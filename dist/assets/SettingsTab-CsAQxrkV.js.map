{"version":3,"file":"SettingsTab-CsAQxrkV.js","sources":["../../src/components/SettingsTab.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { \r\n    X, Loader2, Settings, Bell, Shield, Moon, Users, RefreshCw, Star, \r\n    Filter, Lock, AlertTriangle, Key, Mail, CheckCircle, Eye, MapPin, \r\n    MessageSquare, UserX, Download\r\n} from 'lucide-react';\r\nimport { supabase } from '../config/supabase';\r\nimport { ACCOUNT_TYPES } from '../config/constants';\r\n\r\n// Roles that should never be shown in account settings (managed through other systems)\r\nconst HIDDEN_ROLES = ['Student', 'EDUStaff', 'Intern', 'EDUAdmin', 'GAdmin'];\r\n\r\nexport default function SettingsTab({ user, userData, onUpdate, onRoleSwitch }) {\r\n    const [localSettings, setLocalSettings] = useState(userData?.settings || {\r\n        notifications: { email: true, push: true, marketing: false },\r\n        privacy: { publicProfile: true, showLocation: true, hideProfile: false },\r\n        theme: 'system',\r\n        social: { mutedUsers: [], blockedUsers: [] },\r\n        messenger: { mutedThreads: [], blockedContacts: [] },\r\n        preferences: { seeAllProfiles: false }\r\n    });\r\n    \r\n    const [roles, setRoles] = useState(userData?.accountTypes || []);\r\n    const [preferredRole, setPreferredRole] = useState(userData?.preferredRole || roles[0]);\r\n    const [activeRole, setActiveRole] = useState(userData?.activeProfileRole || roles[0]);\r\n    const [savingRoles, setSavingRoles] = useState(false);\r\n    const [exporting, setExporting] = useState(false);\r\n    \r\n    // Deletion State\r\n    const [isDeleting, setIsDeleting] = useState(false);\r\n    const [deleteConfirm, setDeleteConfirm] = useState('');\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    \r\n    // Security / Account State\r\n    const [showSecurityModal, setShowSecurityModal] = useState(false);\r\n    const [securityAction, setSecurityAction] = useState(null); // 'email' or 'password'\r\n    const [securityForm, setSecurityForm] = useState({ newEmail: '', newPassword: '', currentPassword: '' });\r\n    const [isSecurityLoading, setIsSecurityLoading] = useState(false);\r\n\r\n\r\n    useEffect(() => {\r\n        if (userData?.activeProfileRole) {\r\n            setActiveRole(userData.activeProfileRole);\r\n        }\r\n    }, [userData?.activeProfileRole]);\r\n\r\n    // Generic Toggle Handler for nested settings\r\n    const handleToggle = (category, key) => {\r\n        setLocalSettings(prev => {\r\n            const updated = { \r\n                ...prev, \r\n                [category]: { \r\n                    ...prev[category], \r\n                    [key]: !prev[category]?.[key] \r\n                } \r\n            };\r\n            onUpdate(updated);\r\n            return updated;\r\n        });\r\n    };\r\n\r\n    const handleThemeChange = (val) => {\r\n        setLocalSettings(prev => {\r\n            const updated = { ...prev, theme: val };\r\n            onUpdate(updated);\r\n            return updated;\r\n        });\r\n    };\r\n\r\n    const updateAccountTypes = async () => {\r\n        if (roles.length === 0 || !supabase) return alert(\"You must have at least one role.\");\r\n        setSavingRoles(true);\r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ \r\n                    account_types: roles,\r\n                    preferred_role: preferredRole,\r\n                    active_role: activeRole,\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', user.id);\r\n            \r\n            if (userData && activeRole !== userData.activeProfileRole && onRoleSwitch) {\r\n                onRoleSwitch(activeRole);\r\n            }\r\n\r\n            // Note: Sub-profiles can be handled separately if needed\r\n            // For now, we'll just update the main profile\r\n            alert(\"Roles & Preferences updated!\");\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Failed to update.\");\r\n        }\r\n        setSavingRoles(false);\r\n    };\r\n\r\n    const toggleRole = (role) => {\r\n        setRoles(prev => prev.includes(role) ? prev.filter(r => r !== role) : [...prev, role]);\r\n    };\r\n\r\n    // --- SECURITY HANDLERS ---\r\n    const openSecurityModal = (action) => {\r\n        setSecurityAction(action);\r\n        setSecurityForm({ newEmail: '', newPassword: '', currentPassword: '' });\r\n        setShowSecurityModal(true);\r\n    };\r\n\r\n    const handleSecurityUpdate = async () => {\r\n        if (!securityForm.currentPassword || !supabase) {\r\n            if (!securityForm.currentPassword) alert(\"Current password is required to verify your identity.\");\r\n            return;\r\n        }\r\n        setIsSecurityLoading(true);\r\n\r\n        try {\r\n            // Verify current password by attempting to sign in\r\n            const { error: verifyError } = await supabase.auth.signInWithPassword({\r\n                email: user.email,\r\n                password: securityForm.currentPassword\r\n            });\r\n            \r\n            if (verifyError) {\r\n                throw new Error(\"Incorrect current password.\");\r\n            }\r\n\r\n            if (securityAction === 'email') {\r\n                if (!securityForm.newEmail) throw new Error(\"New email address is required.\");\r\n                const { error: emailError } = await supabase.auth.updateUser({ \r\n                    email: securityForm.newEmail \r\n                });\r\n                if (emailError) throw emailError;\r\n                \r\n                // Update profile email\r\n                await supabase\r\n                    .from('profiles')\r\n                    .update({ email: securityForm.newEmail, updated_at: new Date().toISOString() })\r\n                    .eq('id', user.id);\r\n                \r\n                alert(\"Email updated successfully.\");\r\n            } \r\n            else if (securityAction === 'password') {\r\n                if (securityForm.newPassword.length < 6) throw new Error(\"Password must be at least 6 characters.\");\r\n                const { error: passwordError } = await supabase.auth.updateUser({ \r\n                    password: securityForm.newPassword \r\n                });\r\n                if (passwordError) throw passwordError;\r\n                alert(\"Password updated successfully.\");\r\n            }\r\n\r\n            setShowSecurityModal(false);\r\n            setSecurityForm({ newEmail: '', newPassword: '', currentPassword: '' });\r\n\r\n        } catch (e) {\r\n            console.error(\"Security Update Error:\", e);\r\n            if (e.message?.includes('Incorrect current password') || e.message?.includes('Invalid')) {\r\n                alert(\"Incorrect current password.\");\r\n            } else if (e.message?.includes('already registered') || e.message?.includes('already in use')) {\r\n                alert(\"This email is already associated with another account.\");\r\n            } else {\r\n                alert(\"Failed to update: \" + e.message);\r\n            }\r\n        }\r\n        setIsSecurityLoading(false);\r\n    };\r\n\r\n    const handleDataExport = async () => {\r\n        if (!supabase || !user) {\r\n            alert(\"Unable to export data. Please ensure you're logged in.\");\r\n            return;\r\n        }\r\n        \r\n        setExporting(true);\r\n        try {\r\n            const userId = user.id;\r\n            \r\n            // Collect all user data from Supabase\r\n            const [profile, wallet, bookings, reviews, follows, notifications] = await Promise.all([\r\n                supabase.from('profiles').select('*').eq('id', userId).single(),\r\n                supabase.from('wallets').select('*').eq('user_id', userId).single(),\r\n                supabase.from('bookings').select('*').or(`sender_id.eq.${userId},target_id.eq.${userId}`).limit(1000),\r\n                supabase.from('reviews').select('*').or(`reviewer_id.eq.${userId},target_id.eq.${userId}`).limit(1000),\r\n                supabase.from('follows').select('*').or(`follower_id.eq.${userId},following_id.eq.${userId}`).limit(1000),\r\n                supabase.from('notifications').select('*').eq('user_id', userId).limit(1000)\r\n            ]);\r\n            \r\n            // Also check for sub_profiles\r\n            const { data: subProfiles } = await supabase\r\n                .from('sub_profiles')\r\n                .select('*')\r\n                .eq('user_id', userId);\r\n            \r\n            // Compile export data\r\n            const exportData = {\r\n                exportDate: new Date().toISOString(),\r\n                userId: userId,\r\n                profile: profile.data || null,\r\n                wallet: wallet.data || null,\r\n                subProfiles: subProfiles || [],\r\n                bookings: bookings.data || [],\r\n                reviews: reviews.data || [],\r\n                follows: follows.data || [],\r\n                notifications: notifications.data || []\r\n            };\r\n            \r\n            // Create JSON blob and download\r\n            const jsonString = JSON.stringify(exportData, null, 2);\r\n            const blob = new Blob([jsonString], { type: 'application/json' });\r\n            const url = URL.createObjectURL(blob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `seshnx_data_export_${new Date().toISOString().slice(0,10)}.json`;\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n            URL.revokeObjectURL(url);\r\n            \r\n            alert(\"Your data has been downloaded successfully.\");\r\n        } catch (e) {\r\n            console.error(\"Data export error:\", e);\r\n            alert(\"Failed to export data: \" + (e.message || \"Unknown error\"));\r\n        }\r\n        setExporting(false);\r\n    };\r\n\r\n    // --- DELETION LOGIC ---\r\n    const handleDeleteAccount = async () => {\r\n        if (deleteConfirm !== 'DELETE' || !supabase || !user) return;\r\n        setIsDeleting(true);\r\n        const userId = user.id;\r\n        \r\n        try {\r\n            // Step 1: Delete all related data first to avoid foreign key constraint violations\r\n            // Delete profile and related records\r\n            const relatedTables = [\r\n                'profiles',\r\n                'wallets',\r\n                'notifications',\r\n                'saved_posts',\r\n                'followers',\r\n                'following',\r\n                'posts',\r\n                'comments',\r\n                'bookings',\r\n                'marketplace_items',\r\n                'distribution_releases',\r\n                'equipment_submissions',\r\n                'safe_exchange_transactions',\r\n                'shipping_transactions'\r\n            ];\r\n            \r\n            for (const table of relatedTables) {\r\n                try {\r\n                    // Delete records where user is the owner or participant\r\n                    const deleteQueries = [];\r\n                    \r\n                    if (table === 'profiles' || table === 'wallets') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('id', userId)\r\n                        );\r\n                    } else if (table === 'notifications' || table === 'saved_posts') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('user_id', userId)\r\n                        );\r\n                    } else if (table === 'followers') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('follower_id', userId),\r\n                            supabase.from(table).delete().eq('following_id', userId)\r\n                        );\r\n                    } else if (table === 'following') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('user_id', userId),\r\n                            supabase.from(table).delete().eq('target_id', userId)\r\n                        );\r\n                    } else if (table === 'posts' || table === 'comments') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('user_id', userId)\r\n                        );\r\n                    } else if (table === 'bookings') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('sender_id', userId),\r\n                            supabase.from(table).delete().eq('target_id', userId)\r\n                        );\r\n                    } else if (table === 'marketplace_items') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('seller_id', userId)\r\n                        );\r\n                    } else if (table === 'distribution_releases') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('uploader_id', userId)\r\n                        );\r\n                    } else if (table === 'equipment_submissions') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('submitted_by', userId)\r\n                        );\r\n                    } else if (table === 'safe_exchange_transactions') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('buyer_id', userId),\r\n                            supabase.from(table).delete().eq('seller_id', userId)\r\n                        );\r\n                    } else if (table === 'shipping_transactions') {\r\n                        deleteQueries.push(\r\n                            supabase.from(table).delete().eq('buyer_id', userId),\r\n                            supabase.from(table).delete().eq('seller_id', userId)\r\n                        );\r\n                    }\r\n                    \r\n                    // Execute all delete queries for this table\r\n                    await Promise.all(deleteQueries);\r\n                } catch (tableError) {\r\n                    // Log but don't fail - some tables might not exist or have different schemas\r\n                    console.warn(`Could not delete from ${table}:`, tableError);\r\n                }\r\n            }\r\n            \r\n            // Step 2: Call Supabase admin API to delete the auth user\r\n            // Note: This requires a backend endpoint with service_role key\r\n            // For now, we'll use the Supabase client which may not have permissions\r\n            const { error: deleteError } = await supabase.auth.admin.deleteUser(userId);\r\n            \r\n            if (deleteError) {\r\n                // If admin API fails, try regular signOut and show message\r\n                console.warn(\"Admin delete failed, using signOut:\", deleteError);\r\n                await supabase.auth.signOut();\r\n                alert(\"Account data has been deleted. Please contact support to complete account deletion if needed.\");\r\n            } else {\r\n                alert(\"Account successfully deleted.\");\r\n            }\r\n            \r\n            // Step 3: Clear local state and redirect\r\n            setShowDeleteModal(false);\r\n            setDeleteConfirm('');\r\n            window.location.href = '/';\r\n            \r\n        } catch (error) {\r\n            console.error(\"Deletion Error:\", error);\r\n            alert(\"Failed to delete account: \" + (error.message || \"Unknown error. Please contact support.\"));\r\n            setIsDeleting(false);\r\n        }\r\n    };\r\n\r\n    \r\n\r\n    // Helper for Block Lists\r\n    const ListManager = ({ title, items, type, icon: Icon }) => (\r\n        <div className=\"mt-4 border-t dark:border-gray-700 pt-4\">\r\n            <h5 className=\"text-sm font-bold dark:text-gray-300 mb-2 flex items-center gap-2\"><Icon size={14}/> {title}</h5>\r\n            {items && items.length > 0 ? (\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                    {items.map((id, i) => (\r\n                        <span key={i} className=\"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded flex items-center gap-1 text-gray-600 dark:text-gray-300\">\r\n                            {id.substring(0,8)}... <X size={10} className=\"cursor-pointer hover:text-red-500\"/>\r\n                        </span>\r\n                    ))}\r\n                </div>\r\n            ) : (\r\n                <p className=\"text-xs text-gray-400 italic\">No active {type}.</p>\r\n            )}\r\n        </div>\r\n    );\r\n\r\n    // Always filter out EDU and GAdmin roles from settings - they are managed through other systems\r\n    const displayedRoles = ACCOUNT_TYPES.filter(role => !HIDDEN_ROLES.includes(role));\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-300 pb-20\">\r\n            \r\n            {/* 1. ROLES & WORKFLOW */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm\">\r\n                <h3 className=\"font-bold text-lg dark:text-white mb-4 flex items-center gap-2\"><Users size={18} className=\"text-purple-500\"/> Roles & Workflow</h3>\r\n                \r\n                <div className=\"mb-6\">\r\n                    <div className=\"mb-2\">\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase block\">Active Account Types</label>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-wrap gap-2 mb-4\">\r\n                        {displayedRoles.map(role => (\r\n                            <button \r\n                                key={role} \r\n                                onClick={() => toggleRole(role)}\r\n                                className={`px-3 py-1.5 rounded-full text-xs font-bold transition border ${roles.includes(role) ? 'bg-purple-100 border-purple-200 text-purple-700 dark:bg-purple-900/30 dark:border-purple-700 dark:text-purple-300' : 'bg-gray-50 border-gray-200 text-gray-500 dark:bg-transparent dark:border-gray-600 dark:text-gray-400'}`}\r\n                            >\r\n                                {role}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4\">\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1\"><Star size={12}/> Preferred Profile</label>\r\n                        <select \r\n                            className=\"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                            value={preferredRole}\r\n                            onChange={e => setPreferredRole(e.target.value)}\r\n                        >\r\n                            {roles.filter(r => !HIDDEN_ROLES.includes(r)).map(r => <option key={r} value={r}>{r}</option>)}\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1\"><RefreshCw size={12}/> Active Workflow Context</label>\r\n                        <select \r\n                            className=\"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                            value={activeRole}\r\n                            onChange={e => setActiveRole(e.target.value)}\r\n                        >\r\n                            {roles.filter(r => !HIDDEN_ROLES.includes(r)).map(r => <option key={r} value={r}>{r}</option>)}\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n\r\n                <label className=\"flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded transition border border-gray-200 dark:border-gray-700\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Filter size={16} className=\"text-brand-blue\"/>\r\n                        <div>\r\n                            <span className=\"text-sm font-bold text-gray-700 dark:text-gray-200\">See All (Unfiltered View)</span>\r\n                            <p className=\"text-[10px] text-gray-500\">Show all content types regardless of active workflow.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div className={`w-10 h-5 rounded-full p-0.5 flex transition-colors ${localSettings.preferences?.seeAllProfiles ? 'bg-brand-blue justify-end' : 'bg-gray-300 dark:bg-gray-600 justify-start'}`}>\r\n                        <input type=\"checkbox\" className=\"hidden\" checked={localSettings.preferences?.seeAllProfiles || false} onChange={() => handleToggle('preferences', 'seeAllProfiles')} />\r\n                        <div className=\"w-4 h-4 bg-white rounded-full shadow-sm\"></div>\r\n                    </div>\r\n                </label>\r\n\r\n                <div className=\"mt-4 pt-4 border-t dark:border-gray-700\">\r\n                    <button onClick={updateAccountTypes} disabled={savingRoles} className=\"w-full bg-purple-600 text-white px-4 py-2.5 rounded-lg font-bold hover:bg-purple-700 disabled:opacity-50 flex items-center justify-center gap-2 shadow-md transition\">\r\n                        {savingRoles ? <Loader2 className=\"animate-spin\" size={16}/> : <RefreshCw size={16}/>} Save Workflow Settings\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 2. ACCOUNT SECURITY */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm\">\r\n                <h3 className=\"font-bold text-lg dark:text-white mb-4 flex items-center gap-2\">\r\n                    <Shield size={18} className=\"text-blue-500\"/> Account Security\r\n                </h3>\r\n                \r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full text-blue-600 dark:text-blue-400\">\r\n                                <Mail size={18}/>\r\n                            </div>\r\n                            <div>\r\n                                <div className=\"text-sm font-bold dark:text-white\">Email Address</div>\r\n                                <div className=\"text-xs text-gray-500\">{user.email}</div>\r\n                            </div>\r\n                        </div>\r\n                        <button \r\n                            onClick={() => openSecurityModal('email')}\r\n                            className=\"text-xs font-bold bg-white dark:bg-gray-700 border dark:border-gray-600 px-3 py-1.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition\"\r\n                        >\r\n                            Change Email\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full text-blue-600 dark:text-blue-400\">\r\n                                <Key size={18}/>\r\n                            </div>\r\n                            <div>\r\n                                <div className=\"text-sm font-bold dark:text-white\">Password</div>\r\n                                <div className=\"text-xs text-gray-500\">Last changed: Never (or unknown)</div>\r\n                            </div>\r\n                        </div>\r\n                        <button \r\n                            onClick={() => openSecurityModal('password')}\r\n                            className=\"text-xs font-bold bg-white dark:bg-gray-700 border dark:border-gray-600 px-3 py-1.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition\"\r\n                        >\r\n                            Change Password\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 3. MODULE SETTINGS (Content & Safety) */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm\">\r\n                <h3 className=\"font-bold text-lg dark:text-white mb-4 flex items-center gap-2\"><Settings size={18} className=\"text-gray-500\"/> Content & Safety</h3>\r\n                \r\n                <ListManager \r\n                    title=\"Blocked Users\" \r\n                    items={localSettings.social?.blockedUsers} \r\n                    type=\"blocks\" \r\n                    icon={UserX}\r\n                />\r\n                \r\n                <ListManager \r\n                    title=\"Muted Threads\" \r\n                    items={localSettings.messenger?.mutedThreads} \r\n                    type=\"mutes\" \r\n                    icon={MessageSquare}\r\n                />\r\n            </div>\r\n\r\n            {/* 4. NOTIFICATION PREFERENCES */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm\">\r\n                <h3 className=\"font-bold text-lg dark:text-white mb-4 flex items-center gap-2\"><Bell size={18} className=\"text-brand-blue\"/> Notification Preferences</h3>\r\n                <div className=\"space-y-3\">\r\n                    {Object.entries({\r\n                        email: \"Email Notifications\",\r\n                        push: \"Push Notifications\",\r\n                        marketing: \"Marketing & Updates\"\r\n                    }).map(([key, label]) => (\r\n                        <div key={key} className=\"flex items-center justify-between\">\r\n                            <span className=\"text-sm dark:text-gray-300\">{label}</span>\r\n                            <div \r\n                                onClick={() => handleToggle('notifications', key)}\r\n                                className={`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${localSettings.notifications?.[key] ? 'bg-brand-blue justify-end' : 'bg-gray-300 dark:bg-gray-600 justify-start'}`}\r\n                            >\r\n                                <div className=\"w-4 h-4 bg-white rounded-full shadow-sm\"></div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* 5. PRIVACY & VISIBILITY */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm\">\r\n                <h3 className=\"font-bold text-lg dark:text-white mb-4 flex items-center gap-2\"><Shield size={18} className=\"text-green-500\"/> Privacy & Visibility</h3>\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Eye size={16} className=\"text-gray-400\"/>\r\n                            <span className=\"text-sm dark:text-gray-300\">Public Profile Visibility</span>\r\n                        </div>\r\n                        <div \r\n                            onClick={() => handleToggle('privacy', 'publicProfile')}\r\n                            className={`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${localSettings.privacy?.publicProfile ? 'bg-green-500 justify-end' : 'bg-gray-300 dark:bg-gray-600 justify-start'}`}\r\n                        >\r\n                            <div className=\"w-4 h-4 bg-white rounded-full shadow-sm\"></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <MapPin size={16} className=\"text-gray-400\"/>\r\n                            <span className=\"text-sm dark:text-gray-300\">Show Location on Map</span>\r\n                        </div>\r\n                        <div \r\n                            onClick={() => handleToggle('privacy', 'showLocation')}\r\n                            className={`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${localSettings.privacy?.showLocation ? 'bg-green-500 justify-end' : 'bg-gray-300 dark:bg-gray-600 justify-start'}`}\r\n                        >\r\n                            <div className=\"w-4 h-4 bg-white rounded-full shadow-sm\"></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <UserX size={16} className=\"text-gray-400\"/>\r\n                            <span className=\"text-sm dark:text-gray-300\">Hide Profile Completely</span>\r\n                        </div>\r\n                        <div \r\n                            onClick={() => handleToggle('privacy', 'hideProfile')}\r\n                            className={`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${localSettings.privacy?.hideProfile ? 'bg-brand-blue justify-end' : 'bg-gray-300 dark:bg-gray-600 justify-start'}`}\r\n                        >\r\n                            <div className=\"w-4 h-4 bg-white rounded-full shadow-sm\"></div>\r\n                        </div>\r\n                    </div>\r\n               \r\n        \r\n                    {/* NEW: Data Export Button */}\r\n                    <div className=\"pt-4 mt-2 border-t dark:border-gray-700\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <span className=\"text-sm font-bold dark:text-white\">Your Data</span>\r\n                                <p className=\"text-[10px] text-gray-500\">Download a copy of your personal data (GDPR/CCPA).</p>\r\n                            </div>\r\n                            <button \r\n                                onClick={handleDataExport} \r\n                                disabled={exporting}\r\n                                className=\"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs font-bold text-gray-700 dark:text-gray-200 transition\"\r\n                            >\r\n                                {exporting ? <Loader2 size={14} className=\"animate-spin\"/> : <Download size={14}/>}\r\n                                Download Data\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 6. APPEARANCE */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm\">\r\n                <h3 className=\"font-bold text-lg dark:text-white mb-4 flex items-center gap-2\"><Moon size={18} className=\"text-purple-500\"/> Appearance</h3>\r\n                <div className=\"flex bg-gray-100 dark:bg-black/20 p-1 rounded-lg\">\r\n                    {['light', 'dark', 'system'].map(t => (\r\n                        <button \r\n                            key={t} \r\n                            onClick={() => handleThemeChange(t)}\r\n                            className={`flex-1 py-2 text-xs font-bold rounded-md capitalize transition-all ${localSettings.theme === t ? 'bg-white dark:bg-gray-700 shadow-sm text-brand-blue' : 'text-gray-500 hover:text-gray-700 dark:hover:text-gray-300'}`}\r\n                        >\r\n                            {t}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* 7. DANGER ZONE */}\r\n            <div className=\"bg-red-50 dark:bg-red-900/10 p-6 rounded-xl border border-red-100 dark:border-red-800/30 shadow-sm\">\r\n                <h3 className=\"font-bold text-lg text-red-600 dark:text-red-400 mb-2 flex items-center gap-2\"><Lock size={18}/> Danger Zone</h3>\r\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\r\n                    Deleting your account is permanent. This action will trigger the data cleanup process, removing your profile, posts, and messages.\r\n                </p>\r\n                \r\n                {!showDeleteModal ? (\r\n                    <button \r\n                        onClick={() => setShowDeleteModal(true)}\r\n                        className=\"bg-red-100 hover:bg-red-200 dark:bg-red-900/40 dark:hover:bg-red-900/60 text-red-700 dark:text-red-300 px-4 py-2 rounded-lg text-sm font-bold transition\"\r\n                    >\r\n                        Delete Account\r\n                    </button>\r\n                ) : (\r\n                    <div className=\"bg-white dark:bg-[#1f2128] p-4 rounded-xl border border-red-200 dark:border-red-900 shadow-lg animate-in fade-in slide-in-from-bottom-2\">\r\n                        <h4 className=\"font-bold text-red-600 dark:text-red-400 mb-2 flex items-center gap-2\"><AlertTriangle size={16}/> Confirm Deletion</h4>\r\n                        <p className=\"text-xs text-gray-600 dark:text-gray-400 mb-3\">\r\n                            Type <strong>DELETE</strong> below to confirm. This cannot be undone.\r\n                        </p>\r\n                        <input \r\n                            type=\"text\" \r\n                            className=\"w-full p-2 border border-red-300 dark:border-red-900 rounded mb-3 text-sm focus:ring-2 focus:ring-red-500 outline-none dark:bg-black/20 dark:text-white\"\r\n                            placeholder=\"Type DELETE\"\r\n                            value={deleteConfirm}\r\n                            onChange={(e) => setDeleteConfirm(e.target.value)}\r\n                        />\r\n                        <div className=\"flex gap-2\">\r\n                            <button \r\n                                onClick={handleDeleteAccount} \r\n                                disabled={deleteConfirm !== 'DELETE' || isDeleting}\r\n                                className=\"flex-1 bg-red-600 text-white py-2 rounded font-bold text-xs hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n                            >\r\n                                {isDeleting ? <Loader2 className=\"animate-spin\" size={14}/> : 'Confirm Delete'}\r\n                            </button>\r\n                            <button \r\n                                onClick={() => { setShowDeleteModal(false); setDeleteConfirm(''); }}\r\n                                className=\"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-xs hover:opacity-80\"\r\n                            >\r\n                                Cancel\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* --- SECURITY MODAL --- */}\r\n            {showSecurityModal && (\r\n                <div className=\"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4\">\r\n                    <div className=\"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 shadow-2xl animate-in zoom-in-95 border dark:border-gray-700\">\r\n                        <div className=\"flex justify-between items-center mb-4\">\r\n                            <h3 className=\"text-lg font-bold dark:text-white flex items-center gap-2\">\r\n                                {securityAction === 'email' ? <Mail size={20}/> : <Key size={20}/>}\r\n                                Update {securityAction === 'email' ? 'Email' : 'Password'}\r\n                            </h3>\r\n                            <button onClick={() => setShowSecurityModal(false)} className=\"text-gray-400 hover:text-gray-600 dark:hover:text-white\">\r\n                                <X size={20}/>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-4\">\r\n                            {/* Current Password Field (Always Required) */}\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Current Password (Required)</label>\r\n                                <input \r\n                                    type=\"password\"\r\n                                    className=\"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white\"\r\n                                    placeholder=\"Verify your identity\"\r\n                                    value={securityForm.currentPassword}\r\n                                    onChange={e => setSecurityForm({...securityForm, currentPassword: e.target.value})}\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Dynamic Field based on Action */}\r\n                            {securityAction === 'email' ? (\r\n                                <div>\r\n                                    <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">New Email Address</label>\r\n                                    <input \r\n                                        type=\"email\"\r\n                                        className=\"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white\"\r\n                                        placeholder=\"name@example.com\"\r\n                                        value={securityForm.newEmail}\r\n                                        onChange={e => setSecurityForm({...securityForm, newEmail: e.target.value})}\r\n                                    />\r\n                                </div>\r\n                            ) : (\r\n                                <div>\r\n                                    <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">New Password</label>\r\n                                    <input \r\n                                        type=\"password\"\r\n                                        className=\"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white\"\r\n                                        placeholder=\"Min 6 characters\"\r\n                                        value={securityForm.newPassword}\r\n                                        onChange={e => setSecurityForm({...securityForm, newPassword: e.target.value})}\r\n                                    />\r\n                                </div>\r\n                            )}\r\n\r\n                            <button \r\n                                onClick={handleSecurityUpdate}\r\n                                disabled={isSecurityLoading}\r\n                                className=\"w-full bg-blue-600 text-white py-2.5 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2 shadow-lg mt-2\"\r\n                            >\r\n                                {isSecurityLoading ? <Loader2 className=\"animate-spin\" size={18}/> : <CheckCircle size={18}/>}\r\n                                Confirm Update\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":["HIDDEN_ROLES","SettingsTab","user","userData","onUpdate","onRoleSwitch","localSettings","setLocalSettings","useState","roles","setRoles","preferredRole","setPreferredRole","activeRole","setActiveRole","savingRoles","setSavingRoles","exporting","setExporting","isDeleting","setIsDeleting","deleteConfirm","setDeleteConfirm","showDeleteModal","setShowDeleteModal","showSecurityModal","setShowSecurityModal","securityAction","setSecurityAction","securityForm","setSecurityForm","isSecurityLoading","setIsSecurityLoading","useEffect","handleToggle","category","key","prev","updated","_a","handleThemeChange","val","updateAccountTypes","supabase","toggleRole","role","r","openSecurityModal","action","handleSecurityUpdate","handleDataExport","handleDeleteAccount","ListManager","title","items","type","Icon","jsxs","jsx","id","i","X","displayedRoles","ACCOUNT_TYPES","Users","Star","e","RefreshCw","Filter","_b","Loader2","Shield","Mail","Key","Settings","_c","UserX","_d","MessageSquare","Bell","label","Eye","_e","MapPin","_f","_g","Download","Moon","t","Lock","AlertTriangle","CheckCircle"],"mappings":"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"}