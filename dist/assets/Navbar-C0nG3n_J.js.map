{"version":3,"file":"Navbar-C0nG3n_J.js","sources":["../../src/components/social/NotificationsPanel.jsx","../../src/components/Navbar.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { \r\n    Bell, \r\n    UserPlus, \r\n    Heart, \r\n    MessageCircle, \r\n    AtSign, \r\n    CornerDownRight, \r\n    Bookmark,\r\n    Check,\r\n    CheckCheck,\r\n    Trash2,\r\n    X,\r\n    Calendar,\r\n    DollarSign,\r\n    Clock,\r\n    Loader2\r\n} from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { supabase } from '../../config/supabase';\r\nimport UserAvatar from '../shared/UserAvatar';\r\nimport toast from 'react-hot-toast';\r\n\r\n/**\r\n * Get the appropriate icon for notification type\r\n */\r\nconst NotificationIcon = ({ type }) => {\r\n    const iconProps = { size: 14 };\r\n    const iconMap = {\r\n        follow: <UserPlus {...iconProps} />,\r\n        like: <Heart {...iconProps} />,\r\n        comment: <MessageCircle {...iconProps} />,\r\n        mention: <AtSign {...iconProps} />,\r\n        reply: <CornerDownRight {...iconProps} />,\r\n        save: <Bookmark {...iconProps} />,\r\n        booking: <Calendar {...iconProps} />,\r\n        booking_accepted: <Check {...iconProps} />,\r\n        booking_declined: <X {...iconProps} />\r\n    };\r\n\r\n    const colorMap = {\r\n        follow: 'bg-brand-blue/10 text-brand-blue dark:bg-brand-blue/20',\r\n        like: 'bg-red-100 text-red-500 dark:bg-red-900/30 dark:text-red-400',\r\n        comment: 'bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400',\r\n        mention: 'bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400',\r\n        reply: 'bg-orange-100 text-orange-600 dark:bg-orange-900/30 dark:text-orange-400',\r\n        save: 'bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400',\r\n        booking: 'bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-400',\r\n        booking_accepted: 'bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400',\r\n        booking_declined: 'bg-red-100 text-red-500 dark:bg-red-900/30 dark:text-red-400'\r\n    };\r\n\r\n    return (\r\n        <div className={`p-1.5 rounded-full ${colorMap[type] || 'bg-gray-100 text-gray-500'}`}>\r\n            {iconMap[type] || <Bell size={14} />}\r\n        </div>\r\n    );\r\n};\r\n\r\n/**\r\n * Format timestamp to relative time\r\n */\r\nconst formatTime = (ts) => {\r\n    if (!ts) return '';\r\n    const date = ts.toMillis ? new Date(ts.toMillis()) : new Date(ts);\r\n    const now = new Date();\r\n    const diffMs = now - date;\r\n    const diffMins = Math.floor(diffMs / 60000);\r\n    const diffHours = Math.floor(diffMins / 60);\r\n    const diffDays = Math.floor(diffHours / 24);\r\n\r\n    if (diffMins < 1) return 'Just now';\r\n    if (diffMins < 60) return `${diffMins}m`;\r\n    if (diffHours < 24) return `${diffHours}h`;\r\n    if (diffDays < 7) return `${diffDays}d`;\r\n    return date.toLocaleDateString();\r\n};\r\n\r\n/**\r\n * Single notification item\r\n */\r\nconst NotificationItem = ({ \r\n    notification, \r\n    onMarkAsRead, \r\n    onDelete, \r\n    onUserClick, \r\n    onPostClick,\r\n    onBookingAction\r\n}) => {\r\n    const [actionLoading, setActionLoading] = useState(null);\r\n    \r\n    const handleClick = () => {\r\n        if (!notification.read) {\r\n            onMarkAsRead(notification.id);\r\n        }\r\n        \r\n        // Navigate based on notification type\r\n        if (notification.type === 'follow' && onUserClick) {\r\n            onUserClick(notification.fromUserId);\r\n        } else if (notification.postId && onPostClick) {\r\n            onPostClick(notification.postId);\r\n        }\r\n    };\r\n    \r\n    const handleBookingAction = async (e, action) => {\r\n        e.stopPropagation();\r\n        if (!notification.bookingId) return;\r\n        \r\n        setActionLoading(action);\r\n        try {\r\n            await onBookingAction(notification.bookingId, action, notification.id);\r\n            toast.success(action === 'accept' ? 'Booking accepted!' : 'Booking declined');\r\n        } catch (err) {\r\n            toast.error('Failed to update booking');\r\n            console.error(err);\r\n        }\r\n        setActionLoading(null);\r\n    };\r\n    \r\n    const isBookingNotification = notification.type === 'booking' && notification.bookingId && !notification.actionTaken;\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0, x: -10 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            exit={{ opacity: 0, x: 10 }}\r\n            className={`\r\n                p-3 cursor-pointer border-b dark:border-gray-700 last:border-0 \r\n                flex gap-3 items-start group transition-colors relative\r\n                ${notification.read \r\n                    ? 'hover:bg-gray-50 dark:hover:bg-gray-800' \r\n                    : 'bg-blue-50/50 dark:bg-blue-900/10 hover:bg-blue-50 dark:hover:bg-blue-900/20'\r\n                }\r\n            `}\r\n            onClick={handleClick}\r\n        >\r\n            {/* User avatar with type icon overlay */}\r\n            <div className=\"relative shrink-0\">\r\n                <UserAvatar \r\n                    src={notification.fromUserPhoto}\r\n                    name={notification.fromUserName}\r\n                    size=\"sm\"\r\n                />\r\n                <div className=\"absolute -bottom-1 -right-1\">\r\n                    <NotificationIcon type={notification.type} />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"flex-1 min-w-0\">\r\n                <div className=\"flex justify-between items-start gap-2\">\r\n                    <p className=\"text-sm dark:text-gray-200 leading-snug\">\r\n                        <span className=\"font-bold hover:text-brand-blue transition-colors\">\r\n                            {notification.fromUserName}\r\n                        </span>\r\n                        {' '}\r\n                        <span className=\"text-gray-600 dark:text-gray-400\">\r\n                            {notification.message}\r\n                        </span>\r\n                    </p>\r\n                    <span className=\"text-[10px] text-gray-400 whitespace-nowrap shrink-0\">\r\n                        {formatTime(notification.timestamp)}\r\n                    </span>\r\n                </div>\r\n\r\n                {/* Post preview if available */}\r\n                {notification.postPreview && (\r\n                    <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-1 line-clamp-1 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded\">\r\n                        \"{notification.postPreview}\"\r\n                    </p>\r\n                )}\r\n                \r\n                {/* Booking details preview */}\r\n                {isBookingNotification && notification.bookingDetails && (\r\n                    <div className=\"mt-2 bg-amber-50 dark:bg-amber-900/20 p-2 rounded-lg text-xs space-y-1\">\r\n                        <div className=\"flex items-center gap-3 text-gray-600 dark:text-gray-300\">\r\n                            {notification.bookingDetails.date && (\r\n                                <span className=\"flex items-center gap-1\">\r\n                                    <Clock size={10} /> {notification.bookingDetails.date}\r\n                                </span>\r\n                            )}\r\n                            {notification.bookingDetails.amount && (\r\n                                <span className=\"flex items-center gap-1 text-green-600 dark:text-green-400 font-bold\">\r\n                                    <DollarSign size={10} /> ${notification.bookingDetails.amount}\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                        {notification.bookingDetails.serviceType && (\r\n                            <span className=\"inline-block bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded text-[10px]\">\r\n                                {notification.bookingDetails.serviceType}\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n                )}\r\n                \r\n                {/* Quick Accept/Decline buttons for booking notifications */}\r\n                {isBookingNotification && (\r\n                    <div className=\"flex gap-2 mt-2\" onClick={e => e.stopPropagation()}>\r\n                        <button\r\n                            onClick={(e) => handleBookingAction(e, 'accept')}\r\n                            disabled={actionLoading}\r\n                            className=\"flex-1 bg-green-600 hover:bg-green-700 text-white text-xs font-bold py-1.5 px-3 rounded-lg transition flex items-center justify-center gap-1 disabled:opacity-50\"\r\n                        >\r\n                            {actionLoading === 'accept' ? (\r\n                                <Loader2 size={12} className=\"animate-spin\" />\r\n                            ) : (\r\n                                <><Check size={12} /> Accept</>\r\n                            )}\r\n                        </button>\r\n                        <button\r\n                            onClick={(e) => handleBookingAction(e, 'decline')}\r\n                            disabled={actionLoading}\r\n                            className=\"flex-1 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 text-xs font-bold py-1.5 px-3 rounded-lg transition flex items-center justify-center gap-1 disabled:opacity-50\"\r\n                        >\r\n                            {actionLoading === 'decline' ? (\r\n                                <Loader2 size={12} className=\"animate-spin\" />\r\n                            ) : (\r\n                                <><X size={12} /> Decline</>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Unread indicator */}\r\n                {!notification.read && (\r\n                    <div className=\"w-2 h-2 bg-brand-blue rounded-full absolute right-3 top-1/2 -translate-y-1/2\" />\r\n                )}\r\n            </div>\r\n\r\n            {/* Delete button on hover */}\r\n            <button \r\n                onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    onDelete(notification.id);\r\n                }}\r\n                className=\"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-all text-gray-400 hover:text-red-500 shrink-0\"\r\n            >\r\n                <X size={14} />\r\n            </button>\r\n        </motion.div>\r\n    );\r\n};\r\n\r\n/**\r\n * Full notifications panel/dropdown\r\n */\r\nexport default function NotificationsPanel({\r\n    notifications,\r\n    unreadCount,\r\n    loading,\r\n    onMarkAsRead,\r\n    onMarkAllAsRead,\r\n    onDeleteNotification,\r\n    onClearAll,\r\n    onUserClick,\r\n    onPostClick,\r\n    onBookingAction,\r\n    onClose\r\n}) {\r\n    return (\r\n        <div className=\"absolute right-0 top-full mt-3 w-80 sm:w-96 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-2xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200\">\r\n            {/* Header */}\r\n            <div className=\"p-3 px-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <h4 className=\"font-bold dark:text-white text-sm\">Notifications</h4>\r\n                    {unreadCount > 0 && (\r\n                        <span className=\"text-xs bg-brand-blue text-white px-2 py-0.5 rounded-full font-bold animate-pulse\">\r\n                            {unreadCount}\r\n                        </span>\r\n                    )}\r\n                </div>\r\n                \r\n                {unreadCount > 0 && (\r\n                    <button \r\n                        onClick={onMarkAllAsRead}\r\n                        className=\"text-xs text-brand-blue hover:text-blue-700 font-medium flex items-center gap-1 transition\"\r\n                    >\r\n                        <CheckCheck size={14} />\r\n                        Mark all read\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            {/* Notifications list */}\r\n            <div className=\"max-h-[400px] overflow-y-auto custom-scrollbar\">\r\n                {loading ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <div className=\"w-6 h-6 border-2 border-brand-blue border-t-transparent rounded-full animate-spin mx-auto mb-2\" />\r\n                        <p className=\"text-xs text-gray-500\">Loading...</p>\r\n                    </div>\r\n                ) : notifications.length === 0 ? (\r\n                    <div className=\"p-8 text-center text-gray-500 flex flex-col items-center\">\r\n                        <div className=\"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-3\">\r\n                            <Bell size={24} className=\"opacity-30\" />\r\n                        </div>\r\n                        <p className=\"text-sm font-medium dark:text-gray-400\">All caught up!</p>\r\n                        <p className=\"text-xs text-gray-400 mt-1\">No new notifications</p>\r\n                    </div>\r\n                ) : (\r\n                    <AnimatePresence mode=\"popLayout\">\r\n                        {notifications.map(notification => (\r\n                            <NotificationItem\r\n                                key={notification.id}\r\n                                notification={notification}\r\n                                onMarkAsRead={onMarkAsRead}\r\n                                onDelete={onDeleteNotification}\r\n                                onUserClick={onUserClick}\r\n                                onPostClick={onPostClick}\r\n                                onBookingAction={onBookingAction}\r\n                            />\r\n                        ))}\r\n                    </AnimatePresence>\r\n                )}\r\n            </div>\r\n\r\n            {/* Footer */}\r\n            {notifications.length > 0 && (\r\n                <div className=\"p-2 bg-gray-50 dark:bg-[#23262f] border-t dark:border-gray-700 flex justify-between items-center\">\r\n                    <button \r\n                        onClick={onClearAll}\r\n                        className=\"text-xs text-gray-400 hover:text-red-500 font-medium flex items-center gap-1 transition px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n                    >\r\n                        <Trash2 size={12} />\r\n                        Clear all\r\n                    </button>\r\n                    <button \r\n                        onClick={onClose}\r\n                        className=\"text-xs text-gray-500 hover:text-gray-800 dark:hover:text-gray-200 px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition\"\r\n                    >\r\n                        Close\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/**\r\n * Notification badge component for navbar\r\n */\r\nexport function NotificationBadge({ count }) {\r\n    if (count === 0) return null;\r\n\r\n    return (\r\n        <motion.span\r\n            initial={{ scale: 0 }}\r\n            animate={{ scale: 1 }}\r\n            className=\"absolute -top-0.5 -right-0.5 min-w-[18px] h-[18px] bg-red-500 rounded-full text-[10px] text-white font-bold flex items-center justify-center border-2 border-white dark:border-dark-card\"\r\n        >\r\n            {count > 99 ? '99+' : count}\r\n        </motion.span>\r\n    );\r\n}\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { Sun, Moon, Bell, Menu, MessageCircle, Calendar, ChevronDown, RefreshCw, GraduationCap, Layout } from 'lucide-react';\r\nimport { supabase } from '../config/supabase';\r\nimport LogoWhite from '../assets/SeshNx-PNG cCropped white text.png';\r\nimport LogoDark from '../assets/SeshNx-PNG cCropped.png';\r\nimport UserAvatar from './shared/UserAvatar';\r\nimport NotificationsPanel, { NotificationBadge } from './social/NotificationsPanel';\r\nimport { useNotifications } from '../hooks/useNotifications';\r\nimport { getDisplayRole } from '../config/constants';\r\n\r\nexport default function Navbar({ \r\n    user, \r\n    userData, \r\n    subProfiles, \r\n    darkMode, \r\n    toggleTheme, \r\n    activeTab, \r\n    setActiveTab, \r\n    onMenuClick, \r\n    onRoleSwitch,\r\n    openPublicProfile // Add callback for viewing profiles\r\n}) {\r\n  const [showNotifs, setShowNotifs] = useState(false);\r\n  const [showRoleMenu, setShowRoleMenu] = useState(false);\r\n  const [isSwitching, setIsSwitching] = useState(false); \r\n  const notifRef = useRef(null);\r\n  const roleRef = useRef(null);\r\n\r\n  // Use the new notifications system\r\n  const {\r\n    notifications,\r\n    unreadCount,\r\n    loading: notifsLoading,\r\n    markAsRead,\r\n    markAllAsRead,\r\n    deleteNotification,\r\n    clearAll\r\n  } = useNotifications(user?.id || user?.uid);\r\n\r\n  const activeRole = userData?.activeProfileRole || userData?.accountTypes?.[0] || 'User';\r\n  const displayRole = getDisplayRole(userData); // Shows subRole if set for Talent\r\n  const roles = userData?.accountTypes || [];\r\n\r\n  const eduRoles = ['Student', 'EDUStaff', 'Intern', 'EDUAdmin'];\r\n  const hasEduAccess = roles.some(r => eduRoles.includes(r));\r\n  const isEduTab = activeTab.startsWith('edu');\r\n\r\n  const getDisplayName = (role) => {\r\n      if (!role || role === 'Main' || role === 'Fan' || role === 'User') {\r\n          return userData?.effectiveDisplayName || userData?.firstName || 'User';\r\n      }\r\n      const sub = subProfiles?.[role];\r\n      return sub?.displayName || userData?.effectiveDisplayName || userData?.firstName || 'User';\r\n  };\r\n\r\n  const currentDisplayName = getDisplayName(activeRole);\r\n\r\n  const handleEduClick = () => {\r\n      if (activeRole === 'Student') {\r\n          setActiveTab('edu-student');\r\n      } else if (activeRole === 'Intern') {\r\n          setActiveTab('edu-intern'); \r\n      } else {\r\n          setActiveTab('edu-overview'); \r\n      }\r\n  };\r\n\r\n  useEffect(() => {\r\n      if (activeRole) {\r\n          setIsSwitching(false);\r\n          requestAnimationFrame(() => {\r\n              requestAnimationFrame(() => {\r\n                  setIsSwitching(true);\r\n              });\r\n          });\r\n          const timer = setTimeout(() => setIsSwitching(false), 600); \r\n          return () => clearTimeout(timer);\r\n      }\r\n  }, [activeRole]);\r\n\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (notifRef.current && !notifRef.current.contains(event.target)) {\r\n        setShowNotifs(false);\r\n      }\r\n      if (roleRef.current && !roleRef.current.contains(event.target)) {\r\n        setShowRoleMenu(false);\r\n      }\r\n    }\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, [notifRef, roleRef]);\r\n\r\n  const handleNotifUserClick = (userId) => {\r\n      setShowNotifs(false);\r\n      if (openPublicProfile) {\r\n          openPublicProfile(userId);\r\n      }\r\n  };\r\n\r\n  const handleNotifPostClick = (postId) => {\r\n      setShowNotifs(false);\r\n      setActiveTab('feed'); // Navigate to feed where the post would be\r\n  };\r\n  \r\n  // Handler for quick booking accept/decline from notifications\r\n  const handleBookingAction = async (bookingId, action, notificationId) => {\r\n      try {\r\n          if (!supabase) throw new Error('Supabase not initialized');\r\n          \r\n          // Update booking status\r\n          const { error: bookingError } = await supabase\r\n              .from('bookings')\r\n              .update({\r\n                  status: action === 'accept' ? 'Confirmed' : 'Declined',\r\n                  responded_at: new Date().toISOString()\r\n              })\r\n              .eq('id', bookingId);\r\n          \r\n          if (bookingError) throw bookingError;\r\n          \r\n          // Mark notification as actioned\r\n          if (notificationId && (user?.id || user?.uid)) {\r\n              const userId = user?.id || user?.uid;\r\n              const { error: notifError } = await supabase\r\n                  .from('notifications')\r\n                  .update({ \r\n                      action_taken: action,\r\n                      read: true,\r\n                      updated_at: new Date().toISOString()\r\n                  })\r\n                  .eq('id', notificationId)\r\n                  .eq('user_id', userId);\r\n              \r\n              if (notifError) throw notifError;\r\n          }\r\n      } catch (error) {\r\n          console.error('Booking action failed:', error);\r\n          throw error;\r\n      }\r\n  };\r\n\r\n  const handleRoleSelect = (role) => {\r\n      if (onRoleSwitch) onRoleSwitch(role);\r\n      setShowRoleMenu(false);\r\n  };\r\n\r\n  const formatTime = (ts) => {\r\n      if (!ts) return '';\r\n      const date = ts.toMillis ? new Date(ts.toMillis()) : new Date(ts);\r\n      const now = new Date();\r\n      const diffMs = now - date;\r\n      const diffMins = Math.floor(diffMs / 60000);\r\n      const diffHours = Math.floor(diffMins / 60);\r\n      if (diffMins < 60) return `${diffMins}m ago`;\r\n      if (diffHours < 24) return `${diffHours}h ago`;\r\n      return date.toLocaleDateString();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div \r\n        className={`fixed top-0 bottom-0 w-full pointer-events-none z-[9999] \r\n          bg-gradient-to-r from-transparent via-white/30 dark:via-white/10 to-transparent\r\n          ${isSwitching ? 'left-[-100%] transition-all duration-500 ease-out' : 'left-[100%] transition-none duration-0'}\r\n        `}\r\n      ></div>\r\n\r\n      <nav className=\"h-16 bg-white dark:bg-dark-card border-b border-gray-200 dark:border-gray-700 flex items-center justify-between px-4 shrink-0 z-20 sticky top-0\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <button \r\n              onClick={onMenuClick}\r\n              className=\"p-2 -ml-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 lg:hidden\"\r\n              aria-label=\"Open navigation menu\"\r\n              aria-expanded=\"false\"\r\n          >\r\n              <Menu size={24} aria-hidden=\"true\" />\r\n          </button>\r\n\r\n          <div className=\"flex items-center gap-2 cursor-pointer\" onClick={()=>setActiveTab('dashboard')}>\r\n              <img \r\n                src={darkMode ? LogoWhite : LogoDark} \r\n                alt=\"SeshNx Logo\" \r\n                className=\"h-8 w-auto object-contain transition-opacity duration-300\" \r\n              />\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center gap-3 md:gap-4\">\r\n          \r\n          {hasEduAccess && (\r\n              <div className=\"hidden md:flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1 border dark:border-gray-700\">\r\n                  <button\r\n                      onClick={() => setActiveTab('dashboard')}\r\n                      className={`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${!isEduTab ? 'bg-white dark:bg-gray-600 shadow-sm text-brand-blue dark:text-white' : 'text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200'}`}\r\n                  >\r\n                      <Layout size={14}/> Studio\r\n                  </button>\r\n                  <button\r\n                      onClick={handleEduClick}\r\n                      className={`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${isEduTab ? 'bg-white dark:bg-gray-600 shadow-sm text-indigo-600 dark:text-white' : 'text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200'}`}\r\n                  >\r\n                      <GraduationCap size={14}/> Education\r\n                  </button>\r\n              </div>\r\n          )}\r\n\r\n          {roles.length > 1 && (\r\n              <div className=\"relative hidden sm:flex items-center gap-3\" ref={roleRef}>\r\n                  <button \r\n                      onClick={() => setShowRoleMenu(!showRoleMenu)}\r\n                      className=\"group flex items-center gap-2 px-3 py-1.5 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 text-xs font-bold transition border border-gray-200 dark:border-gray-700\"\r\n                  >\r\n                      <RefreshCw size={12} className={`text-brand-blue shrink-0 transition-transform ${isSwitching ? 'rotate-180 duration-500' : ''}`}/>\r\n                      <span>{displayRole}</span>\r\n                      <ChevronDown size={12} className={`shrink-0 transition-transform ${showRoleMenu ? 'rotate-180' : ''}`}/>\r\n                  </button>\r\n\r\n                  <div className=\"flex flex-col leading-tight\">\r\n                      <span className=\"text-[10px] text-gray-500 font-medium\">Posting as</span>\r\n                      <span className=\"text-xs font-bold dark:text-white truncate max-w-[150px]\">{currentDisplayName}</span>\r\n                  </div>\r\n\r\n                  {showRoleMenu && (\r\n                      <div className=\"absolute left-0 top-full mt-2 w-56 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-1 duration-200\">\r\n                          <div className=\"p-2 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]\">\r\n                              <span className=\"text-[10px] font-bold text-gray-500 uppercase tracking-wider pl-2\">Switch Profile Context</span>\r\n                          </div>\r\n                          <div className=\"p-1\">\r\n                              {roles.map(role => {\r\n                                  const name = getDisplayName(role);\r\n                                  return (\r\n                                      <button \r\n                                          key={role}\r\n                                          onClick={() => handleRoleSelect(role)}\r\n                                          className={`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition flex items-center justify-between ${activeRole === role ? 'bg-blue-50 dark:bg-blue-900/20 text-brand-blue' : 'hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300'}`}\r\n                                      >\r\n                                          <div className=\"flex flex-col\">\r\n                                              <span>{name}</span>\r\n                                              <span className=\"text-[10px] opacity-70 font-normal uppercase\">{role}</span>\r\n                                          </div>\r\n                                          {activeRole === role && <div className=\"w-1.5 h-1.5 rounded-full bg-brand-blue\"></div>}\r\n                                      </button>\r\n                                  );\r\n                              })}\r\n                          </div>\r\n                      </div>\r\n                  )}\r\n              </div>\r\n          )}\r\n\r\n          <button \r\n            onClick={toggleTheme} \r\n            className=\"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300\"\r\n            aria-label={darkMode ? 'Switch to light mode' : 'Switch to dark mode'}\r\n            title={darkMode ? 'Switch to light mode' : 'Switch to dark mode'}\r\n          >\r\n            {darkMode ? <Sun size={20} aria-hidden=\"true\" /> : <Moon size={20} aria-hidden=\"true\" />}\r\n          </button>\r\n          \r\n          <div className=\"relative\" ref={notifRef}>\r\n              <button \r\n                  className={`relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 transition ${showNotifs ? 'bg-gray-100 dark:bg-gray-800 text-brand-blue' : ''}`}\r\n                  onClick={() => setShowNotifs(!showNotifs)}\r\n                  aria-label={`Notifications${unreadCount > 0 ? ` (${unreadCount} unread)` : ''}`}\r\n                  aria-expanded={showNotifs}\r\n              >\r\n                  <Bell size={20} aria-hidden=\"true\" />\r\n                  <NotificationBadge count={unreadCount} />\r\n              </button>\r\n\r\n              {showNotifs && (\r\n                  <NotificationsPanel\r\n                      notifications={notifications}\r\n                      unreadCount={unreadCount}\r\n                      loading={notifsLoading}\r\n                      onMarkAsRead={markAsRead}\r\n                      onMarkAllAsRead={markAllAsRead}\r\n                      onDeleteNotification={deleteNotification}\r\n                      onClearAll={clearAll}\r\n                      onUserClick={handleNotifUserClick}\r\n                      onPostClick={handleNotifPostClick}\r\n                      onBookingAction={handleBookingAction}\r\n                      onClose={() => setShowNotifs(false)}\r\n                  />\r\n              )}\r\n          </div>\r\n\r\n          {/* FIX: Use UserAvatar */}\r\n          <UserAvatar \r\n              src={userData?.photoURL} \r\n              name={currentDisplayName} \r\n              size=\"sm\" \r\n              className=\"border-2 border-transparent hover:border-brand-blue transition\"\r\n              onClick={() => setActiveTab('profile')}\r\n          />\r\n        </div>\r\n      </nav>\r\n    </>\r\n  );\r\n}\r\n"],"names":["NotificationIcon","type","iconProps","iconMap","jsx","UserPlus","Heart","MessageCircle","AtSign","CornerDownRight","Bookmark","Calendar","Check","X","colorMap","Bell","formatTime","ts","date","diffMs","diffMins","diffHours","diffDays","NotificationItem","notification","onMarkAsRead","onDelete","onUserClick","onPostClick","onBookingAction","actionLoading","setActionLoading","useState","handleClick","handleBookingAction","e","action","toast","err","isBookingNotification","jsxs","motion","UserAvatar","Clock","DollarSign","Loader2","Fragment","NotificationsPanel","notifications","unreadCount","loading","onMarkAllAsRead","onDeleteNotification","onClearAll","onClose","CheckCheck","AnimatePresence","Trash2","NotificationBadge","count","Navbar","user","userData","subProfiles","darkMode","toggleTheme","activeTab","setActiveTab","onMenuClick","onRoleSwitch","openPublicProfile","showNotifs","setShowNotifs","showRoleMenu","setShowRoleMenu","isSwitching","setIsSwitching","notifRef","useRef","roleRef","notifsLoading","markAsRead","markAllAsRead","deleteNotification","clearAll","useNotifications","activeRole","_a","displayRole","getDisplayRole","roles","eduRoles","hasEduAccess","r","isEduTab","getDisplayName","role","sub","currentDisplayName","handleEduClick","useEffect","timer","handleClickOutside","event","handleNotifUserClick","userId","handleNotifPostClick","postId","bookingId","notificationId","supabase","bookingError","notifError","error","handleRoleSelect","Menu","LogoWhite","LogoDark","Layout","GraduationCap","RefreshCw","ChevronDown","name","Sun","Moon"],"mappings":"ijBA0BA,MAAMA,GAAmB,CAAC,CAAE,KAAAC,KAAW,CACnC,MAAMC,EAAY,CAAE,KAAM,EAAA,EACpBC,EAAU,CACZ,OAAQC,EAAAA,IAACC,GAAA,CAAU,GAAGH,CAAA,CAAW,EACjC,KAAME,EAAAA,IAACE,GAAA,CAAO,GAAGJ,CAAA,CAAW,EAC5B,QAASE,EAAAA,IAACG,GAAA,CAAe,GAAGL,CAAA,CAAW,EACvC,QAASE,EAAAA,IAACI,GAAA,CAAQ,GAAGN,CAAA,CAAW,EAChC,MAAOE,EAAAA,IAACK,GAAA,CAAiB,GAAGP,CAAA,CAAW,EACvC,KAAME,EAAAA,IAACM,GAAA,CAAU,GAAGR,CAAA,CAAW,EAC/B,QAASE,EAAAA,IAACO,GAAA,CAAU,GAAGT,CAAA,CAAW,EAClC,iBAAkBE,EAAAA,IAACQ,EAAA,CAAO,GAAGV,CAAA,CAAW,EACxC,iBAAkBE,EAAAA,IAACS,EAAA,CAAG,GAAGX,CAAA,CAAW,CAAA,EAGlCY,EAAW,CACb,OAAQ,yDACR,KAAM,+DACN,QAAS,uEACT,QAAS,2EACT,MAAO,2EACP,KAAM,2EACN,QAAS,uEACT,iBAAkB,uEAClB,iBAAkB,8DAAA,EAGtB,aACK,MAAA,CAAI,UAAW,sBAAsBA,EAASb,CAAI,GAAK,2BAA2B,GAC9E,SAAAE,EAAQF,CAAI,GAAKG,EAAAA,IAACW,EAAA,CAAK,KAAM,GAAI,EACtC,CAER,EAKMC,GAAcC,GAAO,CACvB,GAAI,CAACA,EAAI,MAAO,GAChB,MAAMC,EAAOD,EAAG,SAAW,IAAI,KAAKA,EAAG,UAAU,EAAI,IAAI,KAAKA,CAAE,EAE1DE,MADU,KACKD,EACfE,EAAW,KAAK,MAAMD,EAAS,GAAK,EACpCE,EAAY,KAAK,MAAMD,EAAW,EAAE,EACpCE,EAAW,KAAK,MAAMD,EAAY,EAAE,EAE1C,OAAID,EAAW,EAAU,WACrBA,EAAW,GAAW,GAAGA,CAAQ,IACjCC,EAAY,GAAW,GAAGA,CAAS,IACnCC,EAAW,EAAU,GAAGA,CAAQ,IAC7BJ,EAAK,mBAAA,CAChB,EAKMK,GAAmB,CAAC,CACtB,aAAAC,EACA,aAAAC,EACA,SAAAC,EACA,YAAAC,EACA,YAAAC,EACA,gBAAAC,CACJ,IAAM,CACF,KAAM,CAACC,EAAeC,CAAgB,EAAIC,EAAAA,SAAS,IAAI,EAEjDC,EAAc,IAAM,CACjBT,EAAa,MACdC,EAAaD,EAAa,EAAE,EAI5BA,EAAa,OAAS,UAAYG,EAClCA,EAAYH,EAAa,UAAU,EAC5BA,EAAa,QAAUI,GAC9BA,EAAYJ,EAAa,MAAM,CAEvC,EAEMU,EAAsB,MAAOC,EAAGC,IAAW,CAE7C,GADAD,EAAE,gBAAA,EACE,EAACX,EAAa,UAElB,CAAAO,EAAiBK,CAAM,EACvB,GAAI,CACA,MAAMP,EAAgBL,EAAa,UAAWY,EAAQZ,EAAa,EAAE,EACrEa,EAAM,QAAQD,IAAW,SAAW,oBAAsB,kBAAkB,CAChF,OAASE,EAAK,CACVD,EAAM,MAAM,0BAA0B,EACtC,QAAQ,MAAMC,CAAG,CACrB,CACAP,EAAiB,IAAI,EACzB,EAEMQ,EAAwBf,EAAa,OAAS,WAAaA,EAAa,WAAa,CAACA,EAAa,YAEzG,OACIgB,EAAAA,KAACC,EAAO,IAAP,CACG,QAAS,CAAE,QAAS,EAAG,EAAG,GAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,KAAM,CAAE,QAAS,EAAG,EAAG,EAAA,EACvB,UAAW;AAAA;AAAA;AAAA,kBAGLjB,EAAa,KACT,0CACA,8EACN;AAAA,cAEJ,QAASS,EAGT,SAAA,CAAAO,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACX,SAAA,CAAApC,EAAAA,IAACsC,EAAA,CACG,IAAKlB,EAAa,cAClB,KAAMA,EAAa,aACnB,KAAK,IAAA,CAAA,EAETpB,EAAAA,IAAC,OAAI,UAAU,8BACX,eAACJ,GAAA,CAAiB,KAAMwB,EAAa,IAAA,CAAM,CAAA,CAC/C,CAAA,EACJ,EAGAgB,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACX,SAAA,CAAAA,EAAAA,KAAC,IAAA,CAAE,UAAU,0CACT,SAAA,CAAApC,EAAAA,IAAC,OAAA,CAAK,UAAU,oDACX,SAAAoB,EAAa,aAClB,EACC,IACDpB,EAAAA,IAAC,OAAA,CAAK,UAAU,mCACX,WAAa,OAAA,CAClB,CAAA,EACJ,QACC,OAAA,CAAK,UAAU,uDACX,SAAAY,GAAWQ,EAAa,SAAS,CAAA,CACtC,CAAA,EACJ,EAGCA,EAAa,aACVgB,OAAC,IAAA,CAAE,UAAU,4GAA4G,SAAA,CAAA,IACnHhB,EAAa,YAAY,GAAA,EAC/B,EAIHe,GAAyBf,EAAa,gBACnCgB,EAAAA,KAAC,MAAA,CAAI,UAAU,yEACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,2DACV,SAAA,CAAAhB,EAAa,eAAe,MACzBgB,EAAAA,KAAC,OAAA,CAAK,UAAU,0BACZ,SAAA,CAAApC,EAAAA,IAACuC,GAAA,CAAM,KAAM,EAAA,CAAI,EAAE,IAAEnB,EAAa,eAAe,IAAA,EACrD,EAEHA,EAAa,eAAe,QACzBgB,EAAAA,KAAC,OAAA,CAAK,UAAU,uEACZ,SAAA,CAAApC,EAAAA,IAACwC,GAAA,CAAW,KAAM,EAAA,CAAI,EAAE,KAAGpB,EAAa,eAAe,MAAA,CAAA,CAC3D,CAAA,EAER,EACCA,EAAa,eAAe,aACzBpB,EAAAA,IAAC,QAAK,UAAU,4EACX,SAAAoB,EAAa,eAAe,WAAA,CACjC,CAAA,EAER,EAIHe,UACI,MAAA,CAAI,UAAU,kBAAkB,QAASJ,GAAKA,EAAE,gBAAA,EAC7C,SAAA,CAAA/B,EAAAA,IAAC,SAAA,CACG,QAAU+B,GAAMD,EAAoBC,EAAG,QAAQ,EAC/C,SAAUL,EACV,UAAU,mKAET,SAAAA,IAAkB,SACf1B,EAAAA,IAACyC,EAAA,CAAQ,KAAM,GAAI,UAAU,cAAA,CAAe,EAE5CL,EAAAA,KAAAM,EAAAA,SAAA,CAAE,SAAA,CAAA1C,EAAAA,IAACQ,EAAA,CAAM,KAAM,EAAA,CAAI,EAAE,SAAA,CAAA,CAAO,CAAA,CAAA,EAGpCR,EAAAA,IAAC,SAAA,CACG,QAAU+B,GAAMD,EAAoBC,EAAG,SAAS,EAChD,SAAUL,EACV,UAAU,+NAET,SAAAA,IAAkB,UACf1B,EAAAA,IAACyC,EAAA,CAAQ,KAAM,GAAI,UAAU,cAAA,CAAe,EAE5CL,EAAAA,KAAAM,EAAAA,SAAA,CAAE,SAAA,CAAA1C,EAAAA,IAACS,EAAA,CAAE,KAAM,EAAA,CAAI,EAAE,UAAA,CAAA,CAAQ,CAAA,CAAA,CAEjC,EACJ,EAIH,CAACW,EAAa,MACXpB,EAAAA,IAAC,MAAA,CAAI,UAAU,8EAAA,CAA+E,CAAA,EAEtG,EAGAA,EAAAA,IAAC,SAAA,CACG,QAAU+B,GAAM,CACZA,EAAE,gBAAA,EACFT,EAASF,EAAa,EAAE,CAC5B,EACA,UAAU,uJAEV,SAAApB,EAAAA,IAACS,EAAA,CAAE,KAAM,EAAA,CAAI,CAAA,CAAA,CACjB,CAAA,CAAA,CAGZ,EAKA,SAAwBkC,GAAmB,CACvC,cAAAC,EACA,YAAAC,EACA,QAAAC,EACA,aAAAzB,EACA,gBAAA0B,EACA,qBAAAC,EACA,WAAAC,EACA,YAAA1B,EACA,YAAAC,EACA,gBAAAC,EACA,QAAAyB,CACJ,EAAG,CACC,OACId,EAAAA,KAAC,MAAA,CAAI,UAAU,oMAEX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,wGACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACX,SAAA,CAAApC,EAAAA,IAAC,KAAA,CAAG,UAAU,oCAAoC,SAAA,gBAAa,EAC9D6C,EAAc,GACX7C,EAAAA,IAAC,OAAA,CAAK,UAAU,oFACX,SAAA6C,CAAA,CACL,CAAA,EAER,EAECA,EAAc,GACXT,EAAAA,KAAC,SAAA,CACG,QAASW,EACT,UAAU,6FAEV,SAAA,CAAA/C,EAAAA,IAACmD,GAAA,CAAW,KAAM,EAAA,CAAI,EAAE,eAAA,CAAA,CAAA,CAE5B,EAER,EAGAnD,EAAAA,IAAC,OAAI,UAAU,iDACV,WACGoC,EAAAA,KAAC,MAAA,CAAI,UAAU,kBACX,SAAA,CAAApC,EAAAA,IAAC,MAAA,CAAI,UAAU,gGAAA,CAAiG,EAChHA,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,YAAA,CAAU,CAAA,EACnD,EACA4C,EAAc,SAAW,EACzBR,OAAC,MAAA,CAAI,UAAU,2DACX,SAAA,CAAApC,EAAAA,IAAC,MAAA,CAAI,UAAU,4FACX,SAAAA,EAAAA,IAACW,GAAK,KAAM,GAAI,UAAU,YAAA,CAAa,CAAA,CAC3C,EACAX,EAAAA,IAAC,IAAA,CAAE,UAAU,yCAAyC,SAAA,iBAAc,EACpEA,EAAAA,IAAC,IAAA,CAAE,UAAU,6BAA6B,SAAA,sBAAA,CAAoB,CAAA,CAAA,CAClE,EAEAA,EAAAA,IAACoD,GAAA,CAAgB,KAAK,YACjB,SAAAR,EAAc,IAAIxB,GACfpB,EAAAA,IAACmB,GAAA,CAEG,aAAAC,EACA,aAAAC,EACA,SAAU2B,EACV,YAAAzB,EACA,YAAAC,EACA,gBAAAC,CAAA,EANKL,EAAa,EAAA,CAQzB,EACL,CAAA,CAER,EAGCwB,EAAc,OAAS,GACpBR,EAAAA,KAAC,MAAA,CAAI,UAAU,mGACX,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACG,QAASa,EACT,UAAU,qJAEV,SAAA,CAAAjD,EAAAA,IAACqD,GAAA,CAAO,KAAM,EAAA,CAAI,EAAE,WAAA,CAAA,CAAA,EAGxBrD,EAAAA,IAAC,SAAA,CACG,QAASkD,EACT,UAAU,2IACb,SAAA,OAAA,CAAA,CAED,CAAA,CACJ,CAAA,EAER,CAER,CAKO,SAASI,GAAkB,CAAE,MAAAC,GAAS,CACzC,OAAIA,IAAU,EAAU,KAGpBvD,EAAAA,IAACqC,EAAO,KAAP,CACG,QAAS,CAAE,MAAO,CAAA,EAClB,QAAS,CAAE,MAAO,CAAA,EAClB,UAAU,2LAET,SAAAkB,EAAQ,GAAK,MAAQA,CAAA,CAAA,CAGlC,CCtVA,SAAwBC,GAAO,CAC3B,KAAAC,EACA,SAAAC,EACA,YAAAC,EACA,SAAAC,EACA,YAAAC,EACA,UAAAC,EACA,aAAAC,EACA,YAAAC,EACA,aAAAC,EACA,kBAAAC,CACJ,EAAG,OACD,KAAM,CAACC,EAAYC,CAAa,EAAIxC,EAAAA,SAAS,EAAK,EAC5C,CAACyC,EAAcC,CAAe,EAAI1C,EAAAA,SAAS,EAAK,EAChD,CAAC2C,EAAaC,CAAc,EAAI5C,EAAAA,SAAS,EAAK,EAC9C6C,EAAWC,EAAAA,OAAO,IAAI,EACtBC,EAAUD,EAAAA,OAAO,IAAI,EAGrB,CACJ,cAAA9B,EACA,YAAAC,EACA,QAAS+B,EACT,WAAAC,EACA,cAAAC,EACA,mBAAAC,EACA,SAAAC,CAAA,EACEC,IAAiBxB,GAAA,YAAAA,EAAM,MAAMA,GAAA,YAAAA,EAAM,IAAG,EAEpCyB,GAAaxB,GAAA,YAAAA,EAAU,sBAAqByB,EAAAzB,GAAA,YAAAA,EAAU,eAAV,YAAAyB,EAAyB,KAAM,OAC3EC,EAAcC,GAAe3B,CAAQ,EACrC4B,GAAQ5B,GAAA,YAAAA,EAAU,eAAgB,CAAA,EAElC6B,EAAW,CAAC,UAAW,WAAY,SAAU,UAAU,EACvDC,EAAeF,EAAM,QAAUC,EAAS,SAASE,CAAC,CAAC,EACnDC,EAAW5B,EAAU,WAAW,KAAK,EAErC6B,EAAkBC,GAAS,CAC7B,GAAI,CAACA,GAAQA,IAAS,QAAUA,IAAS,OAASA,IAAS,OACvD,OAAOlC,GAAA,YAAAA,EAAU,wBAAwBA,GAAA,YAAAA,EAAU,YAAa,OAEpE,MAAMmC,EAAMlC,GAAA,YAAAA,EAAciC,GAC1B,OAAOC,GAAA,YAAAA,EAAK,eAAenC,GAAA,YAAAA,EAAU,wBAAwBA,GAAA,YAAAA,EAAU,YAAa,MACxF,EAEMoC,EAAqBH,EAAeT,CAAU,EAE9Ca,EAAiB,IAAM,CAErBhC,EADAmB,IAAe,UACF,cACNA,IAAe,SACT,aAEA,cAJa,CAMlC,EAEAc,EAAAA,UAAU,IAAM,CACZ,GAAId,EAAY,CACZV,EAAe,EAAK,EACpB,sBAAsB,IAAM,CACxB,sBAAsB,IAAM,CACxBA,EAAe,EAAI,CACvB,CAAC,CACL,CAAC,EACD,MAAMyB,EAAQ,WAAW,IAAMzB,EAAe,EAAK,EAAG,GAAG,EACzD,MAAO,IAAM,aAAayB,CAAK,CACnC,CACJ,EAAG,CAACf,CAAU,CAAC,EAEfc,EAAAA,UAAU,IAAM,CACd,SAASE,EAAmBC,EAAO,CAC7B1B,EAAS,SAAW,CAACA,EAAS,QAAQ,SAAS0B,EAAM,MAAM,GAC7D/B,EAAc,EAAK,EAEjBO,EAAQ,SAAW,CAACA,EAAQ,QAAQ,SAASwB,EAAM,MAAM,GAC3D7B,EAAgB,EAAK,CAEzB,CACA,gBAAS,iBAAiB,YAAa4B,CAAkB,EAClD,IAAM,SAAS,oBAAoB,YAAaA,CAAkB,CAC3E,EAAG,CAACzB,EAAUE,CAAO,CAAC,EAEtB,MAAMyB,EAAwBC,GAAW,CACrCjC,EAAc,EAAK,EACfF,GACAA,EAAkBmC,CAAM,CAEhC,EAEMC,EAAwBC,GAAW,CACrCnC,EAAc,EAAK,EACnBL,EAAa,MAAM,CACvB,EAGMjC,EAAsB,MAAO0E,EAAWxE,EAAQyE,IAAmB,CACrE,GAAI,CACA,GAAI,CAACC,EAAU,MAAM,IAAI,MAAM,0BAA0B,EAGzD,KAAM,CAAE,MAAOC,GAAiB,MAAMD,EACjC,KAAK,UAAU,EACf,OAAO,CACJ,OAAQ1E,IAAW,SAAW,YAAc,WAC5C,aAAc,IAAI,KAAA,EAAO,YAAA,CAAY,CACxC,EACA,GAAG,KAAMwE,CAAS,EAEvB,GAAIG,EAAc,MAAMA,EAGxB,GAAIF,IAAmBhD,GAAA,MAAAA,EAAM,IAAMA,GAAA,MAAAA,EAAM,KAAM,CAC3C,MAAM4C,IAAS5C,GAAA,YAAAA,EAAM,MAAMA,GAAA,YAAAA,EAAM,KAC3B,CAAE,MAAOmD,GAAe,MAAMF,EAC/B,KAAK,eAAe,EACpB,OAAO,CACJ,aAAc1E,EACd,KAAM,GACN,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,CACtC,EACA,GAAG,KAAMyE,CAAc,EACvB,GAAG,UAAWJ,EAAM,EAEzB,GAAIO,EAAY,MAAMA,CAC1B,CACJ,OAASC,EAAO,CACZ,cAAQ,MAAM,yBAA0BA,CAAK,EACvCA,CACV,CACJ,EAEMC,EAAoBlB,GAAS,CAC3B3B,KAA2B2B,CAAI,EACnCtB,EAAgB,EAAK,CACzB,EAcA,OACElC,EAAAA,KAAAM,WAAA,CACE,SAAA,CAAA1C,EAAAA,IAAC,MAAA,CACC,UAAW;AAAA;AAAA,YAEPuE,EAAc,oDAAsD,wCAAwC;AAAA,SAAA,CAAA,EAIlHnC,EAAAA,KAAC,MAAA,CAAI,UAAU,kJACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAApC,EAAAA,IAAC,SAAA,CACG,QAASgE,EACT,UAAU,2GACV,aAAW,uBACX,gBAAc,QAEd,SAAAhE,EAAAA,IAAC+G,GAAA,CAAK,KAAM,GAAI,cAAY,MAAA,CAAO,CAAA,CAAA,EAGvC/G,MAAC,OAAI,UAAU,yCAAyC,QAAS,IAAI+D,EAAa,WAAW,EACzF,SAAA/D,EAAAA,IAAC,MAAA,CACC,IAAK4D,EAAWoD,GAAYC,GAC5B,IAAI,cACJ,UAAU,2DAAA,CAAA,CACZ,CACJ,CAAA,EACF,EAEA7E,EAAAA,KAAC,MAAA,CAAI,UAAU,mCAEZ,SAAA,CAAAoD,GACGpD,EAAAA,KAAC,MAAA,CAAI,UAAU,sGACX,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACG,QAAS,IAAM2B,EAAa,WAAW,EACvC,UAAW,mFAAoF2B,EAAmF,gFAAxE,qEAAuJ,GAEjQ,SAAA,CAAA1F,EAAAA,IAACkH,GAAA,CAAO,KAAM,EAAA,CAAG,EAAE,SAAA,CAAA,CAAA,EAEvB9E,EAAAA,KAAC,SAAA,CACG,QAAS2D,EACT,UAAW,mFAAmFL,EAAW,sEAAwE,+EAA+E,GAEhQ,SAAA,CAAA1F,EAAAA,IAACmH,GAAA,CAAc,KAAM,EAAA,CAAG,EAAE,YAAA,CAAA,CAAA,CAC9B,EACJ,EAGH7B,EAAM,OAAS,GACZlD,EAAAA,KAAC,OAAI,UAAU,6CAA6C,IAAKuC,EAC7D,SAAA,CAAAvC,EAAAA,KAAC,SAAA,CACG,QAAS,IAAMkC,EAAgB,CAACD,CAAY,EAC5C,UAAU,uOAEV,SAAA,CAAArE,EAAAA,IAACoH,GAAA,CAAU,KAAM,GAAI,UAAW,iDAAiD7C,EAAc,0BAA4B,EAAE,EAAA,CAAG,EAChIvE,EAAAA,IAAC,QAAM,SAAAoF,CAAA,CAAY,EACnBpF,EAAAA,IAACqH,IAAY,KAAM,GAAI,UAAW,iCAAiChD,EAAe,aAAe,EAAE,EAAA,CAAG,CAAA,CAAA,CAAA,EAG1GjC,EAAAA,KAAC,MAAA,CAAI,UAAU,8BACX,SAAA,CAAApC,EAAAA,IAAC,OAAA,CAAK,UAAU,wCAAwC,SAAA,aAAU,EAClEA,EAAAA,IAAC,OAAA,CAAK,UAAU,2DAA4D,SAAA8F,CAAA,CAAmB,CAAA,EACnG,EAECzB,GACGjC,EAAAA,KAAC,MAAA,CAAI,UAAU,0LACX,SAAA,CAAApC,EAAAA,IAAC,MAAA,CAAI,UAAU,iEACX,SAAAA,EAAAA,IAAC,QAAK,UAAU,oEAAoE,kCAAsB,CAAA,CAC9G,QACC,MAAA,CAAI,UAAU,MACV,SAAAsF,EAAM,IAAIM,GAAQ,CACf,MAAM0B,EAAO3B,EAAeC,CAAI,EAChC,OACIxD,EAAAA,KAAC,SAAA,CAEG,QAAS,IAAM0E,EAAiBlB,CAAI,EACpC,UAAW,0GAA0GV,IAAeU,EAAO,iDAAmD,0EAA0E,GAExQ,SAAA,CAAAxD,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACX,SAAA,CAAApC,EAAAA,IAAC,QAAM,SAAAsH,CAAA,CAAK,EACZtH,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAAgD,SAAA4F,CAAA,CAAK,CAAA,EACzE,EACCV,IAAeU,GAAQ5F,EAAAA,IAAC,MAAA,CAAI,UAAU,wCAAA,CAAyC,CAAA,CAAA,EAR3E4F,CAAA,CAWjB,CAAC,CAAA,CACL,CAAA,CAAA,CACJ,CAAA,EAER,EAGJ5F,EAAAA,IAAC,SAAA,CACC,QAAS6D,EACT,UAAU,6FACV,aAAYD,EAAW,uBAAyB,sBAChD,MAAOA,EAAW,uBAAyB,sBAE1C,SAAAA,EAAW5D,EAAAA,IAACuH,GAAA,CAAI,KAAM,GAAI,cAAY,MAAA,CAAO,EAAKvH,EAAAA,IAACwH,GAAA,CAAK,KAAM,GAAI,cAAY,MAAA,CAAO,CAAA,CAAA,EAGxFpF,EAAAA,KAAC,MAAA,CAAI,UAAU,WAAW,IAAKqC,EAC3B,SAAA,CAAArC,EAAAA,KAAC,SAAA,CACG,UAAW,kHAAkH+B,EAAa,+CAAiD,EAAE,GAC7L,QAAS,IAAMC,EAAc,CAACD,CAAU,EACxC,aAAY,gBAAgBtB,EAAc,EAAI,KAAKA,CAAW,WAAa,EAAE,GAC7E,gBAAesB,EAEf,SAAA,CAAAnE,EAAAA,IAACW,EAAA,CAAK,KAAM,GAAI,cAAY,OAAO,EACnCX,EAAAA,IAACsD,GAAA,CAAkB,MAAOT,CAAA,CAAa,CAAA,CAAA,CAAA,EAG1CsB,GACGnE,EAAAA,IAAC2C,GAAA,CACG,cAAAC,EACA,YAAAC,EACA,QAAS+B,EACT,aAAcC,EACd,gBAAiBC,EACjB,qBAAsBC,EACtB,WAAYC,EACZ,YAAaoB,EACb,YAAaE,EACb,gBAAiBxE,EACjB,QAAS,IAAMsC,EAAc,EAAK,CAAA,CAAA,CACtC,EAER,EAGApE,EAAAA,IAACsC,EAAA,CACG,IAAKoB,GAAA,YAAAA,EAAU,SACf,KAAMoC,EACN,KAAK,KACL,UAAU,iEACV,QAAS,IAAM/B,EAAa,SAAS,CAAA,CAAA,CACzC,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}