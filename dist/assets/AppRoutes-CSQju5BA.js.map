{"version":3,"mappings":"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","names":["retryLazyLoad","importFn","retries","delay","lazy","resolve","reject","attempt","attemptNumber","promise","module","error","DebugReport","SettingsTab","ClientPortal","__vitePreload","ProtectedRoute","children","loading","isLoaded","isSignedIn","useAuth","navigate","useNavigate","useEffect","jsx","Loader2","AppRoutes","user","userData","darkMode","toggleTheme","handleLogout","userId","Routes","Route","Suspense","newSettings","updateProfile","err","newRole","Navigate"],"ignoreList":[],"sources":["../../src/routes/AppRoutes.jsx"],"sourcesContent":["import React, { lazy, Suspense, useEffect } from 'react';\nimport { Routes, Route, useNavigate, useLocation, Navigate } from 'react-router-dom';\nimport { useAuth } from '@clerk/clerk-react';\nimport { Loader2 } from 'lucide-react';\nimport { updateProfile } from '../config/neonQueries';\n\n// Retry wrapper for lazy loading to handle network errors and failed imports\nconst retryLazyLoad = (importFn, retries = 3, delay = 100) => {\n  return lazy(() => {\n    return new Promise((resolve, reject) => {\n      const attempt = (attemptNumber) => {\n        // Wrap in try-catch to handle synchronous errors\n        try {\n          const promise = importFn();\n          // If it's already a promise, handle it\n          if (promise && typeof promise.then === 'function') {\n            promise\n              .then((module) => {\n                // Ensure we get the default export\n                resolve(module.default ? module : { default: module });\n              })\n              .catch((error) => {\n                if (attemptNumber < retries) {\n                  console.warn(`Lazy load failed, retrying... (${attemptNumber + 1}/${retries})`, error);\n                  setTimeout(() => attempt(attemptNumber + 1), delay * (attemptNumber + 1));\n                } else {\n                  console.error('Lazy load failed after retries:', error);\n                  reject(error);\n                }\n              });\n          } else {\n            resolve(promise);\n          }\n        } catch (error) {\n          // Handle synchronous errors (like circular dependencies)\n          if (attemptNumber < retries) {\n            console.warn(`Lazy load sync error, retrying... (${attemptNumber + 1}/${retries})`, error);\n            setTimeout(() => attempt(attemptNumber + 1), delay * (attemptNumber + 1));\n          } else {\n            console.error('Lazy load failed after retries (sync error):', error);\n            reject(error);\n          }\n        }\n      };\n      attempt(0);\n    });\n  });\n};\n\n// Lazy load components to avoid circular dependencies with retry mechanism\n// Note: Dashboard is handled by MainLayout, not needed here\nconst DebugReport = retryLazyLoad(() => import('../components/DebugReport'));\nconst ProfileManager = retryLazyLoad(() => import('../components/ProfileManager'));\nconst SettingsTab = retryLazyLoad(() => import('../components/SettingsTab'));\nconst ClientPortal = retryLazyLoad(() => import('../components/studio/portal/ClientPortal'));\n\n/**\n * Protected Route Wrapper\n *\n * Protects routes and redirects to login if user is not authenticated\n * Uses Clerk auth instead of Supabase\n */\nfunction ProtectedRoute({ children, loading }) {\n  const { isLoaded, isSignedIn } = useAuth();\n  const navigate = useNavigate();\n\n  // Check if user is authenticated - use useEffect to navigate to avoid initialization issues\n  // NOTE: This must be called before any conditional returns to satisfy React's rules of hooks\n  useEffect(() => {\n    if (isLoaded && !isSignedIn && !loading) {\n      navigate('/login', { replace: true });\n    }\n  }, [isLoaded, isSignedIn, loading, navigate]);\n\n  // Show loading while checking auth\n  if (!isLoaded || loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"animate-spin text-brand-blue\" size={32} />\n      </div>\n    );\n  }\n\n  // Don't render children if user is not authenticated\n  if (!isSignedIn) {\n    return null;\n  }\n\n  return children;\n}\n\n/**\n * Redirect Component\n *\n * Uses useNavigate hook instead of Navigate component to avoid initialization issues\n */\nfunction Redirect({ to, replace = true }) {\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  useEffect(() => {\n    if (location.pathname !== to) {\n      navigate(to, { replace });\n    }\n  }, [to, replace, navigate, location.pathname]);\n\n  return null;\n}\n\n/**\n * AppRoutes - Full routing with all modules\n * MainLayout handles these routes internally via activeTab with URL-based navigation\n * Now uses Clerk authentication instead of Supabase\n * Note: / is now a redirect to /dashboard for better breadcrumb navigation\n */\nexport default function AppRoutes({ user, userData, loading, darkMode, toggleTheme, handleLogout }) {\n  const { userId } = useAuth();\n\n  return (\n    <Routes>\n      {/* MainLayout handles these routes internally via activeTab with URL sync */}\n      {/* Dashboard and all main modules are handled by MainLayout */}\n      {/* Support nested routes for better URL navigation */}\n      <Route path=\"/dashboard\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/feed\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/feed/discover\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/messages\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/bookings\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/bookings/my-bookings\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/bookings/calendar\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/bookings/find-talent\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/bookings/broadcast-list\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/marketplace\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/tech\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/payments\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/profile\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/business-center\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/legal\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-student\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-intern\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-overview\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-admin\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/studio-ops\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/labels\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/labels/dashboard\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/labels/contracts\" element={<ProtectedRoute loading={loading}><div /></ProtectedRoute>} />\n\n      {/* Debug Report Route - Test login destination */}\n      <Route\n        path=\"/debug-report\"\n        element={\n          <ProtectedRoute loading={loading}>\n            <Suspense fallback={<div className=\"flex items-center justify-center min-h-screen\"><Loader2 className=\"animate-spin text-brand-blue\" size={32} /></div>}>\n              <DebugReport\n                user={user}\n                userData={userData}\n              />\n            </Suspense>\n          </ProtectedRoute>\n        }\n      />\n\n      {/* Settings Route - Uses direct route with Neon queries */}\n      <Route\n        path=\"/settings\"\n        element={\n          <ProtectedRoute loading={loading}>\n            <Suspense fallback={<div className=\"flex items-center justify-center min-h-screen\"><Loader2 className=\"animate-spin text-brand-blue\" size={32} /></div>}>\n              <SettingsTab\n              user={user}\n              userData={userData}\n              onUpdate={async (newSettings) => {\n                // Save settings to database using Neon\n                if (userId) {\n                  try {\n                    await updateProfile(userId, {\n                      settings: newSettings,\n                    });\n                    console.log('Settings saved successfully');\n                  } catch (err) {\n                    console.error('Settings save failed:', err);\n                  }\n                }\n              }}\n              onRoleSwitch={async (newRole) => {\n                // Role switch - update active role in database using Neon\n                if (userId) {\n                  try {\n                    await updateProfile(userId, {\n                      active_role: newRole,\n                    });\n                    console.log('Role switched to:', newRole);\n                    // Reload page to reflect changes\n                    window.location.reload();\n                  } catch (err) {\n                    console.error('Role switch failed:', err);\n                  }\n                }\n              }}\n            />\n            </Suspense>\n          </ProtectedRoute>\n        }\n      />\n\n      {/* Client Portal Route - Self-service client portal */}\n      <Route\n        path=\"/studio/:studioId/portal\"\n        element={\n          <ProtectedRoute loading={loading}>\n            <Suspense fallback={<div className=\"flex items-center justify-center min-h-screen\"><Loader2 className=\"animate-spin text-brand-blue\" size={32} /></div>}>\n              <ClientPortal\n                user={user}\n                userData={userData}\n              />\n            </Suspense>\n          </ProtectedRoute>\n        }\n      />\n\n      {/* Redirect root to dashboard */}\n      <Route path=\"/\" element={<Navigate to=\"/dashboard\" replace />} />\n\n      {/* Redirect dashboard aliases */}\n      <Route path=\"/home\" element={<Navigate to=\"/dashboard\" replace />} />\n      <Route path=\"/social\" element={<Navigate to=\"/feed\" replace />} />\n      <Route path=\"/chat\" element={<Navigate to=\"/messages\" replace />} />\n      <Route path=\"/billing\" element={<Navigate to=\"/payments\" replace />} />\n\n      {/* Fallback - redirect to dashboard */}\n      <Route path=\"*\" element={<Navigate to=\"/dashboard\" replace />} />\n    </Routes>\n  );\n}\n"],"file":"assets/AppRoutes-CSQju5BA.js"}