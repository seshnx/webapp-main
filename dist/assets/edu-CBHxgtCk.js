import{r as l,j as e,a0 as Y,a1 as K,S as ae,h as re,s as ge,U as Ce,W as me,a2 as Ae,J as Ee,a3 as Re,H as Le,a4 as Ue,T as Q,X as Oe,a5 as Ge,D as Be,a6 as He,a7 as he,a8 as ie,P as Z,m as qe,a9 as Ve,$ as Pe,aa as Ie,v as We,a as Te,ab as ye,E as Ke,g as Je,ac as ce,ad as Ye,ae as $e,af as De,z as ze,ag as Xe,ah as Qe,ai as Ze,aj as et,ak as je,al as ke,am as tt,an as st,ao as at,ap as Ne,aq as rt,L as ve}from"./vendor-n9-r8Sqr.js";import{B as te,A as $,G as it,q as G,C as A,w as D,k as z,E as O,H,I as F,r as lt,u as nt,h as dt,F as _e,J as ot,D as ct,K as J,L as ue,M as ee,j as xt}from"./vendor-firebase-Dw9JHIsS.js";import{d as N,g as se,s as we,S as de}from"./chat-Djic-j48.js";const Fe=l.createContext();function le(){return l.useContext(Fe)}function Tt({children:a,user:r,userData:t}){var C;const[c,d]=l.useState(null),[g,u]=l.useState(null),[o,x]=l.useState(null),[i,s]=l.useState([]),[n,j]=l.useState(null),[y,p]=l.useState("GUEST"),[f,v]=l.useState(!0),h=(b={})=>{var L,T,B,U;const S=!!b.schoolId;return b.user?S?(L=b.accountTypes)!=null&&L.includes("Admin")?"ADMIN":(T=b.accountTypes)!=null&&T.includes("Instructor")||b.staffProfile?"INSTRUCTOR":(B=b.accountTypes)!=null&&B.includes("Intern")?"INTERN":(U=b.accountTypes)!=null&&U.includes("Student")||b.studentProfile?"STUDENT":"UNVERIFIED":"UNVERIFIED":"GUEST"};l.useEffect(()=>{if(!r){d(null),u(null),x(null),s([]),j(null),p("GUEST"),v(!1);return}if(!(t!=null&&t.schoolId)){d(null),u(null),x(null),s([]),j(null),p("UNVERIFIED"),v(!1);return}te($(N,"schools",t.schoolId)).then(S=>{S.exists()&&d(S.data())}).catch(S=>console.error("Error fetching school data:",S)),(async()=>{var S,L,T,B;try{let U=null,k=null,P=[];if((S=t.accountTypes)!=null&&S.includes("Student")||(L=t.accountTypes)!=null&&L.includes("Intern")){const I=se(r.uid).studentRecord(t.schoolId,r.uid);it($(N,I),async _=>{if(_.exists()){const M=_.data();if(u(M),U=M,M.internshipStudioId){const q=await te($(N,`schools/${t.schoolId}/partners/${M.internshipStudioId}`));if(q.exists())j(q.data());else{const V=await te($(N,"studios",M.internshipStudioId));V.exists()&&j(V.data())}}p(h({user:r,schoolId:t.schoolId,accountTypes:t.accountTypes,studentProfile:M,staffProfile:k}))}})}if((T=t.accountTypes)!=null&&T.includes("Instructor")||(B=t.accountTypes)!=null&&B.includes("Admin")){const I=G(A(N,`schools/${t.schoolId}/staff`),D("uid","==",r.uid)),_=await z(I);if(!_.empty){const M=_.docs[0].data();if(x(M),k=M,M.roleId){const q=await te($(N,`schools/${t.schoolId}/roles/${M.roleId}`));if(q.exists()){const V=q.data().permissions||[];s(V),P=V}}else t.accountTypes.includes("Admin")&&(s(["ALL"]),P=["ALL"])}}}catch(U){console.error("Error setting up school context:",U)}finally{p(h({user:r,schoolId:t.schoolId,accountTypes:t.accountTypes,studentProfile:g,staffProfile:o})),v(!1)}})()},[r,t]);const m=async(b,S="remote")=>{if(!(!g||!t.schoolId))try{const L=A(N,`schools/${t.schoolId}/internship_logs`),T=await F(L,{studentId:r.uid,studentName:t.displayName||"Unknown",checkIn:H(),checkOut:null,location:b||"Unknown",type:S,status:"active",description:""}),B=se(r.uid).studentRecord(t.schoolId,r.uid);await O($(N,B),{activeSessionId:T.id,isClockedIn:!0})}catch(L){throw console.error("Check-in failed:",L),L}},w=async b=>{if(!(!(g!=null&&g.activeSessionId)||!t.schoolId))try{const S=`schools/${t.schoolId}/internship_logs/${g.activeSessionId}`;await O($(N,S),{checkOut:H(),status:"pending_approval",description:b||"No description"});const L=se(r.uid).studentRecord(t.schoolId,r.uid);await O($(N,L),{activeSessionId:null,isClockedIn:!1})}catch(S){throw console.error("Check-out failed:",S),S}},E={schoolId:t==null?void 0:t.schoolId,schoolData:c,studentProfile:g,staffProfile:o,myPermissions:i,internshipStudio:n,eduRole:y,isStudent:!!g,isStaff:!!o||((C=t==null?void 0:t.accountTypes)==null?void 0:C.includes("Admin")),checkIn:m,checkOut:w,loading:f};return l.useEffect(()=>{p(h({user:r,schoolId:t==null?void 0:t.schoolId,accountTypes:t==null?void 0:t.accountTypes,studentProfile:g,staffProfile:o}))},[r,t==null?void 0:t.schoolId,JSON.stringify((t==null?void 0:t.accountTypes)||[]),g,o]),e.jsx(Fe.Provider,{value:E,children:a})}const $t=["Artist","Musician","Engineer","Producer","Composer","Studio","Technician","Fan","Student","Instructor","Label","Agent"],zt={FREE:"FREE"},_t=["Xfer Serum","NI Massive","Sylenth1","FabFilter Pro-Q 3","Valhalla VintageVerb","RC-20 Retro Color","Omnisphere","Kontakt","Auto-Tune","Soundtoys Decapitator","Waves CLA-2A","SerumFX","Vital","Diva"],Ft=[{id:"single",label:"Single",maxTracks:1},{id:"ep",label:"EP",maxTracks:6},{id:"album",label:"Album",maxTracks:100}],Mt=[{id:"spotify",name:"Spotify",icon:"spotify"},{id:"apple",name:"Apple Music",icon:"apple"},{id:"tiktok",name:"TikTok / Resso",icon:"music"},{id:"instagram",name:"Instagram & Facebook",icon:"instagram"},{id:"youtube",name:"YouTube Music",icon:"youtube"},{id:"amazon",name:"Amazon Music",icon:"shopping-cart"},{id:"tidal",name:"Tidal",icon:"music"},{id:"deezer",name:"Deezer",icon:"music"},{id:"soundcloud",name:"SoundCloud",icon:"cloud"}],Ut=["Alternative","Blues","Children's Music","Christian & Gospel","Classical","Comedy","Country","Dance","Electronic","Fitness & Workout","Folk","Hip Hop/Rap","Holiday","Indie Pop","Instrumental","Jazz","K-Pop","Latin","Metal","New Age","Pop","R&B/Soul","Reggae","Rock","Singer/Songwriter","Soundtrack","Spoken Word","World"],xe=[{id:"manage_roster",label:"Manage Roster",description:"Add, remove, or edit student details."},{id:"manage_enrollment",label:"Admissions",description:"Process applications and handle intake."},{id:"approve_hours",label:"Approve Hours",description:"Verify and approve internship time logs."},{id:"manage_partners",label:"Manage Partners",description:"Add or edit approved internship studios."},{id:"grade_students",label:"Grading",description:"Submit technical and soft-skill evaluations."},{id:"post_announcements",label:"Announcements",description:"Post news to the student dashboard."},{id:"manage_resources",label:"Resource Rules",description:"Set quotas and booking restrictions."},{id:"manage_staff",label:"Manage Staff",description:"Add new instructors and assign roles."},{id:"view_audit",label:"View Audit Logs",description:"See history of administrative actions."},{id:"edit_settings",label:"School Settings",description:"Change school name, address, and branding."}],Se={Vocals:["Soprano","Tenor","Baritone","Bass","Falsetto","Rapping","Beatboxing","Growling"],Guitars:["Electric Guitar","Acoustic Guitar","Bass Guitar","Classical/Nylon","12-String Acoustic","Upright Bass"],Percussion:["Drum Kit","Electronic Drums","Congas","Bongos","Djembe","Cajon","Timbales","Tabla","Marimba","Vibraphone"],Keys:["Grand Piano","Upright Piano","Electric Piano","Clavinet","Hammond Organ","Pipe Organ","Synthesizer","MIDI Controller","Accordion"],Strings:["Violin","Viola","Cello","Double Bass","Harp","Banjo","Mandolin","Ukulele","Sitar","Oud"],Wind:["Flute","Clarinet","Oboe","Bassoon","Saxophone","Trumpet","Trombone","French Horn","Tuba","Harmonica","Didgeridoo","Bagpipes"]},X=["Rock","Alternative","Indie","Metal","Punk","Pop","Electronic","House","Techno","Dubstep","Hip Hop","Rap","Trap","R&B","Soul","Funk","Jazz","Blues","Country","Folk","Americana","Bluegrass","Classical","Reggae","Latin","World","Experimental"],gt=["Wi-Fi","Kitchen","Lounge","Private Parking","Shower","Sleep/Lodging","Accessibility Ramps","Video Feed","Loading Dock","Isolation Booth","Live Room","Grand Piano","Tape Machine"],W=[{key:"useRealName",label:"Use Primary Name?",type:"checkbox",isToggle:!0},{key:"profileName",label:"Profile/Stage Name",type:"text"}],Ot={Artist:[{key:"profileName",label:"Artist / Band Name",type:"text"},{key:"bio",label:"Artist Bio",type:"textarea"},{key:"genres",label:"Primary Genres",type:"multi_select",data:X},{key:"rates",label:"Booking/Feature Rate ($)",type:"number"},{key:"website",label:"Official Website",type:"text"},{key:"label",label:"Record Label (Optional)",type:"text"},{key:"touring",label:"Currently Touring?",type:"select",options:["Yes","No"]}],Label:[{key:"profileName",label:"Label Name",type:"text"},{key:"bio",label:"Label Description / Mission",type:"textarea"},{key:"genres",label:"Focus Genres",type:"multi_select",data:X},{key:"website",label:"Website",type:"text"},{key:"acceptingDemos",label:"Accepting Demos?",type:"select",options:["Yes","No"]}],Agent:[...W,{key:"agencyName",label:"Agency Name",type:"text"},{key:"rosterSize",label:"Roster Size",type:"number"},{key:"territory",label:"Territory Focus",type:"text"}],Musician:[...W,{key:"bio",label:"Biography",type:"textarea"},{key:"instruments",label:"Instruments & Skills",type:"nested_select",data:Se},{key:"genres",label:"Genres",type:"multi_select",data:X},{key:"rates",label:"Session Rate ($/hr)",type:"number"},{key:"dayRate",label:"Day Rate ($)",type:"number"},{key:"travelDist",label:"Max Travel (mi)",type:"number"},{key:"gearHighlights",label:"Key Gear (Guitars, Amps, etc.)",type:"textarea"},{key:"readingSkill",label:"Sight Reading",type:"select",options:["None","Charts/Lead Sheets","Standard Notation","Expert"]},{key:"remoteWork",label:"Remote Recording Capable?",type:"select",options:["Yes","No"]}],Fan:[{key:"bio",label:"About Me",type:"textarea"},{key:"genres",label:"Favorite Genres",type:"multi_select",data:X},{key:"lookingFor",label:"Interested In",type:"multi_select",data:["Discovering Music","Booking Talent","Learning"]}],Studio:[...W,{key:"profileName",label:"Studio Name",type:"text"},{key:"bio",label:"Description",type:"textarea"},{key:"address",label:"Address",type:"text"},{key:"hours",label:"Hours of Operation",type:"text"},{key:"dimensions",label:"Live Room Dimensions",type:"text"},{key:"parking",label:"Parking Situation",type:"text"},{key:"amenities",label:"Amenities",type:"multi_select",data:gt}],Engineer:[...W,{key:"bio",label:"Bio",type:"textarea"},{key:"skills",label:"Specialties",type:"multi_select",data:["Tracking","Mixing","Mastering","Live Sound","Broadcast","Dolby Atmos","Editing/Tuning"]},{key:"daw",label:"DAWs",type:"multi_select",data:["Pro Tools","Logic Pro","Ableton","FL Studio","Cubase","Reaper","Studio One","Luna"]},{key:"outboard",label:"Favorite Outboard Gear",type:"textarea"},{key:"credits",label:"Selected Credits",type:"textarea"}],Producer:[...W,{key:"bio",label:"Bio",type:"textarea"},{key:"genres",label:"Genres",type:"multi_select",data:X},{key:"daw",label:"Primary DAW",type:"select",options:["Pro Tools","Logic Pro","Ableton","FL Studio","Cubase","Studio One"]},{key:"credits",label:"Discography / Credits",type:"textarea"}],Composer:[...W,{key:"bio",label:"Bio",type:"textarea"},{key:"compType",label:"Type",type:"multi_select",options:["Film/TV","Game Audio","Pop/Songwriting","Classical/Orchestral","Library Music","Jingles"]},{key:"instruments",label:"Primary Instruments",type:"nested_select",data:Se},{key:"libraries",label:"Key Sample Libraries",type:"textarea"},{key:"credits",label:"Credits",type:"textarea"}],Technician:[...W,{key:"bio",label:"Bio",type:"textarea"},{key:"skills",label:"Skills",type:"textarea"}]},Gt=[{id:"repair",label:"Equipment Repair"},{id:"wiring",label:"Studio Wiring/Install"},{id:"acoustics",label:"Acoustic Calibration"},{id:"computer",label:"DAW/Computer Support"},{id:"mods",label:"Custom Mods"}],Bt=["Luthier (Guitar/Bass)","Drum Tech","Amp Tech (Tube)","Amp Tech (Solid State)","Studio Electrician","Acoustician","Piano Tuner/Tech","Synth/Keyboard Tech","Computer/IT Systems","Soldering/Cabling","Console Maintenance","Live Sound Tech"],Ht=[{id:"computer_audio_and_interfaces",label:"Computer Audio & Interfaces"},{id:"microphones_and_input_transducers",label:"Microphones"},{id:"mixing_consoles_and_control",label:"Mixing Consoles"},{id:"monitoring_and_playback",label:"Monitoring & Playback"},{id:"outboard_signal_processing",label:"Outboard Gear"}],mt=()=>{const[a,r]=l.useState(!1),[t,c]=l.useState(null);return{uploadImage:async(g,u)=>{if(!g)return null;if(!we)return c("Firebase Storage is not configured. Please set VITE_FIREBASE_STORAGE_BUCKET in your environment variables."),console.error("Firebase Storage is not available. storageBucket is missing from Firebase config."),null;r(!0),c(null);try{const x=`${Date.now()}_${g.name}`,i=`${u}/${x}`,s=lt(we,i),n=await nt(s,g),j=await dt(n.ref);return r(!1),j}catch(o){return console.error("Upload failed:",o),c(o),r(!1),null}},uploading:a,error:t}};function qt({user:a,userData:r}){const{schoolData:t,studentProfile:c}=le(),[d,g]=l.useState(""),[u,o]=l.useState([]),[x,i]=l.useState(!1),s=(r==null?void 0:r.internshipCities)||[],n=async()=>{const f=d.trim();if(f&&s.length<3)try{await O($(N,"users",a.uid),{internshipCities:_e(f)}),g("")}catch(v){console.error("Error adding interest:",v)}},j=async f=>{try{await O($(N,"users",a.uid),{internshipCities:ot(f)})}catch(v){console.error("Error removing interest:",v)}};l.useEffect(()=>{r!=null&&r.programComplete&&y()},[r==null?void 0:r.programComplete,s]);const y=async()=>{i(!0);try{const f=G(A(N,"studios"),D("allowInternship","==",!0));let h=(await z(f)).docs.map(m=>({id:m.id,...m.data()}));s.length>0&&(h=h.filter(m=>s.some(w=>{var E,C;return((E=m.city)==null?void 0:E.toLowerCase().includes(w.toLowerCase()))||((C=m.zipCode)==null?void 0:C.includes(w))}))),o(h)}catch(f){console.error("Error fetching studios:",f)}finally{i(!1)}},p=((c==null?void 0:c.hoursLogged)||0)/((t==null?void 0:t.requiredHours)||100);return e.jsxs("div",{className:"max-w-5xl mx-auto space-y-8 pb-20",children:[e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-2",children:t!=null&&t.logoURL?e.jsx("img",{src:t.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):e.jsx(Y,{size:32,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight mb-1",children:(t==null?void 0:t.name)||"Student Dashboard"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Student Portal"}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["ID: ",(r==null?void 0:r.studentId)||"N/A"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Cohort: ",(c==null?void 0:c.cohort)||"General"]})]})]}),e.jsxs("div",{className:"w-full md:w-64 bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between text-sm font-bold mb-2",children:[e.jsx("span",{className:"dark:text-gray-300",children:"Progress"}),e.jsxs("span",{className:"text-indigo-600",children:[Math.round(p*100),"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-2",children:e.jsx("div",{className:"h-full bg-indigo-600",style:{width:`${Math.min(100,p*100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 text-right",children:[(c==null?void 0:c.hoursLogged)||0," / ",(t==null?void 0:t.requiredHours)||100," Hours"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[e.jsx(K,{size:20,className:"text-indigo-500"})," Internship Locations"]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Add up to 3 target locations (City, Zip, or County) to find matched studios."}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(f=>e.jsxs("span",{className:"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-800 dark:text-indigo-300 text-sm font-medium px-3 py-1 rounded-full flex items-center gap-1",children:[f,e.jsx("button",{onClick:()=>j(f),className:"ml-1 hover:text-indigo-800",children:"×"})]},f))}),s.length<3&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Enter City or Zip Code",value:d,onChange:f=>g(f.target.value),onKeyDown:f=>f.key==="Enter"&&n(),className:"flex-1 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none"}),e.jsx("button",{onClick:n,disabled:!d.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg font-bold disabled:opacity-50",children:"Add"})]})]}),(r==null?void 0:r.programComplete)&&e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm space-y-4",children:[e.jsxs("h2",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[e.jsx(ae,{size:20,className:"text-indigo-500"})," Available Studios"]}),x?e.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[e.jsx(re,{className:"animate-spin",size:16})," Searching..."]}):u.length>0?e.jsx("div",{className:"space-y-3",children:u.map(f=>e.jsxs("div",{className:"p-4 border rounded-lg dark:border-gray-700 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold dark:text-white text-lg",children:f.name}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(K,{size:12})," ",f.city,", ",f.state]})]}),e.jsx("button",{className:"text-indigo-600 font-bold text-sm hover:underline",children:"View Details"})]},f.id))}):e.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[e.jsx(ge,{size:16})," No studios found matching your criteria yet."]})]})]})}const pe=(a,r="export")=>{if(!a||!a.length){console.warn("No data to export.");return}const t=new Set;a.forEach(x=>Object.keys(x).forEach(i=>t.add(i)));const c=Array.from(t),d=[];d.push(c.join(",")),a.forEach(x=>{const i=c.map(s=>{const n=x[s];return n&&typeof n=="object"?n.toMillis?`"${new Date(n.toMillis()).toLocaleString()}"`:`"${JSON.stringify(n).replace(/"/g,'""')}"`:`"${(""+(n??"")).replace(/"/g,'""')}"`});d.push(i.join(","))});const g=new Blob([d.join(`
`)],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(g),o=document.createElement("a");o.href=u,o.setAttribute("download",`${r}_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(o),o.click(),document.body.removeChild(o)};function ht({schoolId:a,schoolData:r}){const[t,c]=l.useState({students:0,interns:0,pending:0}),[d,g]=l.useState([]),[u,o]=l.useState(!0);return l.useEffect(()=>{a&&(async()=>{o(!0);try{const i=await ct(A(N,`schools/${a}/students`)),n=(await z(A(N,`schools/${a}/students`))).docs.filter(f=>f.data().internshipStudioId).length,y=(await z(A(N,`schools/${a}/internship_logs`))).docs.filter(f=>f.data().status==="pending_approval").length;c({students:i.data().count,interns:n,pending:y});const p=await z(G(A(N,`schools/${a}/audit_logs`),J("timestamp","desc"),ue(5)));g(p.docs.map(f=>({id:f.id,...f.data()})))}catch(i){console.error("Overview load failed:",i)}o(!1)})()},[a]),u?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Overview..."}):e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(de,{title:"Total Students",value:t.students,icon:e.jsx(Ce,{className:"text-white"}),bg:"bg-gradient-to-br from-indigo-500 to-blue-600",text:"text-white"}),e.jsx(de,{title:"Active Internships",value:t.interns,icon:e.jsx(me,{className:"text-white"}),bg:"bg-gradient-to-br from-purple-500 to-pink-600",text:"text-white"}),e.jsx(de,{title:"Pending Approvals",value:t.pending,icon:e.jsx(re,{className:"text-white"}),bg:"bg-gradient-to-br from-yellow-500 to-orange-600",text:"text-white"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-4 bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Ae,{size:18,className:"text-gray-400"})," Recent Activity"]}),e.jsx("div",{className:"space-y-3",children:d.length===0?e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No recent activity recorded."}):d.map(x=>{var i;return e.jsxs("div",{className:"text-xs border-b dark:border-gray-700 pb-2 last:border-0",children:[e.jsxs("div",{className:"flex justify-between font-bold dark:text-gray-200",children:[e.jsx("span",{children:x.action}),e.jsx("span",{className:"text-gray-500 font-normal",children:(i=x.timestamp)!=null&&i.toDate?x.timestamp.toDate().toLocaleTimeString():""})]}),e.jsxs("div",{className:"text-gray-500 mt-0.5",children:[x.details," ",e.jsxs("span",{className:"opacity-70",children:["— ",x.adminName]})]})]},x.id)})})]}),e.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-6 flex flex-col items-center justify-center text-center bg-white dark:bg-black/20 shadow-sm",children:[e.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center shadow-lg mb-4 overflow-hidden border-4 border-white dark:border-gray-700",children:r!=null&&r.logoURL?e.jsx("img",{src:r.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):e.jsx(Y,{size:40,className:"text-indigo-500"})}),e.jsx("h2",{className:"text-2xl font-extrabold dark:text-white mb-1",children:(r==null?void 0:r.name)||"School Name"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:(r==null?void 0:r.address)||"No Address Set"}),(r==null?void 0:r.website)&&e.jsxs("a",{href:r.website,target:"_blank",rel:"noreferrer",className:"text-xs font-bold text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1.5 rounded-full hover:bg-indigo-100 transition flex items-center gap-1",children:[e.jsx(Ee,{size:12})," Visit Website"]})]})]})]})}function ut({schoolId:a,logAction:r}){const[t,c]=l.useState([]),[d,g]=l.useState([]),[u,o]=l.useState(!0),[x,i]=l.useState(""),[s,n]=l.useState(!1),[j,y]=l.useState(!1),[p,f]=l.useState(null),[v,h]=l.useState(!1),[m,w]=l.useState({firstName:"",lastName:"",email:"",studentId:"",cohort:"",status:"Enrolled"}),[E,C]=l.useState("");l.useEffect(()=>{(async()=>{o(!0);try{const P=await z(A(N,`schools/${a}/students`));c(P.docs.map(_=>({id:_.id,..._.data()})));const I=await z(A(N,`schools/${a}/partners`));g(I.docs.map(_=>({id:_.id,..._.data()})))}catch(P){console.error("Roster load failed:",P)}o(!1)})()},[a]);const b=()=>{w({firstName:"",lastName:"",email:"",studentId:"",cohort:"",status:"Enrolled"}),h(!1),f(null),n(!0)},S=k=>{var P,I;w({firstName:((P=k.displayName)==null?void 0:P.split(" ")[0])||"",lastName:((I=k.displayName)==null?void 0:I.split(" ").slice(1).join(" "))||"",email:k.email||"",studentId:k.studentId||"",cohort:k.cohort||"",status:k.status||"Enrolled"}),h(!0),f(k),n(!0)},L=async()=>{const k=`${m.firstName} ${m.lastName}`.trim();if(!k||!m.email)return alert("Name and Email required.");try{if(v&&p)await O($(N,`schools/${a}/students/${p.id}`),{...m,displayName:k}),c(P=>P.map(I=>I.id===p.id?{...I,...m,displayName:k}:I)),await r("Edit Student",`Updated ${k}`);else{const P=await F(A(N,`schools/${a}/students`),{...m,displayName:k,hoursLogged:0,createdAt:H()});c(I=>[...I,{id:P.id,...m,displayName:k,hoursLogged:0}]),await r("Add Student",`Added ${k}`)}n(!1)}catch(P){console.error("Save student failed:",P),alert("Failed to save student.")}},T=async(k,P)=>{if(confirm(`Remove ${P} from the roster? This does not delete their user account.`))try{await ee($(N,`schools/${a}/students/${k}`)),c(I=>I.filter(_=>_.id!==k)),await r("Remove Student",`Removed ${P}`)}catch(I){console.error("Delete failed:",I)}},B=async()=>{if(!(!p||!E))try{await O($(N,`schools/${a}/students/${p.id}`),{internshipStudioId:E}),c(k=>k.map(P=>P.id===p.id?{...P,internshipStudioId:E}:P)),y(!1),C(""),alert(`Assigned ${p.displayName} to studio.`),await r("Assign Internship",`Assigned ${p.displayName}`)}catch(k){console.error("Assignment failed:",k)}},U=t.filter(k=>{var P,I;return((P=k.displayName)==null?void 0:P.toLowerCase().includes(x.toLowerCase()))||((I=k.studentId)==null?void 0:I.includes(x))});return u?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roster..."}):e.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ae,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),e.jsx("input",{className:"w-full pl-9 p-2 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Search by Name or ID...",value:x,onChange:k=>i(k.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>pe(t,"student_roster"),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-bold text-xs",children:"Export CSV"}),e.jsxs("button",{onClick:b,className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-indigo-700",children:[e.jsx(Re,{size:16})," Add Student"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Name"}),e.jsx("th",{className:"p-3",children:"ID"}),e.jsx("th",{className:"p-3",children:"Cohort"}),e.jsx("th",{className:"p-3",children:"Internship"}),e.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:U.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"p-6 text-center text-gray-500",children:"No students found."})}):U.map(k=>e.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[e.jsx("td",{className:"p-3 font-bold dark:text-white",children:k.displayName}),e.jsx("td",{className:"p-3 text-gray-500",children:k.studentId||"--"}),e.jsx("td",{className:"p-3",children:k.cohort||"General"}),e.jsx("td",{className:"p-3 text-gray-500",children:k.internshipStudioId?e.jsxs("span",{className:"flex items-center gap-1 text-green-600 font-medium text-xs bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded w-fit",children:[e.jsx(me,{size:12})," Assigned"]}):e.jsx("span",{className:"text-gray-400 italic text-xs",children:"Pending"})}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>{f(k),y(!0)},className:"p-1.5 bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-300 rounded hover:bg-indigo-100",title:"Assign Internship",children:e.jsx(Le,{size:14})}),e.jsx("button",{onClick:()=>S(k),className:"p-1.5 bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 rounded hover:bg-gray-200",title:"Edit Details",children:e.jsx(Ue,{size:14})}),e.jsx("button",{onClick:()=>T(k.id,k.displayName),className:"p-1.5 bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400 rounded hover:bg-red-100",title:"Remove Student",children:e.jsx(Q,{size:14})})]})})]},k.id))})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 space-y-4 animate-in zoom-in-95 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-xl dark:text-white",children:v?"Edit Student":"Add New Student"}),e.jsx("button",{onClick:()=>n(!1),children:e.jsx(Oe,{className:"text-gray-400 hover:text-red-500"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"First Name"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:m.firstName,onChange:k=>w({...m,firstName:k.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Last Name"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:m.lastName,onChange:k=>w({...m,lastName:k.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Email Address"}),e.jsx("input",{type:"email",className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:m.email,onChange:k=>w({...m,email:k.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Student ID"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:m.studentId,onChange:k=>w({...m,studentId:k.target.value}),placeholder:"e.g. S123"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Cohort"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:m.cohort,onChange:k=>w({...m,cohort:k.target.value}),placeholder:"Fall 2024"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Enrollment Status"}),e.jsxs("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:m.status,onChange:k=>w({...m,status:k.target.value}),children:[e.jsx("option",{value:"Enrolled",children:"Enrolled"}),e.jsx("option",{value:"Graduated",children:"Graduated"}),e.jsx("option",{value:"Dropped",children:"Dropped"}),e.jsx("option",{value:"Leave",children:"On Leave"})]})]}),e.jsx("button",{onClick:L,className:"w-full bg-indigo-600 text-white py-2.5 rounded-lg font-bold hover:bg-indigo-700 mt-2",children:v?"Update Student":"Create Student Record"})]})}),j&&p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-sm rounded-xl p-6 space-y-4 animate-in zoom-in-95 shadow-2xl",children:[e.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Assign Internship"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Select a partner studio for ",e.jsx("strong",{children:p.displayName}),"."]}),e.jsxs("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:E,onChange:k=>C(k.target.value),children:[e.jsx("option",{value:"",children:"Select Studio..."}),d.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y(!1),className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-sm",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:!E,className:"flex-1 bg-indigo-600 text-white py-2 rounded font-bold disabled:opacity-50",children:"Confirm"})]})]})})]})}const pt=(a,r)=>{if(!a||!r)return 0;const t=a.toMillis?a.toMillis():new Date(a).getTime(),d=(r.toMillis?r.toMillis():new Date(r).getTime())-t;return Math.max(0,Math.floor(d/6e4))},bt=a=>{const r=Math.floor(a/60),t=Math.floor(a%60);return`${r}h ${t>0?`${t}m`:""}`};function ft({schoolId:a}){const[r,t]=l.useState([]),[c,d]=l.useState(!0),[g,u]=l.useState("all");l.useEffect(()=>{a&&(async()=>{d(!0);try{let s=G(A(N,`schools/${a}/internship_logs`),J("checkIn","desc"),ue(100));const j=(await z(s)).docs.map(y=>{const p=y.data(),f=pt(p.checkIn,p.checkOut);return{id:y.id,...p,duration:f}});t(j)}catch(s){console.error("Error fetching logs:",s)}d(!1)})()},[a]);const o=async(i,s)=>{try{await O($(N,`schools/${a}/internship_logs/${i}`),{status:s}),t(n=>n.map(j=>j.id===i?{...j,status:s}:j))}catch(n){console.error("Error updating log:",n),alert("Failed to update log status.")}},x=g==="all"?r:r.filter(i=>i.status===g);return c?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Internship Hours..."}):e.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{size:16,className:"text-gray-500"}),e.jsxs("select",{className:"bg-white dark:bg-[#1f2128] border dark:border-gray-600 text-sm rounded-md p-1.5 outline-none dark:text-white",value:g,onChange:i=>u(i.target.value),children:[e.jsx("option",{value:"all",children:"All Activity"}),e.jsx("option",{value:"pending_approval",children:"Pending Approval"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"active",children:"Active (Clocked In)"})]})]}),e.jsxs("button",{onClick:()=>pe(x,"internship_hours"),className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-[#1f2128] border dark:border-gray-600 rounded-md text-xs font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx(Be,{size:14})," Export CSV"]})]}),e.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 shadow-sm",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Date"}),e.jsx("th",{className:"p-3",children:"Student"}),e.jsx("th",{className:"p-3",children:"Activity / Description"}),e.jsx("th",{className:"p-3",children:"Duration"}),e.jsx("th",{className:"p-3",children:"Status"}),e.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"p-8 text-center text-gray-500",children:"No logs found matching criteria."})}):x.map(i=>{var s,n;return e.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[e.jsxs("td",{className:"p-3 text-gray-600 dark:text-gray-300 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium",children:(s=i.checkIn)!=null&&s.toDate?i.checkIn.toDate().toLocaleDateString():"N/A"}),e.jsx("div",{className:"text-[10px] text-gray-400",children:(n=i.checkIn)!=null&&n.toDate?i.checkIn.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),e.jsx("td",{className:"p-3 font-bold dark:text-white",children:i.studentName}),e.jsxs("td",{className:"p-3 max-w-xs",children:[e.jsxs("span",{className:"block text-[10px] uppercase font-bold text-gray-400 mb-0.5",children:[i.type," • ",i.location]}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 truncate block",title:i.description,children:i.description||e.jsx("span",{className:"italic opacity-50",children:"No description provided"})})]}),e.jsx("td",{className:"p-3 font-mono font-bold text-indigo-600 dark:text-indigo-400",children:i.checkOut?bt(i.duration):e.jsx("span",{className:"animate-pulse text-green-500",children:"Active..."})}),e.jsx("td",{className:"p-3",children:e.jsx(yt,{status:i.status})}),e.jsx("td",{className:"p-3 text-right",children:i.status==="pending_approval"&&e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx("button",{onClick:()=>o(i.id,"approved"),className:"p-1.5 bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded hover:bg-green-200 transition",title:"Approve",children:e.jsx(ge,{size:16})}),e.jsx("button",{onClick:()=>o(i.id,"rejected"),className:"p-1.5 bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded hover:bg-red-200 transition",title:"Reject",children:e.jsx(He,{size:16})})]})})]},i.id)})})]})})]})}function yt({status:a}){const r={approved:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",rejected:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",pending_approval:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",active:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 animate-pulse"},t={approved:"Approved",rejected:"Rejected",pending_approval:"Pending",active:"In Progress"};return e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-[10px] uppercase font-bold tracking-wide ${r[a]||"bg-gray-100 text-gray-500"}`,children:t[a]||a})}function jt({schoolId:a,logAction:r}){const[t,c]=l.useState([]),[d,g]=l.useState([]),[u,o]=l.useState(!0),[x,i]=l.useState(""),[s,n]=l.useState("");l.useEffect(()=>{(async()=>{o(!0);try{const p=await z(A(N,`schools/${a}/staff`));c(p.docs.map(v=>({id:v.id,...v.data()})));const f=await z(A(N,`schools/${a}/roles`));g(f.docs.map(v=>({id:v.id,...v.data()})))}catch(p){console.error("Staff load failed:",p)}o(!1)})()},[a]);const j=async()=>{if(!x||!s)return alert("Email and Role are required.");try{const y=G(xt(N,"public_profile"),D("email","==",x)),p=await z(y);if(p.empty)return alert("User not found. They must sign up for SeshNx first.");const f=p.docs[0],v=f.data(),h=f.ref.parent.parent.id,m=d.find(C=>C.id===s),w={uid:h,email:v.email,name:`${v.firstName} ${v.lastName}`,roleId:s,roleName:(m==null?void 0:m.name)||"Unknown",addedAt:H()};await F(A(N,`schools/${a}/staff`),w);const E=se(h).userProfile;await O($(N,E),{schoolId:a,accountTypes:_e("Instructor")}),c(C=>[...C,w]),i(""),alert(`${v.firstName} added as ${m==null?void 0:m.name}.`),await r("Add Staff",`Added ${v.email} as ${m==null?void 0:m.name}`)}catch(y){console.error("Add staff error:",y),alert("Failed to add staff member. Check console.")}};return u?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Staff..."}):e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Re,{size:18,className:"text-indigo-600"})," Add New Staff Member"]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(he,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"User Email Address",value:x,onChange:y=>i(y.target.value)})]}),e.jsxs("div",{className:"relative min-w-[200px]",children:[e.jsx(ie,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsxs("select",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white appearance-none",value:s,onChange:y=>n(y.target.value),children:[e.jsx("option",{value:"",children:"Select Role..."}),d.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsx("button",{onClick:j,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 transition shadow-md",children:"Add Staff"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["* The user must already have a SeshNx account. This will grant them ",e.jsx("strong",{children:"Instructor"})," access to this school."]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[e.jsx("span",{className:"font-bold text-sm dark:text-gray-200",children:"Authorized Personnel"}),e.jsxs("span",{className:"text-xs bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded-full font-bold",children:[t.length," Active"]})]}),e.jsx("div",{className:"divide-y dark:divide-gray-700",children:t.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No staff members found."}):t.map(y=>e.jsxs("div",{className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold shadow-sm",children:y.name?y.name.charAt(0):"?"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold dark:text-white text-sm",children:y.name}),e.jsx("div",{className:"text-xs text-gray-500",children:y.email})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-bold border dark:border-gray-600",children:y.roleName})})]},y.id))})]})]})}function kt({schoolId:a,logAction:r}){const[t,c]=l.useState([]),[d,g]=l.useState(!0),[u,o]=l.useState(!1),[x,i]=l.useState({name:"",color:"#3b82f6",permissions:[]}),[s,n]=l.useState(!1);l.useEffect(()=>{a&&(async()=>{g(!0);try{const m=await z(A(N,`schools/${a}/roles`));c(m.docs.map(w=>({id:w.id,...w.data()})))}catch(m){console.error("Error loading roles:",m)}g(!1)})()},[a]);const j=async()=>{if(x.name){n(!0);try{const h=await F(A(N,`schools/${a}/roles`),x);c(m=>[...m,{id:h.id,...x}]),await r("Create Role",`Created role: ${x.name}`),i({name:"",color:"#3b82f6",permissions:[]}),o(!1)}catch(h){console.error("Create role failed:",h),alert("Failed to create role.")}n(!1)}},y=async(h,m)=>{if(confirm(`Delete role "${m}"? Staff assigned to this role will lose their permissions.`))try{await ee($(N,`schools/${a}/roles/${h}`)),c(w=>w.filter(E=>E.id!==h)),await r("Delete Role",`Deleted role: ${m}`)}catch(w){console.error("Delete role failed:",w)}},p=async(h,m)=>{c(w=>w.map(E=>E.id===h?{...E,permissions:m}:E));try{await O($(N,`schools/${a}/roles/${h}`),{permissions:m})}catch(w){console.error("Update perms failed:",w)}},f=h=>{i(m=>({...m,permissions:m.permissions.includes(h)?m.permissions.filter(w=>w!==h):[...m.permissions,h]}))},v=(h,m)=>{const w=h.permissions||[],E=w.includes(m)?w.filter(C=>C!==m):[...w,m];p(h.id,E)};return d?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roles..."}):e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("button",{onClick:()=>o(!0),className:"w-full py-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-500 font-bold hover:bg-gray-50 dark:hover:bg-white/5 transition flex items-center justify-center gap-2",children:[e.jsx(Z,{size:20})," Create New Role"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(h=>{var m;return e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-start bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:h.color}}),h.name]}),e.jsxs("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider font-bold",children:[((m=h.permissions)==null?void 0:m.length)||0," Permissions"]})]}),e.jsx("button",{onClick:()=>y(h.id,h.name),className:"text-gray-400 hover:text-red-500 transition p-1",title:"Delete Role",children:e.jsx(Q,{size:16})})]}),e.jsx("div",{className:"p-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar",children:e.jsx("div",{className:"space-y-0.5",children:xe.map(w=>{var C;const E=(C=h.permissions)==null?void 0:C.includes(w.id);return e.jsxs("label",{className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition ${E?"bg-indigo-50 dark:bg-indigo-900/20":"hover:bg-gray-50 dark:hover:bg-white/5"}`,children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${E?"bg-indigo-600 border-indigo-600":"border-gray-400"}`,children:E&&e.jsx(qe,{size:10,className:"text-white",strokeWidth:4})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:E,onChange:()=>v(h,w.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-xs font-bold ${E?"text-indigo-700 dark:text-indigo-300":"text-gray-600 dark:text-gray-400"}`,children:w.label}),e.jsx("div",{className:"text-[10px] text-gray-400 leading-tight",children:w.description})]})]},w.id)})})})]},h.id)})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-xl p-6 space-y-4 max-h-[90vh] overflow-y-auto animate-in zoom-in-95 shadow-2xl",children:[e.jsxs("h3",{className:"font-bold text-xl dark:text-white flex items-center gap-2",children:[e.jsx(Ve,{className:"text-indigo-600"})," Create New Role"]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Role Name"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g. Academic Advisor",value:x.name,onChange:h=>i({...x,name:h.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Color"}),e.jsx("div",{className:"flex items-center border rounded dark:border-gray-600 p-1 dark:bg-black/20",children:e.jsx("input",{type:"color",className:"h-8 w-8 rounded cursor-pointer border-none bg-transparent",value:x.color,onChange:h=>i({...x,color:h.target.value})})})]})]}),e.jsxs("div",{className:"border-t dark:border-gray-700 pt-4",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-3 block",children:"Assign Initial Permissions"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:xe.map(h=>e.jsxs("label",{className:`flex items-start gap-2 p-2 border rounded cursor-pointer transition ${x.permissions.includes(h.id)?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-white/5"}`,children:[e.jsx("input",{type:"checkbox",className:"mt-1",checked:x.permissions.includes(h.id),onChange:()=>f(h.id)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold dark:text-gray-200",children:h.label}),e.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:h.description})]})]},h.id))})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>o(!1),className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-sm",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:s,className:"flex-1 bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700 disabled:opacity-50",children:s?"Saving...":"Create Role"})]})]})})]})}function Nt({schoolId:a,logAction:r}){const[t,c]=l.useState([]),[d,g]=l.useState(!0),[u,o]=l.useState({resource:"",limit:4,unit:"hours/week",role:"Student"});l.useEffect(()=>{a&&(async()=>{g(!0);try{const n=await z(A(N,`schools/${a}/rules`));c(n.docs.map(j=>({id:j.id,...j.data()})))}catch(n){console.error("Error loading rules:",n)}g(!1)})()},[a]);const x=async()=>{if(!u.resource)return alert("Resource name required.");try{const n={id:(await F(A(N,`schools/${a}/rules`),u)).id,...u};c(j=>[...j,n]),await r("Add Resource Rule",`Set ${u.limit} ${u.unit} limit for ${u.resource}`),o({resource:"",limit:4,unit:"hours/week",role:"Student"})}catch(s){console.error("Add rule failed:",s)}},i=async(s,n)=>{if(confirm("Delete this rule?"))try{await ee($(N,`schools/${a}/rules/${s}`)),c(j=>j.filter(y=>y.id!==s)),await r("Delete Rule",`Removed rule for ${n}`)}catch(j){console.error("Delete failed:",j)}};return d?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Rules..."}):e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Pe,{size:18,className:"text-indigo-600"})," Add Restriction / Quota"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Resource Name"}),e.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g. Studio A, SSL Room",value:u.resource,onChange:s=>o({...u,resource:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Limit"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",className:"w-20 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:u.limit,onChange:s=>o({...u,limit:s.target.value})}),e.jsxs("select",{className:"flex-1 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:u.unit,onChange:s=>o({...u,unit:s.target.value}),children:[e.jsx("option",{value:"hours/week",children:"Hrs/Wk"}),e.jsx("option",{value:"hours/term",children:"Hrs/Term"}),e.jsx("option",{value:"bookings/week",children:"Bookings/Wk"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:x,className:"w-full bg-indigo-600 text-white py-2.5 rounded-lg font-bold hover:bg-indigo-700 flex items-center justify-center gap-2",children:[e.jsx(Z,{size:18})," Add Rule"]})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Applies To Role"}),e.jsxs("select",{className:"w-full md:w-1/2 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:u.role,onChange:s=>o({...u,role:s.target.value}),children:[e.jsx("option",{value:"Student",children:"All Students"}),e.jsx("option",{value:"Senior",children:"Seniors Only"}),e.jsx("option",{value:"Junior",children:"Juniors Only"}),e.jsx("option",{value:"Probation",children:"Probationary"})]})]})]}),e.jsx("div",{className:"space-y-3",children:t.length===0?e.jsx("div",{className:"text-center text-gray-500 py-8 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No active restrictions. Students have default access."}):t.map(s=>e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 flex justify-between items-center shadow-sm hover:shadow-md transition",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold dark:text-white text-lg",children:s.resource}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300 mt-1",children:[e.jsxs("span",{className:"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300 px-2 py-0.5 rounded text-xs font-bold border border-indigo-100 dark:border-indigo-800",children:[s.limit," ",s.unit]}),e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsxs("span",{children:["Applies to: ",e.jsx("strong",{children:s.role})]})]})]}),e.jsx("button",{onClick:()=>i(s.id,s.resource),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:e.jsx(Q,{size:18})})]},s.id))})]})}function vt({schoolId:a,logAction:r,user:t,userData:c}){const[d,g]=l.useState([]),[u,o]=l.useState(!0),[x,i]=l.useState(!1),[s,n]=l.useState({title:"",message:"",target:"All"});l.useEffect(()=>{a&&(async()=>{o(!0);try{const f=G(A(N,`schools/${a}/announcements`),J("createdAt","desc")),v=await z(f);g(v.docs.map(h=>({id:h.id,...h.data()})))}catch(f){console.error("Error loading announcements:",f)}o(!1)})()},[a]);const j=async()=>{if(!s.title.trim()||!s.message.trim())return alert("Title and Message required.");i(!0);try{const p={...s,schoolId:a,authorId:t.uid,authorName:c.displayName||"School Admin",authorRole:c.activeProfileRole||"Admin",createdAt:H()},f=await F(A(N,`schools/${a}/announcements`),p);g(v=>[{id:f.id,...p,createdAt:new Date},...v]),await r("Post Announcement",`Posted: ${s.title}`),n({title:"",message:"",target:"All"})}catch(p){console.error("Post failed:",p),alert("Failed to post announcement.")}i(!1)},y=async p=>{if(confirm("Delete this announcement?"))try{await ee($(N,`schools/${a}/announcements/${p}`)),g(f=>f.filter(v=>v.id!==p)),await r("Delete Announcement","Removed a post")}catch(f){console.error("Delete failed:",f)}};return u?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading News..."}):e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Ie,{size:18,className:"text-indigo-600"})," Post New Announcement"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"Headline / Title",value:s.title,onChange:p=>n({...s,title:p.target.value})})}),e.jsx("div",{className:"sm:w-1/4",children:e.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white cursor-pointer",value:s.target,onChange:p=>n({...s,target:p.target.value}),children:[e.jsx("option",{value:"All",children:"Everyone"}),e.jsx("option",{value:"Student",children:"Students Only"}),e.jsx("option",{value:"Instructor",children:"Staff Only"})]})})]}),e.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Write your message here...",value:s.message,onChange:p=>n({...s,message:p.target.value})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:j,disabled:x||!s.title,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 transition",children:x?"Posting...":e.jsxs(e.Fragment,{children:[e.jsx(We,{size:16})," Post Announcement"]})})})]})]}),e.jsx("div",{className:"space-y-4",children:d.length===0?e.jsx("div",{className:"text-center text-gray-500 py-10 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No announcements yet."}):d.map(p=>{var f;return e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm relative group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold dark:text-white",children:p.title}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Te,{size:12})," ",p.authorName]}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[p.target==="All"?e.jsx(Ce,{size:12}):e.jsx(ie,{size:12}),p.target]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:(f=p.createdAt)!=null&&f.toDate?p.createdAt.toDate().toLocaleDateString():"Just now"})]})]}),e.jsx("button",{onClick:()=>y(p.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition opacity-0 group-hover:opacity-100",title:"Delete Post",children:e.jsx(Q,{size:16})})]}),e.jsx("div",{className:"text-gray-700 dark:text-gray-300 text-sm whitespace-pre-wrap leading-relaxed bg-gray-50 dark:bg-black/20 p-3 rounded-lg",children:p.message})]},p.id)})})]})}function wt({schoolId:a,logAction:r}){const[t,c]=l.useState([]),[d,g]=l.useState(!0),[u,o]=l.useState({name:"",address:"",website:"",contactEmail:""});l.useEffect(()=>{a&&(async()=>{g(!0);try{const n=G(A(N,`schools/${a}/partners`),J("name")),j=await z(n);c(j.docs.map(y=>({id:y.id,...y.data()})))}catch(n){console.error("Error loading partners:",n)}g(!1)})()},[a]);const x=async()=>{if(!u.name)return alert("Partner Name is required.");try{const s={...u,status:"Approved"},n=await F(A(N,`schools/${a}/partners`),s);c(j=>[...j,{id:n.id,...s}]),await r("Add Partner",`Added studio: ${u.name}`),o({name:"",address:"",website:"",contactEmail:""})}catch(s){console.error("Add partner failed:",s),alert("Failed to add partner.")}},i=async(s,n)=>{if(confirm(`Remove ${n} from approved partners?`))try{await ee($(N,`schools/${a}/partners/${s}`)),c(j=>j.filter(y=>y.id!==s)),await r("Remove Partner",`Removed: ${n}`)}catch(j){console.error("Delete failed:",j)}};return d?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Partners..."}):e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(me,{size:18,className:"text-indigo-600"})," Add Approved Partner"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Studio / Company Name"}),e.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"e.g. Sound City Studios",value:u.name,onChange:s=>o({...u,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{size:14,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full pl-9 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"123 Main St...",value:u.address,onChange:s=>o({...u,address:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Contact Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{size:14,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full pl-9 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"manager@studio.com",value:u.contactEmail,onChange:s=>o({...u,contactEmail:s.target.value})})]})]})]}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{onClick:x,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 flex items-center gap-2 shadow-md transition",children:[e.jsx(Z,{size:18})," Add Partner"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.length===0?e.jsx("div",{className:"col-span-full text-center py-10 text-gray-500 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No partners added yet."}):t.map(s=>e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 shadow-sm hover:shadow-md transition group relative",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-bold dark:text-white text-lg truncate pr-8",children:s.name}),e.jsx("button",{onClick:()=>i(s.id,s.name),className:"text-gray-400 hover:text-red-500 absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition",children:e.jsx(Q,{size:16})})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[s.address&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(K,{size:14,className:"mt-0.5 text-indigo-500 shrink-0"}),e.jsx("span",{className:"truncate",children:s.address})]}),s.contactEmail&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{size:14,className:"text-green-500 shrink-0"}),e.jsx("a",{href:`mailto:${s.contactEmail}`,className:"hover:underline truncate",children:s.contactEmail})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t dark:border-gray-700 flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase text-green-600 bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded border border-green-200 dark:border-green-800",children:"Approved"}),s.website&&e.jsx("a",{href:s.website,target:"_blank",rel:"noreferrer",className:"text-gray-400 hover:text-indigo-500",children:e.jsx(Ke,{size:14})})]})]},s.id))})]})}function St({schoolId:a,logAction:r,graderName:t}){const[c,d]=l.useState([]),[g,u]=l.useState(!0),[o,x]=l.useState(""),[i,s]=l.useState(null),[n,j]=l.useState([]),[y,p]=l.useState(!1),[f,v]=l.useState(!1),[h,m]=l.useState({technical:5,softSkills:5,notes:""});l.useEffect(()=>{a&&(async()=>{u(!0);try{const S=G(A(N,`schools/${a}/students`),J("displayName")),L=await z(S);d(L.docs.map(T=>({id:T.id,...T.data()})))}catch(S){console.error("Error loading students:",S)}u(!1)})()},[a]),l.useEffect(()=>{if(!i)return;(async()=>{p(!0);try{const S=G(A(N,`schools/${a}/students/${i.id}/evaluations`),J("date","desc")),L=await z(S);j(L.docs.map(T=>({id:T.id,...T.data()})))}catch(S){console.error("Error loading history:",S)}p(!1)})(),v(!1),m({technical:5,softSkills:5,notes:""})},[i,a]);const w=async()=>{if(i)try{const b={...h,evaluator:t||"Instructor",date:H()},S=await F(A(N,`schools/${a}/students/${i.id}/evaluations`),b);j(L=>[{id:S.id,...b,date:new Date},...L]),await r("Grade Student",`Graded ${i.displayName}: Tech(${h.technical}) Soft(${h.softSkills})`),v(!1),alert("Evaluation submitted successfully.")}catch(b){console.error("Grading failed:",b),alert("Failed to save evaluation.")}},E=c.filter(b=>{var S,L;return((S=b.displayName)==null?void 0:S.toLowerCase().includes(o.toLowerCase()))||((L=b.studentId)==null?void 0:L.toLowerCase().includes(o.toLowerCase()))}),C=b=>b>=8?"text-green-500":b>=5?"text-yellow-500":"text-red-500";return g?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roster..."}):e.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border dark:border-gray-700 rounded-xl overflow-hidden bg-white dark:bg-[#2c2e36] animate-in fade-in shadow-sm",children:[e.jsxs("div",{className:"w-full md:w-1/3 border-r dark:border-gray-700 flex flex-col bg-gray-50 dark:bg-[#23262f]",children:[e.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),e.jsx("input",{className:"w-full pl-9 p-2 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Search Students...",value:o,onChange:b=>x(b.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:E.map(b=>e.jsxs("div",{onClick:()=>s(b),className:`p-3 px-4 cursor-pointer flex justify-between items-center transition border-b dark:border-gray-700/50 last:border-0
                                ${(i==null?void 0:i.id)===b.id?"bg-white dark:bg-[#2c2e36] border-l-4 border-l-indigo-600 shadow-sm":"hover:bg-gray-100 dark:hover:bg-gray-700"}
                            `,children:[e.jsxs("div",{children:[e.jsx("div",{className:`font-bold text-sm ${(i==null?void 0:i.id)===b.id?"text-indigo-700 dark:text-white":"dark:text-gray-300"}`,children:b.displayName}),e.jsxs("div",{className:"text-xs text-gray-500",children:[b.cohort||"General"," • ",b.hoursLogged||0," hrs"]})]}),(i==null?void 0:i.id)===b.id&&e.jsx(Je,{size:16,className:"text-indigo-500"})]},b.id))})]}),e.jsx("div",{className:"flex-1 flex flex-col relative",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-white dark:bg-[#2c2e36]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-700 dark:text-indigo-300 font-bold",children:i.displayName[0]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold dark:text-white",children:i.displayName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",i.studentId||"N/A"]})]})]}),f?e.jsxs("button",{onClick:()=>v(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-white flex items-center gap-2 text-sm font-bold",children:[e.jsx(Ye,{size:16})," View History"]}):e.jsxs("button",{onClick:()=>v(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(Z,{size:16})," New Evaluation"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-white dark:bg-[#2c2e36]",children:[f&&e.jsxs("div",{className:"max-w-lg mx-auto space-y-6 animate-in slide-in-from-bottom-4",children:[e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800/50 mb-6",children:[e.jsx("h4",{className:"font-bold text-indigo-800 dark:text-indigo-300 mb-1",children:"New Assessment"}),e.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:["Rating performance for ",new Date().toLocaleDateString(),"."]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("label",{className:"font-bold text-sm dark:text-gray-300",children:"Technical Proficiency"}),e.jsxs("span",{className:`font-bold ${C(h.technical)}`,children:[h.technical,"/10"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"1",className:"w-full accent-indigo-600 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:h.technical,onChange:b=>m({...h,technical:parseInt(b.target.value)})}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Knowledge of equipment, software, and signal flow."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("label",{className:"font-bold text-sm dark:text-gray-300",children:"Soft Skills / Professionalism"}),e.jsxs("span",{className:`font-bold ${C(h.softSkills)}`,children:[h.softSkills,"/10"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"1",className:"w-full accent-indigo-600 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:h.softSkills,onChange:b=>m({...h,softSkills:parseInt(b.target.value)})}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Punctuality, attitude, communication, and client handling."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-bold text-sm dark:text-gray-300 block mb-2",children:"Instructor Notes"}),e.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Detailed feedback...",value:h.notes,onChange:b=>m({...h,notes:b.target.value})})]}),e.jsxs("button",{onClick:w,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 transition flex items-center justify-center gap-2 shadow-lg",children:[e.jsx($e,{size:18})," Submit Evaluation"]})]})]}),!f&&e.jsx("div",{className:"space-y-4",children:y?e.jsx("p",{className:"text-center text-gray-500",children:"Loading history..."}):n.length===0?e.jsxs("div",{className:"text-center py-10 border-2 border-dashed dark:border-gray-700 rounded-xl",children:[e.jsx(ce,{size:32,className:"mx-auto text-gray-300 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No evaluations recorded yet."}),e.jsx("button",{onClick:()=>v(!0),className:"text-indigo-500 font-bold text-sm mt-2 hover:underline",children:"Start first evaluation"})]}):n.map(b=>{var S;return e.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-4 hover:shadow-md transition bg-gray-50 dark:bg-[#23262f]",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:(S=b.date)!=null&&S.toDate?b.date.toDate().toLocaleDateString():"Unknown Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"text-sm font-medium dark:text-gray-200",children:b.evaluator})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"text-center px-3 py-1 bg-white dark:bg-black/20 rounded border dark:border-gray-600",children:[e.jsx("div",{className:`font-bold ${C(b.technical)}`,children:b.technical}),e.jsx("div",{className:"text-[9px] text-gray-400 uppercase",children:"Tech"})]}),e.jsxs("div",{className:"text-center px-3 py-1 bg-white dark:bg-black/20 rounded border dark:border-gray-600",children:[e.jsx("div",{className:`font-bold ${C(b.softSkills)}`,children:b.softSkills}),e.jsx("div",{className:"text-[9px] text-gray-400 uppercase",children:"Soft"})]})]})]}),b.notes&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 border-t dark:border-gray-700 pt-3 mt-2",children:['"',b.notes,'"']})]},b.id)})})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400",children:[e.jsx(ce,{size:48,className:"mb-4 opacity-20"}),e.jsx("p",{children:"Select a student to view history or submit grades."})]})})]})}function Ct({schoolId:a,logAction:r}){const[t,c]=l.useState(""),[d,g]=l.useState(!1),u=async()=>{var n;if(!t.trim())return alert("Please paste CSV data first.");g(!0);const x=t.trim().split(`
`);let i=0,s=0;try{for(let j of x){const y=j.split(",");if(y.length>=3){const p=y[0].trim(),f=y[1].trim(),v=y[2].trim(),h=((n=y[3])==null?void 0:n.trim())||"General",m=`${f} ${v}`;p&&f?(await F(A(N,`schools/${a}/students`),{email:p,displayName:m,firstName:f,lastName:v,cohort:h,studentId:"",status:"Enrolled",hoursLogged:0,createdAt:H()}),i++):s++}else s++}await r("Batch Import",`Imported ${i} students. (${s} skipped)`),alert(`Import complete! Added ${i} students.`),c("")}catch(j){console.error("Import failed:",j),alert("Batch import encountered an error.")}g(!1)},o=async()=>{prompt("Type 'ROLLOVER' to confirm. This will archive current internship logs for all students.")==="ROLLOVER"&&(alert("Rollover process initiated. (This is a placeholder for the Cloud Function trigger)."),await r("Term Rollover","Initiated term archival"))};return e.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(De,{size:18,className:"text-indigo-600"})," Batch Import Students"]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg mb-4 border border-blue-100 dark:border-blue-800 text-xs text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Format:"})," ",e.jsx("code",{children:"email, first_name, last_name, cohort"}),e.jsx("br",{}),"Example: ",e.jsx("code",{children:"student@test.edu, John, Doe, Fall 2024"})]}),e.jsx("textarea",{className:"w-full h-40 p-3 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-mono resize-y focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Paste CSV data here...",value:t,onChange:x=>c(x.target.value),disabled:d}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{onClick:u,disabled:d||!t,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 transition",children:d?"Processing...":e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:16})," Import Students"]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Xe,{size:18,className:"text-orange-500"})," Term Management"]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-sm dark:text-gray-200 mb-1",children:"End of Term Rollover"}),e.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Use this tool at the end of a semester or cohort period. It will:"}),e.jsxs("ul",{className:"list-disc list-inside text-xs text-gray-500 mt-2 space-y-1 ml-1",children:[e.jsx("li",{children:"Archive all active internship logs."}),e.jsx("li",{children:'Reset "Current Hours" counters (preserving Total Lifetime Hours).'}),e.jsx("li",{children:'Mark graduating students as "Alumni" (optional).'})]})]}),e.jsx("div",{className:"w-full md:w-auto",children:e.jsxs("button",{onClick:o,className:"w-full md:w-auto bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/40 text-red-600 dark:text-red-400 px-4 py-3 rounded-lg font-bold text-xs flex items-center justify-center gap-2 border border-red-200 dark:border-red-800 transition",children:[e.jsx(Qe,{size:16})," Execute Rollover"]})})]})]})]})}function At({schoolId:a}){const[r,t]=l.useState([]),[c,d]=l.useState(!0),[g,u]=l.useState(50);l.useEffect(()=>{a&&(async()=>{d(!0);try{const i=G(A(N,`schools/${a}/audit_logs`),J("timestamp","desc"),ue(g)),s=await z(i);t(s.docs.map(n=>({id:n.id,...n.data()})))}catch(i){console.error("Error loading audit logs:",i)}d(!1)})()},[a,g]);const o=x=>x.includes("Delete")||x.includes("Remove")?"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400":x.includes("Create")||x.includes("Add")?"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-400":x.includes("Update")||x.includes("Edit")?"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 bg-gray-100 dark:bg-gray-700 dark:text-gray-300";return c&&r.length===0?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Audit Trail..."}):e.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(Ae,{size:16}),e.jsxs("span",{children:["Showing last ",e.jsx("strong",{children:r.length})," actions"]})]}),e.jsxs("button",{onClick:()=>pe(r,"audit_logs"),className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-[#1f2128] border dark:border-gray-600 rounded-md text-xs font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx(ze,{size:14})," Export Log"]})]}),e.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 shadow-sm",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Timestamp"}),e.jsx("th",{className:"p-3",children:"Admin / Staff"}),e.jsx("th",{className:"p-3",children:"Action Type"}),e.jsx("th",{className:"p-3",children:"Details"})]})}),e.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"p-8 text-center text-gray-500",children:"No audit history found."})}):r.map(x=>{var i;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[e.jsxs("td",{className:"p-3 text-gray-500 whitespace-nowrap flex items-center gap-2",children:[e.jsx(re,{size:14,className:"opacity-50"}),(i=x.timestamp)!=null&&i.toDate?x.timestamp.toDate().toLocaleString():"N/A"]}),e.jsx("td",{className:"p-3 font-bold dark:text-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{size:14,className:"text-indigo-500"}),x.adminName||"System"]})}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider ${o(x.action)}`,children:x.action})}),e.jsx("td",{className:"p-3 text-gray-600 dark:text-gray-300 font-mono text-xs",children:x.details})]},x.id)})})]})}),r.length>=g&&e.jsx("div",{className:"text-center pt-2",children:e.jsx("button",{onClick:()=>u(x=>x+50),className:"text-xs font-bold text-indigo-600 hover:underline",children:"Load Older Logs"})})]})}function Et({schoolId:a,initialData:r,logAction:t,refreshMeta:c}){const[d,g]=l.useState(r||{}),{uploadImage:u,uploading:o}=mt();l.useEffect(()=>{r&&g(r)},[r]);const x=async()=>{try{await O($(N,"schools",a),d),alert("School settings updated successfully."),c&&c(d),await t("Update Settings","Updated school configuration")}catch(n){console.error("Update failed:",n),alert("Failed to update school settings.")}},i=async n=>{const j=n.target.files[0];if(!(!j||!a))try{const y=await u(j,`schools/${a}/images/logo`);y&&(await O($(N,"schools",a),{logoURL:y}),g(p=>({...p,logoURL:y})),c&&c({...d,logoURL:y}),await t("Update Logo","Uploaded new school logo"))}catch(y){console.error("Logo upload failed",y),alert("Failed to upload logo.")}},s=n=>{g(j=>({...j,[n]:!j[n]}))};return!d.name&&!r?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Settings..."}):e.jsxs("div",{className:"space-y-8 animate-in fade-in",children:[e.jsxs("section",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"h-32 w-32 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300 dark:border-gray-600",children:[d.logoURL?e.jsx("img",{src:d.logoURL,className:"h-full w-full object-contain",alt:"Logo"}):e.jsx(Y,{size:40,className:"text-gray-400"}),o&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center text-white text-xs",children:"Uploading..."})]}),e.jsxs("label",{className:"absolute bottom-2 right-2 bg-indigo-600 p-2 rounded-full text-white cursor-pointer shadow-lg hover:bg-indigo-700 transition",children:[e.jsx(Ze,{size:14}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:i,disabled:o})]})]}),e.jsxs("div",{className:"flex-1 w-full grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"School Name"}),e.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:d.name||"",onChange:n=>g({...d,name:n.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Primary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",className:"h-10 w-10 p-0 border-0 rounded cursor-pointer",value:d.primaryColor||"#4f46e5",onChange:n=>g({...d,primaryColor:n.target.value})}),e.jsx("input",{className:"flex-1 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-mono",value:d.primaryColor||"",onChange:n=>g({...d,primaryColor:n.target.value})})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:d.address||"",onChange:n=>g({...d,address:n.target.value})})]})]})]})]}),e.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Website"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:d.website||"",onChange:n=>g({...d,website:n.target.value}),placeholder:"https://"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Contact Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(he,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:d.contactEmail||"",onChange:n=>g({...d,contactEmail:n.target.value}),placeholder:"admin@school.edu"})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"font-bold text-lg dark:text-white border-b dark:border-gray-700 pb-2 mb-4 flex items-center gap-2",children:[e.jsx(ce,{size:18,className:"text-indigo-600"})," Academic Structure"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Cohort Mode"}),e.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:d.cohortMode||"Semester",onChange:n=>g({...d,cohortMode:n.target.value}),children:[e.jsx("option",{value:"Semester",children:"Semester Based"}),e.jsx("option",{value:"Trimester",children:"Trimester"}),e.jsx("option",{value:"Monthly",children:"Monthly"}),e.jsx("option",{value:"Rolling",children:"Rolling"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Grading Scale"}),e.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:d.gradingScale||"1-10",onChange:n=>g({...d,gradingScale:n.target.value}),children:[e.jsx("option",{value:"1-10",children:"Numeric (1-10)"}),e.jsx("option",{value:"Pass/Fail",children:"Pass/Fail"}),e.jsx("option",{value:"Letter",children:"Letter Grades"})]})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"font-bold text-lg dark:text-white border-b dark:border-gray-700 pb-2 mb-4 flex items-center gap-2",children:[e.jsx(et,{size:18,className:"text-indigo-600"})," Operational Rules"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm dark:text-white",children:"Strict Geofencing"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Require GPS location match for clock-in"})]}),e.jsx("button",{onClick:()=>s("geofencing"),children:d.geofencing?e.jsx(je,{size:24,className:"text-indigo-600"}):e.jsx(ke,{size:24,className:"text-gray-400"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm dark:text-white",children:"Supervisor Approval"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Require partner studio sign-off on hours"})]}),e.jsx("button",{onClick:()=>s("requireApproval"),children:d.requireApproval?e.jsx(je,{size:24,className:"text-indigo-600"}):e.jsx(ke,{size:24,className:"text-gray-400"})})]})]})]}),e.jsx("div",{className:"pt-4 border-t dark:border-gray-700",children:e.jsxs("button",{onClick:x,className:"w-full sm:w-auto bg-indigo-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-indigo-700 flex items-center justify-center gap-2 shadow-lg",children:[e.jsx($e,{size:18})," Save Configuration"]})})]})}function Rt({user:a,userData:r,allowedTabs:t,staffTitle:c,currentView:d}){var E;const{schoolId:g}=le(),u=d?d.replace("edu-",""):t?t[0]:"overview",[o,x]=l.useState(g||null),[i,s]=l.useState(null),[n,j]=l.useState([]),[y,p]=l.useState(!1),[f,v]=l.useState({name:"",address:"",primaryColor:"#4f46e5"}),h=(E=r==null?void 0:r.accountTypes)==null?void 0:E.includes("Admin");l.useEffect(()=>{h&&(async()=>{try{const S=(await z(A(N,"schools"))).docs.map(L=>({id:L.id,...L.data()}));j(S),!o&&!g&&S.length>0&&x(S[0].id)}catch(b){console.error("Error fetching schools list:",b)}})()},[h,o]),l.useEffect(()=>{if(!o)return;(async()=>{try{const b=G(A(N,"schools"),D("__name__","==",o)),S=await z(b);S.empty||s(S.docs[0].data())}catch(b){console.error("Error loading school meta:",b)}})()},[o]);const m=async(C,b)=>{if(o)try{await F(A(N,`schools/${o}/audit_logs`),{action:C,details:b,adminId:a.uid,adminName:`${r.firstName} ${r.lastName}`,timestamp:H()})}catch(S){console.error("Failed to log action:",S)}},w=async()=>{if(f.name)try{const C=await F(A(N,"schools"),{...f,createdAt:H(),requiredHours:100});await F(A(N,`schools/${C.id}/roles`),{name:"Admin",color:"#dc2626",permissions:xe.map(b=>b.id)}),j(b=>[...b,{id:C.id,...f}]),x(C.id),p(!1),v({name:"",address:"",primaryColor:"#4f46e5"})}catch(C){console.error("Error creating school:",C),alert("Failed to create school.")}};return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 pb-20",children:[e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6 relative overflow-hidden",children:[e.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-2 z-10",children:i!=null&&i.logoURL?e.jsx("img",{src:i.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):e.jsx(Y,{size:40,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 text-center md:text-left z-10",children:[e.jsxs("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight flex items-center justify-center md:justify-start gap-3",children:[(i==null?void 0:i.name)||"Select School",h&&!c&&e.jsxs("div",{className:"relative group",children:[e.jsx("select",{className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",value:o||"",onChange:C=>x(C.target.value),children:n.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 border-none rounded-lg text-sm font-bold p-1 px-2 flex items-center gap-1 pointer-events-none group-hover:bg-gray-200 dark:group-hover:bg-gray-600 transition",children:[e.jsx("span",{children:"Switch"})," ",e.jsx(ie,{size:10})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400 mt-1",children:[c?e.jsxs("span",{className:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:[c," Dashboard"]}):e.jsx("span",{className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Global Admin Mode"}),(i==null?void 0:i.address)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(K,{size:12})," ",i.address]})]})]})]}),h&&e.jsx("div",{className:"z-10",children:e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-indigo-700 transition shadow-md",children:[e.jsx(Z,{size:16})," New School"]})}),e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-600/5 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"})]}),e.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 min-h-[400px] p-4",children:o?e.jsxs(e.Fragment,{children:[u==="overview"&&e.jsx(ht,{schoolId:o,schoolData:i}),u==="roster"&&e.jsx(ut,{schoolId:o,logAction:m}),u==="hours"&&e.jsx(ft,{schoolId:o}),u==="instructors"&&e.jsx(jt,{schoolId:o,logAction:m}),u==="roles"&&e.jsx(kt,{schoolId:o,logAction:m}),u==="resources"&&e.jsx(Nt,{schoolId:o,logAction:m}),u==="news"&&e.jsx(vt,{schoolId:o,logAction:m,user:a,userData:r}),u==="partners"&&e.jsx(wt,{schoolId:o,logAction:m}),u==="evaluations"&&e.jsx(St,{schoolId:o,logAction:m,graderName:r.displayName}),u==="cohorts"&&e.jsx(Ct,{schoolId:o,logAction:m}),u==="audit"&&e.jsx(At,{schoolId:o}),u==="settings"&&e.jsx(Et,{schoolId:o,initialData:i,logAction:m,refreshMeta:C=>s(b=>({...b,...C}))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-gray-500",children:[e.jsx(Y,{size:48,className:"mb-4 opacity-20"}),e.jsx("p",{children:"Please select or create a school to manage."})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 space-y-4 animate-in zoom-in-95",children:[e.jsx("h3",{className:"font-bold text-xl dark:text-white",children:"Create School"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"School Name",value:f.name,onChange:C=>v({...f,name:C.target.value})}),e.jsx("button",{onClick:w,className:"w-full bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700",children:"Create"}),e.jsx("button",{onClick:()=>p(!1),className:"w-full text-gray-500 text-sm hover:underline",children:"Cancel"})]})})]})}function Vt({user:a,userData:r,currentView:t}){const{myPermissions:c,staffProfile:d}=le(),g={manage_roster:"roster",manage_enrollment:"cohorts",approve_hours:"hours",manage_partners:"partners",grade_students:"evaluations",post_announcements:"news",manage_resources:"resources",manage_staff:"instructors",view_audit:"audit",edit_settings:"settings"},u=c.includes("ALL")?Object.values(g):c.map(o=>g[o]).filter(Boolean);return u.length===0&&!c.includes("ALL")?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-gray-500",children:[e.jsx(Pe,{size:48,className:"mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-bold",children:"Access Restricted"}),e.jsx("p",{children:"You are listed as staff but have no assigned permissions."})]}):e.jsx(Rt,{user:a,userData:r,allowedTabs:u,staffTitle:d==null?void 0:d.roleName,currentView:t})}function Wt({user:a,userData:r}){const{schoolData:t,studentProfile:c,internshipStudio:d,checkIn:g,checkOut:u}=le(),[o,x]=l.useState(""),[i,s]=l.useState(!1),n=async()=>{s(!0);try{c!=null&&c.isClockedIn?(await u(o),x("")):await g((d==null?void 0:d.name)||"Remote Internship","studio")}catch(y){console.error(y)}s(!1)};if(!c)return e.jsx("div",{className:"p-8 text-center",children:"Loading student profile..."});const j=Math.min(100,(c.hoursLogged||0)/((t==null?void 0:t.requiredHours)||100)*100);return e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:"h-20 w-20 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-1",children:t!=null&&t.logoURL?e.jsx("img",{src:t.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):e.jsx(Y,{size:32,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight mb-1",children:(t==null?void 0:t.name)||"Internship Dashboard"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Active Intern"}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Cohort: ",c.cohort]})]})]}),e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("div",{className:"text-3xl font-black dark:text-white text-indigo-600",children:c.hoursLogged||0}),e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider",children:"Total Hours"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-gradient-to-br from-indigo-900 to-slate-900 text-white p-8 rounded-2xl relative overflow-hidden shadow-lg border border-indigo-800/50",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest opacity-60 mb-2",children:"Assigned Studio Location"}),e.jsx("h2",{className:"text-3xl font-extrabold mb-4 tracking-tight",children:(d==null?void 0:d.name)||"Pending Assignment"}),d?e.jsxs("div",{className:"space-y-3 text-sm opacity-90",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(K,{size:18,className:"text-indigo-400"})," ",d.address||"Address not listed"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(ge,{size:18,className:"text-green-400"})," Status: Active Placement"]})]}):e.jsxs("div",{className:"bg-white/10 p-4 rounded-xl flex items-start gap-3 border border-white/10",children:[e.jsx(tt,{className:"text-yellow-400 shrink-0 mt-0.5",size:20}),e.jsx("p",{className:"text-sm leading-relaxed",children:"You haven't been assigned an internship location yet. Please contact your school coordinator to get placed."})]})]}),e.jsx("div",{className:"absolute -right-12 -bottom-12 w-64 h-64 bg-indigo-600/20 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(re,{className:c.isClockedIn?"text-green-500 animate-pulse":"text-gray-400"}),c.isClockedIn?"Currently Working":"Time Clock"]}),c.isClockedIn&&e.jsx("textarea",{className:"w-full p-3 text-sm border rounded-xl mb-4 dark:bg-black/20 dark:border-gray-600 dark:text-white resize-none focus:ring-2 focus:ring-indigo-500 outline-none",rows:"4",placeholder:"Describe your tasks for this session...",value:o,onChange:y=>x(y.target.value)})]}),e.jsx("button",{onClick:n,disabled:i||!d&&!c.isClockedIn,className:`w-full py-3.5 rounded-xl font-bold text-white transition shadow-lg transform active:scale-95 ${i?"bg-gray-400":c.isClockedIn?"bg-red-500 hover:bg-red-600 shadow-red-500/30":"bg-green-600 hover:bg-green-700 shadow-green-600/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none"}`,children:i?"Processing...":c.isClockedIn?"Clock Out":"Clock In"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between text-sm font-bold mb-2",children:[e.jsx("span",{className:"dark:text-white",children:"Completion Progress"}),e.jsxs("span",{className:"text-indigo-600",children:[Math.round(j),"%"]})]}),e.jsx("div",{className:"w-full h-4 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-1000 ease-out",style:{width:`${j}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2 text-center",children:[c.hoursLogged," / ",(t==null?void 0:t.requiredHours)||100," Hours Required"]})]})]})}const oe=50;function Kt({user:a}){const[r,t]=l.useState(""),[c,d]=l.useState([]),[g,u]=l.useState(null),[o,x]=l.useState(""),[i,s]=l.useState((a==null?void 0:a.email)||""),[n,j]=l.useState(""),[y,p]=l.useState(!1),[f,v]=l.useState(!1),[h,m]=l.useState(!1),[w,E]=l.useState(""),[C,b]=l.useState(""),[S,L]=l.useState((a==null?void 0:a.email)||""),[T,B]=l.useState(""),[U,k]=l.useState(""),[P,I]=l.useState(!1),_=l.useMemo(()=>(g==null?void 0:g.name)||"Activate Student Access",[g]),M=async R=>{if(R.length<2){d([]);return}const ne=G(A(N,"schools"),D("name",">=",R),D("name","<=",R+"")),Me=await z(ne);d(Me.docs.map(fe=>({id:fe.id,...fe.data()})))},q=async()=>{if(!g||!o||!i){j("Please pick a school and provide your student details.");return}j(""),p(!0);try{await F(A(N,"edu_verifications"),{userId:(a==null?void 0:a.uid)||null,email:i,studentId:o,schoolId:g.id,schoolName:g.name,status:"PENDING",createdAt:H()}),v(!1)}catch(R){console.error("Verification request failed",R),j("Could not submit verification. Please try again.")}finally{p(!1)}},V=async()=>{if(!w||!S){k("School name and email are required.");return}k(""),I(!0);try{const R=await F(A(N,"edu_petitions"),{schoolName:w,city:C||null,createdBy:(a==null?void 0:a.uid)||null,email:S,signatures:a?[a.uid]:[],signatureCount:a?1:0,target:oe,status:"COLLECTING",createdAt:H()}),ne=`${window.location.origin}/edu/petition/${R.id}`;B(ne)}catch(R){console.error("Petition creation failed",R),k("Could not start petition. Please try again.")}finally{I(!1)}},be=()=>{T&&navigator.clipboard.writeText(T)};return e.jsxs("div",{className:"space-y-6 max-w-5xl mx-auto",children:[e.jsx("div",{className:"bg-white dark:bg-[#1f2128] border border-gray-200 dark:border-gray-700 rounded-2xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-300",children:e.jsx(st,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-wide text-indigo-600",children:"EDU Welcome Center"}),e.jsx("h1",{className:"text-2xl font-extrabold dark:text-white",children:"Preview first. Verify when you’re ready."}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"Access public EDU resources, then unlock full campus tools with verification."})]})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"bg-white dark:bg-[#1f2128] border border-gray-200 dark:border-gray-700 rounded-2xl p-5 shadow-sm space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-600 dark:text-amber-400 font-bold text-sm uppercase",children:[e.jsx(at,{size:16})," Student Activation"]}),e.jsx("h3",{className:"text-lg font-bold dark:text-white",children:_}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Verify your enrollment to unlock hours tracking, announcements, and internship placement."}),e.jsx("button",{className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2.5 rounded-xl transition",onClick:()=>v(!0),children:"Activate Student Access"})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1f2128] border border-gray-200 dark:border-gray-700 rounded-2xl p-5 shadow-sm space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 dark:text-emerald-400 font-bold text-sm uppercase",children:[e.jsx(Ie,{size:16})," Petition Your School"]}),e.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"School not listed?"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Start a petition link for classmates. Hit ",oe,"+ signatures and we trigger EDU sales outreach."]}),e.jsx("button",{className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2.5 rounded-xl transition",onClick:()=>m(!0),children:"Start a Petition"}),T&&e.jsxs("div",{className:"text-xs bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg p-2 flex items-center justify-between",children:[e.jsx("span",{className:"truncate",children:T}),e.jsxs("button",{onClick:be,className:"text-emerald-700 dark:text-emerald-300 hover:underline flex items-center gap-1",children:[e.jsx(Ne,{size:14}),"Copy"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1f2128] border border-gray-200 dark:border-gray-700 rounded-2xl p-5 shadow-sm space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 font-bold text-sm uppercase",children:[e.jsx(rt,{size:16})," Program Discovery"]}),e.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"Find or list a program"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Browse partner schools or request partnership info for your administrators."}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("a",{className:"text-sm font-bold text-indigo-600 hover:text-indigo-700 underline",href:"https://seshnx.com/edu-directory",target:"_blank",rel:"noreferrer",children:"Explore Partner Schools"}),e.jsx("a",{className:"text-sm font-bold text-gray-700 dark:text-gray-200 hover:text-brand-blue underline",href:"mailto:edu@seshnx.com?subject=Partnership%20Request",children:"Request Partnership Info"})]})]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-[#1f2128] w-full max-w-2xl rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase font-bold text-indigo-600",children:"Student Activation"}),e.jsx("h3",{className:"text-xl font-extrabold dark:text-white",children:"Verify your enrollment"})]}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-500 hover:text-gray-800 dark:hover:text-white text-sm font-bold",children:"Close"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-3 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search for your school...",value:r,onChange:R=>{t(R.target.value),M(R.target.value)},className:"w-full pl-10 p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white"}),r.length>0&&c.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl shadow-xl max-h-48 overflow-y-auto",children:c.map(R=>e.jsxs("div",{className:`p-3 cursor-pointer hover:bg-indigo-50 dark:hover:bg-gray-700/50 ${(g==null?void 0:g.id)===R.id?"bg-indigo-100 dark:bg-indigo-900/30":""}`,onClick:()=>{u(R),t(R.name),d([])},children:[e.jsx("div",{className:"font-medium dark:text-white",children:R.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[R.city,", ",R.state]})]},R.id))})]}),g&&e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Student ID"}),e.jsx("input",{type:"text",value:o,onChange:R=>x(R.target.value),className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g., SESH00123"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"School Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(he,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"email",value:i,onChange:R=>s(R.target.value),className:"w-full pl-9 p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"you@school.edu"})]})]})]}),n&&e.jsx("p",{className:"text-sm text-red-500",children:n}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{className:"px-4 py-2 rounded-lg border dark:border-gray-700 text-sm font-bold text-gray-600 dark:text-gray-300",onClick:()=>v(!1),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-indigo-600 text-white font-bold hover:bg-indigo-700 disabled:opacity-60",onClick:q,disabled:y,children:y?e.jsx(ve,{className:"animate-spin",size:16}):"Submit Verification"})]})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-[#1f2128] w-full max-w-xl rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase font-bold text-emerald-600",children:"Petition"}),e.jsx("h3",{className:"text-xl font-extrabold dark:text-white",children:"Start a petition for your school"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["We’ll notify the EDU team once signatures reach ",oe,"."]})]}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-500 hover:text-gray-800 dark:hover:text-white text-sm font-bold",children:"Close"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"School name"}),e.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:w,onChange:R=>E(R.target.value),placeholder:"e.g., Riverside Community College"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"City / Region"}),e.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:C,onChange:R=>b(R.target.value),placeholder:"City, State (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Your email"}),e.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:S,onChange:R=>L(R.target.value),placeholder:"name@email.com"})]}),U&&e.jsx("p",{className:"text-sm text-red-500",children:U}),T&&e.jsxs("div",{className:"flex items-center gap-2 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg p-3 text-sm",children:[e.jsx(Le,{size:16,className:"text-emerald-600"}),e.jsx("span",{className:"truncate",children:T}),e.jsxs("button",{onClick:be,className:"ml-auto text-emerald-700 dark:text-emerald-300 hover:underline flex items-center gap-1",children:[e.jsx(Ne,{size:14}),"Copy"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{className:"px-4 py-2 rounded-lg border dark:border-gray-700 text-sm font-bold text-gray-600 dark:text-gray-300",onClick:()=>m(!1),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-emerald-600 text-white font-bold hover:bg-emerald-700 disabled:opacity-60",onClick:V,disabled:P,children:P?e.jsx(ve,{className:"animate-spin",size:16}):"Generate Petition Link"})]})]})})]})}export{$t as A,Mt as D,Ht as E,X as G,Se as I,Ot as P,Ft as R,Gt as S,Bt as T,mt as a,_t as b,Ut as c,gt as d,zt as e,Kt as f,qt as g,Wt as h,Vt as i,Rt as j,Tt as k,le as u};
