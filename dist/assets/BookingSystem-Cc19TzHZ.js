const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TalentSearch-DQNuWzGu.js","assets/vendor-CzMudb4J.js","assets/chat-C8KEVgfe.js","assets/vendor-framer-BfJ9H82C.js","assets/config-yUl3KxdD.js","assets/StudioMap-Tg4P0-nJ.js","assets/vendor-maps-DsW3aofm.js","assets/vendor-maps-Dgihpmma.css","assets/SessionBuilderModal-DaijOrLC.js","assets/SessionWizard-h4AMOE5r.js","assets/edu-CvezUxxm.js"])))=>i.map(i=>d[i]);
import{_ as P}from"./edu-CvezUxxm.js";import{r as a,j as e,cz as ee,cA as te,cB as se,cC as ae,X as re,c6 as N,bW as D,cD as U,cp as de,x as V,s as ne,h as W,a0 as le,F as ie,L as z,P as oe,S as ce,aa as xe}from"./vendor-CzMudb4J.js";import{s as v,U as me}from"./chat-C8KEVgfe.js";import{C as ge,d as he}from"./vendor-calendar-D9z_S79X.js";import"./config-yUl3KxdD.js";import"./vendor-framer-BfJ9H82C.js";const be={"en-US":te},ue=he({format:ee,startOfWeek:ae,getDay:se,locales:be});function pe({events:s,onSelectSlot:l,onSelectEvent:y}){const o=a.useMemo(()=>s.map(r=>({id:r.id,title:r.targetName||"Session",start:r.date?new Date(r.date):new Date,end:r.date?new Date(new Date(r.date).getTime()+r.duration*60*60*1e3):new Date,resource:r})),[s]);return e.jsx("div",{className:"h-[600px] bg-white dark:bg-dark-card rounded-xl p-4 text-gray-800 dark:text-gray-200",children:e.jsx(ge,{localizer:ue,events:o,startAccessor:"start",endAccessor:"end",style:{height:"100%"},selectable:!0,onSelectSlot:l,onSelectEvent:y,views:["month","week","day"],defaultView:"week",eventPropGetter:r=>({className:"bg-brand-blue text-white rounded-md border-none text-xs"})})})}const B=[{id:"Pending",label:"Created",icon:N},{id:"Confirmed",label:"Deposit",icon:D},{id:"En Route",label:"En Route",icon:U},{id:"In Progress",label:"Started",icon:de},{id:"Completed",label:"Done",icon:V}];function fe({booking:s,user:l,onClose:y}){var j;const[o,r]=a.useState(s.status),[b,w]=a.useState(!1),k=l.uid===s.targetId,S=l.uid===s.senderId,c=(i=>{const u=B.findIndex(p=>p.id===i);return u===-1?0:u})(o),x=async i=>{},m=c/(B.length-1)*100;return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[90] p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-3xl rounded-2xl shadow-2xl border dark:border-gray-700 flex flex-col max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-extrabold dark:text-white flex items-center gap-2",children:["Session Details ",e.jsxs("span",{className:"text-xs bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded-full font-medium",children:["#",s.id.slice(-6).toUpperCase()]})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["With ",S?s.targetName:s.senderName]})]}),e.jsx("button",{onClick:y,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(re,{size:20})})]}),e.jsxs("div",{className:"overflow-y-auto p-6 space-y-8",children:[e.jsxs("div",{className:"relative pt-4 pb-8 px-4",children:[e.jsx("div",{className:"absolute top-8 left-0 w-full h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full -z-10"}),e.jsx("div",{className:"absolute top-8 left-0 h-1.5 bg-brand-blue rounded-full -z-10 transition-all duration-700 ease-in-out",style:{width:`${m}%`}}),e.jsx("div",{className:"flex justify-between",children:B.map((i,u)=>{const p=u<=c,f=u===c;return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`
                                                w-10 h-10 rounded-full flex items-center justify-center border-4 transition-all duration-500
                                                ${p?"bg-brand-blue border-white dark:border-[#2c2e36] text-white":"bg-gray-200 dark:bg-gray-700 border-white dark:border-[#2c2e36] text-gray-400"}
                                                ${f?"scale-125 shadow-lg ring-4 ring-blue-100 dark:ring-blue-900/50":""}
                                            `,children:e.jsx(i.icon,{size:f?18:16,fill:p?"currentColor":"none"})}),e.jsx("span",{className:`text-xs font-bold uppercase tracking-wider transition-colors ${p?"text-brand-blue":"text-gray-400"}`,children:i.label})]},i.id)})})]}),k&&o!=="Completed"&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-blue-800 dark:text-blue-300",children:"Update Session Status"}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Keep the client informed."})]}),e.jsxs("div",{className:"flex gap-2",children:[o==="Pending"&&e.jsx("button",{onClick:()=>x(),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-green-700 transition shadow-sm",children:"Accept & Confirm"}),o==="Confirmed"&&e.jsxs("button",{onClick:()=>x(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-blue-700 transition shadow-sm flex items-center gap-1",children:[e.jsx(U,{size:14})," I'm En Route"]}),o==="En Route"&&e.jsxs("button",{onClick:()=>x(),className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-purple-700 transition shadow-sm flex items-center gap-1",children:[e.jsx(ne,{size:14})," Start Session"]}),o==="In Progress"&&e.jsxs("button",{onClick:()=>x(),className:"bg-gray-900 dark:bg-white dark:text-black text-white px-4 py-2 rounded-lg font-bold text-xs hover:opacity-90 transition shadow-sm flex items-center gap-1",children:[e.jsx(V,{size:14})," Complete Session"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase border-b dark:border-gray-700 pb-2",children:"Logistics"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:e.jsx(N,{size:20,className:"text-brand-blue"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Date"}),e.jsx("div",{className:"dark:text-white font-medium",children:s.date})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:e.jsx(W,{size:20,className:"text-brand-blue"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Time"}),e.jsxs("div",{className:"dark:text-white font-medium",children:[s.time," (",s.duration," hrs)"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:e.jsx(le,{size:20,className:"text-brand-blue"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Location"}),e.jsx("div",{className:"dark:text-white font-medium",children:((j=s.venue)==null?void 0:j.name)||"Remote / TBD"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase border-b dark:border-gray-700 pb-2",children:"Financials"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:e.jsx(D,{size:20,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Total Value"}),e.jsxs("div",{className:"dark:text-white font-mono font-bold text-lg",children:["$",s.offerAmount]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:e.jsx(ie,{size:20,className:"text-gray-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Agreement"}),e.jsx("div",{className:"text-brand-blue text-xs font-bold cursor-pointer hover:underline",children:"View Contract"})]})]})]})]}),s.message&&e.jsxs("div",{className:"bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Notes"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 italic",children:['"',s.message,'"']})]})]})]})})}const ye=a.lazy(()=>P(()=>import("./TalentSearch-DQNuWzGu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),je=a.lazy(()=>P(()=>import("./SessionBuilderModal-DaijOrLC.js"),__vite__mapDeps([8,1,2,3]))),ve=a.lazy(()=>P(()=>import("./SessionWizard-h4AMOE5r.js"),__vite__mapDeps([9,1,10,2,3,4,5,6,7])));function ze({user:s,userData:l,subProfiles:y,openPublicProfile:o}){var F;const[r,b]=a.useState("my-bookings"),[w,k]=a.useState([]),[S,C]=a.useState(!0),[c,x]=a.useState(null),[m,j]=a.useState("all"),[i,u]=a.useState("all"),[p,f]=a.useState(!1),[O,E]=a.useState([]),[q,H]=a.useState(null),[K,I]=a.useState(!1),T=(F=l==null?void 0:l.accountTypes)==null?void 0:F.includes("Studio");a.useEffect(()=>{if(!(s!=null&&s.id)&&!(s!=null&&s.uid))return;const t=async()=>{C(!0);try{const n=(s==null?void 0:s.id)||(s==null?void 0:s.uid),{data:g,error:h}=await v.from("bookings").select("*").eq("sender_id",n).order("date",{ascending:!1}),{data:M,error:R}=await v.from("bookings").select("*").eq("target_id",n).order("date",{ascending:!1});if(h)throw h;if(R)throw R;const Q=[...g||[],...M||[]],Z=Array.from(new Map(Q.map(L=>[L.id,L])).values());k(Z)}catch(n){console.error("Error loading bookings:",n)}finally{C(!1)}};t();const d=v.channel("bookings-changes").on("postgres_changes",{event:"*",schema:"public",table:"bookings"},()=>{t()}).subscribe();return()=>{d.unsubscribe()}},[s==null?void 0:s.id,s==null?void 0:s.uid]);const _=w.filter(t=>{if(m!=="all"&&(m==="pending"&&t.status!=="Pending"||m==="confirmed"&&t.status!=="Confirmed"||m==="completed"&&t.status!=="Completed"||m==="cancelled"&&t.status!=="Cancelled"))return!1;if(i!=="all"){const d=(s==null?void 0:s.id)||(s==null?void 0:s.uid);if(i==="sent"&&t.sender_id!==d||i==="received"&&t.target_id!==d)return!1}return!0}),A=T?w.filter(t=>{const d=(s==null?void 0:s.id)||(s==null?void 0:s.uid);return t.target_id===d||t.sender_id===d}):[],G=t=>{if(!t||t==="Flexible")return"Flexible";try{return new Date(t).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}catch{return t}},X=t=>{if(!t||t==="Flexible")return"Flexible";try{const[d,n]=t.split(":"),g=parseInt(d),h=g>=12?"PM":"AM";return`${g%12||12}:${n} ${h}`}catch{return t}},Y=t=>{switch(t){case"Pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";case"Confirmed":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"Completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"Cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";case"Declined":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}},$=async(t,d)=>{try{const{error:n}=await v.from("bookings").update({status:d==="accept"?"Confirmed":d==="decline"?"Declined":booking.status,responded_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n}catch(n){console.error("Error updating booking:",n),alert("Failed to update booking")}},J=_.map(t=>({id:t.id,title:t.target_name||t.sender_name||"Session",start:t.date&&t.date!=="Flexible"?new Date(`${t.date}T${t.time||"12:00"}`):new Date,end:t.date&&t.date!=="Flexible"&&t.duration?new Date(new Date(`${t.date}T${t.time||"12:00"}`).getTime()+t.duration*60*60*1e3):new Date,resource:t}));return S?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(z,{className:"animate-spin text-brand-blue",size:32})}):e.jsxs("div",{className:"h-full flex flex-col p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-white",children:"Bookings"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Manage your sessions and bookings"})]}),e.jsxs("button",{onClick:()=>{I(!0),b("session-builder")},className:"flex items-center gap-2 px-4 py-2 bg-brand-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(oe,{size:18}),"New Session"]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>b("my-bookings"),className:`px-4 py-2 font-medium text-sm transition-colors ${r==="my-bookings"?"border-b-2 border-brand-blue text-brand-blue":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"My Bookings"}),e.jsx("button",{onClick:()=>b("calendar"),className:`px-4 py-2 font-medium text-sm transition-colors ${r==="calendar"?"border-b-2 border-brand-blue text-brand-blue":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"Calendar View"}),e.jsxs("button",{onClick:()=>b("find-talent"),className:`px-4 py-2 font-medium text-sm transition-colors ${r==="find-talent"?"border-b-2 border-brand-blue text-brand-blue":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[e.jsx(ce,{size:16,className:"inline mr-1"}),"Find Talent"]})]}),T&&r==="my-bookings"&&e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/10 border border-indigo-200 dark:border-indigo-800 rounded-lg p-4",children:[e.jsx("h2",{className:"text-lg font-bold text-indigo-900 dark:text-indigo-300 mb-3",children:"Studio Bookings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-indigo-800 dark:text-indigo-400 mb-2",children:["Booked Me (",A.filter(t=>t.target_id===((s==null?void 0:s.id)||(s==null?void 0:s.uid))).length,")"]}),e.jsx("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:"Bookings where clients booked your studio"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-indigo-800 dark:text-indigo-400 mb-2",children:["We Booked (",A.filter(t=>t.sender_id===((s==null?void 0:s.id)||(s==null?void 0:s.uid))).length,")"]}),e.jsx("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:"Bookings your studio made for other services"})]})]})]}),r==="my-bookings"&&e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"flex gap-4 mb-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{size:16,className:"text-gray-500"}),e.jsxs("select",{value:m,onChange:t=>j(t.target.value),className:"px-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("select",{value:i,onChange:t=>u(t.target.value),className:"px-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-sm",children:[e.jsx("option",{value:"all",children:"All Bookings"}),e.jsx("option",{value:"sent",children:"I Booked"}),e.jsx("option",{value:"received",children:"Booked Me"})]})]}),_.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(N,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No bookings found"})]}):e.jsx("div",{className:"space-y-3",children:_.map(t=>{const d=(s==null?void 0:s.id)||(s==null?void 0:s.uid),n=t.sender_id===d,g=t.target_id===d;return e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>x(t),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(me,{src:null,name:n?t.target_name:t.sender_name,size:"sm"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold dark:text-white",children:n?t.target_name:t.sender_name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n?"You booked":"Booked you"," â€¢ ",t.service_type]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{size:14}),G(t.date)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{size:14}),X(t.time)," (",t.duration,"h)"]}),t.offer_amount&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{size:14}),"$",t.offer_amount]})]}),t.message&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 line-clamp-2",children:t.message})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Y(t.status)}`,children:t.status}),g&&t.status==="Pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:h=>{h.stopPropagation(),$(t.id,"accept")},className:"px-3 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600",children:"Accept"}),e.jsx("button",{onClick:h=>{h.stopPropagation(),$(t.id,"decline")},className:"px-3 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600",children:"Decline"})]})]})]})},t.id)})})]}),r==="calendar"&&e.jsx("div",{className:"flex-1",children:e.jsx(pe,{events:J,onSelectEvent:t=>x(t.resource),onSelectSlot:t=>{console.log("New booking slot:",t)}})}),r==="find-talent"&&e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(z,{className:"animate-spin text-brand-blue",size:32})}),children:e.jsx(ye,{user:s,userData:l,openPublicProfile:o||(()=>{})})})}),r==="session-builder"&&K&&e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(z,{className:"animate-spin text-brand-blue",size:32})}),children:e.jsx(ve,{userData:l,sessionParams:q,setSessionParams:H,onNext:()=>{I(!1),f(!0)}})})}),c&&e.jsx(fe,{booking:{...c,targetId:c.target_id,senderId:c.sender_id,targetName:c.target_name,senderName:c.sender_name},user:{...s,uid:(s==null?void 0:s.id)||(s==null?void 0:s.uid)},onClose:()=>x(null)}),p&&e.jsx(a.Suspense,{fallback:null,children:e.jsx(je,{user:s,userData:l,cart:O,onRemoveFromCart:t=>{E(d=>d.filter((n,g)=>g!==t))},onClose:()=>{f(!1),b("my-bookings")},onComplete:()=>{f(!1),E([]),b("my-bookings"),window.location.reload()}})})]})}export{ze as default};
