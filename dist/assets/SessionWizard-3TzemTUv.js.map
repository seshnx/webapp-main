{"version":3,"file":"SessionWizard-3TzemTUv.js","sources":["../../src/components/SessionWizard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Calendar, Clock, MapPin, AlertCircle, ChevronRight, Search, Loader2 } from 'lucide-react';\r\nimport { supabase } from '../config/supabase';\r\nimport LocationPicker from './shared/LocationPicker';\r\n// Distance calculation is handled by inline calcDist function\r\nimport StudioMap from './shared/StudioMap';\r\n\r\n// Inline Geo Utility if not imported\r\nfunction calcDist(lat1, lon1, lat2, lon2) {\r\n  const R = 6371; \r\n  const dLat = (lat2-lat1) * (Math.PI/180); \r\n  const dLon = (lon2-lon1) * (Math.PI/180); \r\n  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n    Math.cos(lat1 * (Math.PI/180)) * Math.cos(lat2 * (Math.PI/180)) * Math.sin(dLon/2) * Math.sin(dLon/2); \r\n  return R * (2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a))) * 0.621371; // Miles\r\n}\r\n\r\nexport default function SessionWizard({ userData, sessionParams, setSessionParams, onNext }) {\r\n    const [step, setStep] = useState(1);\r\n    const [loadingStudios, setLoadingStudios] = useState(false);\r\n    const [availableStudios, setAvailableStudios] = useState([]);\r\n\r\n    // --- STEP 1: LOGISTICS ---\r\n    const handleLogisticsSubmit = (e) => {\r\n        e.preventDefault();\r\n        setStep(2);\r\n        fetchStudios();\r\n    };\r\n\r\n    // --- STEP 2: STUDIO FETCHING ---\r\n    const fetchStudios = async () => {\r\n        if (!supabase) return;\r\n        setLoadingStudios(true);\r\n        try {\r\n            // Fetch all studios with Studio account type\r\n            const { data: profilesData, error } = await supabase\r\n                .from('profiles')\r\n                .select('id, display_name, location, account_types, city, state')\r\n                .contains('account_types', ['Studio']);\r\n            \r\n            if (error) throw error;\r\n            \r\n            // Client-side filtering for distance\r\n            const filtered = (profilesData || []).filter(studio => {\r\n                if (!studio.location || !sessionParams.location) return false;\r\n                const dist = calcDist(\r\n                    sessionParams.location.lat, sessionParams.location.lng,\r\n                    studio.location.lat, studio.location.lng\r\n                );\r\n                return dist <= sessionParams.radius;\r\n            }).map(s => ({\r\n                ...s,\r\n                distance: calcDist(sessionParams.location.lat, sessionParams.location.lng, s.location.lat, s.location.lng)\r\n            })).sort((a, b) => a.distance - b.distance);\r\n\r\n            setAvailableStudios(filtered);\r\n        } catch (e) {\r\n            console.error(\"Studio fetch error:\", e);\r\n        }\r\n        setLoadingStudios(false);\r\n    };\r\n\r\n    const selectStudio = (studio) => {\r\n        setSessionParams(prev => ({ ...prev, venue: studio }));\r\n        onNext(); // Move to Talent Search/Summary\r\n    };\r\n\r\n    // --- RENDER ---\r\n    return (\r\n        <div className=\"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 shadow-sm overflow-hidden min-h-[600px]\">\r\n            {/* Header */}\r\n            <div className=\"p-6 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]\">\r\n                <h2 className=\"text-xl font-extrabold dark:text-white flex items-center gap-2\">\r\n                    <span className=\"bg-brand-blue text-white w-8 h-8 rounded-full flex items-center justify-center text-sm\">{step}</span>\r\n                    {step === 1 ? 'Session Logistics' : 'Select Studio'}\r\n                </h2>\r\n                <p className=\"text-sm text-gray-500 mt-1 ml-10\">\r\n                    {step === 1 ? 'Define the when and where.' : `Found ${availableStudios.length} studios within range.`}\r\n                </p>\r\n            </div>\r\n\r\n            {/* STEP 1: FORM */}\r\n            {step === 1 && (\r\n                <form onSubmit={handleLogisticsSubmit} className=\"p-8 space-y-6 max-w-2xl mx-auto\">\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-2 block\"><Calendar size={14} className=\"inline mr-1\"/> Date</label>\r\n                            <input \r\n                                type=\"date\" required \r\n                                className=\"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-brand-blue\"\r\n                                value={sessionParams.date}\r\n                                onChange={e => setSessionParams({...sessionParams, date: e.target.value})}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-2 block\"><Clock size={14} className=\"inline mr-1\"/> Start Time</label>\r\n                            <input \r\n                                type=\"time\" required \r\n                                className=\"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-brand-blue\"\r\n                                value={sessionParams.time}\r\n                                onChange={e => setSessionParams({...sessionParams, time: e.target.value})}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        <LocationPicker \r\n                            initialZip={userData?.zip} \r\n                            label=\"Center Location\"\r\n                            onLocationChange={(loc) => setSessionParams({...sessionParams, location: loc})}\r\n                        />\r\n                        \r\n                        <div>\r\n                            <div className=\"flex justify-between mb-2\">\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase\">Max Distance</label>\r\n                                <span className=\"text-xs font-bold text-brand-blue\">{sessionParams.radius} miles</span>\r\n                            </div>\r\n                            <input \r\n                                type=\"range\" min=\"5\" max=\"100\" step=\"5\"\r\n                                value={sessionParams.radius}\r\n                                onChange={e => setSessionParams({...sessionParams, radius: parseInt(e.target.value)})}\r\n                                className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue\"\r\n                            />\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-2 block\"><AlertCircle size={14} className=\"inline mr-1\"/> Urgency</label>\r\n                            <div className=\"flex gap-2\">\r\n                                {['Low', 'Normal', 'High'].map(u => (\r\n                                    <button\r\n                                        key={u} type=\"button\"\r\n                                        onClick={() => setSessionParams({...sessionParams, urgency: u})}\r\n                                        className={`flex-1 py-2 rounded-lg text-sm font-bold border transition ${sessionParams.urgency === u ? 'bg-brand-blue text-white border-brand-blue' : 'border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700'}`}\r\n                                    >\r\n                                        {u}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"pt-6\">\r\n                        <button type=\"submit\" className=\"w-full bg-brand-blue text-white py-4 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex justify-center items-center gap-2\">\r\n                            Find Studios <ChevronRight size={20}/>\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            )}\r\n\r\n            {/* STEP 2: STUDIO SELECTION */}\r\n            {step === 2 && (\r\n                <div className=\"flex flex-col h-[600px]\">\r\n                    {loadingStudios ? (\r\n                        <div className=\"flex-1 flex flex-col items-center justify-center\">\r\n                            <Loader2 className=\"animate-spin text-brand-blue mb-4\" size={40}/>\r\n                            <p className=\"text-gray-500\">Scouting locations...</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex-1 flex overflow-hidden\">\r\n                            {/* List */}\r\n                            <div className=\"w-full md:w-1/2 overflow-y-auto p-4 space-y-3\">\r\n                                <button onClick={() => setStep(1)} className=\"text-xs text-gray-500 hover:text-brand-blue mb-2 flex items-center gap-1\">‚Üê Change Filters</button>\r\n                                \r\n                                {/* \"No Studio Needed\" Option */}\r\n                                <div \r\n                                    onClick={() => selectStudio({ id: 'remote', name: 'Remote / TBD', address: 'No physical location set' })}\r\n                                    className=\"p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer text-center\"\r\n                                >\r\n                                    <h4 className=\"font-bold text-gray-600 dark:text-gray-300\">No Studio Needed / Remote</h4>\r\n                                    <p className=\"text-xs text-gray-400\">Skip venue selection</p>\r\n                                </div>\r\n\r\n                                {availableStudios.map(studio => (\r\n                                    <div \r\n                                        key={studio.id} \r\n                                        onClick={() => selectStudio(studio)}\r\n                                        className=\"bg-white dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-700 hover:border-brand-blue dark:hover:border-blue-500 cursor-pointer transition shadow-sm group\"\r\n                                    >\r\n                                        <div className=\"flex justify-between items-start\">\r\n                                            <h4 className=\"font-bold dark:text-white group-hover:text-brand-blue\">{studio.name || 'Studio'}</h4>\r\n                                            <span className=\"text-xs font-mono bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-600 dark:text-gray-300\">${studio.rate}/hr</span>\r\n                                        </div>\r\n                                        <p className=\"text-xs text-gray-500 mt-1 flex items-center gap-1\">\r\n                                            <MapPin size={10}/> {studio.distance.toFixed(1)} miles away\r\n                                        </p>\r\n                                        <div className=\"flex gap-1 mt-2\">\r\n                                            {(studio.equipmentList || []).slice(0, 3).map(e => (\r\n                                                <span key={e} className=\"text-[10px] bg-blue-50 dark:bg-blue-900/20 text-blue-600 px-1.5 py-0.5 rounded\">{e}</span>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                            \r\n                            {/* Map Preview */}\r\n                            <div className=\"hidden md:block w-1/2 h-full border-l dark:border-gray-700 relative\">\r\n                                <StudioMap \r\n                                    locations={availableStudios} \r\n                                    center={[sessionParams.location?.lat, sessionParams.location?.lng]} \r\n                                    height=\"100%\" \r\n                                    drawRadius={true}\r\n                                    radiusMiles={sessionParams.radius}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":["SessionWizard","userData","sessionParams","setSessionParams","onNext","step","setStep","useState","loadingStudios","setLoadingStudios","availableStudios","setAvailableStudios","handleLogisticsSubmit","e","fetchStudios","selectStudio","studio","prev","jsxs","jsx","Calendar","Clock","LocationPicker","loc","AlertCircle","u","ChevronRight","Loader2","MapPin","StudioMap","_a","_b"],"mappings":"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"}