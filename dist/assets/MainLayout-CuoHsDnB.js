const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Sidebar-BrKrNNgH.js","assets/vendor-M-mhr7Zm.js","assets/chat-Wu-U_tWR.js","assets/vendor-framer-1_AFqeeG.js","assets/edu-CtXdl24B.js","assets/config-yUl3KxdD.js","assets/index-LkwMlkJF.js","assets/index-DemKsjgZ.css","assets/Navbar-DlYKNFMy.js","assets/SeshNx-PNG cCropped white text-CY2zM0R9.js","assets/useNotifications-DcXD9djn.js","assets/PublicProfileModal-C-B_HBiK.js","assets/FollowButton-DhvsUL3r.js","assets/Dashboard-DLRdaQma.js","assets/SocialFeed-D-CE2YJd.js","assets/ReportModal-D1z5c6N5.js","assets/vendor-audio-Bu2lAtPy.js","assets/Inputs-CwjYZ5ZL.js","assets/ChatInterface-DpzE8A-G.js","assets/BookingSystem-YawePULi.js","assets/vendor-calendar-9rJJU6kO.js","assets/vendor-calendar-DxzzN9QP.css","assets/Marketplace-DonYzEs4.js","assets/TechServices-BZ3313Bz.js","assets/PaymentsManager-IApH45yC.js","assets/vendor-stripe-OXK3Micb.js","assets/ProfileManager-BX5UC7Qa.js","assets/SettingsTab-BId-CMDe.js","assets/EquipmentAutocomplete-DRIl8Sr2.js","assets/useEquipmentDatabase-DM1VkO2W.js","assets/BusinessCenter-CSFm4omO.js","assets/LegalDocs-tDua3Lfq.js"])))=>i.map(i=>d[i]);
import{S as U,_ as l}from"./edu-CtXdl24B.js";import{r as n,j as e,bT as q,bU as H,bV as G,bW as J,a as K,bH as Q,bI as X,L as M}from"./vendor-M-mhr7Zm.js";import{s as k}from"./chat-Wu-U_tWR.js";import{E as O}from"./index-LkwMlkJF.js";import"./config-yUl3KxdD.js";import"./vendor-framer-1_AFqeeG.js";function Y({activeTab:t,setActiveTab:r}){const[_,b]=n.useState(!1);if(n.useEffect(()=>{const o=()=>{b(window.innerWidth<1024)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),!_)return null;const x=[{id:"dashboard",icon:q,label:"Home"},{id:"feed",icon:H,label:"Feed"},{id:"bookings",icon:G,label:"Bookings"},{id:"messages",icon:J,label:"Messages"},{id:"profile",icon:K,label:"Profile"}];return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-[#1f2128] border-t border-gray-200 dark:border-gray-700 z-50 safe-area-bottom shadow-lg","aria-label":"Bottom navigation",style:{paddingBottom:"max(0.5rem, env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"flex justify-around items-center h-16 px-2",children:x.map(o=>{const d=o.icon,i=t===o.id;return e.jsxs("button",{onClick:()=>r(o.id),className:`flex flex-col items-center justify-center gap-1 flex-1 h-full transition-colors ${i?"text-brand-blue dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,"aria-label":o.label,"aria-current":i?"page":void 0,children:[e.jsx(d,{size:22,strokeWidth:i?2.5:2}),e.jsx("span",{className:"text-xs font-medium",children:o.label}),i&&e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-8 h-1 bg-brand-blue dark:bg-blue-400 rounded-b-full"})]},o.id)})})})}const c=(t,r=3,_=100)=>n.lazy(()=>new Promise((b,x)=>{const o=d=>{try{const i=t();i&&typeof i.then=="function"?i.then(f=>{b(f.default?f:{default:f})}).catch(f=>{d<r?(console.warn(`Lazy load failed, retrying... (${d+1}/${r})`,f),setTimeout(()=>o(d+1),_*(d+1))):(console.error("Lazy load failed after retries:",f),x(f))}):b(i)}catch(i){d<r?(console.warn(`Lazy load sync error, retrying... (${d+1}/${r})`,i),setTimeout(()=>o(d+1),_*(d+1))):(console.error("Lazy load failed after retries (sync error):",i),x(i))}};o(0)})),Z=c(()=>l(()=>import("./Sidebar-BrKrNNgH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),ee=c(()=>l(()=>import("./Navbar-DlYKNFMy.js"),__vite__mapDeps([8,1,2,3,9,10,5,6,4,7]))),se=c(()=>l(()=>import("./PublicProfileModal-C-B_HBiK.js"),__vite__mapDeps([11,1,2,3,4,5,12]))),V=c(()=>l(()=>import("./Dashboard-DLRdaQma.js"),__vite__mapDeps([13,4,1,2,3,5,10,6,7]))),te=c(()=>l(()=>import("./SocialFeed-D-CE2YJd.js"),__vite__mapDeps([14,1,2,3,15,16,5,17,12,6,4,7]))),ne=c(()=>l(()=>import("./ChatInterface-DpzE8A-G.js"),__vite__mapDeps([18,1,2,3]))),re=c(()=>l(()=>import("./BookingSystem-YawePULi.js"),__vite__mapDeps([19,4,1,2,3,5,20,21]))),ae=c(()=>l(()=>import("./Marketplace-DonYzEs4.js"),__vite__mapDeps([22,1,2,3,5,15,16]))),ie=c(()=>l(()=>import("./TechServices-BZ3313Bz.js"),__vite__mapDeps([23,1,5,2,3,17]))),oe=c(()=>l(()=>import("./PaymentsManager-IApH45yC.js"),__vite__mapDeps([24,1,2,3,5,25]))),le=c(()=>l(()=>import("./ProfileManager-BX5UC7Qa.js"),__vite__mapDeps([26,1,2,3,4,5,27,6,7,17,28,29]))),C=c(()=>l(()=>import("./BusinessCenter-CSFm4omO.js"),__vite__mapDeps([30,1,2,3,28,29,5,4]))),ce=c(()=>l(()=>import("./LegalDocs-tDua3Lfq.js"),__vite__mapDeps([31,1]))),de=c(()=>l(()=>import("./edu-CtXdl24B.js").then(t=>t.E),__vite__mapDeps([4,1,2,3,5]))),fe=c(()=>l(()=>import("./edu-CtXdl24B.js").then(t=>t.b),__vite__mapDeps([4,1,2,3,5]))),ue=c(()=>l(()=>import("./edu-CtXdl24B.js").then(t=>t.d),__vite__mapDeps([4,1,2,3,5]))),be=c(()=>l(()=>import("./edu-CtXdl24B.js").then(t=>t.c),__vite__mapDeps([4,1,2,3,5]))),W=()=>e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(M,{className:"animate-spin text-brand-blue",size:24})});function ge({user:t,userData:r,loading:_,darkMode:b,toggleTheme:x,handleLogout:o}){const d=Q(),i=X(),f=s=>s==="/"?"dashboard":s.startsWith("/feed")||s==="/social"?"feed":s.startsWith("/messages")||s.startsWith("/chat")?"messages":s.startsWith("/bookings")?"bookings":s.startsWith("/marketplace")?"marketplace":s.startsWith("/tech")?"tech":s.startsWith("/payments")||s==="/billing"?"payments":s.startsWith("/profile")?"profile":s.startsWith("/business-center")?"business-center":s==="/legal"?"legal":s.startsWith("/studio-ops")?"studio-ops":s.startsWith("/edu-")?s.substring(1).split("/")[0]:"dashboard",[h,u]=n.useState(()=>f(i.pathname)),[P,L]=n.useState(!1),[j,z]=n.useState({}),[v,N]=n.useState(0),[w,E]=n.useState(null),[B,R]=n.useState(null),p=n.useRef(!0),y=n.useRef(!1),T=n.useRef(i.pathname),S=n.useRef(!1);n.useEffect(()=>{const s=i.pathname;if(T.current===s){p.current&&(p.current=!1);return}T.current=s;const a=f(s);S.current&&(S.current=!1),u(g=>g!==a?(y.current=!0,a):g),p.current&&(p.current=!1)},[i.pathname]),n.useEffect(()=>{if(p.current)return;if(y.current){y.current=!1;return}const a={dashboard:"/",feed:"/feed",messages:"/messages",bookings:"/bookings",marketplace:"/marketplace",tech:"/tech",payments:"/payments",profile:"/profile","business-center":"/business-center",legal:"/legal","edu-student":"/edu-student","edu-intern":"/edu-intern","edu-overview":"/edu-overview","edu-admin":"/edu-admin","studio-ops":"/studio-ops"}[h];a&&!i.pathname.startsWith(a)&&(S.current=!0,d(a,{replace:!0}))},[h,d,i.pathname]),n.useEffect(()=>{if(!(t!=null&&t.id)||!k)return;(async()=>{try{const{data:a,error:g}=await k.from("sub_profiles").select("*").eq("user_id",t.id);if(g){console.warn("Error loading sub-profiles:",g);return}const I={};a==null||a.forEach(A=>{I[A.role]=A}),z(I)}catch(a){console.error("Failed to load sub-profiles:",a)}})()},[t==null?void 0:t.id]),n.useEffect(()=>{if(!(t!=null&&t.id)||!k)return;(async()=>{try{const{data:a}=await k.from("wallets").select("balance").eq("user_id",t.id).maybeSingle();a&&N(a.balance||0)}catch(a){console.warn("Failed to load token balance:",a)}})()},[t==null?void 0:t.id]);const F=async s=>{},m=n.useCallback((s,a)=>{E({uid:s,name:a})},[]),D=n.useCallback(()=>{R(null)},[]),$=()=>{if(!r||!r.id)return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-blue mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})});const s=()=>e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(M,{className:"animate-spin text-brand-blue",size:32})});switch(h){case"dashboard":return e.jsx(O,{name:"Dashboard",children:e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(O,{name:"Dashboard-Inner",children:e.jsx(V,{user:t,userData:r,setActiveTab:u,bookingCount:0,subProfiles:j,tokenBalance:v})})})});case"feed":case"social":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(te,{user:t,userData:r,openPublicProfile:m})});case"messages":case"chat":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ne,{user:t,userData:r,openPublicProfile:m,pendingChatTarget:B,clearPendingChatTarget:D})});case"bookings":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(re,{user:t,userData:r,subProfiles:j,openPublicProfile:m})});case"marketplace":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ae,{user:t,userData:r,tokenBalance:v})});case"tech":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ie,{user:t,userData:r,openPublicProfile:m})});case"payments":case"billing":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(oe,{user:t,userData:r,tokenBalance:v})});case"profile":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(le,{user:t,userData:r,subProfiles:j,handleLogout:o,openPublicProfile:m})});case"business-center":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(C,{user:t,userData:r})});case"legal":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ce,{})});case"edu-student":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(de,{user:t,userData:r})});case"edu-intern":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(fe,{user:t,userData:r})});case"edu-overview":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ue,{user:t,userData:r})});case"edu-admin":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(be,{user:t,userData:r})});case"studio-ops":return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(C,{user:t,userData:r})});default:return e.jsx(n.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(V,{user:t,userData:r,setActiveTab:u,bookingCount:0,subProfiles:j,tokenBalance:v})})}};return e.jsx(U,{user:t,userData:r,children:e.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-[#1a1d21]",children:[e.jsx(n.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(Z,{userData:r,activeTab:h,setActiveTab:u,sidebarOpen:P,setSidebarOpen:L,handleLogout:o})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(n.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(ee,{user:t,userData:r,subProfiles:j,darkMode:b,toggleTheme:x,activeTab:h,setActiveTab:u,onMenuClick:()=>L(!P),onRoleSwitch:F,openPublicProfile:m})}),e.jsx("main",{className:"flex-1 overflow-y-auto pb-16 lg:pb-0 px-fluid pt-4",children:$()})]}),e.jsx(Y,{activeTab:h,setActiveTab:u}),w&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(se,{userId:w.uid,currentUser:t,currentUserData:r,onClose:()=>E(null),onMessage:(s,a)=>{R({uid:s,name:a}),u("messages"),E(null)}})})]})})}export{ge as default};
