import{r,j as e,O as J,$ as Q,a5 as Z,L as O,q as ee,s as te,an as re,X as ne,Y as M}from"./vendor-DgLHK7fS.js";import{w as se}from"./vendor-audio-Bu2lAtPy.js";const ae="/assets/Fevicon-TMLO4Pj9.png";function le({audioUrl:a,fileName:f="Audio Track",previewMode:b=!1}){const h=r.useRef(null),d=r.useRef(null),m=r.useRef(null),y=r.useRef(null),n=r.useRef(null),g=r.useRef(null),R=r.useRef(Math.random().toString(36).substr(2,9)),u=r.useRef(null),x=r.useRef(null),i=r.useRef(null),[z,S]=r.useState(!1),[F,V]=r.useState(!1),[E,_]=r.useState(!1),[A,q]=r.useState(!1),[P,B]=r.useState(document.documentElement.classList.contains("dark")),C=r.useRef(P),w={dark:{star:"rgba(255, 255, 255, 0.5)",special:"#3D84ED",wave:"rgba(255, 255, 255, 0.3)"},light:{star:"rgba(0, 0, 0, 0.5)",special:"#2563EB",wave:"rgba(0, 0, 0, 0.2)"}},W=400,G=120,H=80,o=r.useRef({stars:[],avg:0,width:0,height:0,cx:0,cy:0});r.useEffect(()=>{const t=new MutationObserver(s=>{s.forEach(l=>{if(l.attributeName==="class"){const v=document.documentElement.classList.contains("dark");B(v),C.current=v,n.current&&n.current.setOptions({waveColor:v?w.dark.wave:w.light.wave})}})});return t.observe(document.documentElement,{attributes:!0}),()=>t.disconnect()},[]),r.useEffect(()=>{if(!m.current||!y.current)return;const t=P?w.dark:w.light;n.current=se.create({container:y.current,waveColor:t.wave,progressColor:"#3D84ED",cursorColor:"#3D84ED",barWidth:4,barGap:3,barRadius:3,height:100,responsive:!0,normalize:!0,backend:"MediaElement",media:m.current,minPxPerSec:50,fillParent:!0,interact:!b,cursorWidth:2,barAlign:"bottom"});const s=l=>{l.detail.id!==R.current&&n.current&&n.current.isPlaying()&&n.current.pause()};return window.addEventListener("seshnx-audio-play",s),n.current.on("ready",()=>V(!0)),n.current.on("play",()=>{S(!0),window.dispatchEvent(new CustomEvent("seshnx-audio-play",{detail:{id:R.current}}))}),n.current.on("pause",()=>S(!1)),n.current.on("finish",()=>{S(!1),cancelAnimationFrame(g.current)}),()=>{window.removeEventListener("seshnx-audio-play",s),n.current&&n.current.destroy(),cancelAnimationFrame(g.current)}},[a,b]),r.useEffect(()=>{const t=()=>{if(h.current&&d.current){const{clientWidth:s,clientHeight:l}=h.current;d.current.width=s,d.current.height=l,o.current.width=s,o.current.height=l,o.current.cx=s/2,o.current.cy=l/2,K()}};return window.addEventListener("resize",t),t(),()=>{window.removeEventListener("resize",t),u.current&&u.current.state!=="closed"&&u.current.close()}},[]);const K=()=>{o.current.stars=[];for(let t=0;t<W;t++)o.current.stars.push({x:Math.random()*o.current.width-o.current.cx,y:Math.random()*o.current.height-o.current.cy,z:Math.random()*o.current.width})},Y=()=>{if(!(A||E||!m.current))try{const t=window.AudioContext||window.webkitAudioContext;u.current=new t,x.current=u.current.createAnalyser(),x.current.fftSize=2048,i.current=u.current.createMediaElementSource(m.current),i.current.connect(x.current),x.current.connect(u.current.destination),q(!0)}catch(t){console.warn("Audio Context Error:",t)}},$=async t=>{var s;t.stopPropagation(),A||Y(),((s=u.current)==null?void 0:s.state)==="suspended"&&await u.current.resume(),n.current&&n.current.playPause(),z||I()},I=()=>{if(!d.current)return;const t=d.current.getContext("2d"),{width:s,height:l,cx:v,cy:T,stars:U}=o.current;let j=0;if(x.current){const c=x.current.frequencyBinCount,p=new Uint8Array(c);x.current.getByteFrequencyData(p);let N=0;for(let k=0;k<p.length;k++)N+=p[k];j=N/p.length}o.current.avg=j,t.clearRect(0,0,s,l);const D=C.current?w.dark:w.light,X=j>H?j/10:j/30+.5;U.forEach(c=>{c.z-=X,c.z<=0&&(c.z=s,c.x=Math.random()*s-v,c.y=Math.random()*l-T);const p=c.x/c.z*s+v,N=c.y/c.z*l+T,k=(1-c.z/s)*2.5;p>=0&&p<=s&&N>=0&&N<=l&&(t.fillStyle=j>G?D.special:D.star,t.globalAlpha=1-c.z/s,t.beginPath(),t.arc(p,N,k,0,Math.PI*2),t.fill(),t.globalAlpha=1)}),n.current&&n.current.isPlaying()&&(g.current=requestAnimationFrame(I))};return e.jsxs("div",{ref:h,className:"relative w-full h-32 rounded-xl overflow-hidden group bg-transparent transition-colors",children:[e.jsx("canvas",{ref:d,className:"w-full h-full absolute inset-0 z-0 pointer-events-none"}),e.jsx("div",{className:"absolute inset-0 z-20 flex flex-col justify-end pointer-events-none",children:e.jsx("div",{ref:y,className:"w-full pointer-events-auto opacity-80 hover:opacity-100 transition-opacity"})}),e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-3 z-30 flex justify-between items-start pointer-events-none",children:[e.jsxs("div",{className:"flex items-center gap-2 text-black dark:text-white/90",children:[e.jsx(J,{size:16,className:"text-brand-blue"}),e.jsx("span",{className:"text-sm font-medium truncate max-w-[200px] shadow-sm",children:f}),b&&e.jsxs("span",{className:"text-[10px] bg-yellow-500 text-black px-2 rounded font-bold flex items-center gap-1",children:[e.jsx(Q,{size:8})," PREVIEW"]})]}),E&&e.jsxs("div",{className:"bg-red-500/80 text-white text-[10px] px-2 py-0.5 rounded flex items-center gap-1",children:[e.jsx(Z,{size:10})," Visuals Disabled"]})]}),e.jsx("div",{className:"absolute bottom-2 left-2 z-30 opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none",children:e.jsx("img",{src:ae,alt:"SeshNx",className:"w-5 h-5 object-contain"})}),e.jsx("div",{className:`absolute inset-0 z-40 flex items-center justify-center transition-opacity duration-300 pointer-events-none
                ${z?"opacity-0 group-hover:opacity-100 bg-white/20 dark:bg-black/20":"opacity-100 bg-white/10 dark:bg-black/10"}`,children:F?e.jsx("button",{onClick:$,className:"w-14 h-14 bg-white/80 dark:bg-black/40 rounded-full flex items-center justify-center border border-gray-200 dark:border-white/40 text-brand-blue shadow-lg hover:scale-110 transition-transform pointer-events-auto",children:z?e.jsx(ee,{fill:"currentColor",className:"ml-0.5",size:24}):e.jsx(te,{fill:"currentColor",className:"ml-1",size:24})}):e.jsx(O,{className:"animate-spin text-brand-blue",size:32})}),e.jsx("audio",{ref:m,src:a,crossOrigin:"anonymous",onError:()=>_(!0)})]})}const L=["Spam or commercial solicitation","Harassment or bullying","Hate speech","Nudity or sexual activity","Violence or dangerous organizations","Copyright / Intellectual Property Violation","Scam or fraud","Other"],ie=async({contentId:a,contentType:f,contentSummary:b,reporterId:h,reporterName:d,reason:m,description:y="",schoolId:n=null,isFacultyAction:g=!1})=>({success:!1,error:"Supabase not initialized"});function ue({user:a,target:f,onClose:b}){const[h,d]=r.useState(L[0]),[m,y]=r.useState(""),[n,g]=r.useState(!1),[R,u]=r.useState(!1),x=async()=>{if(!(!h||!(a!=null&&a.uid))){g(!0);try{(await ie({contentId:f.id,contentType:f.type,contentSummary:f.summary,reporterId:(a==null?void 0:a.id)||(a==null?void 0:a.uid),reporterName:a.displayName||"Anonymous User",reason:h,description:m})).success?(u(!0),setTimeout(b,2e3)):alert("Failed to submit report. Please try again.")}catch(i){console.error("Submission error:",i),alert("An unexpected error occurred during submission.")}g(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:e.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-lg animate-in fade-in zoom-in-95 duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h3",{className:"font-bold text-xl dark:text-white flex items-center gap-2 text-red-500",children:[e.jsx(re,{size:24})," Report Violation"]}),e.jsx("button",{onClick:b,className:"text-gray-500 hover:text-gray-800 dark:text-gray-400 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:e.jsx(ne,{size:20})})]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 mb-6",children:["You are reporting a violation regarding: ",e.jsx("strong",{className:"font-bold",children:f.summary})," (",f.type,")"]}),R?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{size:48,className:"text-green-500 mx-auto mb-4"}),e.jsx("h4",{className:"font-bold text-lg dark:text-white",children:"Report Submitted!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for helping keep the community safe. We will review this shortly."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Reason for Report"}),e.jsx("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:h,onChange:i=>d(i.target.value),children:L.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Additional Details (Optional)"}),e.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm resize-none",rows:"3",placeholder:"Provide any further context or relevant details.",value:m,onChange:i=>y(i.target.value)})]}),e.jsx("button",{onClick:x,disabled:n,className:"w-full bg-red-600 text-white py-3 rounded-xl font-bold hover:bg-red-700 transition disabled:opacity-50 flex items-center justify-center gap-2 shadow-md",children:n?e.jsx(O,{className:"animate-spin",size:18}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:18})," Submit Report"]})})]})]})})})}export{ue as R,le as S};
