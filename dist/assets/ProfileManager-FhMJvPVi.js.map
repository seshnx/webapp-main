{"version":3,"file":"ProfileManager-FhMJvPVi.js","sources":["../../src/hooks/useSoftwareDatabase.js","../../src/hooks/useSoftwareSearch.js","../../src/components/shared/SoftwareAutocomplete.jsx","../../src/components/ProfileManager.jsx"],"sourcesContent":["// src/hooks/useSoftwareDatabase.js\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\n/**\r\n * Hook to fetch software database\r\n * TODO: Migrate to Neon software_database table queries\r\n * Currently returns empty data to prevent app crashes\r\n */\r\nexport const useSoftwareDatabase = () => {\r\n    const [dbData, setDbData] = useState({});\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // TODO: Implement Neon query for software_database table\r\n        // Example SQL needed:\r\n        // SELECT * FROM software_database WHERE verified = true ORDER BY category, subcategory, brand, name\r\n\r\n        setLoading(false);\r\n\r\n        // For now, return empty grouped structure\r\n        setDbData({});\r\n    }, []);\r\n\r\n    /**\r\n     * Search software by name, brand, or category\r\n     * TODO: Implement search with Neon\r\n     */\r\n    const searchSoftware = async (searchTerm) => {\r\n        // TODO: Implement Neon search query\r\n        console.warn('Software search not yet implemented with Neon');\r\n        return [];\r\n    };\r\n\r\n    return {\r\n        dbData,\r\n        loading,\r\n        searchSoftware\r\n    };\r\n};\r\n","import { useState, useMemo } from 'react';\r\nimport { useSoftwareDatabase } from './useSoftwareDatabase';\r\n\r\n/**\r\n * Hook for searching software database\r\n * Provides search functionality for software autocomplete/search components\r\n */\r\nexport const useSoftwareSearch = () => {\r\n    const { data: softwareData, loading } = useSoftwareDatabase();\r\n    const [results, setResults] = useState([]);\r\n    \r\n    // Flatten the database into a single searchable list\r\n    const allItems = useMemo(() => {\r\n        if (loading || !softwareData) return [];\r\n        let flattened = [];\r\n        \r\n        try {\r\n            // Iterate through categories\r\n            Object.keys(softwareData).forEach(categoryKey => {\r\n                const categoryData = softwareData[categoryKey];\r\n                if (!categoryData || typeof categoryData !== 'object') return;\r\n\r\n                // Iterate through subcategories\r\n                Object.entries(categoryData).forEach(([subcategoryKey, subcategoryItems]) => {\r\n                    if (!Array.isArray(subcategoryItems)) return;\r\n\r\n                    // Process each item in the subcategory\r\n                    subcategoryItems.forEach(item => {\r\n                        if (!item || typeof item !== 'object') return;\r\n\r\n                        // Extract data\r\n                        const brand = item.brand || 'Unknown';\r\n                        const name = item.name || item.model || 'Unknown Software';\r\n                        const subCategory = item.subCategory || subcategoryKey;\r\n                        \r\n                        // Build search string from name, brand, model, and search tokens\r\n                        const searchTokens = item.searchTokens || [];\r\n                        const searchString = [\r\n                            name,\r\n                            brand,\r\n                            item.model,\r\n                            ...searchTokens\r\n                        ].filter(Boolean).join(' ').toLowerCase();\r\n\r\n                        flattened.push({\r\n                            id: item.id,\r\n                            name: name,\r\n                            brand: brand,\r\n                            model: item.model || name,\r\n                            category: item.category || categoryKey,\r\n                            subCategory: subCategory,\r\n                            website_url: item.website_url,\r\n                            searchString: searchString,\r\n                            original: item.original || item\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n        } catch (err) {\r\n            console.warn(\"Error processing software data:\", err);\r\n        }\r\n\r\n        return flattened;\r\n    }, [softwareData, loading]);\r\n\r\n    const searchSoftware = (searchTerm) => {\r\n        if (!searchTerm || searchTerm.trim().length < 1) {\r\n            setResults([]);\r\n            return;\r\n        }\r\n\r\n        // Split user query into individual terms\r\n        const queryTerms = searchTerm.toLowerCase().trim().split(/\\s+/).filter(term => term.length > 0);\r\n        \r\n        if (queryTerms.length === 0) {\r\n            setResults([]);\r\n            return;\r\n        }\r\n        \r\n        // Filter: Item must match ALL terms\r\n        const filteredResults = allItems.filter(item => {\r\n            // Check if all query terms are found in the search string\r\n            return queryTerms.every(term => item.searchString.includes(term));\r\n        })\r\n        .slice(0, 50); // Limit results for performance\r\n\r\n        setResults(filteredResults);\r\n    };\r\n\r\n    return { searchSoftware, results, loading };\r\n};\r\n\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Search, X, Loader2, Code } from 'lucide-react';\r\nimport { useSoftwareSearch } from '../../hooks/useSoftwareSearch';\r\n\r\nexport default function SoftwareAutocomplete({ \r\n    onSelect, \r\n    placeholder = \"Search for software (e.g. Pro Tools, Kontakt)...\", \r\n    className = \"\",\r\n    value,      // Controlled value prop\r\n    onChange,   // Controlled change handler\r\n    multi = false // Toggle for comma-separated list behavior\r\n}) {\r\n    const { searchSoftware, results, loading } = useSoftwareSearch();\r\n    const [localQuery, setLocalQuery] = useState('');\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const wrapperRef = useRef(null);\r\n\r\n    // Determine value to display (Controlled vs Uncontrolled)\r\n    const displayValue = value !== undefined ? value : localQuery;\r\n\r\n    // Close dropdown when clicking outside\r\n    useEffect(() => {\r\n        function handleClickOutside(event) {\r\n            if (wrapperRef.current && !wrapperRef.current.contains(event.target)) {\r\n                setIsOpen(false);\r\n            }\r\n        }\r\n        document.addEventListener(\"mousedown\", handleClickOutside);\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    }, [wrapperRef]);\r\n\r\n    const handleInputChange = (e) => {\r\n        const val = e.target.value;\r\n        \r\n        // Update State/Parent\r\n        if (onChange) onChange(val);\r\n        else setLocalQuery(val);\r\n\r\n        // Determine Search Term\r\n        // If multi, search only the text after the last comma\r\n        const searchTerm = multi ? val.split(',').pop().trim() : val;\r\n\r\n        if (searchTerm.length >= 2) {\r\n            searchSoftware(searchTerm);\r\n            setIsOpen(true);\r\n        } else {\r\n            setIsOpen(false);\r\n        }\r\n    };\r\n\r\n    const handleSelect = (item) => {\r\n        // Construct a full display name\r\n        const fullName = item.brand !== 'Various' && item.brand !== 'Unknown' \r\n            ? `${item.brand} ${item.name}` \r\n            : item.name;\r\n            \r\n        if (multi) {\r\n            // Split by comma, remove the partial term being typed\r\n            const terms = displayValue.split(',');\r\n            terms.pop(); \r\n            \r\n            // Clean up existing terms and append the new selection\r\n            const cleanTerms = terms.map(t => t.trim()).filter(Boolean);\r\n            const newValue = [...cleanTerms, fullName].join(', ') + ', ';\r\n            \r\n            if (onChange) onChange(newValue);\r\n            else setLocalQuery(newValue);\r\n        } else {\r\n            // Standard single select behavior\r\n            if (onSelect) onSelect({ ...item, fullName });\r\n            if (onChange) onChange(fullName);\r\n            else setLocalQuery(fullName);\r\n        }\r\n        \r\n        setIsOpen(false);\r\n    };\r\n\r\n    return (\r\n        <div ref={wrapperRef} className={`relative ${className}`}>\r\n            <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-3 text-gray-400\" size={16} />\r\n                <input \r\n                    className=\"w-full pl-9 pr-8 p-3 text-sm border rounded-xl bg-white dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none transition-all\"\r\n                    placeholder={placeholder}\r\n                    value={displayValue}\r\n                    onChange={handleInputChange}\r\n                    onFocus={(e) => handleInputChange(e)} // Trigger search on focus if text exists\r\n                />\r\n                {displayValue && (\r\n                    <button \r\n                        type=\"button\"\r\n                        onClick={() => { \r\n                            if(onChange) onChange(''); \r\n                            else setLocalQuery(''); \r\n                            setIsOpen(false); \r\n                        }}\r\n                        className=\"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200\"\r\n                    >\r\n                        <X size={16}/>\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            {isOpen && results.length > 0 && (\r\n                <div className=\"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl max-h-60 overflow-y-auto animate-in fade-in slide-in-from-top-2\">\r\n                    <div className=\"py-1\">\r\n                        {results.map((item) => (\r\n                            <button\r\n                                key={item.id}\r\n                                type=\"button\"\r\n                                onClick={() => handleSelect(item)}\r\n                                className=\"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b dark:border-gray-700/50 last:border-0 group\"\r\n                            >\r\n                                <div className=\"font-bold text-sm dark:text-white group-hover:text-brand-blue transition-colors\">\r\n                                    {item.name}\r\n                                </div>\r\n                                <div className=\"text-xs text-gray-500 flex items-center gap-1.5 mt-0.5\">\r\n                                    <span className=\"font-medium text-gray-600 dark:text-gray-400\">{item.brand}</span>\r\n                                    <span className=\"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600\"></span>\r\n                                    <span className=\"opacity-75\">{item.subCategory?.replace(/_/g, ' ')}</span>\r\n                                </div>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n            \r\n            {isOpen && loading && (\r\n                <div className=\"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl p-4 text-center text-gray-500 flex items-center justify-center gap-2\">\r\n                    <Loader2 className=\"animate-spin\" size={16}/> Searching database...\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { User, Mail, MapPin, Briefcase, Music, Save, Loader2, DollarSign, Settings, Users, ChevronRight, Check, ToggleLeft, ToggleRight, Camera, Eye, ExternalLink, Image as ImageIcon } from 'lucide-react';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport * as z from 'zod';\r\nimport { clsx } from 'clsx';\r\nimport { twMerge } from 'tailwind-merge';\r\nimport { useVercelImageUpload } from '../hooks/useVercelUpload';\r\nimport toast from 'react-hot-toast';\r\nimport SettingsTab from './SettingsTab';\r\nimport { PROFILE_SCHEMAS, GENRE_DATA, INSTRUMENT_DATA } from '../config/constants';\r\nimport { MultiSelect, NestedSelect } from './shared/Inputs';\r\nimport EquipmentAutocomplete from './shared/EquipmentAutocomplete';\r\nimport SoftwareAutocomplete from './shared/SoftwareAutocomplete';\r\nimport { updateProfile, upsertSubProfile, getProfile } from '../config/neonQueries';\r\n\r\n// --- Validation Schemas ---\r\nconst mainProfileSchema = z.object({\r\n    firstName: z.string().min(2, \"First name too short\"),\r\n    lastName: z.string().min(2, \"Last name too short\"),\r\n    displayName: z.string().optional(), \r\n    bio: z.string().max(500, \"Bio exceeds 500 characters\").optional(),\r\n    zip: z.string().regex(/^\\d{5}$/, \"Invalid ZIP code\").optional().or(z.literal('')),\r\n    hourlyRate: z.number().min(0, \"Rate cannot be negative\").optional(),\r\n    website: z.string().url(\"Invalid URL\").optional().or(z.literal('')),\r\n});\r\n\r\nconst getInitials = (first, last, display) => {\r\n    if (display) return display.substring(0, 2).toUpperCase();\r\n    return ((first?.[0] || '') + (last?.[0] || '')).toUpperCase() || 'U';\r\n};\r\n\r\n// Added openPublicProfile, onSubProfileUpdate, and onRoleSwitch to props\r\nexport default function ProfileManager({ user, userData, subProfiles = {}, handleLogout, openPublicProfile, onSubProfileUpdate, onRoleSwitch }) {\r\n    const location = useLocation();\r\n    const navigate = useNavigate();\r\n\r\n    // Get active tab from URL path\r\n    const getTabFromPath = (path) => {\r\n        const parts = path.split('/').filter(Boolean);\r\n        if (parts[0] === 'profile') {\r\n            if (parts[1] === 'settings' && parts[2]) {\r\n                // Return both settings tab and sub-tab\r\n                return { mainTab: 'settings', subTab: parts[2] };\r\n            } else if (parts[1] === 'settings') {\r\n                return { mainTab: 'settings', subTab: 'general' };\r\n            }\r\n            return { mainTab: 'details', subTab: null };\r\n        }\r\n        return { mainTab: 'details', subTab: null };\r\n    };\r\n\r\n    const [activeSubTab, setActiveSubTab] = useState(() => getTabFromPath(location.pathname).mainTab);\r\n    const [selectedRole, setSelectedRole] = useState('Main');\r\n    const [saving, setSaving] = useState(false);\r\n    const { uploadImage, uploading } = useVercelImageUpload();\r\n    const [bannerUploading, setBannerUploading] = useState(false); // New state for banner\r\n\r\n    // Sync URL with active tab\r\n    useEffect(() => {\r\n        const currentTab = activeSubTab === 'details' ? '/profile' : `/profile/${activeSubTab}`;\r\n        if (location.pathname !== currentTab) {\r\n            navigate(currentTab, { replace: true });\r\n        }\r\n    }, [activeSubTab]);\r\n\r\n    // Update tab when URL changes\r\n    useEffect(() => {\r\n        const { mainTab } = getTabFromPath(location.pathname);\r\n        if (mainTab !== activeSubTab) {\r\n            setActiveSubTab(mainTab);\r\n        }\r\n    }, [location.pathname]);\r\n\r\n    // Toggle States\r\n    const [useLegalNameOnly, setUseLegalNameOnly] = useState(userData?.useLegalNameOnly || false);\r\n    const [useUserNameOnly, setUseUserNameOnly] = useState(userData?.useUserNameOnly || false);\r\n\r\n    useEffect(() => {\r\n        setUseLegalNameOnly(userData?.useLegalNameOnly || false);\r\n        setUseUserNameOnly(userData?.useUserNameOnly || false);\r\n    }, [userData]);\r\n\r\n    const toggleLegalOnly = () => {\r\n        const newVal = !useLegalNameOnly;\r\n        setUseLegalNameOnly(newVal);\r\n        if (newVal) setUseUserNameOnly(false);\r\n    };\r\n\r\n    const toggleUserOnly = () => {\r\n        const newVal = !useUserNameOnly;\r\n        setUseUserNameOnly(newVal);\r\n        if (newVal) setUseLegalNameOnly(false);\r\n    };\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        formState: { errors, isDirty }\r\n    } = useForm({\r\n        resolver: zodResolver(mainProfileSchema),\r\n        defaultValues: {\r\n            firstName: userData?.firstName || '',\r\n            lastName: userData?.lastName || '',\r\n            displayName: userData?.displayName || '',\r\n            bio: userData?.bio || '',\r\n            zip: userData?.zip || '',\r\n            hourlyRate: userData?.hourlyRate || 0,\r\n            website: userData?.website || '',\r\n        }\r\n    });\r\n\r\n    const onMainSubmit = async (data) => {\r\n        setSaving(true);\r\n        const toastId = toast.loading('Saving main profile...');\r\n        try {\r\n            let effectiveName = `${data.firstName} ${data.lastName}`;\r\n            if (useLegalNameOnly) effectiveName = `${data.firstName} ${data.lastName}`;\r\n            else if (useUserNameOnly && data.displayName) effectiveName = data.displayName;\r\n            else if (data.displayName) effectiveName = `${data.firstName} \"${data.displayName}\" ${data.lastName}`;\r\n\r\n            const searchTerms = [\r\n                data.firstName.toLowerCase(),\r\n                data.lastName.toLowerCase(),\r\n                (data.displayName || '').toLowerCase(),\r\n                effectiveName.toLowerCase()\r\n            ].filter(Boolean);\r\n\r\n            const userId = user?.id || user?.uid;\r\n\r\n            // Update main profile using Neon\r\n            await updateProfile(userId, {\r\n                first_name: data.firstName,\r\n                last_name: data.lastName,\r\n                display_name: data.displayName || null,\r\n                bio: data.bio || null,\r\n                zip: data.zip || null,\r\n                hourly_rate: data.hourlyRate || null,\r\n                website: data.website || null,\r\n                use_legal_name_only: useLegalNameOnly,\r\n                use_user_name_only: useUserNameOnly,\r\n                effective_display_name: effectiveName,\r\n                search_terms: searchTerms,\r\n            });\r\n\r\n            toast.success('Profile Updated & Synced!', { id: toastId });\r\n        } catch (error) {\r\n            console.error(\"Update failed\", error);\r\n            const errorMessage = error?.message || \"Failed to update profile.\";\r\n            toast.error(errorMessage, { id: toastId });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const handlePhotoUpload = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n        const userId = user?.id || user?.uid;\r\n        const toastId = toast.loading('Uploading photo...');\r\n        try {\r\n            const url = await uploadImage(file, 'profile-photos');\r\n\r\n            // Update profile using Neon\r\n            await updateProfile(userId, {\r\n                avatar_url: url,\r\n                photo_url: url, // Update both fields for compatibility\r\n            });\r\n\r\n            toast.success('Photo updated!', { id: toastId });\r\n        } catch (err) {\r\n            console.error(err);\r\n            const errorMessage = err?.message || 'Photo upload failed';\r\n            toast.error(errorMessage, { id: toastId });\r\n        }\r\n    };\r\n\r\n    // --- NEW: Handle Banner Upload ---\r\n    const handleBannerUpload = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n        const userId = user?.id || user?.uid;\r\n        setBannerUploading(true);\r\n        const toastId = toast.loading('Uploading cover banner...');\r\n        try {\r\n            // Upload to Vercel Blob\r\n            const url = await uploadImage(file, 'profile-banners');\r\n\r\n            // Update profile using Neon\r\n            await updateProfile(userId, {\r\n                banner_url: url,\r\n            });\r\n\r\n            toast.success('Cover banner updated!', { id: toastId });\r\n        } catch (err) {\r\n            console.error(err);\r\n            const errorMessage = err?.message || 'Banner upload failed';\r\n            toast.error(errorMessage, { id: toastId });\r\n        } finally {\r\n            setBannerUploading(false);\r\n        }\r\n    };\r\n\r\n    const handleSettingsUpdate = async (newSettings) => {\r\n        const userId = user?.id || user?.uid;\r\n        try {\r\n            // Update settings using Neon\r\n            await updateProfile(userId, {\r\n                settings: newSettings,\r\n            });\r\n\r\n            toast.success(\"Settings saved.\");\r\n        } catch (error) {\r\n            console.error(\"Settings save failed\", error);\r\n            const errorMessage = error?.message || \"Failed to save settings.\";\r\n            toast.error(errorMessage);\r\n        }\r\n    };\r\n\r\n    const inputClass = (error) => twMerge(\r\n        \"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none\",\r\n        error ? \"border-red-500 bg-red-50 dark:bg-red-900/10\" : \"border-gray-200 dark:border-gray-700\"\r\n    );\r\n\r\n    return (\r\n        <div className=\"max-w-5xl mx-auto space-y-6 pb-20\">\r\n            {/* Top Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <h1 className=\"text-3xl font-bold dark:text-white flex items-center gap-2\">\r\n                    <User className=\"text-brand-blue\"/> {activeSubTab === 'details' ? 'Edit Profile' : 'Account Settings'}\r\n                </h1>\r\n                \r\n                <div className=\"flex gap-3 self-end\">\r\n                    {/* NEW: View Public Profile Button */}\r\n                    <button \r\n                        onClick={() => openPublicProfile(user?.id || user?.uid)} \r\n                        className=\"bg-gray-900 dark:bg-white text-white dark:text-black px-4 py-2 rounded-xl font-bold text-sm flex items-center gap-2 hover:opacity-90 transition shadow-lg\"\r\n                    >\r\n                        <Eye size={16}/> View Public Profile\r\n                    </button>\r\n\r\n                    <div className=\"bg-gray-100 dark:bg-gray-800 p-1 rounded-lg flex gap-1\">\r\n                        <button onClick={() => setActiveSubTab('details')} className={`px-4 py-2 text-xs font-bold rounded-md transition-all ${activeSubTab === 'details' ? 'bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm' : 'text-gray-500 hover:text-gray-900 dark:hover:text-gray-300'}`}>Edit Details</button>\r\n                        <button onClick={() => setActiveSubTab('settings')} className={`px-4 py-2 text-xs font-bold rounded-md transition-all flex items-center gap-1 ${activeSubTab === 'settings' ? 'bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm' : 'text-gray-500 hover:text-gray-900 dark:hover:text-gray-300'}`}><Settings size={14}/> Settings</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Content Area */}\r\n            {activeSubTab === 'details' ? (\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8 animate-in fade-in slide-in-from-bottom-2\">\r\n                    {/* Left Sidebar */}\r\n                    <div className=\"lg:col-span-1 space-y-2\">\r\n                        <div className=\"font-bold text-xs text-gray-500 uppercase tracking-wider mb-2 px-1\">Profiles</div>\r\n                        <button onClick={() => setSelectedRole('Main')} className={`w-full flex items-center justify-between p-3 rounded-xl transition-all ${selectedRole === 'Main' ? 'bg-brand-blue text-white shadow-md' : 'bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200'}`}><div className=\"flex items-center gap-2\"><User size={16}/> <span className=\"font-bold text-sm\">Main Profile</span></div>{selectedRole === 'Main' && <ChevronRight size={16}/>}</button>\r\n                        {(userData?.accountTypes || []).map(role => {\r\n                            if (!PROFILE_SCHEMAS[role]) return null;\r\n                            return <button key={role} onClick={() => setSelectedRole(role)} className={`w-full flex items-center justify-between p-3 rounded-xl transition-all ${selectedRole === role ? 'bg-brand-blue text-white shadow-md' : 'bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200'}`}><div className=\"flex items-center gap-2\"><Briefcase size={16}/> <span className=\"font-bold text-sm\">{role}</span></div>{selectedRole === role && <ChevronRight size={16}/>}</button>;\r\n                        })}\r\n                    </div>\r\n\r\n                    {/* Right Column */}\r\n                    <div className=\"lg:col-span-3\">\r\n                        {selectedRole === 'Main' ? (\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\r\n                                <div className=\"md:col-span-1 space-y-6\">\r\n                                    {/* Avatar Upload */}\r\n                                    <div className=\"space-y-2\">\r\n                                        <div className=\"text-xs font-bold text-gray-500 uppercase\">Profile Photo</div>\r\n                                        <div className=\"relative group w-full aspect-square rounded-full overflow-hidden bg-gray-100 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 shadow-md\">\r\n                                            {userData?.photoURL ? <img src={userData.photoURL} alt=\"Profile\" className=\"w-full h-full object-cover\" /> : <div className=\"flex items-center justify-center h-full bg-gradient-to-tr from-brand-blue to-purple-500 text-white font-bold text-4xl\">{getInitials(userData?.firstName, userData?.lastName, userData?.displayName)}</div>}\r\n                                            <label className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity\"><span className=\"text-white font-bold text-sm flex items-center gap-1\"><Camera size={16}/> Change</span><input type=\"file\" className=\"hidden\" accept=\"image/*\" onChange={handlePhotoUpload} disabled={uploading} /></label>\r\n                                            {uploading && <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\"><Loader2 className=\"animate-spin text-white\"/></div>}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* NEW: Banner Upload */}\r\n                                    <div className=\"space-y-2\">\r\n                                        <div className=\"text-xs font-bold text-gray-500 uppercase\">Cover Banner</div>\r\n                                        <div className=\"relative group w-full aspect-[3/1] rounded-xl overflow-hidden bg-gray-100 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 shadow-sm\">\r\n                                            {userData?.bannerURL ? (\r\n                                                <img src={userData.bannerURL} alt=\"Banner\" className=\"w-full h-full object-cover\" />\r\n                                            ) : (\r\n                                                <div className=\"w-full h-full flex items-center justify-center text-gray-400\">\r\n                                                    <ImageIcon size={24}/>\r\n                                                </div>\r\n                                            )}\r\n                                            <label className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity\">\r\n                                                <span className=\"text-white font-bold text-xs flex items-center gap-1\"><Camera size={14}/> Upload Cover</span>\r\n                                                <input type=\"file\" className=\"hidden\" accept=\"image/*\" onChange={handleBannerUpload} disabled={bannerUploading} />\r\n                                            </label>\r\n                                            {bannerUploading && <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\"><Loader2 className=\"animate-spin text-white\"/></div>}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl text-xs text-blue-800 dark:text-blue-200\"><p className=\"font-bold mb-1\">Pro Tip:</p>High-quality profile photos & banners increase booking rates by 40%.</div>\r\n                                </div>\r\n\r\n                                <div className=\"md:col-span-2\">\r\n                                    <form onSubmit={handleSubmit(onMainSubmit)} className=\"space-y-6 bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm\">\r\n                                        <div className=\"grid grid-cols-2 gap-4\">\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">First Name (Legal)</label><input {...register(\"firstName\")} className={inputClass(errors.firstName)} /></div>\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Last Name (Legal)</label><input {...register(\"lastName\")} className={inputClass(errors.lastName)} /></div>\r\n                                        </div>\r\n                                        <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">User Name (Display Name)</label><input {...register(\"displayName\")} className={inputClass(errors.displayName)} placeholder=\"e.g. SeshMaster\" /></div>\r\n                                        \r\n                                        {/* Name Toggle Logic */}\r\n                                        <div className=\"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3\">\r\n                                            <label className=\"text-xs font-bold text-gray-500 uppercase block mb-1\">Display Name Preferences</label>\r\n                                            <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use Legal Name Only</span><button type=\"button\" onClick={toggleLegalOnly} className=\"text-brand-blue\">{useLegalNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                                            <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use User Name Only</span><button type=\"button\" onClick={toggleUserOnly} className=\"text-brand-blue\">{useUserNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                                            <div className=\"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2\">Preview: <strong className=\"text-brand-blue\">{useLegalNameOnly ? `${userData?.firstName || ''} ${userData?.lastName || ''}`.trim() || 'Not Set' : useUserNameOnly ? (userData?.displayName || 'Not Set') : `${userData?.firstName || ''} \"${userData?.displayName || 'User'}\" ${userData?.lastName || ''}`.trim() || 'Not Set'}</strong></div>\r\n                                        </div>\r\n\r\n                                        <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Bio / About</label><textarea {...register(\"bio\")} rows=\"4\" className={inputClass(errors.bio)} placeholder=\"Tell us about your musical journey...\" /></div>\r\n                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1\"><MapPin size={12}/> ZIP Code</label><input {...register(\"zip\")} className={inputClass(errors.zip)} /></div>\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1\"><DollarSign size={12}/> Hourly Rate ($)</label><input type=\"number\" {...register(\"hourlyRate\", { valueAsNumber: true })} className={inputClass(errors.hourlyRate)} /></div>\r\n                                        </div>\r\n                                        <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Website</label><input {...register(\"website\")} className={inputClass(errors.website)} placeholder=\"https://...\" /></div>\r\n\r\n                                        <div className=\"pt-4 border-t dark:border-gray-700 flex justify-end\">\r\n                                            <button type=\"button\" onClick={handleSubmit(onMainSubmit)} disabled={saving} className={clsx(\"px-8 py-3 rounded-xl font-bold flex items-center gap-2 transition-all shadow-lg\", saving ? \"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed\" : \"bg-brand-blue text-white hover:bg-blue-600 hover:scale-105\")}>{saving ? <Loader2 className=\"animate-spin\" size={20}/> : <><Save size={20}/> Save Changes</>}</button>\r\n                                        </div>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <DynamicSubProfileForm\r\n                                user={user}\r\n                                userData={userData}\r\n                                role={selectedRole}\r\n                                initialData={subProfiles[selectedRole] || {}}\r\n                                schema={PROFILE_SCHEMAS[selectedRole] || []}\r\n                                onSave={onSubProfileUpdate}\r\n                            />\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                <div className=\"animate-in fade-in slide-in-from-right-2\"><SettingsTab user={user} userData={userData} handleLogout={handleLogout} onUpdate={handleSettingsUpdate} onRoleSwitch={onRoleSwitch} subProfiles={subProfiles}/></div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n// ... (DynamicSubProfileForm remains unchanged from previous version) ...\r\nfunction DynamicSubProfileForm({ user, userData, role, initialData, schema, onSave }) {\r\n    const [formData, setFormData] = useState(initialData);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [followMainProfile, setFollowMainProfile] = useState(initialData.followMainProfile ?? true);\r\n    const [useLegalNameOnly, setUseLegalNameOnly] = useState(initialData.useLegalNameOnly ?? false);\r\n    const [useUserNameOnly, setUseUserNameOnly] = useState(initialData.useUserNameOnly ?? false);\r\n    const [syncStudioOps, setSyncStudioOps] = useState(initialData.syncStudioOps ?? false);\r\n\r\n    useEffect(() => { \r\n        setFormData(initialData || {}); \r\n        setFollowMainProfile(initialData.followMainProfile ?? true);\r\n        setUseLegalNameOnly(initialData.useLegalNameOnly ?? false);\r\n        setUseUserNameOnly(initialData.useUserNameOnly ?? false);\r\n        setSyncStudioOps(initialData.syncStudioOps ?? false);\r\n    }, [initialData]);\r\n\r\n    const handleChange = (key, value) => setFormData(prev => ({ ...prev, [key]: value }));\r\n    const toggleLegalOnly = () => { setUseLegalNameOnly(!useLegalNameOnly); if(!useLegalNameOnly) setUseUserNameOnly(false); };\r\n    const toggleUserOnly = () => { setUseUserNameOnly(!useUserNameOnly); if(!useUserNameOnly) setUseLegalNameOnly(false); };\r\n\r\n    const handleSave = async (e) => {\r\n        e.preventDefault();\r\n        setIsSaving(true);\r\n        const toastId = toast.loading(`Saving ${role} profile...`);\r\n        try {\r\n            let effectiveName = '';\r\n            if (followMainProfile) effectiveName = userData?.effectiveDisplayName || (userData ? `${userData.firstName || ''} ${userData.lastName || ''}`.trim() : '');\r\n            else {\r\n                if (useLegalNameOnly) effectiveName = userData ? `${userData.firstName || ''} ${userData.lastName || ''}`.trim() : '';\r\n                else if (useUserNameOnly) effectiveName = userData?.displayName || (userData ? `${userData.firstName || ''} ${userData.lastName || ''}`.trim() : '');\r\n                else effectiveName = formData.profileName || `${userData.firstName} ${userData.lastName}`;\r\n            }\r\n\r\n            const userId = user?.id || user?.uid;\r\n\r\n            // Save sub-profile data using Neon\r\n            const dataToSave = { ...formData, followMainProfile, useLegalNameOnly, useUserNameOnly, syncStudioOps, displayName: effectiveName };\r\n\r\n            // Upsert sub-profile\r\n            await upsertSubProfile(userId, role, dataToSave);\r\n\r\n            // Update main profile if this is the active role\r\n            if (userData.activeProfileRole === role) {\r\n                await updateProfile(userId, {\r\n                    display_name: effectiveName,\r\n                    effective_display_name: effectiveName,\r\n                    search_terms: [effectiveName.toLowerCase()],\r\n                });\r\n            }\r\n\r\n            // Update studio name if applicable\r\n            if (role === 'Studio' && syncStudioOps) {\r\n                await updateProfile(userId, {\r\n                    studio_name: effectiveName,\r\n                });\r\n            }\r\n\r\n            // Refresh sub-profiles in parent component\r\n            if (onSave) {\r\n                await onSave();\r\n            }\r\n\r\n            toast.success(`${role} Profile Saved!`, { id: toastId });\r\n        } catch (err) {\r\n            console.error(err);\r\n            const errorMessage = err?.message || \"Failed to save.\";\r\n            toast.error(errorMessage, { id: toastId });\r\n        }\r\n        finally { setIsSaving(false); }\r\n    };\r\n\r\n    if (schema.length === 0) return <div className=\"p-10 text-center text-gray-500\">No configuration available for this role.</div>;\r\n    \r\n    const currentSubRole = formData.talentSubRole || '';\r\n    const filteredSchema = schema.filter(f => {\r\n        if (f.key === 'profileName' || f.key === 'useRealName') return false;\r\n        if (f.showFor && Array.isArray(f.showFor)) {\r\n            return f.showFor.includes(currentSubRole);\r\n        }\r\n        return true;\r\n    });\r\n\r\n    return (\r\n        <form onSubmit={handleSave} className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm space-y-6\">\r\n            <h2 className=\"text-xl font-bold dark:text-white border-b dark:border-gray-700 pb-2\">{role} Identity & Details</h2>\r\n            \r\n            <div className=\"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3\">\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase block mb-1\">Identity Settings</label>\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div><div className=\"text-sm font-bold dark:text-white\">Follow Main Profile Name</div><div className=\"text-xs text-gray-500\">Use &quot;{userData.effectiveDisplayName || `${userData.firstName} ${userData.lastName}`}&quot;</div></div>\r\n                    <button type=\"button\" onClick={() => setFollowMainProfile(!followMainProfile)} className=\"text-brand-blue\">{followMainProfile ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button>\r\n                </div>\r\n                {!followMainProfile && (\r\n                    <div className=\"space-y-3 animate-in slide-in-from-top-1 pt-3 border-t dark:border-gray-700\">\r\n                         <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use Legal Name Only</span><button type=\"button\" onClick={toggleLegalOnly} className=\"text-brand-blue\">{useLegalNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                        <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use Main User Name Only</span><button type=\"button\" onClick={toggleUserOnly} className=\"text-brand-blue\">{useUserNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                        {!useLegalNameOnly && !useUserNameOnly && (\r\n                            <div className=\"mt-2\">\r\n                                <label className=\"text-xs font-bold text-brand-blue uppercase mb-1 block\">{role} Name</label>\r\n                                <input type=\"text\" className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none font-bold\" placeholder={`e.g. ${role === 'Studio' ? 'Sound City' : 'The Weeknd'}`} value={formData.profileName || ''} onChange={e => handleChange('profileName', e.target.value)} />\r\n                                {role === 'Studio' && (<div className=\"flex items-center gap-2 mt-2\"><input type=\"checkbox\" checked={syncStudioOps} onChange={(e) => setSyncStudioOps(e.target.checked)} className=\"rounded text-brand-blue focus:ring-brand-blue\"/><span className=\"text-xs text-gray-500 dark:text-gray-400\">Force &quot;Studio Ops&quot; to use this name</span></div>)}\r\n                            </div>\r\n                        )}\r\n                         <div className=\"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2\">Preview: <strong className=\"text-brand-blue\">{useLegalNameOnly ? `${userData.firstName} ${userData.lastName}` : useUserNameOnly ? (userData.displayName || 'Not Set') : (formData.profileName || 'Not Set')}</strong></div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {filteredSchema.map((field) => {\r\n                if (field.isToggle) return null; \r\n                return (\r\n                    <div key={field.key}>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">{field.label}</label>\r\n                        {field.type === 'textarea' ? (\r\n                            <textarea className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none\" rows={4} value={formData[field.key] || ''} onChange={e => handleChange(field.key, e.target.value)} />\r\n                        ) : field.type === 'select' ? (\r\n                            <select className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none\" value={formData[field.key] || ''} onChange={e => handleChange(field.key, e.target.value)}>{field.options?.map(opt => <option key={opt} value={opt}>{opt}</option>)}</select>\r\n                        ) : field.type === 'multi_select' ? (\r\n                            <MultiSelect label=\"\" fieldKey={field.key} options={field.data || field.options || []} initialValues={formData[field.key] || []} onChange={handleChange} />\r\n                        ) : field.type === 'nested_select' ? (\r\n                            <NestedSelect label=\"\" fieldKey={field.key} data={field.data} initialValues={formData[field.key] || []} onChange={handleChange} />\r\n                        ) : field.key === 'equipment' ? (\r\n                                <EquipmentAutocomplete \r\n                                    multi={true} \r\n                                    value={formData[field.key] || ''} \r\n                                    onChange={(val) => handleChange(field.key, val)}\r\n                                    placeholder=\"Add gear...\" \r\n                                />\r\n                        ) : field.key === 'daw' ? (\r\n                                <SoftwareAutocomplete \r\n                                    multi={field.type === 'multi_select'} \r\n                                    value={formData[field.key] || ''} \r\n                                    onChange={(val) => handleChange(field.key, val)}\r\n                                    placeholder=\"Search for DAW or software...\" \r\n                                />\r\n                        ) : field.key === 'software' || field.key === 'softwareList' ? (\r\n                                <SoftwareAutocomplete \r\n                                    multi={true} \r\n                                    value={formData[field.key] || ''} \r\n                                    onChange={(val) => handleChange(field.key, val)}\r\n                                    placeholder=\"Add software...\" \r\n                                />\r\n                        ) : (\r\n                            <input type={field.type === 'number' ? 'number' : 'text'} className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none\" value={formData[field.key] || ''} onChange={e => handleChange(field.key, e.target.value)} />\r\n                        )}\r\n                    </div>\r\n                );\r\n            })}\r\n\r\n            <div className=\"pt-4 border-t dark:border-gray-700 flex justify-end\">\r\n                <button type=\"submit\" disabled={isSaving} className=\"px-8 py-3 rounded-xl font-bold bg-brand-blue text-white hover:bg-blue-600 flex items-center gap-2 transition shadow-lg disabled:opacity-50\">{isSaving ? <Loader2 className=\"animate-spin\" size={20}/> : <><Save size={20}/> Save {role} Profile</>}</button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n"],"names":["useSoftwareDatabase","dbData","setDbData","useState","loading","setLoading","useEffect","searchTerm","useSoftwareSearch","softwareData","results","setResults","allItems","useMemo","flattened","categoryKey","categoryData","subcategoryKey","subcategoryItems","item","brand","name","subCategory","searchTokens","searchString","err","queryTerms","term","filteredResults","SoftwareAutocomplete","onSelect","placeholder","className","value","onChange","multi","searchSoftware","localQuery","setLocalQuery","isOpen","setIsOpen","wrapperRef","useRef","displayValue","handleClickOutside","event","handleInputChange","e","val","handleSelect","fullName","terms","newValue","t","jsxs","jsx","Search","X","Loader2","mainProfileSchema","z.object","z.string","z.literal","z.number","getInitials","first","last","display","ProfileManager","user","userData","subProfiles","handleLogout","openPublicProfile","onSubProfileUpdate","onRoleSwitch","location","useLocation","navigate","useNavigate","getTabFromPath","path","parts","activeSubTab","setActiveSubTab","selectedRole","setSelectedRole","saving","setSaving","uploadImage","uploading","useVercelImageUpload","bannerUploading","setBannerUploading","currentTab","mainTab","useLegalNameOnly","setUseLegalNameOnly","useUserNameOnly","setUseUserNameOnly","toggleLegalOnly","newVal","toggleUserOnly","register","handleSubmit","errors","isDirty","useForm","zodResolver","onMainSubmit","data","toastId","toast","effectiveName","searchTerms","userId","updateProfile","error","errorMessage","handlePhotoUpload","file","url","handleBannerUpload","handleSettingsUpdate","newSettings","inputClass","twMerge","User","Eye","Settings","ChevronRight","role","PROFILE_SCHEMAS","Briefcase","Camera","ImageIcon","ToggleRight","ToggleLeft","MapPin","DollarSign","clsx","Fragment","Save","DynamicSubProfileForm","SettingsTab","initialData","schema","onSave","formData","setFormData","isSaving","setIsSaving","followMainProfile","setFollowMainProfile","syncStudioOps","setSyncStudioOps","handleChange","key","prev","handleSave","dataToSave","upsertSubProfile","currentSubRole","filteredSchema","f","field","_a","opt","MultiSelect","NestedSelect","EquipmentAutocomplete"],"mappings":"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"}