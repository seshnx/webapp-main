import{r as h}from"./vendor-mIyI6DiM.js";import{S as T,e as E,v as M,u as F}from"./chat-P1NCmzAv.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},l=new t.Error().stack;l&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[l]="5afe7e0f-7720-47af-94f7-5c6adac110de",t._sentryDebugIdIdentifier="sentry-dbid-5afe7e0f-7720-47af-94f7-5c6adac110de")})()}catch{}const _=(t="general")=>{const[l,o]=h.useState(!1),[c,s]=h.useState(null),[p,a]=h.useState(0),g=async(r,y=null,i={})=>{if(!r)return null;const n=i.maxSizeMB||10;if(!M(r,n)){const e=`File size exceeds ${n}MB limit`;return s(e),console.error(e),null}if(i.allowedTypes&&!i.allowedTypes.includes(r.type)){const e=`File type not allowed. Allowed types: ${i.allowedTypes.join(", ")}`;return s(e),console.error(e),null}o(!0),s(null),a(0);try{let e="file";r.type.startsWith("video/")?e="video":r.type.startsWith("audio/")?e="audio":r.type.startsWith("image/")&&(e="image");const m=Date.now(),w=r.name.replace(/[^a-zA-Z0-9._-]/g,"_"),d=Math.random().toString(36).substring(2,8),f=`${m}_${d}_${w}`,b=y||t;a(20);const u=await F(r,b,{customFileName:f});a(100);const S={url:u.url,previewUrl:u.url,storageRef:u.pathname,type:e,name:r.name,size:r.size,mimeType:r.type,contentType:u.contentType,uploadedAt:u.uploadedAt,downloadUrl:u.downloadUrl};return o(!1),a(0),S}catch(e){return console.error("Upload failed:",e),s(e.message||"An unknown error occurred during upload."),o(!1),a(0),null}};return{uploadMedia:g,uploadMultiple:async(r,y=null,i={})=>{if(!r||r.length===0)return[];o(!0),s(null),a(0);try{const n=Array.from(r),e=[],m=n.length,w=y||t;for(let d=0;d<n.length;d++){a(Math.round((d+1)/m*100));const f=await g(n[d],w,i);f&&e.push(f)}return a(100),o(!1),e}catch(n){return console.error("Batch upload failed:",n),s(n.message||"Batch upload failed"),o(!1),a(0),[]}},uploading:l,error:c,progress:p,isUploading:l,hasError:!!c,clearError:()=>s(null)}},U=(t={})=>{const{uploadMedia:l,uploading:o,error:c}=_();return{uploadImage:async(p,a=T.PROFILE_PHOTOS)=>{if(!p)return null;if(!E(p))return console.error("File is not an image"),null;const g={maxSizeMB:5,allowedTypes:["image/jpeg","image/png","image/gif","image/webp"],...t};return await l(p,a,g)},uploading:o,error:c,isUploading:o,hasError:!!c}};export{_ as a,U as u};
