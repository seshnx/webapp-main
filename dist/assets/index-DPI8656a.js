var Xz=Object.defineProperty;var Jz=(t,e,n)=>e in t?Xz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $b=(t,e,n)=>Jz(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var eB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function WP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var HP={exports:{}},dv={},GP={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wp=Symbol.for("react.element"),tB=Symbol.for("react.portal"),nB=Symbol.for("react.fragment"),rB=Symbol.for("react.strict_mode"),sB=Symbol.for("react.profiler"),iB=Symbol.for("react.provider"),oB=Symbol.for("react.context"),aB=Symbol.for("react.forward_ref"),lB=Symbol.for("react.suspense"),cB=Symbol.for("react.memo"),uB=Symbol.for("react.lazy"),I2=Symbol.iterator;function dB(t){return t===null||typeof t!="object"?null:(t=I2&&t[I2]||t["@@iterator"],typeof t=="function"?t:null)}var KP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QP=Object.assign,ZP={};function Rh(t,e,n){this.props=t,this.context=e,this.refs=ZP,this.updater=n||KP}Rh.prototype.isReactComponent={};Rh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Rh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function YP(){}YP.prototype=Rh.prototype;function rN(t,e,n){this.props=t,this.context=e,this.refs=ZP,this.updater=n||KP}var sN=rN.prototype=new YP;sN.constructor=rN;QP(sN,Rh.prototype);sN.isPureReactComponent=!0;var A2=Array.isArray,XP=Object.prototype.hasOwnProperty,iN={current:null},JP={key:!0,ref:!0,__self:!0,__source:!0};function eL(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)XP.call(e,r)&&!JP.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Wp,type:t,key:i,ref:a,props:s,_owner:iN.current}}function hB(t,e){return{$$typeof:Wp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function oN(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wp}function fB(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var R2=/\/+/g;function Ub(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fB(""+t.key):e.toString(36)}function Ky(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Wp:case tB:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Ub(a,0):r,A2(s)?(n="",t!=null&&(n=t.replace(R2,"$&/")+"/"),Ky(s,e,n,"",function(d){return d})):s!=null&&(oN(s)&&(s=hB(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(R2,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",A2(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Ub(i,l);a+=Ky(i,e,n,u,s)}else if(u=dB(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Ub(i,l++),a+=Ky(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function cy(t,e,n){if(t==null)return t;var r=[],s=0;return Ky(t,r,"","",function(i){return e.call(n,i,s++)}),r}function mB(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Kr={current:null},Qy={transition:null},pB={ReactCurrentDispatcher:Kr,ReactCurrentBatchConfig:Qy,ReactCurrentOwner:iN};function tL(){throw Error("act(...) is not supported in production builds of React.")}wt.Children={map:cy,forEach:function(t,e,n){cy(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return cy(t,function(){e++}),e},toArray:function(t){return cy(t,function(e){return e})||[]},only:function(t){if(!oN(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};wt.Component=Rh;wt.Fragment=nB;wt.Profiler=sB;wt.PureComponent=rN;wt.StrictMode=rB;wt.Suspense=lB;wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pB;wt.act=tL;wt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=QP({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=iN.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)XP.call(e,u)&&!JP.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Wp,type:t.type,key:s,ref:i,props:r,_owner:a}};wt.createContext=function(t){return t={$$typeof:oB,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:iB,_context:t},t.Consumer=t};wt.createElement=eL;wt.createFactory=function(t){var e=eL.bind(null,t);return e.type=t,e};wt.createRef=function(){return{current:null}};wt.forwardRef=function(t){return{$$typeof:aB,render:t}};wt.isValidElement=oN;wt.lazy=function(t){return{$$typeof:uB,_payload:{_status:-1,_result:t},_init:mB}};wt.memo=function(t,e){return{$$typeof:cB,type:t,compare:e===void 0?null:e}};wt.startTransition=function(t){var e=Qy.transition;Qy.transition={};try{t()}finally{Qy.transition=e}};wt.unstable_act=tL;wt.useCallback=function(t,e){return Kr.current.useCallback(t,e)};wt.useContext=function(t){return Kr.current.useContext(t)};wt.useDebugValue=function(){};wt.useDeferredValue=function(t){return Kr.current.useDeferredValue(t)};wt.useEffect=function(t,e){return Kr.current.useEffect(t,e)};wt.useId=function(){return Kr.current.useId()};wt.useImperativeHandle=function(t,e,n){return Kr.current.useImperativeHandle(t,e,n)};wt.useInsertionEffect=function(t,e){return Kr.current.useInsertionEffect(t,e)};wt.useLayoutEffect=function(t,e){return Kr.current.useLayoutEffect(t,e)};wt.useMemo=function(t,e){return Kr.current.useMemo(t,e)};wt.useReducer=function(t,e,n){return Kr.current.useReducer(t,e,n)};wt.useRef=function(t){return Kr.current.useRef(t)};wt.useState=function(t){return Kr.current.useState(t)};wt.useSyncExternalStore=function(t,e,n){return Kr.current.useSyncExternalStore(t,e,n)};wt.useTransition=function(){return Kr.current.useTransition()};wt.version="18.3.1";GP.exports=wt;var N=GP.exports;const Ve=WP(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gB=N,yB=Symbol.for("react.element"),xB=Symbol.for("react.fragment"),vB=Object.prototype.hasOwnProperty,bB=gB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_B={key:!0,ref:!0,__self:!0,__source:!0};function nL(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)vB.call(e,r)&&!_B.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:yB,type:t,key:i,ref:a,props:s,_owner:bB.current}}dv.Fragment=xB;dv.jsx=nL;dv.jsxs=nL;HP.exports=dv;var o=HP.exports,_w={},rL={exports:{}},Ds={},sL={exports:{}},iL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,Q){var W=H.length;H.push(Q);e:for(;0<W;){var re=W-1>>>1,he=H[re];if(0<s(he,Q))H[re]=Q,H[W]=he,W=re;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Q=H[0],W=H.pop();if(W!==Q){H[0]=W;e:for(var re=0,he=H.length,ye=he>>>1;re<ye;){var Me=2*(re+1)-1,Fe=H[Me],G=Me+1,le=H[G];if(0>s(Fe,W))G<he&&0>s(le,Fe)?(H[re]=le,H[G]=W,re=G):(H[re]=Fe,H[Me]=W,re=Me);else if(G<he&&0>s(le,W))H[re]=le,H[G]=W,re=G;else break e}}return Q}function s(H,Q){var W=H.sortIndex-Q.sortIndex;return W!==0?W:H.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],d=[],f=1,m=null,p=3,v=!1,x=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var Q=n(d);Q!==null;){if(Q.callback===null)r(d);else if(Q.startTime<=H)r(d),Q.sortIndex=Q.expirationTime,e(u,Q);else break;Q=n(d)}}function C(H){if(_=!1,S(H),!x)if(n(u)!==null)x=!0,ve(P);else{var Q=n(d);Q!==null&&ae(C,Q.startTime-H)}}function P(H,Q){x=!1,_&&(_=!1,k(j),j=-1),v=!0;var W=p;try{for(S(Q),m=n(u);m!==null&&(!(m.expirationTime>Q)||H&&!z());){var re=m.callback;if(typeof re=="function"){m.callback=null,p=m.priorityLevel;var he=re(m.expirationTime<=Q);Q=t.unstable_now(),typeof he=="function"?m.callback=he:m===n(u)&&r(u),S(Q)}else r(u);m=n(u)}if(m!==null)var ye=!0;else{var Me=n(d);Me!==null&&ae(C,Me.startTime-Q),ye=!1}return ye}finally{m=null,p=W,v=!1}}var R=!1,I=null,j=-1,O=5,V=-1;function z(){return!(t.unstable_now()-V<O)}function D(){if(I!==null){var H=t.unstable_now();V=H;var Q=!0;try{Q=I(!0,H)}finally{Q?F():(R=!1,I=null)}}else R=!1}var F;if(typeof b=="function")F=function(){b(D)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,ue=ee.port2;ee.port1.onmessage=D,F=function(){ue.postMessage(null)}}else F=function(){E(D,0)};function ve(H){I=H,R||(R=!0,F())}function ae(H,Q){j=E(function(){H(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){x||v||(x=!0,ve(P))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(H){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var W=p;p=Q;try{return H()}finally{p=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,Q){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var W=p;p=H;try{return Q()}finally{p=W}},t.unstable_scheduleCallback=function(H,Q,W){var re=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?re+W:re):W=re,H){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=W+he,H={id:f++,callback:Q,priorityLevel:H,startTime:W,expirationTime:he,sortIndex:-1},W>re?(H.sortIndex=W,e(d,H),n(u)===null&&H===n(d)&&(_?(k(j),j=-1):_=!0,ae(C,W-re))):(H.sortIndex=he,e(u,H),x||v||(x=!0,ve(P))),H},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(H){var Q=p;return function(){var W=p;p=Q;try{return H.apply(this,arguments)}finally{p=W}}}})(iL);sL.exports=iL;var wB=sL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kB=N,Ps=wB;function ge(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var oL=new Set,$m={};function cu(t,e){Gd(t,e),Gd(t+"Capture",e)}function Gd(t,e){for($m[t]=e,t=0;t<e.length;t++)oL.add(e[t])}var Zo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ww=Object.prototype.hasOwnProperty,NB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,P2={},L2={};function SB(t){return ww.call(L2,t)?!0:ww.call(P2,t)?!1:NB.test(t)?L2[t]=!0:(P2[t]=!0,!1)}function TB(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function EB(t,e,n,r){if(e===null||typeof e>"u"||TB(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Qr(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){br[t]=new Qr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];br[e]=new Qr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){br[t]=new Qr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){br[t]=new Qr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){br[t]=new Qr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){br[t]=new Qr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){br[t]=new Qr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){br[t]=new Qr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){br[t]=new Qr(t,5,!1,t.toLowerCase(),null,!1,!1)});var aN=/[\-:]([a-z])/g;function lN(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(aN,lN);br[e]=new Qr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(aN,lN);br[e]=new Qr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(aN,lN);br[e]=new Qr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){br[t]=new Qr(t,1,!1,t.toLowerCase(),null,!1,!1)});br.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){br[t]=new Qr(t,1,!1,t.toLowerCase(),null,!0,!0)});function cN(t,e,n,r){var s=br.hasOwnProperty(e)?br[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EB(e,n,s,r)&&(n=null),r||s===null?SB(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var aa=kB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uy=Symbol.for("react.element"),dd=Symbol.for("react.portal"),hd=Symbol.for("react.fragment"),uN=Symbol.for("react.strict_mode"),kw=Symbol.for("react.profiler"),aL=Symbol.for("react.provider"),lL=Symbol.for("react.context"),dN=Symbol.for("react.forward_ref"),Nw=Symbol.for("react.suspense"),Sw=Symbol.for("react.suspense_list"),hN=Symbol.for("react.memo"),Ra=Symbol.for("react.lazy"),cL=Symbol.for("react.offscreen"),M2=Symbol.iterator;function Ef(t){return t===null||typeof t!="object"?null:(t=M2&&t[M2]||t["@@iterator"],typeof t=="function"?t:null)}var wn=Object.assign,qb;function Yf(t){if(qb===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qb=e&&e[1]||""}return`
`+qb+t}var Wb=!1;function Hb(t,e){if(!t||Wb)return"";Wb=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{Wb=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Yf(t):""}function CB(t){switch(t.tag){case 5:return Yf(t.type);case 16:return Yf("Lazy");case 13:return Yf("Suspense");case 19:return Yf("SuspenseList");case 0:case 2:case 15:return t=Hb(t.type,!1),t;case 11:return t=Hb(t.type.render,!1),t;case 1:return t=Hb(t.type,!0),t;default:return""}}function Tw(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hd:return"Fragment";case dd:return"Portal";case kw:return"Profiler";case uN:return"StrictMode";case Nw:return"Suspense";case Sw:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case lL:return(t.displayName||"Context")+".Consumer";case aL:return(t._context.displayName||"Context")+".Provider";case dN:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hN:return e=t.displayName||null,e!==null?e:Tw(t.type)||"Memo";case Ra:e=t._payload,t=t._init;try{return Tw(t(e))}catch{}}return null}function jB(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tw(e);case 8:return e===uN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function uL(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function IB(t){var e=uL(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function dy(t){t._valueTracker||(t._valueTracker=IB(t))}function dL(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=uL(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ax(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ew(t,e){var n=e.checked;return wn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function O2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=pl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hL(t,e){e=e.checked,e!=null&&cN(t,"checked",e,!1)}function Cw(t,e){hL(t,e);var n=pl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?jw(t,e.type,n):e.hasOwnProperty("defaultValue")&&jw(t,e.type,pl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function D2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function jw(t,e,n){(e!=="number"||Ax(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Xf=Array.isArray;function Pd(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+pl(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Iw(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ge(91));return wn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function V2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ge(92));if(Xf(n)){if(1<n.length)throw Error(ge(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:pl(n)}}function fL(t,e){var n=pl(e.value),r=pl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function F2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mL(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Aw(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mL(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var hy,pL=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(hy=hy||document.createElement("div"),hy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Um(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var mm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AB=["Webkit","ms","Moz","O"];Object.keys(mm).forEach(function(t){AB.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),mm[e]=mm[t]})});function gL(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||mm.hasOwnProperty(t)&&mm[t]?(""+e).trim():e+"px"}function yL(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=gL(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var RB=wn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rw(t,e){if(e){if(RB[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ge(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ge(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ge(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ge(62))}}function Pw(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lw=null;function fN(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Mw=null,Ld=null,Md=null;function z2(t){if(t=Kp(t)){if(typeof Mw!="function")throw Error(ge(280));var e=t.stateNode;e&&(e=gv(e),Mw(t.stateNode,t.type,e))}}function xL(t){Ld?Md?Md.push(t):Md=[t]:Ld=t}function vL(){if(Ld){var t=Ld,e=Md;if(Md=Ld=null,z2(t),e)for(t=0;t<e.length;t++)z2(e[t])}}function bL(t,e){return t(e)}function _L(){}var Gb=!1;function wL(t,e,n){if(Gb)return t(e,n);Gb=!0;try{return bL(t,e,n)}finally{Gb=!1,(Ld!==null||Md!==null)&&(_L(),vL())}}function qm(t,e){var n=t.stateNode;if(n===null)return null;var r=gv(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ge(231,e,typeof n));return n}var Ow=!1;if(Zo)try{var Cf={};Object.defineProperty(Cf,"passive",{get:function(){Ow=!0}}),window.addEventListener("test",Cf,Cf),window.removeEventListener("test",Cf,Cf)}catch{Ow=!1}function PB(t,e,n,r,s,i,a,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var pm=!1,Rx=null,Px=!1,Dw=null,LB={onError:function(t){pm=!0,Rx=t}};function MB(t,e,n,r,s,i,a,l,u){pm=!1,Rx=null,PB.apply(LB,arguments)}function OB(t,e,n,r,s,i,a,l,u){if(MB.apply(this,arguments),pm){if(pm){var d=Rx;pm=!1,Rx=null}else throw Error(ge(198));Px||(Px=!0,Dw=d)}}function uu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function kL(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function B2(t){if(uu(t)!==t)throw Error(ge(188))}function DB(t){var e=t.alternate;if(!e){if(e=uu(t),e===null)throw Error(ge(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return B2(s),t;if(i===r)return B2(s),e;i=i.sibling}throw Error(ge(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(ge(189))}}if(n.alternate!==r)throw Error(ge(190))}if(n.tag!==3)throw Error(ge(188));return n.stateNode.current===n?t:e}function NL(t){return t=DB(t),t!==null?SL(t):null}function SL(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=SL(t);if(e!==null)return e;t=t.sibling}return null}var TL=Ps.unstable_scheduleCallback,$2=Ps.unstable_cancelCallback,VB=Ps.unstable_shouldYield,FB=Ps.unstable_requestPaint,Mn=Ps.unstable_now,zB=Ps.unstable_getCurrentPriorityLevel,mN=Ps.unstable_ImmediatePriority,EL=Ps.unstable_UserBlockingPriority,Lx=Ps.unstable_NormalPriority,BB=Ps.unstable_LowPriority,CL=Ps.unstable_IdlePriority,hv=null,Yi=null;function $B(t){if(Yi&&typeof Yi.onCommitFiberRoot=="function")try{Yi.onCommitFiberRoot(hv,t,void 0,(t.current.flags&128)===128)}catch{}}var Ti=Math.clz32?Math.clz32:WB,UB=Math.log,qB=Math.LN2;function WB(t){return t>>>=0,t===0?32:31-(UB(t)/qB|0)|0}var fy=64,my=4194304;function Jf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Mx(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Jf(l):(i&=a,i!==0&&(r=Jf(i)))}else a=n&~s,a!==0?r=Jf(a):i!==0&&(r=Jf(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ti(e),s=1<<n,r|=t[n],e&=~s;return r}function HB(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GB(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Ti(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=HB(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Vw(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function jL(){var t=fy;return fy<<=1,!(fy&4194240)&&(fy=64),t}function Kb(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Hp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ti(e),t[e]=n}function KB(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Ti(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function pN(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ti(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Bt=0;function IL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var AL,gN,RL,PL,LL,Fw=!1,py=[],Xa=null,Ja=null,el=null,Wm=new Map,Hm=new Map,Oa=[],QB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function U2(t,e){switch(t){case"focusin":case"focusout":Xa=null;break;case"dragenter":case"dragleave":Ja=null;break;case"mouseover":case"mouseout":el=null;break;case"pointerover":case"pointerout":Wm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hm.delete(e.pointerId)}}function jf(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Kp(e),e!==null&&gN(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function ZB(t,e,n,r,s){switch(e){case"focusin":return Xa=jf(Xa,t,e,n,r,s),!0;case"dragenter":return Ja=jf(Ja,t,e,n,r,s),!0;case"mouseover":return el=jf(el,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Wm.set(i,jf(Wm.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Hm.set(i,jf(Hm.get(i)||null,t,e,n,r,s)),!0}return!1}function ML(t){var e=fc(t.target);if(e!==null){var n=uu(e);if(n!==null){if(e=n.tag,e===13){if(e=kL(n),e!==null){t.blockedOn=e,LL(t.priority,function(){RL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zy(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=zw(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Lw=r,n.target.dispatchEvent(r),Lw=null}else return e=Kp(n),e!==null&&gN(e),t.blockedOn=n,!1;e.shift()}return!0}function q2(t,e,n){Zy(t)&&n.delete(e)}function YB(){Fw=!1,Xa!==null&&Zy(Xa)&&(Xa=null),Ja!==null&&Zy(Ja)&&(Ja=null),el!==null&&Zy(el)&&(el=null),Wm.forEach(q2),Hm.forEach(q2)}function If(t,e){t.blockedOn===e&&(t.blockedOn=null,Fw||(Fw=!0,Ps.unstable_scheduleCallback(Ps.unstable_NormalPriority,YB)))}function Gm(t){function e(s){return If(s,t)}if(0<py.length){If(py[0],t);for(var n=1;n<py.length;n++){var r=py[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Xa!==null&&If(Xa,t),Ja!==null&&If(Ja,t),el!==null&&If(el,t),Wm.forEach(e),Hm.forEach(e),n=0;n<Oa.length;n++)r=Oa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Oa.length&&(n=Oa[0],n.blockedOn===null);)ML(n),n.blockedOn===null&&Oa.shift()}var Od=aa.ReactCurrentBatchConfig,Ox=!0;function XB(t,e,n,r){var s=Bt,i=Od.transition;Od.transition=null;try{Bt=1,yN(t,e,n,r)}finally{Bt=s,Od.transition=i}}function JB(t,e,n,r){var s=Bt,i=Od.transition;Od.transition=null;try{Bt=4,yN(t,e,n,r)}finally{Bt=s,Od.transition=i}}function yN(t,e,n,r){if(Ox){var s=zw(t,e,n,r);if(s===null)s_(t,e,r,Dx,n),U2(t,r);else if(ZB(s,t,e,n,r))r.stopPropagation();else if(U2(t,r),e&4&&-1<QB.indexOf(t)){for(;s!==null;){var i=Kp(s);if(i!==null&&AL(i),i=zw(t,e,n,r),i===null&&s_(t,e,r,Dx,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else s_(t,e,r,null,n)}}var Dx=null;function zw(t,e,n,r){if(Dx=null,t=fN(r),t=fc(t),t!==null)if(e=uu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=kL(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dx=t,null}function OL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zB()){case mN:return 1;case EL:return 4;case Lx:case BB:return 16;case CL:return 536870912;default:return 16}default:return 16}}var Wa=null,xN=null,Yy=null;function DL(){if(Yy)return Yy;var t,e=xN,n=e.length,r,s="value"in Wa?Wa.value:Wa.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Yy=s.slice(t,1<r?1-r:void 0)}function Xy(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gy(){return!0}function W2(){return!1}function Vs(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?gy:W2,this.isPropagationStopped=W2,this}return wn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gy)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gy)},persist:function(){},isPersistent:gy}),e}var Ph={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vN=Vs(Ph),Gp=wn({},Ph,{view:0,detail:0}),e$=Vs(Gp),Qb,Zb,Af,fv=wn({},Gp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bN,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Af&&(Af&&t.type==="mousemove"?(Qb=t.screenX-Af.screenX,Zb=t.screenY-Af.screenY):Zb=Qb=0,Af=t),Qb)},movementY:function(t){return"movementY"in t?t.movementY:Zb}}),H2=Vs(fv),t$=wn({},fv,{dataTransfer:0}),n$=Vs(t$),r$=wn({},Gp,{relatedTarget:0}),Yb=Vs(r$),s$=wn({},Ph,{animationName:0,elapsedTime:0,pseudoElement:0}),i$=Vs(s$),o$=wn({},Ph,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),a$=Vs(o$),l$=wn({},Ph,{data:0}),G2=Vs(l$),c$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},u$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},d$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function h$(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=d$[t])?!!e[t]:!1}function bN(){return h$}var f$=wn({},Gp,{key:function(t){if(t.key){var e=c$[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xy(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?u$[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bN,charCode:function(t){return t.type==="keypress"?Xy(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xy(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),m$=Vs(f$),p$=wn({},fv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),K2=Vs(p$),g$=wn({},Gp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bN}),y$=Vs(g$),x$=wn({},Ph,{propertyName:0,elapsedTime:0,pseudoElement:0}),v$=Vs(x$),b$=wn({},fv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),_$=Vs(b$),w$=[9,13,27,32],_N=Zo&&"CompositionEvent"in window,gm=null;Zo&&"documentMode"in document&&(gm=document.documentMode);var k$=Zo&&"TextEvent"in window&&!gm,VL=Zo&&(!_N||gm&&8<gm&&11>=gm),Q2=" ",Z2=!1;function FL(t,e){switch(t){case"keyup":return w$.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fd=!1;function N$(t,e){switch(t){case"compositionend":return zL(e);case"keypress":return e.which!==32?null:(Z2=!0,Q2);case"textInput":return t=e.data,t===Q2&&Z2?null:t;default:return null}}function S$(t,e){if(fd)return t==="compositionend"||!_N&&FL(t,e)?(t=DL(),Yy=xN=Wa=null,fd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VL&&e.locale!=="ko"?null:e.data;default:return null}}var T$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Y2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!T$[t.type]:e==="textarea"}function BL(t,e,n,r){xL(r),e=Vx(e,"onChange"),0<e.length&&(n=new vN("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ym=null,Km=null;function E$(t){XL(t,0)}function mv(t){var e=gd(t);if(dL(e))return t}function C$(t,e){if(t==="change")return e}var $L=!1;if(Zo){var Xb;if(Zo){var Jb="oninput"in document;if(!Jb){var X2=document.createElement("div");X2.setAttribute("oninput","return;"),Jb=typeof X2.oninput=="function"}Xb=Jb}else Xb=!1;$L=Xb&&(!document.documentMode||9<document.documentMode)}function J2(){ym&&(ym.detachEvent("onpropertychange",UL),Km=ym=null)}function UL(t){if(t.propertyName==="value"&&mv(Km)){var e=[];BL(e,Km,t,fN(t)),wL(E$,e)}}function j$(t,e,n){t==="focusin"?(J2(),ym=e,Km=n,ym.attachEvent("onpropertychange",UL)):t==="focusout"&&J2()}function I$(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mv(Km)}function A$(t,e){if(t==="click")return mv(e)}function R$(t,e){if(t==="input"||t==="change")return mv(e)}function P$(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ai=typeof Object.is=="function"?Object.is:P$;function Qm(t,e){if(Ai(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ww.call(e,s)||!Ai(t[s],e[s]))return!1}return!0}function eC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tC(t,e){var n=eC(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=eC(n)}}function qL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?qL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function WL(){for(var t=window,e=Ax();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ax(t.document)}return e}function wN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function L$(t){var e=WL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&qL(n.ownerDocument.documentElement,n)){if(r!==null&&wN(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=tC(n,i);var a=tC(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var M$=Zo&&"documentMode"in document&&11>=document.documentMode,md=null,Bw=null,xm=null,$w=!1;function nC(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$w||md==null||md!==Ax(r)||(r=md,"selectionStart"in r&&wN(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xm&&Qm(xm,r)||(xm=r,r=Vx(Bw,"onSelect"),0<r.length&&(e=new vN("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=md)))}function yy(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var pd={animationend:yy("Animation","AnimationEnd"),animationiteration:yy("Animation","AnimationIteration"),animationstart:yy("Animation","AnimationStart"),transitionend:yy("Transition","TransitionEnd")},e_={},HL={};Zo&&(HL=document.createElement("div").style,"AnimationEvent"in window||(delete pd.animationend.animation,delete pd.animationiteration.animation,delete pd.animationstart.animation),"TransitionEvent"in window||delete pd.transitionend.transition);function pv(t){if(e_[t])return e_[t];if(!pd[t])return t;var e=pd[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in HL)return e_[t]=e[n];return t}var GL=pv("animationend"),KL=pv("animationiteration"),QL=pv("animationstart"),ZL=pv("transitionend"),YL=new Map,rC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Il(t,e){YL.set(t,e),cu(e,[t])}for(var t_=0;t_<rC.length;t_++){var n_=rC[t_],O$=n_.toLowerCase(),D$=n_[0].toUpperCase()+n_.slice(1);Il(O$,"on"+D$)}Il(GL,"onAnimationEnd");Il(KL,"onAnimationIteration");Il(QL,"onAnimationStart");Il("dblclick","onDoubleClick");Il("focusin","onFocus");Il("focusout","onBlur");Il(ZL,"onTransitionEnd");Gd("onMouseEnter",["mouseout","mouseover"]);Gd("onMouseLeave",["mouseout","mouseover"]);Gd("onPointerEnter",["pointerout","pointerover"]);Gd("onPointerLeave",["pointerout","pointerover"]);cu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cu("onBeforeInput",["compositionend","keypress","textInput","paste"]);cu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var em="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V$=new Set("cancel close invalid load scroll toggle".split(" ").concat(em));function sC(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,OB(r,e,void 0,t),t.currentTarget=null}function XL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;sC(s,l,d),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;sC(s,l,d),i=u}}}if(Px)throw t=Dw,Px=!1,Dw=null,t}function nn(t,e){var n=e[Gw];n===void 0&&(n=e[Gw]=new Set);var r=t+"__bubble";n.has(r)||(JL(e,t,2,!1),n.add(r))}function r_(t,e,n){var r=0;e&&(r|=4),JL(n,t,r,e)}var xy="_reactListening"+Math.random().toString(36).slice(2);function Zm(t){if(!t[xy]){t[xy]=!0,oL.forEach(function(n){n!=="selectionchange"&&(V$.has(n)||r_(n,!1,t),r_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[xy]||(e[xy]=!0,r_("selectionchange",!1,e))}}function JL(t,e,n,r){switch(OL(e)){case 1:var s=XB;break;case 4:s=JB;break;default:s=yN}n=s.bind(null,e,n,t),s=void 0,!Ow||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function s_(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=fc(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}wL(function(){var d=i,f=fN(n),m=[];e:{var p=YL.get(t);if(p!==void 0){var v=vN,x=t;switch(t){case"keypress":if(Xy(n)===0)break e;case"keydown":case"keyup":v=m$;break;case"focusin":x="focus",v=Yb;break;case"focusout":x="blur",v=Yb;break;case"beforeblur":case"afterblur":v=Yb;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=H2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=n$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=y$;break;case GL:case KL:case QL:v=i$;break;case ZL:v=v$;break;case"scroll":v=e$;break;case"wheel":v=_$;break;case"copy":case"cut":case"paste":v=a$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=K2}var _=(e&4)!==0,E=!_&&t==="scroll",k=_?p!==null?p+"Capture":null:p;_=[];for(var b=d,S;b!==null;){S=b;var C=S.stateNode;if(S.tag===5&&C!==null&&(S=C,k!==null&&(C=qm(b,k),C!=null&&_.push(Ym(b,C,S)))),E)break;b=b.return}0<_.length&&(p=new v(p,x,null,n,f),m.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",p&&n!==Lw&&(x=n.relatedTarget||n.fromElement)&&(fc(x)||x[Yo]))break e;if((v||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,v?(x=n.relatedTarget||n.toElement,v=d,x=x?fc(x):null,x!==null&&(E=uu(x),x!==E||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=d),v!==x)){if(_=H2,C="onMouseLeave",k="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(_=K2,C="onPointerLeave",k="onPointerEnter",b="pointer"),E=v==null?p:gd(v),S=x==null?p:gd(x),p=new _(C,b+"leave",v,n,f),p.target=E,p.relatedTarget=S,C=null,fc(f)===d&&(_=new _(k,b+"enter",x,n,f),_.target=S,_.relatedTarget=E,C=_),E=C,v&&x)t:{for(_=v,k=x,b=0,S=_;S;S=Zu(S))b++;for(S=0,C=k;C;C=Zu(C))S++;for(;0<b-S;)_=Zu(_),b--;for(;0<S-b;)k=Zu(k),S--;for(;b--;){if(_===k||k!==null&&_===k.alternate)break t;_=Zu(_),k=Zu(k)}_=null}else _=null;v!==null&&iC(m,p,v,_,!1),x!==null&&E!==null&&iC(m,E,x,_,!0)}}e:{if(p=d?gd(d):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var P=C$;else if(Y2(p))if($L)P=R$;else{P=I$;var R=j$}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=A$);if(P&&(P=P(t,d))){BL(m,P,n,f);break e}R&&R(t,p,d),t==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&jw(p,"number",p.value)}switch(R=d?gd(d):window,t){case"focusin":(Y2(R)||R.contentEditable==="true")&&(md=R,Bw=d,xm=null);break;case"focusout":xm=Bw=md=null;break;case"mousedown":$w=!0;break;case"contextmenu":case"mouseup":case"dragend":$w=!1,nC(m,n,f);break;case"selectionchange":if(M$)break;case"keydown":case"keyup":nC(m,n,f)}var I;if(_N)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else fd?FL(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(VL&&n.locale!=="ko"&&(fd||j!=="onCompositionStart"?j==="onCompositionEnd"&&fd&&(I=DL()):(Wa=f,xN="value"in Wa?Wa.value:Wa.textContent,fd=!0)),R=Vx(d,j),0<R.length&&(j=new G2(j,t,null,n,f),m.push({event:j,listeners:R}),I?j.data=I:(I=zL(n),I!==null&&(j.data=I)))),(I=k$?N$(t,n):S$(t,n))&&(d=Vx(d,"onBeforeInput"),0<d.length&&(f=new G2("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:d}),f.data=I))}XL(m,e)})}function Ym(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vx(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=qm(t,n),i!=null&&r.unshift(Ym(t,i,s)),i=qm(t,e),i!=null&&r.push(Ym(t,i,s))),t=t.return}return r}function Zu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function iC(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=qm(n,i),u!=null&&a.unshift(Ym(n,u,l))):s||(u=qm(n,i),u!=null&&a.push(Ym(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var F$=/\r\n?/g,z$=/\u0000|\uFFFD/g;function oC(t){return(typeof t=="string"?t:""+t).replace(F$,`
`).replace(z$,"")}function vy(t,e,n){if(e=oC(e),oC(t)!==e&&n)throw Error(ge(425))}function Fx(){}var Uw=null,qw=null;function Ww(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hw=typeof setTimeout=="function"?setTimeout:void 0,B$=typeof clearTimeout=="function"?clearTimeout:void 0,aC=typeof Promise=="function"?Promise:void 0,$$=typeof queueMicrotask=="function"?queueMicrotask:typeof aC<"u"?function(t){return aC.resolve(null).then(t).catch(U$)}:Hw;function U$(t){setTimeout(function(){throw t})}function i_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Gm(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Gm(e)}function tl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Lh=Math.random().toString(36).slice(2),Wi="__reactFiber$"+Lh,Xm="__reactProps$"+Lh,Yo="__reactContainer$"+Lh,Gw="__reactEvents$"+Lh,q$="__reactListeners$"+Lh,W$="__reactHandles$"+Lh;function fc(t){var e=t[Wi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Yo]||n[Wi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=lC(t);t!==null;){if(n=t[Wi])return n;t=lC(t)}return e}t=n,n=t.parentNode}return null}function Kp(t){return t=t[Wi]||t[Yo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gd(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ge(33))}function gv(t){return t[Xm]||null}var Kw=[],yd=-1;function Al(t){return{current:t}}function on(t){0>yd||(t.current=Kw[yd],Kw[yd]=null,yd--)}function en(t,e){yd++,Kw[yd]=t.current,t.current=e}var gl={},Lr=Al(gl),us=Al(!1),Ac=gl;function Kd(t,e){var n=t.type.contextTypes;if(!n)return gl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function ds(t){return t=t.childContextTypes,t!=null}function zx(){on(us),on(Lr)}function cC(t,e,n){if(Lr.current!==gl)throw Error(ge(168));en(Lr,e),en(us,n)}function eM(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ge(108,jB(t)||"Unknown",s));return wn({},n,r)}function Bx(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gl,Ac=Lr.current,en(Lr,t),en(us,us.current),!0}function uC(t,e,n){var r=t.stateNode;if(!r)throw Error(ge(169));n?(t=eM(t,e,Ac),r.__reactInternalMemoizedMergedChildContext=t,on(us),on(Lr),en(Lr,t)):on(us),en(us,n)}var Mo=null,yv=!1,o_=!1;function tM(t){Mo===null?Mo=[t]:Mo.push(t)}function H$(t){yv=!0,tM(t)}function Rl(){if(!o_&&Mo!==null){o_=!0;var t=0,e=Bt;try{var n=Mo;for(Bt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Mo=null,yv=!1}catch(s){throw Mo!==null&&(Mo=Mo.slice(t+1)),TL(mN,Rl),s}finally{Bt=e,o_=!1}}return null}var xd=[],vd=0,$x=null,Ux=0,Ys=[],Xs=0,Rc=null,Vo=1,Fo="";function tc(t,e){xd[vd++]=Ux,xd[vd++]=$x,$x=t,Ux=e}function nM(t,e,n){Ys[Xs++]=Vo,Ys[Xs++]=Fo,Ys[Xs++]=Rc,Rc=t;var r=Vo;t=Fo;var s=32-Ti(r)-1;r&=~(1<<s),n+=1;var i=32-Ti(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Vo=1<<32-Ti(e)+s|n<<s|r,Fo=i+t}else Vo=1<<i|n<<s|r,Fo=t}function kN(t){t.return!==null&&(tc(t,1),nM(t,1,0))}function NN(t){for(;t===$x;)$x=xd[--vd],xd[vd]=null,Ux=xd[--vd],xd[vd]=null;for(;t===Rc;)Rc=Ys[--Xs],Ys[Xs]=null,Fo=Ys[--Xs],Ys[Xs]=null,Vo=Ys[--Xs],Ys[Xs]=null}var Is=null,Ss=null,hn=!1,vi=null;function rM(t,e){var n=ei(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function dC(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Is=t,Ss=tl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Is=t,Ss=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Rc!==null?{id:Vo,overflow:Fo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ei(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Is=t,Ss=null,!0):!1;default:return!1}}function Qw(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zw(t){if(hn){var e=Ss;if(e){var n=e;if(!dC(t,e)){if(Qw(t))throw Error(ge(418));e=tl(n.nextSibling);var r=Is;e&&dC(t,e)?rM(r,n):(t.flags=t.flags&-4097|2,hn=!1,Is=t)}}else{if(Qw(t))throw Error(ge(418));t.flags=t.flags&-4097|2,hn=!1,Is=t}}}function hC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Is=t}function by(t){if(t!==Is)return!1;if(!hn)return hC(t),hn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ww(t.type,t.memoizedProps)),e&&(e=Ss)){if(Qw(t))throw sM(),Error(ge(418));for(;e;)rM(t,e),e=tl(e.nextSibling)}if(hC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ge(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ss=tl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ss=null}}else Ss=Is?tl(t.stateNode.nextSibling):null;return!0}function sM(){for(var t=Ss;t;)t=tl(t.nextSibling)}function Qd(){Ss=Is=null,hn=!1}function SN(t){vi===null?vi=[t]:vi.push(t)}var G$=aa.ReactCurrentBatchConfig;function Rf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ge(309));var r=n.stateNode}if(!r)throw Error(ge(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(ge(284));if(!n._owner)throw Error(ge(290,t))}return t}function _y(t,e){throw t=Object.prototype.toString.call(e),Error(ge(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fC(t){var e=t._init;return e(t._payload)}function iM(t){function e(k,b){if(t){var S=k.deletions;S===null?(k.deletions=[b],k.flags|=16):S.push(b)}}function n(k,b){if(!t)return null;for(;b!==null;)e(k,b),b=b.sibling;return null}function r(k,b){for(k=new Map;b!==null;)b.key!==null?k.set(b.key,b):k.set(b.index,b),b=b.sibling;return k}function s(k,b){return k=il(k,b),k.index=0,k.sibling=null,k}function i(k,b,S){return k.index=S,t?(S=k.alternate,S!==null?(S=S.index,S<b?(k.flags|=2,b):S):(k.flags|=2,b)):(k.flags|=1048576,b)}function a(k){return t&&k.alternate===null&&(k.flags|=2),k}function l(k,b,S,C){return b===null||b.tag!==6?(b=f_(S,k.mode,C),b.return=k,b):(b=s(b,S),b.return=k,b)}function u(k,b,S,C){var P=S.type;return P===hd?f(k,b,S.props.children,C,S.key):b!==null&&(b.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ra&&fC(P)===b.type)?(C=s(b,S.props),C.ref=Rf(k,b,S),C.return=k,C):(C=ix(S.type,S.key,S.props,null,k.mode,C),C.ref=Rf(k,b,S),C.return=k,C)}function d(k,b,S,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=m_(S,k.mode,C),b.return=k,b):(b=s(b,S.children||[]),b.return=k,b)}function f(k,b,S,C,P){return b===null||b.tag!==7?(b=_c(S,k.mode,C,P),b.return=k,b):(b=s(b,S),b.return=k,b)}function m(k,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return b=f_(""+b,k.mode,S),b.return=k,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case uy:return S=ix(b.type,b.key,b.props,null,k.mode,S),S.ref=Rf(k,null,b),S.return=k,S;case dd:return b=m_(b,k.mode,S),b.return=k,b;case Ra:var C=b._init;return m(k,C(b._payload),S)}if(Xf(b)||Ef(b))return b=_c(b,k.mode,S,null),b.return=k,b;_y(k,b)}return null}function p(k,b,S,C){var P=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return P!==null?null:l(k,b,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case uy:return S.key===P?u(k,b,S,C):null;case dd:return S.key===P?d(k,b,S,C):null;case Ra:return P=S._init,p(k,b,P(S._payload),C)}if(Xf(S)||Ef(S))return P!==null?null:f(k,b,S,C,null);_y(k,S)}return null}function v(k,b,S,C,P){if(typeof C=="string"&&C!==""||typeof C=="number")return k=k.get(S)||null,l(b,k,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case uy:return k=k.get(C.key===null?S:C.key)||null,u(b,k,C,P);case dd:return k=k.get(C.key===null?S:C.key)||null,d(b,k,C,P);case Ra:var R=C._init;return v(k,b,S,R(C._payload),P)}if(Xf(C)||Ef(C))return k=k.get(S)||null,f(b,k,C,P,null);_y(b,C)}return null}function x(k,b,S,C){for(var P=null,R=null,I=b,j=b=0,O=null;I!==null&&j<S.length;j++){I.index>j?(O=I,I=null):O=I.sibling;var V=p(k,I,S[j],C);if(V===null){I===null&&(I=O);break}t&&I&&V.alternate===null&&e(k,I),b=i(V,b,j),R===null?P=V:R.sibling=V,R=V,I=O}if(j===S.length)return n(k,I),hn&&tc(k,j),P;if(I===null){for(;j<S.length;j++)I=m(k,S[j],C),I!==null&&(b=i(I,b,j),R===null?P=I:R.sibling=I,R=I);return hn&&tc(k,j),P}for(I=r(k,I);j<S.length;j++)O=v(I,k,j,S[j],C),O!==null&&(t&&O.alternate!==null&&I.delete(O.key===null?j:O.key),b=i(O,b,j),R===null?P=O:R.sibling=O,R=O);return t&&I.forEach(function(z){return e(k,z)}),hn&&tc(k,j),P}function _(k,b,S,C){var P=Ef(S);if(typeof P!="function")throw Error(ge(150));if(S=P.call(S),S==null)throw Error(ge(151));for(var R=P=null,I=b,j=b=0,O=null,V=S.next();I!==null&&!V.done;j++,V=S.next()){I.index>j?(O=I,I=null):O=I.sibling;var z=p(k,I,V.value,C);if(z===null){I===null&&(I=O);break}t&&I&&z.alternate===null&&e(k,I),b=i(z,b,j),R===null?P=z:R.sibling=z,R=z,I=O}if(V.done)return n(k,I),hn&&tc(k,j),P;if(I===null){for(;!V.done;j++,V=S.next())V=m(k,V.value,C),V!==null&&(b=i(V,b,j),R===null?P=V:R.sibling=V,R=V);return hn&&tc(k,j),P}for(I=r(k,I);!V.done;j++,V=S.next())V=v(I,k,j,V.value,C),V!==null&&(t&&V.alternate!==null&&I.delete(V.key===null?j:V.key),b=i(V,b,j),R===null?P=V:R.sibling=V,R=V);return t&&I.forEach(function(D){return e(k,D)}),hn&&tc(k,j),P}function E(k,b,S,C){if(typeof S=="object"&&S!==null&&S.type===hd&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case uy:e:{for(var P=S.key,R=b;R!==null;){if(R.key===P){if(P=S.type,P===hd){if(R.tag===7){n(k,R.sibling),b=s(R,S.props.children),b.return=k,k=b;break e}}else if(R.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ra&&fC(P)===R.type){n(k,R.sibling),b=s(R,S.props),b.ref=Rf(k,R,S),b.return=k,k=b;break e}n(k,R);break}else e(k,R);R=R.sibling}S.type===hd?(b=_c(S.props.children,k.mode,C,S.key),b.return=k,k=b):(C=ix(S.type,S.key,S.props,null,k.mode,C),C.ref=Rf(k,b,S),C.return=k,k=C)}return a(k);case dd:e:{for(R=S.key;b!==null;){if(b.key===R)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){n(k,b.sibling),b=s(b,S.children||[]),b.return=k,k=b;break e}else{n(k,b);break}else e(k,b);b=b.sibling}b=m_(S,k.mode,C),b.return=k,k=b}return a(k);case Ra:return R=S._init,E(k,b,R(S._payload),C)}if(Xf(S))return x(k,b,S,C);if(Ef(S))return _(k,b,S,C);_y(k,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,b!==null&&b.tag===6?(n(k,b.sibling),b=s(b,S),b.return=k,k=b):(n(k,b),b=f_(S,k.mode,C),b.return=k,k=b),a(k)):n(k,b)}return E}var Zd=iM(!0),oM=iM(!1),qx=Al(null),Wx=null,bd=null,TN=null;function EN(){TN=bd=Wx=null}function CN(t){var e=qx.current;on(qx),t._currentValue=e}function Yw(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Dd(t,e){Wx=t,TN=bd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rs=!0),t.firstContext=null)}function si(t){var e=t._currentValue;if(TN!==t)if(t={context:t,memoizedValue:e,next:null},bd===null){if(Wx===null)throw Error(ge(308));bd=t,Wx.dependencies={lanes:0,firstContext:t}}else bd=bd.next=t;return e}var mc=null;function jN(t){mc===null?mc=[t]:mc.push(t)}function aM(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,jN(e)):(n.next=s.next,s.next=n),e.interleaved=n,Xo(t,r)}function Xo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pa=!1;function IN(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lM(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function nl(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,It&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Xo(t,n)}return s=r.interleaved,s===null?(e.next=e,jN(r)):(e.next=s.next,s.next=e),r.interleaved=e,Xo(t,n)}function Jy(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,pN(t,n)}}function mC(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hx(t,e,n,r){var s=t.updateQueue;Pa=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==a&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;a=0,f=d=u=null,l=i;do{var p=l.lane,v=l.eventTime;if((r&p)===p){f!==null&&(f=f.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,_=l;switch(p=e,v=n,_.tag){case 1:if(x=_.payload,typeof x=="function"){m=x.call(v,m,p);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=_.payload,p=typeof x=="function"?x.call(v,m,p):x,p==null)break e;m=wn({},m,p);break e;case 2:Pa=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else v={eventTime:v,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=v,u=m):f=f.next=v,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Lc|=a,t.lanes=a,t.memoizedState=m}}function pC(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ge(191,s));s.call(r)}}}var Qp={},Xi=Al(Qp),Jm=Al(Qp),ep=Al(Qp);function pc(t){if(t===Qp)throw Error(ge(174));return t}function AN(t,e){switch(en(ep,e),en(Jm,t),en(Xi,Qp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Aw(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Aw(e,t)}on(Xi),en(Xi,e)}function Yd(){on(Xi),on(Jm),on(ep)}function cM(t){pc(ep.current);var e=pc(Xi.current),n=Aw(e,t.type);e!==n&&(en(Jm,t),en(Xi,n))}function RN(t){Jm.current===t&&(on(Xi),on(Jm))}var pn=Al(0);function Gx(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var a_=[];function PN(){for(var t=0;t<a_.length;t++)a_[t]._workInProgressVersionPrimary=null;a_.length=0}var ex=aa.ReactCurrentDispatcher,l_=aa.ReactCurrentBatchConfig,Pc=0,vn=null,Hn=null,rr=null,Kx=!1,vm=!1,tp=0,K$=0;function Nr(){throw Error(ge(321))}function LN(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ai(t[n],e[n]))return!1;return!0}function MN(t,e,n,r,s,i){if(Pc=i,vn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ex.current=t===null||t.memoizedState===null?X$:J$,t=n(r,s),vm){i=0;do{if(vm=!1,tp=0,25<=i)throw Error(ge(301));i+=1,rr=Hn=null,e.updateQueue=null,ex.current=eU,t=n(r,s)}while(vm)}if(ex.current=Qx,e=Hn!==null&&Hn.next!==null,Pc=0,rr=Hn=vn=null,Kx=!1,e)throw Error(ge(300));return t}function ON(){var t=tp!==0;return tp=0,t}function Ui(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rr===null?vn.memoizedState=rr=t:rr=rr.next=t,rr}function ii(){if(Hn===null){var t=vn.alternate;t=t!==null?t.memoizedState:null}else t=Hn.next;var e=rr===null?vn.memoizedState:rr.next;if(e!==null)rr=e,Hn=t;else{if(t===null)throw Error(ge(310));Hn=t,t={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},rr===null?vn.memoizedState=rr=t:rr=rr.next=t}return rr}function np(t,e){return typeof e=="function"?e(t):e}function c_(t){var e=ii(),n=e.queue;if(n===null)throw Error(ge(311));n.lastRenderedReducer=t;var r=Hn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,d=i;do{var f=d.lane;if((Pc&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=m,a=r):u=u.next=m,vn.lanes|=f,Lc|=f}d=d.next}while(d!==null&&d!==i);u===null?a=r:u.next=l,Ai(r,e.memoizedState)||(rs=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,vn.lanes|=i,Lc|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function u_(t){var e=ii(),n=e.queue;if(n===null)throw Error(ge(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Ai(i,e.memoizedState)||(rs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function uM(){}function dM(t,e){var n=vn,r=ii(),s=e(),i=!Ai(r.memoizedState,s);if(i&&(r.memoizedState=s,rs=!0),r=r.queue,DN(mM.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||rr!==null&&rr.memoizedState.tag&1){if(n.flags|=2048,rp(9,fM.bind(null,n,r,s,e),void 0,null),lr===null)throw Error(ge(349));Pc&30||hM(n,e,s)}return s}function hM(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=vn.updateQueue,e===null?(e={lastEffect:null,stores:null},vn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function fM(t,e,n,r){e.value=n,e.getSnapshot=r,pM(e)&&gM(t)}function mM(t,e,n){return n(function(){pM(e)&&gM(t)})}function pM(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ai(t,n)}catch{return!0}}function gM(t){var e=Xo(t,1);e!==null&&Ei(e,t,1,-1)}function gC(t){var e=Ui();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:np,lastRenderedState:t},e.queue=t,t=t.dispatch=Y$.bind(null,vn,t),[e.memoizedState,t]}function rp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=vn.updateQueue,e===null?(e={lastEffect:null,stores:null},vn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function yM(){return ii().memoizedState}function tx(t,e,n,r){var s=Ui();vn.flags|=t,s.memoizedState=rp(1|e,n,void 0,r===void 0?null:r)}function xv(t,e,n,r){var s=ii();r=r===void 0?null:r;var i=void 0;if(Hn!==null){var a=Hn.memoizedState;if(i=a.destroy,r!==null&&LN(r,a.deps)){s.memoizedState=rp(e,n,i,r);return}}vn.flags|=t,s.memoizedState=rp(1|e,n,i,r)}function yC(t,e){return tx(8390656,8,t,e)}function DN(t,e){return xv(2048,8,t,e)}function xM(t,e){return xv(4,2,t,e)}function vM(t,e){return xv(4,4,t,e)}function bM(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function _M(t,e,n){return n=n!=null?n.concat([t]):null,xv(4,4,bM.bind(null,e,t),n)}function VN(){}function wM(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&LN(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kM(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&LN(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function NM(t,e,n){return Pc&21?(Ai(n,e)||(n=jL(),vn.lanes|=n,Lc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rs=!0),t.memoizedState=n)}function Q$(t,e){var n=Bt;Bt=n!==0&&4>n?n:4,t(!0);var r=l_.transition;l_.transition={};try{t(!1),e()}finally{Bt=n,l_.transition=r}}function SM(){return ii().memoizedState}function Z$(t,e,n){var r=sl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},TM(t))EM(e,n);else if(n=aM(t,e,n,r),n!==null){var s=Ur();Ei(n,t,r,s),CM(n,e,r)}}function Y$(t,e,n){var r=sl(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(TM(t))EM(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Ai(l,a)){var u=e.interleaved;u===null?(s.next=s,jN(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=aM(t,e,s,r),n!==null&&(s=Ur(),Ei(n,t,r,s),CM(n,e,r))}}function TM(t){var e=t.alternate;return t===vn||e!==null&&e===vn}function EM(t,e){vm=Kx=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function CM(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,pN(t,n)}}var Qx={readContext:si,useCallback:Nr,useContext:Nr,useEffect:Nr,useImperativeHandle:Nr,useInsertionEffect:Nr,useLayoutEffect:Nr,useMemo:Nr,useReducer:Nr,useRef:Nr,useState:Nr,useDebugValue:Nr,useDeferredValue:Nr,useTransition:Nr,useMutableSource:Nr,useSyncExternalStore:Nr,useId:Nr,unstable_isNewReconciler:!1},X$={readContext:si,useCallback:function(t,e){return Ui().memoizedState=[t,e===void 0?null:e],t},useContext:si,useEffect:yC,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,tx(4194308,4,bM.bind(null,e,t),n)},useLayoutEffect:function(t,e){return tx(4194308,4,t,e)},useInsertionEffect:function(t,e){return tx(4,2,t,e)},useMemo:function(t,e){var n=Ui();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ui();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Z$.bind(null,vn,t),[r.memoizedState,t]},useRef:function(t){var e=Ui();return t={current:t},e.memoizedState=t},useState:gC,useDebugValue:VN,useDeferredValue:function(t){return Ui().memoizedState=t},useTransition:function(){var t=gC(!1),e=t[0];return t=Q$.bind(null,t[1]),Ui().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=vn,s=Ui();if(hn){if(n===void 0)throw Error(ge(407));n=n()}else{if(n=e(),lr===null)throw Error(ge(349));Pc&30||hM(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,yC(mM.bind(null,r,i,t),[t]),r.flags|=2048,rp(9,fM.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Ui(),e=lr.identifierPrefix;if(hn){var n=Fo,r=Vo;n=(r&~(1<<32-Ti(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=tp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=K$++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},J$={readContext:si,useCallback:wM,useContext:si,useEffect:DN,useImperativeHandle:_M,useInsertionEffect:xM,useLayoutEffect:vM,useMemo:kM,useReducer:c_,useRef:yM,useState:function(){return c_(np)},useDebugValue:VN,useDeferredValue:function(t){var e=ii();return NM(e,Hn.memoizedState,t)},useTransition:function(){var t=c_(np)[0],e=ii().memoizedState;return[t,e]},useMutableSource:uM,useSyncExternalStore:dM,useId:SM,unstable_isNewReconciler:!1},eU={readContext:si,useCallback:wM,useContext:si,useEffect:DN,useImperativeHandle:_M,useInsertionEffect:xM,useLayoutEffect:vM,useMemo:kM,useReducer:u_,useRef:yM,useState:function(){return u_(np)},useDebugValue:VN,useDeferredValue:function(t){var e=ii();return Hn===null?e.memoizedState=t:NM(e,Hn.memoizedState,t)},useTransition:function(){var t=u_(np)[0],e=ii().memoizedState;return[t,e]},useMutableSource:uM,useSyncExternalStore:dM,useId:SM,unstable_isNewReconciler:!1};function yi(t,e){if(t&&t.defaultProps){e=wn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Xw(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:wn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var vv={isMounted:function(t){return(t=t._reactInternals)?uu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ur(),s=sl(t),i=Wo(r,s);i.payload=e,n!=null&&(i.callback=n),e=nl(t,i,s),e!==null&&(Ei(e,t,s,r),Jy(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ur(),s=sl(t),i=Wo(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=nl(t,i,s),e!==null&&(Ei(e,t,s,r),Jy(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ur(),r=sl(t),s=Wo(n,r);s.tag=2,e!=null&&(s.callback=e),e=nl(t,s,r),e!==null&&(Ei(e,t,r,n),Jy(e,t,r))}};function xC(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Qm(n,r)||!Qm(s,i):!0}function jM(t,e,n){var r=!1,s=gl,i=e.contextType;return typeof i=="object"&&i!==null?i=si(i):(s=ds(e)?Ac:Lr.current,r=e.contextTypes,i=(r=r!=null)?Kd(t,s):gl),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=vv,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function vC(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&vv.enqueueReplaceState(e,e.state,null)}function Jw(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},IN(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=si(i):(i=ds(e)?Ac:Lr.current,s.context=Kd(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Xw(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&vv.enqueueReplaceState(s,s.state,null),Hx(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Xd(t,e){try{var n="",r=e;do n+=CB(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function d_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ek(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var tU=typeof WeakMap=="function"?WeakMap:Map;function IM(t,e,n){n=Wo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Yx||(Yx=!0,uk=r),ek(t,e)},n}function AM(t,e,n){n=Wo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){ek(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){ek(t,e),typeof r!="function"&&(rl===null?rl=new Set([this]):rl.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function bC(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new tU;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=pU.bind(null,t,e,n),e.then(t,t))}function _C(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wC(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Wo(-1,1),e.tag=2,nl(n,e,1))),n.lanes|=1),t)}var nU=aa.ReactCurrentOwner,rs=!1;function Fr(t,e,n,r){e.child=t===null?oM(e,null,n,r):Zd(e,t.child,n,r)}function kC(t,e,n,r,s){n=n.render;var i=e.ref;return Dd(e,s),r=MN(t,e,n,r,i,s),n=ON(),t!==null&&!rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jo(t,e,s)):(hn&&n&&kN(e),e.flags|=1,Fr(t,e,r,s),e.child)}function NC(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!HN(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,RM(t,e,i,r,s)):(t=ix(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Qm,n(a,r)&&t.ref===e.ref)return Jo(t,e,s)}return e.flags|=1,t=il(i,r),t.ref=e.ref,t.return=e,e.child=t}function RM(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Qm(i,r)&&t.ref===e.ref)if(rs=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(rs=!0);else return e.lanes=t.lanes,Jo(t,e,s)}return tk(t,e,n,r,s)}function PM(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},en(wd,_s),_s|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,en(wd,_s),_s|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,en(wd,_s),_s|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,en(wd,_s),_s|=r;return Fr(t,e,s,n),e.child}function LM(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function tk(t,e,n,r,s){var i=ds(n)?Ac:Lr.current;return i=Kd(e,i),Dd(e,s),n=MN(t,e,n,r,i,s),r=ON(),t!==null&&!rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jo(t,e,s)):(hn&&r&&kN(e),e.flags|=1,Fr(t,e,n,s),e.child)}function SC(t,e,n,r,s){if(ds(n)){var i=!0;Bx(e)}else i=!1;if(Dd(e,s),e.stateNode===null)nx(t,e),jM(e,n,r),Jw(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=si(d):(d=ds(n)?Ac:Lr.current,d=Kd(e,d));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==d)&&vC(e,a,r,d),Pa=!1;var p=e.memoizedState;a.state=p,Hx(e,r,a,s),u=e.memoizedState,l!==r||p!==u||us.current||Pa?(typeof f=="function"&&(Xw(e,n,f,r),u=e.memoizedState),(l=Pa||xC(e,n,l,r,p,u,d))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,lM(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:yi(e.type,l),a.props=d,m=e.pendingProps,p=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=si(u):(u=ds(n)?Ac:Lr.current,u=Kd(e,u));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==m||p!==u)&&vC(e,a,r,u),Pa=!1,p=e.memoizedState,a.state=p,Hx(e,r,a,s);var x=e.memoizedState;l!==m||p!==x||us.current||Pa?(typeof v=="function"&&(Xw(e,n,v,r),x=e.memoizedState),(d=Pa||xC(e,n,d,r,p,x,u)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,x,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,x,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),a.props=r,a.state=x,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return nk(t,e,n,r,i,s)}function nk(t,e,n,r,s,i){LM(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&uC(e,n,!1),Jo(t,e,i);r=e.stateNode,nU.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Zd(e,t.child,null,i),e.child=Zd(e,null,l,i)):Fr(t,e,l,i),e.memoizedState=r.state,s&&uC(e,n,!0),e.child}function MM(t){var e=t.stateNode;e.pendingContext?cC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cC(t,e.context,!1),AN(t,e.containerInfo)}function TC(t,e,n,r,s){return Qd(),SN(s),e.flags|=256,Fr(t,e,n,r),e.child}var rk={dehydrated:null,treeContext:null,retryLane:0};function sk(t){return{baseLanes:t,cachePool:null,transitions:null}}function OM(t,e,n){var r=e.pendingProps,s=pn.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),en(pn,s&1),t===null)return Zw(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=wv(a,r,0,null),t=_c(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=sk(n),e.memoizedState=rk,t):FN(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return rU(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=il(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=il(l,i):(i=_c(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?sk(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=rk,r}return i=t.child,t=i.sibling,r=il(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function FN(t,e){return e=wv({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wy(t,e,n,r){return r!==null&&SN(r),Zd(e,t.child,null,n),t=FN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rU(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=d_(Error(ge(422))),wy(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=wv({mode:"visible",children:r.children},s,0,null),i=_c(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Zd(e,t.child,null,a),e.child.memoizedState=sk(a),e.memoizedState=rk,i);if(!(e.mode&1))return wy(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(ge(419)),r=d_(i,r,void 0),wy(t,e,a,r)}if(l=(a&t.childLanes)!==0,rs||l){if(r=lr,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Xo(t,s),Ei(r,t,s,-1))}return WN(),r=d_(Error(ge(421))),wy(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=gU.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ss=tl(s.nextSibling),Is=e,hn=!0,vi=null,t!==null&&(Ys[Xs++]=Vo,Ys[Xs++]=Fo,Ys[Xs++]=Rc,Vo=t.id,Fo=t.overflow,Rc=e),e=FN(e,r.children),e.flags|=4096,e)}function EC(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Yw(t.return,e,n)}function h_(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function DM(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Fr(t,e,r.children,n),r=pn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&EC(t,n,e);else if(t.tag===19)EC(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(en(pn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Gx(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),h_(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Gx(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}h_(e,!0,n,null,i);break;case"together":h_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Lc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ge(153));if(e.child!==null){for(t=e.child,n=il(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=il(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function sU(t,e,n){switch(e.tag){case 3:MM(e),Qd();break;case 5:cM(e);break;case 1:ds(e.type)&&Bx(e);break;case 4:AN(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;en(qx,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(en(pn,pn.current&1),e.flags|=128,null):n&e.child.childLanes?OM(t,e,n):(en(pn,pn.current&1),t=Jo(t,e,n),t!==null?t.sibling:null);en(pn,pn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return DM(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),en(pn,pn.current),r)break;return null;case 22:case 23:return e.lanes=0,PM(t,e,n)}return Jo(t,e,n)}var VM,ik,FM,zM;VM=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ik=function(){};FM=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,pc(Xi.current);var i=null;switch(n){case"input":s=Ew(t,s),r=Ew(t,r),i=[];break;case"select":s=wn({},s,{value:void 0}),r=wn({},r,{value:void 0}),i=[];break;case"textarea":s=Iw(t,s),r=Iw(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fx)}Rw(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&($m.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&($m.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&nn("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};zM=function(t,e,n,r){n!==r&&(e.flags|=4)};function Pf(t,e){if(!hn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Sr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function iU(t,e,n){var r=e.pendingProps;switch(NN(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sr(e),null;case 1:return ds(e.type)&&zx(),Sr(e),null;case 3:return r=e.stateNode,Yd(),on(us),on(Lr),PN(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(by(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vi!==null&&(fk(vi),vi=null))),ik(t,e),Sr(e),null;case 5:RN(e);var s=pc(ep.current);if(n=e.type,t!==null&&e.stateNode!=null)FM(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ge(166));return Sr(e),null}if(t=pc(Xi.current),by(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Wi]=e,r[Xm]=i,t=(e.mode&1)!==0,n){case"dialog":nn("cancel",r),nn("close",r);break;case"iframe":case"object":case"embed":nn("load",r);break;case"video":case"audio":for(s=0;s<em.length;s++)nn(em[s],r);break;case"source":nn("error",r);break;case"img":case"image":case"link":nn("error",r),nn("load",r);break;case"details":nn("toggle",r);break;case"input":O2(r,i),nn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},nn("invalid",r);break;case"textarea":V2(r,i),nn("invalid",r)}Rw(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&vy(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&vy(r.textContent,l,t),s=["children",""+l]):$m.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&nn("scroll",r)}switch(n){case"input":dy(r),D2(r,i,!0);break;case"textarea":dy(r),F2(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Fx)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mL(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Wi]=e,t[Xm]=r,VM(t,e,!1,!1),e.stateNode=t;e:{switch(a=Pw(n,r),n){case"dialog":nn("cancel",t),nn("close",t),s=r;break;case"iframe":case"object":case"embed":nn("load",t),s=r;break;case"video":case"audio":for(s=0;s<em.length;s++)nn(em[s],t);s=r;break;case"source":nn("error",t),s=r;break;case"img":case"image":case"link":nn("error",t),nn("load",t),s=r;break;case"details":nn("toggle",t),s=r;break;case"input":O2(t,r),s=Ew(t,r),nn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=wn({},r,{value:void 0}),nn("invalid",t);break;case"textarea":V2(t,r),s=Iw(t,r),nn("invalid",t);break;default:s=r}Rw(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?yL(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&pL(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Um(t,u):typeof u=="number"&&Um(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($m.hasOwnProperty(i)?u!=null&&i==="onScroll"&&nn("scroll",t):u!=null&&cN(t,i,u,a))}switch(n){case"input":dy(t),D2(t,r,!1);break;case"textarea":dy(t),F2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+pl(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Pd(t,!!r.multiple,i,!1):r.defaultValue!=null&&Pd(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Fx)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Sr(e),null;case 6:if(t&&e.stateNode!=null)zM(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ge(166));if(n=pc(ep.current),pc(Xi.current),by(e)){if(r=e.stateNode,n=e.memoizedProps,r[Wi]=e,(i=r.nodeValue!==n)&&(t=Is,t!==null))switch(t.tag){case 3:vy(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vy(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wi]=e,e.stateNode=r}return Sr(e),null;case 13:if(on(pn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(hn&&Ss!==null&&e.mode&1&&!(e.flags&128))sM(),Qd(),e.flags|=98560,i=!1;else if(i=by(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(ge(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ge(317));i[Wi]=e}else Qd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Sr(e),i=!1}else vi!==null&&(fk(vi),vi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||pn.current&1?Kn===0&&(Kn=3):WN())),e.updateQueue!==null&&(e.flags|=4),Sr(e),null);case 4:return Yd(),ik(t,e),t===null&&Zm(e.stateNode.containerInfo),Sr(e),null;case 10:return CN(e.type._context),Sr(e),null;case 17:return ds(e.type)&&zx(),Sr(e),null;case 19:if(on(pn),i=e.memoizedState,i===null)return Sr(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Pf(i,!1);else{if(Kn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Gx(t),a!==null){for(e.flags|=128,Pf(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return en(pn,pn.current&1|2),e.child}t=t.sibling}i.tail!==null&&Mn()>Jd&&(e.flags|=128,r=!0,Pf(i,!1),e.lanes=4194304)}else{if(!r)if(t=Gx(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Pf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!hn)return Sr(e),null}else 2*Mn()-i.renderingStartTime>Jd&&n!==1073741824&&(e.flags|=128,r=!0,Pf(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Mn(),e.sibling=null,n=pn.current,en(pn,r?n&1|2:n&1),e):(Sr(e),null);case 22:case 23:return qN(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?_s&1073741824&&(Sr(e),e.subtreeFlags&6&&(e.flags|=8192)):Sr(e),null;case 24:return null;case 25:return null}throw Error(ge(156,e.tag))}function oU(t,e){switch(NN(e),e.tag){case 1:return ds(e.type)&&zx(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yd(),on(us),on(Lr),PN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return RN(e),null;case 13:if(on(pn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ge(340));Qd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return on(pn),null;case 4:return Yd(),null;case 10:return CN(e.type._context),null;case 22:case 23:return qN(),null;case 24:return null;default:return null}}var ky=!1,Ir=!1,aU=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function _d(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Tn(t,e,r)}else n.current=null}function ok(t,e,n){try{n()}catch(r){Tn(t,e,r)}}var CC=!1;function lU(t,e){if(Uw=Ox,t=WL(),wN(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,d=0,f=0,m=t,p=null;t:for(;;){for(var v;m!==n||s!==0&&m.nodeType!==3||(l=a+s),m!==i||r!==0&&m.nodeType!==3||(u=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(v=m.firstChild)!==null;)p=m,m=v;for(;;){if(m===t)break t;if(p===n&&++d===s&&(l=a),p===i&&++f===r&&(u=a),(v=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=v}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(qw={focusedElem:t,selectionRange:n},Ox=!1,Oe=e;Oe!==null;)if(e=Oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Oe=t;else for(;Oe!==null;){e=Oe;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var _=x.memoizedProps,E=x.memoizedState,k=e.stateNode,b=k.getSnapshotBeforeUpdate(e.elementType===e.type?_:yi(e.type,_),E);k.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(C){Tn(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,Oe=t;break}Oe=e.return}return x=CC,CC=!1,x}function bm(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ok(e,n,i)}s=s.next}while(s!==r)}}function bv(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ak(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function BM(t){var e=t.alternate;e!==null&&(t.alternate=null,BM(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Wi],delete e[Xm],delete e[Gw],delete e[q$],delete e[W$])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $M(t){return t.tag===5||t.tag===3||t.tag===4}function jC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$M(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function lk(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fx));else if(r!==4&&(t=t.child,t!==null))for(lk(t,e,n),t=t.sibling;t!==null;)lk(t,e,n),t=t.sibling}function ck(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ck(t,e,n),t=t.sibling;t!==null;)ck(t,e,n),t=t.sibling}var pr=null,xi=!1;function Na(t,e,n){for(n=n.child;n!==null;)UM(t,e,n),n=n.sibling}function UM(t,e,n){if(Yi&&typeof Yi.onCommitFiberUnmount=="function")try{Yi.onCommitFiberUnmount(hv,n)}catch{}switch(n.tag){case 5:Ir||_d(n,e);case 6:var r=pr,s=xi;pr=null,Na(t,e,n),pr=r,xi=s,pr!==null&&(xi?(t=pr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):pr.removeChild(n.stateNode));break;case 18:pr!==null&&(xi?(t=pr,n=n.stateNode,t.nodeType===8?i_(t.parentNode,n):t.nodeType===1&&i_(t,n),Gm(t)):i_(pr,n.stateNode));break;case 4:r=pr,s=xi,pr=n.stateNode.containerInfo,xi=!0,Na(t,e,n),pr=r,xi=s;break;case 0:case 11:case 14:case 15:if(!Ir&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ok(n,e,a),s=s.next}while(s!==r)}Na(t,e,n);break;case 1:if(!Ir&&(_d(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Tn(n,e,l)}Na(t,e,n);break;case 21:Na(t,e,n);break;case 22:n.mode&1?(Ir=(r=Ir)||n.memoizedState!==null,Na(t,e,n),Ir=r):Na(t,e,n);break;default:Na(t,e,n)}}function IC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new aU),e.forEach(function(r){var s=yU.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function mi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:pr=l.stateNode,xi=!1;break e;case 3:pr=l.stateNode.containerInfo,xi=!0;break e;case 4:pr=l.stateNode.containerInfo,xi=!0;break e}l=l.return}if(pr===null)throw Error(ge(160));UM(i,a,s),pr=null,xi=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Tn(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)qM(e,t),e=e.sibling}function qM(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(mi(e,t),Bi(t),r&4){try{bm(3,t,t.return),bv(3,t)}catch(_){Tn(t,t.return,_)}try{bm(5,t,t.return)}catch(_){Tn(t,t.return,_)}}break;case 1:mi(e,t),Bi(t),r&512&&n!==null&&_d(n,n.return);break;case 5:if(mi(e,t),Bi(t),r&512&&n!==null&&_d(n,n.return),t.flags&32){var s=t.stateNode;try{Um(s,"")}catch(_){Tn(t,t.return,_)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&hL(s,i),Pw(l,a);var d=Pw(l,i);for(a=0;a<u.length;a+=2){var f=u[a],m=u[a+1];f==="style"?yL(s,m):f==="dangerouslySetInnerHTML"?pL(s,m):f==="children"?Um(s,m):cN(s,f,m,d)}switch(l){case"input":Cw(s,i);break;case"textarea":fL(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Pd(s,!!i.multiple,v,!1):p!==!!i.multiple&&(i.defaultValue!=null?Pd(s,!!i.multiple,i.defaultValue,!0):Pd(s,!!i.multiple,i.multiple?[]:"",!1))}s[Xm]=i}catch(_){Tn(t,t.return,_)}}break;case 6:if(mi(e,t),Bi(t),r&4){if(t.stateNode===null)throw Error(ge(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(_){Tn(t,t.return,_)}}break;case 3:if(mi(e,t),Bi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Gm(e.containerInfo)}catch(_){Tn(t,t.return,_)}break;case 4:mi(e,t),Bi(t);break;case 13:mi(e,t),Bi(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||($N=Mn())),r&4&&IC(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Ir=(d=Ir)||f,mi(e,t),Ir=d):mi(e,t),Bi(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(Oe=t,f=t.child;f!==null;){for(m=Oe=f;Oe!==null;){switch(p=Oe,v=p.child,p.tag){case 0:case 11:case 14:case 15:bm(4,p,p.return);break;case 1:_d(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(_){Tn(r,n,_)}}break;case 5:_d(p,p.return);break;case 22:if(p.memoizedState!==null){RC(m);continue}}v!==null?(v.return=p,Oe=v):RC(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=gL("display",a))}catch(_){Tn(t,t.return,_)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(_){Tn(t,t.return,_)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:mi(e,t),Bi(t),r&4&&IC(t);break;case 21:break;default:mi(e,t),Bi(t)}}function Bi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if($M(n)){var r=n;break e}n=n.return}throw Error(ge(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Um(s,""),r.flags&=-33);var i=jC(t);ck(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=jC(t);lk(t,l,a);break;default:throw Error(ge(161))}}catch(u){Tn(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cU(t,e,n){Oe=t,WM(t)}function WM(t,e,n){for(var r=(t.mode&1)!==0;Oe!==null;){var s=Oe,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||ky;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Ir;l=ky;var d=Ir;if(ky=a,(Ir=u)&&!d)for(Oe=s;Oe!==null;)a=Oe,u=a.child,a.tag===22&&a.memoizedState!==null?PC(s):u!==null?(u.return=a,Oe=u):PC(s);for(;i!==null;)Oe=i,WM(i),i=i.sibling;Oe=s,ky=l,Ir=d}AC(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Oe=i):AC(t)}}function AC(t){for(;Oe!==null;){var e=Oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ir||bv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ir)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:yi(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&pC(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}pC(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&Gm(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}Ir||e.flags&512&&ak(e)}catch(p){Tn(e,e.return,p)}}if(e===t){Oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Oe=n;break}Oe=e.return}}function RC(t){for(;Oe!==null;){var e=Oe;if(e===t){Oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Oe=n;break}Oe=e.return}}function PC(t){for(;Oe!==null;){var e=Oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bv(4,e)}catch(u){Tn(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Tn(e,s,u)}}var i=e.return;try{ak(e)}catch(u){Tn(e,i,u)}break;case 5:var a=e.return;try{ak(e)}catch(u){Tn(e,a,u)}}}catch(u){Tn(e,e.return,u)}if(e===t){Oe=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Oe=l;break}Oe=e.return}}var uU=Math.ceil,Zx=aa.ReactCurrentDispatcher,zN=aa.ReactCurrentOwner,ri=aa.ReactCurrentBatchConfig,It=0,lr=null,Un=null,xr=0,_s=0,wd=Al(0),Kn=0,sp=null,Lc=0,_v=0,BN=0,_m=null,ns=null,$N=0,Jd=1/0,Lo=null,Yx=!1,uk=null,rl=null,Ny=!1,Ha=null,Xx=0,wm=0,dk=null,rx=-1,sx=0;function Ur(){return It&6?Mn():rx!==-1?rx:rx=Mn()}function sl(t){return t.mode&1?It&2&&xr!==0?xr&-xr:G$.transition!==null?(sx===0&&(sx=jL()),sx):(t=Bt,t!==0||(t=window.event,t=t===void 0?16:OL(t.type)),t):1}function Ei(t,e,n,r){if(50<wm)throw wm=0,dk=null,Error(ge(185));Hp(t,n,r),(!(It&2)||t!==lr)&&(t===lr&&(!(It&2)&&(_v|=n),Kn===4&&Da(t,xr)),hs(t,r),n===1&&It===0&&!(e.mode&1)&&(Jd=Mn()+500,yv&&Rl()))}function hs(t,e){var n=t.callbackNode;GB(t,e);var r=Mx(t,t===lr?xr:0);if(r===0)n!==null&&$2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&$2(n),e===1)t.tag===0?H$(LC.bind(null,t)):tM(LC.bind(null,t)),$$(function(){!(It&6)&&Rl()}),n=null;else{switch(IL(r)){case 1:n=mN;break;case 4:n=EL;break;case 16:n=Lx;break;case 536870912:n=CL;break;default:n=Lx}n=JM(n,HM.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function HM(t,e){if(rx=-1,sx=0,It&6)throw Error(ge(327));var n=t.callbackNode;if(Vd()&&t.callbackNode!==n)return null;var r=Mx(t,t===lr?xr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Jx(t,r);else{e=r;var s=It;It|=2;var i=KM();(lr!==t||xr!==e)&&(Lo=null,Jd=Mn()+500,bc(t,e));do try{fU();break}catch(l){GM(t,l)}while(!0);EN(),Zx.current=i,It=s,Un!==null?e=0:(lr=null,xr=0,e=Kn)}if(e!==0){if(e===2&&(s=Vw(t),s!==0&&(r=s,e=hk(t,s))),e===1)throw n=sp,bc(t,0),Da(t,r),hs(t,Mn()),n;if(e===6)Da(t,r);else{if(s=t.current.alternate,!(r&30)&&!dU(s)&&(e=Jx(t,r),e===2&&(i=Vw(t),i!==0&&(r=i,e=hk(t,i))),e===1))throw n=sp,bc(t,0),Da(t,r),hs(t,Mn()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(ge(345));case 2:nc(t,ns,Lo);break;case 3:if(Da(t,r),(r&130023424)===r&&(e=$N+500-Mn(),10<e)){if(Mx(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ur(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Hw(nc.bind(null,t,ns,Lo),e);break}nc(t,ns,Lo);break;case 4:if(Da(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Ti(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Mn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uU(r/1960))-r,10<r){t.timeoutHandle=Hw(nc.bind(null,t,ns,Lo),r);break}nc(t,ns,Lo);break;case 5:nc(t,ns,Lo);break;default:throw Error(ge(329))}}}return hs(t,Mn()),t.callbackNode===n?HM.bind(null,t):null}function hk(t,e){var n=_m;return t.current.memoizedState.isDehydrated&&(bc(t,e).flags|=256),t=Jx(t,e),t!==2&&(e=ns,ns=n,e!==null&&fk(e)),t}function fk(t){ns===null?ns=t:ns.push.apply(ns,t)}function dU(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ai(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Da(t,e){for(e&=~BN,e&=~_v,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ti(e),r=1<<n;t[n]=-1,e&=~r}}function LC(t){if(It&6)throw Error(ge(327));Vd();var e=Mx(t,0);if(!(e&1))return hs(t,Mn()),null;var n=Jx(t,e);if(t.tag!==0&&n===2){var r=Vw(t);r!==0&&(e=r,n=hk(t,r))}if(n===1)throw n=sp,bc(t,0),Da(t,e),hs(t,Mn()),n;if(n===6)throw Error(ge(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nc(t,ns,Lo),hs(t,Mn()),null}function UN(t,e){var n=It;It|=1;try{return t(e)}finally{It=n,It===0&&(Jd=Mn()+500,yv&&Rl())}}function Mc(t){Ha!==null&&Ha.tag===0&&!(It&6)&&Vd();var e=It;It|=1;var n=ri.transition,r=Bt;try{if(ri.transition=null,Bt=1,t)return t()}finally{Bt=r,ri.transition=n,It=e,!(It&6)&&Rl()}}function qN(){_s=wd.current,on(wd)}function bc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,B$(n)),Un!==null)for(n=Un.return;n!==null;){var r=n;switch(NN(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zx();break;case 3:Yd(),on(us),on(Lr),PN();break;case 5:RN(r);break;case 4:Yd();break;case 13:on(pn);break;case 19:on(pn);break;case 10:CN(r.type._context);break;case 22:case 23:qN()}n=n.return}if(lr=t,Un=t=il(t.current,null),xr=_s=e,Kn=0,sp=null,BN=_v=Lc=0,ns=_m=null,mc!==null){for(e=0;e<mc.length;e++)if(n=mc[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}mc=null}return t}function GM(t,e){do{var n=Un;try{if(EN(),ex.current=Qx,Kx){for(var r=vn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Kx=!1}if(Pc=0,rr=Hn=vn=null,vm=!1,tp=0,zN.current=null,n===null||n.return===null){Kn=1,sp=e,Un=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=xr,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=l,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=_C(a);if(v!==null){v.flags&=-257,wC(v,a,l,i,e),v.mode&1&&bC(i,d,e),e=v,u=d;var x=e.updateQueue;if(x===null){var _=new Set;_.add(u),e.updateQueue=_}else x.add(u);break e}else{if(!(e&1)){bC(i,d,e),WN();break e}u=Error(ge(426))}}else if(hn&&l.mode&1){var E=_C(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),wC(E,a,l,i,e),SN(Xd(u,l));break e}}i=u=Xd(u,l),Kn!==4&&(Kn=2),_m===null?_m=[i]:_m.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=IM(i,u,e);mC(i,k);break e;case 1:l=u;var b=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(rl===null||!rl.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=AM(i,l,e);mC(i,C);break e}}i=i.return}while(i!==null)}ZM(n)}catch(P){e=P,Un===n&&n!==null&&(Un=n=n.return);continue}break}while(!0)}function KM(){var t=Zx.current;return Zx.current=Qx,t===null?Qx:t}function WN(){(Kn===0||Kn===3||Kn===2)&&(Kn=4),lr===null||!(Lc&268435455)&&!(_v&268435455)||Da(lr,xr)}function Jx(t,e){var n=It;It|=2;var r=KM();(lr!==t||xr!==e)&&(Lo=null,bc(t,e));do try{hU();break}catch(s){GM(t,s)}while(!0);if(EN(),It=n,Zx.current=r,Un!==null)throw Error(ge(261));return lr=null,xr=0,Kn}function hU(){for(;Un!==null;)QM(Un)}function fU(){for(;Un!==null&&!VB();)QM(Un)}function QM(t){var e=XM(t.alternate,t,_s);t.memoizedProps=t.pendingProps,e===null?ZM(t):Un=e,zN.current=null}function ZM(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=oU(n,e),n!==null){n.flags&=32767,Un=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kn=6,Un=null;return}}else if(n=iU(n,e,_s),n!==null){Un=n;return}if(e=e.sibling,e!==null){Un=e;return}Un=e=t}while(e!==null);Kn===0&&(Kn=5)}function nc(t,e,n){var r=Bt,s=ri.transition;try{ri.transition=null,Bt=1,mU(t,e,n,r)}finally{ri.transition=s,Bt=r}return null}function mU(t,e,n,r){do Vd();while(Ha!==null);if(It&6)throw Error(ge(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ge(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(KB(t,i),t===lr&&(Un=lr=null,xr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ny||(Ny=!0,JM(Lx,function(){return Vd(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ri.transition,ri.transition=null;var a=Bt;Bt=1;var l=It;It|=4,zN.current=null,lU(t,n),qM(n,t),L$(qw),Ox=!!Uw,qw=Uw=null,t.current=n,cU(n),FB(),It=l,Bt=a,ri.transition=i}else t.current=n;if(Ny&&(Ny=!1,Ha=t,Xx=s),i=t.pendingLanes,i===0&&(rl=null),$B(n.stateNode),hs(t,Mn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Yx)throw Yx=!1,t=uk,uk=null,t;return Xx&1&&t.tag!==0&&Vd(),i=t.pendingLanes,i&1?t===dk?wm++:(wm=0,dk=t):wm=0,Rl(),null}function Vd(){if(Ha!==null){var t=IL(Xx),e=ri.transition,n=Bt;try{if(ri.transition=null,Bt=16>t?16:t,Ha===null)var r=!1;else{if(t=Ha,Ha=null,Xx=0,It&6)throw Error(ge(331));var s=It;for(It|=4,Oe=t.current;Oe!==null;){var i=Oe,a=i.child;if(Oe.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(Oe=d;Oe!==null;){var f=Oe;switch(f.tag){case 0:case 11:case 15:bm(8,f,i)}var m=f.child;if(m!==null)m.return=f,Oe=m;else for(;Oe!==null;){f=Oe;var p=f.sibling,v=f.return;if(BM(f),f===d){Oe=null;break}if(p!==null){p.return=v,Oe=p;break}Oe=v}}}var x=i.alternate;if(x!==null){var _=x.child;if(_!==null){x.child=null;do{var E=_.sibling;_.sibling=null,_=E}while(_!==null)}}Oe=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Oe=a;else e:for(;Oe!==null;){if(i=Oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:bm(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,Oe=k;break e}Oe=i.return}}var b=t.current;for(Oe=b;Oe!==null;){a=Oe;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,Oe=S;else e:for(a=b;Oe!==null;){if(l=Oe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:bv(9,l)}}catch(P){Tn(l,l.return,P)}if(l===a){Oe=null;break e}var C=l.sibling;if(C!==null){C.return=l.return,Oe=C;break e}Oe=l.return}}if(It=s,Rl(),Yi&&typeof Yi.onPostCommitFiberRoot=="function")try{Yi.onPostCommitFiberRoot(hv,t)}catch{}r=!0}return r}finally{Bt=n,ri.transition=e}}return!1}function MC(t,e,n){e=Xd(n,e),e=IM(t,e,1),t=nl(t,e,1),e=Ur(),t!==null&&(Hp(t,1,e),hs(t,e))}function Tn(t,e,n){if(t.tag===3)MC(t,t,n);else for(;e!==null;){if(e.tag===3){MC(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(rl===null||!rl.has(r))){t=Xd(n,t),t=AM(e,t,1),e=nl(e,t,1),t=Ur(),e!==null&&(Hp(e,1,t),hs(e,t));break}}e=e.return}}function pU(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ur(),t.pingedLanes|=t.suspendedLanes&n,lr===t&&(xr&n)===n&&(Kn===4||Kn===3&&(xr&130023424)===xr&&500>Mn()-$N?bc(t,0):BN|=n),hs(t,e)}function YM(t,e){e===0&&(t.mode&1?(e=my,my<<=1,!(my&130023424)&&(my=4194304)):e=1);var n=Ur();t=Xo(t,e),t!==null&&(Hp(t,e,n),hs(t,n))}function gU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),YM(t,n)}function yU(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ge(314))}r!==null&&r.delete(e),YM(t,n)}var XM;XM=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||us.current)rs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rs=!1,sU(t,e,n);rs=!!(t.flags&131072)}else rs=!1,hn&&e.flags&1048576&&nM(e,Ux,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;nx(t,e),t=e.pendingProps;var s=Kd(e,Lr.current);Dd(e,n),s=MN(null,e,r,t,s,n);var i=ON();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ds(r)?(i=!0,Bx(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,IN(e),s.updater=vv,e.stateNode=s,s._reactInternals=e,Jw(e,r,t,n),e=nk(null,e,r,!0,i,n)):(e.tag=0,hn&&i&&kN(e),Fr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(nx(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=vU(r),t=yi(r,t),s){case 0:e=tk(null,e,r,t,n);break e;case 1:e=SC(null,e,r,t,n);break e;case 11:e=kC(null,e,r,t,n);break e;case 14:e=NC(null,e,r,yi(r.type,t),n);break e}throw Error(ge(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yi(r,s),tk(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yi(r,s),SC(t,e,r,s,n);case 3:e:{if(MM(e),t===null)throw Error(ge(387));r=e.pendingProps,i=e.memoizedState,s=i.element,lM(t,e),Hx(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Xd(Error(ge(423)),e),e=TC(t,e,r,n,s);break e}else if(r!==s){s=Xd(Error(ge(424)),e),e=TC(t,e,r,n,s);break e}else for(Ss=tl(e.stateNode.containerInfo.firstChild),Is=e,hn=!0,vi=null,n=oM(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Qd(),r===s){e=Jo(t,e,n);break e}Fr(t,e,r,n)}e=e.child}return e;case 5:return cM(e),t===null&&Zw(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Ww(r,s)?a=null:i!==null&&Ww(r,i)&&(e.flags|=32),LM(t,e),Fr(t,e,a,n),e.child;case 6:return t===null&&Zw(e),null;case 13:return OM(t,e,n);case 4:return AN(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Zd(e,null,r,n):Fr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yi(r,s),kC(t,e,r,s,n);case 7:return Fr(t,e,e.pendingProps,n),e.child;case 8:return Fr(t,e,e.pendingProps.children,n),e.child;case 12:return Fr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,en(qx,r._currentValue),r._currentValue=a,i!==null)if(Ai(i.value,a)){if(i.children===s.children&&!us.current){e=Jo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Wo(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Yw(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ge(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Yw(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Fr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Dd(e,n),s=si(s),r=r(s),e.flags|=1,Fr(t,e,r,n),e.child;case 14:return r=e.type,s=yi(r,e.pendingProps),s=yi(r.type,s),NC(t,e,r,s,n);case 15:return RM(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:yi(r,s),nx(t,e),e.tag=1,ds(r)?(t=!0,Bx(e)):t=!1,Dd(e,n),jM(e,r,s),Jw(e,r,s,n),nk(null,e,r,!0,t,n);case 19:return DM(t,e,n);case 22:return PM(t,e,n)}throw Error(ge(156,e.tag))};function JM(t,e){return TL(t,e)}function xU(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(t,e,n,r){return new xU(t,e,n,r)}function HN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function vU(t){if(typeof t=="function")return HN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dN)return 11;if(t===hN)return 14}return 2}function il(t,e){var n=t.alternate;return n===null?(n=ei(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ix(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")HN(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case hd:return _c(n.children,s,i,e);case uN:a=8,s|=8;break;case kw:return t=ei(12,n,e,s|2),t.elementType=kw,t.lanes=i,t;case Nw:return t=ei(13,n,e,s),t.elementType=Nw,t.lanes=i,t;case Sw:return t=ei(19,n,e,s),t.elementType=Sw,t.lanes=i,t;case cL:return wv(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case aL:a=10;break e;case lL:a=9;break e;case dN:a=11;break e;case hN:a=14;break e;case Ra:a=16,r=null;break e}throw Error(ge(130,t==null?t:typeof t,""))}return e=ei(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function _c(t,e,n,r){return t=ei(7,t,r,e),t.lanes=n,t}function wv(t,e,n,r){return t=ei(22,t,r,e),t.elementType=cL,t.lanes=n,t.stateNode={isHidden:!1},t}function f_(t,e,n){return t=ei(6,t,null,e),t.lanes=n,t}function m_(t,e,n){return e=ei(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function bU(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kb(0),this.expirationTimes=Kb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kb(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function GN(t,e,n,r,s,i,a,l,u){return t=new bU(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ei(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},IN(i),t}function _U(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dd,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function eO(t){if(!t)return gl;t=t._reactInternals;e:{if(uu(t)!==t||t.tag!==1)throw Error(ge(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ds(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ge(171))}if(t.tag===1){var n=t.type;if(ds(n))return eM(t,n,e)}return e}function tO(t,e,n,r,s,i,a,l,u){return t=GN(n,r,!0,t,s,i,a,l,u),t.context=eO(null),n=t.current,r=Ur(),s=sl(n),i=Wo(r,s),i.callback=e??null,nl(n,i,s),t.current.lanes=s,Hp(t,s,r),hs(t,r),t}function kv(t,e,n,r){var s=e.current,i=Ur(),a=sl(s);return n=eO(n),e.context===null?e.context=n:e.pendingContext=n,e=Wo(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=nl(s,e,a),t!==null&&(Ei(t,s,a,i),Jy(t,s,a)),a}function e0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function OC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function KN(t,e){OC(t,e),(t=t.alternate)&&OC(t,e)}function wU(){return null}var nO=typeof reportError=="function"?reportError:function(t){console.error(t)};function QN(t){this._internalRoot=t}Nv.prototype.render=QN.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ge(409));kv(t,e,null,null)};Nv.prototype.unmount=QN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Mc(function(){kv(null,t,null,null)}),e[Yo]=null}};function Nv(t){this._internalRoot=t}Nv.prototype.unstable_scheduleHydration=function(t){if(t){var e=PL();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oa.length&&e!==0&&e<Oa[n].priority;n++);Oa.splice(n,0,t),n===0&&ML(t)}};function ZN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Sv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function DC(){}function kU(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=e0(a);i.call(d)}}var a=tO(e,r,t,0,null,!1,!1,"",DC);return t._reactRootContainer=a,t[Yo]=a.current,Zm(t.nodeType===8?t.parentNode:t),Mc(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=e0(u);l.call(d)}}var u=GN(t,0,!1,null,null,!1,!1,"",DC);return t._reactRootContainer=u,t[Yo]=u.current,Zm(t.nodeType===8?t.parentNode:t),Mc(function(){kv(e,u,n,r)}),u}function Tv(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=e0(a);l.call(u)}}kv(e,a,t,s)}else a=kU(n,e,t,s,r);return e0(a)}AL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Jf(e.pendingLanes);n!==0&&(pN(e,n|1),hs(e,Mn()),!(It&6)&&(Jd=Mn()+500,Rl()))}break;case 13:Mc(function(){var r=Xo(t,1);if(r!==null){var s=Ur();Ei(r,t,1,s)}}),KN(t,1)}};gN=function(t){if(t.tag===13){var e=Xo(t,134217728);if(e!==null){var n=Ur();Ei(e,t,134217728,n)}KN(t,134217728)}};RL=function(t){if(t.tag===13){var e=sl(t),n=Xo(t,e);if(n!==null){var r=Ur();Ei(n,t,e,r)}KN(t,e)}};PL=function(){return Bt};LL=function(t,e){var n=Bt;try{return Bt=t,e()}finally{Bt=n}};Mw=function(t,e,n){switch(e){case"input":if(Cw(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=gv(r);if(!s)throw Error(ge(90));dL(r),Cw(r,s)}}}break;case"textarea":fL(t,n);break;case"select":e=n.value,e!=null&&Pd(t,!!n.multiple,e,!1)}};bL=UN;_L=Mc;var NU={usingClientEntryPoint:!1,Events:[Kp,gd,gv,xL,vL,UN]},Lf={findFiberByHostInstance:fc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SU={bundleType:Lf.bundleType,version:Lf.version,rendererPackageName:Lf.rendererPackageName,rendererConfig:Lf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:aa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=NL(t),t===null?null:t.stateNode},findFiberByHostInstance:Lf.findFiberByHostInstance||wU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sy.isDisabled&&Sy.supportsFiber)try{hv=Sy.inject(SU),Yi=Sy}catch{}}Ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NU;Ds.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ZN(e))throw Error(ge(200));return _U(t,e,null,n)};Ds.createRoot=function(t,e){if(!ZN(t))throw Error(ge(299));var n=!1,r="",s=nO;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=GN(t,1,!1,null,null,n,!1,r,s),t[Yo]=e.current,Zm(t.nodeType===8?t.parentNode:t),new QN(e)};Ds.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ge(188)):(t=Object.keys(t).join(","),Error(ge(268,t)));return t=NL(e),t=t===null?null:t.stateNode,t};Ds.flushSync=function(t){return Mc(t)};Ds.hydrate=function(t,e,n){if(!Sv(e))throw Error(ge(200));return Tv(null,t,e,!0,n)};Ds.hydrateRoot=function(t,e,n){if(!ZN(t))throw Error(ge(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=nO;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=tO(e,null,t,1,n??null,s,!1,i,a),t[Yo]=e.current,Zm(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Nv(e)};Ds.render=function(t,e,n){if(!Sv(e))throw Error(ge(200));return Tv(null,t,e,!1,n)};Ds.unmountComponentAtNode=function(t){if(!Sv(t))throw Error(ge(40));return t._reactRootContainer?(Mc(function(){Tv(null,null,t,!1,function(){t._reactRootContainer=null,t[Yo]=null})}),!0):!1};Ds.unstable_batchedUpdates=UN;Ds.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Sv(n))throw Error(ge(200));if(t==null||t._reactInternals===void 0)throw Error(ge(38));return Tv(t,e,n,!1,r)};Ds.version="18.3.1-next-f1338f8080-20240426";function rO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rO)}catch(t){console.error(t)}}rO(),rL.exports=Ds;var sO=rL.exports,VC=sO;_w.createRoot=VC.createRoot,_w.hydrateRoot=VC.hydrateRoot;var Hi=[],Zs=[],TU=Uint8Array,p_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Yu=0,EU=p_.length;Yu<EU;++Yu)Hi[Yu]=p_[Yu],Zs[p_.charCodeAt(Yu)]=Yu;Zs[45]=62;Zs[95]=63;function CU(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function jU(t,e,n){return(e+n)*3/4-n}function ip(t){var e,n=CU(t),r=n[0],s=n[1],i=new TU(jU(t,r,s)),a=0,l=s>0?r-4:r,u;for(u=0;u<l;u+=4)e=Zs[t.charCodeAt(u)]<<18|Zs[t.charCodeAt(u+1)]<<12|Zs[t.charCodeAt(u+2)]<<6|Zs[t.charCodeAt(u+3)],i[a++]=e>>16&255,i[a++]=e>>8&255,i[a++]=e&255;return s===2&&(e=Zs[t.charCodeAt(u)]<<2|Zs[t.charCodeAt(u+1)]>>4,i[a++]=e&255),s===1&&(e=Zs[t.charCodeAt(u)]<<10|Zs[t.charCodeAt(u+1)]<<4|Zs[t.charCodeAt(u+2)]>>2,i[a++]=e>>8&255,i[a++]=e&255),i}function IU(t){return Hi[t>>18&63]+Hi[t>>12&63]+Hi[t>>6&63]+Hi[t&63]}function AU(t,e,n){for(var r,s=[],i=e;i<n;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(IU(r));return s.join("")}function op(t){for(var e,n=t.length,r=n%3,s=[],i=16383,a=0,l=n-r;a<l;a+=i)s.push(AU(t,a,a+i>l?l:a+i));return r===1?(e=t[n-1],s.push(Hi[e>>2]+Hi[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],s.push(Hi[e>>10]+Hi[e>>4&63]+Hi[e<<2&63]+"=")),s.join("")}function Oo(t){if(t===void 0)return{};if(!iO(t))throw new Error(`The arguments to a Convex function must be an object. Received: ${t}`);return t}function RU(t){if(typeof t>"u")throw new Error("Client created with undefined deployment address. If you used an environment variable, check that it's set.");if(typeof t!="string")throw new Error(`Invalid deployment address: found ${t}".`);if(!(t.startsWith("http:")||t.startsWith("https:")))throw new Error(`Invalid deployment address: Must start with "https://" or "http://". Found "${t}".`);try{new URL(t)}catch{throw new Error(`Invalid deployment address: "${t}" is not a valid URL. If you believe this URL is correct, use the \`skipConvexDeploymentUrlCheck\` option to bypass this.`)}if(t.endsWith(".convex.site"))throw new Error(`Invalid deployment address: "${t}" ends with .convex.site, which is used for HTTP Actions. Convex deployment URLs typically end with .convex.cloud? If you believe this URL is correct, use the \`skipConvexDeploymentUrlCheck\` option to bypass this.`)}function iO(t){var s;const e=typeof t=="object",n=Object.getPrototypeOf(t),r=n===null||n===Object.prototype||((s=n==null?void 0:n.constructor)==null?void 0:s.name)==="Object";return e&&r}const oO=!0,eh=BigInt("-9223372036854775808"),YN=BigInt("9223372036854775807"),mk=BigInt("0"),PU=BigInt("8"),LU=BigInt("256");function aO(t){return Number.isNaN(t)||!Number.isFinite(t)||Object.is(t,-0)}function MU(t){t<mk&&(t-=eh+eh);let e=t.toString(16);e.length%2===1&&(e="0"+e);const n=new Uint8Array(new ArrayBuffer(8));let r=0;for(const s of e.match(/.{2}/g).reverse())n.set([parseInt(s,16)],r++),t>>=PU;return op(n)}function OU(t){const e=ip(t);if(e.byteLength!==8)throw new Error(`Received ${e.byteLength} bytes, expected 8 for $integer`);let n=mk,r=mk;for(const s of e)n+=BigInt(s)*LU**r,r++;return n>YN&&(n+=eh+eh),n}function DU(t){if(t<eh||YN<t)throw new Error(`BigInt ${t} does not fit into a 64-bit signed integer.`);const e=new ArrayBuffer(8);return new DataView(e).setBigInt64(0,t,!0),op(new Uint8Array(e))}function VU(t){const e=ip(t);if(e.byteLength!==8)throw new Error(`Received ${e.byteLength} bytes, expected 8 for $integer`);return new DataView(e.buffer).getBigInt64(0,!0)}const FU=DataView.prototype.setBigInt64?DU:MU,zU=DataView.prototype.getBigInt64?VU:OU,FC=1024;function lO(t){if(t.length>FC)throw new Error(`Field name ${t} exceeds maximum field name length ${FC}.`);if(t.startsWith("$"))throw new Error(`Field name ${t} starts with a '$', which is reserved.`);for(let e=0;e<t.length;e+=1){const n=t.charCodeAt(e);if(n<32||n>=127)throw new Error(`Field name ${t} has invalid character '${t[e]}': Field names can only contain non-control ASCII characters`)}}function th(t){if(t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string")return t;if(Array.isArray(t))return t.map(r=>th(r));if(typeof t!="object")throw new Error(`Unexpected type of ${t}`);const e=Object.entries(t);if(e.length===1){const r=e[0][0];if(r==="$bytes"){if(typeof t.$bytes!="string")throw new Error(`Malformed $bytes field on ${t}`);return ip(t.$bytes).buffer}if(r==="$integer"){if(typeof t.$integer!="string")throw new Error(`Malformed $integer field on ${t}`);return zU(t.$integer)}if(r==="$float"){if(typeof t.$float!="string")throw new Error(`Malformed $float field on ${t}`);const s=ip(t.$float);if(s.byteLength!==8)throw new Error(`Received ${s.byteLength} bytes, expected 8 for $float`);const a=new DataView(s.buffer).getFloat64(0,oO);if(!aO(a))throw new Error(`Float ${a} should be encoded as a number`);return a}if(r==="$set")throw new Error("Received a Set which is no longer supported as a Convex type.");if(r==="$map")throw new Error("Received a Map which is no longer supported as a Convex type.")}const n={};for(const[r,s]of Object.entries(t))lO(r),n[r]=th(s);return n}const zC=16384;function km(t){const e=JSON.stringify(t,(n,r)=>r===void 0?"undefined":typeof r=="bigint"?`${r.toString()}n`:r);if(e.length>zC){const n="[...truncated]";let r=zC-n.length;const s=e.codePointAt(r-1);return s!==void 0&&s>65535&&(r-=1),e.substring(0,r)+n}return e}function pk(t,e,n,r){var a;if(t===void 0){const l=n&&` (present at path ${n} in original object ${km(e)})`;throw new Error(`undefined is not a valid Convex value${l}. To learn about Convex's supported types, see https://docs.convex.dev/using/types.`)}if(t===null)return t;if(typeof t=="bigint"){if(t<eh||YN<t)throw new Error(`BigInt ${t} does not fit into a 64-bit signed integer.`);return{$integer:FU(t)}}if(typeof t=="number")if(aO(t)){const l=new ArrayBuffer(8);return new DataView(l).setFloat64(0,t,oO),{$float:op(new Uint8Array(l))}}else return t;if(typeof t=="boolean"||typeof t=="string")return t;if(t instanceof ArrayBuffer)return{$bytes:op(new Uint8Array(t))};if(Array.isArray(t))return t.map((l,u)=>pk(l,e,n+`[${u}]`));if(t instanceof Set)throw new Error(g_(n,"Set",[...t],e));if(t instanceof Map)throw new Error(g_(n,"Map",[...t],e));if(!iO(t)){const l=(a=t==null?void 0:t.constructor)==null?void 0:a.name,u=l?`${l} `:"";throw new Error(g_(n,u,t,e))}const s={},i=Object.entries(t);i.sort(([l,u],[d,f])=>l===d?0:l<d?-1:1);for(const[l,u]of i)u!==void 0&&(lO(l),s[l]=pk(u,e,n+`.${l}`));return s}function g_(t,e,n,r){return t?`${e}${km(n)} is not a supported Convex type (present at path ${t} in original object ${km(r)}). To learn about Convex's supported types, see https://docs.convex.dev/using/types.`:`${e}${km(n)} is not a supported Convex type.`}function io(t){return pk(t,t,"")}var BU=Object.defineProperty,$U=(t,e,n)=>e in t?BU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,y_=(t,e,n)=>$U(t,typeof e!="symbol"?e+"":e,n),BC,$C;const UU=Symbol.for("ConvexError");class gk extends($C=Error,BC=UU,$C){constructor(e){super(typeof e=="string"?e:km(e)),y_(this,"name","ConvexError"),y_(this,"data"),y_(this,BC,!0),this.data=e}}const cO=()=>Array.from({length:4},()=>0);cO();cO();const UC="1.30.0";var qU=Object.defineProperty,WU=(t,e,n)=>e in t?qU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qC=(t,e,n)=>WU(t,typeof e!="symbol"?e+"":e,n);const HU="color:rgb(0, 145, 255)";function uO(t){switch(t){case"query":return"Q";case"mutation":return"M";case"action":return"A";case"any":return"?"}}class dO{constructor(e){qC(this,"_onLogLineFuncs"),qC(this,"_verbose"),this._onLogLineFuncs={},this._verbose=e.verbose}addLogLineListener(e){let n=Math.random().toString(36).substring(2,15);for(let r=0;r<10&&this._onLogLineFuncs[n]!==void 0;r++)n=Math.random().toString(36).substring(2,15);return this._onLogLineFuncs[n]=e,()=>{delete this._onLogLineFuncs[n]}}logVerbose(...e){if(this._verbose)for(const n of Object.values(this._onLogLineFuncs))n("debug",`${new Date().toISOString()}`,...e)}log(...e){for(const n of Object.values(this._onLogLineFuncs))n("info",...e)}warn(...e){for(const n of Object.values(this._onLogLineFuncs))n("warn",...e)}error(...e){for(const n of Object.values(this._onLogLineFuncs))n("error",...e)}}function hO(t){const e=new dO(t);return e.addLogLineListener((n,...r)=>{switch(n){case"debug":console.debug(...r);break;case"info":console.log(...r);break;case"warn":console.warn(...r);break;case"error":console.error(...r);break;default:console.log(...r)}}),e}function fO(t){return new dO(t)}function t0(t,e,n,r,s){const i=uO(n);if(typeof s=="object"&&(s=`ConvexError ${JSON.stringify(s.errorData,null,2)}`),e==="info"){const a=s.match(/^\[.*?\] /);if(a===null){t.error(`[CONVEX ${i}(${r})] Could not parse console.log`);return}const l=s.slice(1,a[0].length-2),u=s.slice(a[0].length);t.log(`%c[CONVEX ${i}(${r})] [${l}]`,HU,u)}else t.error(`[CONVEX ${i}(${r})] ${s}`)}function GU(t,e){const n=`[CONVEX FATAL ERROR] ${e}`;return t.error(n),new Error(n)}function kd(t,e,n){return`[CONVEX ${uO(t)}(${e})] ${n.errorMessage}
  Called by client`}function yk(t,e){return e.data=t.errorData,e}function Oc(t){const e=t.split(":");let n,r;return e.length===1?(n=e[0],r="default"):(n=e.slice(0,e.length-1).join(":"),r=e[e.length-1]),n.endsWith(".js")&&(n=n.slice(0,-3)),`${n}:${r}`}function wc(t,e){return JSON.stringify({udfPath:Oc(t),args:io(e)})}function WC(t,e,n){const{initialNumItems:r,id:s}=n;return JSON.stringify({type:"paginated",udfPath:Oc(t),args:io(e),options:io({initialNumItems:r,id:s})})}var KU=Object.defineProperty,QU=(t,e,n)=>e in t?KU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$i=(t,e,n)=>QU(t,typeof e!="symbol"?e+"":e,n);class ZU{constructor(){$i(this,"nextQueryId"),$i(this,"querySetVersion"),$i(this,"querySet"),$i(this,"queryIdToToken"),$i(this,"identityVersion"),$i(this,"auth"),$i(this,"outstandingQueriesOlderThanRestart"),$i(this,"outstandingAuthOlderThanRestart"),$i(this,"paused"),$i(this,"pendingQuerySetModifications"),this.nextQueryId=0,this.querySetVersion=0,this.identityVersion=0,this.querySet=new Map,this.queryIdToToken=new Map,this.outstandingQueriesOlderThanRestart=new Set,this.outstandingAuthOlderThanRestart=!1,this.paused=!1,this.pendingQuerySetModifications=new Map}hasSyncedPastLastReconnect(){return this.outstandingQueriesOlderThanRestart.size===0&&!this.outstandingAuthOlderThanRestart}markAuthCompletion(){this.outstandingAuthOlderThanRestart=!1}subscribe(e,n,r,s){const i=Oc(e),a=wc(i,n),l=this.querySet.get(a);if(l!==void 0)return l.numSubscribers+=1,{queryToken:a,modification:null,unsubscribe:()=>this.removeSubscriber(a)};{const u=this.nextQueryId++,d={id:u,canonicalizedUdfPath:i,args:n,numSubscribers:1,journal:r,componentPath:s};this.querySet.set(a,d),this.queryIdToToken.set(u,a);const f=this.querySetVersion,m=this.querySetVersion+1,p={type:"Add",queryId:u,udfPath:i,args:[io(n)],journal:r,componentPath:s};return this.paused?this.pendingQuerySetModifications.set(u,p):this.querySetVersion=m,{queryToken:a,modification:{type:"ModifyQuerySet",baseVersion:f,newVersion:m,modifications:[p]},unsubscribe:()=>this.removeSubscriber(a)}}}transition(e){for(const n of e.modifications)switch(n.type){case"QueryUpdated":case"QueryFailed":{this.outstandingQueriesOlderThanRestart.delete(n.queryId);const r=n.journal;if(r!==void 0){const s=this.queryIdToToken.get(n.queryId);s!==void 0&&(this.querySet.get(s).journal=r)}break}case"QueryRemoved":{this.outstandingQueriesOlderThanRestart.delete(n.queryId);break}default:throw new Error(`Invalid modification ${n.type}`)}}queryId(e,n){const r=Oc(e),s=wc(r,n),i=this.querySet.get(s);return i!==void 0?i.id:null}isCurrentOrNewerAuthVersion(e){return e>=this.identityVersion}getAuth(){return this.auth}setAuth(e){this.auth={tokenType:"User",value:e};const n=this.identityVersion;return this.paused||(this.identityVersion=n+1),{type:"Authenticate",baseVersion:n,...this.auth}}setAdminAuth(e,n){const r={tokenType:"Admin",value:e,impersonating:n};this.auth=r;const s=this.identityVersion;return this.paused||(this.identityVersion=s+1),{type:"Authenticate",baseVersion:s,...r}}clearAuth(){this.auth=void 0,this.markAuthCompletion();const e=this.identityVersion;return this.paused||(this.identityVersion=e+1),{type:"Authenticate",tokenType:"None",baseVersion:e}}hasAuth(){return!!this.auth}isNewAuth(e){var n;return((n=this.auth)==null?void 0:n.value)!==e}queryPath(e){const n=this.queryIdToToken.get(e);return n?this.querySet.get(n).canonicalizedUdfPath:null}queryArgs(e){const n=this.queryIdToToken.get(e);return n?this.querySet.get(n).args:null}queryToken(e){return this.queryIdToToken.get(e)??null}queryJournal(e){var n;return(n=this.querySet.get(e))==null?void 0:n.journal}restart(e){this.unpause(),this.outstandingQueriesOlderThanRestart.clear();const n=[];for(const i of this.querySet.values()){const a={type:"Add",queryId:i.id,udfPath:i.canonicalizedUdfPath,args:[io(i.args)],journal:i.journal,componentPath:i.componentPath};n.push(a),e.has(i.id)||this.outstandingQueriesOlderThanRestart.add(i.id)}this.querySetVersion=1;const r={type:"ModifyQuerySet",baseVersion:0,newVersion:1,modifications:n};if(!this.auth)return this.identityVersion=0,[r,void 0];this.outstandingAuthOlderThanRestart=!0;const s={type:"Authenticate",baseVersion:0,...this.auth};return this.identityVersion=1,[r,s]}pause(){this.paused=!0}resume(){const e=this.pendingQuerySetModifications.size>0?{type:"ModifyQuerySet",baseVersion:this.querySetVersion,newVersion:++this.querySetVersion,modifications:Array.from(this.pendingQuerySetModifications.values())}:void 0,n=this.auth!==void 0?{type:"Authenticate",baseVersion:this.identityVersion++,...this.auth}:void 0;return this.unpause(),[e,n]}unpause(){this.paused=!1,this.pendingQuerySetModifications.clear()}removeSubscriber(e){const n=this.querySet.get(e);if(n.numSubscribers>1)return n.numSubscribers-=1,null;{this.querySet.delete(e),this.queryIdToToken.delete(n.id),this.outstandingQueriesOlderThanRestart.delete(n.id);const r=this.querySetVersion,s=this.querySetVersion+1,i={type:"Remove",queryId:n.id};return this.paused?this.pendingQuerySetModifications.has(n.id)?this.pendingQuerySetModifications.delete(n.id):this.pendingQuerySetModifications.set(n.id,i):this.querySetVersion=s,{type:"ModifyQuerySet",baseVersion:r,newVersion:s,modifications:[i]}}}}var YU=Object.defineProperty,XU=(t,e,n)=>e in t?YU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ty=(t,e,n)=>XU(t,typeof e!="symbol"?e+"":e,n);class JU{constructor(e,n){this.logger=e,this.markConnectionStateDirty=n,Ty(this,"inflightRequests"),Ty(this,"requestsOlderThanRestart"),Ty(this,"inflightMutationsCount",0),Ty(this,"inflightActionsCount",0),this.inflightRequests=new Map,this.requestsOlderThanRestart=new Set}request(e,n){const r=new Promise(s=>{const i=n?"Requested":"NotSent";this.inflightRequests.set(e.requestId,{message:e,status:{status:i,requestedAt:new Date,onResult:s}}),e.type==="Mutation"?this.inflightMutationsCount++:e.type==="Action"&&this.inflightActionsCount++});return this.markConnectionStateDirty(),r}onResponse(e){const n=this.inflightRequests.get(e.requestId);if(n===void 0||n.status.status==="Completed")return null;const r=n.message.type==="Mutation"?"mutation":"action",s=n.message.udfPath;for(const u of e.logLines)t0(this.logger,"info",r,s,u);const i=n.status;let a,l;if(e.success)a={success:!0,logLines:e.logLines,value:th(e.result)},l=()=>i.onResult(a);else{const u=e.result,{errorData:d}=e;t0(this.logger,"error",r,s,u),a={success:!1,errorMessage:u,errorData:d!==void 0?th(d):void 0,logLines:e.logLines},l=()=>i.onResult(a)}return e.type==="ActionResponse"||!e.success?(l(),this.inflightRequests.delete(e.requestId),this.requestsOlderThanRestart.delete(e.requestId),n.message.type==="Action"?this.inflightActionsCount--:n.message.type==="Mutation"&&this.inflightMutationsCount--,this.markConnectionStateDirty(),{requestId:e.requestId,result:a}):(n.status={status:"Completed",result:a,ts:e.ts,onResolve:l},null)}removeCompleted(e){const n=new Map;for(const[r,s]of this.inflightRequests.entries()){const i=s.status;i.status==="Completed"&&i.ts.lessThanOrEqual(e)&&(i.onResolve(),n.set(r,i.result),s.message.type==="Mutation"?this.inflightMutationsCount--:s.message.type==="Action"&&this.inflightActionsCount--,this.inflightRequests.delete(r),this.requestsOlderThanRestart.delete(r))}return n.size>0&&this.markConnectionStateDirty(),n}restart(){this.requestsOlderThanRestart=new Set(this.inflightRequests.keys());const e=[];for(const[n,r]of this.inflightRequests){if(r.status.status==="NotSent"){r.status.status="Requested",e.push(r.message);continue}if(r.message.type==="Mutation")e.push(r.message);else if(r.message.type==="Action"){if(this.inflightRequests.delete(n),this.requestsOlderThanRestart.delete(n),this.inflightActionsCount--,r.status.status==="Completed")throw new Error("Action should never be in 'Completed' state");r.status.onResult({success:!1,errorMessage:"Connection lost while action was in flight",logLines:[]})}}return this.markConnectionStateDirty(),e}resume(){const e=[];for(const[,n]of this.inflightRequests)if(n.status.status==="NotSent"){n.status.status="Requested",e.push(n.message);continue}return e}hasIncompleteRequests(){for(const e of this.inflightRequests.values())if(e.status.status==="Requested")return!0;return!1}hasInflightRequests(){return this.inflightRequests.size>0}hasSyncedPastLastReconnect(){return this.requestsOlderThanRestart.size===0}timeOfOldestInflightRequest(){if(this.inflightRequests.size===0)return null;let e=Date.now();for(const n of this.inflightRequests.values())n.status.status!=="Completed"&&n.status.requestedAt.getTime()<e&&(e=n.status.requestedAt.getTime());return new Date(e)}inflightMutations(){return this.inflightMutationsCount}inflightActions(){return this.inflightActionsCount}}const ap=Symbol.for("functionName"),e9=Symbol.for("toReferencePath");function t9(t){return t[e9]??null}function n9(t){return t.startsWith("function://")}function r9(t){let e;if(typeof t=="string")n9(t)?e={functionHandle:t}:e={name:t};else if(t[ap])e={name:t[ap]};else{const n=t9(t);if(!n)throw new Error(`${t} is not a functionReference`);e={reference:n}}return e}function ss(t){const e=r9(t);if(e.name===void 0)throw e.functionHandle!==void 0?new Error(`Expected function reference like "api.file.func" or "internal.file.func", but received function handle ${e.functionHandle}`):e.reference!==void 0?new Error(`Expected function reference in the current component like "api.file.func" or "internal.file.func", but received reference ${e.reference}`):new Error(`Expected function reference like "api.file.func" or "internal.file.func", but received ${JSON.stringify(e)}`);if(typeof t=="string")return t;const n=t[ap];if(!n)throw new Error(`${t} is not a functionReference`);return n}function mO(t){return{[ap]:t}}function pO(t=[]){const e={get(n,r){if(typeof r=="string"){const s=[...t,r];return pO(s)}else if(r===ap){if(t.length<2){const a=["api",...t].join(".");throw new Error(`API path is expected to be of the form \`api.moduleName.functionName\`. Found: \`${a}\``)}const s=t.slice(0,-1).join("/"),i=t[t.length-1];return i==="default"?s:s+":"+i}else return r===Symbol.toStringTag?"FunctionReference":void 0}};return new Proxy({},e)}pO();var s9=Object.defineProperty,i9=(t,e,n)=>e in t?s9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,n0=(t,e,n)=>i9(t,typeof e!="symbol"?e+"":e,n);class lp{constructor(e){n0(this,"queryResults"),n0(this,"modifiedQueries"),this.queryResults=e,this.modifiedQueries=[]}getQuery(e,...n){const r=Oo(n[0]),s=ss(e),i=this.queryResults.get(wc(s,r));if(i!==void 0)return lp.queryValue(i.result)}getAllQueries(e){const n=[],r=ss(e);for(const s of this.queryResults.values())s.udfPath===Oc(r)&&n.push({args:s.args,value:lp.queryValue(s.result)});return n}setQuery(e,n,r){const s=Oo(n),i=ss(e),a=wc(i,s);let l;r===void 0?l=void 0:l={success:!0,value:r,logLines:[]};const u={udfPath:i,args:s,result:l};this.queryResults.set(a,u),this.modifiedQueries.push(a)}static queryValue(e){if(e!==void 0)return e.success?e.value:void 0}}class o9{constructor(){n0(this,"queryResults"),n0(this,"optimisticUpdates"),this.queryResults=new Map,this.optimisticUpdates=[]}ingestQueryResultsFromServer(e,n){this.optimisticUpdates=this.optimisticUpdates.filter(a=>!n.has(a.mutationId));const r=this.queryResults;this.queryResults=new Map(e);const s=new lp(this.queryResults);for(const a of this.optimisticUpdates)a.update(s);const i=[];for(const[a,l]of this.queryResults){const u=r.get(a);(u===void 0||u.result!==l.result)&&i.push(a)}return i}applyOptimisticUpdate(e,n){this.optimisticUpdates.push({update:e,mutationId:n});const r=new lp(this.queryResults);return e(r),r.modifiedQueries}rawQueryResult(e){const n=this.queryResults.get(e);if(n!==void 0)return n.result}queryResult(e){const n=this.queryResults.get(e);if(n===void 0)return;const r=n.result;if(r!==void 0){if(r.success)return r.value;throw r.errorData!==void 0?yk(r,new gk(kd("query",n.udfPath,r))):new Error(kd("query",n.udfPath,r))}}hasQueryResult(e){return this.queryResults.get(e)!==void 0}queryLogs(e){var r;const n=this.queryResults.get(e);return(r=n==null?void 0:n.result)==null?void 0:r.logLines}}var a9=Object.defineProperty,l9=(t,e,n)=>e in t?a9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,x_=(t,e,n)=>l9(t,typeof e!="symbol"?e+"":e,n);class Jr{constructor(e,n){x_(this,"low"),x_(this,"high"),x_(this,"__isUnsignedLong__"),this.low=e|0,this.high=n|0,this.__isUnsignedLong__=!0}static isLong(e){return(e&&e.__isUnsignedLong__)===!0}static fromBytesLE(e){return new Jr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24)}toBytesLE(){const e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]}static fromNumber(e){return isNaN(e)||e<0?HC:e>=c9?u9:new Jr(e%Nm|0,e/Nm|0)}toString(){return(BigInt(this.high)*BigInt(Nm)+BigInt(this.low)).toString()}equals(e){return Jr.isLong(e)||(e=Jr.fromValue(e)),this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low}notEquals(e){return!this.equals(e)}comp(e){return Jr.isLong(e)||(e=Jr.fromValue(e)),this.equals(e)?0:e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1}lessThanOrEqual(e){return this.comp(e)<=0}static fromValue(e){return typeof e=="number"?Jr.fromNumber(e):new Jr(e.low,e.high)}}const HC=new Jr(0,0),GC=65536,Nm=GC*GC,c9=Nm*Nm,u9=new Jr(-1,-1);var d9=Object.defineProperty,h9=(t,e,n)=>e in t?d9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ey=(t,e,n)=>h9(t,typeof e!="symbol"?e+"":e,n);class KC{constructor(e,n){Ey(this,"version"),Ey(this,"remoteQuerySet"),Ey(this,"queryPath"),Ey(this,"logger"),this.version={querySet:0,ts:Jr.fromNumber(0),identity:0},this.remoteQuerySet=new Map,this.queryPath=e,this.logger=n}transition(e){const n=e.startVersion;if(this.version.querySet!==n.querySet||this.version.ts.notEquals(n.ts)||this.version.identity!==n.identity)throw new Error(`Invalid start version: ${n.ts.toString()}:${n.querySet}:${n.identity}, transitioning from ${this.version.ts.toString()}:${this.version.querySet}:${this.version.identity}`);for(const r of e.modifications)switch(r.type){case"QueryUpdated":{const s=this.queryPath(r.queryId);if(s)for(const a of r.logLines)t0(this.logger,"info","query",s,a);const i=th(r.value??null);this.remoteQuerySet.set(r.queryId,{success:!0,value:i,logLines:r.logLines});break}case"QueryFailed":{const s=this.queryPath(r.queryId);if(s)for(const a of r.logLines)t0(this.logger,"info","query",s,a);const{errorData:i}=r;this.remoteQuerySet.set(r.queryId,{success:!1,errorMessage:r.errorMessage,errorData:i!==void 0?th(i):void 0,logLines:r.logLines});break}case"QueryRemoved":{this.remoteQuerySet.delete(r.queryId);break}default:throw new Error(`Invalid modification ${r.type}`)}this.version=e.endVersion}remoteQueryResults(){return this.remoteQuerySet}timestamp(){return this.version.ts}}function v_(t){const e=ip(t);return Jr.fromBytesLE(Array.from(e))}function f9(t){const e=new Uint8Array(t.toBytesLE());return op(e)}function QC(t){switch(t.type){case"FatalError":case"AuthError":case"ActionResponse":case"TransitionChunk":case"Ping":return{...t};case"MutationResponse":return t.success?{...t,ts:v_(t.ts)}:{...t};case"Transition":return{...t,startVersion:{...t.startVersion,ts:v_(t.startVersion.ts)},endVersion:{...t.endVersion,ts:v_(t.endVersion.ts)}}}}function m9(t){switch(t.type){case"Authenticate":case"ModifyQuerySet":case"Mutation":case"Action":case"Event":return{...t};case"Connect":return t.maxObservedTimestamp!==void 0?{...t,maxObservedTimestamp:f9(t.maxObservedTimestamp)}:{...t,maxObservedTimestamp:void 0}}}var p9=Object.defineProperty,g9=(t,e,n)=>e in t?p9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mr=(t,e,n)=>g9(t,typeof e!="symbol"?e+"":e,n);const y9=1e3,x9=1001,v9=1005,b9=4040;let ox;function ax(){return ox===void 0&&(ox=Date.now()),typeof performance>"u"||!performance.now?Date.now():Math.round(ox+performance.now())}function ZC(){return`t=${Math.round((ax()-ox)/100)/10}s`}const gO={InternalServerError:{timeout:1e3},SubscriptionsWorkerFullError:{timeout:3e3},TooManyConcurrentRequests:{timeout:3e3},CommitterFullError:{timeout:3e3},AwsTooManyRequestsException:{timeout:3e3},ExecuteFullError:{timeout:3e3},SystemTimeoutError:{timeout:3e3},ExpiredInQueue:{timeout:3e3},VectorIndexesUnavailable:{timeout:1e3},SearchIndexesUnavailable:{timeout:1e3},TableSummariesUnavailable:{timeout:1e3},VectorIndexTooLarge:{timeout:3e3},SearchIndexTooLarge:{timeout:3e3},TooManyWritesInTimePeriod:{timeout:3e3}};function _9(t){if(t===void 0)return"Unknown";for(const e of Object.keys(gO))if(t.startsWith(e))return e;return"Unknown"}class w9{constructor(e,n,r,s,i,a){this.markConnectionStateDirty=i,this.debug=a,mr(this,"socket"),mr(this,"connectionCount"),mr(this,"_hasEverConnected",!1),mr(this,"lastCloseReason"),mr(this,"transitionChunkBuffer",null),mr(this,"defaultInitialBackoff"),mr(this,"maxBackoff"),mr(this,"retries"),mr(this,"serverInactivityThreshold"),mr(this,"reconnectDueToServerInactivityTimeout"),mr(this,"uri"),mr(this,"onOpen"),mr(this,"onResume"),mr(this,"onMessage"),mr(this,"webSocketConstructor"),mr(this,"logger"),mr(this,"onServerDisconnectError"),this.webSocketConstructor=r,this.socket={state:"disconnected"},this.connectionCount=0,this.lastCloseReason="InitialConnect",this.defaultInitialBackoff=1e3,this.maxBackoff=16e3,this.retries=0,this.serverInactivityThreshold=6e4,this.reconnectDueToServerInactivityTimeout=null,this.uri=e,this.onOpen=n.onOpen,this.onResume=n.onResume,this.onMessage=n.onMessage,this.onServerDisconnectError=n.onServerDisconnectError,this.logger=s,this.connect()}setSocketState(e){this.socket=e,this._logVerbose(`socket state changed: ${this.socket.state}, paused: ${"paused"in this.socket?this.socket.paused:void 0}`),this.markConnectionStateDirty()}assembleTransition(e){if(e.partNumber<0||e.partNumber>=e.totalParts||e.totalParts===0||this.transitionChunkBuffer&&(this.transitionChunkBuffer.totalParts!==e.totalParts||this.transitionChunkBuffer.transitionId!==e.transitionId))throw this.transitionChunkBuffer=null,new Error("Invalid TransitionChunk");if(this.transitionChunkBuffer===null&&(this.transitionChunkBuffer={chunks:[],totalParts:e.totalParts,transitionId:e.transitionId}),e.partNumber!==this.transitionChunkBuffer.chunks.length){const n=this.transitionChunkBuffer.chunks.length;throw this.transitionChunkBuffer=null,new Error(`TransitionChunk received out of order: expected part ${n}, got ${e.partNumber}`)}if(this.transitionChunkBuffer.chunks.push(e.chunk),this.transitionChunkBuffer.chunks.length===e.totalParts){const n=this.transitionChunkBuffer.chunks.join("");this.transitionChunkBuffer=null;const r=QC(JSON.parse(n));if(r.type!=="Transition")throw new Error(`Expected Transition, got ${r.type} after assembling chunks`);return r}return null}connect(){if(this.socket.state==="terminated")return;if(this.socket.state!=="disconnected"&&this.socket.state!=="stopped")throw new Error("Didn't start connection from disconnected state: "+this.socket.state);const e=new this.webSocketConstructor(this.uri);this._logVerbose("constructed WebSocket"),this.setSocketState({state:"connecting",ws:e,paused:"no"}),this.resetServerInactivityTimeout(),e.onopen=()=>{if(this.logger.logVerbose("begin ws.onopen"),this.socket.state!=="connecting")throw new Error("onopen called with socket not in connecting state");this.setSocketState({state:"ready",ws:e,paused:this.socket.paused==="yes"?"uninitialized":"no"}),this.resetServerInactivityTimeout(),this.socket.paused==="no"&&(this._hasEverConnected=!0,this.onOpen({connectionCount:this.connectionCount,lastCloseReason:this.lastCloseReason,clientTs:ax()})),this.lastCloseReason!=="InitialConnect"&&(this.lastCloseReason?this.logger.log("WebSocket reconnected at",ZC(),"after disconnect due to",this.lastCloseReason):this.logger.log("WebSocket reconnected at",ZC())),this.connectionCount+=1,this.lastCloseReason=null},e.onerror=n=>{this.transitionChunkBuffer=null;const r=n.message;r&&this.logger.log(`WebSocket error message: ${r}`)},e.onmessage=n=>{this.resetServerInactivityTimeout();const r=n.data.length;let s=QC(JSON.parse(n.data));if(this._logVerbose(`received ws message with type ${s.type}`),s.type==="Ping")return;if(s.type==="TransitionChunk"){const a=this.assembleTransition(s);if(!a)return;s=a,this._logVerbose(`assembled full ws message of type ${s.type}`)}this.transitionChunkBuffer!==null&&(this.transitionChunkBuffer=null,this.logger.log(`Received unexpected ${s.type} while buffering TransitionChunks`)),s.type==="Transition"&&this.reportLargeTransition({messageLength:r,transition:s}),this.onMessage(s).hasSyncedPastLastReconnect&&(this.retries=0,this.markConnectionStateDirty())},e.onclose=n=>{if(this._logVerbose("begin ws.onclose"),this.transitionChunkBuffer=null,this.lastCloseReason===null&&(this.lastCloseReason=n.reason||`closed with code ${n.code}`),n.code!==y9&&n.code!==x9&&n.code!==v9&&n.code!==b9){let s=`WebSocket closed with code ${n.code}`;n.reason&&(s+=`: ${n.reason}`),this.logger.log(s),this.onServerDisconnectError&&n.reason&&this.onServerDisconnectError(s)}const r=_9(n.reason);this.scheduleReconnect(r)}}socketState(){return this.socket.state}sendMessage(e){const n={type:e.type,...e.type==="Authenticate"&&e.tokenType==="User"?{value:`...${e.value.slice(-7)}`}:{}};if(this.socket.state==="ready"&&this.socket.paused==="no"){const r=m9(e),s=JSON.stringify(r);let i=!1;try{this.socket.ws.send(s),i=!0}catch(a){this.logger.log(`Failed to send message on WebSocket, reconnecting: ${a}`),this.closeAndReconnect("FailedToSendMessage")}return this._logVerbose(`${i?"sent":"failed to send"} message with type ${e.type}: ${JSON.stringify(n)}`),!0}return this._logVerbose(`message not sent (socket state: ${this.socket.state}, paused: ${"paused"in this.socket?this.socket.paused:void 0}): ${JSON.stringify(n)}`),!1}resetServerInactivityTimeout(){this.socket.state!=="terminated"&&(this.reconnectDueToServerInactivityTimeout!==null&&(clearTimeout(this.reconnectDueToServerInactivityTimeout),this.reconnectDueToServerInactivityTimeout=null),this.reconnectDueToServerInactivityTimeout=setTimeout(()=>{this.closeAndReconnect("InactiveServer")},this.serverInactivityThreshold))}scheduleReconnect(e){this.socket={state:"disconnected"};const n=this.nextBackoff(e);this.markConnectionStateDirty(),this.logger.log(`Attempting reconnect in ${Math.round(n)}ms`),setTimeout(()=>this.connect(),n)}closeAndReconnect(e){switch(this._logVerbose(`begin closeAndReconnect with reason ${e}`),this.socket.state){case"disconnected":case"terminated":case"stopped":return;case"connecting":case"ready":{this.lastCloseReason=e,this.close(),this.scheduleReconnect("client");return}default:this.socket}}close(){switch(this.transitionChunkBuffer=null,this.socket.state){case"disconnected":case"terminated":case"stopped":return Promise.resolve();case"connecting":{const e=this.socket.ws;return e.onmessage=n=>{this._logVerbose("Ignoring message received after close")},new Promise(n=>{e.onclose=()=>{this._logVerbose("Closed after connecting"),n()},e.onopen=()=>{this._logVerbose("Opened after connecting"),e.close()}})}case"ready":{this._logVerbose("ws.close called");const e=this.socket.ws;e.onmessage=r=>{this._logVerbose("Ignoring message received after close")};const n=new Promise(r=>{e.onclose=()=>{r()}});return e.close(),n}default:return this.socket,Promise.resolve()}}terminate(){switch(this.reconnectDueToServerInactivityTimeout&&clearTimeout(this.reconnectDueToServerInactivityTimeout),this.socket.state){case"terminated":case"stopped":case"disconnected":case"connecting":case"ready":{const e=this.close();return this.setSocketState({state:"terminated"}),e}default:throw this.socket,new Error(`Invalid websocket state: ${this.socket.state}`)}}stop(){switch(this.socket.state){case"terminated":return Promise.resolve();case"connecting":case"stopped":case"disconnected":case"ready":{const e=this.close();return this.socket={state:"stopped"},e}default:return this.socket,Promise.resolve()}}tryRestart(){switch(this.socket.state){case"stopped":break;case"terminated":case"connecting":case"ready":case"disconnected":this.logger.logVerbose("Restart called without stopping first");return;default:this.socket}this.connect()}pause(){switch(this.socket.state){case"disconnected":case"stopped":case"terminated":return;case"connecting":case"ready":{this.socket={...this.socket,paused:"yes"};return}default:{this.socket;return}}}resume(){switch(this.socket.state){case"connecting":this.socket={...this.socket,paused:"no"};return;case"ready":this.socket.paused==="uninitialized"?(this.socket={...this.socket,paused:"no"},this.onOpen({connectionCount:this.connectionCount,lastCloseReason:this.lastCloseReason,clientTs:ax()})):this.socket.paused==="yes"&&(this.socket={...this.socket,paused:"no"},this.onResume());return;case"terminated":case"stopped":case"disconnected":return;default:this.socket}this.connect()}connectionState(){return{isConnected:this.socket.state==="ready",hasEverConnected:this._hasEverConnected,connectionCount:this.connectionCount,connectionRetries:this.retries}}_logVerbose(e){this.logger.logVerbose(e)}nextBackoff(e){const r=(e==="client"?100:e==="Unknown"?this.defaultInitialBackoff:gO[e].timeout)*Math.pow(2,this.retries);this.retries+=1;const s=Math.min(r,this.maxBackoff),i=s*(Math.random()-.5);return s+i}reportLargeTransition({transition:e,messageLength:n}){if(e.clientClockSkew===void 0||e.serverTs===void 0)return;const r=ax()-e.clientClockSkew-e.serverTs/1e6,s=`${Math.round(r)}ms`,i=`${Math.round(n/1e4)/100}MB`,a=n/(r/1e3),l=`${Math.round(a/1e4)/100}MB per second`;this._logVerbose(`received ${i} transition in ${s} at ${l}`),n>2e7?this.logger.log(`received query results totaling more that 20MB (${i}) which will take a long time to download on slower connections`):r>2e4&&this.logger.log(`received query results totaling ${i} which took more than 20s to arrive (${s})`),this.debug&&this.sendMessage({type:"Event",eventType:"ClientReceivedTransition",event:{transitionTransitTime:r,messageLength:n}})}}function k9(){return N9()}function N9(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}class tm extends Error{}tm.prototype.name="InvalidTokenError";function S9(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,n)=>{let r=n.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function T9(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return S9(e)}catch{return atob(e)}}function yO(t,e){if(typeof t!="string")throw new tm("Invalid token specified: must be a string");e||(e={});const n=e.header===!0?0:1,r=t.split(".")[n];if(typeof r!="string")throw new tm(`Invalid token specified: missing part #${n+1}`);let s;try{s=T9(r)}catch(i){throw new tm(`Invalid token specified: invalid base64 for part #${n+1} (${i.message})`)}try{return JSON.parse(s)}catch(i){throw new tm(`Invalid token specified: invalid json for part #${n+1} (${i.message})`)}}var E9=Object.defineProperty,C9=(t,e,n)=>e in t?E9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gs=(t,e,n)=>C9(t,typeof e!="symbol"?e+"":e,n);const j9=20*24*60*60*1e3,YC=2;class I9{constructor(e,n,r){Gs(this,"authState",{state:"noAuth"}),Gs(this,"configVersion",0),Gs(this,"syncState"),Gs(this,"authenticate"),Gs(this,"stopSocket"),Gs(this,"tryRestartSocket"),Gs(this,"pauseSocket"),Gs(this,"resumeSocket"),Gs(this,"clearAuth"),Gs(this,"logger"),Gs(this,"refreshTokenLeewaySeconds"),Gs(this,"tokenConfirmationAttempts",0),this.syncState=e,this.authenticate=n.authenticate,this.stopSocket=n.stopSocket,this.tryRestartSocket=n.tryRestartSocket,this.pauseSocket=n.pauseSocket,this.resumeSocket=n.resumeSocket,this.clearAuth=n.clearAuth,this.logger=r.logger,this.refreshTokenLeewaySeconds=r.refreshTokenLeewaySeconds}async setConfig(e,n){this.resetAuthState(),this._logVerbose("pausing WS for auth token fetch"),this.pauseSocket();const r=await this.fetchTokenAndGuardAgainstRace(e,{forceRefreshToken:!1});r.isFromOutdatedConfig||(r.value?(this.setAuthState({state:"waitingForServerConfirmationOfCachedToken",config:{fetchToken:e,onAuthChange:n},hasRetried:!1}),this.authenticate(r.value)):(this.setAuthState({state:"initialRefetch",config:{fetchToken:e,onAuthChange:n}}),await this.refetchToken()),this._logVerbose("resuming WS after auth token fetch"),this.resumeSocket())}onTransition(e){if(this.syncState.isCurrentOrNewerAuthVersion(e.endVersion.identity)&&!(e.endVersion.identity<=e.startVersion.identity)){if(this.authState.state==="waitingForServerConfirmationOfCachedToken"){this._logVerbose("server confirmed auth token is valid"),this.refetchToken(),this.authState.config.onAuthChange(!0);return}this.authState.state==="waitingForServerConfirmationOfFreshToken"&&(this._logVerbose("server confirmed new auth token is valid"),this.scheduleTokenRefetch(this.authState.token),this.tokenConfirmationAttempts=0,this.authState.hadAuth||this.authState.config.onAuthChange(!0))}}onAuthError(e){if(e.authUpdateAttempted===!1&&(this.authState.state==="waitingForServerConfirmationOfFreshToken"||this.authState.state==="waitingForServerConfirmationOfCachedToken")){this._logVerbose("ignoring non-auth token expired error");return}const{baseVersion:n}=e;if(!this.syncState.isCurrentOrNewerAuthVersion(n+1)){this._logVerbose("ignoring auth error for previous auth attempt");return}this.tryToReauthenticate(e)}async tryToReauthenticate(e){if(this._logVerbose(`attempting to reauthenticate: ${e.error}`),this.authState.state==="noAuth"||this.authState.state==="waitingForServerConfirmationOfFreshToken"&&this.tokenConfirmationAttempts>=YC){this.logger.error(`Failed to authenticate: "${e.error}", check your server auth config`),this.syncState.hasAuth()&&this.syncState.clearAuth(),this.authState.state!=="noAuth"&&this.setAndReportAuthFailed(this.authState.config.onAuthChange);return}this.authState.state==="waitingForServerConfirmationOfFreshToken"&&(this.tokenConfirmationAttempts++,this._logVerbose(`retrying reauthentication, ${YC-this.tokenConfirmationAttempts} attempts remaining`)),await this.stopSocket();const n=await this.fetchTokenAndGuardAgainstRace(this.authState.config.fetchToken,{forceRefreshToken:!0});n.isFromOutdatedConfig||(n.value&&this.syncState.isNewAuth(n.value)?(this.authenticate(n.value),this.setAuthState({state:"waitingForServerConfirmationOfFreshToken",config:this.authState.config,token:n.value,hadAuth:this.authState.state==="notRefetching"||this.authState.state==="waitingForScheduledRefetch"})):(this._logVerbose("reauthentication failed, could not fetch a new token"),this.syncState.hasAuth()&&this.syncState.clearAuth(),this.setAndReportAuthFailed(this.authState.config.onAuthChange)),this.tryRestartSocket())}async refetchToken(){if(this.authState.state==="noAuth")return;this._logVerbose("refetching auth token");const e=await this.fetchTokenAndGuardAgainstRace(this.authState.config.fetchToken,{forceRefreshToken:!0});e.isFromOutdatedConfig||(e.value?this.syncState.isNewAuth(e.value)?(this.setAuthState({state:"waitingForServerConfirmationOfFreshToken",hadAuth:this.syncState.hasAuth(),token:e.value,config:this.authState.config}),this.authenticate(e.value)):this.setAuthState({state:"notRefetching",config:this.authState.config}):(this._logVerbose("refetching token failed"),this.syncState.hasAuth()&&this.clearAuth(),this.setAndReportAuthFailed(this.authState.config.onAuthChange)),this._logVerbose("restarting WS after auth token fetch (if currently stopped)"),this.tryRestartSocket())}scheduleTokenRefetch(e){if(this.authState.state==="noAuth")return;const n=this.decodeToken(e);if(!n){this.logger.error("Auth token is not a valid JWT, cannot refetch the token");return}const{iat:r,exp:s}=n;if(!r||!s){this.logger.error("Auth token does not have required fields, cannot refetch the token");return}const i=s-r;if(i<=2){this.logger.error("Auth token does not live long enough, cannot refetch the token");return}let a=Math.min(j9,(i-this.refreshTokenLeewaySeconds)*1e3);a<=0&&(this.logger.warn(`Refetching auth token immediately, configured leeway ${this.refreshTokenLeewaySeconds}s is larger than the token's lifetime ${i}s`),a=0);const l=setTimeout(()=>{this._logVerbose("running scheduled token refetch"),this.refetchToken()},a);this.setAuthState({state:"waitingForScheduledRefetch",refetchTokenTimeoutId:l,config:this.authState.config}),this._logVerbose(`scheduled preemptive auth token refetching in ${a}ms`)}async fetchTokenAndGuardAgainstRace(e,n){const r=++this.configVersion;this._logVerbose(`fetching token with config version ${r}`);const s=await e(n);return this.configVersion!==r?(this._logVerbose(`stale config version, expected ${r}, got ${this.configVersion}`),{isFromOutdatedConfig:!0}):{isFromOutdatedConfig:!1,value:s}}stop(){this.resetAuthState(),this.configVersion++,this._logVerbose(`config version bumped to ${this.configVersion}`)}setAndReportAuthFailed(e){e(!1),this.resetAuthState()}resetAuthState(){this.setAuthState({state:"noAuth"})}setAuthState(e){const n=e.state==="waitingForServerConfirmationOfFreshToken"?{hadAuth:e.hadAuth,state:e.state,token:`...${e.token.slice(-7)}`}:{state:e.state};switch(this._logVerbose(`setting auth state to ${JSON.stringify(n)}`),e.state){case"waitingForScheduledRefetch":case"notRefetching":case"noAuth":this.tokenConfirmationAttempts=0;break}this.authState.state==="waitingForScheduledRefetch"&&(clearTimeout(this.authState.refetchTokenTimeoutId),this.syncState.markAuthCompletion()),this.authState=e}decodeToken(e){try{return yO(e)}catch(n){return this._logVerbose(`Error decoding token: ${n instanceof Error?n.message:"Unknown error"}`),null}}_logVerbose(e){this.logger.logVerbose(`${e} [v${this.configVersion}]`)}}const A9=["convexClientConstructed","convexWebSocketOpen","convexFirstMessageReceived"];function R9(t,e){const n={sessionId:e};typeof performance>"u"||!performance.mark||performance.mark(t,{detail:n})}function P9(t){let e=t.name.slice(6);return e=e.charAt(0).toLowerCase()+e.slice(1),{name:e,startTime:t.startTime}}function L9(t){if(typeof performance>"u"||!performance.getEntriesByName)return[];const e=[];for(const n of A9){const r=performance.getEntriesByName(n).filter(s=>s.entryType==="mark").filter(s=>s.detail.sessionId===t);e.push(...r)}return e.map(P9)}var M9=Object.defineProperty,O9=(t,e,n)=>e in t?M9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zn=(t,e,n)=>O9(t,typeof e!="symbol"?e+"":e,n);class D9{constructor(e,n,r){if(zn(this,"address"),zn(this,"state"),zn(this,"requestManager"),zn(this,"webSocketManager"),zn(this,"authenticationManager"),zn(this,"remoteQuerySet"),zn(this,"optimisticQueryResults"),zn(this,"_transitionHandlerCounter",0),zn(this,"_nextRequestId"),zn(this,"_onTransitionFns",new Map),zn(this,"_sessionId"),zn(this,"firstMessageReceived",!1),zn(this,"debug"),zn(this,"logger"),zn(this,"maxObservedTimestamp"),zn(this,"connectionStateSubscribers",new Map),zn(this,"nextConnectionStateSubscriberId",0),zn(this,"_lastPublishedConnectionState"),zn(this,"markConnectionStateDirty",()=>{Promise.resolve().then(()=>{const v=this.connectionState();if(JSON.stringify(v)!==JSON.stringify(this._lastPublishedConnectionState)){this._lastPublishedConnectionState=v;for(const x of this.connectionStateSubscribers.values())x(v)}})}),zn(this,"mark",v=>{this.debug&&R9(v,this.sessionId)}),typeof e=="object")throw new Error("Passing a ClientConfig object is no longer supported. Pass the URL of the Convex deployment as a string directly.");(r==null?void 0:r.skipConvexDeploymentUrlCheck)!==!0&&RU(e),r={...r};const s=r.authRefreshTokenLeewaySeconds??2;let i=r.webSocketConstructor;if(!i&&typeof WebSocket>"u")throw new Error("No WebSocket global variable defined! To use Convex in an environment without WebSocket try the HTTP client: https://docs.convex.dev/api/classes/browser.ConvexHttpClient");i=i||WebSocket,this.debug=r.reportDebugInfoToConvex??!1,this.address=e,this.logger=r.logger===!1?fO({verbose:r.verbose??!1}):r.logger!==!0&&r.logger?r.logger:hO({verbose:r.verbose??!1});const a=e.search("://");if(a===-1)throw new Error("Provided address was not an absolute URL.");const l=e.substring(a+3),u=e.substring(0,a);let d;if(u==="http")d="ws";else if(u==="https")d="wss";else throw new Error(`Unknown parent protocol ${u}`);const f=`${d}://${l}/api/${UC}/sync`;this.state=new ZU,this.remoteQuerySet=new KC(v=>this.state.queryPath(v),this.logger),this.requestManager=new JU(this.logger,this.markConnectionStateDirty);const m=()=>{this.webSocketManager.pause(),this.state.pause()};this.authenticationManager=new I9(this.state,{authenticate:v=>{const x=this.state.setAuth(v);return this.webSocketManager.sendMessage(x),x.baseVersion},stopSocket:()=>this.webSocketManager.stop(),tryRestartSocket:()=>this.webSocketManager.tryRestart(),pauseSocket:m,resumeSocket:()=>this.webSocketManager.resume(),clearAuth:()=>{this.clearAuth()}},{logger:this.logger,refreshTokenLeewaySeconds:s}),this.optimisticQueryResults=new o9,this.addOnTransitionHandler(v=>{n(v.queries.map(x=>x.token))}),this._nextRequestId=0,this._sessionId=k9();const{unsavedChangesWarning:p}=r;if(typeof window>"u"||typeof window.addEventListener>"u"){if(p===!0)throw new Error("unsavedChangesWarning requested, but window.addEventListener not found! Remove {unsavedChangesWarning: true} from Convex client options.")}else p!==!1&&window.addEventListener("beforeunload",v=>{if(this.requestManager.hasIncompleteRequests()){v.preventDefault();const x="Are you sure you want to leave? Your changes may not be saved.";return(v||window.event).returnValue=x,x}});this.webSocketManager=new w9(f,{onOpen:v=>{this.mark("convexWebSocketOpen"),this.webSocketManager.sendMessage({...v,type:"Connect",sessionId:this._sessionId,maxObservedTimestamp:this.maxObservedTimestamp});const x=new Set(this.remoteQuerySet.remoteQueryResults().keys());this.remoteQuerySet=new KC(k=>this.state.queryPath(k),this.logger);const[_,E]=this.state.restart(x);E&&this.webSocketManager.sendMessage(E),this.webSocketManager.sendMessage(_);for(const k of this.requestManager.restart())this.webSocketManager.sendMessage(k)},onResume:()=>{const[v,x]=this.state.resume();x&&this.webSocketManager.sendMessage(x),v&&this.webSocketManager.sendMessage(v);for(const _ of this.requestManager.resume())this.webSocketManager.sendMessage(_)},onMessage:v=>{switch(this.firstMessageReceived||(this.firstMessageReceived=!0,this.mark("convexFirstMessageReceived"),this.reportMarks()),v.type){case"Transition":{this.observedTimestamp(v.endVersion.ts),this.authenticationManager.onTransition(v),this.remoteQuerySet.transition(v),this.state.transition(v);const x=this.requestManager.removeCompleted(this.remoteQuerySet.timestamp());this.notifyOnQueryResultChanges(x);break}case"MutationResponse":{v.success&&this.observedTimestamp(v.ts);const x=this.requestManager.onResponse(v);x!==null&&this.notifyOnQueryResultChanges(new Map([[x.requestId,x.result]]));break}case"ActionResponse":{this.requestManager.onResponse(v);break}case"AuthError":{this.authenticationManager.onAuthError(v);break}case"FatalError":{const x=GU(this.logger,v.error);throw this.webSocketManager.terminate(),x}}return{hasSyncedPastLastReconnect:this.hasSyncedPastLastReconnect()}},onServerDisconnectError:r.onServerDisconnectError},i,this.logger,this.markConnectionStateDirty,this.debug),this.mark("convexClientConstructed"),r.expectAuth&&m()}hasSyncedPastLastReconnect(){return this.requestManager.hasSyncedPastLastReconnect()||this.state.hasSyncedPastLastReconnect()}observedTimestamp(e){(this.maxObservedTimestamp===void 0||this.maxObservedTimestamp.lessThanOrEqual(e))&&(this.maxObservedTimestamp=e)}getMaxObservedTimestamp(){return this.maxObservedTimestamp}notifyOnQueryResultChanges(e){const n=this.remoteQuerySet.remoteQueryResults(),r=new Map;for(const[i,a]of n){const l=this.state.queryToken(i);if(l!==null){const u={result:a,udfPath:this.state.queryPath(i),args:this.state.queryArgs(i)};r.set(l,u)}}const s=this.optimisticQueryResults.ingestQueryResultsFromServer(r,new Set(e.keys()));this.handleTransition({queries:s.map(i=>{const a=this.optimisticQueryResults.rawQueryResult(i);return{token:i,modification:{kind:"Updated",result:a}}}),reflectedMutations:Array.from(e).map(([i,a])=>({requestId:i,result:a})),timestamp:this.remoteQuerySet.timestamp()})}handleTransition(e){for(const n of this._onTransitionFns.values())n(e)}addOnTransitionHandler(e){const n=this._transitionHandlerCounter++;return this._onTransitionFns.set(n,e),()=>this._onTransitionFns.delete(n)}getCurrentAuthClaims(){const e=this.state.getAuth();let n={};if(e&&e.tokenType==="User")try{n=e?yO(e.value):{}}catch{n={}}else return;return{token:e.value,decoded:n}}setAuth(e,n){this.authenticationManager.setConfig(e,n)}hasAuth(){return this.state.hasAuth()}setAdminAuth(e,n){const r=this.state.setAdminAuth(e,n);this.webSocketManager.sendMessage(r)}clearAuth(){const e=this.state.clearAuth();this.webSocketManager.sendMessage(e)}subscribe(e,n,r){const s=Oo(n),{modification:i,queryToken:a,unsubscribe:l}=this.state.subscribe(e,s,r==null?void 0:r.journal,r==null?void 0:r.componentPath);return i!==null&&this.webSocketManager.sendMessage(i),{queryToken:a,unsubscribe:()=>{const u=l();u&&this.webSocketManager.sendMessage(u)}}}localQueryResult(e,n){const r=Oo(n),s=wc(e,r);return this.optimisticQueryResults.queryResult(s)}localQueryResultByToken(e){return this.optimisticQueryResults.queryResult(e)}hasLocalQueryResultByToken(e){return this.optimisticQueryResults.hasQueryResult(e)}localQueryLogs(e,n){const r=Oo(n),s=wc(e,r);return this.optimisticQueryResults.queryLogs(s)}queryJournal(e,n){const r=Oo(n),s=wc(e,r);return this.state.queryJournal(s)}connectionState(){const e=this.webSocketManager.connectionState();return{hasInflightRequests:this.requestManager.hasInflightRequests(),isWebSocketConnected:e.isConnected,hasEverConnected:e.hasEverConnected,connectionCount:e.connectionCount,connectionRetries:e.connectionRetries,timeOfOldestInflightRequest:this.requestManager.timeOfOldestInflightRequest(),inflightMutations:this.requestManager.inflightMutations(),inflightActions:this.requestManager.inflightActions()}}subscribeToConnectionState(e){const n=this.nextConnectionStateSubscriberId++;return this.connectionStateSubscribers.set(n,e),()=>{this.connectionStateSubscribers.delete(n)}}async mutation(e,n,r){const s=await this.mutationInternal(e,n,r);if(!s.success)throw s.errorData!==void 0?yk(s,new gk(kd("mutation",e,s))):new Error(kd("mutation",e,s));return s.value}async mutationInternal(e,n,r,s){const{mutationPromise:i}=this.enqueueMutation(e,n,r,s);return i}enqueueMutation(e,n,r,s){const i=Oo(n);this.tryReportLongDisconnect();const a=this.nextRequestId;if(this._nextRequestId++,r!==void 0){const f=r.optimisticUpdate;if(f!==void 0){const m=x=>{f(x,i)instanceof Promise&&this.logger.warn("Optimistic update handler returned a Promise. Optimistic updates should be synchronous.")},v=this.optimisticQueryResults.applyOptimisticUpdate(m,a).map(x=>{const _=this.localQueryResultByToken(x);return{token:x,modification:{kind:"Updated",result:_===void 0?void 0:{success:!0,value:_,logLines:[]}}}});this.handleTransition({queries:v,reflectedMutations:[],timestamp:this.remoteQuerySet.timestamp()})}}const l={type:"Mutation",requestId:a,udfPath:e,componentPath:s,args:[io(i)]},u=this.webSocketManager.sendMessage(l),d=this.requestManager.request(l,u);return{requestId:a,mutationPromise:d}}async action(e,n){const r=await this.actionInternal(e,n);if(!r.success)throw r.errorData!==void 0?yk(r,new gk(kd("action",e,r))):new Error(kd("action",e,r));return r.value}async actionInternal(e,n,r){const s=Oo(n),i=this.nextRequestId;this._nextRequestId++,this.tryReportLongDisconnect();const a={type:"Action",requestId:i,udfPath:e,componentPath:r,args:[io(s)]},l=this.webSocketManager.sendMessage(a);return this.requestManager.request(a,l)}async close(){return this.authenticationManager.stop(),this.webSocketManager.terminate()}get url(){return this.address}get nextRequestId(){return this._nextRequestId}get sessionId(){return this._sessionId}reportMarks(){if(this.debug){const e=L9(this.sessionId);this.webSocketManager.sendMessage({type:"Event",eventType:"ClientConnect",event:e})}}tryReportLongDisconnect(){if(!this.debug)return;const e=this.connectionState().timeOfOldestInflightRequest;if(e===null||Date.now()-e.getTime()<=60*1e3)return;const n=`${this.address}/api/debug_event`;fetch(n,{method:"POST",headers:{"Content-Type":"application/json","Convex-Client":`npm-${UC}`},body:JSON.stringify({event:"LongWebsocketDisconnect"})}).then(r=>{r.ok||this.logger.warn("Analytics request failed with response:",r.body)}).catch(r=>{this.logger.warn("Analytics response failed with error:",r)})}}function b_(t){if(typeof t!="object"||t===null||!Array.isArray(t.page)||typeof t.isDone!="boolean"||typeof t.continueCursor!="string")throw new Error(`Not a valid paginated query result: ${t==null?void 0:t.toString()}`);return t}var V9=Object.defineProperty,F9=(t,e,n)=>e in t?V9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,XC=(t,e,n)=>F9(t,typeof e!="symbol"?e+"":e,n);class z9{constructor(e,n){this.client=e,this.onTransition=n,XC(this,"paginatedQuerySet",new Map),XC(this,"lastTransitionTs"),this.lastTransitionTs=Jr.fromNumber(0),this.client.addOnTransitionHandler(r=>this.onBaseTransition(r))}subscribe(e,n,r){const s=Oc(e),i=WC(s,n,r),a=()=>this.removePaginatedQuerySubscriber(i),l=this.paginatedQuerySet.get(i);return l?(l.numSubscribers+=1,{paginatedQueryToken:i,unsubscribe:a}):(this.paginatedQuerySet.set(i,{token:i,canonicalizedUdfPath:s,args:n,numSubscribers:1,options:{initialNumItems:r.initialNumItems},nextPageKey:0,pageKeys:[],pageKeyToQuery:new Map,ongoingSplits:new Map,skip:!1,id:r.id}),this.addPageToPaginatedQuery(i,null,r.initialNumItems),{paginatedQueryToken:i,unsubscribe:a})}localQueryResult(e,n,r){const s=Oc(e),i=WC(s,n,r);return this.localQueryResultByToken(i)}localQueryResultByToken(e){const n=this.paginatedQuerySet.get(e);if(!n)return;const r=this.activePageQueryTokens(n);if(r.length===0)return{results:[],status:"LoadingFirstPage",loadMore:u=>this.loadMoreOfPaginatedQuery(e,u)};let s=[],i=!1,a=!1;for(const u of r){const d=this.client.localQueryResultByToken(u);if(d===void 0){i=!0,a=!1;continue}const f=b_(d);s=s.concat(f.page),a=!!f.isDone}let l;return i?l=s.length===0?"LoadingFirstPage":"LoadingMore":a?l="Exhausted":l="CanLoadMore",{results:s,status:l,loadMore:u=>this.loadMoreOfPaginatedQuery(e,u)}}onBaseTransition(e){const n=e.queries.map(a=>a.token),r=this.queriesContainingTokens(n);let s=[];r.length>0&&(this.processPaginatedQuerySplits(r,a=>this.client.localQueryResultByToken(a)),s=r.map(a=>({token:a,modification:{kind:"Updated",result:this.localQueryResultByToken(a)}})));const i={...e,paginatedQueries:s};this.onTransition(i)}loadMoreOfPaginatedQuery(e,n){this.mustGetPaginatedQuery(e);const r=this.queryTokenForLastPageOfPaginatedQuery(e),s=this.client.localQueryResultByToken(r);if(!s)return!1;const i=b_(s);if(i.isDone)return!1;this.addPageToPaginatedQuery(e,i.continueCursor,n);const a={timestamp:this.lastTransitionTs,reflectedMutations:[],queries:[],paginatedQueries:[{token:e,modification:{kind:"Updated",result:this.localQueryResultByToken(e)}}]};return this.onTransition(a),!0}queriesContainingTokens(e){if(e.length===0)return[];const n=[],r=new Set(e);for(const[s,i]of this.paginatedQuerySet)for(const a of this.allQueryTokens(i))if(r.has(a)){n.push(s);break}return n}processPaginatedQuerySplits(e,n){for(const r of e){const s=this.mustGetPaginatedQuery(r),{ongoingSplits:i,pageKeyToQuery:a,pageKeys:l}=s;for(const[u,[d,f]]of i)n(a.get(d).queryToken)!==void 0&&n(a.get(f).queryToken)!==void 0&&this.completePaginatedQuerySplit(s,u,d,f);for(const u of l){if(i.has(u))continue;const d=a.get(u).queryToken,f=n(d);if(!f)continue;const m=b_(f);m.splitCursor&&(m.pageStatus==="SplitRecommended"||m.pageStatus==="SplitRequired"||m.page.length>s.options.initialNumItems*2)&&this.splitPaginatedQueryPage(s,u,m.splitCursor,m.continueCursor)}}}splitPaginatedQueryPage(e,n,r,s){const i=e.nextPageKey++,a=e.nextPageKey++,l={cursor:s,numItems:e.options.initialNumItems,id:e.id},u=this.client.subscribe(e.canonicalizedUdfPath,{...e.args,paginationOpts:{...l,cursor:null,endCursor:r}});e.pageKeyToQuery.set(i,u);const d=this.client.subscribe(e.canonicalizedUdfPath,{...e.args,paginationOpts:{...l,cursor:r,endCursor:s}});e.pageKeyToQuery.set(a,d),e.ongoingSplits.set(n,[i,a])}addPageToPaginatedQuery(e,n,r){const s=this.mustGetPaginatedQuery(e),i=s.nextPageKey++,a={cursor:n,numItems:r,id:s.id},l={...s.args,paginationOpts:a},u=this.client.subscribe(s.canonicalizedUdfPath,l);return s.pageKeys.push(i),s.pageKeyToQuery.set(i,u),u}removePaginatedQuerySubscriber(e){const n=this.paginatedQuerySet.get(e);if(n&&(n.numSubscribers-=1,!(n.numSubscribers>0))){for(const r of n.pageKeyToQuery.values())r.unsubscribe();this.paginatedQuerySet.delete(e)}}completePaginatedQuerySplit(e,n,r,s){const i=e.pageKeyToQuery.get(n);e.pageKeyToQuery.delete(n);const a=e.pageKeys.indexOf(n);e.pageKeys.splice(a,1,r,s),e.ongoingSplits.delete(n),i.unsubscribe()}activePageQueryTokens(e){return e.pageKeys.map(n=>e.pageKeyToQuery.get(n).queryToken)}allQueryTokens(e){return Array.from(e.pageKeyToQuery.values()).map(n=>n.queryToken)}queryTokenForLastPageOfPaginatedQuery(e){const n=this.mustGetPaginatedQuery(e),r=n.pageKeys[n.pageKeys.length-1];if(r===void 0)throw new Error(`No pages for paginated query ${e}`);return n.pageKeyToQuery.get(r).queryToken}mustGetPaginatedQuery(e){const n=this.paginatedQuerySet.get(e);if(!n)throw new Error("paginated query no longer exists for token "+e);return n}}function B9({getCurrentValue:t,subscribe:e}){const[n,r]=N.useState(()=>({getCurrentValue:t,subscribe:e,value:t()}));let s=n.value;return(n.getCurrentValue!==t||n.subscribe!==e)&&(s=t(),r({getCurrentValue:t,subscribe:e,value:s})),N.useEffect(()=>{let i=!1;const a=()=>{i||r(u=>{if(u.getCurrentValue!==t||u.subscribe!==e)return u;const d=t();return u.value===d?u:{...u,value:d}})},l=e(a);return a(),()=>{i=!0,l()}},[t,e]),s}var $9=Object.defineProperty,U9=(t,e,n)=>e in t?$9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jo=(t,e,n)=>U9(t,typeof e!="symbol"?e+"":e,n);const q9=5e3;if(typeof Ve>"u")throw new Error("Required dependency 'react' not found");function xO(t,e,n){function r(s){return K9(s),e.mutation(t,s,{optimisticUpdate:n})}return r.withOptimisticUpdate=function(i){if(n!==void 0)throw new Error(`Already specified optimistic update for mutation ${ss(t)}`);return xO(t,e,i)},r}class W9{constructor(e,n){if(jo(this,"address"),jo(this,"cachedSync"),jo(this,"cachedPaginatedQueryClient"),jo(this,"listeners"),jo(this,"options"),jo(this,"closed",!1),jo(this,"_logger"),jo(this,"adminAuth"),jo(this,"fakeUserIdentity"),e===void 0)throw new Error("No address provided to ConvexReactClient.\nIf trying to deploy to production, make sure to follow all the instructions found at https://docs.convex.dev/production/hosting/\nIf running locally, make sure to run `convex dev` and ensure the .env.local file is populated.");if(typeof e!="string")throw new Error(`ConvexReactClient requires a URL like 'https://happy-otter-123.convex.cloud', received something of type ${typeof e} instead.`);if(!e.includes("://"))throw new Error("Provided address was not an absolute URL.");this.address=e,this.listeners=new Map,this._logger=(n==null?void 0:n.logger)===!1?fO({verbose:(n==null?void 0:n.verbose)??!1}):(n==null?void 0:n.logger)!==!0&&(n!=null&&n.logger)?n.logger:hO({verbose:(n==null?void 0:n.verbose)??!1}),this.options={...n,logger:this._logger}}get url(){return this.address}get sync(){if(this.closed)throw new Error("ConvexReactClient has already been closed.");return this.cachedSync?this.cachedSync:(this.cachedSync=new D9(this.address,()=>{},this.options),this.adminAuth&&this.cachedSync.setAdminAuth(this.adminAuth,this.fakeUserIdentity),this.cachedPaginatedQueryClient=new z9(this.cachedSync,e=>this.handleTransition(e)),this.cachedSync)}get paginatedQueryClient(){if(this.sync,this.cachedPaginatedQueryClient)return this.cachedPaginatedQueryClient;throw new Error("Should already be instantiated")}setAuth(e,n){if(typeof e=="string")throw new Error("Passing a string to ConvexReactClient.setAuth is no longer supported, please upgrade to passing in an async function to handle reauthentication.");this.sync.setAuth(e,n??(()=>{}))}clearAuth(){this.sync.clearAuth()}setAdminAuth(e,n){if(this.adminAuth=e,this.fakeUserIdentity=n,this.closed)throw new Error("ConvexReactClient has already been closed.");this.cachedSync&&this.sync.setAdminAuth(e,n)}watchQuery(e,...n){const[r,s]=n,i=ss(e);return{onUpdate:a=>{const{queryToken:l,unsubscribe:u}=this.sync.subscribe(i,r,s),d=this.listeners.get(l);return d!==void 0?d.add(a):this.listeners.set(l,new Set([a])),()=>{if(this.closed)return;const f=this.listeners.get(l);f.delete(a),f.size===0&&this.listeners.delete(l),u()}},localQueryResult:()=>{if(this.cachedSync)return this.cachedSync.localQueryResult(i,r)},localQueryLogs:()=>{if(this.cachedSync)return this.cachedSync.localQueryLogs(i,r)},journal:()=>{if(this.cachedSync)return this.cachedSync.queryJournal(i,r)}}}prewarmQuery(e){const n=e.extendSubscriptionFor??q9,s=this.watchQuery(e.query,e.args||{}).onUpdate(()=>{});setTimeout(s,n)}watchPaginatedQuery(e,n,r){const s=ss(e);return{onUpdate:i=>{const{paginatedQueryToken:a,unsubscribe:l}=this.paginatedQueryClient.subscribe(s,n||{},r),u=this.listeners.get(a);return u!==void 0?u.add(i):this.listeners.set(a,new Set([i])),()=>{if(this.closed)return;const d=this.listeners.get(a);d.delete(i),d.size===0&&this.listeners.delete(a),l()}},localQueryResult:()=>this.paginatedQueryClient.localQueryResult(s,n,r)}}mutation(e,...n){const[r,s]=n,i=ss(e);return this.sync.mutation(i,r,s)}action(e,...n){const r=ss(e);return this.sync.action(r,...n)}query(e,...n){const r=this.watchQuery(e,...n),s=r.localQueryResult();return s!==void 0?Promise.resolve(s):new Promise((i,a)=>{const l=r.onUpdate(()=>{l();try{i(r.localQueryResult())}catch(u){a(u)}})})}connectionState(){return this.sync.connectionState()}subscribeToConnectionState(e){return this.sync.subscribeToConnectionState(e)}get logger(){return this._logger}async close(){if(this.closed=!0,this.listeners=new Map,this.cachedPaginatedQueryClient&&(this.cachedPaginatedQueryClient=void 0),this.cachedSync){const e=this.cachedSync;this.cachedSync=void 0,await e.close()}}handleTransition(e){const n=e.queries.map(s=>s.token),r=e.paginatedQueries.map(s=>s.token);this.transition([...n,...r])}transition(e){for(const n of e){const r=this.listeners.get(n);if(r)for(const s of r)s()}}}const XN=Ve.createContext(void 0);function H9(){return N.useContext(XN)}const G9=({client:t,children:e})=>Ve.createElement(XN.Provider,{value:t},e);function Zp(t,...e){const n=e[0]==="skip",r=e[0]==="skip"?{}:Oo(e[0]),s=typeof t=="string"?mO(t):t,i=ss(s),a=N.useMemo(()=>n?{}:{query:{query:s,args:r}},[JSON.stringify(io(r)),i,n]),u=X9(a).query;if(u instanceof Error)throw u;return u}function qi(t){const e=typeof t=="string"?mO(t):t,n=N.useContext(XN);if(n===void 0)throw new Error("Could not find Convex client! `useMutation` must be used in the React component tree under `ConvexProvider`. Did you forget it? See https://docs.convex.dev/quick-start#set-up-convex-in-your-react-app");return N.useMemo(()=>xO(e,n),[n,ss(e)])}function K9(t){if(typeof t=="object"&&t!==null&&"bubbles"in t&&"persist"in t&&"isDefaultPrevented"in t)throw new Error("Convex function called with SyntheticEvent object. Did you use a Convex function as an event handler directly? Event handlers like onClick receive an event object as their first argument. These SyntheticEvent objects are not valid Convex values. Try wrapping the function like `const handler = () => myMutation();` and using `handler` in the event handler.")}var Q9=Object.defineProperty,Z9=(t,e,n)=>e in t?Q9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,__=(t,e,n)=>Z9(t,typeof e!="symbol"?e+"":e,n);class Y9{constructor(e){__(this,"createWatch"),__(this,"queries"),__(this,"listeners"),this.createWatch=e,this.queries={},this.listeners=new Set}setQueries(e){for(const n of Object.keys(e)){const{query:r,args:s,paginationOptions:i}=e[n];if(ss(r),this.queries[n]===void 0)this.addQuery(n,r,s,i?{paginationOptions:i}:{});else{const a=this.queries[n];(ss(r)!==ss(a.query)||JSON.stringify(io(s))!==JSON.stringify(io(a.args))||JSON.stringify(i)!==JSON.stringify(a.paginationOptions))&&(this.removeQuery(n),this.addQuery(n,r,s,i?{paginationOptions:i}:{}))}}for(const n of Object.keys(this.queries))e[n]===void 0&&this.removeQuery(n)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}getLocalResults(e){const n={};for(const r of Object.keys(e)){const{query:s,args:i}=e[r],a=e[r].paginationOptions;ss(s);const l=this.createWatch(s,i,a?{paginationOptions:a}:{});let u;try{u=l.localQueryResult()}catch(d){if(d instanceof Error)u=d;else throw d}n[r]=u}return n}setCreateWatch(e){this.createWatch=e;for(const n of Object.keys(this.queries)){const{query:r,args:s,watch:i,paginationOptions:a}=this.queries[n],l="journal"in i?i.journal():void 0;this.removeQuery(n),this.addQuery(n,r,s,{...l?{journal:l}:[],...a?{paginationOptions:a}:{}})}}destroy(){for(const e of Object.keys(this.queries))this.removeQuery(e);this.listeners=new Set}addQuery(e,n,r,{paginationOptions:s,journal:i}){if(this.queries[e]!==void 0)throw new Error(`Tried to add a new query with identifier ${e} when it already exists.`);const a=this.createWatch(n,r,{...i?{journal:i}:[],...s?{paginationOptions:s}:{}}),l=a.onUpdate(()=>this.notifyListeners());this.queries[e]={query:n,args:r,watch:a,unsubscribe:l,...s?{paginationOptions:s}:{}}}removeQuery(e){const n=this.queries[e];if(n===void 0)throw new Error(`No query found with identifier ${e}.`);n.unsubscribe(),delete this.queries[e]}notifyListeners(){for(const e of this.listeners)e()}}function X9(t){const e=H9();if(e===void 0)throw new Error("Could not find Convex client! `useQuery` must be used in the React component tree under `ConvexProvider`. Did you forget it? See https://docs.convex.dev/quick-start#set-up-convex-in-your-react-app");const n=N.useMemo(()=>(r,s,{journal:i,paginationOptions:a})=>a?e.watchPaginatedQuery(r,s,a):e.watchQuery(r,s,i?{journal:i}:{}),[e]);return J9(t,n)}function J9(t,e){const[n]=N.useState(()=>new Y9(e));n.createWatch!==e&&n.setCreateWatch(e),N.useEffect(()=>()=>n.destroy(),[n]);const r=N.useMemo(()=>({getCurrentValue:()=>n.getLocalResults(t),subscribe:s=>(n.setQueries(t),n.subscribe(s))}),[n,t]);return B9(r)}var JC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},e8=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},bO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;u||(v=64,a||(p=64)),r.push(n[f],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(vO(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):e8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new t8;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let t8=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const n8=function(t){const e=vO(t);return bO.encodeByteArray(e,!0)},r0=function(t){return n8(t).replace(/\./g,"")},_O=function(t){try{return bO.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=()=>r8().__FIREBASE_DEFAULTS__,i8=()=>{if(typeof process>"u"||typeof JC>"u")return;const t=JC.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},o8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&_O(t[1]);return e&&JSON.parse(e)},Ev=()=>{try{return s8()||i8()||o8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wO=t=>{var e,n;return(n=(e=Ev())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},a8=t=>{const e=wO(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},kO=()=>{var t;return(t=Ev())===null||t===void 0?void 0:t.config},NO=t=>{var e;return(e=Ev())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l8=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[r0(JSON.stringify(n)),r0(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function u8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yn())}function d8(){var t;const e=(t=Ev())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function h8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function f8(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function m8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function p8(){const t=Yn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function SO(){return!d8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function TO(){try{return typeof indexedDB=="object"}catch{return!1}}function g8(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8="FirebaseError";let du=class EO extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=y8,Object.setPrototypeOf(this,EO.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yp.prototype.create)}},Yp=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?x8(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new du(s,l,r)}};function x8(t,e){return t.replace(v8,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const v8=/\{\$([^}]+)}/g;function b8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Dc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(ej(i)&&ej(a)){if(!Dc(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function ej(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function nm(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function rm(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function _8(t,e){const n=new w8(t,e);return n.subscribe.bind(n)}class w8{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");k8(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=w_),s.error===void 0&&(s.error=w_),s.complete===void 0&&(s.complete=w_);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function k8(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function w_(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(t){return t&&t._delegate?t._delegate:t}let Vc=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N8{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new l8;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(T8(e))try{this.getOrInitializeService({instanceIdentifier:rc})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=rc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rc){return this.instances.has(e)}getOptions(e=rc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:S8(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=rc){return this.component?this.component.multipleInstances?e:rc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function S8(t){return t===rc?void 0:t}function T8(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E8{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new N8(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Nt||(Nt={}));const C8={debug:Nt.DEBUG,verbose:Nt.VERBOSE,info:Nt.INFO,warn:Nt.WARN,error:Nt.ERROR,silent:Nt.SILENT},j8=Nt.INFO,I8={[Nt.DEBUG]:"log",[Nt.VERBOSE]:"log",[Nt.INFO]:"info",[Nt.WARN]:"warn",[Nt.ERROR]:"error"},A8=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=I8[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let JN=class{constructor(e){this.name=e,this._logLevel=j8,this._logHandler=A8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Nt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?C8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Nt.DEBUG,...e),this._logHandler(this,Nt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Nt.VERBOSE,...e),this._logHandler(this,Nt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Nt.INFO,...e),this._logHandler(this,Nt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Nt.WARN,...e),this._logHandler(this,Nt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Nt.ERROR,...e),this._logHandler(this,Nt.ERROR,...e)}};const R8=(t,e)=>e.some(n=>t instanceof n);let tj,nj;function P8(){return tj||(tj=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function L8(){return nj||(nj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CO=new WeakMap,xk=new WeakMap,jO=new WeakMap,k_=new WeakMap,eS=new WeakMap;function M8(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(ol(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&CO.set(n,t)}).catch(()=>{}),eS.set(e,t),e}function O8(t){if(xk.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});xk.set(t,e)}let vk={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xk.get(t);if(e==="objectStoreNames")return t.objectStoreNames||jO.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ol(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function D8(t){vk=t(vk)}function V8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(N_(this),e,...n);return jO.set(r,e.sort?e.sort():[e]),ol(r)}:L8().includes(t)?function(...e){return t.apply(N_(this),e),ol(CO.get(this))}:function(...e){return ol(t.apply(N_(this),e))}}function F8(t){return typeof t=="function"?V8(t):(t instanceof IDBTransaction&&O8(t),R8(t,P8())?new Proxy(t,vk):t)}function ol(t){if(t instanceof IDBRequest)return M8(t);if(k_.has(t))return k_.get(t);const e=F8(t);return e!==t&&(k_.set(t,e),eS.set(e,t)),e}const N_=t=>eS.get(t);function z8(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=ol(a);return r&&a.addEventListener("upgradeneeded",u=>{r(ol(a.result),u.oldVersion,u.newVersion,ol(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const B8=["get","getKey","getAll","getAllKeys","count"],$8=["put","add","delete","clear"],S_=new Map;function rj(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(S_.get(e))return S_.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=$8.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||B8.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return S_.set(e,i),i}D8(t=>({...t,get:(e,n,r)=>rj(e,n)||t.get(e,n,r),has:(e,n)=>!!rj(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U8=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(q8(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function q8(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bk="@firebase/app",sj="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea=new JN("@firebase/app"),W8="@firebase/app-compat",H8="@firebase/analytics-compat",G8="@firebase/analytics",K8="@firebase/app-check-compat",Q8="@firebase/app-check",Z8="@firebase/auth",Y8="@firebase/auth-compat",X8="@firebase/database",J8="@firebase/data-connect",e7="@firebase/database-compat",t7="@firebase/functions",n7="@firebase/functions-compat",r7="@firebase/installations",s7="@firebase/installations-compat",i7="@firebase/messaging",o7="@firebase/messaging-compat",a7="@firebase/performance",l7="@firebase/performance-compat",c7="@firebase/remote-config",u7="@firebase/remote-config-compat",d7="@firebase/storage",h7="@firebase/storage-compat",f7="@firebase/firestore",m7="@firebase/vertexai-preview",p7="@firebase/firestore-compat",g7="firebase",y7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k="[DEFAULT]",x7={[bk]:"fire-core",[W8]:"fire-core-compat",[G8]:"fire-analytics",[H8]:"fire-analytics-compat",[Q8]:"fire-app-check",[K8]:"fire-app-check-compat",[Z8]:"fire-auth",[Y8]:"fire-auth-compat",[X8]:"fire-rtdb",[J8]:"fire-data-connect",[e7]:"fire-rtdb-compat",[t7]:"fire-fn",[n7]:"fire-fn-compat",[r7]:"fire-iid",[s7]:"fire-iid-compat",[i7]:"fire-fcm",[o7]:"fire-fcm-compat",[a7]:"fire-perf",[l7]:"fire-perf-compat",[c7]:"fire-rc",[u7]:"fire-rc-compat",[d7]:"fire-gcs",[h7]:"fire-gcs-compat",[f7]:"fire-fst",[p7]:"fire-fst-compat",[m7]:"fire-vertex","fire-js":"fire-js",[g7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=new Map,v7=new Map,wk=new Map;function ij(t,e){try{t.container.addComponent(e)}catch(n){ea.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function nh(t){const e=t.name;if(wk.has(e))return ea.debug(`There were multiple attempts to register component ${e}.`),!1;wk.set(e,t);for(const n of s0.values())ij(n,t);for(const n of v7.values())ij(n,t);return!0}function Cv(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ti(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},al=new Yp("app","Firebase",b7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _7{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Vc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw al.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=y7;function IO(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:_k,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw al.create("bad-app-name",{appName:String(s)});if(n||(n=kO()),!n)throw al.create("no-options");const i=s0.get(s);if(i){if(Dc(n,i.options)&&Dc(r,i.config))return i;throw al.create("duplicate-app",{appName:s})}const a=new E8(s);for(const u of wk.values())a.addComponent(u);const l=new _7(n,r,a);return s0.set(s,l),l}function tS(t=_k){const e=s0.get(t);if(!e&&t===_k&&kO())return IO();if(!e)throw al.create("no-app",{appName:t});return e}function ll(t,e,n){var r;let s=(r=x7[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ea.warn(l.join(" "));return}nh(new Vc(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7="firebase-heartbeat-database",k7=1,cp="firebase-heartbeat-store";let T_=null;function AO(){return T_||(T_=z8(w7,k7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(cp)}catch(n){console.warn(n)}}}}).catch(t=>{throw al.create("idb-open",{originalErrorMessage:t.message})})),T_}async function N7(t){try{const n=(await AO()).transaction(cp),r=await n.objectStore(cp).get(RO(t));return await n.done,r}catch(e){if(e instanceof du)ea.warn(e.message);else{const n=al.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ea.warn(n.message)}}}async function oj(t,e){try{const r=(await AO()).transaction(cp,"readwrite");await r.objectStore(cp).put(e,RO(t)),await r.done}catch(n){if(n instanceof du)ea.warn(n.message);else{const r=al.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ea.warn(r.message)}}}function RO(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S7=1024,T7=30*24*60*60*1e3;let E7=class{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new j7(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=aj();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=T7}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ea.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=aj(),{heartbeatsToSend:r,unsentEntries:s}=C7(this._heartbeatsCache.heartbeats),i=r0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ea.warn(n),""}}};function aj(){return new Date().toISOString().substring(0,10)}function C7(t,e=S7){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),lj(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),lj(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}let j7=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return TO()?g8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await N7(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return oj(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return oj(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}};function lj(t){return r0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I7(t){nh(new Vc("platform-logger",e=>new U8(e),"PRIVATE")),nh(new Vc("heartbeat",e=>new E7(e),"PRIVATE")),ll(bk,sj,t),ll(bk,sj,"esm2017"),ll("fire-js","")}I7("");function nS(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function PO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const A7=PO,LO=new Yp("auth","Firebase",PO());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0=new JN("@firebase/auth");function R7(t,...e){i0.logLevel<=Nt.WARN&&i0.warn(`Auth (${Mh}): ${t}`,...e)}function lx(t,...e){i0.logLevel<=Nt.ERROR&&i0.error(`Auth (${Mh}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t,...e){throw sS(t,...e)}function Ci(t,...e){return sS(t,...e)}function rS(t,e,n){const r=Object.assign(Object.assign({},A7()),{[e]:n});return new Yp("auth","Firebase",r).create(e,{appName:t.name})}function Ji(t){return rS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function P7(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&oi(t,"argument-error"),rS(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function sS(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return LO.create(t,...e)}function nt(t,e,...n){if(!t)throw sS(e,...n)}function zo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lx(e),new Error(e)}function ta(t,e){t||zo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function L7(){return cj()==="http:"||cj()==="https:"}function cj(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(L7()||f8()||"connection"in navigator)?navigator.onLine:!0}function O7(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,n){this.shortDelay=e,this.longDelay=n,ta(n>e,"Short delay should be less than long delay!"),this.isMobile=u8()||m8()}get(){return M7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t,e){ta(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V7=new Jp(3e4,6e4);function la(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ho(t,e,n,r,s={}){return OO(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=Xp(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return h8()||(d.referrerPolicy="no-referrer"),MO.fetch()(DO(t,t.config.apiHost,n,l),d)})}async function OO(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},D7),e);try{const s=new z7(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Cy(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cy(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Cy(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Cy(t,"user-disabled",a);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw rS(t,f,d);oi(t,f)}}catch(s){if(s instanceof du)throw s;oi(t,"network-request-failed",{message:String(s)})}}async function eg(t,e,n,r,s={}){const i=await ho(t,e,n,r,s);return"mfaPendingCredential"in i&&oi(t,"multi-factor-auth-required",{_serverResponse:i}),i}function DO(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?iS(t.config,s):`${t.config.apiScheme}://${s}`}function F7(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class z7{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ci(this.auth,"network-request-failed")),V7.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Cy(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Ci(t,e,r);return s.customData._tokenResponse=n,s}function uj(t){return t!==void 0&&t.enterprise!==void 0}class B7{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return F7(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function $7(t,e){return ho(t,"GET","/v2/recaptchaConfig",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U7(t,e){return ho(t,"POST","/v1/accounts:delete",e)}async function VO(t,e){return ho(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function q7(t,e=!1){const n=ln(t),r=await n.getIdToken(e),s=oS(r);nt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Sm(E_(s.auth_time)),issuedAtTime:Sm(E_(s.iat)),expirationTime:Sm(E_(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function E_(t){return Number(t)*1e3}function oS(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return lx("JWT malformed, contained fewer than 3 sections"),null;try{const s=_O(n);return s?JSON.parse(s):(lx("Failed to decode base64 JWT payload"),null)}catch(s){return lx("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function dj(t){const e=oS(t);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rh(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof du&&W7(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function W7({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sm(this.lastLoginAt),this.creationTime=Sm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o0(t){var e;const n=t.auth,r=await t.getIdToken(),s=await rh(t,VO(n,{idToken:r}));nt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?FO(i.providerUserInfo):[],l=K7(t.providerData,a),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),f=u?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Nk(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,m)}async function G7(t){const e=ln(t);await o0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function K7(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function FO(t){return t.map(e=>{var{providerId:n}=e,r=nS(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q7(t,e){const n=await OO(t,{},async()=>{const r=Xp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=DO(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",MO.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Z7(t,e){return ho(t,"POST","/v2/accounts:revokeToken",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):dj(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const n=dj(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Q7(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new Fd;return r&&(nt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(nt(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(nt(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fd,this.toJSON())}_performRefresh(){return zo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(t,e){nt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Bo{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=nS(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H7(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Nk(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await rh(this,this.stsTokenManager.getToken(this.auth,e));return nt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return q7(this,e)}reload(){return G7(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Bo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await o0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ti(this.auth.app))return Promise.reject(Ji(this.auth));const e=await this.getIdToken();return await rh(this,U7(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,l,u,d,f;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,v=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(a=n.photoURL)!==null&&a!==void 0?a:void 0,_=(l=n.tenantId)!==null&&l!==void 0?l:void 0,E=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,k=(d=n.createdAt)!==null&&d!==void 0?d:void 0,b=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:S,emailVerified:C,isAnonymous:P,providerData:R,stsTokenManager:I}=n;nt(S&&I,e,"internal-error");const j=Fd.fromJSON(this.name,I);nt(typeof S=="string",e,"internal-error"),Sa(m,e.name),Sa(p,e.name),nt(typeof C=="boolean",e,"internal-error"),nt(typeof P=="boolean",e,"internal-error"),Sa(v,e.name),Sa(x,e.name),Sa(_,e.name),Sa(E,e.name),Sa(k,e.name),Sa(b,e.name);const O=new Bo({uid:S,auth:e,email:p,emailVerified:C,displayName:m,isAnonymous:P,photoURL:x,phoneNumber:v,tenantId:_,stsTokenManager:j,createdAt:k,lastLoginAt:b});return R&&Array.isArray(R)&&(O.providerData=R.map(V=>Object.assign({},V))),E&&(O._redirectEventId=E),O}static async _fromIdTokenResponse(e,n,r=!1){const s=new Fd;s.updateFromServerResponse(n);const i=new Bo({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await o0(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];nt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?FO(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Fd;l.updateFromIdToken(r);const u=new Bo({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Nk(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=new Map;function $o(t){ta(t instanceof Function,"Expected a class definition");let e=hj.get(t);return e?(ta(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hj.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}zO.type="NONE";const fj=zO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(t,e,n){return`firebase:${t}:${e}:${n}`}class zd{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=cx(this.userKey,s.apiKey,i),this.fullPersistenceKey=cx("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Bo._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new zd($o(fj),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||$o(fj);const a=cx(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const f=await d._get(a);if(f){const m=Bo._fromJSON(e,f);d!==i&&(l=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new zd(i,e,r):(i=u[0],l&&await i._set(a,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new zd(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(qO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(BO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(HO(e))return"Blackberry";if(GO(e))return"Webos";if($O(e))return"Safari";if((e.includes("chrome/")||UO(e))&&!e.includes("edge/"))return"Chrome";if(WO(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function BO(t=Yn()){return/firefox\//i.test(t)}function $O(t=Yn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function UO(t=Yn()){return/crios\//i.test(t)}function qO(t=Yn()){return/iemobile/i.test(t)}function WO(t=Yn()){return/android/i.test(t)}function HO(t=Yn()){return/blackberry/i.test(t)}function GO(t=Yn()){return/webos/i.test(t)}function aS(t=Yn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Y7(t=Yn()){var e;return aS(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function X7(){return p8()&&document.documentMode===10}function KO(t=Yn()){return aS(t)||WO(t)||GO(t)||HO(t)||/windows phone/i.test(t)||qO(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QO(t,e=[]){let n;switch(t){case"Browser":n=mj(Yn());break;case"Worker":n=`${mj(Yn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Mh}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,l)=>{try{const u=e(i);a(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eq(t,e={}){return ho(t,"GET","/v2/passwordPolicy",la(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tq=6;class nq{constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:tq,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pj(this),this.idTokenSubscription=new pj(this),this.beforeStateQueue=new J7(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=LO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=$o(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await zd.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await VO(this,{idToken:e}),r=await Bo._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(ti(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await o0(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=O7()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ti(this.app))return Promise.reject(Ji(this));const n=e?ln(e):null;return n&&nt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ti(this.app)?Promise.reject(Ji(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ti(this.app)?Promise.reject(Ji(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($o(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eq(this),n=new nq(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Yp("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Z7(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&$o(e)||this._popupRedirectResolver;nt(n,this,"argument-error"),this.redirectPersistenceManager=await zd.create(this,[$o(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(l,this,"internal-error"),l.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=QO(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&R7(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ca(t){return ln(t)}class pj{constructor(e){this.auth=e,this.observer=null,this.addObserver=_8(n=>this.observer=n)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sq(t){jv=t}function ZO(t){return jv.loadJS(t)}function iq(){return jv.recaptchaEnterpriseScript}function oq(){return jv.gapiScript}function aq(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const lq="recaptcha-enterprise",cq="NO_RECAPTCHA";class uq{constructor(e){this.type=lq,this.auth=ca(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,l)=>{$7(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new B7(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,a(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,a,l){const u=window.grecaptcha;uj(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{a(d)}).catch(()=>{a(cq)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{r(this.auth).then(l=>{if(!n&&uj(window.grecaptcha))s(l,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=iq();u.length!==0&&(u+=l),ZO(u).then(()=>{s(l,i,a)}).catch(d=>{a(d)})}}).catch(l=>{a(l)})})}}async function gj(t,e,n,r=!1){const s=new uq(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function a0(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await gj(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await gj(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dq(t,e){const n=Cv(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Dc(i,e??{}))return s;oi(s,"already-initialized")}return n.initialize({options:e})}function hq(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map($o);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function fq(t,e,n){const r=ca(t);nt(r._canInitEmulator,r,"emulator-config-failed"),nt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=YO(e),{host:a,port:l}=mq(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${a}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),pq()}function YO(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function mq(t){const e=YO(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:yj(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:yj(a)}}}function yj(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function pq(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return zo("not implemented")}_getIdTokenResponse(e){return zo("not implemented")}_linkToIdToken(e,n){return zo("not implemented")}_getReauthenticationResolver(e){return zo("not implemented")}}async function gq(t,e){return ho(t,"POST","/v1/accounts:update",e)}async function yq(t,e){return ho(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xq(t,e){return eg(t,"POST","/v1/accounts:signInWithPassword",la(t,e))}async function vq(t,e){return ho(t,"POST","/v1/accounts:sendOobCode",la(t,e))}async function bq(t,e){return vq(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _q(t,e){return eg(t,"POST","/v1/accounts:signInWithEmailLink",la(t,e))}async function wq(t,e){return eg(t,"POST","/v1/accounts:signInWithEmailLink",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up extends lS{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new up(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new up(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return a0(e,n,"signInWithPassword",xq);case"emailLink":return _q(e,{email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return a0(e,r,"signUpPassword",yq);case"emailLink":return wq(e,{idToken:n,email:this._email,oobCode:this._password});default:oi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bd(t,e){return eg(t,"POST","/v1/accounts:signInWithIdp",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kq="http://localhost";class Fc extends lS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Fc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):oi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=nS(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new Fc(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Bd(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Bd(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bd(e,n)}buildRequest(){const e={requestUri:kq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Xp(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nq(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Sq(t){const e=nm(rm(t)).link,n=e?nm(rm(e)).deep_link_id:null,r=nm(rm(t)).deep_link_id;return(r?nm(rm(r)).link:null)||r||n||e||t}class cS{constructor(e){var n,r,s,i,a,l;const u=nm(rm(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,m=Nq((s=u.mode)!==null&&s!==void 0?s:null);nt(d&&f&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=f,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=u.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=Sq(e);try{return new cS(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(){this.providerId=hu.PROVIDER_ID}static credential(e,n){return up._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=cS.parseLink(n);return nt(r,"argument-error"),up._fromEmailAndCode(e,r.code,r.tenantId)}}hu.PROVIDER_ID="password";hu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";hu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg extends uS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va extends tg{constructor(){super("facebook.com")}static credential(e){return Fc._fromParams({providerId:Va.PROVIDER_ID,signInMethod:Va.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Va.credentialFromTaggedObject(e)}static credentialFromError(e){return Va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Va.credential(e.oauthAccessToken)}catch{return null}}}Va.FACEBOOK_SIGN_IN_METHOD="facebook.com";Va.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do extends tg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Fc._fromParams({providerId:Do.PROVIDER_ID,signInMethod:Do.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Do.credentialFromTaggedObject(e)}static credentialFromError(e){return Do.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Do.credential(n,r)}catch{return null}}}Do.GOOGLE_SIGN_IN_METHOD="google.com";Do.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa extends tg{constructor(){super("github.com")}static credential(e){return Fc._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fa.credential(e.oauthAccessToken)}catch{return null}}}Fa.GITHUB_SIGN_IN_METHOD="github.com";Fa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za extends tg{constructor(){super("twitter.com")}static credential(e,n){return Fc._fromParams({providerId:za.PROVIDER_ID,signInMethod:za.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return za.credentialFromTaggedObject(e)}static credentialFromError(e){return za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return za.credential(n,r)}catch{return null}}}za.TWITTER_SIGN_IN_METHOD="twitter.com";za.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tq(t,e){return eg(t,"POST","/v1/accounts:signUp",la(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Bo._fromIdTokenResponse(e,r,s),a=xj(r);return new zc({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=xj(r);return new zc({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function xj(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0 extends du{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,l0.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new l0(e,n,r,s)}}function XO(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?l0._fromErrorAndOperation(t,i,e,r):i})}async function Eq(t,e,n=!1){const r=await rh(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return zc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JO(t,e,n=!1){const{auth:r}=t;if(ti(r.app))return Promise.reject(Ji(r));const s="reauthenticate";try{const i=await rh(t,XO(r,s,e,t),n);nt(i.idToken,r,"internal-error");const a=oS(i.idToken);nt(a,r,"internal-error");const{sub:l}=a;return nt(t.uid===l,r,"user-mismatch"),zc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&oi(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e4(t,e,n=!1){if(ti(t.app))return Promise.reject(Ji(t));const r="signIn",s=await XO(t,r,e),i=await zc._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Cq(t,e){return e4(ca(t),e)}async function jq(t,e){return JO(ln(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t4(t){const e=ca(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Iq(t,e,n){const r=ca(t);await a0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",bq)}async function Aq(t,e,n){if(ti(t.app))return Promise.reject(Ji(t));const r=ca(t),a=await a0(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Tq).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&t4(t),u}),l=await zc._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function Rq(t,e,n){return ti(t.app)?Promise.reject(Ji(t)):Cq(ln(t),hu.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&t4(t),r})}function Pq(t,e){const n=ln(t);return ti(n.auth.app)?Promise.reject(Ji(n.auth)):n4(n,e,null)}function Lq(t,e){return n4(ln(t),null,e)}async function n4(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const a=await rh(t,gq(r,i));await t._updateTokensIfNecessary(a,!0)}function Mq(t,e,n,r){return ln(t).onIdTokenChanged(e,n,r)}function Oq(t,e,n){return ln(t).beforeAuthStateChanged(e,n)}function Dq(t,e,n,r){return ln(t).onAuthStateChanged(e,n,r)}function dS(t){return ln(t).signOut()}async function Vq(t){return ln(t).delete()}const c0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(c0,"1"),this.storage.removeItem(c0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fq=1e3,zq=10;class s4 extends r4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=KO(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);X7()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,zq):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Fq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}s4.type="LOCAL";const Bq=s4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4 extends r4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}i4.type="SESSION";const o4=i4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $q(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Iv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async d=>d(n.origin,i)),u=await $q(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Iv.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,u)=>{const d=hS("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(){return window}function qq(t){eo().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(){return typeof eo().WorkerGlobalScope<"u"&&typeof eo().importScripts=="function"}async function Wq(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Hq(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Gq(){return a4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4="firebaseLocalStorageDb",Kq=1,u0="firebaseLocalStorage",c4="fbase_key";class ng{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Av(t,e){return t.transaction([u0],e?"readwrite":"readonly").objectStore(u0)}function Qq(){const t=indexedDB.deleteDatabase(l4);return new ng(t).toPromise()}function Sk(){const t=indexedDB.open(l4,Kq);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(u0,{keyPath:c4})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(u0)?e(r):(r.close(),await Qq(),e(await Sk()))})})}async function vj(t,e,n){const r=Av(t,!0).put({[c4]:e,value:n});return new ng(r).toPromise()}async function Zq(t,e){const n=Av(t,!1).get(e),r=await new ng(n).toPromise();return r===void 0?null:r.value}function bj(t,e){const n=Av(t,!0).delete(e);return new ng(n).toPromise()}const Yq=800,Xq=3;class u4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sk(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Xq)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return a4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Iv._getInstance(Gq()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Wq(),!this.activeServiceWorker)return;this.sender=new Uq(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Hq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sk();return await vj(e,c0,"1"),await bj(e,c0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>vj(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Zq(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>bj(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Av(s,!1).getAll();return new ng(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Yq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}u4.type="LOCAL";const Jq=u4;new Jp(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(t,e){return e?$o(e):(nt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS extends lS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bd(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bd(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bd(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function eW(t){return e4(t.auth,new fS(t),t.bypassAuthState)}function tW(t){const{auth:e,user:n}=t;return nt(n,e,"internal-error"),JO(n,new fS(t),t.bypassAuthState)}async function nW(t){const{auth:e,user:n}=t;return nt(n,e,"internal-error"),Eq(n,new fS(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eW;case"linkViaPopup":case"linkViaRedirect":return nW;case"reauthViaPopup":case"reauthViaRedirect":return tW;default:oi(this.auth,"internal-error")}}resolve(e){ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW=new Jp(2e3,1e4);async function sW(t,e,n){if(ti(t.app))return Promise.reject(Ci(t,"operation-not-supported-in-this-environment"));const r=ca(t);P7(t,e,uS);const s=d4(r,n);return new gc(r,"signInViaPopup",e,s).executeNotNull()}class gc extends h4{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,gc.currentPopupAction&&gc.currentPopupAction.cancel(),gc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){ta(this.filter.length===1,"Popup operations only handle one event");const e=hS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ci(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ci(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ci(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rW.get())};e()}}gc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iW="pendingRedirect",ux=new Map;class oW extends h4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ux.get(this.auth._key());if(!e){try{const r=await aW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ux.set(this.auth._key(),e)}return this.bypassAuthState||ux.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aW(t,e){const n=uW(e),r=cW(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function lW(t,e){ux.set(t._key(),e)}function cW(t){return $o(t._redirectPersistence)}function uW(t){return cx(iW,t.config.apiKey,t.name)}async function dW(t,e,n=!1){if(ti(t.app))return Promise.reject(Ji(t));const r=ca(t),s=d4(r,e),a=await new oW(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hW=10*60*1e3;class fW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mW(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!f4(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ci(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hW&&this.cachedEventUids.clear(),this.cachedEventUids.has(_j(e))}saveEventToCache(e){this.cachedEventUids.add(_j(e)),this.lastProcessedEventTime=Date.now()}}function _j(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function f4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function mW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return f4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pW(t,e={}){return ho(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yW=/^https?/;async function xW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await pW(t);for(const n of e)try{if(vW(n))return}catch{}oi(t,"unauthorized-domain")}function vW(t){const e=kk(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!yW.test(n))return!1;if(gW.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW=new Jp(3e4,6e4);function wj(){const t=eo().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function _W(t){return new Promise((e,n)=>{var r,s,i;function a(){wj(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wj(),n(Ci(t,"network-request-failed"))},timeout:bW.get()})}if(!((s=(r=eo().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=eo().gapi)===null||i===void 0)&&i.load)a();else{const l=aq("iframefcb");return eo()[l]=()=>{gapi.load?a():n(Ci(t,"network-request-failed"))},ZO(`${oq()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw dx=null,e})}let dx=null;function wW(t){return dx=dx||_W(t),dx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kW=new Jp(5e3,15e3),NW="__/auth/iframe",SW="emulator/auth/iframe",TW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function CW(t){const e=t.config;nt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?iS(e,SW):`https://${t.config.authDomain}/${NW}`,r={apiKey:e.apiKey,appName:t.name,v:Mh},s=EW.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Xp(r).slice(1)}`}async function jW(t){const e=await wW(t),n=eo().gapi;return nt(n,t,"internal-error"),e.open({where:document.body,url:CW(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TW,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=Ci(t,"network-request-failed"),l=eo().setTimeout(()=>{i(a)},kW.get());function u(){eo().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},AW=500,RW=600,PW="_blank",LW="http://localhost";class kj{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MW(t,e,n,r=AW,s=RW){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},IW),{width:r.toString(),height:s.toString(),top:i,left:a}),d=Yn().toLowerCase();n&&(l=UO(d)?PW:n),BO(d)&&(e=e||LW,u.scrollbars="yes");const f=Object.entries(u).reduce((p,[v,x])=>`${p}${v}=${x},`,"");if(Y7(d)&&l!=="_self")return OW(e||"",l),new kj(null);const m=window.open(e||"",l,f);nt(m,t,"popup-blocked");try{m.focus()}catch{}return new kj(m)}function OW(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DW="__/auth/handler",VW="emulator/auth/handler",FW=encodeURIComponent("fac");async function Nj(t,e,n,r,s,i){nt(t.config.authDomain,t,"auth-domain-config-required"),nt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Mh,eventId:s};if(e instanceof uS){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",b8(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))a[f]=m}if(e instanceof tg){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await t._getAppCheckToken(),d=u?`#${FW}=${encodeURIComponent(u)}`:"";return`${zW(t)}?${Xp(l).slice(1)}${d}`}function zW({config:t}){return t.emulator?iS(t,VW):`https://${t.authDomain}/${DW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="webStorageSupport";class BW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=o4,this._completeRedirectFn=dW,this._overrideRedirectResult=lW}async _openPopup(e,n,r,s){var i;ta((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await Nj(e,n,r,kk(),s);return MW(e,a,hS())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Nj(e,n,r,kk(),s);return qq(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ta(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await jW(e),r=new fW(e);return n.register("authEvent",s=>(nt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(C_,{type:C_},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[C_];a!==void 0&&n(!!a),oi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=xW(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return KO()||$O()||aS()}}const $W=BW;var Sj="@firebase/auth",Tj="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WW(t){nh(new Vc("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;nt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:QO(t)},d=new rq(r,s,i,u);return hq(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),nh(new Vc("auth-internal",e=>{const n=ca(e.getProvider("auth").getImmediate());return(r=>new UW(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ll(Sj,Tj,qW(t)),ll(Sj,Tj,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HW=5*60,GW=NO("authIdTokenMaxAge")||HW;let Ej=null;const KW=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>GW)return;const s=n==null?void 0:n.token;Ej!==s&&(Ej=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function m4(t=tS()){const e=Cv(t,"auth");if(e.isInitialized())return e.getImmediate();const n=dq(t,{popupRedirectResolver:$W,persistence:[Jq,Bq,o4]}),r=NO("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=KW(i.toString());Oq(n,a,()=>a(n.currentUser)),Mq(n,l=>a(l))}}const s=wO("auth");return s&&fq(n,`http://${s}`),n}function QW(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}sq({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Ci("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",QW().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WW("Browser");var Cj=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kc,p4;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,j){function O(){}O.prototype=j.prototype,I.D=j.prototype,I.prototype=new O,I.prototype.constructor=I,I.C=function(V,z,D){for(var F=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)F[ee-2]=arguments[ee];return j.prototype[z].apply(V,F)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,j,O){O||(O=0);var V=Array(16);if(typeof j=="string")for(var z=0;16>z;++z)V[z]=j.charCodeAt(O++)|j.charCodeAt(O++)<<8|j.charCodeAt(O++)<<16|j.charCodeAt(O++)<<24;else for(z=0;16>z;++z)V[z]=j[O++]|j[O++]<<8|j[O++]<<16|j[O++]<<24;j=I.g[0],O=I.g[1],z=I.g[2];var D=I.g[3],F=j+(D^O&(z^D))+V[0]+3614090360&4294967295;j=O+(F<<7&4294967295|F>>>25),F=D+(z^j&(O^z))+V[1]+3905402710&4294967295,D=j+(F<<12&4294967295|F>>>20),F=z+(O^D&(j^O))+V[2]+606105819&4294967295,z=D+(F<<17&4294967295|F>>>15),F=O+(j^z&(D^j))+V[3]+3250441966&4294967295,O=z+(F<<22&4294967295|F>>>10),F=j+(D^O&(z^D))+V[4]+4118548399&4294967295,j=O+(F<<7&4294967295|F>>>25),F=D+(z^j&(O^z))+V[5]+1200080426&4294967295,D=j+(F<<12&4294967295|F>>>20),F=z+(O^D&(j^O))+V[6]+2821735955&4294967295,z=D+(F<<17&4294967295|F>>>15),F=O+(j^z&(D^j))+V[7]+4249261313&4294967295,O=z+(F<<22&4294967295|F>>>10),F=j+(D^O&(z^D))+V[8]+1770035416&4294967295,j=O+(F<<7&4294967295|F>>>25),F=D+(z^j&(O^z))+V[9]+2336552879&4294967295,D=j+(F<<12&4294967295|F>>>20),F=z+(O^D&(j^O))+V[10]+4294925233&4294967295,z=D+(F<<17&4294967295|F>>>15),F=O+(j^z&(D^j))+V[11]+2304563134&4294967295,O=z+(F<<22&4294967295|F>>>10),F=j+(D^O&(z^D))+V[12]+1804603682&4294967295,j=O+(F<<7&4294967295|F>>>25),F=D+(z^j&(O^z))+V[13]+4254626195&4294967295,D=j+(F<<12&4294967295|F>>>20),F=z+(O^D&(j^O))+V[14]+2792965006&4294967295,z=D+(F<<17&4294967295|F>>>15),F=O+(j^z&(D^j))+V[15]+1236535329&4294967295,O=z+(F<<22&4294967295|F>>>10),F=j+(z^D&(O^z))+V[1]+4129170786&4294967295,j=O+(F<<5&4294967295|F>>>27),F=D+(O^z&(j^O))+V[6]+3225465664&4294967295,D=j+(F<<9&4294967295|F>>>23),F=z+(j^O&(D^j))+V[11]+643717713&4294967295,z=D+(F<<14&4294967295|F>>>18),F=O+(D^j&(z^D))+V[0]+3921069994&4294967295,O=z+(F<<20&4294967295|F>>>12),F=j+(z^D&(O^z))+V[5]+3593408605&4294967295,j=O+(F<<5&4294967295|F>>>27),F=D+(O^z&(j^O))+V[10]+38016083&4294967295,D=j+(F<<9&4294967295|F>>>23),F=z+(j^O&(D^j))+V[15]+3634488961&4294967295,z=D+(F<<14&4294967295|F>>>18),F=O+(D^j&(z^D))+V[4]+3889429448&4294967295,O=z+(F<<20&4294967295|F>>>12),F=j+(z^D&(O^z))+V[9]+568446438&4294967295,j=O+(F<<5&4294967295|F>>>27),F=D+(O^z&(j^O))+V[14]+3275163606&4294967295,D=j+(F<<9&4294967295|F>>>23),F=z+(j^O&(D^j))+V[3]+4107603335&4294967295,z=D+(F<<14&4294967295|F>>>18),F=O+(D^j&(z^D))+V[8]+1163531501&4294967295,O=z+(F<<20&4294967295|F>>>12),F=j+(z^D&(O^z))+V[13]+2850285829&4294967295,j=O+(F<<5&4294967295|F>>>27),F=D+(O^z&(j^O))+V[2]+4243563512&4294967295,D=j+(F<<9&4294967295|F>>>23),F=z+(j^O&(D^j))+V[7]+1735328473&4294967295,z=D+(F<<14&4294967295|F>>>18),F=O+(D^j&(z^D))+V[12]+2368359562&4294967295,O=z+(F<<20&4294967295|F>>>12),F=j+(O^z^D)+V[5]+4294588738&4294967295,j=O+(F<<4&4294967295|F>>>28),F=D+(j^O^z)+V[8]+2272392833&4294967295,D=j+(F<<11&4294967295|F>>>21),F=z+(D^j^O)+V[11]+1839030562&4294967295,z=D+(F<<16&4294967295|F>>>16),F=O+(z^D^j)+V[14]+4259657740&4294967295,O=z+(F<<23&4294967295|F>>>9),F=j+(O^z^D)+V[1]+2763975236&4294967295,j=O+(F<<4&4294967295|F>>>28),F=D+(j^O^z)+V[4]+1272893353&4294967295,D=j+(F<<11&4294967295|F>>>21),F=z+(D^j^O)+V[7]+4139469664&4294967295,z=D+(F<<16&4294967295|F>>>16),F=O+(z^D^j)+V[10]+3200236656&4294967295,O=z+(F<<23&4294967295|F>>>9),F=j+(O^z^D)+V[13]+681279174&4294967295,j=O+(F<<4&4294967295|F>>>28),F=D+(j^O^z)+V[0]+3936430074&4294967295,D=j+(F<<11&4294967295|F>>>21),F=z+(D^j^O)+V[3]+3572445317&4294967295,z=D+(F<<16&4294967295|F>>>16),F=O+(z^D^j)+V[6]+76029189&4294967295,O=z+(F<<23&4294967295|F>>>9),F=j+(O^z^D)+V[9]+3654602809&4294967295,j=O+(F<<4&4294967295|F>>>28),F=D+(j^O^z)+V[12]+3873151461&4294967295,D=j+(F<<11&4294967295|F>>>21),F=z+(D^j^O)+V[15]+530742520&4294967295,z=D+(F<<16&4294967295|F>>>16),F=O+(z^D^j)+V[2]+3299628645&4294967295,O=z+(F<<23&4294967295|F>>>9),F=j+(z^(O|~D))+V[0]+4096336452&4294967295,j=O+(F<<6&4294967295|F>>>26),F=D+(O^(j|~z))+V[7]+1126891415&4294967295,D=j+(F<<10&4294967295|F>>>22),F=z+(j^(D|~O))+V[14]+2878612391&4294967295,z=D+(F<<15&4294967295|F>>>17),F=O+(D^(z|~j))+V[5]+4237533241&4294967295,O=z+(F<<21&4294967295|F>>>11),F=j+(z^(O|~D))+V[12]+1700485571&4294967295,j=O+(F<<6&4294967295|F>>>26),F=D+(O^(j|~z))+V[3]+2399980690&4294967295,D=j+(F<<10&4294967295|F>>>22),F=z+(j^(D|~O))+V[10]+4293915773&4294967295,z=D+(F<<15&4294967295|F>>>17),F=O+(D^(z|~j))+V[1]+2240044497&4294967295,O=z+(F<<21&4294967295|F>>>11),F=j+(z^(O|~D))+V[8]+1873313359&4294967295,j=O+(F<<6&4294967295|F>>>26),F=D+(O^(j|~z))+V[15]+4264355552&4294967295,D=j+(F<<10&4294967295|F>>>22),F=z+(j^(D|~O))+V[6]+2734768916&4294967295,z=D+(F<<15&4294967295|F>>>17),F=O+(D^(z|~j))+V[13]+1309151649&4294967295,O=z+(F<<21&4294967295|F>>>11),F=j+(z^(O|~D))+V[4]+4149444226&4294967295,j=O+(F<<6&4294967295|F>>>26),F=D+(O^(j|~z))+V[11]+3174756917&4294967295,D=j+(F<<10&4294967295|F>>>22),F=z+(j^(D|~O))+V[2]+718787259&4294967295,z=D+(F<<15&4294967295|F>>>17),F=O+(D^(z|~j))+V[9]+3951481745&4294967295,I.g[0]=I.g[0]+j&4294967295,I.g[1]=I.g[1]+(z+(F<<21&4294967295|F>>>11))&4294967295,I.g[2]=I.g[2]+z&4294967295,I.g[3]=I.g[3]+D&4294967295}r.prototype.u=function(I,j){j===void 0&&(j=I.length);for(var O=j-this.blockSize,V=this.B,z=this.h,D=0;D<j;){if(z==0)for(;D<=O;)s(this,I,D),D+=this.blockSize;if(typeof I=="string"){for(;D<j;)if(V[z++]=I.charCodeAt(D++),z==this.blockSize){s(this,V),z=0;break}}else for(;D<j;)if(V[z++]=I[D++],z==this.blockSize){s(this,V),z=0;break}}this.h=z,this.o+=j},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var j=1;j<I.length-8;++j)I[j]=0;var O=8*this.o;for(j=I.length-8;j<I.length;++j)I[j]=O&255,O/=256;for(this.u(I),I=Array(16),j=O=0;4>j;++j)for(var V=0;32>V;V+=8)I[O++]=this.g[j]>>>V&255;return I};function i(I,j){var O=l;return Object.prototype.hasOwnProperty.call(O,I)?O[I]:O[I]=j(I)}function a(I,j){this.h=j;for(var O=[],V=!0,z=I.length-1;0<=z;z--){var D=I[z]|0;V&&D==j||(O[z]=D,V=!1)}this.g=O}var l={};function u(I){return-128<=I&&128>I?i(I,function(j){return new a([j|0],0>j?-1:0)}):new a([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return m;if(0>I)return E(d(-I));for(var j=[],O=1,V=0;I>=O;V++)j[V]=I/O|0,O*=4294967296;return new a(j,0)}function f(I,j){if(I.length==0)throw Error("number format error: empty string");if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(I.charAt(0)=="-")return E(f(I.substring(1),j));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var O=d(Math.pow(j,8)),V=m,z=0;z<I.length;z+=8){var D=Math.min(8,I.length-z),F=parseInt(I.substring(z,z+D),j);8>D?(D=d(Math.pow(j,D)),V=V.j(D).add(d(F))):(V=V.j(O),V=V.add(d(F)))}return V}var m=u(0),p=u(1),v=u(16777216);t=a.prototype,t.m=function(){if(_(this))return-E(this).m();for(var I=0,j=1,O=0;O<this.g.length;O++){var V=this.i(O);I+=(0<=V?V:4294967296+V)*j,j*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(x(this))return"0";if(_(this))return"-"+E(this).toString(I);for(var j=d(Math.pow(I,6)),O=this,V="";;){var z=C(O,j).g;O=k(O,z.j(j));var D=((0<O.g.length?O.g[0]:O.h)>>>0).toString(I);if(O=z,x(O))return D+V;for(;6>D.length;)D="0"+D;V=D+V}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function x(I){if(I.h!=0)return!1;for(var j=0;j<I.g.length;j++)if(I.g[j]!=0)return!1;return!0}function _(I){return I.h==-1}t.l=function(I){return I=k(this,I),_(I)?-1:x(I)?0:1};function E(I){for(var j=I.g.length,O=[],V=0;V<j;V++)O[V]=~I.g[V];return new a(O,~I.h).add(p)}t.abs=function(){return _(this)?E(this):this},t.add=function(I){for(var j=Math.max(this.g.length,I.g.length),O=[],V=0,z=0;z<=j;z++){var D=V+(this.i(z)&65535)+(I.i(z)&65535),F=(D>>>16)+(this.i(z)>>>16)+(I.i(z)>>>16);V=F>>>16,D&=65535,F&=65535,O[z]=F<<16|D}return new a(O,O[O.length-1]&-2147483648?-1:0)};function k(I,j){return I.add(E(j))}t.j=function(I){if(x(this)||x(I))return m;if(_(this))return _(I)?E(this).j(E(I)):E(E(this).j(I));if(_(I))return E(this.j(E(I)));if(0>this.l(v)&&0>I.l(v))return d(this.m()*I.m());for(var j=this.g.length+I.g.length,O=[],V=0;V<2*j;V++)O[V]=0;for(V=0;V<this.g.length;V++)for(var z=0;z<I.g.length;z++){var D=this.i(V)>>>16,F=this.i(V)&65535,ee=I.i(z)>>>16,ue=I.i(z)&65535;O[2*V+2*z]+=F*ue,b(O,2*V+2*z),O[2*V+2*z+1]+=D*ue,b(O,2*V+2*z+1),O[2*V+2*z+1]+=F*ee,b(O,2*V+2*z+1),O[2*V+2*z+2]+=D*ee,b(O,2*V+2*z+2)}for(V=0;V<j;V++)O[V]=O[2*V+1]<<16|O[2*V];for(V=j;V<2*j;V++)O[V]=0;return new a(O,0)};function b(I,j){for(;(I[j]&65535)!=I[j];)I[j+1]+=I[j]>>>16,I[j]&=65535,j++}function S(I,j){this.g=I,this.h=j}function C(I,j){if(x(j))throw Error("division by zero");if(x(I))return new S(m,m);if(_(I))return j=C(E(I),j),new S(E(j.g),E(j.h));if(_(j))return j=C(I,E(j)),new S(E(j.g),j.h);if(30<I.g.length){if(_(I)||_(j))throw Error("slowDivide_ only works with positive integers.");for(var O=p,V=j;0>=V.l(I);)O=P(O),V=P(V);var z=R(O,1),D=R(V,1);for(V=R(V,2),O=R(O,2);!x(V);){var F=D.add(V);0>=F.l(I)&&(z=z.add(O),D=F),V=R(V,1),O=R(O,1)}return j=k(I,z.j(j)),new S(z,j)}for(z=m;0<=I.l(j);){for(O=Math.max(1,Math.floor(I.m()/j.m())),V=Math.ceil(Math.log(O)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),D=d(O),F=D.j(j);_(F)||0<F.l(I);)O-=V,D=d(O),F=D.j(j);x(D)&&(D=p),z=z.add(D),I=k(I,F)}return new S(z,I)}t.A=function(I){return C(this,I).h},t.and=function(I){for(var j=Math.max(this.g.length,I.g.length),O=[],V=0;V<j;V++)O[V]=this.i(V)&I.i(V);return new a(O,this.h&I.h)},t.or=function(I){for(var j=Math.max(this.g.length,I.g.length),O=[],V=0;V<j;V++)O[V]=this.i(V)|I.i(V);return new a(O,this.h|I.h)},t.xor=function(I){for(var j=Math.max(this.g.length,I.g.length),O=[],V=0;V<j;V++)O[V]=this.i(V)^I.i(V);return new a(O,this.h^I.h)};function P(I){for(var j=I.g.length+1,O=[],V=0;V<j;V++)O[V]=I.i(V)<<1|I.i(V-1)>>>31;return new a(O,I.h)}function R(I,j){var O=j>>5;j%=32;for(var V=I.g.length-O,z=[],D=0;D<V;D++)z[D]=0<j?I.i(D+O)>>>j|I.i(D+O+1)<<32-j:I.i(D+O);return new a(z,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,p4=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,kc=a}).apply(typeof Cj<"u"?Cj:typeof self<"u"?self:typeof window<"u"?window:{});var jy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var g4,sm,y4,hx,Tk,x4,v4,b4;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,T,M){return g==Array.prototype||g==Object.prototype||(g[T]=M.value),g};function n(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof jy=="object"&&jy];for(var T=0;T<g.length;++T){var M=g[T];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var r=n(this);function s(g,T){if(T)e:{var M=r;g=g.split(".");for(var $=0;$<g.length-1;$++){var Z=g[$];if(!(Z in M))break e;M=M[Z]}g=g[g.length-1],$=M[g],T=T($),T!=$&&T!=null&&e(M,g,{configurable:!0,writable:!0,value:T})}}function i(g,T){g instanceof String&&(g+="");var M=0,$=!1,Z={next:function(){if(!$&&M<g.length){var se=M++;return{value:T(se,g[se]),done:!1}}return $=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}s("Array.prototype.values",function(g){return g||function(){return i(this,function(T,M){return M})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(g){var T=typeof g;return T=T!="object"?T:g?Array.isArray(g)?"array":T:"null",T=="array"||T=="object"&&typeof g.length=="number"}function d(g){var T=typeof g;return T=="object"&&g!=null||T=="function"}function f(g,T,M){return g.call.apply(g.bind,arguments)}function m(g,T,M){if(!g)throw Error();if(2<arguments.length){var $=Array.prototype.slice.call(arguments,2);return function(){var Z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Z,$),g.apply(T,Z)}}return function(){return g.apply(T,arguments)}}function p(g,T,M){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,p.apply(null,arguments)}function v(g,T){var M=Array.prototype.slice.call(arguments,1);return function(){var $=M.slice();return $.push.apply($,arguments),g.apply(this,$)}}function x(g,T){function M(){}M.prototype=T.prototype,g.aa=T.prototype,g.prototype=new M,g.prototype.constructor=g,g.Qb=function($,Z,se){for(var Se=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)Se[Vt-2]=arguments[Vt];return T.prototype[Z].apply($,Se)}}function _(g){const T=g.length;if(0<T){const M=Array(T);for(let $=0;$<T;$++)M[$]=g[$];return M}return[]}function E(g,T){for(let M=1;M<arguments.length;M++){const $=arguments[M];if(u($)){const Z=g.length||0,se=$.length||0;g.length=Z+se;for(let Se=0;Se<se;Se++)g[Z+Se]=$[Se]}else g.push($)}}class k{constructor(T,M){this.i=T,this.j=M,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function b(g){return/^[\s\xa0]*$/.test(g)}function S(){var g=l.navigator;return g&&(g=g.userAgent)?g:""}function C(g){return C[" "](g),g}C[" "]=function(){};var P=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function R(g,T,M){for(const $ in g)T.call(M,g[$],$,g)}function I(g,T){for(const M in g)T.call(void 0,g[M],M,g)}function j(g){const T={};for(const M in g)T[M]=g[M];return T}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(g,T){let M,$;for(let Z=1;Z<arguments.length;Z++){$=arguments[Z];for(M in $)g[M]=$[M];for(let se=0;se<O.length;se++)M=O[se],Object.prototype.hasOwnProperty.call($,M)&&(g[M]=$[M])}}function z(g){var T=1;g=g.split(":");const M=[];for(;0<T&&g.length;)M.push(g.shift()),T--;return g.length&&M.push(g.join(":")),M}function D(g){l.setTimeout(()=>{throw g},0)}function F(){var g=Q;let T=null;return g.g&&(T=g.g,g.g=g.g.next,g.g||(g.h=null),T.next=null),T}class ee{constructor(){this.h=this.g=null}add(T,M){const $=ue.get();$.set(T,M),this.h?this.h.next=$:this.g=$,this.h=$}}var ue=new k(()=>new ve,g=>g.reset());class ve{constructor(){this.next=this.g=this.h=null}set(T,M){this.h=T,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,H=!1,Q=new ee,W=()=>{const g=l.Promise.resolve(void 0);ae=()=>{g.then(re)}};var re=()=>{for(var g;g=F();){try{g.h.call(g.g)}catch(M){D(M)}var T=ue;T.j(g),100>T.h&&(T.h++,g.next=T.g,T.g=g)}H=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ye(g,T){this.type=g,this.g=this.target=T,this.defaultPrevented=!1}ye.prototype.h=function(){this.defaultPrevented=!0};var Me=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,T=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const M=()=>{};l.addEventListener("test",M,T),l.removeEventListener("test",M,T)}catch{}return g}();function Fe(g,T){if(ye.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var M=this.type=g.type,$=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=T,T=g.relatedTarget){if(P){e:{try{C(T.nodeName);var Z=!0;break e}catch{}Z=!1}Z||(T=null)}}else M=="mouseover"?T=g.fromElement:M=="mouseout"&&(T=g.toElement);this.relatedTarget=T,$?(this.clientX=$.clientX!==void 0?$.clientX:$.pageX,this.clientY=$.clientY!==void 0?$.clientY:$.pageY,this.screenX=$.screenX||0,this.screenY=$.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:G[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&Fe.aa.h.call(this)}}x(Fe,ye);var G={2:"touch",3:"pen",4:"mouse"};Fe.prototype.h=function(){Fe.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var le="closure_listenable_"+(1e6*Math.random()|0),De=0;function Qe(g,T,M,$,Z){this.listener=g,this.proxy=null,this.src=T,this.type=M,this.capture=!!$,this.ha=Z,this.key=++De,this.da=this.fa=!1}function ie(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Ae(g){this.src=g,this.g={},this.h=0}Ae.prototype.add=function(g,T,M,$,Z){var se=g.toString();g=this.g[se],g||(g=this.g[se]=[],this.h++);var Se=me(g,T,$,Z);return-1<Se?(T=g[Se],M||(T.fa=!1)):(T=new Qe(T,this.src,se,!!$,Z),T.fa=M,g.push(T)),T};function Ge(g,T){var M=T.type;if(M in g.g){var $=g.g[M],Z=Array.prototype.indexOf.call($,T,void 0),se;(se=0<=Z)&&Array.prototype.splice.call($,Z,1),se&&(ie(T),g.g[M].length==0&&(delete g.g[M],g.h--))}}function me(g,T,M,$){for(var Z=0;Z<g.length;++Z){var se=g[Z];if(!se.da&&se.listener==T&&se.capture==!!M&&se.ha==$)return Z}return-1}var dt="closure_lm_"+(1e6*Math.random()|0),Dt={};function dr(g,T,M,$,Z){if(Array.isArray(T)){for(var se=0;se<T.length;se++)dr(g,T[se],M,$,Z);return null}return M=xe(M),g&&g[le]?g.K(T,M,d($)?!!$.capture:!1,Z):Wn(g,T,M,!1,$,Z)}function Wn(g,T,M,$,Z,se){if(!T)throw Error("Invalid event type");var Se=d(Z)?!!Z.capture:!!Z,Vt=Ee(g);if(Vt||(g[dt]=Vt=new Ae(g)),M=Vt.add(T,M,$,Se,se),M.proxy)return M;if($=st(),M.proxy=$,$.src=g,$.listener=M,g.addEventListener)Me||(Z=Se),Z===void 0&&(Z=!1),g.addEventListener(T.toString(),$,Z);else if(g.attachEvent)g.attachEvent(K(T.toString()),$);else if(g.addListener&&g.removeListener)g.addListener($);else throw Error("addEventListener and attachEvent are unavailable.");return M}function st(){function g(M){return T.call(g.src,g.listener,M)}const T=ne;return g}function pe(g,T,M,$,Z){if(Array.isArray(T))for(var se=0;se<T.length;se++)pe(g,T[se],M,$,Z);else $=d($)?!!$.capture:!!$,M=xe(M),g&&g[le]?(g=g.i,T=String(T).toString(),T in g.g&&(se=g.g[T],M=me(se,M,$,Z),-1<M&&(ie(se[M]),Array.prototype.splice.call(se,M,1),se.length==0&&(delete g.g[T],g.h--)))):g&&(g=Ee(g))&&(T=g.g[T.toString()],g=-1,T&&(g=me(T,M,$,Z)),(M=-1<g?T[g]:null)&&U(M))}function U(g){if(typeof g!="number"&&g&&!g.da){var T=g.src;if(T&&T[le])Ge(T.i,g);else{var M=g.type,$=g.proxy;T.removeEventListener?T.removeEventListener(M,$,g.capture):T.detachEvent?T.detachEvent(K(M),$):T.addListener&&T.removeListener&&T.removeListener($),(M=Ee(T))?(Ge(M,g),M.h==0&&(M.src=null,T[dt]=null)):ie(g)}}}function K(g){return g in Dt?Dt[g]:Dt[g]="on"+g}function ne(g,T){if(g.da)g=!0;else{T=new Fe(T,this);var M=g.listener,$=g.ha||g.src;g.fa&&U(g),g=M.call($,T)}return g}function Ee(g){return g=g[dt],g instanceof Ae?g:null}var Ne="__closure_events_fn_"+(1e9*Math.random()>>>0);function xe(g){return typeof g=="function"?g:(g[Ne]||(g[Ne]=function(T){return g.handleEvent(T)}),g[Ne])}function je(){he.call(this),this.i=new Ae(this),this.M=this,this.F=null}x(je,he),je.prototype[le]=!0,je.prototype.removeEventListener=function(g,T,M,$){pe(this,g,T,M,$)};function et(g,T){var M,$=g.F;if($)for(M=[];$;$=$.F)M.push($);if(g=g.M,$=T.type||T,typeof T=="string")T=new ye(T,g);else if(T instanceof ye)T.target=T.target||g;else{var Z=T;T=new ye($,g),V(T,Z)}if(Z=!0,M)for(var se=M.length-1;0<=se;se--){var Se=T.g=M[se];Z=Tt(Se,$,!0,T)&&Z}if(Se=T.g=g,Z=Tt(Se,$,!0,T)&&Z,Z=Tt(Se,$,!1,T)&&Z,M)for(se=0;se<M.length;se++)Se=T.g=M[se],Z=Tt(Se,$,!1,T)&&Z}je.prototype.N=function(){if(je.aa.N.call(this),this.i){var g=this.i,T;for(T in g.g){for(var M=g.g[T],$=0;$<M.length;$++)ie(M[$]);delete g.g[T],g.h--}}this.F=null},je.prototype.K=function(g,T,M,$){return this.i.add(String(g),T,!1,M,$)},je.prototype.L=function(g,T,M,$){return this.i.add(String(g),T,!0,M,$)};function Tt(g,T,M,$){if(T=g.i.g[String(T)],!T)return!0;T=T.concat();for(var Z=!0,se=0;se<T.length;++se){var Se=T[se];if(Se&&!Se.da&&Se.capture==M){var Vt=Se.listener,Vn=Se.ha||Se.src;Se.fa&&Ge(g.i,Se),Z=Vt.call(Vn,$)!==!1&&Z}}return Z&&!$.defaultPrevented}function hr(g,T,M){if(typeof g=="function")M&&(g=p(g,M));else if(g&&typeof g.handleEvent=="function")g=p(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:l.setTimeout(g,T||0)}function Mi(g){g.g=hr(()=>{g.g=null,g.i&&(g.i=!1,Mi(g))},g.l);const T=g.h;g.h=null,g.m.apply(null,T)}class gs extends he{constructor(T,M){super(),this.m=T,this.l=M,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:Mi(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function po(g){he.call(this),this.h=g,this.g={}}x(po,he);var go=[];function Oi(g){R(g.g,function(T,M){this.g.hasOwnProperty(M)&&U(T)},g),g.g={}}po.prototype.N=function(){po.aa.N.call(this),Oi(this)},po.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fa=l.JSON.stringify,Su=l.JSON.parse,yo=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function ma(){}ma.prototype.h=null;function Pg(g){return g.h||(g.h=g.i())}function Yh(){}var pa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Tu(){ye.call(this,"d")}x(Tu,ye);function Xh(){ye.call(this,"c")}x(Xh,ye);var xo={},Lg=null;function Eu(){return Lg=Lg||new je}xo.La="serverreachability";function Mg(g){ye.call(this,xo.La,g)}x(Mg,ye);function $l(g){const T=Eu();et(T,new Mg(T))}xo.STAT_EVENT="statevent";function Cu(g,T){ye.call(this,xo.STAT_EVENT,g),this.stat=T}x(Cu,ye);function fr(g){const T=Eu();et(T,new Cu(T,g))}xo.Ma="timingevent";function Og(g,T){ye.call(this,xo.Ma,g),this.size=T}x(Og,ye);function Ul(g,T){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},T)}function ql(){this.g=!0}ql.prototype.xa=function(){this.g=!1};function Fs(g,T,M,$,Z,se){g.info(function(){if(g.g)if(se)for(var Se="",Vt=se.split("&"),Vn=0;Vn<Vt.length;Vn++){var Et=Vt[Vn].split("=");if(1<Et.length){var qt=Et[0];Et=Et[1];var mn=qt.split("_");Se=2<=mn.length&&mn[1]=="type"?Se+(qt+"="+Et+"&"):Se+(qt+"=redacted&")}}else Se=null;else Se=se;return"XMLHTTP REQ ("+$+") [attempt "+Z+"]: "+T+`
`+M+`
`+Se})}function He(g,T,M,$,Z,se,Se){g.info(function(){return"XMLHTTP RESP ("+$+") [ attempt "+Z+"]: "+T+`
`+M+`
`+se+" "+Se})}function vo(g,T,M,$){g.info(function(){return"XMLHTTP TEXT ("+T+"): "+Vg(g,M)+($?" "+$:"")})}function Dg(g,T){g.info(function(){return"TIMEOUT: "+T})}ql.prototype.info=function(){};function Vg(g,T){if(!g.g)return T;if(!T)return null;try{var M=JSON.parse(T);if(M){for(g=0;g<M.length;g++)if(Array.isArray(M[g])){var $=M[g];if(!(2>$.length)){var Z=$[1];if(Array.isArray(Z)&&!(1>Z.length)){var se=Z[0];if(se!="noop"&&se!="stop"&&se!="close")for(var Se=1;Se<Z.length;Se++)Z[Se]=""}}}}return fa(M)}catch{return T}}var Wl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ju={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Iu;function ci(){}x(ci,ma),ci.prototype.g=function(){return new XMLHttpRequest},ci.prototype.i=function(){return{}},Iu=new ci;function ui(g,T,M,$){this.j=g,this.i=T,this.l=M,this.R=$||1,this.U=new po(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fg}function Fg(){this.i=null,this.g="",this.h=!1}var zg={},Jh={};function ef(g,T,M){g.L=1,g.v=Bs(Nn(T)),g.m=M,g.P=!0,tf(g,null)}function tf(g,T){g.F=Date.now(),Ru(g),g.A=Nn(g.v);var M=g.A,$=g.R;Array.isArray($)||($=[String($)]),Ug(M.i,"t",$),g.C=0,M=g.j.J,g.h=new Fg,g.g=Zg(g.j,M?T:null,!g.m),0<g.O&&(g.M=new gs(p(g.Y,g,g.g),g.O)),T=g.U,M=g.g,$=g.ca;var Z="readystatechange";Array.isArray(Z)||(Z&&(go[0]=Z.toString()),Z=go);for(var se=0;se<Z.length;se++){var Se=dr(M,Z[se],$||T.handleEvent,!1,T.h||T);if(!Se)break;T.g[Se.key]=Se}T=g.H?j(g.H):{},g.m?(g.u||(g.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,T)):(g.u="GET",g.g.ea(g.A,g.u,null,T)),$l(),Fs(g.i,g.u,g.A,g.l,g.R,g.m)}ui.prototype.ca=function(g){g=g.target;const T=this.M;T&&Or(g)==3?T.j():this.Y(g)},ui.prototype.Y=function(g){try{if(g==this.g)e:{const mn=Or(this.g);var T=this.g.Ba();const wa=this.g.Z();if(!(3>mn)&&(mn!=3||this.g&&(this.h.h||this.g.oa()||xf(this.g)))){this.J||mn!=4||T==7||(T==8||0>=wa?$l(3):$l(2)),nf(this);var M=this.g.Z();this.X=M;t:if(Bg(this)){var $=xf(this.g);g="";var Z=$.length,se=Or(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){bo(this),Hl(this);var Se="";break t}this.h.i=new l.TextDecoder}for(T=0;T<Z;T++)this.h.h=!0,g+=this.h.i.decode($[T],{stream:!(se&&T==Z-1)});$.length=0,this.h.g+=g,this.C=0,Se=this.h.g}else Se=this.g.oa();if(this.o=M==200,He(this.i,this.u,this.A,this.l,this.R,mn,M),this.o){if(this.T&&!this.K){t:{if(this.g){var Vt,Vn=this.g;if((Vt=Vn.g?Vn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Vt)){var Et=Vt;break t}}Et=null}if(M=Et)vo(this.i,this.l,M,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gl(this,M);else{this.o=!1,this.s=3,fr(12),bo(this),Hl(this);break e}}if(this.P){M=!0;let An;for(;!this.J&&this.C<Se.length;)if(An=Au(this,Se),An==Jh){mn==4&&(this.s=4,fr(14),M=!1),vo(this.i,this.l,null,"[Incomplete Response]");break}else if(An==zg){this.s=4,fr(15),vo(this.i,this.l,Se,"[Invalid Chunk]"),M=!1;break}else vo(this.i,this.l,An,null),Gl(this,An);if(Bg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mn!=4||Se.length!=0||this.h.h||(this.s=1,fr(16),M=!1),this.o=this.o&&M,!M)vo(this.i,this.l,Se,"[Invalid Chunked Response]"),bo(this),Hl(this);else if(0<Se.length&&!this.W){this.W=!0;var qt=this.j;qt.g==this&&qt.ba&&!qt.M&&(qt.j.info("Great, no buffering proxy detected. Bytes received: "+Se.length),Bu(qt),qt.M=!0,fr(11))}}else vo(this.i,this.l,Se,null),Gl(this,Se);mn==4&&bo(this),this.o&&!this.J&&(mn==4?bf(this.j,this):(this.o=!1,Ru(this)))}else Mb(this.g),M==400&&0<Se.indexOf("Unknown SID")?(this.s=3,fr(12)):(this.s=0,fr(13)),bo(this),Hl(this)}}}catch{}finally{}};function Bg(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function Au(g,T){var M=g.C,$=T.indexOf(`
`,M);return $==-1?Jh:(M=Number(T.substring(M,$)),isNaN(M)?zg:($+=1,$+M>T.length?Jh:(T=T.slice($,$+M),g.C=$+M,T)))}ui.prototype.cancel=function(){this.J=!0,bo(this)};function Ru(g){g.S=Date.now()+g.I,$g(g,g.I)}function $g(g,T){if(g.B!=null)throw Error("WatchDog timer not null");g.B=Ul(p(g.ba,g),T)}function nf(g){g.B&&(l.clearTimeout(g.B),g.B=null)}ui.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(Dg(this.i,this.A),this.L!=2&&($l(),fr(17)),bo(this),this.s=2,Hl(this)):$g(this,this.S-g)};function Hl(g){g.j.G==0||g.J||bf(g.j,g)}function bo(g){nf(g);var T=g.M;T&&typeof T.ma=="function"&&T.ma(),g.M=null,Oi(g.U),g.g&&(T=g.g,g.g=null,T.abort(),T.ma())}function Gl(g,T){try{var M=g.j;if(M.G!=0&&(M.g==g||kt(M.h,g))){if(!g.K&&kt(M.h,g)&&M.G==3){try{var $=M.Da.g.parse(T)}catch{$=null}if(Array.isArray($)&&$.length==3){var Z=$;if(Z[0]==0){e:if(!M.u){if(M.g)if(M.g.F+3e3<g.F)Uu(M),Fu(M);else break e;zu(M),fr(18)}}else M.za=Z[1],0<M.za-M.T&&37500>Z[2]&&M.F&&M.v==0&&!M.C&&(M.C=Ul(p(M.Za,M),6e3));if(1>=ga(M.h)&&M.ca){try{M.ca()}catch{}M.ca=void 0}}else So(M,11)}else if((g.K||M.g==g)&&Uu(M),!b(T))for(Z=M.Da.g.parse(T),T=0;T<Z.length;T++){let Et=Z[T];if(M.T=Et[0],Et=Et[1],M.G==2)if(Et[0]=="c"){M.K=Et[1],M.ia=Et[2];const qt=Et[3];qt!=null&&(M.la=qt,M.j.info("VER="+M.la));const mn=Et[4];mn!=null&&(M.Aa=mn,M.j.info("SVER="+M.Aa));const wa=Et[5];wa!=null&&typeof wa=="number"&&0<wa&&($=1.5*wa,M.L=$,M.j.info("backChannelRequestTimeoutMs_="+$)),$=M;const An=g.g;if(An){const Wu=An.g?An.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wu){var se=$.h;se.g||Wu.indexOf("spdy")==-1&&Wu.indexOf("quic")==-1&&Wu.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(Kt(se,se.h),se.h=null))}if($.D){const Fi=An.g?An.g.getResponseHeader("X-HTTP-Session-Id"):null;Fi&&($.ya=Fi,it($.I,$.D,Fi))}}M.G=3,M.l&&M.l.ua(),M.ba&&(M.R=Date.now()-g.F,M.j.info("Handshake RTT: "+M.R+"ms")),$=M;var Se=g;if($.qa=qu($,$.J?$.ia:null,$.W),Se.K){Ql($.h,Se);var Vt=Se,Vn=$.L;Vn&&(Vt.I=Vn),Vt.B&&(nf(Vt),Ru(Vt)),$.g=Se}else fi($);0<M.i.length&&_a(M)}else Et[0]!="stop"&&Et[0]!="close"||So(M,7);else M.G==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?So(M,7):Vu(M):Et[0]!="noop"&&M.l&&M.l.ta(Et),M.v=0)}}$l(4)}catch{}}var Kl=class{constructor(g,T){this.g=g,this.map=T}};function rf(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function sf(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function ga(g){return g.h?1:g.g?g.g.size:0}function kt(g,T){return g.h?g.h==T:g.g?g.g.has(T):!1}function Kt(g,T){g.g?g.g.add(T):g.h=T}function Ql(g,T){g.h&&g.h==T?g.h=null:g.g&&g.g.has(T)&&g.g.delete(T)}rf.prototype.cancel=function(){if(this.i=_o(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function _o(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let T=g.i;for(const M of g.g.values())T=T.concat(M.D);return T}return _(g.i)}function ya(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(u(g)){for(var T=[],M=g.length,$=0;$<M;$++)T.push(g[$]);return T}T=[],M=0;for($ in g)T[M++]=g[$];return T}function of(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(u(g)||typeof g=="string"){var T=[];g=g.length;for(var M=0;M<g;M++)T.push(M);return T}T=[],M=0;for(const $ in g)T[M++]=$;return T}}}function ct(g,T){if(g.forEach&&typeof g.forEach=="function")g.forEach(T,void 0);else if(u(g)||typeof g=="string")Array.prototype.forEach.call(g,T,void 0);else for(var M=of(g),$=ya(g),Z=$.length,se=0;se<Z;se++)T.call(void 0,$[se],M&&M[se],g)}var cn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function af(g,T){if(g){g=g.split("&");for(var M=0;M<g.length;M++){var $=g[M].indexOf("="),Z=null;if(0<=$){var se=g[M].substring(0,$);Z=g[M].substring($+1)}else se=g[M];T(se,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function zs(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof zs){this.h=g.h,Pu(this,g.j),this.o=g.o,this.g=g.g,wo(this,g.s),this.l=g.l;var T=g.i,M=new ko;M.i=T.i,T.g&&(M.g=new Map(T.g),M.h=T.h),Di(this,M),this.m=g.m}else g&&(T=String(g).match(cn))?(this.h=!1,Pu(this,T[1]||"",!0),this.o=di(T[2]||""),this.g=di(T[3]||"",!0),wo(this,T[4]),this.l=di(T[5]||"",!0),Di(this,T[6]||"",!0),this.m=di(T[7]||"")):(this.h=!1,this.i=new ko(null,this.h))}zs.prototype.toString=function(){var g=[],T=this.j;T&&g.push(hi(T,xa,!0),":");var M=this.g;return(M||T=="file")&&(g.push("//"),(T=this.o)&&g.push(hi(T,xa,!0),"@"),g.push(encodeURIComponent(String(M)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.s,M!=null&&g.push(":",String(M))),(M=this.l)&&(this.g&&M.charAt(0)!="/"&&g.push("/"),g.push(hi(M,M.charAt(0)=="/"?uf:cf,!0))),(M=this.i.toString())&&g.push("?",M),(M=this.m)&&g.push("#",hi(M,df)),g.join("")};function Nn(g){return new zs(g)}function Pu(g,T,M){g.j=M?di(T,!0):T,g.j&&(g.j=g.j.replace(/:$/,""))}function wo(g,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);g.s=T}else g.s=null}function Di(g,T,M){T instanceof ko?(g.i=T,$s(g.i,g.h)):(M||(T=hi(T,Lu)),g.i=new ko(T,g.h))}function it(g,T,M){g.i.set(T,M)}function Bs(g){return it(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function di(g,T){return g?T?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function hi(g,T,M){return typeof g=="string"?(g=encodeURI(g).replace(T,lf),M&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function lf(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var xa=/[#\/\?@]/g,cf=/[#\?:]/g,uf=/[#\?]/g,Lu=/[#\?@]/g,df=/#/g;function ko(g,T){this.h=this.g=null,this.i=g||null,this.j=!!T}function ys(g){g.g||(g.g=new Map,g.h=0,g.i&&af(g.i,function(T,M){g.add(decodeURIComponent(T.replace(/\+/g," ")),M)}))}t=ko.prototype,t.add=function(g,T){ys(this),this.i=null,g=Xe(this,g);var M=this.g.get(g);return M||this.g.set(g,M=[]),M.push(T),this.h+=1,this};function hf(g,T){ys(g),T=Xe(g,T),g.g.has(T)&&(g.i=null,g.h-=g.g.get(T).length,g.g.delete(T))}function Mu(g,T){return ys(g),T=Xe(g,T),g.g.has(T)}t.forEach=function(g,T){ys(this),this.g.forEach(function(M,$){M.forEach(function(Z){g.call(T,Z,$,this)},this)},this)},t.na=function(){ys(this);const g=Array.from(this.g.values()),T=Array.from(this.g.keys()),M=[];for(let $=0;$<T.length;$++){const Z=g[$];for(let se=0;se<Z.length;se++)M.push(T[$])}return M},t.V=function(g){ys(this);let T=[];if(typeof g=="string")Mu(this,g)&&(T=T.concat(this.g.get(Xe(this,g))));else{g=Array.from(this.g.values());for(let M=0;M<g.length;M++)T=T.concat(g[M])}return T},t.set=function(g,T){return ys(this),this.i=null,g=Xe(this,g),Mu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[T]),this.h+=1,this},t.get=function(g,T){return g?(g=this.V(g),0<g.length?String(g[0]):T):T};function Ug(g,T,M){hf(g,T),0<M.length&&(g.i=null,g.g.set(Xe(g,T),_(M)),g.h+=M.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],T=Array.from(this.g.keys());for(var M=0;M<T.length;M++){var $=T[M];const se=encodeURIComponent(String($)),Se=this.V($);for($=0;$<Se.length;$++){var Z=se;Se[$]!==""&&(Z+="="+encodeURIComponent(String(Se[$]))),g.push(Z)}}return this.i=g.join("&")};function Xe(g,T){return T=String(T),g.j&&(T=T.toLowerCase()),T}function $s(g,T){T&&!g.j&&(ys(g),g.i=null,g.g.forEach(function(M,$){var Z=$.toLowerCase();$!=Z&&(hf(this,$),Ug(this,Z,M))},g)),g.j=T}function Ut(g,T){const M=new ql;if(l.Image){const $=new Image;$.onload=v(Us,M,"TestLoadImage: loaded",!0,T,$),$.onerror=v(Us,M,"TestLoadImage: error",!1,T,$),$.onabort=v(Us,M,"TestLoadImage: abort",!1,T,$),$.ontimeout=v(Us,M,"TestLoadImage: timeout",!1,T,$),l.setTimeout(function(){$.ontimeout&&$.ontimeout()},1e4),$.src=g}else T(!1)}function qg(g,T){const M=new ql,$=new AbortController,Z=setTimeout(()=>{$.abort(),Us(M,"TestPingServer: timeout",!1,T)},1e4);fetch(g,{signal:$.signal}).then(se=>{clearTimeout(Z),se.ok?Us(M,"TestPingServer: ok",!0,T):Us(M,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(Z),Us(M,"TestPingServer: error",!1,T)})}function Us(g,T,M,$,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),$(M)}catch{}}function ff(){this.g=new yo}function mf(g,T,M){const $=M||"";try{ct(g,function(Z,se){let Se=Z;d(Z)&&(Se=fa(Z)),T.push($+se+"="+encodeURIComponent(Se))})}catch(Z){throw T.push($+"type="+encodeURIComponent("_badmap")),Z}}function qs(g){this.l=g.Ub||null,this.j=g.eb||!1}x(qs,ma),qs.prototype.g=function(){return new va(this.l,this.j)},qs.prototype.i=function(g){return function(){return g}}({});function va(g,T){je.call(this),this.D=g,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(va,je),t=va.prototype,t.open=function(g,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=T,this.readyState=1,xs(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(T.body=g),(this.D||l).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fn(this)),this.readyState=0},t.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,xs(this)),this.g&&(this.readyState=3,xs(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ba(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function ba(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}t.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var T=g.value?g.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!g.done}))&&(this.response=this.responseText+=T)}g.done?fn(this):xs(this),this.readyState==3&&ba(this)}},t.Ra=function(g){this.g&&(this.response=this.responseText=g,fn(this))},t.Qa=function(g){this.g&&(this.response=g,fn(this))},t.ga=function(){this.g&&fn(this)};function fn(g){g.readyState=4,g.l=null,g.j=null,g.v=null,xs(g)}t.setRequestHeader=function(g,T){this.u.append(g,T)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],T=this.h.entries();for(var M=T.next();!M.done;)M=M.value,g.push(M[0]+": "+M[1]),M=T.next();return g.join(`\r
`)};function xs(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(va.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function pf(g){let T="";return R(g,function(M,$){T+=$,T+=":",T+=M,T+=`\r
`}),T}function Ou(g,T,M){e:{for($ in M){var $=!1;break e}$=!0}$||(M=pf(M),typeof g=="string"?M!=null&&encodeURIComponent(String(M)):it(g,T,M))}function un(g){je.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(un,je);var Wg=/^https?$/i,gf=["POST","PUT"];t=un.prototype,t.Ha=function(g){this.J=g},t.ea=function(g,T,M,$){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);T=T?T.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Iu.g(),this.v=this.o?Pg(this.o):Pg(Iu),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(T,String(g),!0),this.B=!1}catch(se){Hg(this,se);return}if(g=M||"",M=new Map(this.headers),$)if(Object.getPrototypeOf($)===Object.prototype)for(var Z in $)M.set(Z,$[Z]);else if(typeof $.keys=="function"&&typeof $.get=="function")for(const se of $.keys())M.set(se,$.get(se));else throw Error("Unknown input type for opt_headers: "+String($));$=Array.from(M.keys()).find(se=>se.toLowerCase()=="content-type"),Z=l.FormData&&g instanceof l.FormData,!(0<=Array.prototype.indexOf.call(gf,T,void 0))||$||Z||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,Se]of M)this.g.setRequestHeader(se,Se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Yr(this),this.u=!0,this.g.send(g),this.u=!1}catch(se){Hg(this,se)}};function Hg(g,T){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=T,g.m=5,yf(g),Du(g)}function yf(g){g.A||(g.A=!0,et(g,"complete"),et(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,et(this,"complete"),et(this,"abort"),Du(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Du(this,!0)),un.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?_t(this):this.bb())},t.bb=function(){_t(this)};function _t(g){if(g.h&&typeof a<"u"&&(!g.v[1]||Or(g)!=4||g.Z()!=2)){if(g.u&&Or(g)==4)hr(g.Ea,0,g);else if(et(g,"readystatechange"),Or(g)==4){g.h=!1;try{const Se=g.Z();e:switch(Se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var M;if(!(M=T)){var $;if($=Se===0){var Z=String(g.D).match(cn)[1]||null;!Z&&l.self&&l.self.location&&(Z=l.self.location.protocol.slice(0,-1)),$=!Wg.test(Z?Z.toLowerCase():"")}M=$}if(M)et(g,"complete"),et(g,"success");else{g.m=6;try{var se=2<Or(g)?g.g.statusText:""}catch{se=""}g.l=se+" ["+g.Z()+"]",yf(g)}}finally{Du(g)}}}}function Du(g,T){if(g.g){Yr(g);const M=g.g,$=g.v[0]?()=>{}:null;g.g=null,g.v=null,T||et(g,"ready");try{M.onreadystatechange=$}catch{}}}function Yr(g){g.I&&(l.clearTimeout(g.I),g.I=null)}t.isActive=function(){return!!this.g};function Or(g){return g.g?g.g.readyState:0}t.Z=function(){try{return 2<Or(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(g){if(this.g){var T=this.g.responseText;return g&&T.indexOf(g)==0&&(T=T.substring(g.length)),Su(T)}};function xf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Mb(g){const T={};g=(g.g&&2<=Or(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let $=0;$<g.length;$++){if(b(g[$]))continue;var M=z(g[$]);const Z=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const se=T[Z]||[];T[Z]=se,se.push(M)}I(T,function($){return $.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function No(g,T,M){return M&&M.internalChannelParams&&M.internalChannelParams[g]||T}function Gg(g){this.Aa=0,this.i=[],this.j=new ql,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=No("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=No("baseRetryDelayMs",5e3,g),this.cb=No("retryDelaySeedMs",1e4,g),this.Wa=No("forwardChannelMaxRetries",2,g),this.wa=No("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new rf(g&&g.concurrentRequestLimit),this.Da=new ff,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Gg.prototype,t.la=8,t.G=1,t.connect=function(g,T,M,$){fr(0),this.W=g,this.H=T||{},M&&$!==void 0&&(this.H.OSID=M,this.H.OAID=$),this.F=this.X,this.I=qu(this,null,this.W),_a(this)};function Vu(g){if(Kg(g),g.G==3){var T=g.U++,M=Nn(g.I);if(it(M,"SID",g.K),it(M,"RID",T),it(M,"TYPE","terminate"),Zl(g,M),T=new ui(g,g.j,T),T.L=2,T.v=Bs(Nn(M)),M=!1,l.navigator&&l.navigator.sendBeacon)try{M=l.navigator.sendBeacon(T.v.toString(),"")}catch{}!M&&l.Image&&(new Image().src=T.v,M=!0),M||(T.g=Zg(T.j,null),T.g.ea(T.v)),T.F=Date.now(),Ru(T)}Qg(g)}function Fu(g){g.g&&(Bu(g),g.g.cancel(),g.g=null)}function Kg(g){Fu(g),g.u&&(l.clearTimeout(g.u),g.u=null),Uu(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&l.clearTimeout(g.s),g.s=null)}function _a(g){if(!sf(g.h)&&!g.s){g.s=!0;var T=g.Ga;ae||W(),H||(ae(),H=!0),Q.add(T,g),g.B=0}}function Ob(g,T){return ga(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=T.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=Ul(p(g.Ga,g,T),_f(g,g.B)),g.B++,!0)}t.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const Z=new ui(this,this.j,g);let se=this.o;if(this.S&&(se?(se=j(se),V(se,this.S)):se=this.S),this.m!==null||this.O||(Z.H=se,se=null),this.P)e:{for(var T=0,M=0;M<this.i.length;M++){t:{var $=this.i[M];if("__data__"in $.map&&($=$.map.__data__,typeof $=="string")){$=$.length;break t}$=void 0}if($===void 0)break;if(T+=$,4096<T){T=M;break e}if(T===4096||M===this.i.length-1){T=M+1;break e}}T=1e3}else T=1e3;T=vf(this,Z,T),M=Nn(this.I),it(M,"RID",g),it(M,"CVER",22),this.D&&it(M,"X-HTTP-Session-Id",this.D),Zl(this,M),se&&(this.O?T="headers="+encodeURIComponent(String(pf(se)))+"&"+T:this.m&&Ou(M,this.m,se)),Kt(this.h,Z),this.Ua&&it(M,"TYPE","init"),this.P?(it(M,"$req",T),it(M,"SID","null"),Z.T=!0,ef(Z,M,null)):ef(Z,M,T),this.G=2}}else this.G==3&&(g?vs(this,g):this.i.length==0||sf(this.h)||vs(this))};function vs(g,T){var M;T?M=T.l:M=g.U++;const $=Nn(g.I);it($,"SID",g.K),it($,"RID",M),it($,"AID",g.T),Zl(g,$),g.m&&g.o&&Ou($,g.m,g.o),M=new ui(g,g.j,M,g.B+1),g.m===null&&(M.H=g.o),T&&(g.i=T.D.concat(g.i)),T=vf(g,M,1e3),M.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),Kt(g.h,M),ef(M,$,T)}function Zl(g,T){g.H&&R(g.H,function(M,$){it(T,$,M)}),g.l&&ct({},function(M,$){it(T,$,M)})}function vf(g,T,M){M=Math.min(g.i.length,M);var $=g.l?p(g.l.Na,g.l,g):null;e:{var Z=g.i;let se=-1;for(;;){const Se=["count="+M];se==-1?0<M?(se=Z[0].g,Se.push("ofs="+se)):se=0:Se.push("ofs="+se);let Vt=!0;for(let Vn=0;Vn<M;Vn++){let Et=Z[Vn].g;const qt=Z[Vn].map;if(Et-=se,0>Et)se=Math.max(0,Z[Vn].g-100),Vt=!1;else try{mf(qt,Se,"req"+Et+"_")}catch{$&&$(qt)}}if(Vt){$=Se.join("&");break e}}}return g=g.i.splice(0,M),T.D=g,$}function fi(g){if(!g.g&&!g.u){g.Y=1;var T=g.Fa;ae||W(),H||(ae(),H=!0),Q.add(T,g),g.v=0}}function zu(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=Ul(p(g.Fa,g),_f(g,g.v)),g.v++,!0)}t.Fa=function(){if(this.u=null,$u(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=Ul(p(this.ab,this),g)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,fr(10),Fu(this),$u(this))};function Bu(g){g.A!=null&&(l.clearTimeout(g.A),g.A=null)}function $u(g){g.g=new ui(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var T=Nn(g.qa);it(T,"RID","rpc"),it(T,"SID",g.K),it(T,"AID",g.T),it(T,"CI",g.F?"0":"1"),!g.F&&g.ja&&it(T,"TO",g.ja),it(T,"TYPE","xmlhttp"),Zl(g,T),g.m&&g.o&&Ou(T,g.m,g.o),g.L&&(g.g.I=g.L);var M=g.g;g=g.ia,M.L=1,M.v=Bs(Nn(T)),M.m=null,M.P=!0,tf(M,g)}t.Za=function(){this.C!=null&&(this.C=null,Fu(this),zu(this),fr(19))};function Uu(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function bf(g,T){var M=null;if(g.g==T){Uu(g),Bu(g),g.g=null;var $=2}else if(kt(g.h,T))M=T.D,Ql(g.h,T),$=1;else return;if(g.G!=0){if(T.o)if($==1){M=T.m?T.m.length:0,T=Date.now()-T.F;var Z=g.B;$=Eu(),et($,new Og($,M)),_a(g)}else fi(g);else if(Z=T.s,Z==3||Z==0&&0<T.X||!($==1&&Ob(g,T)||$==2&&zu(g)))switch(M&&0<M.length&&(T=g.h,T.i=T.i.concat(M)),Z){case 1:So(g,5);break;case 4:So(g,10);break;case 3:So(g,6);break;default:So(g,2)}}}function _f(g,T){let M=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(M*=2),M*T}function So(g,T){if(g.j.info("Error code "+T),T==2){var M=p(g.fb,g),$=g.Xa;const Z=!$;$=new zs($||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Pu($,"https"),Bs($),Z?Ut($.toString(),M):qg($.toString(),M)}else fr(2);g.G=0,g.l&&g.l.sa(T),Qg(g),Kg(g)}t.fb=function(g){g?(this.j.info("Successfully pinged google.com"),fr(2)):(this.j.info("Failed to ping google.com"),fr(1))};function Qg(g){if(g.G=0,g.ka=[],g.l){const T=_o(g.h);(T.length!=0||g.i.length!=0)&&(E(g.ka,T),E(g.ka,g.i),g.h.i.length=0,_(g.i),g.i.length=0),g.l.ra()}}function qu(g,T,M){var $=M instanceof zs?Nn(M):new zs(M);if($.g!="")T&&($.g=T+"."+$.g),wo($,$.s);else{var Z=l.location;$=Z.protocol,T=T?T+"."+Z.hostname:Z.hostname,Z=+Z.port;var se=new zs(null);$&&Pu(se,$),T&&(se.g=T),Z&&wo(se,Z),M&&(se.l=M),$=se}return M=g.D,T=g.ya,M&&T&&it($,M,T),it($,"VER",g.la),Zl(g,$),$}function Zg(g,T,M){if(T&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=g.Ca&&!g.pa?new un(new qs({eb:M})):new un(g.pa),T.Ha(g.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function wf(){}t=wf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yl(){}Yl.prototype.g=function(g,T){return new Jn(g,T)};function Jn(g,T){je.call(this),this.g=new Gg(T),this.l=g,this.h=T&&T.messageUrlParams||null,g=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(g?g["X-WebChannel-Content-Type"]=T.messageContentType:g={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(g?g["X-WebChannel-Client-Profile"]=T.va:g={"X-WebChannel-Client-Profile":T.va}),this.g.S=g,(g=T&&T.Sb)&&!b(g)&&(this.g.m=g),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!b(T)&&(this.g.D=T,g=this.h,g!==null&&T in g&&(g=this.h,T in g&&delete g[T])),this.j=new Ws(this)}x(Jn,je),Jn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jn.prototype.close=function(){Vu(this.g)},Jn.prototype.o=function(g){var T=this.g;if(typeof g=="string"){var M={};M.__data__=g,g=M}else this.u&&(M={},M.__data__=fa(g),g=M);T.i.push(new Kl(T.Ya++,g)),T.G==3&&_a(T)},Jn.prototype.N=function(){this.g.l=null,delete this.j,Vu(this.g),delete this.g,Jn.aa.N.call(this)};function Vi(g){Tu.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var T=g.__sm__;if(T){e:{for(const M in T){g=M;break e}g=void 0}(this.i=g)&&(g=this.i,T=T!==null&&g in T?T[g]:void 0),this.data=T}else this.data=g}x(Vi,Tu);function Yg(){Xh.call(this),this.status=1}x(Yg,Xh);function Ws(g){this.g=g}x(Ws,wf),Ws.prototype.ua=function(){et(this.g,"a")},Ws.prototype.ta=function(g){et(this.g,new Vi(g))},Ws.prototype.sa=function(g){et(this.g,new Yg)},Ws.prototype.ra=function(){et(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,Jn.prototype.send=Jn.prototype.o,Jn.prototype.open=Jn.prototype.m,Jn.prototype.close=Jn.prototype.close,b4=function(){return new Yl},v4=function(){return Eu()},x4=xo,Tk={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Wl.NO_ERROR=0,Wl.TIMEOUT=8,Wl.HTTP_ERROR=6,hx=Wl,ju.COMPLETE="complete",y4=ju,Yh.EventType=pa,pa.OPEN="a",pa.CLOSE="b",pa.ERROR="c",pa.MESSAGE="d",je.prototype.listen=je.prototype.K,sm=Yh,un.prototype.listenOnce=un.prototype.L,un.prototype.getLastError=un.prototype.Ka,un.prototype.getLastErrorCode=un.prototype.Ba,un.prototype.getStatus=un.prototype.Z,un.prototype.getResponseJson=un.prototype.Oa,un.prototype.getResponseText=un.prototype.oa,un.prototype.send=un.prototype.ea,un.prototype.setWithCredentials=un.prototype.Ha,g4=un}).apply(typeof jy<"u"?jy:typeof self<"u"?self:typeof window<"u"?window:{});const jj="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};sr.UNAUTHENTICATED=new sr(null),sr.GOOGLE_CREDENTIALS=new sr("google-credentials-uid"),sr.FIRST_PARTY=new sr("first-party-uid"),sr.MOCK_USER=new sr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oh="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc=new JN("@firebase/firestore");function sd(){return Bc.logLevel}function fe(t,...e){if(Bc.logLevel<=Nt.DEBUG){const n=e.map(mS);Bc.debug(`Firestore (${Oh}): ${t}`,...n)}}function On(t,...e){if(Bc.logLevel<=Nt.ERROR){const n=e.map(mS);Bc.error(`Firestore (${Oh}): ${t}`,...n)}}function sh(t,...e){if(Bc.logLevel<=Nt.WARN){const n=e.map(mS);Bc.warn(`Firestore (${Oh}): ${t}`,...n)}}function mS(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(t="Unexpected state"){const e=`FIRESTORE (${Oh}) INTERNAL ASSERTION FAILED: `+t;throw On(e),new Error(e)}function We(t,e){t||Be()}function ze(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends du{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ZW{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(sr.UNAUTHENTICATED))}shutdown(){}}class YW{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class XW{constructor(e){this.t=e,this.currentUser=sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){We(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new ji;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ji,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ji)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(We(typeof r.accessToken=="string"),new _4(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return We(e===null||typeof e=="string"),new sr(e)}}class JW{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=sr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class eH{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new JW(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(sr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tH{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nH{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){We(this.o===void 0);const r=i=>{i.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,fe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(We(typeof n.token=="string"),this.R=n.token,new tH(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rH(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=rH(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ot(t,e){return t<e?-1:t>e?1:0}function ih(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function k4(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new we(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new we(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new we(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return bn.fromMillis(Date.now())}static fromDate(e){return bn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new bn(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ke(e)}static min(){return new Ke(new bn(0,0))}static max(){return new Ke(new bn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,n,r){n===void 0?n=0:n>e.length&&Be(),r===void 0?r=e.length-n:r>e.length-n&&Be(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return dp.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof dp?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Mt extends dp{construct(e,n,r){return new Mt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new we(oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Mt(n)}static emptyPath(){return new Mt([])}}const sH=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gn extends dp{construct(e,n,r){return new gn(e,n,r)}static isValidIdentifier(e){return sH.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new gn(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new we(oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new we(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new we(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new we(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gn(n)}static emptyPath(){return new gn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(Mt.fromString(e))}static fromName(e){return new Ie(Mt.fromString(e).popFirst(5))}static empty(){return new Ie(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Mt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new Mt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Ek(t){return t.fields.find(e=>e.kind===2)}function sc(t){return t.fields.filter(e=>e.kind!==2)}d0.UNKNOWN_ID=-1;class fx{constructor(e,n){this.fieldPath=e,this.kind=n}}class hp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new hp(0,Ls.min())}}function N4(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Ke.fromTimestamp(r===1e9?new bn(n+1,0):new bn(n,r));return new Ls(s,Ie.empty(),e)}function S4(t){return new Ls(t.readTime,t.key,-1)}class Ls{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ls(Ke.min(),Ie.empty(),-1)}static max(){return new Ls(Ke.max(),Ie.empty(),-1)}}function pS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ie.comparator(t.documentKey,e.documentKey),n!==0?n:ot(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class E4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pl(t){if(t.code!==oe.FAILED_PRECONDITION||t.message!==T4)throw t;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Be(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new J((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof J?n:J.resolve(n)}catch(n){return J.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):J.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):J.reject(n)}static resolve(e){return new J((n,r)=>{n(e)})}static reject(e){return new J((n,r)=>{r(e)})}static waitFor(e){return new J((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=J.resolve(!1);for(const r of e)n=n.next(s=>s?J.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new J((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{a[d]=f,++l,l===i&&r(a)},f=>s(f))}})}static doWhile(e,n){return new J((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ji,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Tm(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=gS(r.target.error);this.V.reject(new Tm(e,s))}}static open(e,n,r,s){try{return new Rv(n,e.transaction(s,r))}catch(i){throw new Tm(n,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(fe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new oH(n)}}class cl{constructor(e,n,r){this.name=e,this.version=n,this.p=r,cl.S(Yn())===12.2&&On("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return fe("SimpleDb","Removing database:",e),lc(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!TO())return!1;if(cl.v())return!0;const e=Yn(),n=cl.S(e),r=0<n&&n<10,s=C4(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(fe("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const a=i.target.result;n(a)},s.onblocked=()=>{r(new Tm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const a=i.target.error;a.name==="VersionError"?r(new we(oe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new we(oe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Tm(e,a))},s.onupgradeneeded=i=>{fe("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const a=i.target.result;this.p.O(a,s.transaction,i.oldVersion,this.version).next(()=>{fe("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(e);const l=Rv.open(this.db,e,i?"readonly":"readwrite",r),u=s(l).next(d=>(l.g(),d)).catch(d=>(l.abort(d),J.reject(d))).toPromise();return u.catch(()=>{}),await l.m,u}catch(l){const u=l,d=u.name!=="FirebaseError"&&a<3;if(fe("SimpleDb","Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function C4(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class iH{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return lc(this.B.delete())}}class Tm extends we{constructor(e,n){super(oe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ll(t){return t.name==="IndexedDbTransactionError"}class oH{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(fe("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(fe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),lc(r)}add(e){return fe("SimpleDb","ADD",this.store.name,e,e),lc(this.store.add(e))}get(e){return lc(this.store.get(e)).next(n=>(n===void 0&&(n=null),fe("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return fe("SimpleDb","DELETE",this.store.name,e),lc(this.store.delete(e))}count(){return fe("SimpleDb","COUNT",this.store.name),lc(this.store.count())}U(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new J((a,l)=>{i.onerror=u=>{l(u.target.error)},i.onsuccess=u=>{a(u.target.result)}})}{const i=this.cursor(r),a=[];return this.W(i,(l,u)=>{a.push(u)}).next(()=>a)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new J((s,i)=>{r.onerror=a=>{i(a.target.error)},r.onsuccess=a=>{s(a.target.result)}})}j(e,n){fe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.W(s,(i,a,l)=>l.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.W(s,n)}Y(e){const n=this.cursor({});return new J((r,s)=>{n.onerror=i=>{const a=gS(i.target.error);s(a)},n.onsuccess=i=>{const a=i.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():r()}):r()}})}W(e,n){const r=[];return new J((s,i)=>{e.onerror=a=>{i(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void s();const u=new iH(l),d=n(l.primaryKey,l.value,u);if(d instanceof J){const f=d.catch(m=>(u.done(),J.reject(m)));r.push(f)}u.isDone?s():u.K===null?l.continue():l.continue(u.K)}}).next(()=>J.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function lc(t){return new J((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=gS(r.target.error);n(s)}})}let Ij=!1;function gS(t){const e=cl.S(Yn());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new we("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ij||(Ij=!0,setTimeout(()=>{throw r},0)),r}}return t}class aH{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){fe("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{fe("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Ll(n)?fe("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Pl(n)}await this.X(6e4)})}}class lH{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let s=n,i=!0;return J.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return fe("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,s).next(l=>{s-=l,r.add(a)});i=!1})).next(()=>n-s)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const a=i.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(s,i)).next(l=>(fe("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>a.size)}))}re(e,n){let r=e;return n.changes.forEach((s,i)=>{const a=S4(i);pS(a,r)>0&&(r=a)}),new Ls(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}is.oe=-1;function Pv(t){return t==null}function fp(t){return t===0&&1/t==-1/0}function j4(t){return typeof t=="number"&&Number.isInteger(t)&&!fp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Aj(e)),e=cH(t.get(n),e);return Aj(e)}function cH(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Aj(t){return t+""}function Gi(t){const e=t.length;if(We(e>=2),e===2)return We(t.charAt(0)===""&&t.charAt(1)===""),Mt.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const a=t.indexOf("",i);switch((a<0||a>n)&&Be(),t.charAt(a+1)){case"":const l=t.substring(i,a);let u;s.length===0?u=l:(s+=l,u=s,s=""),r.push(u);break;case"":s+=t.substring(i,a),s+="\0";break;case"":s+=t.substring(i,a+1);break;default:Be()}i=a+2}return new Mt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t,e){return[t,qr(e)]}function I4(t,e,n){return[t,qr(e),n]}const uH={},dH=["prefixPath","collectionGroup","readTime","documentId"],hH=["prefixPath","collectionGroup","documentId"],fH=["collectionGroup","readTime","prefixPath","documentId"],mH=["canonicalId","targetId"],pH=["targetId","path"],gH=["path","targetId"],yH=["collectionId","parent"],xH=["indexId","uid"],vH=["uid","sequenceNumber"],bH=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],_H=["indexId","uid","orderedDocumentKey"],wH=["userId","collectionPath","documentId"],kH=["userId","collectionPath","largestBatchId"],NH=["userId","collectionGroup","largestBatchId"],A4=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],SH=[...A4,"documentOverlays"],R4=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],P4=R4,yS=[...P4,"indexConfiguration","indexState","indexEntries"],TH=yS,EH=[...yS,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck extends E4{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Xn(t,e){const n=ze(t);return cl.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function fu(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function CH(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function L4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kn=class jk{constructor(e,n){this.comparator=e,this.root=n||ul.EMPTY}insert(e,n){return new jk(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ul.BLACK,null,null))}remove(e){return new jk(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ul.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Iy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Iy(this.root,e,this.comparator,!1)}getReverseIterator(){return new Iy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Iy(this.root,e,this.comparator,!0)}},Iy=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ul=class Po{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Po.RED,this.left=s??Po.EMPTY,this.right=i??Po.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Po(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Po.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Po.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Po.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Po.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Be();const e=this.left.check();if(e!==this.right.check())throw Be();return e+(this.isRed()?0:1)}};ul.EMPTY=null,ul.RED=!0,ul.BLACK=!1;ul.EMPTY=new class{constructor(){this.size=0}get key(){throw Be()}get value(){throw Be()}get color(){throw Be()}get left(){throw Be()}get right(){throw Be()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ul(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.comparator=e,this.data=new kn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Lj(this.data.getIterator())}getIteratorFrom(e){return new Lj(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ht(this.comparator);return n.data=e,n}}class Lj{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xu(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this.fields=e,e.sort(gn.comparator)}static empty(){return new os([])}unionWith(e){let n=new Ht(gn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new os(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ih(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new M4("Invalid base64 string: "+i):i}}(e);return new Dn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Dn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dn.EMPTY_BYTE_STRING=new Dn("");const jH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function na(t){if(We(!!t),typeof t=="string"){let e=0;const n=jH.exec(t);if(We(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:dn(t.seconds),nanos:dn(t.nanos)}}function dn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function yl(t){return typeof t=="string"?Dn.fromBase64String(t):Dn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function vS(t){const e=t.mapValue.fields.__previous_value__;return xS(e)?vS(e):e}function mp(t){const e=na(t.mapValue.fields.__local_write_time__.timestampValue);return new bn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IH{constructor(e,n,r,s,i,a,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class $c{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new $c("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof $c&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},px={nullValue:"NULL_VALUE"};function Uc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xS(t)?4:O4(t)?9007199254740991:Lv(t)?10:11:Be()}function oo(t,e){if(t===e)return!0;const n=Uc(t);if(n!==Uc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mp(t).isEqual(mp(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=na(s.timestampValue),l=na(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return yl(s.bytesValue).isEqual(yl(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return dn(s.geoPointValue.latitude)===dn(i.geoPointValue.latitude)&&dn(s.geoPointValue.longitude)===dn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return dn(s.integerValue)===dn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=dn(s.doubleValue),l=dn(i.doubleValue);return a===l?fp(a)===fp(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return ih(t.arrayValue.values||[],e.arrayValue.values||[],oo);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Pj(a)!==Pj(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!oo(a[u],l[u])))return!1;return!0}(t,e);default:return Be()}}function pp(t,e){return(t.values||[]).find(n=>oo(n,e))!==void 0}function xl(t,e){if(t===e)return 0;const n=Uc(t),r=Uc(e);if(n!==r)return ot(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ot(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=dn(i.integerValue||i.doubleValue),u=dn(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Mj(t.timestampValue,e.timestampValue);case 4:return Mj(mp(t),mp(e));case 5:return ot(t.stringValue,e.stringValue);case 6:return function(i,a){const l=yl(i),u=yl(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let d=0;d<l.length&&d<u.length;d++){const f=ot(l[d],u[d]);if(f!==0)return f}return ot(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=ot(dn(i.latitude),dn(a.latitude));return l!==0?l:ot(dn(i.longitude),dn(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Oj(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,u,d,f;const m=i.fields||{},p=a.fields||{},v=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=(u=p.value)===null||u===void 0?void 0:u.arrayValue,_=ot(((d=v==null?void 0:v.values)===null||d===void 0?void 0:d.length)||0,((f=x==null?void 0:x.values)===null||f===void 0?void 0:f.length)||0);return _!==0?_:Oj(v,x)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Ga.mapValue&&a===Ga.mapValue)return 0;if(i===Ga.mapValue)return 1;if(a===Ga.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const p=ot(u[m],f[m]);if(p!==0)return p;const v=xl(l[u[m]],d[f[m]]);if(v!==0)return v}return ot(u.length,f.length)}(t.mapValue,e.mapValue);default:throw Be()}}function Mj(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ot(t,e);const n=na(t),r=na(e),s=ot(n.seconds,r.seconds);return s!==0?s:ot(n.nanos,r.nanos)}function Oj(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=xl(n[s],r[s]);if(i)return i}return ot(n.length,r.length)}function oh(t){return Ik(t)}function Ik(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=na(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return yl(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ik(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Ik(n.fields[a])}`;return s+"}"}(t.mapValue):Be()}function gp(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ak(t){return!!t&&"integerValue"in t}function yp(t){return!!t&&"arrayValue"in t}function Dj(t){return!!t&&"nullValue"in t}function Vj(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gx(t){return!!t&&"mapValue"in t}function Lv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Em(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return fu(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Em(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Em(t.arrayValue.values[n]);return e}return Object.assign({},t)}function O4(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const D4={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function AH(t){return"nullValue"in t?px:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?gp($c.empty(),Ie.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Lv(t)?D4:{mapValue:{}}:Be()}function RH(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?gp($c.empty(),Ie.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?D4:"mapValue"in t?Lv(t)?{mapValue:{}}:Ga:Be()}function Fj(t,e){const n=xl(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function zj(t,e){const n=xl(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.value=e}static empty(){return new Ar({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!gx(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Em(n)}setAll(e){let n=gn.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=Em(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());gx(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return oo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];gx(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){fu(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ar(Em(this.value))}}function V4(t){const e=[];return fu(t.fields,(n,r)=>{const s=new gn([n]);if(gx(r)){const i=V4(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new os(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new En(e,0,Ke.min(),Ke.min(),Ke.min(),Ar.empty(),0)}static newFoundDocument(e,n,r,s){return new En(e,1,n,Ke.min(),r,s,0)}static newNoDocument(e,n){return new En(e,2,n,Ke.min(),Ke.min(),Ar.empty(),0)}static newUnknownDocument(e,n){return new En(e,3,n,Ke.min(),Ke.min(),Ar.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ar.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ar.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof En&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new En(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,n){this.position=e,this.inclusive=n}}function Bj(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=Ie.comparator(Ie.fromName(a.referenceValue),n.key):r=xl(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function $j(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!oo(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,n="asc"){this.field=e,this.dir=n}}function PH(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F4=class{};class St extends F4{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new LH(e,n,r):n==="array-contains"?new DH(e,r):n==="in"?new W4(e,r):n==="not-in"?new VH(e,r):n==="array-contains-any"?new FH(e,r):new St(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new MH(e,r):new OH(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(xl(n,this.value)):n!==null&&Uc(this.value)===Uc(n)&&this.matchesComparison(xl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Be()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ft extends F4{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Ft(e,n)}matches(e){return lh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function lh(t){return t.op==="and"}function Rk(t){return t.op==="or"}function bS(t){return z4(t)&&lh(t)}function z4(t){for(const e of t.filters)if(e instanceof Ft)return!1;return!0}function Pk(t){if(t instanceof St)return t.field.canonicalString()+t.op.toString()+oh(t.value);if(bS(t))return t.filters.map(e=>Pk(e)).join(",");{const e=t.filters.map(n=>Pk(n)).join(",");return`${t.op}(${e})`}}function B4(t,e){return t instanceof St?function(r,s){return s instanceof St&&r.op===s.op&&r.field.isEqual(s.field)&&oo(r.value,s.value)}(t,e):t instanceof Ft?function(r,s){return s instanceof Ft&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&B4(a,s.filters[l]),!0):!1}(t,e):void Be()}function $4(t,e){const n=t.filters.concat(e);return Ft.create(n,t.op)}function U4(t){return t instanceof St?function(n){return`${n.field.canonicalString()} ${n.op} ${oh(n.value)}`}(t):t instanceof Ft?function(n){return n.op.toString()+" {"+n.getFilters().map(U4).join(" ,")+"}"}(t):"Filter"}class LH extends St{constructor(e,n,r){super(e,n,r),this.key=Ie.fromName(r.referenceValue)}matches(e){const n=Ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class MH extends St{constructor(e,n){super(e,"in",n),this.keys=q4("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class OH extends St{constructor(e,n){super(e,"not-in",n),this.keys=q4("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function q4(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ie.fromName(r.referenceValue))}class DH extends St{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return yp(n)&&pp(n.arrayValue,this.value)}}class W4 extends St{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&pp(this.value.arrayValue,n)}}class VH extends St{constructor(e,n){super(e,"not-in",n)}matches(e){if(pp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!pp(this.value.arrayValue,n)}}class FH extends St{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!yp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>pp(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zH{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function Lk(t,e=null,n=[],r=[],s=null,i=null,a=null){return new zH(t,e,n,r,s,i,a)}function qc(t){const e=ze(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Pk(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Pv(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>oh(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>oh(r)).join(",")),e.ue=n}return e.ue}function rg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!PH(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!B4(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$j(t.startAt,e.startAt)&&$j(t.endAt,e.endAt)}function h0(t){return Ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function f0(t,e){return t.filters.filter(n=>n instanceof St&&n.field.isEqual(e))}function Uj(t,e,n){let r=px,s=!0;for(const i of f0(t,e)){let a=px,l=!0;switch(i.op){case"<":case"<=":a=AH(i.value);break;case"==":case"in":case">=":a=i.value;break;case">":a=i.value,l=!1;break;case"!=":case"not-in":a=px}Fj({value:r,inclusive:s},{value:a,inclusive:l})<0&&(r=a,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const a=n.position[i];Fj({value:r,inclusive:s},{value:a,inclusive:n.inclusive})<0&&(r=a,s=n.inclusive);break}}return{value:r,inclusive:s}}function qj(t,e,n){let r=Ga,s=!0;for(const i of f0(t,e)){let a=Ga,l=!0;switch(i.op){case">=":case">":a=RH(i.value),l=!1;break;case"==":case"in":case"<=":a=i.value;break;case"<":a=i.value,l=!1;break;case"!=":case"not-in":a=Ga}zj({value:r,inclusive:s},{value:a,inclusive:l})>0&&(r=a,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const a=n.position[i];zj({value:r,inclusive:s},{value:a,inclusive:n.inclusive})>0&&(r=a,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function H4(t,e,n,r,s,i,a,l){return new mu(t,e,n,r,s,i,a,l)}function sg(t){return new mu(t)}function Wj(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function G4(t){return t.collectionGroup!==null}function Cm(t){const e=ze(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Ht(gn.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new xp(i,r))}),n.has(gn.keyField().canonicalString())||e.ce.push(new xp(gn.keyField(),r))}return e.ce}function As(t){const e=ze(t);return e.le||(e.le=K4(e,Cm(t))),e.le}function BH(t){const e=ze(t);return e.he||(e.he=K4(e,t.explicitOrderBy)),e.he}function K4(t,e){if(t.limitType==="F")return Lk(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new xp(s.field,i)});const n=t.endAt?new ah(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ah(t.startAt.position,t.startAt.inclusive):null;return Lk(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Mk(t,e){const n=t.filters.concat([e]);return new mu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function m0(t,e,n){return new mu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Mv(t,e){return rg(As(t),As(e))&&t.limitType===e.limitType}function Q4(t){return`${qc(As(t))}|lt:${t.limitType}`}function id(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>U4(s)).join(", ")}]`),Pv(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>oh(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>oh(s)).join(",")),`Target(${r})`}(As(t))}; limitType=${t.limitType})`}function ig(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ie.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Cm(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,u){const d=Bj(a,l,u);return a.inclusive?d<=0:d<0}(r.startAt,Cm(r),s)||r.endAt&&!function(a,l,u){const d=Bj(a,l,u);return a.inclusive?d>=0:d>0}(r.endAt,Cm(r),s))}(t,e)}function Z4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Y4(t){return(e,n)=>{let r=!1;for(const s of Cm(t)){const i=$H(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function $H(t,e,n){const r=t.field.isKeyField()?Ie.comparator(e.key,n.key):function(i,a,l){const u=a.data.field(i),d=l.data.field(i);return u!==null&&d!==null?xl(u,d):Be()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Be()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){fu(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return L4(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UH=new kn(Ie.comparator);function Ts(){return UH}const X4=new kn(Ie.comparator);function im(...t){let e=X4;for(const n of t)e=e.insert(n.key,n);return e}function J4(t){let e=X4;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ki(){return jm()}function eD(){return jm()}function jm(){return new Ml(t=>t.toString(),(t,e)=>t.isEqual(e))}const qH=new kn(Ie.comparator),WH=new Ht(Ie.comparator);function pt(...t){let e=WH;for(const n of t)e=e.add(n);return e}const HH=new Ht(ot);function _S(){return HH}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fp(e)?"-0":e}}function tD(t){return{integerValue:""+t}}function nD(t,e){return j4(e)?tD(e):wS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(){this._=void 0}}function GH(t,e,n){return t instanceof ch?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&xS(i)&&(i=vS(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof Wc?sD(t,e):t instanceof Hc?iD(t,e):function(s,i){const a=rD(s,i),l=Hj(a)+Hj(s.Pe);return Ak(a)&&Ak(s.Pe)?tD(l):wS(s.serializer,l)}(t,e)}function KH(t,e,n){return t instanceof Wc?sD(t,e):t instanceof Hc?iD(t,e):n}function rD(t,e){return t instanceof uh?function(r){return Ak(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ch extends Ov{}class Wc extends Ov{constructor(e){super(),this.elements=e}}function sD(t,e){const n=oD(e);for(const r of t.elements)n.some(s=>oo(s,r))||n.push(r);return{arrayValue:{values:n}}}class Hc extends Ov{constructor(e){super(),this.elements=e}}function iD(t,e){let n=oD(e);for(const r of t.elements)n=n.filter(s=>!oo(s,r));return{arrayValue:{values:n}}}class uh extends Ov{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Hj(t){return dn(t.integerValue||t.doubleValue)}function oD(t){return yp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e,n){this.field=e,this.transform=n}}function QH(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Wc&&s instanceof Wc||r instanceof Hc&&s instanceof Hc?ih(r.elements,s.elements,oo):r instanceof uh&&s instanceof uh?oo(r.Pe,s.Pe):r instanceof ch&&s instanceof ch}(t.transform,e.transform)}class ZH{constructor(e,n){this.version=e,this.transformResults=n}}class Qn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Qn}static exists(e){return new Qn(void 0,e)}static updateTime(e){return new Qn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yx(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Dv{}function aD(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ag(t.key,Qn.none()):new Dh(t.key,t.data,Qn.none());{const n=t.data,r=Ar.empty();let s=new Ht(gn.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new ua(t.key,r,new os(s.toArray()),Qn.none())}}function YH(t,e,n){t instanceof Dh?function(s,i,a){const l=s.value.clone(),u=Kj(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ua?function(s,i,a){if(!yx(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=Kj(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(lD(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Im(t,e,n,r){return t instanceof Dh?function(i,a,l,u){if(!yx(i.precondition,a))return l;const d=i.value.clone(),f=Qj(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ua?function(i,a,l,u){if(!yx(i.precondition,a))return l;const d=Qj(i.fieldTransforms,u,a),f=a.data;return f.setAll(lD(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,a,l){return yx(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function XH(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=rD(r.transform,s||null);i!=null&&(n===null&&(n=Ar.empty()),n.set(r.field,i))}return n||null}function Gj(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ih(r,s,(i,a)=>QH(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Dh extends Dv{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ua extends Dv{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function lD(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Kj(t,e,n){const r=new Map;We(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,KH(a,l,n[s]))}return r}function Qj(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,GH(i,a,e))}return r}class ag extends Dv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cD extends Dv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&YH(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Im(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Im(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=eD();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=aD(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(Ke.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pt())}isEqual(e){return this.batchId===e.batchId&&ih(this.mutations,e.mutations,(n,r)=>Gj(n,r))&&ih(this.baseMutations,e.baseMutations,(n,r)=>Gj(n,r))}}class NS{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){We(e.mutations.length===r.length);let s=function(){return qH}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new NS(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JH{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bn,Ct;function tG(t){switch(t){default:return Be();case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0}}function uD(t){if(t===void 0)return On("GRPC error has no .code"),oe.UNKNOWN;switch(t){case Bn.OK:return oe.OK;case Bn.CANCELLED:return oe.CANCELLED;case Bn.UNKNOWN:return oe.UNKNOWN;case Bn.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case Bn.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case Bn.INTERNAL:return oe.INTERNAL;case Bn.UNAVAILABLE:return oe.UNAVAILABLE;case Bn.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case Bn.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case Bn.NOT_FOUND:return oe.NOT_FOUND;case Bn.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case Bn.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case Bn.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case Bn.ABORTED:return oe.ABORTED;case Bn.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case Bn.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case Bn.DATA_LOSS:return oe.DATA_LOSS;default:return Be()}}(Ct=Bn||(Bn={}))[Ct.OK=0]="OK",Ct[Ct.CANCELLED=1]="CANCELLED",Ct[Ct.UNKNOWN=2]="UNKNOWN",Ct[Ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ct[Ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ct[Ct.NOT_FOUND=5]="NOT_FOUND",Ct[Ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ct[Ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ct[Ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ct[Ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ct[Ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ct[Ct.ABORTED=10]="ABORTED",Ct[Ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ct[Ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ct[Ct.INTERNAL=13]="INTERNAL",Ct[Ct.UNAVAILABLE=14]="UNAVAILABLE",Ct[Ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nG(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rG=new kc([4294967295,4294967295],0);function Zj(t){const e=nG().encode(t),n=new p4;return n.update(e),new Uint8Array(n.digest())}function Yj(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new kc([n,r],0),new kc([s,i],0)]}class TS{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new om(`Invalid padding: ${n}`);if(r<0)throw new om(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new om(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new om(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=kc.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(kc.fromNumber(r)));return s.compare(rG)===1&&(s=new kc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Zj(e),[r,s]=Yj(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new TS(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=Zj(e),[r,s]=Yj(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class om extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,cg.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new lg(Ke.min(),s,new kn(ot),Ts(),pt())}}class cg{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new cg(r,n,pt(),pt(),pt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class dD{constructor(e,n){this.targetId=e,this.me=n}}class hD{constructor(e,n,r=Dn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Xj{constructor(){this.fe=0,this.ge=eI(),this.pe=Dn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=pt(),n=pt(),r=pt();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Be()}}),new cg(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=eI()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,We(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class sG{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ts(),this.qe=Jj(),this.Qe=new kn(ot)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Be()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(h0(i))if(r===0){const a=new Ie(i.path);this.Ue(n,a,En.newNoDocument(a,Ke.min()))}else We(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=yl(r).toUint8Array()}catch(u){if(u instanceof M4)return sh("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new TS(a,s,i)}catch(u){return sh(u instanceof om?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&h0(l.target)){const u=new Ie(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,En.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=pt();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new lg(e,n,this.Qe,this.ke,r);return this.ke=Ts(),this.qe=Jj(),this.Qe=new kn(ot),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Xj,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ht(ot),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||fe("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Xj),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Jj(){return new kn(Ie.comparator)}function eI(){return new kn(Ie.comparator)}const iG={asc:"ASCENDING",desc:"DESCENDING"},oG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aG={and:"AND",or:"OR"};class lG{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ok(t,e){return t.useProto3Json||Pv(e)?e:{value:e}}function dh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fD(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function cG(t,e){return dh(t,e.toTimestamp())}function Wr(t){return We(!!t),Ke.fromTimestamp(function(n){const r=na(n);return new bn(r.seconds,r.nanos)}(t))}function ES(t,e){return Dk(t,e).canonicalString()}function Dk(t,e){const n=function(s){return new Mt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function mD(t){const e=Mt.fromString(t);return We(wD(e)),e}function p0(t,e){return ES(t.databaseId,e.path)}function Nc(t,e){const n=mD(e);if(n.get(1)!==t.databaseId.projectId)throw new we(oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new we(oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ie(yD(n))}function pD(t,e){return ES(t.databaseId,e)}function gD(t){const e=mD(t);return e.length===4?Mt.emptyPath():yD(e)}function Vk(t){return new Mt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yD(t){return We(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function tI(t,e,n){return{name:p0(t,e),fields:n.value.mapValue.fields}}function uG(t,e,n){const r=Nc(t,e.name),s=Wr(e.updateTime),i=e.createTime?Wr(e.createTime):Ke.min(),a=new Ar({mapValue:{fields:e.fields}}),l=En.newFoundDocument(r,s,i,a);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function dG(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Be()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(We(f===void 0||typeof f=="string"),Dn.fromBase64String(f||"")):(We(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Dn.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(d){const f=d.code===void 0?oe.UNKNOWN:uD(d.code);return new we(f,d.message||"")}(a);n=new hD(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Nc(t,r.document.name),i=Wr(r.document.updateTime),a=r.document.createTime?Wr(r.document.createTime):Ke.min(),l=new Ar({mapValue:{fields:r.document.fields}}),u=En.newFoundDocument(s,i,a,l),d=r.targetIds||[],f=r.removedTargetIds||[];n=new xx(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Nc(t,r.document),i=r.readTime?Wr(r.readTime):Ke.min(),a=En.newNoDocument(s,i),l=r.removedTargetIds||[];n=new xx([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Nc(t,r.document),i=r.removedTargetIds||[];n=new xx([],i,s,null)}else{if(!("filter"in e))return Be();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new eG(s,i),l=r.targetId;n=new dD(l,a)}}return n}function g0(t,e){let n;if(e instanceof Dh)n={update:tI(t,e.key,e.value)};else if(e instanceof ag)n={delete:p0(t,e.key)};else if(e instanceof ua)n={update:tI(t,e.key,e.data),updateMask:xG(e.fieldMask)};else{if(!(e instanceof cD))return Be();n={verify:p0(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof ch)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Wc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Hc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof uh)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw Be()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:cG(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Be()}(t,e.precondition)),n}function Fk(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Qn.updateTime(Wr(i.updateTime)):i.exists!==void 0?Qn.exists(i.exists):Qn.none()}(e.currentDocument):Qn.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(a,l){let u=null;if("setToServerValue"in l)We(l.setToServerValue==="REQUEST_TIME"),u=new ch;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Wc(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Hc(f)}else"increment"in l?u=new uh(a,l.increment):Be();const d=gn.fromServerFormat(l.fieldPath);return new og(d,u)}(t,s)):[];if(e.update){e.update.name;const s=Nc(t,e.update.name),i=new Ar({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(u){const d=u.fieldPaths||[];return new os(d.map(f=>gn.fromServerFormat(f)))}(e.updateMask);return new ua(s,i,a,n,r)}return new Dh(s,i,n,r)}if(e.delete){const s=Nc(t,e.delete);return new ag(s,n)}if(e.verify){const s=Nc(t,e.verify);return new cD(s,n)}return Be()}function hG(t,e){return t&&t.length>0?(We(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Wr(s.updateTime):Wr(i);return a.isEqual(Ke.min())&&(a=Wr(i)),new ZH(a,s.transformResults||[])}(n,e))):[]}function xD(t,e){return{documents:[pD(t,e.path)]}}function CS(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=pD(t,s);const i=function(d){if(d.length!==0)return _D(Ft.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(f=>function(p){return{field:Ba(p.field),direction:pG(p.dir)}}(f))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=Ok(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function fG(t,e,n,r){const{_t:s,parent:i}=CS(t,e),a={},l=[];let u=0;return n.forEach(d=>{const f="aggregate_"+u++;a[f]=d.alias,d.aggregateType==="count"?l.push({alias:f,count:{}}):d.aggregateType==="avg"?l.push({alias:f,avg:{field:Ba(d.fieldPath)}}):d.aggregateType==="sum"&&l.push({alias:f,sum:{field:Ba(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},ut:a,parent:i}}function vD(t){let e=gD(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){We(r===1);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(m){const p=bD(m);return p instanceof Ft&&bS(p)?p.getFilters():[p]}(n.where));let a=[];n.orderBy&&(a=function(m){return m.map(p=>function(x){return new xp(od(x.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(m){let p;return p=typeof m=="object"?m.value:m,Pv(p)?null:p}(n.limit));let u=null;n.startAt&&(u=function(m){const p=!!m.before,v=m.values||[];return new ah(v,p)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const p=!m.before,v=m.values||[];return new ah(v,p)}(n.endAt)),H4(e,s,a,i,l,"F",u,d)}function mG(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Be()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function bD(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=od(n.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=od(n.unaryFilter.field);return St.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=od(n.unaryFilter.field);return St.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=od(n.unaryFilter.field);return St.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Be()}}(t):t.fieldFilter!==void 0?function(n){return St.create(od(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Be()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ft.create(n.compositeFilter.filters.map(r=>bD(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Be()}}(n.compositeFilter.op))}(t):Be()}function pG(t){return iG[t]}function gG(t){return oG[t]}function yG(t){return aG[t]}function Ba(t){return{fieldPath:t.canonicalString()}}function od(t){return gn.fromServerFormat(t.fieldPath)}function _D(t){return t instanceof St?function(n){if(n.op==="=="){if(Vj(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NAN"}};if(Dj(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Vj(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NOT_NAN"}};if(Dj(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ba(n.field),op:gG(n.op),value:n.value}}}(t):t instanceof Ft?function(n){const r=n.getFilters().map(s=>_D(s));return r.length===1?r[0]:{compositeFilter:{op:yG(n.op),filters:r}}}(t):Be()}function xG(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function wD(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,n,r,s,i=Ke.min(),a=Ke.min(),l=Dn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Uo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Uo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e){this.ct=e}}function vG(t,e){let n;if(e.document)n=uG(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ie.fromSegments(e.noDocument.path),s=Kc(e.noDocument.readTime);n=En.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Be();{const r=Ie.fromSegments(e.unknownDocument.path),s=Kc(e.unknownDocument.version);n=En.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new bn(s[0],s[1]);return Ke.fromTimestamp(i)}(e.readTime)),n}function nI(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:y0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,a){return{name:p0(i,a.key),fields:a.data.value.mapValue.fields,updateTime:dh(i,a.version.toTimestamp()),createTime:dh(i,a.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Gc(e.version)};else{if(!e.isUnknownDocument())return Be();r.unknownDocument={path:n.path.toArray(),version:Gc(e.version)}}return r}function y0(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Gc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Kc(t){const e=new bn(t.seconds,t.nanoseconds);return Ke.fromTimestamp(e)}function cc(t,e){const n=(e.baseMutations||[]).map(i=>Fk(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const a=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Fk(t.ct,i)),s=bn.fromMillis(e.localWriteTimeMs);return new kS(e.batchId,s,n,r)}function am(t){const e=Kc(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Kc(t.lastLimboFreeSnapshotVersion):Ke.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){return We(i.documents.length===1),As(sg(gD(i.documents[0])))}(t.query):function(i){return As(vD(i))}(t.query),new Uo(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Dn.fromBase64String(t.resumeToken))}function ND(t,e){const n=Gc(e.snapshotVersion),r=Gc(e.lastLimboFreeSnapshotVersion);let s;s=h0(e.target)?xD(t.ct,e.target):CS(t.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:qc(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function SD(t){const e=vD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?m0(e,e.limit,"L"):e}function j_(t,e){return new SS(e.largestBatchId,Fk(t.ct,e.overlayMutation))}function rI(t,e){const n=e.path.lastSegment();return[t,qr(e.path.popLast()),n]}function sI(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Gc(r.readTime),documentKey:qr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bG{getBundleMetadata(e,n){return iI(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Kc(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return iI(e).put(function(s){return{bundleId:s.id,createTime:Gc(Wr(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return oI(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:SD(i.bundledQuery),readTime:Kc(i.readTime)}}(r)})}saveNamedQuery(e,n){return oI(e).put(function(s){return{name:s.name,readTime:Gc(Wr(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function iI(t){return Xn(t,"bundles")}function oI(t){return Xn(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Vv(e,r)}getOverlay(e,n){return Mf(e).get(rI(this.userId,n)).next(r=>r?j_(this.serializer,r):null)}getOverlays(e,n){const r=Ki();return J.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,a)=>{const l=new SS(n,a);s.push(this.ht(e,l))}),J.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(a=>s.add(qr(a.getCollectionPath())));const i=[];return s.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);i.push(Mf(e).j("collectionPathOverlayIndex",l))}),J.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Ki(),i=qr(n),a=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Mf(e).U("collectionPathOverlayIndex",a).next(l=>{for(const u of l){const d=j_(this.serializer,u);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Ki();let a;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Mf(e).J({index:"collectionGroupOverlayIndex",range:l},(u,d,f)=>{const m=j_(this.serializer,d);i.size()<s||m.largestBatchId===a?(i.set(m.getKey(),m),a=m.largestBatchId):f.done()}).next(()=>i)}ht(e,n){return Mf(e).put(function(s,i,a){const[l,u,d]=rI(i,a.mutation.key);return{userId:i,collectionPath:u,documentId:d,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:g0(s.ct,a.mutation)}}(this.serializer,this.userId,n))}}function Mf(t){return Xn(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _G{Pt(e){return Xn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Dn.fromUint8Array(r):Dn.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(dn(e.integerValue));else if("doubleValue"in e){const r=dn(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),fp(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=na(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(yl(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?O4(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Lv(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Be()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const s of Object.keys(r))this.Vt(s,n),this.Tt(r[s],n)}wt(e,n){var r,s;const i=e.fields||{};this.dt(n,53);const a="value",l=((s=(r=i[a].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(n,15),n.At(dn(l)),this.Vt(a,n),this.Tt(i[a],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const s of r)this.Tt(s,n)}yt(e,n){this.dt(n,37),Ie.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}uc.vt=new uc;function wG(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function aI(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const a=wG(255&r[i]);if(s+=a,a!==8)break}return s}(t);return Math.ceil(e/8)}class kG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=n.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=n.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const n=this.qt(e),r=aI(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}Kt(e){const n=this.qt(e),r=aI(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class NG{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class SG{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Of{constructor(){this.jt=new kG,this.Ht=new NG(this.jt),this.Jt=new SG(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new dc(this.indexId,this.documentKey,this.arrayValue,r)}}function Ta(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=lI(t.arrayValue,e.arrayValue),n!==0?n:(n=lI(t.directionalValue,e.directionalValue),n!==0?n:Ie.comparator(t.documentKey,e.documentKey)))}function lI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e){this.Xt=new Ht((n,r)=>gn.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(We(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Ek(e);if(n!==void 0&&!this.sn(n))return!1;const r=sc(e);let s=new Set,i=0,a=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const u=r[i];if(!this.on(l,u)||!this._n(this.en[a++],u))return!1}++i}for(;i<r.length;++i){const l=r[i];if(a>=this.en.length||!this._n(this.en[a++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Ht(gn.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new fx(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new fx(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new fx(r.field,r.dir==="asc"?0:1)));return new d0(d0.UNKNOWN_ID,this.collectionId,n,hp.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(t){var e,n;if(We(t instanceof St||t instanceof Ft),t instanceof St){if(t instanceof W4){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>St.create(t.field,"==",i)))||[];return Ft.create(s,"or")}return t}const r=t.filters.map(s=>TD(s));return Ft.create(r,t.op)}function TG(t){if(t.getFilters().length===0)return[];const e=$k(TD(t));return We(ED(e)),zk(e)||Bk(e)?[e]:e.getFilters()}function zk(t){return t instanceof St}function Bk(t){return t instanceof Ft&&bS(t)}function ED(t){return zk(t)||Bk(t)||function(n){if(n instanceof Ft&&Rk(n)){for(const r of n.getFilters())if(!zk(r)&&!Bk(r))return!1;return!0}return!1}(t)}function $k(t){if(We(t instanceof St||t instanceof Ft),t instanceof St)return t;if(t.filters.length===1)return $k(t.filters[0]);const e=t.filters.map(r=>$k(r));let n=Ft.create(e,t.op);return n=x0(n),ED(n)?n:(We(n instanceof Ft),We(lh(n)),We(n.filters.length>1),n.filters.reduce((r,s)=>jS(r,s)))}function jS(t,e){let n;return We(t instanceof St||t instanceof Ft),We(e instanceof St||e instanceof Ft),n=t instanceof St?e instanceof St?function(s,i){return Ft.create([s,i],"and")}(t,e):uI(t,e):e instanceof St?uI(e,t):function(s,i){if(We(s.filters.length>0&&i.filters.length>0),lh(s)&&lh(i))return $4(s,i.getFilters());const a=Rk(s)?s:i,l=Rk(s)?i:s,u=a.filters.map(d=>jS(d,l));return Ft.create(u,"or")}(t,e),x0(n)}function uI(t,e){if(lh(e))return $4(e,t.getFilters());{const n=e.filters.map(r=>jS(t,r));return Ft.create(n,"or")}}function x0(t){if(We(t instanceof St||t instanceof Ft),t instanceof St)return t;const e=t.getFilters();if(e.length===1)return x0(e[0]);if(z4(t))return t;const n=e.map(s=>x0(s)),r=[];return n.forEach(s=>{s instanceof St?r.push(s):s instanceof Ft&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ft.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EG{constructor(){this.un=new IS}addToCollectionParentIndex(e,n){return this.un.add(n),J.resolve()}getCollectionParents(e,n){return J.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return J.resolve()}deleteFieldIndex(e,n){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,n){return J.resolve()}getDocumentsMatchingTarget(e,n){return J.resolve(null)}getIndexType(e,n){return J.resolve(0)}getFieldIndexes(e,n){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,n){return J.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,n){return J.resolve(Ls.min())}updateCollectionGroup(e,n,r){return J.resolve()}updateIndexEntries(e,n){return J.resolve()}}class IS{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ht(Mt.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ht(Mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=new Uint8Array(0);class CG{constructor(e,n){this.databaseId=n,this.cn=new IS,this.ln=new Ml(r=>qc(r),(r,s)=>rg(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const i={collectionId:r,parent:qr(s)};return dI(e).put(i)}return J.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[k4(n),""],!1,!0);return dI(e).U(s).next(i=>{for(const a of i){if(a.collectionId!==n)break;r.push(Gi(a.parent))}return r})}addFieldIndex(e,n){const r=Df(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const a=ed(e);return i.next(l=>{a.put(sI(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Df(e),s=ed(e),i=Ju(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Df(e),r=Ju(e),s=ed(e);return n.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,n){return J.forEach(this.hn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new cI(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Ju(e);let s=!0;const i=new Map;return J.forEach(this.hn(n),a=>this.Pn(e,a).next(l=>{s&&(s=!!l),i.set(a,l)})).next(()=>{if(s){let a=pt();const l=[];return J.forEach(i,(u,d)=>{fe("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(C=>`${C.fieldPath}:${C.kind}`).join(",")}`}(u)} to execute ${qc(n)}`);const f=function(S,C){const P=Ek(C);if(P===void 0)return null;for(const R of f0(S,P.fieldPath))switch(R.op){case"array-contains-any":return R.value.arrayValue.values||[];case"array-contains":return[R.value]}return null}(d,u),m=function(S,C){const P=new Map;for(const R of sc(C))for(const I of f0(S,R.fieldPath))switch(I.op){case"==":case"in":P.set(R.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return P.set(R.fieldPath.canonicalString(),I.value),Array.from(P.values())}return null}(d,u),p=function(S,C){const P=[];let R=!0;for(const I of sc(C)){const j=I.kind===0?Uj(S,I.fieldPath,S.startAt):qj(S,I.fieldPath,S.startAt);P.push(j.value),R&&(R=j.inclusive)}return new ah(P,R)}(d,u),v=function(S,C){const P=[];let R=!0;for(const I of sc(C)){const j=I.kind===0?qj(S,I.fieldPath,S.endAt):Uj(S,I.fieldPath,S.endAt);P.push(j.value),R&&(R=j.inclusive)}return new ah(P,R)}(d,u),x=this.In(u,d,p),_=this.In(u,d,v),E=this.Tn(u,d,m),k=this.En(u.indexId,f,x,p.inclusive,_,v.inclusive,E);return J.forEach(k,b=>r.G(b,n.limit).next(S=>{S.forEach(C=>{const P=Ie.fromSegments(C.documentKey);a.has(P)||(a=a.add(P),l.push(P))})}))}).next(()=>l)}return J.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=TG(Ft.create(e.filters,"and")).map(r=>Lk(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,s,i,a,l){const u=(n!=null?n.length:1)*Math.max(r.length,i.length),d=u/(n!=null?n.length:1),f=[];for(let m=0;m<u;++m){const p=n?this.dn(n[m/d]):Ay,v=this.An(e,p,r[m%d],s),x=this.Rn(e,p,i[m%d],a),_=l.map(E=>this.An(e,p,E,!0));f.push(...this.createRange(v,x,_))}return f}An(e,n,r,s){const i=new dc(e,Ie.empty(),n,r);return s?i:i.Zt()}Rn(e,n,r,s){const i=new dc(e,Ie.empty(),n,r);return s?i.Zt():i}Pn(e,n){const r=new cI(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let a=null;for(const l of i)r.rn(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,n){let r=2;const s=this.hn(n);return J.forEach(s,i=>this.Pn(e,i).next(a=>{a?r!==0&&a.fields.length<function(u){let d=new Ht(gn.comparator),f=!1;for(const m of u.filters)for(const p of m.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?f=!0:d=d.add(p.field));for(const m of u.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(f?1:0)}(i)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&s.length>1&&r===2?1:r)}Vn(e,n){const r=new Of;for(const s of sc(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const a=r.Yt(s.kind);uc.vt.It(i,a)}return r.zt()}dn(e){const n=new Of;return uc.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Of;return uc.vt.It(gp(this.databaseId,n),r.Yt(function(i){const a=sc(i);return a.length===0?0:a[a.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let s=[];s.push(new Of);let i=0;for(const a of sc(e)){const l=r[i++];for(const u of s)if(this.fn(n,a.fieldPath)&&yp(l))s=this.gn(s,a,l);else{const d=u.Yt(a.kind);uc.vt.It(l,d)}}return this.pn(s)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const s=[...e],i=[];for(const a of r.arrayValue.values||[])for(const l of s){const u=new Of;u.seed(l.zt()),uc.vt.It(a,u.Yt(n.kind)),i.push(u)}return i}fn(e,n){return!!e.filters.find(r=>r instanceof St&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Df(e),s=ed(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(i=>{const a=[];return J.forEach(i,l=>s.get([l.indexId,this.uid]).next(u=>{a.push(function(f,m){const p=m?new hp(m.sequenceNumber,new Ls(Kc(m.readTime),new Ie(Gi(m.documentKey)),m.largestBatchId)):hp.empty(),v=f.fields.map(([x,_])=>new fx(gn.fromServerFormat(x),_));return new d0(f.indexId,f.collectionGroup,v,p)}(l,u))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ot(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Df(e),i=ed(e);return this.yn(e).next(a=>s.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(l=>J.forEach(l,u=>i.put(sI(u.indexId,this.uid,a,r)))))}updateIndexEntries(e,n){const r=new Map;return J.forEach(n,(s,i)=>{const a=r.get(s.collectionGroup);return(a?J.resolve(a):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),J.forEach(l,u=>this.wn(e,s,u).next(d=>{const f=this.Sn(i,u);return d.isEqual(f)?J.resolve():this.bn(e,i,u,d,f)}))))})}Dn(e,n,r,s){return Ju(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,s){return Ju(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const s=Ju(e);let i=new Ht(Ta);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(a,l)=>{i=i.add(new dc(r.indexId,n,l.arrayValue,l.directionalValue))}).next(()=>i)}Sn(e,n){let r=new Ht(Ta);const s=this.Vn(n,e);if(s==null)return r;const i=Ek(n);if(i!=null){const a=e.data.field(i.fieldPath);if(yp(a))for(const l of a.arrayValue.values||[])r=r.add(new dc(n.indexId,e.key,this.dn(l),s))}else r=r.add(new dc(n.indexId,e.key,Ay,s));return r}bn(e,n,r,s,i){fe("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(u,d,f,m,p){const v=u.getIterator(),x=d.getIterator();let _=Xu(v),E=Xu(x);for(;_||E;){let k=!1,b=!1;if(_&&E){const S=f(_,E);S<0?b=!0:S>0&&(k=!0)}else _!=null?b=!0:k=!0;k?(m(E),E=Xu(x)):b?(p(_),_=Xu(v)):(_=Xu(v),E=Xu(x))}}(s,i,Ta,l=>{a.push(this.Dn(e,n,r,l))},l=>{a.push(this.vn(e,n,r,l))}),J.waitFor(a)}yn(e){let n=1;return ed(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,l)=>Ta(a,l)).filter((a,l,u)=>!l||Ta(a,u[l-1])!==0);const s=[];s.push(e);for(const a of r){const l=Ta(a,e),u=Ta(a,n);if(l===0)s[0]=e.Zt();else if(l>0&&u<0)s.push(a),s.push(a.Zt());else if(u>0)break}s.push(n);const i=[];for(let a=0;a<s.length;a+=2){if(this.Cn(s[a],s[a+1]))return[];const l=[s[a].indexId,this.uid,s[a].arrayValue,s[a].directionalValue,Ay,[]],u=[s[a+1].indexId,this.uid,s[a+1].arrayValue,s[a+1].directionalValue,Ay,[]];i.push(IDBKeyRange.bound(l,u))}return i}Cn(e,n){return Ta(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(hI)}getMinOffset(e,n){return J.mapArray(this.hn(n),r=>this.Pn(e,r).next(s=>s||Be())).next(hI)}}function dI(t){return Xn(t,"collectionParents")}function Ju(t){return Xn(t,"indexEntries")}function Df(t){return Xn(t,"indexConfiguration")}function ed(t){return Xn(t,"indexState")}function hI(t){We(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;pS(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Ls(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class es{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new es(e,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],a=IDBKeyRange.only(n.batchId);let l=0;const u=r.J({range:a},(f,m,p)=>(l++,p.delete()));i.push(u.next(()=>{We(l===1)}));const d=[];for(const f of n.mutations){const m=I4(e,f.key.path,n.batchId);i.push(s.delete(m)),d.push(f.key)}return J.waitFor(i).next(()=>d)}function v0(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Be();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */es.DEFAULT_COLLECTION_PERCENTILE=10,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,es.DEFAULT=new es(41943040,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),es.DISABLED=new es(-1,0,0);class Fv{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,n,r,s){We(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Fv(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ea(e).J({index:"userMutationsIndex",range:r},(s,i,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=ad(e),a=Ea(e);return a.add({}).next(l=>{We(typeof l=="number");const u=new kS(l,n,r,s),d=function(v,x,_){const E=_.baseMutations.map(b=>g0(v.ct,b)),k=_.mutations.map(b=>g0(v.ct,b));return{userId:x,batchId:_.batchId,localWriteTimeMs:_.localWriteTime.toMillis(),baseMutations:E,mutations:k}}(this.serializer,this.userId,u),f=[];let m=new Ht((p,v)=>ot(p.canonicalString(),v.canonicalString()));for(const p of s){const v=I4(this.userId,p.key.path,l);m=m.add(p.key.path.popLast()),f.push(a.put(d)),f.push(i.put(v,uH))}return m.forEach(p=>{f.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Fn[l]=u.keys()}),J.waitFor(f).next(()=>u)})}lookupMutationBatch(e,n){return Ea(e).get(n).next(r=>r?(We(r.userId===this.userId),cc(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?J.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Fn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Ea(e).J({index:"userMutationsIndex",range:s},(a,l,u)=>{l.userId===this.userId&&(We(l.batchId>=r),i=cc(this.serializer,l)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ea(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,i,a)=>{r=i.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ea(e).U("userMutationsIndex",n).next(r=>r.map(s=>cc(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=mx(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return ad(e).J({range:s},(a,l,u)=>{const[d,f,m]=a,p=Gi(f);if(d===this.userId&&n.path.isEqual(p))return Ea(e).get(m).next(v=>{if(!v)throw Be();We(v.userId===this.userId),i.push(cc(this.serializer,v))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ht(ot);const s=[];return n.forEach(i=>{const a=mx(this.userId,i.path),l=IDBKeyRange.lowerBound(a),u=ad(e).J({range:l},(d,f,m)=>{const[p,v,x]=d,_=Gi(v);p===this.userId&&i.path.isEqual(_)?r=r.add(x):m.done()});s.push(u)}),J.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=mx(this.userId,r),a=IDBKeyRange.lowerBound(i);let l=new Ht(ot);return ad(e).J({range:a},(u,d,f)=>{const[m,p,v]=u,x=Gi(p);m===this.userId&&r.isPrefixOf(x)?x.length===s&&(l=l.add(v)):f.done()}).next(()=>this.xn(e,l))}xn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Ea(e).get(i).next(a=>{if(a===null)throw Be();We(a.userId===this.userId),r.push(cc(this.serializer,a))}))}),J.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return CD(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),J.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return J.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),s=[];return ad(e).J({range:r},(i,a,l)=>{if(i[0]===this.userId){const u=Gi(i[1]);s.push(u)}else l.done()}).next(()=>{We(s.length===0)})})}containsKey(e,n){return jD(e,this.userId,n)}Nn(e){return ID(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function jD(t,e,n){const r=mx(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let a=!1;return ad(t).J({range:i,H:!0},(l,u,d)=>{const[f,m,p]=l;f===e&&m===s&&(a=!0),d.done()}).next(()=>a)}function Ea(t){return Xn(t,"mutations")}function ad(t){return Xn(t,"documentMutations")}function ID(t){return Xn(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Qc(0)}static kn(){return new Qc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jG{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new Qc(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Ke.fromTimestamp(new bn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Qn(e,s)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>td(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(We(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return td(e).J((a,l)=>{const u=am(l);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>J.waitFor(i)).next(()=>s)}forEachTarget(e,n){return td(e).J((r,s)=>{const i=am(s);n(i)})}qn(e){return mI(e).get("targetGlobalKey").next(n=>(We(n!==null),n))}Qn(e,n){return mI(e).put("targetGlobalKey",n)}Kn(e,n){return td(e).put(ND(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=qc(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return td(e).J({range:s,index:"queryTargetsIndex"},(a,l,u)=>{const d=am(l);rg(n,d.target)&&(i=d,u.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=$a(e);return n.forEach(a=>{const l=qr(a.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,a))}),J.waitFor(s)}removeMatchingKeys(e,n,r){const s=$a(e);return J.forEach(n,i=>{const a=qr(i.path);return J.waitFor([s.delete([r,a]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=$a(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=$a(e);let i=pt();return s.J({range:r,H:!0},(a,l,u)=>{const d=Gi(a[1]),f=new Ie(d);i=i.add(f)}).next(()=>i)}containsKey(e,n){const r=qr(n.path),s=IDBKeyRange.bound([r],[k4(r)],!1,!0);let i=0;return $a(e).J({index:"documentTargetsIndex",H:!0,range:s},([a,l],u,d)=>{a!==0&&(i++,d.done())}).next(()=>i>0)}ot(e,n){return td(e).get(n).next(r=>r?am(r):null)}}function td(t){return Xn(t,"targets")}function mI(t){return Xn(t,"targetGlobal")}function $a(t){return Xn(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI([t,e],[n,r]){const s=ot(t,n);return s===0?ot(e,r):s}class IG{constructor(e){this.Un=e,this.buffer=new Ht(pI),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();pI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class AG{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){fe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ll(n)?fe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Pl(n)}await this.Hn(3e5)})}}class RG{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return J.resolve(is.oe);const r=new IG(n);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),J.resolve(fI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fI):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,s,i,a,l,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),sd()<=Nt.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(l-a)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),J.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function PG(t,e){return new RG(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LG{constructor(e,n){this.db=e,this.garbageCollector=PG(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,s)=>n(s))}addReference(e,n,r){return Ry(e,r)}removeReference(e,n,r){return Ry(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Ry(e,n)}nr(e,n){return function(s,i){let a=!1;return ID(s).Y(l=>jD(s,l,i).next(u=>(u&&(a=!0),J.resolve(!u)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(a,l)=>{if(l<=n){const u=this.nr(e,a).next(d=>{if(!d)return i++,r.getEntry(e,a).next(()=>(r.removeEntry(a,Ke.min()),$a(e).delete(function(m){return[0,qr(m.path)]}(a))))});s.push(u)}}).next(()=>J.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Ry(e,n)}tr(e,n){const r=$a(e);let s,i=is.oe;return r.J({index:"documentTargetsIndex"},([a,l],{path:u,sequenceNumber:d})=>{a===0?(i!==is.oe&&n(new Ie(Gi(s)),i),i=d,s=u):i=is.oe}).next(()=>{i!==is.oe&&n(new Ie(Gi(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ry(t,e){return $a(t).put(function(r,s){return{targetId:0,path:qr(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(){this.changes=new Ml(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,En.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?J.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Xl(e).put(r)}removeEntry(e,n,r){return Xl(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],y0(a),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=En.newInvalidDocument(n);return Xl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vf(n))},(s,i)=>{r=this.ir(n,i)}).next(()=>r)}sr(e,n){let r={size:0,document:En.newInvalidDocument(n)};return Xl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vf(n))},(s,i)=>{r={document:this.ir(n,i),size:v0(i)}}).next(()=>r)}getEntries(e,n){let r=Ts();return this._r(e,n,(s,i)=>{const a=this.ir(s,i);r=r.insert(s,a)}).next(()=>r)}ar(e,n){let r=Ts(),s=new kn(Ie.comparator);return this._r(e,n,(i,a)=>{const l=this.ir(i,a);r=r.insert(i,l),s=s.insert(i,v0(a))}).next(()=>({documents:r,ur:s}))}_r(e,n,r){if(n.isEmpty())return J.resolve();let s=new Ht(xI);n.forEach(u=>s=s.add(u));const i=IDBKeyRange.bound(Vf(s.first()),Vf(s.last())),a=s.getIterator();let l=a.getNext();return Xl(e).J({index:"documentKeyIndex",range:i},(u,d,f)=>{const m=Ie.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&xI(l,m)<0;)r(l,null),l=a.getNext();l&&l.isEqual(m)&&(r(l,d),l=a.hasNext()?a.getNext():null),l?f.$(Vf(l)):f.done()}).next(()=>{for(;l;)r(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const a=n.path,l=[a.popLast().toArray(),a.lastSegment(),y0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xl(e).U(IDBKeyRange.bound(l,u,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let f=Ts();for(const m of d){const p=this.ir(Ie.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);p.isFoundDocument()&&(ig(n,p)||s.has(p.key))&&(f=f.insert(p.key,p))}return f})}getAllFromCollectionGroup(e,n,r,s){let i=Ts();const a=yI(n,r),l=yI(n,Ls.max());return Xl(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(u,d,f)=>{const m=this.ir(Ie.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&f.done()}).next(()=>i)}newChangeBuffer(e){return new OG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return gI(e).get("remoteDocumentGlobalKey").next(n=>(We(!!n),n))}rr(e,n){return gI(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=vG(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Ke.min())))return r}return En.newInvalidDocument(e)}}function RD(t){return new MG(t)}class OG extends AD{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new Ml(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Ht((i,a)=>ot(i.canonicalString(),a.canonicalString()));return this.changes.forEach((i,a)=>{const l=this.lr.get(i);if(n.push(this.cr.removeEntry(e,i,l.readTime)),a.isValidDocument()){const u=nI(this.cr.serializer,a);s=s.add(i.path.popLast());const d=v0(u);r+=d-l.size,n.push(this.cr.addEntry(e,i,u))}else if(r-=l.size,this.trackRemovals){const u=nI(this.cr.serializer,a.convertToNoDocument(Ke.min()));n.push(this.cr.addEntry(e,i,u))}}),s.forEach(i=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.cr.updateMetadata(e,r)),J.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:s})=>(s.forEach((i,a)=>{this.lr.set(i,{size:a,readTime:r.get(i).readTime})}),r))}}function gI(t){return Xn(t,"remoteDocumentGlobal")}function Xl(t){return Xn(t,"remoteDocumentsV14")}function Vf(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function yI(t,e){const n=e.documentKey.path.toArray();return[t,y0(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function xI(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ot(n[i],r[i]),s)return s;return s=ot(n.length,r.length),s||(s=ot(n[n.length-2],r[r.length-2]),s||ot(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DG{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Im(r.mutation,s,os.empty(),bn.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pt()){const s=Ki();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=im();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Ki();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pt()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=Ts();const a=jm(),l=function(){return jm()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof ua)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),Im(f.mutation,d,f.mutation.getFieldMask(),bn.now())):a.set(d.key,os.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>a.set(d,f)),n.forEach((d,f)=>{var m;return l.set(d,new DG(f,(m=a.get(d))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=jm();let s=new kn((a,l)=>a-l),i=pt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||os.empty();f=l.applyToLocalView(d,f),r.set(u,f);const m=(s.get(l.batchId)||pt()).add(u);s=s.insert(l.batchId,m)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,f=u.value,m=eD();f.forEach(p=>{if(!i.has(p)){const v=aD(n.get(p),r.get(p));v!==null&&m.set(p,v),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return J.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return Ie.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):G4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):J.resolve(Ki());let l=-1,u=i;return a.next(d=>J.forEach(d,(f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(f)?J.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{u=u.insert(f,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,pt())).next(f=>({batchId:l,changes:J4(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ie(n)).next(r=>{let s=im();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=im();return this.indexManager.getCollectionParents(e,i).next(l=>J.forEach(l,u=>{const d=function(m,p){return new mu(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((m,p)=>{a=a.insert(m,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,En.newInvalidDocument(f)))});let l=im();return a.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Im(f.mutation,d,os.empty(),bn.now()),ig(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VG{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return J.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Wr(s.createTime)}}(n)),J.resolve()}getNamedQuery(e,n){return J.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:SD(s.bundledQuery),readTime:Wr(s.readTime)}}(n)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FG{constructor(){this.overlays=new kn(Ie.comparator),this.Ir=new Map}getOverlay(e,n){return J.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ki();return J.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),J.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),J.resolve()}getOverlaysForCollection(e,n,r){const s=Ki(),i=n.length+1,a=new Ie(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return J.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new kn((d,f)=>d-f);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Ki(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const l=Ki(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>l.set(d,f)),!(l.size()>=s)););return J.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new SS(n,r));let i=this.Ir.get(n);i===void 0&&(i=pt(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zG{constructor(){this.sessionToken=Dn.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,J.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(){this.Tr=new Ht(nr.Er),this.dr=new Ht(nr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new nr(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new nr(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Ie(new Mt([])),r=new nr(n,e),s=new nr(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Ie(new Mt([])),r=new nr(n,e),s=new nr(n,e+1);let i=pt();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new nr(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class nr{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Ie.comparator(e.key,n.key)||ot(e.wr,n.wr)}static Ar(e,n){return ot(e.wr,n.wr)||Ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BG{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ht(nr.Er)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new kS(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new nr(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return J.resolve(a)}lookupMutationBatch(e,n){return J.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return J.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new nr(n,0),s=new nr(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),J.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ht(ot);return n.forEach(s=>{const i=new nr(s,0),a=new nr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),J.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Ie.isDocumentKey(i)||(i=i.child(""));const a=new nr(new Ie(i),0);let l=new Ht(ot);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.wr)),!0)},a),J.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){We(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return J.forEach(n.mutations,s=>{const i=new nr(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new nr(n,0),s=this.br.firstAfterOrEqual(r);return J.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $G{constructor(e){this.Mr=e,this.docs=function(){return new kn(Ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return J.resolve(r?r.document.mutableCopy():En.newInvalidDocument(n))}getEntries(e,n){let r=Ts();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():En.newInvalidDocument(s))}),J.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ts();const a=n.path,l=new Ie(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||pS(S4(f),r)<=0||(s.has(f.key)||ig(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return J.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Be()}Or(e,n){return J.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new UG(this)}getSize(e){return J.resolve(this.size)}}class UG extends AD{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),J.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qG{constructor(e){this.persistence=e,this.Nr=new Ml(n=>qc(n),rg),this.lastRemoteSnapshotVersion=Ke.min(),this.highestTargetId=0,this.Lr=0,this.Br=new AS,this.targetCount=0,this.kr=Qc.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),J.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Qc(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,J.resolve()}updateTargetData(e,n){return this.Kn(n),J.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),J.waitFor(i).next(()=>s)}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return J.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),J.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),J.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),J.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return J.resolve(r)}containsKey(e,n){return J.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,n){this.qr={},this.overlays={},this.Qr=new is(0),this.Kr=!1,this.Kr=!0,this.$r=new zG,this.referenceDelegate=e(this),this.Ur=new qG(this),this.indexManager=new EG,this.remoteDocumentCache=function(s){return new $G(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new kD(n),this.Gr=new VG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new FG,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new BG(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){fe("MemoryPersistence","Starting transaction:",e);const s=new WG(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return J.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class WG extends E4{constructor(e){super(),this.currentSequenceNumber=e}}class zv{constructor(e){this.persistence=e,this.Jr=new AS,this.Yr=null}static Zr(e){return new zv(e)}get Xr(){if(this.Yr)return this.Yr;throw Be()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),J.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),J.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),J.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.Xr,r=>{const s=Ie.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,Ke.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return J.or([()=>J.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HG{constructor(e){this.serializer=e}O(e,n,r,s){const i=new Rv("createOrUpgrade",n);r<1&&s>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Rj,{unique:!0}),u.createObjectStore("documentMutations")}(e),vI(e),function(u){u.createObjectStore("remoteDocuments")}(e));let a=J.resolve();return r<3&&s>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),vI(e)),a=a.next(()=>function(u){const d=u.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ke.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",f)}(i))),r<4&&s>=4&&(r!==0&&(a=a.next(()=>function(u,d){return d.store("mutations").U().next(f=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Rj,{unique:!0});const m=d.store("mutations"),p=f.map(v=>m.put(v));return J.waitFor(p)})}(e,i))),a=a.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(a=a.next(()=>this.ni(i))),r<6&&s>=6&&(a=a.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(a=a.next(()=>this.ii(i))),r<8&&s>=8&&(a=a.next(()=>this.si(e,i))),r<9&&s>=9&&(a=a.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(a=a.next(()=>this.oi(i))),r<11&&s>=11&&(a=a.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(a=a.next(()=>{(function(u){const d=u.createObjectStore("documentOverlays",{keyPath:wH});d.createIndex("collectionPathOverlayIndex",kH,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",NH,{unique:!1})})(e)})),r<13&&s>=13&&(a=a.next(()=>function(u){const d=u.createObjectStore("remoteDocumentsV14",{keyPath:dH});d.createIndex("documentKeyIndex",hH),d.createIndex("collectionGroupIndex",fH)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(a=a.next(()=>this.ai(e,i))),r<15&&s>=15&&(a=a.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:xH}).createIndex("sequenceNumberIndex",vH,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:bH}).createIndex("documentKeyIndex",_H,{unique:!1})}(e))),r<16&&s>=16&&(a=a.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&s>=17&&(a=a.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=v0(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(s=>J.forEach(s,i=>{const a=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",a).next(l=>J.forEach(l,u=>{We(u.userId===i.userId);const d=cc(this.serializer,u);return CD(e,i.userId,d).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((a,l)=>{const u=new Mt(a),d=function(m){return[0,qr(m)]}(u);i.push(n.get(d).next(f=>f?J.resolve():(m=>n.put({targetId:0,path:qr(m),sequenceNumber:s.highestListenSequenceNumber}))(u)))}).next(()=>J.waitFor(i))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:yH});const r=n.store("collectionParents"),s=new IS,i=a=>{if(s.add(a)){const l=a.lastSegment(),u=a.popLast();return r.put({collectionId:l,parent:qr(u)})}};return n.store("remoteDocuments").J({H:!0},(a,l)=>{const u=new Mt(a);return i(u.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([a,l,u],d)=>{const f=Gi(l);return i(f.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,s)=>{const i=am(s),a=ND(this.serializer,i);return n.put(a)})}_i(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((i,a)=>{const l=n.store("remoteDocumentsV14"),u=function(m){return m.document?new Ie(Mt.fromString(m.document.name).popFirst(5)):m.noDocument?Ie.fromSegments(m.noDocument.path):m.unknownDocument?Ie.fromSegments(m.unknownDocument.path):Be()}(a).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};s.push(l.put(d))}).next(()=>J.waitFor(s))}ai(e,n){const r=n.store("mutations"),s=RD(this.serializer),i=new LD(zv.Zr,this.serializer.ct);return r.U().next(a=>{const l=new Map;return a.forEach(u=>{var d;let f=(d=l.get(u.userId))!==null&&d!==void 0?d:pt();cc(this.serializer,u).keys().forEach(m=>f=f.add(m)),l.set(u.userId,f)}),J.forEach(l,(u,d)=>{const f=new sr(d),m=Vv.lt(this.serializer,f),p=i.getIndexManager(f),v=Fv.lt(f,this.serializer,p,i.referenceDelegate);return new PD(s,v,m,p).recalculateAndSaveOverlaysForDocumentKeys(new Ck(n,is.oe),u).next()})})}}function vI(t){t.createObjectStore("targetDocuments",{keyPath:pH}).createIndex("documentTargetsIndex",gH,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",mH,{unique:!0}),t.createObjectStore("targetGlobal")}const I_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class RS{constructor(e,n,r,s,i,a,l,u,d,f,m=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=i,this.window=a,this.document=l,this.ci=d,this.li=f,this.hi=m,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=p=>Promise.resolve(),!RS.D())throw new we(oe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new LG(this,s),this.Ai=n+"main",this.serializer=new kD(u),this.Ri=new cl(this.Ai,this.hi,new HG(this.serializer)),this.$r=new _G,this.Ur=new jG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=RD(this.serializer),this.Gr=new bG,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,f===!1&&On("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new we(oe.FAILED_PRECONDITION,I_);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new is(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Py(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Ll(e))return fe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ff(e).get("owner").next(n=>J.resolve(this.vi(n)))}Ci(e){return Py(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Xn(n,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),a=s.filter(l=>i.indexOf(l)===-1);return J.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?J.resolve(!0):Ff(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new we(oe.FAILED_PRECONDITION,I_);return!1}}return!(!this.networkEnabled||!this.inForeground)||Py(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,a=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||a&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&fe("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Ck(e,is.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Py(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Fv.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new CG(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Vv.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){fe("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(u){return u===17?EH:u===16?TH:u===15?yS:u===14?P4:u===13?R4:u===12?SH:u===11?A4:void Be()}(this.hi);let a;return this.Ri.runTransaction(e,s,i,l=>(a=new Ck(l,this.Qr?this.Qr.next():is.oe),n==="readwrite-primary"?this.wi(a).next(u=>!!u||this.Si(a)).next(u=>{if(!u)throw On(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new we(oe.FAILED_PRECONDITION,T4);return r(a)}).next(u=>this.Di(a).next(()=>u)):this.Ki(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Ki(e){return Ff(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new we(oe.FAILED_PRECONDITION,I_)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ff(e).put("owner",n)}static D(){return cl.D()}bi(e){const n=Ff(e);return n.get("owner").next(r=>this.vi(r)?(fe("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):J.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(On(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;SO()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return fe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return On("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){On("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ff(t){return Xn(t,"owner")}function Py(t){return Xn(t,"clientMetadata")}function MD(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=pt(),s=pt();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new PS(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return SO()?8:C4(Yn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new GG;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(sd()<=Nt.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",id(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),J.resolve()):(sd()<=Nt.DEBUG&&fe("QueryEngine","Query:",id(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(sd()<=Nt.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",id(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,As(n))):J.resolve())}Yi(e,n){if(Wj(n))return J.resolve(null);let r=As(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=m0(n,null,"F"),r=As(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=pt(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,l);return this.ns(n,d,a,u.readTime)?this.Yi(e,m0(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return Wj(n)||s.isEqual(Ke.min())?J.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?J.resolve(null):(sd()<=Nt.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),id(n)),this.rs(e,a,n,N4(s,-1)).next(l=>l))})}ts(e,n){let r=new Ht(Y4(e));return n.forEach((s,i)=>{ig(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return sd()<=Nt.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",id(n)),this.Ji.getDocumentsMatchingQuery(e,n,Ls.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KG{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new kn(ot),this._s=new Ml(i=>qc(i),rg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PD(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function DD(t,e,n,r){return new KG(t,e,n,r)}async function VD(t,e){const n=ze(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=pt();for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){l.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:l}))})})}function QG(t,e){const n=ze(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,f){const m=d.batch,p=m.keys();let v=J.resolve();return p.forEach(x=>{v=v.next(()=>f.getEntry(u,x)).next(_=>{const E=d.docVersions.get(x);We(E!==null),_.version.compareTo(E)<0&&(m.applyToRemoteDocument(_,d),_.isValidDocument()&&(_.setReadTime(d.commitVersion),f.addEntry(_)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=pt();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function FD(t){const e=ze(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function ZG(t,e){const n=ze(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((f,m)=>{const p=s.get(m);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,f.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,f.addedDocuments,m)));let v=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(Dn.EMPTY_BYTE_STRING,Ke.min()).withLastLimboFreeSnapshotVersion(Ke.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),s=s.insert(m,v),function(_,E,k){return _.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(p,v,f)&&l.push(n.Ur.updateTargetData(i,v))});let u=Ts(),d=pt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(YG(i,a,e.documentUpdates).next(f=>{u=f.Ps,d=f.Is})),!r.isEqual(Ke.min())){const f=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return J.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function YG(t,e,n){let r=pt(),s=pt();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=Ts();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(Ke.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):fe("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function XG(t,e){const n=ze(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function b0(t,e){const n=ze(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,J.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Uo(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function hh(t,e,n){const r=ze(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Ll(a))throw a;fe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Uk(t,e,n){const r=ze(t);let s=Ke.min(),i=pt();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,f){const m=ze(u),p=m._s.get(f);return p!==void 0?J.resolve(m.os.get(p)):m.Ur.getTargetData(d,f)}(r,a,As(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:Ke.min(),n?i:pt())).next(l=>($D(r,Z4(e),l),{documents:l,Ts:i})))}function zD(t,e){const n=ze(t),r=ze(n.Ur),s=n.os.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(a=>a?a.target:null))}function BD(t,e){const n=ze(t),r=n.us.get(e)||Ke.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.cs.getAllFromCollectionGroup(s,e,N4(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>($D(n,e,s),s))}function $D(t,e,n){let r=t.us.get(e)||Ke.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}function bI(t,e){return`firestore_clients_${t}_${e}`}function _I(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function A_(t,e){return`firestore_targets_${t}_${e}`}class _0{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Rs(e,n,r){const s=JSON.parse(r);let i,a=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return a&&s.error&&(a=typeof s.error.message=="string"&&typeof s.error.code=="string",a&&(i=new we(s.error.code,s.error.message))),a?new _0(e,n,s.state,i):(On("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Am{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new we(r.error.code,r.error.message))),i?new Am(e,r.state,s):(On("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class w0{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=_S();for(let a=0;s&&a<r.activeTargetIds.length;++a)s=j4(r.activeTargetIds[a]),i=i.add(r.activeTargetIds[a]);return s?new w0(e,i):(On("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class LS{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new LS(n.clientId,n.onlineState):(On("SharedClientState",`Failed to parse online state: ${e}`),null)}}class qk{constructor(){this.activeTargetIds=_S()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class R_{constructor(e,n,r,s,i){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new kn(ot),this.started=!1,this.bs=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=bI(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new qk),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(bI(this.persistenceKey,r));if(s){const i=w0.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(A_(this.persistenceKey,e));if(s){const i=Am.Rs(e,s);i&&(r=i.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(A_(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return fe("SharedClientState","READ",e,n),n}setItem(e,n){fe("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){fe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(fe("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void On("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(i){let a=is.oe;if(i!=null)try{const l=JSON.parse(i);We(typeof l=="number"),a=l}catch(l){On("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(n.newValue);r!==is.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const s=new _0(this.currentUser,e,n,r),i=_I(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const n=_I(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const s=A_(this.persistenceKey,e),i=new Am(e,n,r);this.setItem(s,i.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return w0.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return _0.Rs(new sr(i),s,n)}Ys(e,n){const r=this.Ms.exec(e),s=Number(r[1]);return Am.Rs(s,n)}Ls(e){return LS.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);fe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),a=[],l=[];return i.forEach(u=>{s.has(u)||a.push(u)}),s.forEach(u=>{i.has(u)||l.push(u)}),this.syncEngine.io(a,l).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=_S();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class UD{constructor(){this.so=new qk,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new qk,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JG{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){fe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){fe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ly=null;function P_(){return Ly===null?Ly=function(){return 268435456+Math.round(2147483648*Math.random())}():Ly++,"0x"+Ly.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tK{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr="WebChannelConnection";class nK extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=P_(),u=this.xo(n,r.toUriEncodedString());fe("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,a),this.No(n,u,d,s).then(f=>(fe("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw sh("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Oh}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=eK[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=P_();return new Promise((a,l)=>{const u=new g4;u.setWithCredentials(!0),u.listenOnce(y4.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case hx.NO_ERROR:const f=u.getResponseJson();fe(Tr,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),a(f);break;case hx.TIMEOUT:fe(Tr,`RPC '${e}' ${i} timed out`),l(new we(oe.DEADLINE_EXCEEDED,"Request time out"));break;case hx.HTTP_ERROR:const m=u.getStatus();if(fe(Tr,`RPC '${e}' ${i} failed with status:`,m,"response text:",u.getResponseText()),m>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p==null?void 0:p.error;if(v&&v.status&&v.message){const x=function(E){const k=E.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(k)>=0?k:oe.UNKNOWN}(v.status);l(new we(x,v.message))}else l(new we(oe.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new we(oe.UNAVAILABLE,"Connection failed."));break;default:Be()}}finally{fe(Tr,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);fe(Tr,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=P_(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=b4(),l=v4(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");fe(Tr,`Creating RPC '${e}' stream ${s}: ${f}`,u);const m=a.createWebChannel(f,u);let p=!1,v=!1;const x=new tK({Io:E=>{v?fe(Tr,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(p||(fe(Tr,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),fe(Tr,`RPC '${e}' stream ${s} sending:`,E),m.send(E))},To:()=>m.close()}),_=(E,k,b)=>{E.listen(k,S=>{try{b(S)}catch(C){setTimeout(()=>{throw C},0)}})};return _(m,sm.EventType.OPEN,()=>{v||(fe(Tr,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),_(m,sm.EventType.CLOSE,()=>{v||(v=!0,fe(Tr,`RPC '${e}' stream ${s} transport closed`),x.So())}),_(m,sm.EventType.ERROR,E=>{v||(v=!0,sh(Tr,`RPC '${e}' stream ${s} transport errored:`,E),x.So(new we(oe.UNAVAILABLE,"The operation could not be completed")))}),_(m,sm.EventType.MESSAGE,E=>{var k;if(!v){const b=E.data[0];We(!!b);const S=b,C=S.error||((k=S[0])===null||k===void 0?void 0:k.error);if(C){fe(Tr,`RPC '${e}' stream ${s} received error:`,C);const P=C.status;let R=function(O){const V=Bn[O];if(V!==void 0)return uD(V)}(P),I=C.message;R===void 0&&(R=oe.INTERNAL,I="Unknown error status: "+P+" with message "+C.message),v=!0,x.So(new we(R,I)),m.close()}else fe(Tr,`RPC '${e}' stream ${s} received:`,b),x.bo(b)}}),_(l,x4.STAT_EVENT,E=>{E.stat===Tk.PROXY?fe(Tr,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===Tk.NOPROXY&&fe(Tr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(){return typeof window<"u"?window:null}function vx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(t){return new lG(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&fe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,n,r,s,i,a,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new WD(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===oe.RESOURCE_EXHAUSTED?(On(n.toString()),On("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new we(oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return fe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(fe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rK extends HD{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=dG(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ke.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ke.min():a.readTime?Wr(a.readTime):Ke.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Vk(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=h0(u)?{documents:xD(i,u)}:{query:CS(i,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=fD(i,a.resumeToken);const d=Ok(i,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(Ke.min())>0){l.readTime=dh(i,a.snapshotVersion.toTimestamp());const d=Ok(i,a.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=mG(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Vk(this.serializer),n.removeTarget=e,this.a_(n)}}class sK extends HD{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return We(!!e.streamToken),this.lastStreamToken=e.streamToken,We(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){We(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=hG(e.writeResults,e.commitTime),r=Wr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Vk(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>g0(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iK extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new we(oe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Dk(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new we(oe.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,Dk(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new we(oe.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class oK{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(On(n),this.D_=!1):fe("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aK{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{pu(this)&&(fe("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=ze(u);d.L_.add(4),await ug(d),d.q_.set("Unknown"),d.L_.delete(4),await $v(d)}(this))})}),this.q_=new oK(r,s)}}async function $v(t){if(pu(t))for(const e of t.B_)await e(!0)}async function ug(t){for(const e of t.B_)await e(!1)}function Uv(t,e){const n=ze(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),DS(n)?OS(n):Fh(n).r_()&&MS(n,e))}function fh(t,e){const n=ze(t),r=Fh(n);n.N_.delete(e),r.r_()&&GD(n,e),n.N_.size===0&&(r.r_()?r.o_():pu(n)&&n.q_.set("Unknown"))}function MS(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ke.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fh(t).A_(e)}function GD(t,e){t.Q_.xe(e),Fh(t).R_(e)}function OS(t){t.Q_=new sG({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Fh(t).start(),t.q_.v_()}function DS(t){return pu(t)&&!Fh(t).n_()&&t.N_.size>0}function pu(t){return ze(t).L_.size===0}function KD(t){t.Q_=void 0}async function lK(t){t.q_.set("Online")}async function cK(t){t.N_.forEach((e,n)=>{MS(t,e)})}async function uK(t,e){KD(t),DS(t)?(t.q_.M_(e),OS(t)):t.q_.set("Unknown")}async function dK(t,e,n){if(t.q_.set("Online"),e instanceof hD&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){fe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await k0(t,r)}else if(e instanceof xx?t.Q_.Ke(e):e instanceof dD?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ke.min()))try{const r=await FD(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(d);f&&i.N_.set(d,f.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,d)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(Dn.EMPTY_BYTE_STRING,f.snapshotVersion)),GD(i,u);const m=new Uo(f.target,u,d,f.sequenceNumber);MS(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){fe("RemoteStore","Failed to raise snapshot:",r),await k0(t,r)}}async function k0(t,e,n){if(!Ll(e))throw e;t.L_.add(1),await ug(t),t.q_.set("Offline"),n||(n=()=>FD(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{fe("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await $v(t)})}function QD(t,e){return e().catch(n=>k0(t,n,e))}async function Vh(t){const e=ze(t),n=vl(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;hK(e);)try{const s=await XG(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,fK(e,s)}catch(s){await k0(e,s)}ZD(e)&&YD(e)}function hK(t){return pu(t)&&t.O_.length<10}function fK(t,e){t.O_.push(e);const n=vl(t);n.r_()&&n.V_&&n.m_(e.mutations)}function ZD(t){return pu(t)&&!vl(t).n_()&&t.O_.length>0}function YD(t){vl(t).start()}async function mK(t){vl(t).p_()}async function pK(t){const e=vl(t);for(const n of t.O_)e.m_(n.mutations)}async function gK(t,e,n){const r=t.O_.shift(),s=NS.from(r,e,n);await QD(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Vh(t)}async function yK(t,e){e&&vl(t).V_&&await async function(r,s){if(function(a){return tG(a)&&a!==oe.ABORTED}(s.code)){const i=r.O_.shift();vl(r).s_(),await QD(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Vh(r)}}(t,e),ZD(t)&&YD(t)}async function kI(t,e){const n=ze(t);n.asyncQueue.verifyOperationInProgress(),fe("RemoteStore","RemoteStore received new credentials");const r=pu(n);n.L_.add(3),await ug(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await $v(n)}async function Wk(t,e){const n=ze(t);e?(n.L_.delete(2),await $v(n)):e||(n.L_.add(2),await ug(n),n.q_.set("Unknown"))}function Fh(t){return t.K_||(t.K_=function(n,r,s){const i=ze(n);return i.w_(),new rK(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:lK.bind(null,t),Ro:cK.bind(null,t),mo:uK.bind(null,t),d_:dK.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),DS(t)?OS(t):t.q_.set("Unknown")):(await t.K_.stop(),KD(t))})),t.K_}function vl(t){return t.U_||(t.U_=function(n,r,s){const i=ze(n);return i.w_(),new sK(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:mK.bind(null,t),mo:yK.bind(null,t),f_:pK.bind(null,t),g_:gK.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Vh(t)):(await t.U_.stop(),t.O_.length>0&&(fe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ji,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new VS(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function FS(t,e){if(On("AsyncQueue",`${e}: ${t}`),Ll(t))return new we(oe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ie.comparator(n.key,r.key):(n,r)=>Ie.comparator(n.key,r.key),this.keyedMap=im(),this.sortedSet=new kn(this.comparator)}static emptySet(e){return new $d(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof $d)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new $d;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(){this.W_=new kn(Ie.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Be():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class mh{constructor(e,n,r,s,i,a,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new mh(e,n,$d.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xK{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class vK{constructor(){this.queries=SI(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ze(n),i=s.queries;s.queries=SI(),i.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new we(oe.ABORTED,"Firestore shutting down"))}}function SI(){return new Ml(t=>Q4(t),Mv)}async function zS(t,e){const n=ze(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new xK,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=FS(a,`Initialization of query '${id(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&$S(n)}async function BS(t,e){const n=ze(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function bK(t,e){const n=ze(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&$S(n)}function _K(t,e,n){const r=ze(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function $S(t){t.Y_.forEach(e=>{e.next()})}var Hk,TI;(TI=Hk||(Hk={})).ea="default",TI.Cache="cache";class US{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new mh(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=mh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Hk.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e){this.key=e}}class JD{constructor(e){this.key=e}}class wK{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=pt(),this.mutatedKeys=pt(),this.Aa=Y4(e),this.Ra=new $d(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new NI,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const p=s.get(f),v=ig(this.query,m)?m:null,x=!!p&&this.mutatedKeys.has(p.key),_=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let E=!1;p&&v?p.data.isEqual(v.data)?x!==_&&(r.track({type:3,doc:v}),E=!0):this.ga(p,v)||(r.track({type:2,doc:v}),E=!0,(u&&this.Aa(v,u)>0||d&&this.Aa(v,d)<0)&&(l=!0)):!p&&v?(r.track({type:0,doc:v}),E=!0):p&&!v&&(r.track({type:1,doc:p}),E=!0,(u||d)&&(l=!0)),E&&(v?(a=a.add(v),i=_?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,m)=>function(v,x){const _=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Be()}};return _(v)-_(x)}(f.type,m.type)||this.Aa(f.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,a.length!==0||d?{snapshot:new mh(this.query,e.Ra,i,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new NI,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=pt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new JD(r))}),this.da.forEach(r=>{e.has(r)||n.push(new XD(r))}),n}ba(e){this.Ta=e.Ts,this.da=pt();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return mh.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class kK{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class NK{constructor(e){this.key=e,this.va=!1}}class SK{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Ml(l=>Q4(l),Mv),this.Ma=new Map,this.xa=new Set,this.Oa=new kn(Ie.comparator),this.Na=new Map,this.La=new AS,this.Ba={},this.ka=new Map,this.qa=Qc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function TK(t,e,n=!0){const r=qv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await e5(r,e,n,!0),s}async function EK(t,e){const n=qv(t);await e5(n,e,!0,!1)}async function e5(t,e,n,r){const s=await b0(t.localStore,As(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await qS(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&Uv(t.remoteStore,s),l}async function qS(t,e,n,r,s){t.Ka=(m,p,v)=>async function(_,E,k,b){let S=E.view.ma(k);S.ns&&(S=await Uk(_.localStore,E.query,!1).then(({documents:I})=>E.view.ma(I,S)));const C=b&&b.targetChanges.get(E.targetId),P=b&&b.targetMismatches.get(E.targetId)!=null,R=E.view.applyChanges(S,_.isPrimaryClient,C,P);return Gk(_,E.targetId,R.wa),R.snapshot}(t,m,p,v);const i=await Uk(t.localStore,e,!0),a=new wK(e,i.Ts),l=a.ma(i.documents),u=cg.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=a.applyChanges(l,t.isPrimaryClient,u);Gk(t,n,d.wa);const f=new kK(e,n,a);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function CK(t,e,n){const r=ze(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!Mv(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await hh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&fh(r.remoteStore,s.targetId),ph(r,s.targetId)}).catch(Pl)):(ph(r,s.targetId),await hh(r.localStore,s.targetId,!0))}async function jK(t,e){const n=ze(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),fh(n.remoteStore,r.targetId))}async function IK(t,e,n){const r=KS(t);try{const s=await function(a,l){const u=ze(a),d=bn.now(),f=l.reduce((v,x)=>v.add(x.key),pt());let m,p;return u.persistence.runTransaction("Locally write mutations","readwrite",v=>{let x=Ts(),_=pt();return u.cs.getEntries(v,f).next(E=>{x=E,x.forEach((k,b)=>{b.isValidDocument()||(_=_.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(v,x)).next(E=>{m=E;const k=[];for(const b of l){const S=XH(b,m.get(b.key).overlayedDocument);S!=null&&k.push(new ua(b.key,S,V4(S.value.mapValue),Qn.exists(!0)))}return u.mutationQueue.addMutationBatch(v,d,k,l)}).next(E=>{p=E;const k=E.applyToLocalDocumentSet(m,_);return u.documentOverlayCache.saveOverlays(v,E.batchId,k)})}).then(()=>({batchId:p.batchId,changes:J4(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let d=a.Ba[a.currentUser.toKey()];d||(d=new kn(ot)),d=d.insert(l,u),a.Ba[a.currentUser.toKey()]=d}(r,s.batchId,n),await Ol(r,s.changes),await Vh(r.remoteStore)}catch(s){const i=FS(s,"Failed to persist write");n.reject(i)}}async function t5(t,e){const n=ze(t);try{const r=await ZG(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(We(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?We(a.va):s.removedDocuments.size>0&&(We(a.va),a.va=!1))}),await Ol(n,r,e)}catch(r){await Pl(r)}}function EI(t,e,n){const r=ze(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=ze(a);u.onlineState=l;let d=!1;u.queries.forEach((f,m)=>{for(const p of m.j_)p.Z_(l)&&(d=!0)}),d&&$S(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function AK(t,e,n){const r=ze(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new kn(Ie.comparator);a=a.insert(i,En.newNoDocument(i,Ke.min()));const l=pt().add(i),u=new lg(Ke.min(),new Map,new kn(ot),a,l);await t5(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),GS(r)}else await hh(r.localStore,e,!1).then(()=>ph(r,e,n)).catch(Pl)}async function RK(t,e){const n=ze(t),r=e.batch.batchId;try{const s=await QG(n.localStore,e);HS(n,r,null),WS(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ol(n,s)}catch(s){await Pl(s)}}async function PK(t,e,n){const r=ze(t);try{const s=await function(a,l){const u=ze(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,l).next(m=>(We(m!==null),f=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);HS(r,e,n),WS(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ol(r,s)}catch(s){await Pl(s)}}function WS(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function HS(t,e,n){const r=ze(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function ph(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||n5(t,r)})}function n5(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(fh(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),GS(t))}function Gk(t,e,n){for(const r of n)r instanceof XD?(t.La.addReference(r.key,e),LK(t,r)):r instanceof JD?(fe("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||n5(t,r.key)):Be()}function LK(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(fe("SyncEngine","New document in limbo: "+n),t.xa.add(r),GS(t))}function GS(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Ie(Mt.fromString(e)),r=t.qa.next();t.Na.set(r,new NK(n)),t.Oa=t.Oa.insert(n,r),Uv(t.remoteStore,new Uo(As(sg(n.path)),r,"TargetPurposeLimboResolution",is.oe))}}async function Ol(t,e,n){const r=ze(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){s.push(d);const m=PS.Wi(u.targetId,d);i.push(m)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,d){const f=ze(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>J.forEach(d,p=>J.forEach(p.$i,v=>f.persistence.referenceDelegate.addReference(m,p.targetId,v)).next(()=>J.forEach(p.Ui,v=>f.persistence.referenceDelegate.removeReference(m,p.targetId,v)))))}catch(m){if(!Ll(m))throw m;fe("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const p=m.targetId;if(!m.fromCache){const v=f.os.get(p),x=v.snapshotVersion,_=v.withLastLimboFreeSnapshotVersion(x);f.os=f.os.insert(p,_)}}}(r.localStore,i))}async function MK(t,e){const n=ze(t);if(!n.currentUser.isEqual(e)){fe("SyncEngine","User change. New user:",e.toKey());const r=await VD(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new we(oe.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ol(n,r.hs)}}function OK(t,e){const n=ze(t),r=n.Na.get(e);if(r&&r.va)return pt().add(r.key);{let s=pt();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}async function DK(t,e){const n=ze(t),r=await Uk(n.localStore,e.query,!0),s=e.view.ba(r);return n.isPrimaryClient&&Gk(n,e.targetId,s.wa),s}async function VK(t,e){const n=ze(t);return BD(n.localStore,e).then(r=>Ol(n,r))}async function FK(t,e,n,r){const s=ze(t),i=await function(l,u){const d=ze(l),f=ze(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>f.Mn(m,u).next(p=>p?d.localDocuments.getDocuments(m,p):J.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await Vh(s.remoteStore):n==="acknowledged"||n==="rejected"?(HS(s,e,r||null),WS(s,e),function(l,u){ze(ze(l).mutationQueue).On(u)}(s.localStore,e)):Be(),await Ol(s,i)):fe("SyncEngine","Cannot apply mutation batch with id: "+e)}async function zK(t,e){const n=ze(t);if(qv(n),KS(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await CI(n,r.toArray());n.Qa=!0,await Wk(n.remoteStore,!0);for(const i of s)Uv(n.remoteStore,i)}else if(e===!1&&n.Qa!==!1){const r=[];let s=Promise.resolve();n.Ma.forEach((i,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):s=s.then(()=>(ph(n,a),hh(n.localStore,a,!0))),fh(n.remoteStore,a)}),await s,await CI(n,r),function(a){const l=ze(a);l.Na.forEach((u,d)=>{fh(l.remoteStore,d)}),l.La.pr(),l.Na=new Map,l.Oa=new kn(Ie.comparator)}(n),n.Qa=!1,await Wk(n.remoteStore,!1)}}async function CI(t,e,n){const r=ze(t),s=[],i=[];for(const a of e){let l;const u=r.Ma.get(a);if(u&&u.length!==0){l=await b0(r.localStore,As(u[0]));for(const d of u){const f=r.Fa.get(d),m=await DK(r,f);m.snapshot&&i.push(m.snapshot)}}else{const d=await zD(r.localStore,a);l=await b0(r.localStore,d),await qS(r,r5(d),a,!1,l.resumeToken)}s.push(l)}return r.Ca.d_(i),s}function r5(t){return H4(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function BK(t){return function(n){return ze(ze(n).persistence).Qi()}(ze(t).localStore)}async function $K(t,e,n,r){const s=ze(t);if(s.Qa)return void fe("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const a=await BD(s.localStore,Z4(i[0])),l=lg.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Dn.EMPTY_BYTE_STRING);await Ol(s,a,l);break}case"rejected":await hh(s.localStore,e,!0),ph(s,e,r);break;default:Be()}}async function UK(t,e,n){const r=qv(t);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){fe("SyncEngine","Adding an already active target "+s);continue}const i=await zD(r.localStore,s),a=await b0(r.localStore,i);await qS(r,r5(i),a.targetId,!1,a.resumeToken),Uv(r.remoteStore,a)}for(const s of n)r.Ma.has(s)&&await hh(r.localStore,s,!1).then(()=>{fh(r.remoteStore,s),ph(r,s)}).catch(Pl)}}function qv(t){const e=ze(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=t5.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OK.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AK.bind(null,e),e.Ca.d_=bK.bind(null,e.eventManager),e.Ca.$a=_K.bind(null,e.eventManager),e}function KS(t){const e=ze(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=RK.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PK.bind(null,e),e}class vp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bv(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return DD(this.persistence,new OD,e.initialUser,this.serializer)}Ga(e){return new LD(zv.Zr,this.serializer)}Wa(e){return new UD}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vp.provider={build:()=>new vp};class s5 extends vp{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await KS(this.Ja.syncEngine),await Vh(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return DD(this.persistence,new OD,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new AG(r,e.asyncQueue,n)}Ha(e,n){const r=new lH(n,this.persistence);return new aH(e.asyncQueue,r)}Ga(e){const n=MD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?es.withCacheSize(this.cacheSizeBytes):es.DEFAULT;return new RS(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,qD(),vx(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new UD}}class qK extends s5{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof R_&&(this.sharedClientState.syncEngine={no:FK.bind(null,n),ro:$K.bind(null,n),io:UK.bind(null,n),Qi:BK.bind(null,n),eo:VK.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await zK(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=qD();if(!R_.D(n))throw new we(oe.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=MD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new R_(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class bp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>EI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=MK.bind(null,this.syncEngine),await Wk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vK}()}createDatastore(e){const n=Bv(e.databaseInfo.databaseId),r=function(i){return new nK(i)}(e.databaseInfo);return function(i,a,l,u){return new iK(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new aK(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>EI(this.syncEngine,n,0),function(){return wI.D()?new wI:new JG}())}createSyncEngine(e,n){return function(s,i,a,l,u,d,f){const m=new SK(s,i,a,l,u,d);return f&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ze(s);fe("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ug(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}bp.provider={build:()=>new bp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):On("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WK{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=sr.UNAUTHENTICATED,this.clientId=w4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{fe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(fe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ji;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=FS(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function L_(t,e){t.asyncQueue.verifyOperationInProgress(),fe("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await VD(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function jI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await HK(t);fe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>kI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>kI(e.remoteStore,s)),t._onlineComponents=e}async function HK(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){fe("FirestoreClient","Using user provided OfflineComponentProvider");try{await L_(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===oe.FAILED_PRECONDITION||s.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;sh("Error using user provided cache. Falling back to memory cache: "+n),await L_(t,new vp)}}else fe("FirestoreClient","Using default OfflineComponentProvider"),await L_(t,new vp);return t._offlineComponents}async function ZS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(fe("FirestoreClient","Using user provided OnlineComponentProvider"),await jI(t,t._uninitializedComponentsProvider._online)):(fe("FirestoreClient","Using default OnlineComponentProvider"),await jI(t,new bp))),t._onlineComponents}function GK(t){return ZS(t).then(e=>e.syncEngine)}function KK(t){return ZS(t).then(e=>e.datastore)}async function N0(t){const e=await ZS(t),n=e.eventManager;return n.onListen=TK.bind(null,e.syncEngine),n.onUnlisten=CK.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=EK.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=jK.bind(null,e.syncEngine),n}function QK(t,e,n={}){const r=new ji;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,d){const f=new QS({next:p=>{f.Za(),a.enqueueAndForget(()=>BS(i,m));const v=p.docs.has(l);!v&&p.fromCache?d.reject(new we(oe.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&p.fromCache&&u&&u.source==="server"?d.reject(new we(oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new US(sg(l.path),f,{includeMetadataChanges:!0,_a:!0});return zS(i,m)}(await N0(t),t.asyncQueue,e,n,r)),r.promise}function ZK(t,e,n={}){const r=new ji;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,d){const f=new QS({next:p=>{f.Za(),a.enqueueAndForget(()=>BS(i,m)),p.fromCache&&u.source==="server"?d.reject(new we(oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new US(l,f,{includeMetadataChanges:!0,_a:!0});return zS(i,m)}(await N0(t),t.asyncQueue,e,n,r)),r.promise}function YK(t,e,n){const r=new ji;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await KK(t);r.resolve(async function(a,l,u){var d;const f=ze(a),{request:m,ut:p,parent:v}=fG(f.serializer,BH(l),u);f.connection.Fo||delete m.parent;const x=(await f.Lo("RunAggregationQuery",f.serializer.databaseId,v,m,1)).filter(E=>!!E.result);We(x.length===1);const _=(d=x[0].result)===null||d===void 0?void 0:d.aggregateFields;return Object.keys(_).reduce((E,k)=>(E[p[k]]=_[k],E),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(t,e,n){if(!n)throw new we(oe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function XK(t,e,n,r){if(e===!0&&r===!0)throw new we(oe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function AI(t){if(!Ie.isDocumentKey(t))throw new we(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function RI(t){if(Ie.isDocumentKey(t))throw new we(oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Wv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Be()}function vr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wv(t);throw new we(oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function JK(t,e){if(e<=0)throw new we(oe.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new we(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new we(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}XK("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=i5((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new we(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new we(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new we(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dg{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new PI({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new PI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ZW;switch(r.type){case"firstParty":return new eH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new we(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=II.get(n);r&&(fe("ComponentProvider","Removing Datastore"),II.delete(n),r.terminate())}(this),Promise.resolve()}}function eQ(t,e,n,r={}){var s;const i=(t=vr(t,dg))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&sh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=sr.MOCK_USER;else{l=c8(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new we(oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new sr(d)}t._authCredentials=new YW(new _4(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new fo(this.firestore,e,this._query)}}class Pr{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pr(this.firestore,e,this._key)}}class dl extends fo{constructor(e,n,r){super(e,n,sg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pr(this.firestore,null,new Ie(e))}withConverter(e){return new dl(this.firestore,e,this._path)}}function Ce(t,e,...n){if(t=ln(t),YS("collection","path",e),t instanceof dg){const r=Mt.fromString(e,...n);return RI(r),new dl(t,null,r)}{if(!(t instanceof Pr||t instanceof dl))throw new we(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Mt.fromString(e,...n));return RI(r),new dl(t.firestore,null,r)}}function Zc(t,e){if(t=vr(t,dg),YS("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new we(oe.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new fo(t,null,function(r){return new mu(Mt.emptyPath(),r)}(e))}function ke(t,e,...n){if(t=ln(t),arguments.length===1&&(e=w4.newId()),YS("doc","path",e),t instanceof dg){const r=Mt.fromString(e,...n);return AI(r),new Pr(t,null,new Ie(r))}{if(!(t instanceof Pr||t instanceof dl))throw new we(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Mt.fromString(e,...n));return AI(r),new Pr(t.firestore,t instanceof dl?t.converter:null,new Ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new WD(this,"async_queue_retry"),this.Vu=()=>{const r=vx();r&&fe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=vx();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=vx();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new ji;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ll(e))throw e;fe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw On("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=VS.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Be()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function MI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Ri extends dg{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new LI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new LI(e),this._firestoreClient=void 0,await e}}}function tQ(t,e,n){n||(n="(default)");const r=Cv(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Dc(i,e))return s;throw new we(oe.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new we(oe.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new we(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function o5(t,e){const n=typeof t=="object"?t:tS(),r=typeof t=="string"?t:"(default)",s=Cv(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=a8("firestore");i&&eQ(s,...i)}return s}function zh(t){if(t._terminated)throw new we(oe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||nQ(t),t._firestoreClient}function nQ(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,d,f){return new IH(l,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,i5(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new WK(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rQ{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class sQ{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gh(Dn.fromBase64String(e))}catch(n){throw new we(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new gh(Dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new we(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new we(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new we(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iQ=/^__.*__$/;class oQ{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ua(e,this.data,this.fieldMask,n,this.fieldTransforms):new Dh(e,this.data,n,this.fieldTransforms)}}class a5{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ua(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function l5(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Be()}}class Hv{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Hv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return S0(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(l5(this.Cu)&&iQ.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class aQ{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Bv(e)}Qu(e,n,r,s=!1){return new Hv({Cu:e,methodName:n,qu:r,path:gn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fg(t){const e=t._freezeSettings(),n=Bv(t._databaseId);return new aQ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function eT(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);iT("Data must be an object, but it was:",a,r);const l=h5(r,a);let u,d;if(i.merge)u=new os(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const p=Kk(e,m,n);if(!a.contains(p))throw new we(oe.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);m5(f,p)||f.push(p)}u=new os(f),d=a.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=a.fieldTransforms;return new oQ(new Ar(l),u,d)}class mg extends gu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mg}}function c5(t,e,n){return new Hv({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class tT extends gu{_toFieldTransform(e){return new og(e.path,new ch)}isEqual(e){return e instanceof tT}}class nT extends gu{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=c5(this,e,!0),r=this.Ku.map(i=>yu(i,n)),s=new Wc(r);return new og(e.path,s)}isEqual(e){return e instanceof nT&&Dc(this.Ku,e.Ku)}}class rT extends gu{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=c5(this,e,!0),r=this.Ku.map(i=>yu(i,n)),s=new Hc(r);return new og(e.path,s)}isEqual(e){return e instanceof rT&&Dc(this.Ku,e.Ku)}}class sT extends gu{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new uh(e.serializer,nD(e.serializer,this.$u));return new og(e.path,n)}isEqual(e){return e instanceof sT&&this.$u===e.$u}}function u5(t,e,n,r){const s=t.Qu(1,e,n);iT("Data must be an object, but it was:",s,r);const i=[],a=Ar.empty();fu(r,(u,d)=>{const f=oT(e,u,n);d=ln(d);const m=s.Nu(f);if(d instanceof mg)i.push(f);else{const p=yu(d,m);p!=null&&(i.push(f),a.set(f,p))}});const l=new os(i);return new a5(a,l,s.fieldTransforms)}function d5(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Kk(e,r,n)],u=[s];if(i.length%2!=0)throw new we(oe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(Kk(e,i[p])),u.push(i[p+1]);const d=[],f=Ar.empty();for(let p=l.length-1;p>=0;--p)if(!m5(d,l[p])){const v=l[p];let x=u[p];x=ln(x);const _=a.Nu(v);if(x instanceof mg)d.push(v);else{const E=yu(x,_);E!=null&&(d.push(v),f.set(v,E))}}const m=new os(d);return new a5(f,m,a.fieldTransforms)}function lQ(t,e,n,r=!1){return yu(n,t.Qu(r?4:3,e))}function yu(t,e){if(f5(t=ln(t)))return iT("Unsupported field value:",e,t),h5(t,e);if(t instanceof gu)return function(r,s){if(!l5(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=yu(l,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=ln(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return nD(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=bn.fromDate(r);return{timestampValue:dh(s.serializer,i)}}if(r instanceof bn){const i=new bn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:dh(s.serializer,i)}}if(r instanceof XS)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gh)return{bytesValue:fD(s.serializer,r._byteString)};if(r instanceof Pr){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ES(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof JS)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return wS(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Wv(r)}`)}(t,e)}function h5(t,e){const n={};return L4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fu(t,(r,s)=>{const i=yu(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function f5(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof bn||t instanceof XS||t instanceof gh||t instanceof Pr||t instanceof gu||t instanceof JS)}function iT(t,e,n){if(!f5(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Wv(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Kk(t,e,n){if((e=ln(e))instanceof hg)return e._internalPath;if(typeof e=="string")return oT(t,e);throw S0("Field path arguments must be of type string or ",t,!1,void 0,n)}const cQ=new RegExp("[~\\*/\\[\\]]");function oT(t,e,n){if(e.search(cQ)>=0)throw S0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new hg(...e.split("."))._internalPath}catch{throw S0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function S0(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new we(oe.INVALID_ARGUMENT,l+t+u)}function m5(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Pr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new uQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Gv("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class uQ extends p5{data(){return super.data()}}function Gv(t,e){return typeof e=="string"?oT(t,e):e instanceof hg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g5(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class aT{}let lT=class extends aT{};function mt(t,e,...n){let r=[];e instanceof aT&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof cT).length,l=i.filter(u=>u instanceof Kv).length;if(a>1||a>0&&l>0)throw new we(oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Kv extends lT{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Kv(e,n,r)}_apply(e){const n=this._parse(e);return y5(e._query,n),new fo(e.firestore,e.converter,Mk(e._query,n))}_parse(e){const n=fg(e.firestore);return function(i,a,l,u,d,f,m){let p;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new we(oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){DI(m,f);const v=[];for(const x of m)v.push(OI(u,i,x));p={arrayValue:{values:v}}}else p=OI(u,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||DI(m,f),p=lQ(l,a,m,f==="in"||f==="not-in");return St.create(d,f,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function zt(t,e,n){const r=e,s=Gv("where",t);return Kv._create(s,r,n)}class cT extends aT{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new cT(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ft.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)y5(a,u),a=Mk(a,u)}(e._query,n),new fo(e.firestore,e.converter,Mk(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class uT extends lT{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new uT(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new we(oe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new we(oe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xp(i,a)}(e._query,this._field,this._direction);return new fo(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new mu(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function _n(t,e="asc"){const n=e,r=Gv("orderBy",t);return uT._create(r,n)}class dT extends lT{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new dT(e,n,r)}_apply(e){return new fo(e.firestore,e.converter,m0(e._query,this._limit,this._limitType))}}function fs(t){return JK("limit",t),dT._create("limit",t,"F")}function OI(t,e,n){if(typeof(n=ln(n))=="string"){if(n==="")throw new we(oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!G4(e)&&n.indexOf("/")!==-1)throw new we(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Mt.fromString(n));if(!Ie.isDocumentKey(r))throw new we(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return gp(t,new Ie(r))}if(n instanceof Pr)return gp(t,n._key);throw new we(oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wv(n)}.`)}function DI(t,e){if(!Array.isArray(t)||t.length===0)throw new we(oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function y5(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new we(oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class dQ{convertValue(e,n="none"){switch(Uc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(yl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Be()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return fu(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>dn(a.doubleValue));return new JS(i)}convertGeoPoint(e){return new XS(dn(e.latitude),dn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=vS(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(mp(e));default:return null}}convertTimestamp(e){const n=na(e);return new bn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Mt.fromString(e);We(wD(r));const s=new $c(r.get(1),r.get(3)),i=new Ie(r.popFirst(5));return s.isEqual(n)||On(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function hQ(){return new rQ("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class x5 extends p5{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new bx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Gv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class bx extends x5{data(e={}){return super.data(e)}}class v5{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new lm(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new bx(this._firestore,this._userDataWriter,r.key,r,new lm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new we(oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new bx(s._firestore,s._userDataWriter,l.doc.key,l.doc,new lm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new bx(s._firestore,s._userDataWriter,l.doc.key,l.doc,new lm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),f=a.indexOf(l.doc.key)),{type:fQ(l.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function fQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Be()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(t){t=vr(t,Pr);const e=vr(t.firestore,Ri);return QK(zh(e),t._key).then(n=>b5(e,t,n))}class Qv extends dQ{constructor(e){super(),this.firestore=e}convertBytes(e){return new gh(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pr(this.firestore,null,n)}}function Pt(t){t=vr(t,fo);const e=vr(t.firestore,Ri),n=zh(e),r=new Qv(e);return g5(t._query),ZK(n,t._query).then(s=>new v5(e,r,t,s))}function Ka(t,e,n){t=vr(t,Pr);const r=vr(t.firestore,Ri),s=hT(t.converter,e,n);return pg(r,[eT(fg(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Qn.none())])}function ft(t,e,n,...r){t=vr(t,Pr);const s=vr(t.firestore,Ri),i=fg(s);let a;return a=typeof(e=ln(e))=="string"||e instanceof hg?d5(i,"updateDoc",t._key,e,n,r):u5(i,"updateDoc",t._key,e),pg(s,[a.toMutation(t._key,Qn.exists(!0))])}function Pi(t){return pg(vr(t.firestore,Ri),[new ag(t._key,Qn.none())])}function Gt(t,e){const n=vr(t.firestore,Ri),r=ke(t),s=hT(t.converter,e);return pg(n,[eT(fg(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Qn.exists(!1))]).then(()=>r)}function Qt(t,...e){var n,r,s;t=ln(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||MI(e[a])||(i=e[a],a++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(MI(e[a])){const m=e[a];e[a]=(n=m.next)===null||n===void 0?void 0:n.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let u,d,f;if(t instanceof Pr)d=vr(t.firestore,Ri),f=sg(t._key.path),u={next:m=>{e[a]&&e[a](b5(d,t,m))},error:e[a+1],complete:e[a+2]};else{const m=vr(t,fo);d=vr(m.firestore,Ri),f=m._query;const p=new Qv(d);u={next:v=>{e[a]&&e[a](new v5(d,p,m,v))},error:e[a+1],complete:e[a+2]},g5(t._query)}return function(p,v,x,_){const E=new QS(_),k=new US(v,E,x);return p.asyncQueue.enqueueAndForget(async()=>zS(await N0(p),k)),()=>{E.Za(),p.asyncQueue.enqueueAndForget(async()=>BS(await N0(p),k))}}(zh(d),f,l,u)}function pg(t,e){return function(r,s){const i=new ji;return r.asyncQueue.enqueueAndForget(async()=>IK(await GK(r),s,i)),i.promise}(zh(t),e)}function b5(t,e,n){const r=n.docs.get(e._key),s=new Qv(t);return new x5(t,s,e._key,r,new lm(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(t){return mQ(t,{count:hQ()})}function mQ(t,e){const n=vr(t.firestore,Ri),r=zh(n),s=CH(e,(i,a)=>new JH(a,i.aggregateType,i._internalFieldPath));return YK(r,t._query,s).then(i=>function(l,u,d){const f=new Qv(l);return new sQ(u,f,d)}(n,t,i))}class pQ{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=vQ(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function gQ(t){return new pQ(t)}class yQ{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bp.provider,this._offlineComponentProvider={build:n=>new s5(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class xQ{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bp.provider,this._offlineComponentProvider={build:n=>new qK(n,e==null?void 0:e.cacheSizeBytes)}}}function vQ(t){return new yQ(void 0)}function bQ(){return new xQ}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Q{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=fg(e)}set(e,n,r){this._verifyNotCommitted();const s=M_(e,this._firestore),i=hT(s.converter,n,r),a=eT(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,Qn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=M_(e,this._firestore);let a;return a=typeof(n=ln(n))=="string"||n instanceof hg?d5(this._dataReader,"WriteBatch.update",i._key,n,r,s):u5(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,Qn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=M_(e,this._firestore);return this._mutations=this._mutations.concat(new ag(n._key,Qn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new we(oe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function M_(t,e){if((t=ln(t)).firestore!==e)throw new we(oe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wQ(){return new mg("deleteField")}function jt(){return new tT("serverTimestamp")}function _p(...t){return new nT("arrayUnion",t)}function kQ(...t){return new rT("arrayRemove",t)}function Ni(t){return new sT("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(t){return zh(t=vr(t,Ri)),new _Q(t,e=>pg(t,e))}(function(e,n=!0){(function(s){Oh=s})(Mh),nh(new Vc("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Ri(new XW(r.getProvider("auth-internal")),new nH(r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new we(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $c(d.options.projectId,f)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),ll(jj,"4.7.3",e),ll(jj,"4.7.3","esm2017")})();var NQ="firebase",SQ="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ll(NQ,SQ,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},TQ=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},EQ={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;u||(v=64,a||(p=64)),r.push(n[f],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_5(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):TQ(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw Error();const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},CQ=function(t){const e=_5(t);return EQ.encodeByteArray(e,!0)},w5=function(t){return CQ(t).replace(/\./g,"")};function jQ(){return typeof indexedDB=="object"}function IQ(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AQ="FirebaseError";let mT=class k5 extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=AQ,Object.setPrototypeOf(this,k5.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N5.prototype.create)}},N5=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?RQ(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new mT(s,l,r)}};function RQ(t,e){return t.replace(PQ,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const PQ=/\{\$([^}]+)}/g;let Qk=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(sn||(sn={}));const LQ={debug:sn.DEBUG,verbose:sn.VERBOSE,info:sn.INFO,warn:sn.WARN,error:sn.ERROR,silent:sn.SILENT},MQ=sn.INFO,OQ={[sn.DEBUG]:"log",[sn.VERBOSE]:"log",[sn.INFO]:"info",[sn.WARN]:"warn",[sn.ERROR]:"error"},DQ=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=OQ[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let VQ=class{constructor(e){this.name=e,this._logLevel=MQ,this._logHandler=DQ,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in sn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LQ[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,sn.DEBUG,...e),this._logHandler(this,sn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,sn.VERBOSE,...e),this._logHandler(this,sn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,sn.INFO,...e),this._logHandler(this,sn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,sn.WARN,...e),this._logHandler(this,sn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,sn.ERROR,...e),this._logHandler(this,sn.ERROR,...e)}};const FQ=(t,e)=>e.some(n=>t instanceof n);let VI,FI;function zQ(){return VI||(VI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BQ(){return FI||(FI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const S5=new WeakMap,Zk=new WeakMap,T5=new WeakMap,O_=new WeakMap,pT=new WeakMap;function $Q(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(hl(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&S5.set(n,t)}).catch(()=>{}),pT.set(e,t),e}function UQ(t){if(Zk.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Zk.set(t,e)}let Yk={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zk.get(t);if(e==="objectStoreNames")return t.objectStoreNames||T5.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return hl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function qQ(t){Yk=t(Yk)}function WQ(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(D_(this),e,...n);return T5.set(r,e.sort?e.sort():[e]),hl(r)}:BQ().includes(t)?function(...e){return t.apply(D_(this),e),hl(S5.get(this))}:function(...e){return hl(t.apply(D_(this),e))}}function HQ(t){return typeof t=="function"?WQ(t):(t instanceof IDBTransaction&&UQ(t),FQ(t,zQ())?new Proxy(t,Yk):t)}function hl(t){if(t instanceof IDBRequest)return $Q(t);if(O_.has(t))return O_.get(t);const e=HQ(t);return e!==t&&(O_.set(t,e),pT.set(e,t)),e}const D_=t=>pT.get(t);function GQ(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=hl(a);return r&&a.addEventListener("upgradeneeded",u=>{r(hl(a.result),u.oldVersion,u.newVersion,hl(a.transaction))}),n&&a.addEventListener("blocked",()=>n()),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),l}const KQ=["get","getKey","getAll","getAllKeys","count"],QQ=["put","add","delete","clear"],V_=new Map;function zI(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(V_.get(e))return V_.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=QQ.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||KQ.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return V_.set(e,i),i}qQ(t=>({...t,get:(e,n,r)=>zI(e,n)||t.get(e,n,r),has:(e,n)=>!!zI(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZQ{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(YQ(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function YQ(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xk="@firebase/app",BI="0.7.33";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc=new VQ("@firebase/app"),XQ="@firebase/app-compat",JQ="@firebase/analytics-compat",eZ="@firebase/analytics",tZ="@firebase/app-check-compat",nZ="@firebase/app-check",rZ="@firebase/auth",sZ="@firebase/auth-compat",iZ="@firebase/database",oZ="@firebase/database-compat",aZ="@firebase/functions",lZ="@firebase/functions-compat",cZ="@firebase/installations",uZ="@firebase/installations-compat",dZ="@firebase/messaging",hZ="@firebase/messaging-compat",fZ="@firebase/performance",mZ="@firebase/performance-compat",pZ="@firebase/remote-config",gZ="@firebase/remote-config-compat",yZ="@firebase/storage",xZ="@firebase/storage-compat",vZ="@firebase/firestore",bZ="@firebase/firestore-compat",_Z="firebase",wZ="9.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kZ="[DEFAULT]",NZ={[Xk]:"fire-core",[XQ]:"fire-core-compat",[eZ]:"fire-analytics",[JQ]:"fire-analytics-compat",[nZ]:"fire-app-check",[tZ]:"fire-app-check-compat",[rZ]:"fire-auth",[sZ]:"fire-auth-compat",[iZ]:"fire-rtdb",[oZ]:"fire-rtdb-compat",[aZ]:"fire-fn",[lZ]:"fire-fn-compat",[cZ]:"fire-iid",[uZ]:"fire-iid-compat",[dZ]:"fire-fcm",[hZ]:"fire-fcm-compat",[fZ]:"fire-perf",[mZ]:"fire-perf-compat",[pZ]:"fire-rc",[gZ]:"fire-rc-compat",[yZ]:"fire-gcs",[xZ]:"fire-gcs-compat",[vZ]:"fire-fst",[bZ]:"fire-fst-compat","fire-js":"fire-js",[_Z]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=new Map,$I=new Map;function SZ(t,e){try{t.container.addComponent(e)}catch(n){Yc.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function wp(t){const e=t.name;if($I.has(e))return Yc.debug(`There were multiple attempts to register component ${e}.`),!1;$I.set(e,t);for(const n of E5.values())SZ(n,t);return!0}function C5(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TZ={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Zv=new N5("app","Firebase",TZ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5=wZ;function I5(t=kZ){const e=E5.get(t);if(!e)throw Zv.create("no-app",{appName:t});return e}function Sc(t,e,n){var r;let s=(r=NZ[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yc.warn(l.join(" "));return}wp(new Qk(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EZ="firebase-heartbeat-database",CZ=1,kp="firebase-heartbeat-store";let F_=null;function A5(){return F_||(F_=GQ(EZ,CZ,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(kp)}}}).catch(t=>{throw Zv.create("idb-open",{originalErrorMessage:t.message})})),F_}async function jZ(t){var e;try{return(await A5()).transaction(kp).objectStore(kp).get(R5(t))}catch(n){if(n instanceof mT)Yc.warn(n.message);else{const r=Zv.create("idb-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message});Yc.warn(r.message)}}}async function UI(t,e){var n;try{const s=(await A5()).transaction(kp,"readwrite");return await s.objectStore(kp).put(e,R5(t)),s.done}catch(r){if(r instanceof mT)Yc.warn(r.message);else{const s=Zv.create("idb-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message});Yc.warn(s.message)}}}function R5(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IZ=1024,AZ=30*24*60*60*1e3;class RZ{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new LZ(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=qI();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=AZ}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=qI(),{heartbeatsToSend:n,unsentEntries:r}=PZ(this._heartbeatsCache.heartbeats),s=w5(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function qI(){return new Date().toISOString().substring(0,10)}function PZ(t,e=IZ){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),WI(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),WI(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class LZ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jQ()?IQ().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await jZ(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return UI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return UI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function WI(t){return w5(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MZ(t){wp(new Qk("platform-logger",e=>new ZQ(e),"PRIVATE")),wp(new Qk("heartbeat",e=>new RZ(e),"PRIVATE")),Sc(Xk,BI,t),Sc(Xk,BI,"esm2017"),Sc("fire-js","")}MZ("");var HI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P5=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},OZ=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},L5={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;u||(v=64,a||(p=64)),r.push(n[f],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(P5(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):OZ(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new DZ;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let DZ=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const VZ=function(t){const e=P5(t);return L5.encodeByteArray(e,!0)},GI=function(t){return VZ(t).replace(/\./g,"")},FZ=function(t){try{return L5.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zZ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BZ=()=>zZ().__FIREBASE_DEFAULTS__,$Z=()=>{if(typeof process>"u"||typeof HI>"u")return;const t=HI.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},UZ=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&FZ(t[1]);return e&&JSON.parse(e)},qZ=()=>{try{return BZ()||$Z()||UZ()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},WZ=t=>{var e,n;return(n=(e=qZ())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},HZ=t=>{const e=WZ(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GZ(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[GI(JSON.stringify(n)),GI(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KZ="FirebaseError";class Yv extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=KZ,Object.setPrototypeOf(this,Yv.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,QZ.prototype.create)}}class QZ{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?ZZ(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Yv(s,l,r)}}function ZZ(t,e){return t.replace(YZ,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const YZ=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(t){return t&&t._delegate?t._delegate:t}let XZ=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M5="firebasestorage.googleapis.com",O5="storageBucket",JZ=2*60*1e3,eY=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In extends Yv{constructor(e,n,r=0){super(z_(e),`Firebase Storage: ${n} (${z_(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,In.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return z_(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var jn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(jn||(jn={}));function z_(t){return"storage/"+t}function gT(){const t="An unknown error occurred, please check the error payload for server response.";return new In(jn.UNKNOWN,t)}function tY(t){return new In(jn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function nY(t){return new In(jn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function rY(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new In(jn.UNAUTHENTICATED,t)}function sY(){return new In(jn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function iY(t){return new In(jn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function oY(){return new In(jn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function aY(){return new In(jn.CANCELED,"User canceled the upload/download.")}function lY(t){return new In(jn.INVALID_URL,"Invalid URL '"+t+"'.")}function cY(t){return new In(jn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function uY(){return new In(jn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+O5+"' property when initializing the app?")}function dY(){return new In(jn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function hY(){return new In(jn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function fY(t){return new In(jn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Jk(t){return new In(jn.INVALID_ARGUMENT,t)}function D5(){return new In(jn.APP_DELETED,"The Firebase app was deleted.")}function mY(t){return new In(jn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Rm(t,e){return new In(jn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function zf(t){throw new In(jn.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Es.makeFromUrl(e,n)}catch{return new Es(e,"")}if(r.path==="")return r;throw cY(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(C){C.path.charAt(C.path.length-1)==="/"&&(C.path_=C.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+s+a,"i"),u={bucket:1,path:3};function d(C){C.path_=decodeURIComponent(C.path)}const f="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",v=new RegExp(`^https?://${m}/${f}/b/${s}/o${p}`,"i"),x={bucket:1,path:3},_=n===M5?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",k=new RegExp(`^https?://${_}/${s}/${E}`,"i"),S=[{regex:l,indices:u,postModify:i},{regex:v,indices:x,postModify:d},{regex:k,indices:{bucket:1,path:2},postModify:d}];for(let C=0;C<S.length;C++){const P=S[C],R=P.regex.exec(e);if(R){const I=R[P.indices.bucket];let j=R[P.indices.path];j||(j=""),r=new Es(I,j),P.postModify(r);break}}if(r==null)throw lY(e);return r}}class pY{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gY(t,e,n){let r=1,s=null,i=null,a=!1,l=0;function u(){return l===2}let d=!1;function f(...E){d||(d=!0,e.apply(null,E))}function m(E){s=setTimeout(()=>{s=null,t(v,u())},E)}function p(){i&&clearTimeout(i)}function v(E,...k){if(d){p();return}if(E){p(),f.call(null,E,...k);return}if(u()||a){p(),f.call(null,E,...k);return}r<64&&(r*=2);let S;l===1?(l=2,S=0):S=(r+Math.random())*1e3,m(S)}let x=!1;function _(E){x||(x=!0,p(),!d&&(s!==null?(E||(l=2),clearTimeout(s),m(0)):E||(l=1)))}return m(0),i=setTimeout(()=>{a=!0,_(!0)},n),_}function yY(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xY(t){return t!==void 0}function vY(t){return typeof t=="object"&&!Array.isArray(t)}function yT(t){return typeof t=="string"||t instanceof String}function KI(t){return xT()&&t instanceof Blob}function xT(){return typeof Blob<"u"}function QI(t,e,n,r){if(r<e)throw Jk(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Jk(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function V5(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Tc;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Tc||(Tc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bY(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Y{constructor(e,n,r,s,i,a,l,u,d,f,m,p=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=f,this.connectionFactory_=m,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new My(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=l=>{const u=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const l=i.getErrorCode()===Tc.NO_ERROR,u=i.getStatus();if(!l||bY(u,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===Tc.ABORT;r(!1,new My(!1,null,f));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new My(d,i))})},n=(r,s)=>{const i=this.resolve_,a=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());xY(u)?i(u):i()}catch(u){a(u)}else if(l!==null){const u=gT();u.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,u)):a(u)}else if(s.canceled){const u=this.appDelete_?D5():aY();a(u)}else{const u=oY();a(u)}};this.canceled_?n(!1,new My(!1,null,!0)):this.backoffId_=gY(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&yY(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class My{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function wY(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function kY(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function NY(t,e){e&&(t["X-Firebase-GMPID"]=e)}function SY(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function TY(t,e,n,r,s,i,a=!0){const l=V5(t.urlParams),u=t.url+l,d=Object.assign({},t.headers);return NY(d,e),wY(d,n),kY(d,i),SY(d,r),new _Y(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EY(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function CY(...t){const e=EY();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(xT())return new Blob(t);throw new In(jn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function jY(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IY(t){if(typeof atob>"u")throw fY("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class B_{constructor(e,n){this.data=e,this.contentType=n||null}}function AY(t,e){switch(t){case Qi.RAW:return new B_(F5(e));case Qi.BASE64:case Qi.BASE64URL:return new B_(z5(t,e));case Qi.DATA_URL:return new B_(PY(e),LY(e))}throw gT()}function F5(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=t.charCodeAt(++n);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function RY(t){let e;try{e=decodeURIComponent(t)}catch{throw Rm(Qi.DATA_URL,"Malformed data URL.")}return F5(e)}function z5(t,e){switch(t){case Qi.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Rm(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Qi.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Rm(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=IY(e)}catch(s){throw s.message.includes("polyfill")?s:Rm(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class B5{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Rm(Qi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=MY(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function PY(t){const e=new B5(t);return e.base64?z5(Qi.BASE64,e.rest):RY(e.rest)}function LY(t){return new B5(t).contentType}function MY(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,n){let r=0,s="";KI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(KI(this.data_)){const r=this.data_,s=jY(r,e,n);return s===null?null:new Ua(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ua(r,!0)}}static getBlob(...e){if(xT()){const n=e.map(r=>r instanceof Ua?r.data_:r);return new Ua(CY.apply(null,n))}else{const n=e.map(a=>yT(a)?AY(Qi.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(a=>{for(let l=0;l<a.length;l++)s[i++]=a[l]}),new Ua(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(t){let e;try{e=JSON.parse(t)}catch{return null}return vY(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OY(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function DY(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function U5(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VY(t,e){return e}class Vr{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||VY}}let Oy=null;function FY(t){return!yT(t)||t.length<2?t:U5(t)}function q5(){if(Oy)return Oy;const t=[];t.push(new Vr("bucket")),t.push(new Vr("generation")),t.push(new Vr("metageneration")),t.push(new Vr("name","fullPath",!0));function e(i,a){return FY(a)}const n=new Vr("name");n.xform=e,t.push(n);function r(i,a){return a!==void 0?Number(a):a}const s=new Vr("size");return s.xform=r,t.push(s),t.push(new Vr("timeCreated")),t.push(new Vr("updated")),t.push(new Vr("md5Hash",null,!0)),t.push(new Vr("cacheControl",null,!0)),t.push(new Vr("contentDisposition",null,!0)),t.push(new Vr("contentEncoding",null,!0)),t.push(new Vr("contentLanguage",null,!0)),t.push(new Vr("contentType",null,!0)),t.push(new Vr("metadata","customMetadata",!0)),Oy=t,Oy}function zY(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Es(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function BY(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const a=n[i];r[a.local]=a.xform(r,e[a.server])}return zY(r,t),r}function W5(t,e,n){const r=$5(e);return r===null?null:BY(t,r,n)}function $Y(t,e,n,r){const s=$5(e);if(s===null||!yT(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(d=>{const f=t.bucket,m=t.fullPath,p="/b/"+a(f)+"/o/"+a(m),v=vT(p,n,r),x=V5({alt:"media",token:d});return v+x})[0]}function UY(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class H5{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G5(t){if(!t)throw gT()}function qY(t,e){function n(r,s){const i=W5(t,s,e);return G5(i!==null),i}return n}function WY(t,e){function n(r,s){const i=W5(t,s,e);return G5(i!==null),$Y(i,s,t.host,t._protocol)}return n}function K5(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=sY():s=rY():n.getStatus()===402?s=nY(t.bucket):n.getStatus()===403?s=iY(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function HY(t){const e=K5(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=tY(t.path)),i.serverResponse=s.serverResponse,i}return n}function GY(t,e,n){const r=e.fullServerUrl(),s=vT(r,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,l=new H5(s,i,WY(t,n),a);return l.errorHandler=HY(e),l}function KY(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function QY(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=KY(null,e)),r}function ZY(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let C=0;C<2;C++)S=S+Math.random().toString().slice(2);return S}const u=l();a["Content-Type"]="multipart/related; boundary="+u;const d=QY(e,r,s),f=UY(d,n),m="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+u+"--",v=Ua.getBlob(m,r,p);if(v===null)throw dY();const x={name:d.fullPath},_=vT(i,t.host,t._protocol),E="POST",k=t.maxUploadRetryTime,b=new H5(_,E,qY(t,n),k);return b.urlParams=x,b.headers=a,b.body=v.uploadData(),b.errorHandler=K5(e),b}class YY{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Tc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Tc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Tc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw zf("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw zf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw zf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw zf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw zf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class XY extends YY{initXhr(){this.xhr_.responseType="text"}}function Q5(){return new XY}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n){this._service=e,n instanceof Es?this._location=n:this._location=Es.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Xc(e,n)}get root(){const e=new Es(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return U5(this._location.path)}get storage(){return this._service}get parent(){const e=OY(this._location.path);if(e===null)return null;const n=new Es(this._location.bucket,e);return new Xc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw mY(e)}}function JY(t,e,n){t._throwIfRoot("uploadBytes");const r=ZY(t.storage,t._location,q5(),new Ua(e,!0),n);return t.storage.makeRequestWithTokens(r,Q5).then(s=>({metadata:s,ref:t}))}function eX(t){t._throwIfRoot("getDownloadURL");const e=GY(t.storage,t._location,q5());return t.storage.makeRequestWithTokens(e,Q5).then(n=>{if(n===null)throw hY();return n})}function tX(t,e){const n=DY(t._location.path,e),r=new Es(t._location.bucket,n);return new Xc(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nX(t){return/^[A-Za-z]+:\/\//.test(t)}function rX(t,e){return new Xc(t,e)}function Z5(t,e){if(t instanceof bT){const n=t;if(n._bucket==null)throw uY();const r=new Xc(n,n._bucket);return e!=null?Z5(r,e):r}else return e!==void 0?tX(t,e):t}function sX(t,e){if(e&&nX(e)){if(t instanceof bT)return rX(t,e);throw Jk("To use ref(service, url), the first argument must be a Storage instance.")}else return Z5(t,e)}function ZI(t,e){const n=e==null?void 0:e[O5];return n==null?null:Es.makeFromBucketSpec(n,t)}function iX(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:GZ(s,t.app.options.projectId))}class bT{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=M5,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=JZ,this._maxUploadRetryTime=eY,this._requests=new Set,s!=null?this._bucket=Es.makeFromBucketSpec(s,this._host):this._bucket=ZI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Es.makeFromBucketSpec(this._url,e):this._bucket=ZI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){QI("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){QI("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xc(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new pY(D5());{const a=TY(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const YI="@firebase/storage",XI="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5="storage";function X5(t,e,n){return t=Xv(t),JY(t,e,n)}function J5(t){return t=Xv(t),eX(t)}function e3(t,e){return t=Xv(t),sX(t,e)}function oX(t=I5(),e){t=Xv(t);const r=C5(t,Y5).getImmediate({identifier:e}),s=HZ("storage");return s&&aX(r,...s),r}function aX(t,e,n,r={}){iX(t,e,n,r)}function lX(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new bT(n,r,s,e,j5)}function cX(){wp(new XZ(Y5,lX,"PUBLIC").setMultipleInstances(!0)),Sc(YI,XI,""),Sc(YI,XI,"esm2017")}cX();var JI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _e=function(t,e){if(!t)throw Bh(e)},Bh=function(t){return new Error("Firebase Database ("+t3.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},uX=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},_T={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;u||(v=64,a||(p=64)),r.push(n[f],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(n3(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):uX(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new dX;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dX extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const r3=function(t){const e=n3(t);return _T.encodeByteArray(e,!0)},eA=function(t){return r3(t).replace(/\./g,"")},e1=function(t){try{return _T.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hX(t){return s3(void 0,t)}function s3(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!fX(n)||(t[n]=s3(t[n],e[n]));return t}function fX(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mX(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pX=()=>mX().__FIREBASE_DEFAULTS__,gX=()=>{if(typeof process>"u"||typeof JI>"u")return;const t=JI.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},yX=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&e1(t[1]);return e&&JSON.parse(e)},xX=()=>{try{return pX()||gX()||yX()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},vX=t=>{var e,n;return(n=(e=xX())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},bX=t=>{const e=vX(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _X(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[eA(JSON.stringify(n)),eA(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wX(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function i3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wX())}function kX(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NX(){return t3.NODE_ADMIN===!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(t){return JSON.parse(t)}function ar(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=Np(e1(i[0])||""),n=Np(e1(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},SX=function(t){const e=o3(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},TX=function(t){const e=o3(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function yh(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function tA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function E0(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EX(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CX{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)r[m]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let m=0;m<16;m++)r[m]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let m=16;m<80;m++){const p=r[m-3]^r[m-8]^r[m-14]^r[m-16];r[m]=(p<<1|p>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],a=this.chain_[2],l=this.chain_[3],u=this.chain_[4],d,f;for(let m=0;m<80;m++){m<40?m<20?(d=l^i&(a^l),f=1518500249):(d=i^a^l,f=1859775393):m<60?(d=i&a|l&(i|a),f=2400959708):(d=i^a^l,f=3395469782);const p=(s<<5|s>>>27)+d+u+f+r[m]&4294967295;u=l,l=a,a=(i<<30|i>>>2)&4294967295,i=s,s=p}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let a=this.inbuf_;for(;s<n;){if(a===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[a]=e.charCodeAt(s),++a,++s,a===this.blockSize){this.compress_(i),a=0;break}}else for(;s<n;)if(i[a]=e[s],++a,++s,a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function eb(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jX=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,_e(r<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(r)-56320;s=65536+(i<<10)+a}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},tb=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(t){return t&&t._delegate?t._delegate:t}class IX{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Yt||(Yt={}));const AX={debug:Yt.DEBUG,verbose:Yt.VERBOSE,info:Yt.INFO,warn:Yt.WARN,error:Yt.ERROR,silent:Yt.SILENT},RX=Yt.INFO,PX={[Yt.DEBUG]:"log",[Yt.VERBOSE]:"log",[Yt.INFO]:"info",[Yt.WARN]:"warn",[Yt.ERROR]:"error"},LX=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=PX[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class MX{constructor(e){this.name=e,this._logLevel=RX,this._logHandler=LX,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AX[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Yt.DEBUG,...e),this._logHandler(this,Yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Yt.VERBOSE,...e),this._logHandler(this,Yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Yt.INFO,...e),this._logHandler(this,Yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Yt.WARN,...e),this._logHandler(this,Yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Yt.ERROR,...e),this._logHandler(this,Yt.ERROR,...e)}}var nA={};const rA="@firebase/database",sA="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a3="";function OX(t){a3=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DX{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ar(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Np(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VX{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return mo(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new DX(e)}}catch{}return new VX},yc=l3("localStorage"),FX=l3("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud=new MX("@firebase/database"),zX=function(){let t=1;return function(){return t++}}(),c3=function(t){const e=jX(t),n=new CX;n.update(e);const r=n.digest();return _T.encodeByteArray(r)},gg=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=gg.apply(null,r):typeof r=="object"?e+=ar(r):e+=r,e+=" "}return e};let Pm=null,iA=!0;const BX=function(t,e){_e(!0,"Can't turn on custom loggers persistently."),Ud.logLevel=Yt.VERBOSE,Pm=Ud.log.bind(Ud)},yr=function(...t){if(iA===!0&&(iA=!1,Pm===null&&FX.get("logging_enabled")===!0&&BX()),Pm){const e=gg.apply(null,t);Pm(e)}},yg=function(t){return function(...e){yr(t,...e)}},t1=function(...t){const e="FIREBASE INTERNAL ERROR: "+gg(...t);Ud.error(e)},ra=function(...t){const e=`FIREBASE FATAL ERROR: ${gg(...t)}`;throw Ud.error(e),new Error(e)},Hr=function(...t){const e="FIREBASE WARNING: "+gg(...t);Ud.warn(e)},$X=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Hr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},wT=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},UX=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Jc="[MIN_NAME]",bl="[MAX_NAME]",vu=function(t,e){if(t===e)return 0;if(t===Jc||e===bl)return-1;if(e===Jc||t===bl)return 1;{const n=oA(t),r=oA(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},qX=function(t,e){return t===e?0:t<e?-1:1},Bf=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ar(e))},kT=function(t){if(typeof t!="object"||t===null)return ar(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=ar(e[r]),n+=":",n+=kT(t[e[r]]);return n+="}",n},u3=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function _r(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const d3=function(t){_e(!wT(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,a,l,u;t===0?(i=0,a=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=l+r,a=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(i=0,a=Math.round(t/Math.pow(2,1-r-n))));const d=[];for(u=n;u;u-=1)d.push(a%2?1:0),a=Math.floor(a/2);for(u=e;u;u-=1)d.push(i%2?1:0),i=Math.floor(i/2);d.push(s?1:0),d.reverse();const f=d.join("");let m="";for(u=0;u<64;u+=8){let p=parseInt(f.substr(u,8),2).toString(16);p.length===1&&(p="0"+p),m=m+p}return m.toLowerCase()},WX=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},HX=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function GX(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const KX=new RegExp("^-?(0*)\\d{1,10}$"),QX=-2147483648,ZX=2147483647,oA=function(t){if(KX.test(t)){const e=Number(t);if(e>=QX&&e<=ZX)return e}return null},$h=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Hr("Exception was thrown by user callback.",n),e},Math.floor(0))}},YX=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Lm=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XX{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Hr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JX{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(yr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Hr(e)}}class _x{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}_x.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT="5",h3="v",f3="s",m3="r",p3="f",g3=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,y3="ls",x3="p",n1="ac",v3="websocket",b3="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _3{constructor(e,n,r,s,i=!1,a="",l=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=yc.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&yc.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function eJ(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function w3(t,e,n){_e(typeof e=="string","typeof type must == string"),_e(typeof n=="object","typeof params must == object");let r;if(e===v3)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===b3)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);eJ(t)&&(n.ns=t.namespace);const s=[];return _r(n,(i,a)=>{s.push(i+"="+a)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tJ{constructor(){this.counters_={}}incrementCounter(e,n=1){mo(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return hX(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_={},U_={};function ST(t){const e=t.toString();return $_[e]||($_[e]=new tJ),$_[e]}function nJ(t,e){const n=t.toString();return U_[n]||(U_[n]=e()),U_[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rJ{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&$h(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="start",sJ="close",iJ="pLPCommand",oJ="pRTLPCB",k3="id",N3="pw",S3="ser",aJ="cb",lJ="seg",cJ="ts",uJ="d",dJ="dframe",T3=1870,E3=30,hJ=T3-E3,fJ=25e3,mJ=3e4;class Nd{constructor(e,n,r,s,i,a,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=yg(e),this.stats_=ST(n),this.urlFn=u=>(this.appCheckToken&&(u[n1]=this.appCheckToken),w3(n,b3,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new rJ(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(mJ)),UX(()=>{if(this.isClosed_)return;this.scriptTagHolder=new TT((...i)=>{const[a,l,u,d,f]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===aA)this.id=l,this.password=u;else if(a===sJ)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...i)=>{const[a,l]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[aA]="t",r[S3]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[aJ]=this.scriptTagHolder.uniqueCallbackIdentifier),r[h3]=NT,this.transportSessionId&&(r[f3]=this.transportSessionId),this.lastSessionId&&(r[y3]=this.lastSessionId),this.applicationId&&(r[x3]=this.applicationId),this.appCheckToken&&(r[n1]=this.appCheckToken),typeof location<"u"&&location.hostname&&g3.test(location.hostname)&&(r[m3]=p3);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Nd.forceAllow_=!0}static forceDisallow(){Nd.forceDisallow_=!0}static isAvailable(){return Nd.forceAllow_?!0:!Nd.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!WX()&&!HX()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ar(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=r3(n),s=u3(r,hJ);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[dJ]="t",r[k3]=e,r[N3]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ar(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class TT{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=zX(),window[iJ+this.uniqueCallbackIdentifier]=e,window[oJ+this.uniqueCallbackIdentifier]=n,this.myIFrame=TT.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){yr("frame writing exception"),l.stack&&yr(l.stack),yr(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||yr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[k3]=this.myID,e[N3]=this.myPW,e[S3]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+E3+r.length<=T3;){const a=this.pendingSegs.shift();r=r+"&"+lJ+s+"="+a.seg+"&"+cJ+s+"="+a.ts+"&"+uJ+s+"="+a.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(fJ)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{yr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pJ=16384,gJ=45e3;let C0=null;typeof MozWebSocket<"u"?C0=MozWebSocket:typeof WebSocket<"u"&&(C0=WebSocket);class bi{constructor(e,n,r,s,i,a,l){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=yg(this.connId),this.stats_=ST(n),this.connURL=bi.connectionURL_(n,a,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const a={};return a[h3]=NT,typeof location<"u"&&location.hostname&&g3.test(location.hostname)&&(a[m3]=p3),n&&(a[f3]=n),r&&(a[y3]=r),s&&(a[n1]=s),i&&(a[x3]=i),w3(e,v3,a)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,yc.set("previous_websocket_failure",!0);try{let r;NX(),this.mySock=new C0(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){bi.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&C0!==null&&!bi.forceDisallow_}static previouslyFailed(){return yc.isInMemoryStorage||yc.get("previous_websocket_failure")===!0}markConnectionHealthy(){yc.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Np(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(_e(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=ar(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=u3(n,pJ);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(gJ))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}bi.responsesRequiredToBeHealthy=2;bi.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Nd,bi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=bi&&bi.isAvailable();let r=n&&!bi.previouslyFailed();if(e.webSocketOnly&&(n||Hr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[bi];else{const s=this.transports_=[];for(const i of Sp.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Sp.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Sp.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yJ=6e4,xJ=5e3,vJ=10*1024,bJ=100*1024,q_="t",lA="d",_J="s",cA="r",wJ="e",uA="o",dA="a",hA="n",fA="p",kJ="h";class NJ{constructor(e,n,r,s,i,a,l,u,d,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=u,this.onKill_=d,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=yg("c:"+this.id+":"),this.transportManager_=new Sp(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Lm(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>bJ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>vJ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(q_ in e){const n=e[q_];n===dA?this.upgradeIfSecondaryHealthy_():n===cA?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===uA&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Bf("t",e),r=Bf("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:fA,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:dA,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:hA,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Bf("t",e),r=Bf("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Bf(q_,e);if(lA in e){const r=e[lA];if(n===kJ){const s=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===hA){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===_J?this.onConnectionShutdown_(r):n===cA?this.onReset_(r):n===wJ?t1("Server Error: "+r):n===uA?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):t1("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),NT!==r&&Hr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Lm(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(yJ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Lm(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(xJ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:fA,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(yc.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(e){this.allowedEvents_=e,this.listeners_={},_e(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){_e(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0 extends j3{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!i3()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new j0}getInitialEvent(e){return _e(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=32,pA=768;class $t{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Ot(){return new $t("")}function yt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function _l(t){return t.pieces_.length-t.pieceNum_}function Xt(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new $t(t.pieces_,e)}function ET(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function SJ(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Tp(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function I3(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new $t(e,0)}function Cn(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof $t)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new $t(n,0)}function xt(t){return t.pieceNum_>=t.pieces_.length}function as(t,e){const n=yt(t),r=yt(e);if(n===null)return e;if(n===r)return as(Xt(t),Xt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function TJ(t,e){const n=Tp(t,0),r=Tp(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=vu(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function CT(t,e){if(_l(t)!==_l(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function ni(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(_l(t)>_l(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class EJ{constructor(e,n){this.errorPrefix_=n,this.parts_=Tp(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=tb(this.parts_[r]);A3(this)}}function CJ(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=tb(e),A3(t)}function jJ(t){const e=t.parts_.pop();t.byteLength_-=tb(e),t.parts_.length>0&&(t.byteLength_-=1)}function A3(t){if(t.byteLength_>pA)throw new Error(t.errorPrefix_+"has a key path longer than "+pA+" bytes ("+t.byteLength_+").");if(t.parts_.length>mA)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+mA+") or object contains a cycle "+ic(t))}function ic(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT extends j3{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new jT}getInitialEvent(e){return _e(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f=1e3,IJ=60*5*1e3,gA=30*1e3,AJ=1.3,RJ=3e4,PJ="server_kill",yA=3;class Ho extends C3{constructor(e,n,r,s,i,a,l,u){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=Ho.nextPersistentConnectionId_++,this.log_=yg("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=$f,this.maxReconnectDelay_=IJ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");jT.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&j0.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(ar(i)),_e(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Jv,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const l=a.d;a.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),_e(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),_e(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(a).set(i,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},a="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(a,i,l=>{const u=l.d,d=l.s;Ho.warnOnListenWarnings_(u,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(d,u))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&mo(e,"w")){const r=yh(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Hr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||TX(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=gA)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=SX(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,a=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),_e(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},a="n";s&&(i.q=r,i.t=s),this.sendRequest(a,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const a={p:n,d:r};i!==void 0&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ar(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):t1("Unrecognized action received from server: "+ar(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){_e(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=$f,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=$f,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RJ&&(this.reconnectDelay_=$f),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*AJ)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ho.nextConnectionId_++,i=this.lastSessionId;let a=!1,l=null;const u=function(){l?l.close():(a=!0,r())},d=function(m){_e(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(m)};this.realtime_={close:u,sendRequest:d};const f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,p]=await Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?yr("getToken() completed but was canceled"):(yr("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=p&&p.token,l=new NJ(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,v=>{Hr(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(PJ)},i))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&Hr(m),u())}}}interrupt(e){yr("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){yr("Resuming connection for reason: "+e),delete this.interruptReasons_[e],tA(this.interruptReasons_)&&(this.reconnectDelay_=$f,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>kT(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new $t(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){yr("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=yA&&(this.reconnectDelay_=gA,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){yr("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=yA&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+a3.replace(/\./g,"-")]=1,i3()?e["framework.cordova"]=1:kX()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=j0.getInstance().currentlyOnline();return tA(this.interruptReasons_)&&e}}Ho.nextPersistentConnectionId_=0;Ho.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new vt(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new vt(Jc,e),s=new vt(Jc,n);return this.compare(r,s)!==0}minPost(){return vt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dy;class R3 extends nb{static get __EMPTY_NODE(){return Dy}static set __EMPTY_NODE(e){Dy=e}compare(e,n){return vu(e.name,n.name)}isDefinedOn(e){throw Bh("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return vt.MIN}maxPost(){return new vt(bl,Dy)}makePost(e,n){return _e(typeof e=="string","KeyIndex indexValue must always be a string."),new vt(e,Dy)}toString(){return".key"}}const Ec=new R3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=n?r(e.key,n):1,s&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ir{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ir.RED,this.left=s??ls.EMPTY_NODE,this.right=i??ls.EMPTY_NODE}copy(e,n,r,s,i){return new ir(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ls.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return ls.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ir.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ir.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ir.RED=!0;ir.BLACK=!1;class LJ{copy(e,n,r,s,i){return this}insert(e,n,r){return new ir(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class ls{constructor(e,n=ls.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new ls(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ir.BLACK,null,null))}remove(e){return new ls(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ir.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Vy(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Vy(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Vy(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Vy(this.root_,null,this.comparator_,!0,e)}}ls.EMPTY_NODE=new LJ;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MJ(t,e){return vu(t.name,e.name)}function IT(t,e){return vu(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r1;function OJ(t){r1=t}const P3=function(t){return typeof t=="number"?"number:"+d3(t):"string:"+t},L3=function(t){if(t.isLeafNode()){const e=t.val();_e(typeof e=="string"||typeof e=="number"||typeof e=="object"&&mo(e,".sv"),"Priority must be a string or number.")}else _e(t===r1||t.isEmpty(),"priority of unexpected type.");_e(t===r1||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xA;class tr{constructor(e,n=tr.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,_e(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),L3(this.priorityNode_)}static set __childrenNodeConstructor(e){xA=e}static get __childrenNodeConstructor(){return xA}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new tr(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:tr.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return xt(e)?this:yt(e)===".priority"?this.priorityNode_:tr.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:tr.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=yt(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(_e(r!==".priority"||_l(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,tr.__childrenNodeConstructor.EMPTY_NODE.updateChild(Xt(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+P3(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=d3(this.value_):e+=this.value_,this.lazyHash_=c3(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===tr.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof tr.__childrenNodeConstructor?-1:(_e(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=tr.VALUE_TYPE_ORDER.indexOf(n),i=tr.VALUE_TYPE_ORDER.indexOf(r);return _e(s>=0,"Unknown leaf type: "+n),_e(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}tr.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let M3,O3;function DJ(t){M3=t}function VJ(t){O3=t}class FJ extends nb{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?vu(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return vt.MIN}maxPost(){return new vt(bl,new tr("[PRIORITY-POST]",O3))}makePost(e,n){const r=M3(e);return new vt(n,new tr("[PRIORITY-POST]",r))}toString(){return".priority"}}const xn=new FJ;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zJ=Math.log(2);class BJ{constructor(e){const n=i=>parseInt(Math.log(i)/zJ,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const I0=function(t,e,n,r){t.sort(e);const s=function(u,d){const f=d-u;let m,p;if(f===0)return null;if(f===1)return m=t[u],p=n?n(m):m,new ir(p,m.node,ir.BLACK,null,null);{const v=parseInt(f/2,10)+u,x=s(u,v),_=s(v+1,d);return m=t[v],p=n?n(m):m,new ir(p,m.node,ir.BLACK,x,_)}},i=function(u){let d=null,f=null,m=t.length;const p=function(x,_){const E=m-x,k=m;m-=x;const b=s(E+1,k),S=t[E],C=n?n(S):S;v(new ir(C,S.node,_,null,b))},v=function(x){d?(d.left=x,d=x):(f=x,d=x)};for(let x=0;x<u.count;++x){const _=u.nextBitIsOne(),E=Math.pow(2,u.count-(x+1));_?p(E,ir.BLACK):(p(E,ir.BLACK),p(E,ir.RED))}return f},a=new BJ(t.length),l=i(a);return new ls(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let W_;const nd={};class qo{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return _e(nd&&xn,"ChildrenNode.ts has not been loaded"),W_=W_||new qo({".priority":nd},{".priority":xn}),W_}get(e){const n=yh(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof ls?n:null}hasIndex(e){return mo(this.indexSet_,e.toString())}addIndex(e,n){_e(e!==Ec,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(vt.Wrap);let a=i.getNext();for(;a;)s=s||e.isDefinedOn(a.node),r.push(a),a=i.getNext();let l;s?l=I0(r,e.getCompare()):l=nd;const u=e.toString(),d=Object.assign({},this.indexSet_);d[u]=e;const f=Object.assign({},this.indexes_);return f[u]=l,new qo(f,d)}addToIndexes(e,n){const r=E0(this.indexes_,(s,i)=>{const a=yh(this.indexSet_,i);if(_e(a,"Missing index implementation for "+i),s===nd)if(a.isDefinedOn(e.node)){const l=[],u=n.getIterator(vt.Wrap);let d=u.getNext();for(;d;)d.name!==e.name&&l.push(d),d=u.getNext();return l.push(e),I0(l,a.getCompare())}else return nd;else{const l=n.get(e.name);let u=s;return l&&(u=u.remove(new vt(e.name,l))),u.insert(e,e.node)}});return new qo(r,this.indexSet_)}removeFromIndexes(e,n){const r=E0(this.indexes_,s=>{if(s===nd)return s;{const i=n.get(e.name);return i?s.remove(new vt(e.name,i)):s}});return new qo(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uf;class rt{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&L3(this.priorityNode_),this.children_.isEmpty()&&_e(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Uf||(Uf=new rt(new ls(IT),null,qo.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Uf}updatePriority(e){return this.children_.isEmpty()?this:new rt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Uf:n}}getChild(e){const n=yt(e);return n===null?this:this.getImmediateChild(n).getChild(Xt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(_e(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new vt(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const a=s.isEmpty()?Uf:this.priorityNode_;return new rt(s,a,i)}}updateChild(e,n){const r=yt(e);if(r===null)return n;{_e(yt(e)!==".priority"||_l(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Xt(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(xn,(a,l)=>{n[a]=l.val(e),r++,i&&rt.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):i=!1}),!e&&i&&s<2*r){const a=[];for(const l in n)a[l]=n[l];return a}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+P3(this.getPriority().val())+":"),this.forEachChild(xn,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":c3(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new vt(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new vt(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new vt(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,vt.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,vt.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===xg?-1:0}withIndex(e){if(e===Ec||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new rt(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ec||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(xn),s=n.getIterator(xn);let i=r.getNext(),a=s.getNext();for(;i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=r.getNext(),a=s.getNext()}return i===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===Ec?null:this.indexMap_.get(e.toString())}}rt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class $J extends rt{constructor(){super(new ls(IT),rt.EMPTY_NODE,qo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return rt.EMPTY_NODE}isEmpty(){return!1}}const xg=new $J;Object.defineProperties(vt,{MIN:{value:new vt(Jc,rt.EMPTY_NODE)},MAX:{value:new vt(bl,xg)}});R3.__EMPTY_NODE=rt.EMPTY_NODE;tr.__childrenNodeConstructor=rt;OJ(xg);VJ(xg);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UJ=!0;function or(t,e=null){if(t===null)return rt.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),_e(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new tr(n,or(e))}if(!(t instanceof Array)&&UJ){const n=[];let r=!1;if(_r(t,(a,l)=>{if(a.substring(0,1)!=="."){const u=or(l);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new vt(a,u)))}}),n.length===0)return rt.EMPTY_NODE;const i=I0(n,MJ,a=>a.name,IT);if(r){const a=I0(n,xn.getCompare());return new rt(i,or(e),new qo({".priority":a},{".priority":xn}))}else return new rt(i,or(e),qo.Default)}else{let n=rt.EMPTY_NODE;return _r(t,(r,s)=>{if(mo(t,r)&&r.substring(0,1)!=="."){const i=or(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(or(e))}}DJ(or);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT extends nb{constructor(e){super(),this.indexPath_=e,_e(!xt(e)&&yt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?vu(e.name,n.name):i}makePost(e,n){const r=or(e),s=rt.EMPTY_NODE.updateChild(this.indexPath_,r);return new vt(n,s)}maxPost(){const e=rt.EMPTY_NODE.updateChild(this.indexPath_,xg);return new vt(bl,e)}toString(){return Tp(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qJ extends nb{compare(e,n){const r=e.node.compareTo(n.node);return r===0?vu(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return vt.MIN}maxPost(){return vt.MAX}makePost(e,n){const r=or(e);return new vt(n,r)}toString(){return".value"}}const D3=new qJ;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(t){return{type:"value",snapshotNode:t}}function xh(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ep(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Cp(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function WJ(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e){this.index_=e}updateChild(e,n,r,s,i,a){_e(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(r.getChild(s))&&l.isEmpty()===r.isEmpty()||(a!=null&&(r.isEmpty()?e.hasChild(n)?a.trackChildChange(Ep(n,l)):_e(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?a.trackChildChange(xh(n,r)):a.trackChildChange(Cp(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(xn,(s,i)=>{n.hasChild(s)||r.trackChildChange(Ep(s,i))}),n.isLeafNode()||n.forEachChild(xn,(s,i)=>{if(e.hasChild(s)){const a=e.getImmediateChild(s);a.equals(i)||r.trackChildChange(Cp(s,i,a))}else r.trackChildChange(xh(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?rt.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e){this.indexedFilter_=new RT(e.getIndex()),this.index_=e.getIndex(),this.startPost_=jp.getStartPost_(e),this.endPost_=jp.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,a){return this.matches(new vt(n,r))||(r=rt.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,a)}updateFullNode(e,n,r){n.isLeafNode()&&(n=rt.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(rt.EMPTY_NODE);const i=this;return n.forEachChild(xn,(a,l)=>{i.matches(new vt(a,l))||(s=s.updateImmediateChild(a,rt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HJ{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new jp(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,a){return this.rangedFilter_.matches(new vt(n,r))||(r=rt.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,a):this.fullLimitUpdateChild_(e,n,r,i,a)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=rt.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=rt.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;i.hasNext()&&a<this.limit_;){const l=i.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),a++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(rt.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let a=0;for(;i.hasNext();){const l=i.getNext();a<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?a++:s=s.updateImmediateChild(l.name,rt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let a;if(this.reverse_){const m=this.index_.getCompare();a=(p,v)=>m(v,p)}else a=this.index_.getCompare();const l=e;_e(l.numChildren()===this.limit_,"");const u=new vt(n,r),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),f=this.rangedFilter_.matches(u);if(l.hasChild(n)){const m=l.getImmediateChild(n);let p=s.getChildAfterChild(this.index_,d,this.reverse_);for(;p!=null&&(p.name===n||l.hasChild(p.name));)p=s.getChildAfterChild(this.index_,p,this.reverse_);const v=p==null?1:a(p,u);if(f&&!r.isEmpty()&&v>=0)return i!=null&&i.trackChildChange(Cp(n,r,m)),l.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(Ep(n,m));const _=l.updateImmediateChild(n,rt.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(i!=null&&i.trackChildChange(xh(p.name,p.node)),_.updateImmediateChild(p.name,p.node)):_}}else return r.isEmpty()?e:f&&a(d,u)>=0?(i!=null&&(i.trackChildChange(Ep(d.name,d.node)),i.trackChildChange(xh(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(d.name,rt.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=xn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return _e(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return _e(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Jc}hasEnd(){return this.endSet_}getIndexEndValue(){return _e(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return _e(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:bl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return _e(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===xn}copy(){const e=new PT;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function GJ(t){return t.loadsAllData()?new RT(t.getIndex()):t.hasLimit()?new HJ(t):new jp(t)}function KJ(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function QJ(t,e){const n=t.copy();return n.index_=e,n}function vA(t){const e={};if(t.isDefault())return e;let n;if(t.index_===xn?n="$priority":t.index_===D3?n="$value":t.index_===Ec?n="$key":(_e(t.index_ instanceof AT,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ar(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=ar(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+ar(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=ar(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+ar(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function bA(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==xn&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0 extends C3{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=yg("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(_e(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const a=A0.getListenId_(e,r),l={};this.listens_[a]=l;const u=vA(e._queryParams);this.restRequest_(i+".json",u,(d,f)=>{let m=f;if(d===404&&(m=null,d=null),d===null&&this.onDataUpdate_(i,m,!1,r),yh(this.listens_,a)===l){let p;d?d===401?p="permission_denied":p="rest_error:"+d:p="ok",s(p,null)}})}unlisten(e,n){const r=A0.getListenId_(e,n);delete this.listens_[r]}get(e){const n=vA(e._queryParams),r=e._path.toString(),s=new Jv;return this.restRequest_(r+".json",n,(i,a)=>{let l=a;i===404&&(l=null,i=null),i===null?(this.onDataUpdate_(r,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+EX(n);this.log_("Sending REST request for "+a);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let u=null;if(l.status>=200&&l.status<300){try{u=Np(l.responseText)}catch{Hr("Failed to parse JSON response for "+a+": "+l.responseText)}r(null,u)}else l.status!==401&&l.status!==404&&Hr("Got unsuccessful REST response for "+a+" Status: "+l.status),r(l.status);r=null}},l.open("GET",a,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJ{constructor(){this.rootNode_=rt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(){return{value:null,children:new Map}}function F3(t,e,n){if(xt(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=yt(e);t.children.has(r)||t.children.set(r,R0());const s=t.children.get(r);e=Xt(e),F3(s,e,n)}}function s1(t,e,n){t.value!==null?n(e,t.value):YJ(t,(r,s)=>{const i=new $t(e.toString()+"/"+r);s1(s,i,n)})}function YJ(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XJ{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&_r(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=10*1e3,JJ=30*1e3,eee=5*60*1e3;class tee{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new XJ(e);const r=_A+(JJ-_A)*Math.random();Lm(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;_r(e,(s,i)=>{i>0&&mo(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),Lm(this.reportStats_.bind(this),Math.floor(Math.random()*2*eee))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Si;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Si||(Si={}));function LT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function MT(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function OT(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Si.ACK_USER_WRITE,this.source=LT()}operationForChild(e){if(xt(this.path)){if(this.affectedTree.value!=null)return _e(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new $t(e));return new P0(Ot(),n,this.revert)}}else return _e(yt(this.path)===e,"operationForChild called for unrelated child."),new P0(Xt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,n){this.source=e,this.path=n,this.type=Si.LISTEN_COMPLETE}operationForChild(e){return xt(this.path)?new Ip(this.source,Ot()):new Ip(this.source,Xt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Si.OVERWRITE}operationForChild(e){return xt(this.path)?new eu(this.source,Ot(),this.snap.getImmediateChild(e)):new eu(this.source,Xt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Si.MERGE}operationForChild(e){if(xt(this.path)){const n=this.children.subtree(new $t(e));return n.isEmpty()?null:n.value?new eu(this.source,Ot(),n.value):new vh(this.source,Ot(),n)}else return _e(yt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new vh(this.source,Xt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(xt(e))return this.isFullyInitialized()&&!this.filtered_;const n=yt(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nee{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function ree(t,e,n,r){const s=[],i=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&i.push(WJ(a.childName,a.snapshotNode))}),qf(t,s,"child_removed",e,r,n),qf(t,s,"child_added",e,r,n),qf(t,s,"child_moved",i,r,n),qf(t,s,"child_changed",e,r,n),qf(t,s,"value",e,r,n),s}function qf(t,e,n,r,s,i){const a=r.filter(l=>l.type===n);a.sort((l,u)=>iee(t,l,u)),a.forEach(l=>{const u=see(t,l,i);s.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(u,t.query_))})})}function see(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function iee(t,e,n){if(e.childName==null||n.childName==null)throw Bh("Should only compare child_ events.");const r=new vt(e.childName,e.snapshotNode),s=new vt(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(t,e){return{eventCache:t,serverCache:e}}function Mm(t,e,n,r){return rb(new tu(e,n,r),t.serverCache)}function z3(t,e,n,r){return rb(t.eventCache,new tu(e,n,r))}function i1(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function nu(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H_;const oee=()=>(H_||(H_=new ls(qX)),H_);class Zt{constructor(e,n=oee()){this.value=e,this.children=n}static fromObject(e){let n=new Zt(null);return _r(e,(r,s)=>{n=n.set(new $t(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ot(),value:this.value};if(xt(e))return null;{const r=yt(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Xt(e),n);return i!=null?{path:Cn(new $t(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(xt(e))return this;{const n=yt(e),r=this.children.get(n);return r!==null?r.subtree(Xt(e)):new Zt(null)}}set(e,n){if(xt(e))return new Zt(n,this.children);{const r=yt(e),i=(this.children.get(r)||new Zt(null)).set(Xt(e),n),a=this.children.insert(r,i);return new Zt(this.value,a)}}remove(e){if(xt(e))return this.children.isEmpty()?new Zt(null):new Zt(null,this.children);{const n=yt(e),r=this.children.get(n);if(r){const s=r.remove(Xt(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Zt(null):new Zt(this.value,i)}else return this}}get(e){if(xt(e))return this.value;{const n=yt(e),r=this.children.get(n);return r?r.get(Xt(e)):null}}setTree(e,n){if(xt(e))return n;{const r=yt(e),i=(this.children.get(r)||new Zt(null)).setTree(Xt(e),n);let a;return i.isEmpty()?a=this.children.remove(r):a=this.children.insert(r,i),new Zt(this.value,a)}}fold(e){return this.fold_(Ot(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(Cn(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Ot(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(xt(e))return null;{const i=yt(e),a=this.children.get(i);return a?a.findOnPath_(Xt(e),Cn(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ot(),n)}foreachOnPath_(e,n,r){if(xt(e))return this;{this.value&&r(n,this.value);const s=yt(e),i=this.children.get(s);return i?i.foreachOnPath_(Xt(e),Cn(n,s),r):new Zt(null)}}foreach(e){this.foreach_(Ot(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(Cn(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e){this.writeTree_=e}static empty(){return new Ii(new Zt(null))}}function Om(t,e,n){if(xt(e))return new Ii(new Zt(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const a=as(s,e);return i=i.updateChild(a,n),new Ii(t.writeTree_.set(s,i))}else{const s=new Zt(n),i=t.writeTree_.setTree(e,s);return new Ii(i)}}}function o1(t,e,n){let r=t;return _r(n,(s,i)=>{r=Om(r,Cn(e,s),i)}),r}function wA(t,e){if(xt(e))return Ii.empty();{const n=t.writeTree_.setTree(e,new Zt(null));return new Ii(n)}}function a1(t,e){return bu(t,e)!=null}function bu(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(as(n.path,e)):null}function kA(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(xn,(r,s)=>{e.push(new vt(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new vt(r,s.value))}),e}function fl(t,e){if(xt(e))return t;{const n=bu(t,e);return n!=null?new Ii(new Zt(n)):new Ii(t.writeTree_.subtree(e))}}function l1(t){return t.writeTree_.isEmpty()}function bh(t,e){return B3(Ot(),t.writeTree_,e)}function B3(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(_e(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=B3(Cn(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Cn(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(t,e){return W3(e,t)}function aee(t,e,n,r,s){_e(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Om(t.visibleWrites,e,n)),t.lastWriteId=r}function lee(t,e,n,r){_e(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=o1(t.visibleWrites,e,n),t.lastWriteId=r}function cee(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function uee(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);_e(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,a=t.allWrites.length-1;for(;s&&a>=0;){const l=t.allWrites[a];l.visible&&(a>=n&&dee(l,r.path)?s=!1:ni(r.path,l.path)&&(i=!0)),a--}if(s){if(i)return hee(t),!0;if(r.snap)t.visibleWrites=wA(t.visibleWrites,r.path);else{const l=r.children;_r(l,u=>{t.visibleWrites=wA(t.visibleWrites,Cn(r.path,u))})}return!0}else return!1}function dee(t,e){if(t.snap)return ni(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ni(Cn(t.path,n),e))return!0;return!1}function hee(t){t.visibleWrites=$3(t.allWrites,fee,Ot()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function fee(t){return t.visible}function $3(t,e,n){let r=Ii.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const a=i.path;let l;if(i.snap)ni(n,a)?(l=as(n,a),r=Om(r,l,i.snap)):ni(a,n)&&(l=as(a,n),r=Om(r,Ot(),i.snap.getChild(l)));else if(i.children){if(ni(n,a))l=as(n,a),r=o1(r,l,i.children);else if(ni(a,n))if(l=as(a,n),xt(l))r=o1(r,Ot(),i.children);else{const u=yh(i.children,yt(l));if(u){const d=u.getChild(Xt(l));r=Om(r,Ot(),d)}}}else throw Bh("WriteRecord should have .snap or .children")}}return r}function U3(t,e,n,r,s){if(!r&&!s){const i=bu(t.visibleWrites,e);if(i!=null)return i;{const a=fl(t.visibleWrites,e);if(l1(a))return n;if(n==null&&!a1(a,Ot()))return null;{const l=n||rt.EMPTY_NODE;return bh(a,l)}}}else{const i=fl(t.visibleWrites,e);if(!s&&l1(i))return n;if(!s&&n==null&&!a1(i,Ot()))return null;{const a=function(d){return(d.visible||s)&&(!r||!~r.indexOf(d.writeId))&&(ni(d.path,e)||ni(e,d.path))},l=$3(t.allWrites,a,e),u=n||rt.EMPTY_NODE;return bh(l,u)}}}function mee(t,e,n){let r=rt.EMPTY_NODE;const s=bu(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(xn,(i,a)=>{r=r.updateImmediateChild(i,a)}),r;if(n){const i=fl(t.visibleWrites,e);return n.forEachChild(xn,(a,l)=>{const u=bh(fl(i,new $t(a)),l);r=r.updateImmediateChild(a,u)}),kA(i).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}else{const i=fl(t.visibleWrites,e);return kA(i).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}}function pee(t,e,n,r,s){_e(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=Cn(e,n);if(a1(t.visibleWrites,i))return null;{const a=fl(t.visibleWrites,i);return l1(a)?s.getChild(n):bh(a,s.getChild(n))}}function gee(t,e,n,r){const s=Cn(e,n),i=bu(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const a=fl(t.visibleWrites,s);return bh(a,r.getNode().getImmediateChild(n))}else return null}function yee(t,e){return bu(t.visibleWrites,e)}function xee(t,e,n,r,s,i,a){let l;const u=fl(t.visibleWrites,e),d=bu(u,Ot());if(d!=null)l=d;else if(n!=null)l=bh(u,n);else return[];if(l=l.withIndex(a),!l.isEmpty()&&!l.isLeafNode()){const f=[],m=a.getCompare(),p=i?l.getReverseIteratorFrom(r,a):l.getIteratorFrom(r,a);let v=p.getNext();for(;v&&f.length<s;)m(v,r)!==0&&f.push(v),v=p.getNext();return f}else return[]}function vee(){return{visibleWrites:Ii.empty(),allWrites:[],lastWriteId:-1}}function L0(t,e,n,r){return U3(t.writeTree,t.treePath,e,n,r)}function VT(t,e){return mee(t.writeTree,t.treePath,e)}function NA(t,e,n,r){return pee(t.writeTree,t.treePath,e,n,r)}function M0(t,e){return yee(t.writeTree,Cn(t.treePath,e))}function bee(t,e,n,r,s,i){return xee(t.writeTree,t.treePath,e,n,r,s,i)}function FT(t,e,n){return gee(t.writeTree,t.treePath,e,n)}function q3(t,e){return W3(Cn(t.treePath,e),t.writeTree)}function W3(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ee{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;_e(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),_e(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Cp(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Ep(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,xh(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Cp(r,e.snapshotNode,s.oldSnap));else throw Bh("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wee{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const H3=new wee;class zT{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new tu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return FT(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:nu(this.viewCache_),i=bee(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kee(t){return{filter:t}}function Nee(t,e){_e(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),_e(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function See(t,e,n,r,s){const i=new _ee;let a,l;if(n.type===Si.OVERWRITE){const d=n;d.source.fromUser?a=c1(t,e,d.path,d.snap,r,s,i):(_e(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!xt(d.path),a=O0(t,e,d.path,d.snap,r,s,l,i))}else if(n.type===Si.MERGE){const d=n;d.source.fromUser?a=Eee(t,e,d.path,d.children,r,s,i):(_e(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),a=u1(t,e,d.path,d.children,r,s,l,i))}else if(n.type===Si.ACK_USER_WRITE){const d=n;d.revert?a=Iee(t,e,d.path,r,s,i):a=Cee(t,e,d.path,d.affectedTree,r,s,i)}else if(n.type===Si.LISTEN_COMPLETE)a=jee(t,e,n.path,r,i);else throw Bh("Unknown operation type: "+n.type);const u=i.getChanges();return Tee(e,a,u),{viewCache:a,changes:u}}function Tee(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=i1(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(V3(i1(e)))}}function G3(t,e,n,r,s,i){const a=e.eventCache;if(M0(r,n)!=null)return e;{let l,u;if(xt(n))if(_e(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=nu(e),f=d instanceof rt?d:rt.EMPTY_NODE,m=VT(r,f);l=t.filter.updateFullNode(e.eventCache.getNode(),m,i)}else{const d=L0(r,nu(e));l=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const d=yt(n);if(d===".priority"){_e(_l(n)===1,"Can't have a priority with additional path components");const f=a.getNode();u=e.serverCache.getNode();const m=NA(r,n,f,u);m!=null?l=t.filter.updatePriority(f,m):l=a.getNode()}else{const f=Xt(n);let m;if(a.isCompleteForChild(d)){u=e.serverCache.getNode();const p=NA(r,n,a.getNode(),u);p!=null?m=a.getNode().getImmediateChild(d).updateChild(f,p):m=a.getNode().getImmediateChild(d)}else m=FT(r,d,e.serverCache);m!=null?l=t.filter.updateChild(a.getNode(),d,m,f,s,i):l=a.getNode()}}return Mm(e,l,a.isFullyInitialized()||xt(n),t.filter.filtersNodes())}}function O0(t,e,n,r,s,i,a,l){const u=e.serverCache;let d;const f=a?t.filter:t.filter.getIndexedFilter();if(xt(n))d=f.updateFullNode(u.getNode(),r,null);else if(f.filtersNodes()&&!u.isFiltered()){const v=u.getNode().updateChild(n,r);d=f.updateFullNode(u.getNode(),v,null)}else{const v=yt(n);if(!u.isCompleteForPath(n)&&_l(n)>1)return e;const x=Xt(n),E=u.getNode().getImmediateChild(v).updateChild(x,r);v===".priority"?d=f.updatePriority(u.getNode(),E):d=f.updateChild(u.getNode(),v,E,x,H3,null)}const m=z3(e,d,u.isFullyInitialized()||xt(n),f.filtersNodes()),p=new zT(s,m,i);return G3(t,m,n,s,p,l)}function c1(t,e,n,r,s,i,a){const l=e.eventCache;let u,d;const f=new zT(s,e,i);if(xt(n))d=t.filter.updateFullNode(e.eventCache.getNode(),r,a),u=Mm(e,d,!0,t.filter.filtersNodes());else{const m=yt(n);if(m===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),r),u=Mm(e,d,l.isFullyInitialized(),l.isFiltered());else{const p=Xt(n),v=l.getNode().getImmediateChild(m);let x;if(xt(p))x=r;else{const _=f.getCompleteChild(m);_!=null?ET(p)===".priority"&&_.getChild(I3(p)).isEmpty()?x=_:x=_.updateChild(p,r):x=rt.EMPTY_NODE}if(v.equals(x))u=e;else{const _=t.filter.updateChild(l.getNode(),m,x,p,f,a);u=Mm(e,_,l.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function SA(t,e){return t.eventCache.isCompleteForChild(e)}function Eee(t,e,n,r,s,i,a){let l=e;return r.foreach((u,d)=>{const f=Cn(n,u);SA(e,yt(f))&&(l=c1(t,l,f,d,s,i,a))}),r.foreach((u,d)=>{const f=Cn(n,u);SA(e,yt(f))||(l=c1(t,l,f,d,s,i,a))}),l}function TA(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function u1(t,e,n,r,s,i,a,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,d;xt(n)?d=r:d=new Zt(null).setTree(n,r);const f=e.serverCache.getNode();return d.children.inorderTraversal((m,p)=>{if(f.hasChild(m)){const v=e.serverCache.getNode().getImmediateChild(m),x=TA(t,v,p);u=O0(t,u,new $t(m),x,s,i,a,l)}}),d.children.inorderTraversal((m,p)=>{const v=!e.serverCache.isCompleteForChild(m)&&p.value===null;if(!f.hasChild(m)&&!v){const x=e.serverCache.getNode().getImmediateChild(m),_=TA(t,x,p);u=O0(t,u,new $t(m),_,s,i,a,l)}}),u}function Cee(t,e,n,r,s,i,a){if(M0(s,n)!=null)return e;const l=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(xt(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return O0(t,e,n,u.getNode().getChild(n),s,i,l,a);if(xt(n)){let d=new Zt(null);return u.getNode().forEachChild(Ec,(f,m)=>{d=d.set(new $t(f),m)}),u1(t,e,n,d,s,i,l,a)}else return e}else{let d=new Zt(null);return r.foreach((f,m)=>{const p=Cn(n,f);u.isCompleteForPath(p)&&(d=d.set(f,u.getNode().getChild(p)))}),u1(t,e,n,d,s,i,l,a)}}function jee(t,e,n,r,s){const i=e.serverCache,a=z3(e,i.getNode(),i.isFullyInitialized()||xt(n),i.isFiltered());return G3(t,a,n,r,H3,s)}function Iee(t,e,n,r,s,i){let a;if(M0(r,n)!=null)return e;{const l=new zT(r,e,s),u=e.eventCache.getNode();let d;if(xt(n)||yt(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=L0(r,nu(e));else{const m=e.serverCache.getNode();_e(m instanceof rt,"serverChildren would be complete if leaf node"),f=VT(r,m)}f=f,d=t.filter.updateFullNode(u,f,i)}else{const f=yt(n);let m=FT(r,f,e.serverCache);m==null&&e.serverCache.isCompleteForChild(f)&&(m=u.getImmediateChild(f)),m!=null?d=t.filter.updateChild(u,f,m,Xt(n),l,i):e.eventCache.getNode().hasChild(f)?d=t.filter.updateChild(u,f,rt.EMPTY_NODE,Xt(n),l,i):d=u,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=L0(r,nu(e)),a.isLeafNode()&&(d=t.filter.updateFullNode(d,a,i)))}return a=e.serverCache.isFullyInitialized()||M0(r,Ot())!=null,Mm(e,d,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aee{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new RT(r.getIndex()),i=GJ(r);this.processor_=kee(i);const a=n.serverCache,l=n.eventCache,u=s.updateFullNode(rt.EMPTY_NODE,a.getNode(),null),d=i.updateFullNode(rt.EMPTY_NODE,l.getNode(),null),f=new tu(u,a.isFullyInitialized(),s.filtersNodes()),m=new tu(d,l.isFullyInitialized(),i.filtersNodes());this.viewCache_=rb(m,f),this.eventGenerator_=new nee(this.query_)}get query(){return this.query_}}function Ree(t){return t.viewCache_.serverCache.getNode()}function Pee(t,e){const n=nu(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!xt(e)&&!n.getImmediateChild(yt(e)).isEmpty())?n.getChild(e):null}function EA(t){return t.eventRegistrations_.length===0}function Lee(t,e){t.eventRegistrations_.push(e)}function CA(t,e,n){const r=[];if(n){_e(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const a=i.createCancelEvent(n,s);a&&r.push(a)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const a=t.eventRegistrations_[i];if(!a.matches(e))s.push(a);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function jA(t,e,n,r){e.type===Si.MERGE&&e.source.queryId!==null&&(_e(nu(t.viewCache_),"We should always have a full cache before handling merges"),_e(i1(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=See(t.processor_,s,e,n,r);return Nee(t.processor_,i.viewCache),_e(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,K3(t,i.changes,i.viewCache.eventCache.getNode(),null)}function Mee(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(xn,(i,a)=>{r.push(xh(i,a))}),n.isFullyInitialized()&&r.push(V3(n.getNode())),K3(t,r,n.getNode(),e)}function K3(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return ree(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D0;class Oee{constructor(){this.views=new Map}}function Dee(t){_e(!D0,"__referenceConstructor has already been defined"),D0=t}function Vee(){return _e(D0,"Reference.ts has not been loaded"),D0}function Fee(t){return t.views.size===0}function BT(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return _e(i!=null,"SyncTree gave us an op for an invalid query."),jA(i,e,n,r)}else{let i=[];for(const a of t.views.values())i=i.concat(jA(a,e,n,r));return i}}function zee(t,e,n,r,s){const i=e._queryIdentifier,a=t.views.get(i);if(!a){let l=L0(n,s?r:null),u=!1;l?u=!0:r instanceof rt?(l=VT(n,r),u=!1):(l=rt.EMPTY_NODE,u=!1);const d=rb(new tu(l,u,!1),new tu(r,s,!1));return new Aee(e,d)}return a}function Bee(t,e,n,r,s,i){const a=zee(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),Lee(a,n),Mee(a,n)}function $ee(t,e,n,r){const s=e._queryIdentifier,i=[];let a=[];const l=wl(t);if(s==="default")for(const[u,d]of t.views.entries())a=a.concat(CA(d,n,r)),EA(d)&&(t.views.delete(u),d.query._queryParams.loadsAllData()||i.push(d.query));else{const u=t.views.get(s);u&&(a=a.concat(CA(u,n,r)),EA(u)&&(t.views.delete(s),u.query._queryParams.loadsAllData()||i.push(u.query)))}return l&&!wl(t)&&i.push(new(Vee())(e._repo,e._path)),{removed:i,events:a}}function Q3(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function qd(t,e){let n=null;for(const r of t.views.values())n=n||Pee(r,e);return n}function Z3(t,e){if(e._queryParams.loadsAllData())return sb(t);{const r=e._queryIdentifier;return t.views.get(r)}}function Y3(t,e){return Z3(t,e)!=null}function wl(t){return sb(t)!=null}function sb(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V0;function Uee(t){_e(!V0,"__referenceConstructor has already been defined"),V0=t}function qee(){return _e(V0,"Reference.ts has not been loaded"),V0}let Wee=1;class IA{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Zt(null),this.pendingWriteTree_=vee(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function X3(t,e,n,r,s){return aee(t.pendingWriteTree_,e,n,r,s),s?Uh(t,new eu(LT(),e,n)):[]}function Hee(t,e,n,r){lee(t.pendingWriteTree_,e,n,r);const s=Zt.fromObject(n);return Uh(t,new vh(LT(),e,s))}function Qa(t,e,n=!1){const r=cee(t.pendingWriteTree_,e);if(uee(t.pendingWriteTree_,e)){let i=new Zt(null);return r.snap!=null?i=i.set(Ot(),!0):_r(r.children,a=>{i=i.set(new $t(a),!0)}),Uh(t,new P0(r.path,i,n))}else return[]}function ib(t,e,n){return Uh(t,new eu(MT(),e,n))}function Gee(t,e,n){const r=Zt.fromObject(n);return Uh(t,new vh(MT(),e,r))}function Kee(t,e){return Uh(t,new Ip(MT(),e))}function Qee(t,e,n){const r=UT(t,n);if(r){const s=qT(r),i=s.path,a=s.queryId,l=as(i,e),u=new Ip(OT(a),l);return WT(t,i,u)}else return[]}function d1(t,e,n,r,s=!1){const i=e._path,a=t.syncPointTree_.get(i);let l=[];if(a&&(e._queryIdentifier==="default"||Y3(a,e))){const u=$ee(a,e,n,r);Fee(a)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const d=u.removed;if(l=u.events,!s){const f=d.findIndex(p=>p._queryParams.loadsAllData())!==-1,m=t.syncPointTree_.findOnPath(i,(p,v)=>wl(v));if(f&&!m){const p=t.syncPointTree_.subtree(i);if(!p.isEmpty()){const v=Xee(p);for(let x=0;x<v.length;++x){const _=v[x],E=_.query,k=tV(t,_);t.listenProvider_.startListening(Dm(E),F0(t,E),k.hashFn,k.onComplete)}}}!m&&d.length>0&&!r&&(f?t.listenProvider_.stopListening(Dm(e),null):d.forEach(p=>{const v=t.queryToTagMap.get(ob(p));t.listenProvider_.stopListening(Dm(p),v)}))}Jee(t,d)}return l}function Zee(t,e,n,r){const s=UT(t,r);if(s!=null){const i=qT(s),a=i.path,l=i.queryId,u=as(a,e),d=new eu(OT(l),u,n);return WT(t,a,d)}else return[]}function Yee(t,e,n,r){const s=UT(t,r);if(s){const i=qT(s),a=i.path,l=i.queryId,u=as(a,e),d=Zt.fromObject(n),f=new vh(OT(l),u,d);return WT(t,a,f)}else return[]}function AA(t,e,n,r=!1){const s=e._path;let i=null,a=!1;t.syncPointTree_.foreachOnPath(s,(p,v)=>{const x=as(p,s);i=i||qd(v,x),a=a||wl(v)});let l=t.syncPointTree_.get(s);l?(a=a||wl(l),i=i||qd(l,Ot())):(l=new Oee,t.syncPointTree_=t.syncPointTree_.set(s,l));let u;i!=null?u=!0:(u=!1,i=rt.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((v,x)=>{const _=qd(x,Ot());_&&(i=i.updateImmediateChild(v,_))}));const d=Y3(l,e);if(!d&&!e._queryParams.loadsAllData()){const p=ob(e);_e(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");const v=ete();t.queryToTagMap.set(p,v),t.tagToQueryMap.set(v,p)}const f=DT(t.pendingWriteTree_,s);let m=Bee(l,e,n,f,i,u);if(!d&&!a&&!r){const p=Z3(l,e);m=m.concat(tte(t,e,p))}return m}function $T(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(a,l)=>{const u=as(a,e),d=qd(l,u);if(d)return d});return U3(s,e,i,n,!0)}function Uh(t,e){return J3(e,t.syncPointTree_,null,DT(t.pendingWriteTree_,Ot()))}function J3(t,e,n,r){if(xt(t.path))return eV(t,e,n,r);{const s=e.get(Ot());n==null&&s!=null&&(n=qd(s,Ot()));let i=[];const a=yt(t.path),l=t.operationForChild(a),u=e.children.get(a);if(u&&l){const d=n?n.getImmediateChild(a):null,f=q3(r,a);i=i.concat(J3(l,u,d,f))}return s&&(i=i.concat(BT(s,t,r,n))),i}}function eV(t,e,n,r){const s=e.get(Ot());n==null&&s!=null&&(n=qd(s,Ot()));let i=[];return e.children.inorderTraversal((a,l)=>{const u=n?n.getImmediateChild(a):null,d=q3(r,a),f=t.operationForChild(a);f&&(i=i.concat(eV(f,l,u,d)))}),s&&(i=i.concat(BT(s,t,r,n))),i}function tV(t,e){const n=e.query,r=F0(t,n);return{hashFn:()=>(Ree(e)||rt.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?Qee(t,n._path,r):Kee(t,n._path);{const i=GX(s,n);return d1(t,n,null,i)}}}}function F0(t,e){const n=ob(e);return t.queryToTagMap.get(n)}function ob(t){return t._path.toString()+"$"+t._queryIdentifier}function UT(t,e){return t.tagToQueryMap.get(e)}function qT(t){const e=t.indexOf("$");return _e(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new $t(t.substr(0,e))}}function WT(t,e,n){const r=t.syncPointTree_.get(e);_e(r,"Missing sync point for query tag that we're tracking");const s=DT(t.pendingWriteTree_,e);return BT(r,n,s,null)}function Xee(t){return t.fold((e,n,r)=>{if(n&&wl(n))return[sb(n)];{let s=[];return n&&(s=Q3(n)),_r(r,(i,a)=>{s=s.concat(a)}),s}})}function Dm(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(qee())(t._repo,t._path):t}function Jee(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=ob(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function ete(){return Wee++}function tte(t,e,n){const r=e._path,s=F0(t,e),i=tV(t,n),a=t.listenProvider_.startListening(Dm(e),s,i.hashFn,i.onComplete),l=t.syncPointTree_.subtree(r);if(s)_e(!wl(l.value),"If we're adding a query, it shouldn't be shadowed");else{const u=l.fold((d,f,m)=>{if(!xt(d)&&f&&wl(f))return[sb(f).query];{let p=[];return f&&(p=p.concat(Q3(f).map(v=>v.query))),_r(m,(v,x)=>{p=p.concat(x)}),p}});for(let d=0;d<u.length;++d){const f=u[d];t.listenProvider_.stopListening(Dm(f),F0(t,f))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new HT(n)}node(){return this.node_}}class GT{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Cn(this.path_,e);return new GT(this.syncTree_,n)}node(){return $T(this.syncTree_,this.path_)}}const nte=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},RA=function(t,e,n){if(!t||typeof t!="object")return t;if(_e(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return rte(t[".sv"],e,n);if(typeof t[".sv"]=="object")return ste(t[".sv"],e);_e(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},rte=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:_e(!1,"Unexpected server value: "+t)}},ste=function(t,e,n){t.hasOwnProperty("increment")||_e(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&_e(!1,"Unexpected increment value: "+r);const s=e.node();if(_e(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const a=s.getValue();return typeof a!="number"?r:a+r},nV=function(t,e,n,r){return KT(e,new GT(n,t),r)},rV=function(t,e,n){return KT(t,new HT(e),n)};function KT(t,e,n){const r=t.getPriority().val(),s=RA(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const a=t,l=RA(a.getValue(),e,n);return l!==a.getValue()||s!==a.getPriority().val()?new tr(l,or(s)):t}else{const a=t;return i=a,s!==a.getPriority().val()&&(i=i.updatePriority(new tr(s))),a.forEachChild(xn,(l,u)=>{const d=KT(u,e.getImmediateChild(l),n);d!==u&&(i=i.updateImmediateChild(l,d))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function ZT(t,e){let n=e instanceof $t?e:new $t(e),r=t,s=yt(n);for(;s!==null;){const i=yh(r.node.children,s)||{children:{},childCount:0};r=new QT(s,r,i),n=Xt(n),s=yt(n)}return r}function qh(t){return t.node.value}function sV(t,e){t.node.value=e,h1(t)}function iV(t){return t.node.childCount>0}function ite(t){return qh(t)===void 0&&!iV(t)}function ab(t,e){_r(t.node.children,(n,r)=>{e(new QT(n,t,r))})}function oV(t,e,n,r){n&&e(t),ab(t,s=>{oV(s,e,!0)})}function ote(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function vg(t){return new $t(t.parent===null?t.name:vg(t.parent)+"/"+t.name)}function h1(t){t.parent!==null&&ate(t.parent,t.name,t)}function ate(t,e,n){const r=ite(n),s=mo(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,h1(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,h1(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lte=/[\[\].#$\/\u0000-\u001F\u007F]/,cte=/[\[\].#$\u0000-\u001F\u007F]/,G_=10*1024*1024,YT=function(t){return typeof t=="string"&&t.length!==0&&!lte.test(t)},aV=function(t){return typeof t=="string"&&t.length!==0&&!cte.test(t)},ute=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),aV(t)},f1=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!wT(t)||t&&typeof t=="object"&&mo(t,".sv")},lV=function(t,e,n,r){r&&e===void 0||lb(eb(t,"value"),e,n)},lb=function(t,e,n){const r=n instanceof $t?new EJ(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+ic(r));if(typeof e=="function")throw new Error(t+"contains a function "+ic(r)+" with contents = "+e.toString());if(wT(e))throw new Error(t+"contains "+e.toString()+" "+ic(r));if(typeof e=="string"&&e.length>G_/3&&tb(e)>G_)throw new Error(t+"contains a string greater than "+G_+" utf8 bytes "+ic(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(_r(e,(a,l)=>{if(a===".value")s=!0;else if(a!==".priority"&&a!==".sv"&&(i=!0,!YT(a)))throw new Error(t+" contains an invalid key ("+a+") "+ic(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);CJ(r,a),lb(t,l,r),jJ(r)}),s&&i)throw new Error(t+' contains ".value" child '+ic(r)+" in addition to actual children.")}},dte=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=Tp(r);for(let a=0;a<i.length;a++)if(!(i[a]===".priority"&&a===i.length-1)){if(!YT(i[a]))throw new Error(t+"contains an invalid key ("+i[a]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(TJ);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&ni(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},hte=function(t,e,n,r){const s=eb(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];_r(e,(a,l)=>{const u=new $t(a);if(lb(s,l,Cn(n,u)),ET(u)===".priority"&&!f1(l))throw new Error(s+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(u)}),dte(s,i)},XT=function(t,e,n,r){if(!aV(n))throw new Error(eb(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},fte=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),XT(t,e,n)},JT=function(t,e){if(yt(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},mte=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!YT(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!ute(n))throw new Error(eb(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pte{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function cb(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!CT(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function cV(t,e,n){cb(t,n),uV(t,r=>CT(r,e))}function Li(t,e,n){cb(t,n),uV(t,r=>ni(r,e)||ni(e,r))}function uV(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(gte(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function gte(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Pm&&yr("event: "+n.toString()),$h(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yte="repo_interrupt",xte=25;class vte{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new pte,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=R0(),this.transactionQueueTree_=new QT,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function bte(t,e,n){if(t.stats_=ST(t.repoInfo_),t.forceRestClient_||YX())t.server_=new A0(t.repoInfo_,(r,s,i,a)=>{PA(t,r,s,i,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>LA(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ar(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Ho(t.repoInfo_,e,(r,s,i,a)=>{PA(t,r,s,i,a)},r=>{LA(t,r)},r=>{_te(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=nJ(t.repoInfo_,()=>new tee(t.stats_,t.server_)),t.infoData_=new ZJ,t.infoSyncTree_=new IA({startListening:(r,s,i,a)=>{let l=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(l=ib(t.infoSyncTree_,r._path,u),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),eE(t,"connected",!1),t.serverSyncTree_=new IA({startListening:(r,s,i,a)=>(t.server_.listen(r,i,s,(l,u)=>{const d=a(l,u);Li(t.eventQueue_,r._path,d)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function dV(t){const n=t.infoData_.getNode(new $t(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function ub(t){return nte({timestamp:dV(t)})}function PA(t,e,n,r,s){t.dataUpdateCount++;const i=new $t(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(s)if(r){const u=E0(n,d=>or(d));a=Yee(t.serverSyncTree_,i,u,s)}else{const u=or(n);a=Zee(t.serverSyncTree_,i,u,s)}else if(r){const u=E0(n,d=>or(d));a=Gee(t.serverSyncTree_,i,u)}else{const u=or(n);a=ib(t.serverSyncTree_,i,u)}let l=i;a.length>0&&(l=_h(t,i)),Li(t.eventQueue_,l,a)}function LA(t,e){eE(t,"connected",e),e===!1&&Nte(t)}function _te(t,e){_r(e,(n,r)=>{eE(t,n,r)})}function eE(t,e,n){const r=new $t("/.info/"+e),s=or(n);t.infoData_.updateSnapshot(r,s);const i=ib(t.infoSyncTree_,r,s);Li(t.eventQueue_,r,i)}function tE(t){return t.nextWriteId_++}function wte(t,e,n,r,s){db(t,"set",{path:e.toString(),value:n,priority:r});const i=ub(t),a=or(n,r),l=$T(t.serverSyncTree_,e),u=rV(a,l,i),d=tE(t),f=X3(t.serverSyncTree_,e,u,d,!0);cb(t.eventQueue_,f),t.server_.put(e.toString(),a.val(!0),(p,v)=>{const x=p==="ok";x||Hr("set at "+e+" failed: "+p);const _=Qa(t.serverSyncTree_,d,!x);Li(t.eventQueue_,e,_),m1(t,s,p,v)});const m=rE(t,e);_h(t,m),Li(t.eventQueue_,m,[])}function kte(t,e,n,r){db(t,"update",{path:e.toString(),value:n});let s=!0;const i=ub(t),a={};if(_r(n,(l,u)=>{s=!1,a[l]=nV(Cn(e,l),or(u),t.serverSyncTree_,i)}),s)yr("update() called with empty data.  Don't do anything."),m1(t,r,"ok",void 0);else{const l=tE(t),u=Hee(t.serverSyncTree_,e,a,l);cb(t.eventQueue_,u),t.server_.merge(e.toString(),n,(d,f)=>{const m=d==="ok";m||Hr("update at "+e+" failed: "+d);const p=Qa(t.serverSyncTree_,l,!m),v=p.length>0?_h(t,e):e;Li(t.eventQueue_,v,p),m1(t,r,d,f)}),_r(n,d=>{const f=rE(t,Cn(e,d));_h(t,f)}),Li(t.eventQueue_,e,[])}}function Nte(t){db(t,"onDisconnectEvents");const e=ub(t),n=R0();s1(t.onDisconnect_,Ot(),(s,i)=>{const a=nV(s,i,t.serverSyncTree_,e);F3(n,s,a)});let r=[];s1(n,Ot(),(s,i)=>{r=r.concat(ib(t.serverSyncTree_,s,i));const a=rE(t,s);_h(t,a)}),t.onDisconnect_=R0(),Li(t.eventQueue_,Ot(),r)}function Ste(t,e,n){let r;yt(e._path)===".info"?r=AA(t.infoSyncTree_,e,n):r=AA(t.serverSyncTree_,e,n),cV(t.eventQueue_,e._path,r)}function Tte(t,e,n){let r;yt(e._path)===".info"?r=d1(t.infoSyncTree_,e,n):r=d1(t.serverSyncTree_,e,n),cV(t.eventQueue_,e._path,r)}function Ete(t){t.persistentConnection_&&t.persistentConnection_.interrupt(yte)}function db(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),yr(n,...e)}function m1(t,e,n,r){e&&$h(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const a=new Error(i);a.code=s,e(a)}})}function hV(t,e,n){return $T(t.serverSyncTree_,e,n)||rt.EMPTY_NODE}function nE(t,e=t.transactionQueueTree_){if(e||hb(t,e),qh(e)){const n=mV(t,e);_e(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&Cte(t,vg(e),n)}else iV(e)&&ab(e,n=>{nE(t,n)})}function Cte(t,e,n){const r=n.map(d=>d.currentWriteId),s=hV(t,e,r);let i=s;const a=s.hash();for(let d=0;d<n.length;d++){const f=n[d];_e(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const m=as(e,f.path);i=i.updateChild(m,f.currentOutputSnapshotRaw)}const l=i.val(!0),u=e;t.server_.put(u.toString(),l,d=>{db(t,"transaction put response",{path:u.toString(),status:d});let f=[];if(d==="ok"){const m=[];for(let p=0;p<n.length;p++)n[p].status=2,f=f.concat(Qa(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&m.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();hb(t,ZT(t.transactionQueueTree_,e)),nE(t,t.transactionQueueTree_),Li(t.eventQueue_,e,f);for(let p=0;p<m.length;p++)$h(m[p])}else{if(d==="datastale")for(let m=0;m<n.length;m++)n[m].status===3?n[m].status=4:n[m].status=0;else{Hr("transaction at "+u.toString()+" failed: "+d);for(let m=0;m<n.length;m++)n[m].status=4,n[m].abortReason=d}_h(t,e)}},a)}function _h(t,e){const n=fV(t,e),r=vg(n),s=mV(t,n);return jte(t,s,r),r}function jte(t,e,n){if(e.length===0)return;const r=[];let s=[];const a=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const u=e[l],d=as(n,u.path);let f=!1,m;if(_e(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)f=!0,m=u.abortReason,s=s.concat(Qa(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=xte)f=!0,m="maxretry",s=s.concat(Qa(t.serverSyncTree_,u.currentWriteId,!0));else{const p=hV(t,u.path,a);u.currentInputSnapshot=p;const v=e[l].update(p.val());if(v!==void 0){lb("transaction failed: Data returned ",v,u.path);let x=or(v);typeof v=="object"&&v!=null&&mo(v,".priority")||(x=x.updatePriority(p.getPriority()));const E=u.currentWriteId,k=ub(t),b=rV(x,p,k);u.currentOutputSnapshotRaw=x,u.currentOutputSnapshotResolved=b,u.currentWriteId=tE(t),a.splice(a.indexOf(E),1),s=s.concat(X3(t.serverSyncTree_,u.path,b,u.currentWriteId,u.applyLocally)),s=s.concat(Qa(t.serverSyncTree_,E,!0))}else f=!0,m="nodata",s=s.concat(Qa(t.serverSyncTree_,u.currentWriteId,!0))}Li(t.eventQueue_,n,s),s=[],f&&(e[l].status=2,function(p){setTimeout(p,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(m==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(m),!1,null))))}hb(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)$h(r[l]);nE(t,t.transactionQueueTree_)}function fV(t,e){let n,r=t.transactionQueueTree_;for(n=yt(e);n!==null&&qh(r)===void 0;)r=ZT(r,n),e=Xt(e),n=yt(e);return r}function mV(t,e){const n=[];return pV(t,e,n),n.sort((r,s)=>r.order-s.order),n}function pV(t,e,n){const r=qh(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);ab(e,s=>{pV(t,s,n)})}function hb(t,e){const n=qh(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,sV(e,n.length>0?n:void 0)}ab(e,r=>{hb(t,r)})}function rE(t,e){const n=vg(fV(t,e)),r=ZT(t.transactionQueueTree_,e);return ote(r,s=>{K_(t,s)}),K_(t,r),oV(r,s=>{K_(t,s)}),n}function K_(t,e){const n=qh(e);if(n){const r=[];let s=[],i=-1;for(let a=0;a<n.length;a++)n[a].status===3||(n[a].status===1?(_e(i===a-1,"All SENT items should be at beginning of queue."),i=a,n[a].status=3,n[a].abortReason="set"):(_e(n[a].status===0,"Unexpected transaction status in abort"),n[a].unwatcher(),s=s.concat(Qa(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));i===-1?sV(e,void 0):n.length=i+1,Li(t.eventQueue_,vg(e),s);for(let a=0;a<r.length;a++)$h(r[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ite(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function Ate(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Hr(`Invalid query segment '${n}' in query '${t}'`)}return e}const MA=function(t,e){const n=Rte(t),r=n.namespace;n.domain==="firebase.com"&&ra(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&ra("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||$X();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new _3(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new $t(n.pathString)}},Rte=function(t){let e="",n="",r="",s="",i="",a=!0,l="https",u=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(l=t.substring(0,d-1),t=t.substring(d+2));let f=t.indexOf("/");f===-1&&(f=t.length);let m=t.indexOf("?");m===-1&&(m=t.length),e=t.substring(0,Math.min(f,m)),f<m&&(s=Ite(t.substring(f,m)));const p=Ate(t.substring(Math.min(t.length,m)));d=e.indexOf(":"),d>=0?(a=l==="https"||l==="wss",u=parseInt(e.substring(d+1),10)):d=e.length;const v=e.slice(0,d);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{const x=e.indexOf(".");r=e.substring(0,x).toLowerCase(),n=e.substring(x+1),i=r}"ns"in p&&(i=p.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:a,scheme:l,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Pte=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const i=new Array(8);for(s=7;s>=0;s--)i[s]=OA.charAt(n%64),n=Math.floor(n/64);_e(n===0,"Cannot push at time == 0");let a=i.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)a+=OA.charAt(e[s]);return _e(a.length===20,"nextPushId: Length should be 20."),a}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lte{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ar(this.snapshot.exportVal())}}class Mte{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ote{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return _e(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return xt(this._path)?null:ET(this._path)}get ref(){return new Dl(this._repo,this._path)}get _queryIdentifier(){const e=bA(this._queryParams),n=kT(e);return n==="{}"?"default":n}get _queryObject(){return bA(this._queryParams)}isEqual(e){if(e=xu(e),!(e instanceof bg))return!1;const n=this._repo===e._repo,r=CT(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+SJ(this._path)}}function Dte(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Vte(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ec){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Jc)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==bl)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===xn){if(e!=null&&!f1(e)||n!=null&&!f1(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(_e(t.getIndex()instanceof AT||t.getIndex()===D3,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Dl extends bg{constructor(e,n){super(e,n,new PT,!1)}get parent(){const e=I3(this._path);return e===null?null:new Dl(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class z0{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new $t(e),r=Ap(this.ref,e);return new z0(this._node.getChild(n),r,xn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new z0(s,Ap(this.ref,r),xn)))}hasChild(e){const n=new $t(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Za(t,e){return t=xu(t),t._checkNotDeleted("ref"),e!==void 0?Ap(t._root,e):t._root}function Ap(t,e){return t=xu(t),yt(t._path)===null?fte("child","path",e):XT("child","path",e),new Dl(t._repo,Cn(t._path,e))}function Fte(t,e){t=xu(t),JT("push",t._path),lV("push",e,t._path,!0);const n=dV(t._repo),r=Pte(n),s=Ap(t,r),i=Ap(t,r);let a;return a=Promise.resolve(i),s.then=a.then.bind(a),s.catch=a.then.bind(a,void 0),s}function zte(t){return JT("remove",t._path),gV(t,null)}function gV(t,e){t=xu(t),JT("set",t._path),lV("set",e,t._path,!1);const n=new Jv;return wte(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function wx(t,e){hte("update",e,t._path);const n=new Jv;return kte(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}class sE{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new Lte("value",this,new z0(e.snapshotNode,new Dl(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Mte(this,e,n):null}matches(e){return e instanceof sE?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Bte(t,e,n,r,s){const i=new Ote(n,void 0),a=new sE(i);return Ste(t._repo,t,a),()=>Tte(t._repo,t,a)}function $te(t,e,n,r){return Bte(t,"value",e)}class yV{}class Ute extends yV{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new bg(e._repo,e._path,KJ(e._queryParams,this._limit),e._orderByCalled)}}function qte(t){if(Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Ute(t)}class Wte extends yV{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Dte(e,"orderByChild");const n=new $t(this._path);if(xt(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new AT(n),s=QJ(e._queryParams,r);return Vte(s),new bg(e._repo,e._path,s,!0)}}function Hte(t){return XT("orderByChild","path",t),new Wte(t)}function Gte(t,...e){let n=xu(t);for(const r of e)n=r._apply(n);return n}Dee(Dl);Uee(Dl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kte="FIREBASE_DATABASE_EMULATOR_HOST",p1={};let Qte=!1;function Zte(t,e,n,r){t.repoInfo_=new _3(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function Yte(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||ra("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),yr("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=MA(i,s),l=a.repoInfo,u;typeof process<"u"&&nA&&(u=nA[Kte]),u?(i=`http://${u}?ns=${l.namespace}`,a=MA(i,s),l=a.repoInfo):a.repoInfo.secure;const d=new JX(t.name,t.options,e);mte("Invalid Firebase Database URL",a),xt(a.path)||ra("Database URL must point to the root of a Firebase Database (not including a child path).");const f=Jte(l,t,d,new XX(t.name,n));return new ene(f,t)}function Xte(t,e){const n=p1[e];(!n||n[t.key]!==t)&&ra(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Ete(t),delete n[t.key]}function Jte(t,e,n,r){let s=p1[e.name];s||(s={},p1[e.name]=s);let i=s[t.toURLString()];return i&&ra("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new vte(t,Qte,n,r),s[t.toURLString()]=i,i}let ene=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(bte(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Dl(this._repo,Ot())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Xte(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ra("Cannot call "+e+" on a deleted database.")}};function tne(t=I5(),e){const n=C5(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=bX("database");r&&nne(n,...r)}return n}function nne(t,e,n,r={}){t=xu(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&ra("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&ra('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new _x(_x.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:_X(r.mockUserToken,t.app.options.projectId);i=new _x(a)}Zte(s,e,n,i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rne(t){OX(j5),wp(new IX("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return Yte(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),Sc(rA,sA,t),Sc(rA,sA,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sne={".sv":"timestamp"};function ine(){return sne}Ho.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Ho.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};rne();const ru={apiKey:"AIzaSyCRRmP9lfWF2hWdquNmo1t-x5Pjz-l6idM",authDomain:"auth.seshnx.net",databaseURL:"https://seshnx-db-default-rtdb.firebaseio.com",projectId:"seshnx-70c04",storageBucket:"seshnx-70c04.firebasestorage.app",messagingSenderId:"98272119648",appId:"1:98272119648:web:ff6d186adf94a03fe0ac05",measurementId:"G-7SP53NK9FM"};ru.databaseURL||(ru.databaseURL="https://seshnx-db-default-rtdb.firebaseio.com");let g1=null;try{g1=tS()}catch{g1=null}const su=g1||IO(ru),Sd=m4(su);let y1;try{y1=tQ(su,{localCache:gQ({tabManager:bQ()})})}catch{y1=o5(su)}const Y=y1;let x1=null,xV=null;const one=()=>{const t=ru.databaseURL;if(!t||t.trim()==="")return null;try{return tne(su)||null}catch{return null}};xV=one();if(ru.storageBucket&&ru.storageBucket.trim()!=="")try{x1=oX(su)}catch{x1=null}const B0=x1,Br=xV,qe=ru.projectId,Le=t=>({userProfile:`artifacts/${qe}/users/${t}/profiles/main`,userSubProfile:e=>`artifacts/${qe}/users/${t}/profiles/${e}`,userPublicProfile:`artifacts/${qe}/users/${t}/public_profile/main`,publicProfileCollectionGroup:"public_profile",publicFeed:`artifacts/${qe}/public/data/posts`,serviceRequests:`artifacts/${qe}/public/data/service_requests`,messages:`artifacts/${qe}/public/data/direct_messages`,marketplaceItems:`artifacts/${qe}/public/data/market_items`,userLibrary:`artifacts/${qe}/users/${t}/library`,marketAssets:`artifacts/${qe}/users/${t}/assets/market`,userWallet:`artifacts/${qe}/users/${t}/wallet/account`,profileImages:`artifacts/${qe}/users/${t}/images/profile`,equipmentSubmissions:`artifacts/${qe}/public/data/equipment_submissions`,studentRecord:(e,n)=>`schools/${e}/students/${n}`,distributionReleases:`artifacts/${qe}/distribution/${t}/releases`,royaltyReports:`artifacts/${qe}/distribution/${t}/royalty_reports`,distributionStats:`artifacts/${qe}/distribution/${t}/stats/main`,labelRoster:e=>`artifacts/${qe}/labels/${e}/roster`,labelInvites:e=>`artifacts/${qe}/labels/${e}/invites`,gearListings:`artifacts/${qe}/public/data/gear_listings`,followers:`artifacts/${qe}/users/${t}/followers`,following:`artifacts/${qe}/users/${t}/following`,socialStats:`artifacts/${qe}/users/${t}/stats/social`,notifications:`artifacts/${qe}/users/${t}/notifications`,savedPosts:`artifacts/${qe}/users/${t}/savedPosts`});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ane={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lne=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ce=(t,e)=>{const n=N.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:u,...d},f)=>N.createElement("svg",{ref:f,...ane,width:s,height:s,stroke:r,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${lne(t)}`,l].join(" "),...d},[...e.map(([m,p])=>N.createElement(m,p)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=ce("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=ce("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=ce("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cne=ce("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=ce("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=ce("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const une=ce("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=ce("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vV=ce("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=ce("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=ce("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dne=ce("CameraOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=ce("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bV=ce("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=ce("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=ce("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=ce("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _V=ce("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=ce("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=ce("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hne=ce("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fne=ce("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oE=ce("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mne=ce("CornerDownRight",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wV=ce("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pne=ce("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kV=ce("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gne=ce("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=ce("Disc",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=ce("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NV=ce("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yne=ce("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xne=ce("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=ce("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=ce("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=ce("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _g=ce("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=ce("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vne=ce("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bne=ce("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ne=ce("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wne=ce("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kne=ce("Images",[["path",{d:"M18 22H4a2 2 0 0 1-2-2V6",key:"pblm9e"}],["path",{d:"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18",key:"nf6bnh"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["rect",{width:"16",height:"16",x:"6",y:"2",rx:"2",key:"12espp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SV=ce("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rp=ce("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nne=ce("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sne=ce("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cE=ce("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ce("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=ce("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TV=ce("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pp=ce("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=ce("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EV=ce("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tne=ce("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=ce("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CV=ce("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ene=ce("Mic2",[["path",{d:"m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12",key:"zoua8r"}],["circle",{cx:"17",cy:"7",r:"5",key:"1fomce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cne=ce("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uE=ce("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jne=ce("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=ce("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jV=ce("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IV=ce("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AV=ce("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ine=ce("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dE=ce("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RV=ce("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=ce("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=ce("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lp=ce("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=ce("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=ce("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=ce("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ane=ce("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=ce("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=ce("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PV=ce("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=ce("Sliders",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LV=ce("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fE=ce("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MV=ce("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OV=ce("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rne=ce("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pne=ce("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=ce("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=ce("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DV=ce("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=ce("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lne=ce("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=ce("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=ce("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=ce("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mne=ce("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hh=ce("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const One=ce("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=ce("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),mE=N.createContext({});function pE(t){const e=N.useRef(null);return e.current===null&&(e.current=t()),e.current}const yb=N.createContext(null),gE=N.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class Dne extends N.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Vne({children:t,isPresent:e}){const n=N.useId(),r=N.useRef(null),s=N.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=N.useContext(gE);return N.useInsertionEffect(()=>{const{width:a,height:l,top:u,left:d}=s.current;if(e||!r.current||!a||!l)return;r.current.dataset.motionPopId=n;const f=document.createElement("style");return i&&(f.nonce=i),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),o.jsx(Dne,{isPresent:e,childRef:r,sizeRef:s,children:N.cloneElement(t,{ref:r})})}const Fne=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a})=>{const l=pE(zne),u=N.useId(),d=N.useCallback(m=>{l.set(m,!0);for(const p of l.values())if(!p)return;r&&r()},[l,r]),f=N.useMemo(()=>({id:u,initial:e,isPresent:n,custom:s,onExitComplete:d,register:m=>(l.set(m,!1),()=>l.delete(m))}),i?[Math.random(),d]:[n,d]);return N.useMemo(()=>{l.forEach((m,p)=>l.set(p,!1))},[n]),N.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(t=o.jsx(Vne,{isPresent:n,children:t})),o.jsx(yb.Provider,{value:f,children:t})};function zne(){return new Map}function VV(t=!0){const e=N.useContext(yb);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,i=N.useId();N.useEffect(()=>{t&&s(i)},[t]);const a=N.useCallback(()=>t&&r&&r(i),[i,r,t]);return!n&&r?[!1,a]:[!0]}const Fy=t=>t.key||"";function zA(t){const e=[];return N.Children.forEach(t,n=>{N.isValidElement(n)&&e.push(n)}),e}const yE=typeof window<"u",FV=yE?N.useLayoutEffect:N.useEffect,Zn=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1})=>{const[l,u]=VV(a),d=N.useMemo(()=>zA(t),[t]),f=a&&!l?[]:d.map(Fy),m=N.useRef(!0),p=N.useRef(d),v=pE(()=>new Map),[x,_]=N.useState(d),[E,k]=N.useState(d);FV(()=>{m.current=!1,p.current=d;for(let C=0;C<E.length;C++){const P=Fy(E[C]);f.includes(P)?v.delete(P):v.get(P)!==!0&&v.set(P,!1)}},[E,f.length,f.join("-")]);const b=[];if(d!==x){let C=[...d];for(let P=0;P<E.length;P++){const R=E[P],I=Fy(R);f.includes(I)||(C.splice(P,0,R),b.push(R))}i==="wait"&&b.length&&(C=b),k(zA(C)),_(d);return}const{forceRender:S}=N.useContext(mE);return o.jsx(o.Fragment,{children:E.map(C=>{const P=Fy(C),R=a&&!l?!1:d===E||f.includes(P),I=()=>{if(v.has(P))v.set(P,!0);else return;let j=!0;v.forEach(O=>{O||(j=!1)}),j&&(S==null||S(),k(p.current),a&&(u==null||u()),r&&r())};return o.jsx(Fne,{isPresent:R,initial:!m.current||n?void 0:!1,custom:R?void 0:e,presenceAffectsLayout:s,mode:i,onExitComplete:R?void 0:I,children:C},P)})})},Rs=t=>t;let zV=Rs;function xE(t){let e;return()=>(e===void 0&&(e=t()),e)}const Nh=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},Go=t=>t*1e3,Ko=t=>t/1e3,Bne={useManualTiming:!1};function $ne(t){let e=new Set,n=new Set,r=!1,s=!1;const i=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(d){i.has(d)&&(u.schedule(d),t()),d(a)}const u={schedule:(d,f=!1,m=!1)=>{const v=m&&r?e:n;return f&&i.add(d),v.has(d)||v.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(a=d,r){s=!0;return}r=!0,[e,n]=[n,e],e.forEach(l),e.clear(),r=!1,s&&(s=!1,u.process(d))}};return u}const zy=["read","resolveKeyframes","update","preRender","render","postRender"],Une=40;function BV(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=zy.reduce((k,b)=>(k[b]=$ne(i),k),{}),{read:l,resolveKeyframes:u,update:d,preRender:f,render:m,postRender:p}=a,v=()=>{const k=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(k-s.timestamp,Une),1),s.timestamp=k,s.isProcessing=!0,l.process(s),u.process(s),d.process(s),f.process(s),m.process(s),p.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(v))},x=()=>{n=!0,r=!0,s.isProcessing||t(v)};return{schedule:zy.reduce((k,b)=>{const S=a[b];return k[b]=(C,P=!1,R=!1)=>(n||x(),S.schedule(C,P,R)),k},{}),cancel:k=>{for(let b=0;b<zy.length;b++)a[zy[b]].cancel(k)},state:s,steps:a}}const{schedule:an,cancel:Tl,state:gr,steps:Q_}=BV(typeof requestAnimationFrame<"u"?requestAnimationFrame:Rs,!0),$V=N.createContext({strict:!1}),BA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Sh={};for(const t in BA)Sh[t]={isEnabled:e=>BA[t].some(n=>!!e[n])};function qne(t){for(const e in t)Sh[e]={...Sh[e],...t[e]}}const Wne=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function q0(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Wne.has(t)}let UV=t=>!q0(t);function Hne(t){t&&(UV=e=>e.startsWith("on")?!q0(e):t(e))}try{Hne(require("@emotion/is-prop-valid").default)}catch{}function Gne(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(UV(s)||n===!0&&q0(s)||!e&&!q0(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function Kne(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,s)=>s==="create"?t:(e.has(s)||e.set(s,t(s)),e.get(s))})}const xb=N.createContext({});function Mp(t){return typeof t=="string"||Array.isArray(t)}function vb(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const vE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bE=["initial",...vE];function bb(t){return vb(t.animate)||bE.some(e=>Mp(t[e]))}function qV(t){return!!(bb(t)||t.variants)}function Qne(t,e){if(bb(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Mp(n)?n:void 0,animate:Mp(r)?r:void 0}}return t.inherit!==!1?e:{}}function Zne(t){const{initial:e,animate:n}=Qne(t,N.useContext(xb));return N.useMemo(()=>({initial:e,animate:n}),[$A(e),$A(n)])}function $A(t){return Array.isArray(t)?t.join(" "):t}const Yne=Symbol.for("motionComponentSymbol");function Ed(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Xne(t,e,n){return N.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Ed(n)&&(n.current=r))},[e])}const _E=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Jne="framerAppearId",WV="data-"+_E(Jne),{schedule:wE}=BV(queueMicrotask,!1),HV=N.createContext({});function ere(t,e,n,r,s){var i,a;const{visualElement:l}=N.useContext(xb),u=N.useContext($V),d=N.useContext(yb),f=N.useContext(gE).reducedMotion,m=N.useRef(null);r=r||u.renderer,!m.current&&r&&(m.current=r(t,{visualState:e,parent:l,props:n,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:f}));const p=m.current,v=N.useContext(HV);p&&!p.projection&&s&&(p.type==="html"||p.type==="svg")&&tre(m.current,n,s,v);const x=N.useRef(!1);N.useInsertionEffect(()=>{p&&x.current&&p.update(n,d)});const _=n[WV],E=N.useRef(!!_&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,_))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,_)));return FV(()=>{p&&(x.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),wE.render(p.render),E.current&&p.animationState&&p.animationState.animateChanges())}),N.useEffect(()=>{p&&(!E.current&&p.animationState&&p.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var k;(k=window.MotionHandoffMarkAsComplete)===null||k===void 0||k.call(window,_)}),E.current=!1))}),p}function tre(t,e,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:l,layoutScroll:u,layoutRoot:d}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:GV(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||l&&Ed(l),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,layoutScroll:u,layoutRoot:d})}function GV(t){if(t)return t.options.allowProjection!==!1?t.projection:GV(t.parent)}function nre({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){var i,a;t&&qne(t);function l(d,f){let m;const p={...N.useContext(gE),...d,layoutId:rre(d)},{isStatic:v}=p,x=Zne(d),_=r(d,v);if(!v&&yE){sre();const E=ire(p);m=E.MeasureLayout,x.visualElement=ere(s,_,p,e,E.ProjectionNode)}return o.jsxs(xb.Provider,{value:x,children:[m&&x.visualElement?o.jsx(m,{visualElement:x.visualElement,...p}):null,n(s,d,Xne(_,x.visualElement,f),_,v,x.visualElement)]})}l.displayName=`motion.${typeof s=="string"?s:`create(${(a=(i=s.displayName)!==null&&i!==void 0?i:s.name)!==null&&a!==void 0?a:""})`}`;const u=N.forwardRef(l);return u[Yne]=s,u}function rre({layoutId:t}){const e=N.useContext(mE).id;return e&&t!==void 0?e+"-"+t:t}function sre(t,e){N.useContext($V).strict}function ire(t){const{drag:e,layout:n}=Sh;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const ore=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function kE(t){return typeof t!="string"||t.includes("-")?!1:!!(ore.indexOf(t)>-1||/[A-Z]/u.test(t))}function UA(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function NE(t,e,n,r){if(typeof e=="function"){const[s,i]=UA(r);e=e(n!==void 0?n:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=UA(r);e=e(n!==void 0?n:t.custom,s,i)}return e}const w1=t=>Array.isArray(t),are=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),lre=t=>w1(t)?t[t.length-1]||0:t,Rr=t=>!!(t&&t.getVelocity);function Nx(t){const e=Rr(t)?t.get():t;return are(e)?e.toValue():e}function cre({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},r,s,i){const a={latestValues:ure(r,s,i,t),renderState:e()};return n&&(a.onMount=l=>n({props:r,current:l,...a}),a.onUpdate=l=>n(l)),a}const KV=t=>(e,n)=>{const r=N.useContext(xb),s=N.useContext(yb),i=()=>cre(t,e,r,s);return n?i():pE(i)};function ure(t,e,n,r){const s={},i=r(t,{});for(const p in i)s[p]=Nx(i[p]);let{initial:a,animate:l}=t;const u=bb(t),d=qV(t);e&&d&&!u&&t.inherit!==!1&&(a===void 0&&(a=e.initial),l===void 0&&(l=e.animate));let f=n?n.initial===!1:!1;f=f||a===!1;const m=f?l:a;if(m&&typeof m!="boolean"&&!vb(m)){const p=Array.isArray(m)?m:[m];for(let v=0;v<p.length;v++){const x=NE(t,p[v]);if(x){const{transitionEnd:_,transition:E,...k}=x;for(const b in k){let S=k[b];if(Array.isArray(S)){const C=f?S.length-1:0;S=S[C]}S!==null&&(s[b]=S)}for(const b in _)s[b]=_[b]}}}return s}const Gh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Nu=new Set(Gh),QV=t=>e=>typeof e=="string"&&e.startsWith(t),ZV=QV("--"),dre=QV("var(--"),SE=t=>dre(t)?hre.test(t.split("/*")[0].trim()):!1,hre=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,YV=(t,e)=>e&&typeof t=="number"?e.transform(t):t,sa=(t,e,n)=>n>e?e:n<t?t:n,Kh={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Op={...Kh,transform:t=>sa(0,1,t)},By={...Kh,default:1},kg=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Aa=kg("deg"),no=kg("%"),Ze=kg("px"),fre=kg("vh"),mre=kg("vw"),qA={...no,parse:t=>no.parse(t)/100,transform:t=>no.transform(t*100)},pre={borderWidth:Ze,borderTopWidth:Ze,borderRightWidth:Ze,borderBottomWidth:Ze,borderLeftWidth:Ze,borderRadius:Ze,radius:Ze,borderTopLeftRadius:Ze,borderTopRightRadius:Ze,borderBottomRightRadius:Ze,borderBottomLeftRadius:Ze,width:Ze,maxWidth:Ze,height:Ze,maxHeight:Ze,top:Ze,right:Ze,bottom:Ze,left:Ze,padding:Ze,paddingTop:Ze,paddingRight:Ze,paddingBottom:Ze,paddingLeft:Ze,margin:Ze,marginTop:Ze,marginRight:Ze,marginBottom:Ze,marginLeft:Ze,backgroundPositionX:Ze,backgroundPositionY:Ze},gre={rotate:Aa,rotateX:Aa,rotateY:Aa,rotateZ:Aa,scale:By,scaleX:By,scaleY:By,scaleZ:By,skew:Aa,skewX:Aa,skewY:Aa,distance:Ze,translateX:Ze,translateY:Ze,translateZ:Ze,x:Ze,y:Ze,z:Ze,perspective:Ze,transformPerspective:Ze,opacity:Op,originX:qA,originY:qA,originZ:Ze},WA={...Kh,transform:Math.round},TE={...pre,...gre,zIndex:WA,size:Ze,fillOpacity:Op,strokeOpacity:Op,numOctaves:WA},yre={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},xre=Gh.length;function vre(t,e,n){let r="",s=!0;for(let i=0;i<xre;i++){const a=Gh[i],l=t[a];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(a.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||n){const d=YV(l,TE[a]);if(!u){s=!1;const f=yre[a]||a;r+=`${f}(${d}) `}n&&(e[a]=d)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function EE(t,e,n){const{style:r,vars:s,transformOrigin:i}=t;let a=!1,l=!1;for(const u in e){const d=e[u];if(Nu.has(u)){a=!0;continue}else if(ZV(u)){s[u]=d;continue}else{const f=YV(d,TE[u]);u.startsWith("origin")?(l=!0,i[u]=f):r[u]=f}}if(e.transform||(a||n?r.transform=vre(e,t.transform,n):r.transform&&(r.transform="none")),l){const{originX:u="50%",originY:d="50%",originZ:f=0}=i;r.transformOrigin=`${u} ${d} ${f}`}}const bre={offset:"stroke-dashoffset",array:"stroke-dasharray"},_re={offset:"strokeDashoffset",array:"strokeDasharray"};function wre(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?bre:_re;t[i.offset]=Ze.transform(-r);const a=Ze.transform(e),l=Ze.transform(n);t[i.array]=`${a} ${l}`}function HA(t,e,n){return typeof t=="string"?t:Ze.transform(e+n*t)}function kre(t,e,n){const r=HA(e,t.x,t.width),s=HA(n,t.y,t.height);return`${r} ${s}`}function CE(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:a,pathSpacing:l=1,pathOffset:u=0,...d},f,m){if(EE(t,d,m),f){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:v,dimensions:x}=t;p.transform&&(x&&(v.transform=p.transform),delete p.transform),x&&(s!==void 0||i!==void 0||v.transform)&&(v.transformOrigin=kre(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(p.x=e),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),a!==void 0&&wre(p,a,l,u,!1)}const jE=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),XV=()=>({...jE(),attrs:{}}),IE=t=>typeof t=="string"&&t.toLowerCase()==="svg";function JV(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const eF=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function tF(t,e,n,r){JV(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(eF.has(s)?s:_E(s),e.attrs[s])}const W0={};function Nre(t){Object.assign(W0,t)}function nF(t,{layout:e,layoutId:n}){return Nu.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!W0[t]||t==="opacity")}function AE(t,e,n){var r;const{style:s}=t,i={};for(const a in s)(Rr(s[a])||e.style&&Rr(e.style[a])||nF(a,t)||((r=n==null?void 0:n.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(i[a]=s[a]);return i}function rF(t,e,n){const r=AE(t,e,n);for(const s in t)if(Rr(t[s])||Rr(e[s])){const i=Gh.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=t[s]}return r}function Sre(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const GA=["x","y","width","height","cx","cy","r"],Tre={useVisualState:KV({scrapeMotionValuesFromProps:rF,createRenderState:XV,onUpdate:({props:t,prevProps:e,current:n,renderState:r,latestValues:s})=>{if(!n)return;let i=!!t.drag;if(!i){for(const l in s)if(Nu.has(l)){i=!0;break}}if(!i)return;let a=!e;if(e)for(let l=0;l<GA.length;l++){const u=GA[l];t[u]!==e[u]&&(a=!0)}a&&an.read(()=>{Sre(n,r),an.render(()=>{CE(r,s,IE(n.tagName),t.transformTemplate),tF(n,r)})})}})},Ere={useVisualState:KV({scrapeMotionValuesFromProps:AE,createRenderState:jE})};function sF(t,e,n){for(const r in e)!Rr(e[r])&&!nF(r,n)&&(t[r]=e[r])}function Cre({transformTemplate:t},e){return N.useMemo(()=>{const n=jE();return EE(n,e,t),Object.assign({},n.vars,n.style)},[e])}function jre(t,e){const n=t.style||{},r={};return sF(r,n,t),Object.assign(r,Cre(t,e)),r}function Ire(t,e){const n={},r=jre(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}function Are(t,e,n,r){const s=N.useMemo(()=>{const i=XV();return CE(i,e,IE(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};sF(i,t.style,t),s.style={...i,...s.style}}return s}function Rre(t=!1){return(n,r,s,{latestValues:i},a)=>{const u=(kE(n)?Are:Ire)(r,i,a,n),d=Gne(r,typeof n=="string",t),f=n!==N.Fragment?{...d,...u,ref:s}:{},{children:m}=r,p=N.useMemo(()=>Rr(m)?m.get():m,[m]);return N.createElement(n,{...f,children:p})}}function Pre(t,e){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...kE(r)?Tre:Ere,preloadedFeatures:t,useRender:Rre(s),createVisualElement:e,Component:r};return nre(a)}}function iF(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function _b(t,e,n){const r=t.getProps();return NE(r,e,n!==void 0?n:r.custom,t)}const Lre=xE(()=>window.ScrollTimeline!==void 0);class Mre{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e,n){const r=this.animations.map(s=>{if(Lre()&&s.attachTimeline)return s.attachTimeline(e);if(typeof n=="function")return n(s)});return()=>{r.forEach((s,i)=>{s&&s(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Ore extends Mre{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function RE(t,e){return t?t[e]||t.default||t:void 0}const k1=2e4;function oF(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<k1;)e+=n,r=t.next(e);return e>=k1?1/0:e}function PE(t){return typeof t=="function"}function KA(t,e){t.timeline=e,t.onfinish=null}const LE=t=>Array.isArray(t)&&typeof t[0]=="number",Dre={linearEasing:void 0};function Vre(t,e){const n=xE(t);return()=>{var r;return(r=Dre[e])!==null&&r!==void 0?r:n()}}const H0=Vre(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),aF=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let i=0;i<s;i++)r+=t(Nh(0,s-1,i))+", ";return`linear(${r.substring(0,r.length-2)})`};function lF(t){return!!(typeof t=="function"&&H0()||!t||typeof t=="string"&&(t in N1||H0())||LE(t)||Array.isArray(t)&&t.every(lF))}const cm=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,N1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cm([0,.65,.55,1]),circOut:cm([.55,0,1,.45]),backIn:cm([.31,.01,.66,-.59]),backOut:cm([.33,1.53,.69,.99])};function cF(t,e){if(t)return typeof t=="function"&&H0()?aF(t,e):LE(t)?cm(t):Array.isArray(t)?t.map(n=>cF(n,e)||N1.easeOut):N1[t]}const gi={x:!1,y:!1};function uF(){return gi.x||gi.y}function Fre(t,e,n){var r;if(t instanceof Element)return[t];if(typeof t=="string"){let s=document;const i=(r=void 0)!==null&&r!==void 0?r:s.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}function dF(t,e){const n=Fre(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function QA(t){return e=>{e.pointerType==="touch"||uF()||t(e)}}function zre(t,e,n={}){const[r,s,i]=dF(t,n),a=QA(l=>{const{target:u}=l,d=e(l);if(typeof d!="function"||!u)return;const f=QA(m=>{d(m),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,s)});return r.forEach(l=>{l.addEventListener("pointerenter",a,s)}),i}const hF=(t,e)=>e?t===e?!0:hF(t,e.parentElement):!1,ME=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Bre=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function $re(t){return Bre.has(t.tagName)||t.tabIndex!==-1}const um=new WeakSet;function ZA(t){return e=>{e.key==="Enter"&&t(e)}}function Z_(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Ure=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=ZA(()=>{if(um.has(n))return;Z_(n,"down");const s=ZA(()=>{Z_(n,"up")}),i=()=>Z_(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function YA(t){return ME(t)&&!uF()}function qre(t,e,n={}){const[r,s,i]=dF(t,n),a=l=>{const u=l.currentTarget;if(!YA(l)||um.has(u))return;um.add(u);const d=e(l),f=(v,x)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",p),!(!YA(v)||!um.has(u))&&(um.delete(u),typeof d=="function"&&d(v,{success:x}))},m=v=>{f(v,n.useGlobalTarget||hF(u,v.target))},p=v=>{f(v,!1)};window.addEventListener("pointerup",m,s),window.addEventListener("pointercancel",p,s)};return r.forEach(l=>{!$re(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(n.useGlobalTarget?window:l).addEventListener("pointerdown",a,s),l.addEventListener("focus",d=>Ure(d,s),s)}),i}function Wre(t){return t==="x"||t==="y"?gi[t]?null:(gi[t]=!0,()=>{gi[t]=!1}):gi.x||gi.y?null:(gi.x=gi.y=!0,()=>{gi.x=gi.y=!1})}const fF=new Set(["width","height","top","left","right","bottom",...Gh]);let Sx;function Hre(){Sx=void 0}const ro={now:()=>(Sx===void 0&&ro.set(gr.isProcessing||Bne.useManualTiming?gr.timestamp:performance.now()),Sx),set:t=>{Sx=t,queueMicrotask(Hre)}};function OE(t,e){t.indexOf(e)===-1&&t.push(e)}function DE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class VE{constructor(){this.subscriptions=[]}add(e){return OE(this.subscriptions,e),()=>DE(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function mF(t,e){return e?t*(1e3/e):0}const XA=30,Gre=t=>!isNaN(parseFloat(t));class Kre{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{const i=ro.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=ro.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Gre(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new VE);const r=this.events[e].add(n);return e==="change"?()=>{r(),an.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ro.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>XA)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,XA);return mF(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Dp(t,e){return new Kre(t,e)}function Qre(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Dp(n))}function Zre(t,e){const n=_b(t,e);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const l=lre(i[a]);Qre(t,a,l)}}function Yre(t){return!!(Rr(t)&&t.add)}function S1(t,e){const n=t.getValue("willChange");if(Yre(n))return n.add(e)}function pF(t){return t.props[WV]}const gF=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Xre=1e-7,Jre=12;function ese(t,e,n,r,s){let i,a,l=0;do a=e+(n-e)/2,i=gF(a,r,s)-t,i>0?n=a:e=a;while(Math.abs(i)>Xre&&++l<Jre);return a}function Ng(t,e,n,r){if(t===e&&n===r)return Rs;const s=i=>ese(i,0,1,t,n);return i=>i===0||i===1?i:gF(s(i),e,r)}const yF=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,xF=t=>e=>1-t(1-e),vF=Ng(.33,1.53,.69,.99),FE=xF(vF),bF=yF(FE),_F=t=>(t*=2)<1?.5*FE(t):.5*(2-Math.pow(2,-10*(t-1))),zE=t=>1-Math.sin(Math.acos(t)),wF=xF(zE),kF=yF(zE),NF=t=>/^0[^.\s]+$/u.test(t);function tse(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||NF(t):!0}const Vm=t=>Math.round(t*1e5)/1e5,BE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function nse(t){return t==null}const rse=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,$E=(t,e)=>n=>!!(typeof n=="string"&&rse.test(n)&&n.startsWith(t)||e&&!nse(n)&&Object.prototype.hasOwnProperty.call(n,e)),SF=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,l]=r.match(BE);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},sse=t=>sa(0,255,t),Y_={...Kh,transform:t=>Math.round(sse(t))},xc={test:$E("rgb","red"),parse:SF("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Y_.transform(t)+", "+Y_.transform(e)+", "+Y_.transform(n)+", "+Vm(Op.transform(r))+")"};function ise(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const T1={test:$E("#"),parse:ise,transform:xc.transform},Cd={test:$E("hsl","hue"),parse:SF("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+no.transform(Vm(e))+", "+no.transform(Vm(n))+", "+Vm(Op.transform(r))+")"},Cr={test:t=>xc.test(t)||T1.test(t)||Cd.test(t),parse:t=>xc.test(t)?xc.parse(t):Cd.test(t)?Cd.parse(t):T1.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?xc.transform(t):Cd.transform(t)},ose=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function ase(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(BE))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(ose))===null||n===void 0?void 0:n.length)||0)>0}const TF="number",EF="color",lse="var",cse="var(",JA="${}",use=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Vp(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const l=e.replace(use,u=>(Cr.test(u)?(r.color.push(i),s.push(EF),n.push(Cr.parse(u))):u.startsWith(cse)?(r.var.push(i),s.push(lse),n.push(u)):(r.number.push(i),s.push(TF),n.push(parseFloat(u))),++i,JA)).split(JA);return{values:n,split:l,indexes:r,types:s}}function CF(t){return Vp(t).values}function jF(t){const{split:e,types:n}=Vp(t),r=e.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=e[a],s[a]!==void 0){const l=n[a];l===TF?i+=Vm(s[a]):l===EF?i+=Cr.transform(s[a]):i+=s[a]}return i}}const dse=t=>typeof t=="number"?0:t;function hse(t){const e=CF(t);return jF(t)(e.map(dse))}const El={test:ase,parse:CF,createTransformer:jF,getAnimatableNone:hse},fse=new Set(["brightness","contrast","saturate","opacity"]);function mse(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(BE)||[];if(!r)return t;const s=n.replace(r,"");let i=fse.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const pse=/\b([a-z-]*)\(.*?\)/gu,E1={...El,getAnimatableNone:t=>{const e=t.match(pse);return e?e.map(mse).join(" "):t}},gse={...TE,color:Cr,backgroundColor:Cr,outlineColor:Cr,fill:Cr,stroke:Cr,borderColor:Cr,borderTopColor:Cr,borderRightColor:Cr,borderBottomColor:Cr,borderLeftColor:Cr,filter:E1,WebkitFilter:E1},UE=t=>gse[t];function IF(t,e){let n=UE(t);return n!==E1&&(n=El),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const yse=new Set(["auto","none","0"]);function xse(t,e,n){let r=0,s;for(;r<t.length&&!s;){const i=t[r];typeof i=="string"&&!yse.has(i)&&Vp(i).values.length&&(s=t[r]),r++}if(s&&n)for(const i of e)t[i]=IF(n,s)}const eR=t=>t===Kh||t===Ze,tR=(t,e)=>parseFloat(t.split(", ")[e]),nR=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/u);if(s)return tR(s[1],e);{const i=r.match(/^matrix\((.+)\)$/u);return i?tR(i[1],t):0}},vse=new Set(["x","y","z"]),bse=Gh.filter(t=>!vse.has(t));function _se(t){const e=[];return bse.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Th={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:nR(4,13),y:nR(5,14)};Th.translateX=Th.x;Th.translateY=Th.y;const Ic=new Set;let C1=!1,j1=!1;function AF(){if(j1){const t=Array.from(Ic).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=_se(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var l;(l=r.getValue(i))===null||l===void 0||l.set(a)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}j1=!1,C1=!1,Ic.forEach(t=>t.complete()),Ic.clear()}function RF(){Ic.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(j1=!0)})}function wse(){RF(),AF()}class qE{constructor(e,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ic.add(this),C1||(C1=!0,an.read(RF),an.resolveKeyframes(AF))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const a=s==null?void 0:s.get(),l=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&n){const u=r.readValue(n,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),s&&a===void 0&&s.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Ic.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ic.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const PF=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),kse=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Nse(t){const e=kse.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function LF(t,e,n=1){const[r,s]=Nse(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const a=i.trim();return PF(a)?parseFloat(a):a}return SE(s)?LF(s,e,n+1):s}const MF=t=>e=>e.test(t),Sse={test:t=>t==="auto",parse:t=>t},OF=[Kh,Ze,no,Aa,mre,fre,Sse],rR=t=>OF.find(MF(t));class DF extends qE{constructor(e,n,r,s,i){super(e,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),SE(d))){const f=LF(d,n.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!fF.has(r)||e.length!==2)return;const[s,i]=e,a=rR(s),l=rR(i);if(a!==l)if(eR(a)&&eR(l))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)tse(e[s])&&r.push(s);r.length&&xse(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Th[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:s}=this;if(!n||!n.current)return;const i=n.getValue(r);i&&i.jump(this.measuredOrigin,!1);const a=s.length-1,l=s[a];s[a]=Th[r](n.measureViewportBox(),window.getComputedStyle(n.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,d])=>{n.getValue(u).set(d)}),this.resolveNoneKeyframes()}}const sR=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(El.test(t)||t==="0")&&!t.startsWith("url("));function Tse(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Ese(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],a=sR(s,e),l=sR(i,e);return!a||!l?!1:Tse(t)||(n==="spring"||PE(n))&&r}const Cse=t=>t!==null;function wb(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(Cse),i=e&&n!=="loop"&&e%2===1?0:s.length-1;return!i||r===void 0?s[i]:r}const jse=40;class VF{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ro.now(),this.options={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>jse?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&wse(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=ro.now(),this.hasAttemptedResolve=!0;const{name:r,type:s,velocity:i,delay:a,onComplete:l,onUpdate:u,isGenerator:d}=this.options;if(!d&&!Ese(e,r,s,i))if(a)this.options.duration=0;else{u&&u(wb(e,this.options,n)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,n);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...f},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const yn=(t,e,n)=>t+(e-t)*n;function X_(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Ise({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,a=0;if(!e)s=i=a=n;else{const l=n<.5?n*(1+e):n+e-n*e,u=2*n-l;s=X_(u,l,t+1/3),i=X_(u,l,t),a=X_(u,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function G0(t,e){return n=>n>0?e:t}const J_=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},Ase=[T1,xc,Cd],Rse=t=>Ase.find(e=>e.test(t));function iR(t){const e=Rse(t);if(!e)return!1;let n=e.parse(t);return e===Cd&&(n=Ise(n)),n}const oR=(t,e)=>{const n=iR(t),r=iR(e);if(!n||!r)return G0(t,e);const s={...n};return i=>(s.red=J_(n.red,r.red,i),s.green=J_(n.green,r.green,i),s.blue=J_(n.blue,r.blue,i),s.alpha=yn(n.alpha,r.alpha,i),xc.transform(s))},Pse=(t,e)=>n=>e(t(n)),Sg=(...t)=>t.reduce(Pse),I1=new Set(["none","hidden"]);function Lse(t,e){return I1.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Mse(t,e){return n=>yn(t,e,n)}function WE(t){return typeof t=="number"?Mse:typeof t=="string"?SE(t)?G0:Cr.test(t)?oR:Vse:Array.isArray(t)?FF:typeof t=="object"?Cr.test(t)?oR:Ose:G0}function FF(t,e){const n=[...t],r=n.length,s=t.map((i,a)=>WE(i)(i,e[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function Ose(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=WE(t[s])(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function Dse(t,e){var n;const r=[],s={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],l=t.indexes[a][s[a]],u=(n=t.values[l])!==null&&n!==void 0?n:0;r[i]=u,s[a]++}return r}const Vse=(t,e)=>{const n=El.createTransformer(e),r=Vp(t),s=Vp(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?I1.has(t)&&!s.values.length||I1.has(e)&&!r.values.length?Lse(t,e):Sg(FF(Dse(r,s),s.values),n):G0(t,e)};function zF(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?yn(t,e,n):WE(t)(t,e)}const Fse=5;function BF(t,e,n){const r=Math.max(e-Fse,0);return mF(n-t(r),e-r)}const Sn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ew=.001;function zse({duration:t=Sn.duration,bounce:e=Sn.bounce,velocity:n=Sn.velocity,mass:r=Sn.mass}){let s,i,a=1-e;a=sa(Sn.minDamping,Sn.maxDamping,a),t=sa(Sn.minDuration,Sn.maxDuration,Ko(t)),a<1?(s=d=>{const f=d*a,m=f*t,p=f-n,v=A1(d,a),x=Math.exp(-m);return ew-p/v*x},i=d=>{const m=d*a*t,p=m*n+n,v=Math.pow(a,2)*Math.pow(d,2)*t,x=Math.exp(-m),_=A1(Math.pow(d,2),a);return(-s(d)+ew>0?-1:1)*((p-v)*x)/_}):(s=d=>{const f=Math.exp(-d*t),m=(d-n)*t+1;return-ew+f*m},i=d=>{const f=Math.exp(-d*t),m=(n-d)*(t*t);return f*m});const l=5/t,u=$se(s,i,l);if(t=Go(t),isNaN(u))return{stiffness:Sn.stiffness,damping:Sn.damping,duration:t};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:a*2*Math.sqrt(r*d),duration:t}}}const Bse=12;function $se(t,e,n){let r=n;for(let s=1;s<Bse;s++)r=r-t(r)/e(r);return r}function A1(t,e){return t*Math.sqrt(1-e*e)}const Use=["duration","bounce"],qse=["stiffness","damping","mass"];function aR(t,e){return e.some(n=>t[n]!==void 0)}function Wse(t){let e={velocity:Sn.velocity,stiffness:Sn.stiffness,damping:Sn.damping,mass:Sn.mass,isResolvedFromDuration:!1,...t};if(!aR(t,qse)&&aR(t,Use))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*sa(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Sn.mass,stiffness:s,damping:i}}else{const n=zse(t);e={...e,...n,mass:Sn.mass},e.isResolvedFromDuration=!0}return e}function $F(t=Sn.visualDuration,e=Sn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],l={done:!1,value:i},{stiffness:u,damping:d,mass:f,duration:m,velocity:p,isResolvedFromDuration:v}=Wse({...n,velocity:-Ko(n.velocity||0)}),x=p||0,_=d/(2*Math.sqrt(u*f)),E=a-i,k=Ko(Math.sqrt(u/f)),b=Math.abs(E)<5;r||(r=b?Sn.restSpeed.granular:Sn.restSpeed.default),s||(s=b?Sn.restDelta.granular:Sn.restDelta.default);let S;if(_<1){const P=A1(k,_);S=R=>{const I=Math.exp(-_*k*R);return a-I*((x+_*k*E)/P*Math.sin(P*R)+E*Math.cos(P*R))}}else if(_===1)S=P=>a-Math.exp(-k*P)*(E+(x+k*E)*P);else{const P=k*Math.sqrt(_*_-1);S=R=>{const I=Math.exp(-_*k*R),j=Math.min(P*R,300);return a-I*((x+_*k*E)*Math.sinh(j)+P*E*Math.cosh(j))/P}}const C={calculatedDuration:v&&m||null,next:P=>{const R=S(P);if(v)l.done=P>=m;else{let I=0;_<1&&(I=P===0?Go(x):BF(S,P,R));const j=Math.abs(I)<=r,O=Math.abs(a-R)<=s;l.done=j&&O}return l.value=l.done?a:R,l},toString:()=>{const P=Math.min(oF(C),k1),R=aF(I=>C.next(P*I).value,P,30);return P+"ms "+R}};return C}function lR({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:u,restDelta:d=.5,restSpeed:f}){const m=t[0],p={done:!1,value:m},v=j=>l!==void 0&&j<l||u!==void 0&&j>u,x=j=>l===void 0?u:u===void 0||Math.abs(l-j)<Math.abs(u-j)?l:u;let _=n*e;const E=m+_,k=a===void 0?E:a(E);k!==E&&(_=k-m);const b=j=>-_*Math.exp(-j/r),S=j=>k+b(j),C=j=>{const O=b(j),V=S(j);p.done=Math.abs(O)<=d,p.value=p.done?k:V};let P,R;const I=j=>{v(p.value)&&(P=j,R=$F({keyframes:[p.value,x(p.value)],velocity:BF(S,j,p.value),damping:s,stiffness:i,restDelta:d,restSpeed:f}))};return I(0),{calculatedDuration:null,next:j=>{let O=!1;return!R&&P===void 0&&(O=!0,C(j),I(j)),P!==void 0&&j>=P?R.next(j-P):(!O&&C(j),p)}}}const Hse=Ng(.42,0,1,1),Gse=Ng(0,0,.58,1),UF=Ng(.42,0,.58,1),Kse=t=>Array.isArray(t)&&typeof t[0]!="number",Qse={linear:Rs,easeIn:Hse,easeInOut:UF,easeOut:Gse,circIn:zE,circInOut:kF,circOut:wF,backIn:FE,backInOut:bF,backOut:vF,anticipate:_F},cR=t=>{if(LE(t)){zV(t.length===4);const[e,n,r,s]=t;return Ng(e,n,r,s)}else if(typeof t=="string")return Qse[t];return t};function Zse(t,e,n){const r=[],s=n||zF,i=t.length-1;for(let a=0;a<i;a++){let l=s(t[a],t[a+1]);if(e){const u=Array.isArray(e)?e[a]||Rs:e;l=Sg(u,l)}r.push(l)}return r}function Yse(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(zV(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const l=Zse(e,r,s),u=l.length,d=f=>{if(a&&f<t[0])return e[0];let m=0;if(u>1)for(;m<t.length-2&&!(f<t[m+1]);m++);const p=Nh(t[m],t[m+1],f);return l[m](p)};return n?f=>d(sa(t[0],t[i-1],f)):d}function Xse(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=Nh(0,e,r);t.push(yn(n,1,s))}}function Jse(t){const e=[0];return Xse(e,t.length-1),e}function eie(t,e){return t.map(n=>n*e)}function tie(t,e){return t.map(()=>e||UF).splice(0,t.length-1)}function K0({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=Kse(r)?r.map(cR):cR(r),i={done:!1,value:e[0]},a=eie(n&&n.length===e.length?n:Jse(e),t),l=Yse(a,e,{ease:Array.isArray(s)?s:tie(e,s)});return{calculatedDuration:t,next:u=>(i.value=l(u),i.done=u>=t,i)}}const nie=t=>{const e=({timestamp:n})=>t(n);return{start:()=>an.update(e,!0),stop:()=>Tl(e),now:()=>gr.isProcessing?gr.timestamp:ro.now()}},rie={decay:lR,inertia:lR,tween:K0,keyframes:K0,spring:$F},sie=t=>t/100;class HE extends VF{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:n,motionValue:r,element:s,keyframes:i}=this.options,a=(s==null?void 0:s.KeyframeResolver)||qE,l=(u,d)=>this.onKeyframesResolved(u,d);this.resolver=new a(i,l,n,r,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=this.options,l=PE(n)?n:rie[n]||K0;let u,d;l!==K0&&typeof e[0]!="number"&&(u=Sg(sie,zF(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});i==="mirror"&&(d=l({...this.options,keyframes:[...e].reverse(),velocity:-a})),f.calculatedDuration===null&&(f.calculatedDuration=oF(f));const{calculatedDuration:m}=f,p=m+s,v=p*(r+1)-s;return{generator:f,mirroredGenerator:d,mapPercentToKeyframes:u,calculatedDuration:m,resolvedDuration:p,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:j}=this.options;return{done:!0,value:j[j.length-1]}}const{finalKeyframe:s,generator:i,mirroredGenerator:a,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:d,totalDuration:f,resolvedDuration:m}=r;if(this.startTime===null)return i.next(0);const{delay:p,repeat:v,repeatType:x,repeatDelay:_,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const k=this.currentTime-p*(this.speed>=0?1:-1),b=this.speed>=0?k<0:k>f;this.currentTime=Math.max(k,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let S=this.currentTime,C=i;if(v){const j=Math.min(this.currentTime,f)/m;let O=Math.floor(j),V=j%1;!V&&j>=1&&(V=1),V===1&&O--,O=Math.min(O,v+1),!!(O%2)&&(x==="reverse"?(V=1-V,_&&(V-=_/m)):x==="mirror"&&(C=a)),S=sa(0,1,V)*m}const P=b?{done:!1,value:u[0]}:C.next(S);l&&(P.value=l(P.value));let{done:R}=P;!b&&d!==null&&(R=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return I&&s!==void 0&&(P.value=wb(u,this.options,s)),E&&E(P.value),I&&this.finish(),P}get duration(){const{resolved:e}=this;return e?Ko(e.calculatedDuration):0}get time(){return Ko(this.currentTime)}set time(e){e=Go(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ko(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=nie,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const iie=new Set(["opacity","clipPath","filter","transform"]);function oie(t,e,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:l="easeInOut",times:u}={}){const d={[e]:n};u&&(d.offset=u);const f=cF(l,s);return Array.isArray(f)&&(d.easing=f),t.animate(d,{delay:r,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"})}const aie=xE(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Q0=10,lie=2e4;function cie(t){return PE(t.type)||t.type==="spring"||!lF(t.ease)}function uie(t,e){const n=new HE({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const s=[];let i=0;for(;!r.done&&i<lie;)r=n.sample(i),s.push(r.value),i+=Q0;return{times:void 0,keyframes:s,duration:i-Q0,ease:"linear"}}const qF={anticipate:_F,backInOut:bF,circInOut:kF};function die(t){return t in qF}class uR extends VF{constructor(e){super(e);const{name:n,motionValue:r,element:s,keyframes:i}=this.options;this.resolver=new DF(i,(a,l)=>this.onKeyframesResolved(a,l),n,r,s),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:r=300,times:s,ease:i,type:a,motionValue:l,name:u,startTime:d}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof i=="string"&&H0()&&die(i)&&(i=qF[i]),cie(this.options)){const{onComplete:m,onUpdate:p,motionValue:v,element:x,..._}=this.options,E=uie(e,_);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,s=E.times,i=E.ease,a="keyframes"}const f=oie(l.owner.current,u,e,{...this.options,duration:r,times:s,ease:i});return f.startTime=d??this.calcStartTime(),this.pendingTimeline?(KA(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;l.set(wb(e,this.options,n)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:r,times:s,type:a,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Ko(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Ko(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=Go(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return Rs;const{animation:r}=n;KA(r,e)}return Rs}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:s,type:i,ease:a,times:l}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:f,onComplete:m,element:p,...v}=this.options,x=new HE({...v,keyframes:r,duration:s,type:i,ease:a,times:l,isGenerator:!0}),_=Go(this.time);d.setWithVelocity(x.sample(_-Q0).value,x.sample(_).value,Q0)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:s,repeatType:i,damping:a,type:l}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=n.owner.getProps();return aie()&&r&&iie.has(r)&&!u&&!d&&!s&&i!=="mirror"&&a!==0&&l!=="inertia"}}const hie={type:"spring",stiffness:500,damping:25,restSpeed:10},fie=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),mie={type:"keyframes",duration:.8},pie={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},gie=(t,{keyframes:e})=>e.length>2?mie:Nu.has(t)?t.startsWith("scale")?fie(e[1]):hie:pie;function yie({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:l,from:u,elapsed:d,...f}){return!!Object.keys(f).length}const GE=(t,e,n,r={},s,i)=>a=>{const l=RE(r,t)||{},u=l.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Go(u);let f={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-d,onUpdate:p=>{e.set(p),l.onUpdate&&l.onUpdate(p)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:t,motionValue:e,element:i?void 0:s};yie(l)||(f={...f,...gie(t,f)}),f.duration&&(f.duration=Go(f.duration)),f.repeatDelay&&(f.repeatDelay=Go(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!i&&e.get()!==void 0){const p=wb(f.keyframes,l);if(p!==void 0)return an.update(()=>{f.onUpdate(p),f.onComplete()}),new Ore([])}return!i&&uR.supports(f)?new uR(f):new HE(f)};function xie({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function WF(t,e,{delay:n=0,transitionOverride:r,type:s}={}){var i;let{transition:a=t.getDefaultTransition(),transitionEnd:l,...u}=e;r&&(a=r);const d=[],f=s&&t.animationState&&t.animationState.getState()[s];for(const m in u){const p=t.getValue(m,(i=t.latestValues[m])!==null&&i!==void 0?i:null),v=u[m];if(v===void 0||f&&xie(f,m))continue;const x={delay:n,...RE(a||{},m)};let _=!1;if(window.MotionHandoffAnimation){const k=pF(t);if(k){const b=window.MotionHandoffAnimation(k,m,an);b!==null&&(x.startTime=b,_=!0)}}S1(t,m),p.start(GE(m,p,v,t.shouldReduceMotion&&fF.has(m)?{type:!1}:x,t,_));const E=p.animation;E&&d.push(E)}return l&&Promise.all(d).then(()=>{an.update(()=>{l&&Zre(t,l)})}),d}function R1(t,e,n={}){var r;const s=_b(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(i=n.transitionOverride);const a=s?()=>Promise.all(WF(t,s,n)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(d=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:p}=i;return vie(t,e,f+d,m,p,n)}:()=>Promise.resolve(),{when:u}=i;if(u){const[d,f]=u==="beforeChildren"?[a,l]:[l,a];return d().then(()=>f())}else return Promise.all([a(),l(n.delay)])}function vie(t,e,n=0,r=0,s=1,i){const a=[],l=(t.variantChildren.size-1)*r,u=s===1?(d=0)=>d*r:(d=0)=>l-d*r;return Array.from(t.variantChildren).sort(bie).forEach((d,f)=>{d.notify("AnimationStart",e),a.push(R1(d,e,{...i,delay:n+u(f)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(a)}function bie(t,e){return t.sortNodePosition(e)}function _ie(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>R1(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=R1(t,e,n);else{const s=typeof e=="function"?_b(t,e,n.custom):e;r=Promise.all(WF(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const wie=bE.length;function HF(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?HF(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<wie;n++){const r=bE[n],s=t.props[r];(Mp(s)||s===!1)&&(e[r]=s)}return e}const kie=[...vE].reverse(),Nie=vE.length;function Sie(t){return e=>Promise.all(e.map(({animation:n,options:r})=>_ie(t,n,r)))}function Tie(t){let e=Sie(t),n=dR(),r=!0;const s=u=>(d,f)=>{var m;const p=_b(t,f,u==="exit"?(m=t.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(p){const{transition:v,transitionEnd:x,..._}=p;d={...d,..._,...x}}return d};function i(u){e=u(t)}function a(u){const{props:d}=t,f=HF(t.parent)||{},m=[],p=new Set;let v={},x=1/0;for(let E=0;E<Nie;E++){const k=kie[E],b=n[k],S=d[k]!==void 0?d[k]:f[k],C=Mp(S),P=k===u?b.isActive:null;P===!1&&(x=E);let R=S===f[k]&&S!==d[k]&&C;if(R&&r&&t.manuallyAnimateOnMount&&(R=!1),b.protectedKeys={...v},!b.isActive&&P===null||!S&&!b.prevProp||vb(S)||typeof S=="boolean")continue;const I=Eie(b.prevProp,S);let j=I||k===u&&b.isActive&&!R&&C||E>x&&C,O=!1;const V=Array.isArray(S)?S:[S];let z=V.reduce(s(k),{});P===!1&&(z={});const{prevResolvedValues:D={}}=b,F={...D,...z},ee=ae=>{j=!0,p.has(ae)&&(O=!0,p.delete(ae)),b.needsAnimating[ae]=!0;const H=t.getValue(ae);H&&(H.liveStyle=!1)};for(const ae in F){const H=z[ae],Q=D[ae];if(v.hasOwnProperty(ae))continue;let W=!1;w1(H)&&w1(Q)?W=!iF(H,Q):W=H!==Q,W?H!=null?ee(ae):p.add(ae):H!==void 0&&p.has(ae)?ee(ae):b.protectedKeys[ae]=!0}b.prevProp=S,b.prevResolvedValues=z,b.isActive&&(v={...v,...z}),r&&t.blockInitialAnimation&&(j=!1),j&&(!(R&&I)||O)&&m.push(...V.map(ae=>({animation:ae,options:{type:k}})))}if(p.size){const E={};p.forEach(k=>{const b=t.getBaseTarget(k),S=t.getValue(k);S&&(S.liveStyle=!0),E[k]=b??null}),m.push({animation:E})}let _=!!m.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(_=!1),r=!1,_?e(m):Promise.resolve()}function l(u,d){var f;if(n[u].isActive===d)return Promise.resolve();(f=t.variantChildren)===null||f===void 0||f.forEach(p=>{var v;return(v=p.animationState)===null||v===void 0?void 0:v.setActive(u,d)}),n[u].isActive=d;const m=a(u);for(const p in n)n[p].protectedKeys={};return m}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>n,reset:()=>{n=dR(),r=!0}}}function Eie(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!iF(e,t):!1}function Jl(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function dR(){return{animate:Jl(!0),whileInView:Jl(),whileHover:Jl(),whileTap:Jl(),whileDrag:Jl(),whileFocus:Jl(),exit:Jl()}}class zl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Cie extends zl{constructor(e){super(e),e.animationState||(e.animationState=Tie(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();vb(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let jie=0;class Iie extends zl{constructor(){super(...arguments),this.id=jie++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Aie={animation:{Feature:Cie},exit:{Feature:Iie}};function Fp(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Tg(t){return{point:{x:t.pageX,y:t.pageY}}}const Rie=t=>e=>ME(e)&&t(e,Tg(e));function Fm(t,e,n,r){return Fp(t,e,Rie(n),r)}const hR=(t,e)=>Math.abs(t-e);function Pie(t,e){const n=hR(t.x,e.x),r=hR(t.y,e.y);return Math.sqrt(n**2+r**2)}class GF{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=nw(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,v=Pie(m.offset,{x:0,y:0})>=3;if(!p&&!v)return;const{point:x}=m,{timestamp:_}=gr;this.history.push({...x,timestamp:_});const{onStart:E,onMove:k}=this.handlers;p||(E&&E(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,m)},this.handlePointerMove=(m,p)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=tw(p,this.transformPagePoint),an.update(this.updatePoint,!0)},this.handlePointerUp=(m,p)=>{this.end();const{onEnd:v,onSessionEnd:x,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=nw(m.type==="pointercancel"?this.lastMoveEventInfo:tw(p,this.transformPagePoint),this.history);this.startEvent&&v&&v(m,E),x&&x(m,E)},!ME(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=Tg(e),l=tw(a,this.transformPagePoint),{point:u}=l,{timestamp:d}=gr;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=n;f&&f(e,nw(l,this.history)),this.removeListeners=Sg(Fm(this.contextWindow,"pointermove",this.handlePointerMove),Fm(this.contextWindow,"pointerup",this.handlePointerUp),Fm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Tl(this.updatePoint)}}function tw(t,e){return e?{point:e(t.point)}:t}function fR(t,e){return{x:t.x-e.x,y:t.y-e.y}}function nw({point:t},e){return{point:t,delta:fR(t,KF(e)),offset:fR(t,Lie(e)),velocity:Mie(e,.1)}}function Lie(t){return t[0]}function KF(t){return t[t.length-1]}function Mie(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=KF(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>Go(e)));)n--;if(!r)return{x:0,y:0};const i=Ko(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const QF=1e-4,Oie=1-QF,Die=1+QF,ZF=.01,Vie=0-ZF,Fie=0+ZF;function Ms(t){return t.max-t.min}function zie(t,e,n){return Math.abs(t-e)<=n}function mR(t,e,n,r=.5){t.origin=r,t.originPoint=yn(e.min,e.max,t.origin),t.scale=Ms(n)/Ms(e),t.translate=yn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Oie&&t.scale<=Die||isNaN(t.scale))&&(t.scale=1),(t.translate>=Vie&&t.translate<=Fie||isNaN(t.translate))&&(t.translate=0)}function zm(t,e,n,r){mR(t.x,e.x,n.x,r?r.originX:void 0),mR(t.y,e.y,n.y,r?r.originY:void 0)}function pR(t,e,n){t.min=n.min+e.min,t.max=t.min+Ms(e)}function Bie(t,e,n){pR(t.x,e.x,n.x),pR(t.y,e.y,n.y)}function gR(t,e,n){t.min=e.min-n.min,t.max=t.min+Ms(e)}function Bm(t,e,n){gR(t.x,e.x,n.x),gR(t.y,e.y,n.y)}function $ie(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?yn(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?yn(n,t,r.max):Math.min(t,n)),t}function yR(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Uie(t,{top:e,left:n,bottom:r,right:s}){return{x:yR(t.x,n,s),y:yR(t.y,e,r)}}function xR(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function qie(t,e){return{x:xR(t.x,e.x),y:xR(t.y,e.y)}}function Wie(t,e){let n=.5;const r=Ms(t),s=Ms(e);return s>r?n=Nh(e.min,e.max-r,t.min):r>s&&(n=Nh(t.min,t.max-s,e.min)),sa(0,1,n)}function Hie(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const P1=.35;function Gie(t=P1){return t===!1?t=0:t===!0&&(t=P1),{x:vR(t,"left","right"),y:vR(t,"top","bottom")}}function vR(t,e,n){return{min:bR(t,e),max:bR(t,n)}}function bR(t,e){return typeof t=="number"?t:t[e]||0}const _R=()=>({translate:0,scale:1,origin:0,originPoint:0}),jd=()=>({x:_R(),y:_R()}),wR=()=>({min:0,max:0}),Pn=()=>({x:wR(),y:wR()});function Qs(t){return[t("x"),t("y")]}function YF({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Kie({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Qie(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function rw(t){return t===void 0||t===1}function L1({scale:t,scaleX:e,scaleY:n}){return!rw(t)||!rw(e)||!rw(n)}function oc(t){return L1(t)||XF(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function XF(t){return kR(t.x)||kR(t.y)}function kR(t){return t&&t!=="0%"}function Z0(t,e,n){const r=t-n,s=e*r;return n+s}function NR(t,e,n,r,s){return s!==void 0&&(t=Z0(t,s,r)),Z0(t,n,r)+e}function M1(t,e=0,n=1,r,s){t.min=NR(t.min,e,n,r,s),t.max=NR(t.max,e,n,r,s)}function JF(t,{x:e,y:n}){M1(t.x,e.translate,e.scale,e.originPoint),M1(t.y,n.translate,n.scale,n.originPoint)}const SR=.999999999999,TR=1.0000000000001;function Zie(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,a;for(let l=0;l<s;l++){i=n[l],a=i.projectionDelta;const{visualElement:u}=i.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Ad(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,JF(t,a)),r&&oc(i.latestValues)&&Ad(t,i.latestValues))}e.x<TR&&e.x>SR&&(e.x=1),e.y<TR&&e.y>SR&&(e.y=1)}function Id(t,e){t.min=t.min+e,t.max=t.max+e}function ER(t,e,n,r,s=.5){const i=yn(t.min,t.max,s);M1(t,e,n,i,r)}function Ad(t,e){ER(t.x,e.x,e.scaleX,e.scale,e.originX),ER(t.y,e.y,e.scaleY,e.scale,e.originY)}function e6(t,e){return YF(Qie(t.getBoundingClientRect(),e))}function Yie(t,e,n){const r=e6(t,n),{scroll:s}=e;return s&&(Id(r.x,s.offset.x),Id(r.y,s.offset.y)),r}const t6=({current:t})=>t?t.ownerDocument.defaultView:null,Xie=new WeakMap;class Jie{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Pn(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Tg(f).point)},i=(f,m)=>{const{drag:p,dragPropagation:v,onDragStart:x}=this.getProps();if(p&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Wre(p),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Qs(E=>{let k=this.getAxisMotionValue(E).get()||0;if(no.test(k)){const{projection:b}=this.visualElement;if(b&&b.layout){const S=b.layout.layoutBox[E];S&&(k=Ms(S)*(parseFloat(k)/100))}}this.originPoint[E]=k}),x&&an.postRender(()=>x(f,m)),S1(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},a=(f,m)=>{const{dragPropagation:p,dragDirectionLock:v,onDirectionLock:x,onDrag:_}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:E}=m;if(v&&this.currentDirection===null){this.currentDirection=eoe(E),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",m.point,E),this.updateAxis("y",m.point,E),this.visualElement.render(),_&&_(f,m)},l=(f,m)=>this.stop(f,m),u=()=>Qs(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new GF(e,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:t6(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&an.postRender(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!$y(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=$ie(a,this.constraints[e],this.elastic[e])),i.set(a)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&Ed(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=Uie(s.layoutBox,n):this.constraints=!1,this.elastic=Gie(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Qs(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Hie(s.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Ed(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=Yie(r,s.root,this.visualElement.getTransformPagePoint());let a=qie(s.layout.layoutBox,i);if(n){const l=n(Kie(a));this.hasMutatedConstraints=!!l,l&&(a=YF(l))}return a}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},d=Qs(f=>{if(!$y(f,n,this.currentDirection))return;let m=u&&u[f]||{};a&&(m={min:0,max:0});const p=s?200:1e6,v=s?40:1e7,x={type:"inertia",velocity:r?e[f]:0,bounceStiffness:p,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...i,...m};return this.startAxisValueAnimation(f,x)});return Promise.all(d).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return S1(this.visualElement,e),r.start(GE(e,r,0,n,this.visualElement,!1))}stopAnimation(){Qs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Qs(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Qs(n=>{const{drag:r}=this.getProps();if(!$y(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:l}=s.layout.layoutBox[n];i.set(e[n]-yn(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Ed(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Qs(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const u=l.get();s[a]=Wie({min:u,max:u},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Qs(a=>{if(!$y(a,e,null))return;const l=this.getAxisMotionValue(a),{min:u,max:d}=this.constraints[a];l.set(yn(u,d,s[a]))})}addListeners(){if(!this.visualElement.current)return;Xie.set(this.visualElement,this);const e=this.visualElement.current,n=Fm(e,"pointerdown",u=>{const{drag:d,dragListener:f=!0}=this.getProps();d&&f&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Ed(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),an.read(r);const a=Fp(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Qs(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=u[f].translate,m.set(m.get()+u[f].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=P1,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function $y(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function eoe(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class toe extends zl{constructor(e){super(e),this.removeGroupControls=Rs,this.removeListeners=Rs,this.controls=new Jie(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Rs}unmount(){this.removeGroupControls(),this.removeListeners()}}const CR=t=>(e,n)=>{t&&an.postRender(()=>t(e,n))};class noe extends zl{constructor(){super(...arguments),this.removePointerDownListener=Rs}onPointerDown(e){this.session=new GF(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:t6(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:CR(e),onStart:CR(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&an.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Fm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Tx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function jR(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Wf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ze.test(t))t=parseFloat(t);else return t;const n=jR(t,e.target.x),r=jR(t,e.target.y);return`${n}% ${r}%`}},roe={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=El.parse(t);if(s.length>5)return r;const i=El.createTransformer(t),a=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,u=n.y.scale*e.y;s[0+a]/=l,s[1+a]/=u;const d=yn(l,u,.5);return typeof s[2+a]=="number"&&(s[2+a]/=d),typeof s[3+a]=="number"&&(s[3+a]/=d),i(s)}};class soe extends N.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;Nre(ioe),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Tx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,a=r.projection;return a&&(a.isPresent=i,s||e.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?a.promote():a.relegate()||an.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),wE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function n6(t){const[e,n]=VV(),r=N.useContext(mE);return o.jsx(soe,{...t,layoutGroup:r,switchLayoutGroup:N.useContext(HV),isPresent:e,safeToRemove:n})}const ioe={borderRadius:{...Wf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Wf,borderTopRightRadius:Wf,borderBottomLeftRadius:Wf,borderBottomRightRadius:Wf,boxShadow:roe};function ooe(t,e,n){const r=Rr(t)?t:Dp(t);return r.start(GE("",r,e,n)),r.animation}function aoe(t){return t instanceof SVGElement&&t.tagName!=="svg"}const loe=(t,e)=>t.depth-e.depth;class coe{constructor(){this.children=[],this.isDirty=!1}add(e){OE(this.children,e),this.isDirty=!0}remove(e){DE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(loe),this.isDirty=!1,this.children.forEach(e)}}function uoe(t,e){const n=ro.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(Tl(r),t(i-e))};return an.read(r,!0),()=>Tl(r)}const r6=["TopLeft","TopRight","BottomLeft","BottomRight"],doe=r6.length,IR=t=>typeof t=="string"?parseFloat(t):t,AR=t=>typeof t=="number"||Ze.test(t);function hoe(t,e,n,r,s,i){s?(t.opacity=yn(0,n.opacity!==void 0?n.opacity:1,foe(r)),t.opacityExit=yn(e.opacity!==void 0?e.opacity:1,0,moe(r))):i&&(t.opacity=yn(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let a=0;a<doe;a++){const l=`border${r6[a]}Radius`;let u=RR(e,l),d=RR(n,l);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||AR(u)===AR(d)?(t[l]=Math.max(yn(IR(u),IR(d),r),0),(no.test(d)||no.test(u))&&(t[l]+="%")):t[l]=d}(e.rotate||n.rotate)&&(t.rotate=yn(e.rotate||0,n.rotate||0,r))}function RR(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const foe=s6(0,.5,wF),moe=s6(.5,.95,Rs);function s6(t,e,n){return r=>r<t?0:r>e?1:n(Nh(t,e,r))}function PR(t,e){t.min=e.min,t.max=e.max}function Ks(t,e){PR(t.x,e.x),PR(t.y,e.y)}function LR(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function MR(t,e,n,r,s){return t-=e,t=Z0(t,1/n,r),s!==void 0&&(t=Z0(t,1/s,r)),t}function poe(t,e=0,n=1,r=.5,s,i=t,a=t){if(no.test(e)&&(e=parseFloat(e),e=yn(a.min,a.max,e/100)-a.min),typeof e!="number")return;let l=yn(i.min,i.max,r);t===i&&(l-=e),t.min=MR(t.min,e,n,l,s),t.max=MR(t.max,e,n,l,s)}function OR(t,e,[n,r,s],i,a){poe(t,e[n],e[r],e[s],e.scale,i,a)}const goe=["x","scaleX","originX"],yoe=["y","scaleY","originY"];function DR(t,e,n,r){OR(t.x,e,goe,n?n.x:void 0,r?r.x:void 0),OR(t.y,e,yoe,n?n.y:void 0,r?r.y:void 0)}function VR(t){return t.translate===0&&t.scale===1}function i6(t){return VR(t.x)&&VR(t.y)}function FR(t,e){return t.min===e.min&&t.max===e.max}function xoe(t,e){return FR(t.x,e.x)&&FR(t.y,e.y)}function zR(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function o6(t,e){return zR(t.x,e.x)&&zR(t.y,e.y)}function BR(t){return Ms(t.x)/Ms(t.y)}function $R(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class voe{constructor(){this.members=[]}add(e){OE(this.members,e),e.scheduleRender()}remove(e){if(DE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function boe(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:d,rotate:f,rotateX:m,rotateY:p,skewX:v,skewY:x}=n;d&&(r=`perspective(${d}px) ${r}`),f&&(r+=`rotate(${f}deg) `),m&&(r+=`rotateX(${m}deg) `),p&&(r+=`rotateY(${p}deg) `),v&&(r+=`skewX(${v}deg) `),x&&(r+=`skewY(${x}deg) `)}const l=t.x.scale*e.x,u=t.y.scale*e.y;return(l!==1||u!==1)&&(r+=`scale(${l}, ${u})`),r||"none"}const ac={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},dm=typeof window<"u"&&window.MotionDebug!==void 0,sw=["","X","Y","Z"],_oe={visibility:"hidden"},UR=1e3;let woe=0;function iw(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function a6(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=pF(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",an,!(s||i))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&a6(r)}function l6({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},l=e==null?void 0:e()){this.id=woe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,dm&&(ac.totalNodes=ac.resolvedTargetDeltas=ac.recalculatedProjection=0),this.nodes.forEach(Soe),this.nodes.forEach(Ioe),this.nodes.forEach(Aoe),this.nodes.forEach(Toe),dm&&window.MotionDebug.record(ac)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new coe)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new VE),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const u=this.eventHandlers.get(a);u&&u.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=aoe(a),this.instance=a;const{layoutId:u,layout:d,visualElement:f}=this.options;if(f&&!f.current&&f.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||u)&&(this.isLayoutDirty=!0),t){let m;const p=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=uoe(p,250),Tx.hasAnimatedSinceResize&&(Tx.hasAnimatedSinceResize=!1,this.nodes.forEach(WR))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||d)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:p,hasRelativeTargetChanged:v,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||f.getDefaultTransition()||Ooe,{onLayoutAnimationStart:E,onLayoutAnimationComplete:k}=f.getProps(),b=!this.targetLayout||!o6(this.targetLayout,x)||v,S=!p&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||p&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,S);const C={...RE(_,"layout"),onPlay:E,onComplete:k};(f.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else p||WR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Tl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Roe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&a6(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(qR);return}this.isUpdating||this.nodes.forEach(Coe),this.isUpdating=!1,this.nodes.forEach(joe),this.nodes.forEach(koe),this.nodes.forEach(Noe),this.clearAllSnapshots();const l=ro.now();gr.delta=sa(0,1e3/60,l-gr.timestamp),gr.timestamp=l,gr.isProcessing=!0,Q_.update.process(gr),Q_.preRender.process(gr),Q_.render.process(gr),gr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,wE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Eoe),this.sharedNodes.forEach(Poe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,an.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){an.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Pn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:u,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!i6(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;a&&(l||oc(this.latestValues)||f)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return a&&(u=this.removeTransform(u)),Doe(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:l}=this.options;if(!l)return Pn();const u=l.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(Voe))){const{scroll:f}=this.root;f&&(Id(u.x,f.offset.x),Id(u.y,f.offset.y))}return u}removeElementScroll(a){var l;const u=Pn();if(Ks(u,a),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let d=0;d<this.path.length;d++){const f=this.path[d],{scroll:m,options:p}=f;f!==this.root&&m&&p.layoutScroll&&(m.wasRoot&&Ks(u,a),Id(u.x,m.offset.x),Id(u.y,m.offset.y))}return u}applyTransform(a,l=!1){const u=Pn();Ks(u,a);for(let d=0;d<this.path.length;d++){const f=this.path[d];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Ad(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),oc(f.latestValues)&&Ad(u,f.latestValues)}return oc(this.latestValues)&&Ad(u,this.latestValues),u}removeTransform(a){const l=Pn();Ks(l,a);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!oc(d.latestValues))continue;L1(d.latestValues)&&d.updateSnapshot();const f=Pn(),m=d.measurePageBox();Ks(f,m),DR(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,f)}return oc(this.latestValues)&&DR(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==gr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==u;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:p}=this.options;if(!(!this.layout||!(m||p))){if(this.resolvedRelativeTargetAt=gr.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pn(),this.relativeTargetOrigin=Pn(),Bm(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),Ks(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Pn(),this.targetWithTransforms=Pn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Bie(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ks(this.target,this.layout.layoutBox),JF(this.target,this.targetDelta)):Ks(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pn(),this.relativeTargetOrigin=Pn(),Bm(this.relativeTargetOrigin,this.target,v.target),Ks(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}dm&&ac.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||L1(this.parent.latestValues)||XF(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===gr.timestamp&&(d=!1),d)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;Ks(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,v=this.treeScale.y;Zie(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Pn());const{target:x}=l;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(LR(this.prevProjectionDelta.x,this.projectionDelta.x),LR(this.prevProjectionDelta.y,this.projectionDelta.y)),zm(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==v||!$R(this.projectionDelta.x,this.prevProjectionDelta.x)||!$R(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),dm&&ac.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),a){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=jd(),this.projectionDelta=jd(),this.projectionDeltaWithTransform=jd()}setAnimationOrigin(a,l=!1){const u=this.snapshot,d=u?u.latestValues:{},f={...this.latestValues},m=jd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const p=Pn(),v=u?u.source:void 0,x=this.layout?this.layout.source:void 0,_=v!==x,E=this.getStack(),k=!E||E.members.length<=1,b=!!(_&&!k&&this.options.crossfade===!0&&!this.path.some(Moe));this.animationProgress=0;let S;this.mixTargetDelta=C=>{const P=C/1e3;HR(m.x,a.x,P),HR(m.y,a.y,P),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Bm(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Loe(this.relativeTarget,this.relativeTargetOrigin,p,P),S&&xoe(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=Pn()),Ks(S,this.relativeTarget)),_&&(this.animationValues=f,hoe(f,d,this.latestValues,P,b,k)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Tl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=an.update(()=>{Tx.hasAnimatedSinceResize=!0,this.currentAnimation=ooe(0,UR,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(UR),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:u,layout:d,latestValues:f}=a;if(!(!l||!u||!d)){if(this!==a&&this.layout&&d&&c6(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Pn();const m=Ms(this.layout.layoutBox.x);u.x.min=a.target.x.min,u.x.max=u.x.min+m;const p=Ms(this.layout.layoutBox.y);u.y.min=a.target.y.min,u.y.max=u.y.min+p}Ks(l,u),Ad(l,f),zm(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new voe),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:u}=a;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const d={};u.z&&iw("z",a,d,this.animationValues);for(let f=0;f<sw.length;f++)iw(`rotate${sw[f]}`,a,d,this.animationValues),iw(`skew${sw[f]}`,a,d,this.animationValues);a.render();for(const f in d)a.setStaticValue(f,d[f]),this.animationValues&&(this.animationValues[f]=d[f]);a.scheduleRender()}getProjectionStyles(a){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return _oe;const d={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Nx(a==null?void 0:a.pointerEvents)||"",d.transform=f?f(this.latestValues,""):"none",d;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=Nx(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!oc(this.latestValues)&&(_.transform=f?f({},""):"none",this.hasProjected=!1),_}const p=m.animationValues||m.latestValues;this.applyTransformsToTarget(),d.transform=boe(this.projectionDeltaWithTransform,this.treeScale,p),f&&(d.transform=f(p,d.transform));const{x:v,y:x}=this.projectionDelta;d.transformOrigin=`${v.origin*100}% ${x.origin*100}% 0`,m.animationValues?d.opacity=m===this?(u=(l=p.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=m===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const _ in W0){if(p[_]===void 0)continue;const{correct:E,applyTo:k}=W0[_],b=d.transform==="none"?p[_]:E(p[_],m);if(k){const S=k.length;for(let C=0;C<S;C++)d[k[C]]=b}else d[_]=b}return this.options.layoutId&&(d.pointerEvents=m===this?Nx(a==null?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(qR),this.root.sharedNodes.clear()}}}function koe(t){t.updateLayout()}function Noe(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,a=n.source!==t.layout.source;i==="size"?Qs(m=>{const p=a?n.measuredBox[m]:n.layoutBox[m],v=Ms(p);p.min=r[m].min,p.max=p.min+v}):c6(i,n.layoutBox,r)&&Qs(m=>{const p=a?n.measuredBox[m]:n.layoutBox[m],v=Ms(r[m]);p.max=p.min+v,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+v)});const l=jd();zm(l,r,n.layoutBox);const u=jd();a?zm(u,t.applyTransform(s,!0),n.measuredBox):zm(u,r,n.layoutBox);const d=!i6(l);let f=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:p,layout:v}=m;if(p&&v){const x=Pn();Bm(x,n.layoutBox,p.layoutBox);const _=Pn();Bm(_,r,v.layoutBox),o6(x,_)||(f=!0),m.options.layoutRoot&&(t.relativeTarget=_,t.relativeTargetOrigin=x,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:u,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:f})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Soe(t){dm&&ac.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Toe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Eoe(t){t.clearSnapshot()}function qR(t){t.clearMeasurements()}function Coe(t){t.isLayoutDirty=!1}function joe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function WR(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Ioe(t){t.resolveTargetDelta()}function Aoe(t){t.calcProjection()}function Roe(t){t.resetSkewAndRotation()}function Poe(t){t.removeLeadSnapshot()}function HR(t,e,n){t.translate=yn(e.translate,0,n),t.scale=yn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function GR(t,e,n,r){t.min=yn(e.min,n.min,r),t.max=yn(e.max,n.max,r)}function Loe(t,e,n,r){GR(t.x,e.x,n.x,r),GR(t.y,e.y,n.y,r)}function Moe(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Ooe={duration:.45,ease:[.4,0,.1,1]},KR=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),QR=KR("applewebkit/")&&!KR("chrome/")?Math.round:Rs;function ZR(t){t.min=QR(t.min),t.max=QR(t.max)}function Doe(t){ZR(t.x),ZR(t.y)}function c6(t,e,n){return t==="position"||t==="preserve-aspect"&&!zie(BR(e),BR(n),.2)}function Voe(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const Foe=l6({attachResizeListener:(t,e)=>Fp(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ow={current:void 0},u6=l6({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!ow.current){const t=new Foe({});t.mount(window),t.setOptions({layoutScroll:!0}),ow.current=t}return ow.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),zoe={pan:{Feature:noe},drag:{Feature:toe,ProjectionNode:u6,MeasureLayout:n6}};function YR(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&an.postRender(()=>i(e,Tg(e)))}class Boe extends zl{mount(){const{current:e}=this.node;e&&(this.unmount=zre(e,n=>(YR(this.node,n,"Start"),r=>YR(this.node,r,"End"))))}unmount(){}}class $oe extends zl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Sg(Fp(this.node.current,"focus",()=>this.onFocus()),Fp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function XR(t,e,n){const{props:r}=t;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&an.postRender(()=>i(e,Tg(e)))}class Uoe extends zl{mount(){const{current:e}=this.node;e&&(this.unmount=qre(e,n=>(XR(this.node,n,"Start"),(r,{success:s})=>XR(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const O1=new WeakMap,aw=new WeakMap,qoe=t=>{const e=O1.get(t.target);e&&e(t)},Woe=t=>{t.forEach(qoe)};function Hoe({root:t,...e}){const n=t||document;aw.has(n)||aw.set(n,{});const r=aw.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Woe,{root:t,...e})),r[s]}function Goe(t,e,n){const r=Hoe(e);return O1.set(t,n),r.observe(t),()=>{O1.delete(t),r.unobserve(t)}}const Koe={some:0,all:1};class Qoe extends zl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Koe[s]},l=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),p=d?f:m;p&&p(u)};return Goe(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Zoe(e,n))&&this.startObserver()}unmount(){}}function Zoe({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Yoe={inView:{Feature:Qoe},tap:{Feature:Uoe},focus:{Feature:$oe},hover:{Feature:Boe}},Xoe={layout:{ProjectionNode:u6,MeasureLayout:n6}},D1={current:null},d6={current:!1};function Joe(){if(d6.current=!0,!!yE)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>D1.current=t.matches;t.addListener(e),e()}else D1.current=!1}const eae=[...OF,Cr,El],tae=t=>eae.find(MF(t)),JR=new WeakMap;function nae(t,e,n){for(const r in e){const s=e[r],i=n[r];if(Rr(s))t.addValue(r,s);else if(Rr(i))t.addValue(r,Dp(s,{owner:t}));else if(i!==s)if(t.hasValue(r)){const a=t.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=t.getStaticValue(r);t.addValue(r,Dp(a!==void 0?a:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const eP=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class rae{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=qE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=ro.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,an.render(this.render,!1,!0))};const{latestValues:u,renderState:d,onUpdate:f}=a;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=n.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=bb(n),this.isVariantNode=qV(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const v in p){const x=p[v];u[v]!==void 0&&Rr(x)&&x.set(u[v],!1)}}mount(e){this.current=e,JR.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),d6.current||Joe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:D1.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){JR.delete(this.current),this.projection&&this.projection.unmount(),Tl(this.notifyUpdate),Tl(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Nu.has(e),s=n.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&an.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Sh){const n=Sh[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Pn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<eP.length;r++){const s=eP[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=e[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=nae(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Dp(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(PF(s)||NF(s))?s=parseFloat(s):!tae(s)&&El.test(n)&&(s=IF(e,n)),this.setBaseTarget(e,Rr(s)?s.get():s)),Rr(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const a=NE(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);a&&(s=a[e])}if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Rr(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new VE),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class h6 extends rae{constructor(){super(...arguments),this.KeyframeResolver=DF}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Rr(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function sae(t){return window.getComputedStyle(t)}class iae extends h6{constructor(){super(...arguments),this.type="html",this.renderInstance=JV}readValueFromInstance(e,n){if(Nu.has(n)){const r=UE(n);return r&&r.default||0}else{const r=sae(e),s=(ZV(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return e6(e,n)}build(e,n,r){EE(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return AE(e,n,r)}}class oae extends h6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Pn}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Nu.has(n)){const r=UE(n);return r&&r.default||0}return n=eF.has(n)?n:_E(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return rF(e,n,r)}build(e,n,r){CE(e,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,r,s){tF(e,n,r,s)}mount(e){this.isSVGTag=IE(e.tagName),super.mount(e)}}const aae=(t,e)=>kE(t)?new oae(e):new iae(e,{allowProjection:t!==N.Fragment}),lae=Pre({...Aie,...Yoe,...zoe,...Xoe},aae),tt=Kne(lae);let cae={data:""},uae=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||cae},dae=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,hae=/\/\*[^]*?\*\/|  +/g,tP=/\n+/g,qa=(t,e)=>{let n="",r="",s="";for(let i in t){let a=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+a+";":r+=i[1]=="f"?qa(a,i):i+"{"+qa(a,i[1]=="k"?"":e)+"}":typeof a=="object"?r+=qa(a,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=qa.p?qa.p(i,a):i+":"+a+";")}return n+(e&&s?e+"{"+s+"}":s)+r},Io={},f6=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+f6(t[n]);return e}return t},fae=(t,e,n,r,s)=>{let i=f6(t),a=Io[i]||(Io[i]=(u=>{let d=0,f=11;for(;d<u.length;)f=101*f+u.charCodeAt(d++)>>>0;return"go"+f})(i));if(!Io[a]){let u=i!==t?t:(d=>{let f,m,p=[{}];for(;f=dae.exec(d.replace(hae,""));)f[4]?p.shift():f[3]?(m=f[3].replace(tP," ").trim(),p.unshift(p[0][m]=p[0][m]||{})):p[0][f[1]]=f[2].replace(tP," ").trim();return p[0]})(t);Io[a]=qa(s?{["@keyframes "+a]:u}:u,n?"":"."+a)}let l=n&&Io.g?Io.g:null;return n&&(Io.g=Io[a]),((u,d,f,m)=>{m?d.data=d.data.replace(m,u):d.data.indexOf(u)===-1&&(d.data=f?u+d.data:d.data+u)})(Io[a],e,r,l),a},mae=(t,e,n)=>t.reduce((r,s,i)=>{let a=e[i];if(a&&a.call){let l=a(n),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;a=u?"."+u:l&&typeof l=="object"?l.props?"":qa(l,""):l===!1?"":l}return r+s+(a??"")},"");function kb(t){let e=this||{},n=t.call?t(e.p):t;return fae(n.unshift?n.raw?mae(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,uae(e.target),e.g,e.o,e.k)}let m6,V1,F1;kb.bind({g:1});let ia=kb.bind({k:1});function pae(t,e,n,r){qa.p=e,m6=t,V1=n,F1=r}function Bl(t,e){let n=this||{};return function(){let r=arguments;function s(i,a){let l=Object.assign({},i),u=l.className||s.className;n.p=Object.assign({theme:V1&&V1()},l),n.o=/ *go\d+/.test(u),l.className=kb.apply(n,r)+(u?" "+u:"");let d=t;return t[0]&&(d=l.as||t,delete l.as),F1&&d[0]&&F1(l),m6(d,l)}return s}}var gae=t=>typeof t=="function",Y0=(t,e)=>gae(t)?t(e):t,yae=(()=>{let t=0;return()=>(++t).toString()})(),p6=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),xae=20,KE="default",g6=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:r}=e;return g6(t,{type:t.toasts.find(a=>a.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(a=>a.id===s||s===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+i}))}}},Ex=[],y6={toasts:[],pausedAt:void 0,settings:{toastLimit:xae}},Zi={},x6=(t,e=KE)=>{Zi[e]=g6(Zi[e]||y6,t),Ex.forEach(([n,r])=>{n===e&&r(Zi[e])})},v6=t=>Object.keys(Zi).forEach(e=>x6(t,e)),vae=t=>Object.keys(Zi).find(e=>Zi[e].toasts.some(n=>n.id===t)),Nb=(t=KE)=>e=>{x6(e,t)},bae={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},_ae=(t={},e=KE)=>{let[n,r]=N.useState(Zi[e]||y6),s=N.useRef(Zi[e]);N.useEffect(()=>(s.current!==Zi[e]&&r(Zi[e]),Ex.push([e,r]),()=>{let a=Ex.findIndex(([l])=>l===e);a>-1&&Ex.splice(a,1)}),[e]);let i=n.toasts.map(a=>{var l,u,d;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((l=t[a.type])==null?void 0:l.removeDelay)||(t==null?void 0:t.removeDelay),duration:a.duration||((u=t[a.type])==null?void 0:u.duration)||(t==null?void 0:t.duration)||bae[a.type],style:{...t.style,...(d=t[a.type])==null?void 0:d.style,...a.style}}});return{...n,toasts:i}},wae=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||yae()}),Eg=t=>(e,n)=>{let r=wae(e,t,n);return Nb(r.toasterId||vae(r.id))({type:2,toast:r}),r.id},Gn=(t,e)=>Eg("blank")(t,e);Gn.error=Eg("error");Gn.success=Eg("success");Gn.loading=Eg("loading");Gn.custom=Eg("custom");Gn.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Nb(e)(n):v6(n)};Gn.dismissAll=t=>Gn.dismiss(void 0,t);Gn.remove=(t,e)=>{let n={type:4,toastId:t};e?Nb(e)(n):v6(n)};Gn.removeAll=t=>Gn.remove(void 0,t);Gn.promise=(t,e,n)=>{let r=Gn.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Y0(e.success,s):void 0;return i?Gn.success(i,{id:r,...n,...n==null?void 0:n.success}):Gn.dismiss(r),s}).catch(s=>{let i=e.error?Y0(e.error,s):void 0;i?Gn.error(i,{id:r,...n,...n==null?void 0:n.error}):Gn.dismiss(r)}),t};var kae=1e3,Nae=(t,e="default")=>{let{toasts:n,pausedAt:r}=_ae(t,e),s=N.useRef(new Map).current,i=N.useCallback((m,p=kae)=>{if(s.has(m))return;let v=setTimeout(()=>{s.delete(m),a({type:4,toastId:m})},p);s.set(m,v)},[]);N.useEffect(()=>{if(r)return;let m=Date.now(),p=n.map(v=>{if(v.duration===1/0)return;let x=(v.duration||0)+v.pauseDuration-(m-v.createdAt);if(x<0){v.visible&&Gn.dismiss(v.id);return}return setTimeout(()=>Gn.dismiss(v.id,e),x)});return()=>{p.forEach(v=>v&&clearTimeout(v))}},[n,r,e]);let a=N.useCallback(Nb(e),[e]),l=N.useCallback(()=>{a({type:5,time:Date.now()})},[a]),u=N.useCallback((m,p)=>{a({type:1,toast:{id:m,height:p}})},[a]),d=N.useCallback(()=>{r&&a({type:6,time:Date.now()})},[r,a]),f=N.useCallback((m,p)=>{let{reverseOrder:v=!1,gutter:x=8,defaultPosition:_}=p||{},E=n.filter(S=>(S.position||_)===(m.position||_)&&S.height),k=E.findIndex(S=>S.id===m.id),b=E.filter((S,C)=>C<k&&S.visible).length;return E.filter(S=>S.visible).slice(...v?[b+1]:[0,b]).reduce((S,C)=>S+(C.height||0)+x,0)},[n]);return N.useEffect(()=>{n.forEach(m=>{if(m.dismissed)i(m.id,m.removeDelay);else{let p=s.get(m.id);p&&(clearTimeout(p),s.delete(m.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:u,startPause:l,endPause:d,calculateOffset:f}}},Sae=ia`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Tae=ia`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Eae=ia`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Cae=Bl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Sae} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Tae} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Eae} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,jae=ia`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Iae=Bl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${jae} 1s linear infinite;
`,Aae=ia`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Rae=ia`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Pae=Bl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Aae} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Rae} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Lae=Bl("div")`
  position: absolute;
`,Mae=Bl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Oae=ia`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Dae=Bl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Oae} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Vae=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?N.createElement(Dae,null,e):e:n==="blank"?null:N.createElement(Mae,null,N.createElement(Iae,{...r}),n!=="loading"&&N.createElement(Lae,null,n==="error"?N.createElement(Cae,{...r}):N.createElement(Pae,{...r})))},Fae=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,zae=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Bae="0%{opacity:0;} 100%{opacity:1;}",$ae="0%{opacity:1;} 100%{opacity:0;}",Uae=Bl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,qae=Bl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Wae=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=p6()?[Bae,$ae]:[Fae(n),zae(n)];return{animation:e?`${ia(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ia(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Hae=N.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?Wae(t.position||e||"top-center",t.visible):{opacity:0},i=N.createElement(Vae,{toast:t}),a=N.createElement(qae,{...t.ariaProps},Y0(t.message,t));return N.createElement(Uae,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:a}):N.createElement(N.Fragment,null,i,a))});pae(N.createElement);var Gae=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=N.useCallback(a=>{if(a){let l=()=>{let u=a.getBoundingClientRect().height;r(t,u)};l(),new MutationObserver(l).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return N.createElement("div",{ref:i,className:e,style:n},s)},Kae=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:p6()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},Qae=kb`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Uy=16,Zae=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:a,containerClassName:l})=>{let{toasts:u,handlers:d}=Nae(n,i);return N.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Uy,left:Uy,right:Uy,bottom:Uy,pointerEvents:"none",...a},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},u.map(f=>{let m=f.position||e,p=d.calculateOffset(f,{reverseOrder:t,gutter:r,defaultPosition:e}),v=Kae(m,p);return N.createElement(Gae,{id:f.id,key:f.id,onHeightUpdate:d.updateHeight,className:f.visible?Qae:"",style:v},f.type==="custom"?Y0(f.message,f):s?s(f):N.createElement(Hae,{toast:f,position:m}))}))},Wt=Gn;const b6="/assets/SeshNx-PNG%20cCropped%20white%20text-BvB6QJif.png",_6="/assets/SeshNx-PNG%20cCropped-mikqxod_.png";function w6(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=w6(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function au(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=w6(t))&&(r&&(r+=" "),r+=e);return r}const QE="-",Yae=t=>{const e=Jae(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const l=a.split(QE);return l[0]===""&&l.length!==1&&l.shift(),k6(l,e)||Xae(a)},getConflictingClassGroupIds:(a,l)=>{const u=n[a]||[];return l&&r[a]?[...u,...r[a]]:u}}},k6=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?k6(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(QE);return(a=e.validators.find(({validator:l})=>l(i)))==null?void 0:a.classGroupId},nP=/^\[(.+)\]$/,Xae=t=>{if(nP.test(t)){const e=nP.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},Jae=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return tle(Object.entries(t.classGroups),n).forEach(([i,a])=>{z1(a,r,i,e)}),r},z1=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:rP(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(ele(s)){z1(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{z1(a,rP(e,i),n,r)})})},rP=(t,e)=>{let n=t;return e.split(QE).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},ele=t=>t.isThemeGetter,tle=(t,e)=>e?t.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,l])=>[e+a,l])):i);return[n,s]}):t,nle=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},N6="!",rle=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,s=e[0],i=e.length,a=l=>{const u=[];let d=0,f=0,m;for(let E=0;E<l.length;E++){let k=l[E];if(d===0){if(k===s&&(r||l.slice(E,E+i)===e)){u.push(l.slice(f,E)),f=E+i;continue}if(k==="/"){m=E;continue}}k==="["?d++:k==="]"&&d--}const p=u.length===0?l:l.substring(f),v=p.startsWith(N6),x=v?p.substring(1):p,_=m&&m>f?m-f:void 0;return{modifiers:u,hasImportantModifier:v,baseClassName:x,maybePostfixModifierPosition:_}};return n?l=>n({className:l,parseClassName:a}):a},sle=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},ile=t=>({cache:nle(t.cacheSize),parseClassName:rle(t),...Yae(t)}),ole=/\s+/,ale=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],a=t.trim().split(ole);let l="";for(let u=a.length-1;u>=0;u-=1){const d=a[u],{modifiers:f,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:v}=n(d);let x=!!v,_=r(x?p.substring(0,v):p);if(!_){if(!x){l=d+(l.length>0?" "+l:l);continue}if(_=r(p),!_){l=d+(l.length>0?" "+l:l);continue}x=!1}const E=sle(f).join(":"),k=m?E+N6:E,b=k+_;if(i.includes(b))continue;i.push(b);const S=s(_,x);for(let C=0;C<S.length;++C){const P=S[C];i.push(k+P)}l=d+(l.length>0?" "+l:l)}return l};function lle(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=S6(e))&&(r&&(r+=" "),r+=n);return r}const S6=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=S6(t[r]))&&(n&&(n+=" "),n+=e);return n};function cle(t,...e){let n,r,s,i=a;function a(u){const d=e.reduce((f,m)=>m(f),t());return n=ile(d),r=n.cache.get,s=n.cache.set,i=l,l(u)}function l(u){const d=r(u);if(d)return d;const f=ale(u,n);return s(u,f),f}return function(){return i(lle.apply(null,arguments))}}const tn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},T6=/^\[(?:([a-z-]+):)?(.+)\]$/i,ule=/^\d+\/\d+$/,dle=new Set(["px","full","screen"]),hle=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,fle=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,mle=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ple=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gle=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ao=t=>Wd(t)||dle.has(t)||ule.test(t),Ca=t=>Qh(t,"length",Nle),Wd=t=>!!t&&!Number.isNaN(Number(t)),lw=t=>Qh(t,"number",Wd),Hf=t=>!!t&&Number.isInteger(Number(t)),yle=t=>t.endsWith("%")&&Wd(t.slice(0,-1)),ht=t=>T6.test(t),ja=t=>hle.test(t),xle=new Set(["length","size","percentage"]),vle=t=>Qh(t,xle,E6),ble=t=>Qh(t,"position",E6),_le=new Set(["image","url"]),wle=t=>Qh(t,_le,Tle),kle=t=>Qh(t,"",Sle),Gf=()=>!0,Qh=(t,e,n)=>{const r=T6.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},Nle=t=>fle.test(t)&&!mle.test(t),E6=()=>!1,Sle=t=>ple.test(t),Tle=t=>gle.test(t),Ele=()=>{const t=tn("colors"),e=tn("spacing"),n=tn("blur"),r=tn("brightness"),s=tn("borderColor"),i=tn("borderRadius"),a=tn("borderSpacing"),l=tn("borderWidth"),u=tn("contrast"),d=tn("grayscale"),f=tn("hueRotate"),m=tn("invert"),p=tn("gap"),v=tn("gradientColorStops"),x=tn("gradientColorStopPositions"),_=tn("inset"),E=tn("margin"),k=tn("opacity"),b=tn("padding"),S=tn("saturate"),C=tn("scale"),P=tn("sepia"),R=tn("skew"),I=tn("space"),j=tn("translate"),O=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",ht,e],D=()=>[ht,e],F=()=>["",Ao,Ca],ee=()=>["auto",Wd,ht],ue=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ve=()=>["solid","dashed","dotted","double","none"],ae=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],H=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",ht],W=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>[Wd,ht];return{cacheSize:500,separator:":",theme:{colors:[Gf],spacing:[Ao,Ca],blur:["none","",ja,ht],brightness:re(),borderColor:[t],borderRadius:["none","","full",ja,ht],borderSpacing:D(),borderWidth:F(),contrast:re(),grayscale:Q(),hueRotate:re(),invert:Q(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[yle,Ca],inset:z(),margin:z(),opacity:re(),padding:D(),saturate:re(),scale:re(),sepia:Q(),skew:re(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",ht]}],container:["container"],columns:[{columns:[ja]}],"break-after":[{"break-after":W()}],"break-before":[{"break-before":W()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ue(),ht]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Hf,ht]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ht]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Hf,ht]}],"grid-cols":[{"grid-cols":[Gf]}],"col-start-end":[{col:["auto",{span:["full",Hf,ht]},ht]}],"col-start":[{"col-start":ee()}],"col-end":[{"col-end":ee()}],"grid-rows":[{"grid-rows":[Gf]}],"row-start-end":[{row:["auto",{span:[Hf,ht]},ht]}],"row-start":[{"row-start":ee()}],"row-end":[{"row-end":ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ht]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ht]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...H()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...H(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...H(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ht,e]}],"min-w":[{"min-w":[ht,e,"min","max","fit"]}],"max-w":[{"max-w":[ht,e,"none","full","min","max","fit","prose",{screen:[ja]},ja]}],h:[{h:[ht,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ht,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ht,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ht,e,"auto","min","max","fit"]}],"font-size":[{text:["base",ja,Ca]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",lw]}],"font-family":[{font:[Gf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ht]}],"line-clamp":[{"line-clamp":["none",Wd,lw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ao,ht]}],"list-image":[{"list-image":["none",ht]}],"list-style-type":[{list:["none","disc","decimal",ht]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[k]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[k]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ve(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ao,Ca]}],"underline-offset":[{"underline-offset":["auto",Ao,ht]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ht]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ht]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[k]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ue(),ble]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",vle]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},wle]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[k]}],"border-style":[{border:[...ve(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[k]}],"divide-style":[{divide:ve()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...ve()]}],"outline-offset":[{"outline-offset":[Ao,ht]}],"outline-w":[{outline:[Ao,Ca]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:F()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[k]}],"ring-offset-w":[{"ring-offset":[Ao,Ca]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",ja,kle]}],"shadow-color":[{shadow:[Gf]}],opacity:[{opacity:[k]}],"mix-blend":[{"mix-blend":[...ae(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ae()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",ja,ht]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[m]}],saturate:[{saturate:[S]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[k]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ht]}],duration:[{duration:re()}],ease:[{ease:["linear","in","out","in-out",ht]}],delay:[{delay:re()}],animate:[{animate:["none","spin","ping","pulse","bounce",ht]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[Hf,ht]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[R]}],"skew-y":[{"skew-y":[R]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ht]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ht]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ht]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ao,Ca,lw]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Cg=cle(Ele),Cle=t=>{if(!t)return"";const e=t.trim().split(" ");return e.length>=2?(e[0][0]+e[1][0]).toUpperCase():t.substring(0,2).toUpperCase()};function ai({src:t,name:e,size:n="md",className:r,onClick:s,status:i,isGroup:a=!1,square:l=!1}){const d=Cg(au("relative overflow-hidden flex items-center justify-center shrink-0 bg-gray-200 dark:bg-gray-700 border border-transparent transition-all select-none",l?"rounded-xl":"rounded-full",{xs:"h-6 w-6 text-[10px]",sm:"h-8 w-8 text-xs",md:"h-10 w-10 text-sm",lg:"h-12 w-12 text-base",xl:"h-14 w-14 text-lg","2xl":"h-24 w-24 text-2xl","3xl":"h-32 w-32 text-4xl"}[n],s&&"cursor-pointer hover:opacity-90",r));return o.jsxs("div",{className:d,onClick:s,children:[t?o.jsx("img",{src:t,alt:e||"Avatar",className:"h-full w-full object-cover",onError:f=>f.target.style.display="none"}):o.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gradient-to-br from-brand-blue to-purple-600 text-white font-bold",children:a?o.jsx(Gr,{className:"w-1/2 h-1/2"}):e?Cle(e):o.jsx(wr,{className:"w-1/2 h-1/2"})}),i&&o.jsx("span",{className:au("absolute bottom-0 right-0 rounded-full border-2 border-white dark:border-gray-900",i==="online"?"bg-green-500":"bg-gray-400",n==="xs"||n==="sm"?"h-2 w-2":"h-3.5 w-3.5")})]})}const jle=({type:t})=>{const e={size:14},n={follow:o.jsx(Fl,{...e}),like:o.jsx(vne,{...e}),comment:o.jsx(ou,{...e}),mention:o.jsx(une,{...e}),reply:o.jsx(mne,{...e}),save:o.jsx(vV,{...e})},r={follow:"bg-brand-blue/10 text-brand-blue dark:bg-brand-blue/20",like:"bg-red-100 text-red-500 dark:bg-red-900/30 dark:text-red-400",comment:"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400",mention:"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400",reply:"bg-orange-100 text-orange-600 dark:bg-orange-900/30 dark:text-orange-400",save:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400"};return o.jsx("div",{className:`p-1.5 rounded-full ${r[t]||"bg-gray-100 text-gray-500"}`,children:n[t]||o.jsx(iu,{size:14})})},Ile=t=>{if(!t)return"";const e=t.toMillis?new Date(t.toMillis()):new Date(t),r=new Date-e,s=Math.floor(r/6e4),i=Math.floor(s/60),a=Math.floor(i/24);return s<1?"Just now":s<60?`${s}m`:i<24?`${i}h`:a<7?`${a}d`:e.toLocaleDateString()},Ale=({notification:t,onMarkAsRead:e,onDelete:n,onUserClick:r,onPostClick:s})=>{const i=()=>{t.read||e(t.id),t.type==="follow"&&r?r(t.fromUserId):t.postId&&s&&s(t.postId)};return o.jsxs(tt.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:`
                p-3 cursor-pointer border-b dark:border-gray-700 last:border-0 
                flex gap-3 items-start group transition-colors
                ${t.read?"hover:bg-gray-50 dark:hover:bg-gray-800":"bg-blue-50/50 dark:bg-blue-900/10 hover:bg-blue-50 dark:hover:bg-blue-900/20"}
            `,onClick:i,children:[o.jsxs("div",{className:"relative shrink-0",children:[o.jsx(ai,{src:t.fromUserPhoto,name:t.fromUserName,size:"sm"}),o.jsx("div",{className:"absolute -bottom-1 -right-1",children:o.jsx(jle,{type:t.type})})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex justify-between items-start gap-2",children:[o.jsxs("p",{className:"text-sm dark:text-gray-200 leading-snug",children:[o.jsx("span",{className:"font-bold hover:text-brand-blue transition-colors",children:t.fromUserName})," ",o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t.message})]}),o.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap shrink-0",children:Ile(t.timestamp)})]}),t.postPreview&&o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1 line-clamp-1 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:['"',t.postPreview,'"']}),!t.read&&o.jsx("div",{className:"w-2 h-2 bg-brand-blue rounded-full absolute right-3 top-1/2 -translate-y-1/2"})]}),o.jsx("button",{onClick:a=>{a.stopPropagation(),n(t.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-all text-gray-400 hover:text-red-500 shrink-0",children:o.jsx(ut,{size:14})})]})};function Rle({notifications:t,unreadCount:e,loading:n,onMarkAsRead:r,onMarkAllAsRead:s,onDeleteNotification:i,onClearAll:a,onUserClick:l,onPostClick:u,onClose:d}){return o.jsxs("div",{className:"absolute right-0 top-full mt-3 w-80 sm:w-96 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-2xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[o.jsxs("div",{className:"p-3 px-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"font-bold dark:text-white text-sm",children:"Notifications"}),e>0&&o.jsx("span",{className:"text-xs bg-brand-blue text-white px-2 py-0.5 rounded-full font-bold animate-pulse",children:e})]}),e>0&&o.jsxs("button",{onClick:s,className:"text-xs text-brand-blue hover:text-blue-700 font-medium flex items-center gap-1 transition",children:[o.jsx(v1,{size:14}),"Mark all read"]})]}),o.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:n?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-brand-blue border-t-transparent rounded-full animate-spin mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Loading..."})]}):t.length===0?o.jsxs("div",{className:"p-8 text-center text-gray-500 flex flex-col items-center",children:[o.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-3",children:o.jsx(iu,{size:24,className:"opacity-30"})}),o.jsx("p",{className:"text-sm font-medium dark:text-gray-400",children:"All caught up!"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"No new notifications"})]}):o.jsx(Zn,{mode:"popLayout",children:t.map(f=>o.jsx(Ale,{notification:f,onMarkAsRead:r,onDelete:i,onUserClick:l,onPostClick:u},f.id))})}),t.length>0&&o.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-[#23262f] border-t dark:border-gray-700 flex justify-between items-center",children:[o.jsxs("button",{onClick:a,className:"text-xs text-gray-400 hover:text-red-500 font-medium flex items-center gap-1 transition px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:[o.jsx(Mr,{size:12}),"Clear all"]}),o.jsx("button",{onClick:d,className:"text-xs text-gray-500 hover:text-gray-800 dark:hover:text-gray-200 px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:"Close"})]})]})}function Ple({count:t}){return t===0?null:o.jsx(tt.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-0.5 -right-0.5 min-w-[18px] h-[18px] bg-red-500 rounded-full text-[10px] text-white font-bold flex items-center justify-center border-2 border-white dark:border-dark-card",children:t>99?"99+":t})}function Lle(t,e=50){const[n,r]=N.useState([]),[s,i]=N.useState(0),[a,l]=N.useState(!0);N.useEffect(()=>{if(!t){l(!1);return}const p=Ce(Y,Le(t).notifications),v=mt(p,_n("timestamp","desc"),fs(e)),x=Qt(v,_=>{const E=_.docs.map(k=>({id:k.id,...k.data()}));r(E),i(E.filter(k=>!k.read).length),l(!1)},_=>{console.error("Notifications listener error:",_),l(!1)});return()=>x()},[t,e]);const u=N.useCallback(async p=>{if(t)try{const v=ke(Y,Le(t).notifications,p);await ft(v,{read:!0})}catch(v){console.error("Mark as read error:",v)}},[t]),d=N.useCallback(async()=>{if(!(!t||s===0))try{const p=T0(Y);n.filter(x=>!x.read).forEach(x=>{const _=ke(Y,Le(t).notifications,x.id);p.update(_,{read:!0})}),await p.commit()}catch(p){console.error("Mark all as read error:",p)}},[t,n,s]),f=N.useCallback(async p=>{if(t)try{const v=ke(Y,Le(t).notifications,p);await ft(v,{deleted:!0})}catch(v){console.error("Delete notification error:",v)}},[t]),m=N.useCallback(async()=>{if(t)try{const p=T0(Y);n.forEach(v=>{const x=ke(Y,Le(t).notifications,v.id);p.update(x,{deleted:!0})}),await p.commit()}catch(p){console.error("Clear all error:",p)}},[t,n]);return{notifications:n.filter(p=>!p.deleted),unreadCount:s,loading:a,markAsRead:u,markAllAsRead:d,deleteNotification:f,clearAll:m}}async function C6({targetUserId:t,type:e,fromUserId:n,fromUserName:r,fromUserPhoto:s,postId:i=null,postPreview:a=null,commentId:l=null,message:u}){if(!(!t||t===n))try{await Gt(Ce(Y,Le(t).notifications),{type:e,fromUserId:n,fromUserName:r,fromUserPhoto:s||null,postId:i,postPreview:a,commentId:l,message:u,read:!1,timestamp:jt()})}catch(d){console.error("Create notification error:",d)}}function Mle({user:t,userData:e,subProfiles:n,darkMode:r,toggleTheme:s,activeTab:i,setActiveTab:a,onMenuClick:l,onRoleSwitch:u,openPublicProfile:d}){var W;const[f,m]=N.useState(!1),[p,v]=N.useState(!1),[x,_]=N.useState(!1),E=N.useRef(null),k=N.useRef(null),{notifications:b,unreadCount:S,loading:C,markAsRead:P,markAllAsRead:R,deleteNotification:I,clearAll:j}=Lle(t==null?void 0:t.uid),O=(e==null?void 0:e.activeProfileRole)||((W=e==null?void 0:e.accountTypes)==null?void 0:W[0])||"User",V=(e==null?void 0:e.accountTypes)||[],z=["Student","Instructor","Intern","Admin"],D=V.some(re=>z.includes(re)),F=i.startsWith("edu"),ee=re=>{if(!re||re==="Main"||re==="Fan"||re==="User")return(e==null?void 0:e.effectiveDisplayName)||(e==null?void 0:e.firstName)||"User";const he=n==null?void 0:n[re];return(he==null?void 0:he.displayName)||(e==null?void 0:e.effectiveDisplayName)||(e==null?void 0:e.firstName)||"User"},ue=ee(O),ve=()=>{a(O==="Student"?"edu-student":O==="Intern"?"edu-intern":"edu-overview")};N.useEffect(()=>{{_(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{_(!0)})});const re=setTimeout(()=>_(!1),600);return()=>clearTimeout(re)}},[O]),N.useEffect(()=>{function re(he){E.current&&!E.current.contains(he.target)&&m(!1),k.current&&!k.current.contains(he.target)&&v(!1)}return document.addEventListener("mousedown",re),()=>document.removeEventListener("mousedown",re)},[E,k]);const ae=re=>{m(!1),d&&d(re)},H=re=>{m(!1),a("feed")},Q=re=>{u&&u(re),v(!1)};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`fixed top-0 bottom-0 w-full pointer-events-none z-[9999] 
          bg-gradient-to-r from-transparent via-white/30 dark:via-white/10 to-transparent
          ${x?"left-[-100%] transition-all duration-500 ease-out":"left-[100%] transition-none duration-0"}
        `}),o.jsxs("nav",{className:"h-16 bg-white dark:bg-dark-card border-b border-gray-200 dark:border-gray-700 flex items-center justify-between px-4 shrink-0 z-20 sticky top-0",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:l,className:"p-2 -ml-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 lg:hidden",children:o.jsx(Tne,{size:24})}),o.jsx("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>a("dashboard"),children:o.jsx("img",{src:r?b6:_6,alt:"SeshNx Logo",className:"h-8 w-auto object-contain transition-opacity duration-300"})})]}),o.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[D&&o.jsxs("div",{className:"hidden md:flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1 border dark:border-gray-700",children:[o.jsxs("button",{onClick:()=>a("dashboard"),className:`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${F?"text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200":"bg-white dark:bg-gray-600 shadow-sm text-brand-blue dark:text-white"}`,children:[o.jsx(jV,{size:14})," Studio"]}),o.jsxs("button",{onClick:ve,className:`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${F?"bg-white dark:bg-gray-600 shadow-sm text-indigo-600 dark:text-white":"text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[o.jsx(kh,{size:14})," Education"]})]}),V.length>1&&o.jsxs("div",{className:"relative hidden sm:flex items-center gap-3",ref:k,children:[o.jsxs("button",{onClick:()=>v(!p),className:"group flex items-center gap-2 px-3 py-1.5 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 text-xs font-bold transition border border-gray-200 dark:border-gray-700",children:[o.jsx(Lp,{size:12,className:`text-brand-blue shrink-0 transition-transform ${x?"rotate-180 duration-500":""}`}),o.jsx("span",{children:O}),o.jsx(Td,{size:12,className:`shrink-0 transition-transform ${p?"rotate-180":""}`})]}),o.jsxs("div",{className:"flex flex-col leading-tight",children:[o.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:"Posting as"}),o.jsx("span",{className:"text-xs font-bold dark:text-white truncate max-w-[150px]",children:ue})]}),p&&o.jsxs("div",{className:"absolute left-0 top-full mt-2 w-56 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-1 duration-200",children:[o.jsx("div",{className:"p-2 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:o.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider pl-2",children:"Switch Profile Context"})}),o.jsx("div",{className:"p-1",children:V.map(re=>{const he=ee(re);return o.jsxs("button",{onClick:()=>Q(re),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition flex items-center justify-between ${O===re?"bg-blue-50 dark:bg-blue-900/20 text-brand-blue":"hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{children:he}),o.jsx("span",{className:"text-[10px] opacity-70 font-normal uppercase",children:re})]}),O===re&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-brand-blue"})]},re)})})]})]}),o.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300",children:r?o.jsx(OV,{size:20}):o.jsx(uE,{size:20})}),o.jsxs("div",{className:"relative",ref:E,children:[o.jsxs("button",{className:`relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 transition ${f?"bg-gray-100 dark:bg-gray-800 text-brand-blue":""}`,onClick:()=>m(!f),children:[o.jsx(iu,{size:20}),o.jsx(Ple,{count:S})]}),f&&o.jsx(Rle,{notifications:b,unreadCount:S,loading:C,onMarkAsRead:P,onMarkAllAsRead:R,onDeleteNotification:I,onClearAll:j,onUserClick:ae,onPostClick:H,onClose:()=>m(!1)})]}),o.jsx(ai,{src:e==null?void 0:e.photoURL,name:ue,size:"sm",className:"border-2 border-transparent hover:border-brand-blue transition",onClick:()=>a("profile")})]})]})]})}const j6=N.createContext();function jg(){return N.useContext(j6)}function Ole({children:t,user:e,userData:n}){var b;const[r,s]=N.useState(null),[i,a]=N.useState(null),[l,u]=N.useState(null),[d,f]=N.useState([]),[m,p]=N.useState(null),[v,x]=N.useState(!0);N.useEffect(()=>{if(!e||!(n!=null&&n.schoolId)){x(!1);return}ki(ke(Y,"schools",n.schoolId)).then(C=>{C.exists()&&s(C.data())}).catch(C=>console.error("Error fetching school data:",C)),(async()=>{var C,P,R,I;try{if((C=n.accountTypes)!=null&&C.includes("Student")||(P=n.accountTypes)!=null&&P.includes("Intern")){const j=Le(e.uid).studentRecord(n.schoolId,e.uid);Qt(ke(Y,j),async O=>{if(O.exists()){const V=O.data();if(a(V),V.internshipStudioId){const z=await ki(ke(Y,`schools/${n.schoolId}/partners/${V.internshipStudioId}`));if(z.exists())p(z.data());else{const D=await ki(ke(Y,"studios",V.internshipStudioId));D.exists()&&p(D.data())}}}})}if((R=n.accountTypes)!=null&&R.includes("Instructor")||(I=n.accountTypes)!=null&&I.includes("Admin")){const j=mt(Ce(Y,`schools/${n.schoolId}/staff`),zt("uid","==",e.uid)),O=await Pt(j);if(!O.empty){const V=O.docs[0].data();if(u(V),V.roleId){const z=await ki(ke(Y,`schools/${n.schoolId}/roles/${V.roleId}`));z.exists()&&f(z.data().permissions||[])}else n.accountTypes.includes("Admin")&&f(["ALL"])}}}catch(j){console.error("Error setting up school context:",j)}finally{x(!1)}})()},[e,n]);const _=async(S,C="remote")=>{if(!(!i||!n.schoolId))try{const P=Ce(Y,`schools/${n.schoolId}/internship_logs`),R=await Gt(P,{studentId:e.uid,studentName:n.displayName||"Unknown",checkIn:jt(),checkOut:null,location:S||"Unknown",type:C,status:"active",description:""}),I=Le(e.uid).studentRecord(n.schoolId,e.uid);await ft(ke(Y,I),{activeSessionId:R.id,isClockedIn:!0})}catch(P){throw console.error("Check-in failed:",P),P}},E=async S=>{if(!(!(i!=null&&i.activeSessionId)||!n.schoolId))try{const C=`schools/${n.schoolId}/internship_logs/${i.activeSessionId}`;await ft(ke(Y,C),{checkOut:jt(),status:"pending_approval",description:S||"No description"});const P=Le(e.uid).studentRecord(n.schoolId,e.uid);await ft(ke(Y,P),{activeSessionId:null,isClockedIn:!1})}catch(C){throw console.error("Check-out failed:",C),C}},k={schoolId:n==null?void 0:n.schoolId,schoolData:r,studentProfile:i,staffProfile:l,myPermissions:d,internshipStudio:m,isStudent:!!i,isStaff:!!l||((b=n==null?void 0:n.accountTypes)==null?void 0:b.includes("Admin")),checkIn:_,checkOut:E,loading:v};return o.jsx(j6.Provider,{value:k,children:t})}function Dle({userData:t,activeTab:e,setActiveTab:n,sidebarOpen:r,setSidebarOpen:s,handleLogout:i}){var x,_,E,k;const{isStudent:a,isStaff:l}=jg(),u=[{id:"dashboard",icon:o.jsx(wr,{size:18}),label:"Dashboard"},{id:"feed",icon:o.jsx(CV,{size:18}),label:"SocialNx"},{id:"marketplace",icon:o.jsx(PV,{size:18}),label:"Marketplace"},{id:"tech",icon:o.jsx(Hh,{size:18}),label:"Tech Services"},{id:"bookings",icon:o.jsx(to,{size:18}),label:"Bookings"},{id:"messages",icon:o.jsx(ou,{size:18}),label:"Messages"},{id:"payments",icon:o.jsx(pne,{size:18}),label:"Billing"},{id:"profile",icon:o.jsx(wu,{size:18}),label:"Profile"}];if((x=t==null?void 0:t.accountTypes)!=null&&x.includes("Studio")){const b=u.findIndex(S=>S.id==="profile");b!==-1&&u.splice(b,0,{id:"studio-ops",icon:o.jsx(wg,{size:18}),label:"Studio Ops",highlight:!0})}const d=(_=t==null?void 0:t.accountTypes)==null?void 0:_.includes("Intern");if(a||d||l||(E=t==null?void 0:t.accountTypes)!=null&&E.includes("student")){const b=u.findIndex(P=>P.id==="payments");let S="EDU Panel";d?S="Internship":l&&(S="School Admin");let C="edu-overview";d?C="edu-intern":a&&(C="edu-student"),u.splice(b,0,{id:C,icon:o.jsx(kh,{size:18}),label:S,highlight:!0})}const f=i||(()=>dS(Sd)),m=b=>{n(b);const S=window.innerWidth<1024;s&&(S||r)&&s(!1)},p=({isMobile:b})=>o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex-1 py-4 overflow-y-auto scrollbar-hide",children:[b&&o.jsxs("div",{className:"px-4 mb-6 flex items-center justify-between",children:[o.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase",children:"Menu"}),o.jsx("button",{onClick:()=>s(!1),className:"p-2 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors",children:o.jsx(ut,{size:20})})]}),o.jsx("nav",{className:"space-y-1 px-2",children:u.map(S=>o.jsxs("button",{onClick:()=>m(S.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition
                ${e===S.id?"bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}
                ${S.highlight?"text-amber-600 dark:text-amber-500":""}
                `,children:[S.icon,S.label]},S.id))}),o.jsx("div",{className:"mt-auto px-2 pt-4",children:o.jsxs("button",{onClick:()=>m("legal"),className:`flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium w-full transition ${e==="legal"?"bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[o.jsx(U0,{size:18}),"Legal Center"]})})]}),o.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 shrink-0 bg-white dark:bg-[#1f2128]",children:o.jsxs("button",{onClick:f,className:"flex items-center gap-2 text-red-500 text-sm font-medium hover:opacity-80 px-2 w-full py-2 rounded hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",children:[o.jsx(TV,{size:16})," Sign Out"]})})]});if((k=t==null?void 0:t.accountTypes)==null?void 0:k.some(b=>["Label","Agent"].includes(b))){const b=u.findIndex(S=>S.id==="bookings");b!==-1&&u.splice(b,0,{id:"roster",icon:o.jsx(U0,{size:18}),label:"Label Roster",highlight:!0})}return o.jsxs(o.Fragment,{children:[o.jsx("aside",{className:"hidden lg:flex w-64 bg-white dark:bg-[#1f2128] border-r border-gray-200 dark:border-gray-700 flex-col h-full shrink-0 relative z-30",children:o.jsx(p,{isMobile:!1})}),o.jsx("div",{className:`fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] transition-opacity duration-300 lg:hidden ${r?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>s(!1)}),o.jsx("aside",{className:`fixed inset-y-0 left-0 z-[10000] w-72 bg-white dark:bg-[#1f2128] shadow-2xl transform transition-transform duration-300 cubic-bezier(0.4, 0, 0.2, 1) flex flex-col h-full lg:hidden ${r?"translate-x-0":"-translate-x-full"}`,children:o.jsx(p,{isMobile:!0})})]})}function Vle({activeTab:t,setActiveTab:e,sidebarOpen:n,setSidebarOpen:r,isGlobalAdmin:s}){const i=[{id:"edu-overview",icon:Nne,label:"Overview"},{id:"edu-roster",icon:Gr,label:"Student Roster"},{id:"edu-hours",icon:Zr,label:"Internship Hours"},{id:"edu-instructors",icon:Fl,label:"Staff Management"},{id:"edu-roles",icon:Rp,label:"Role Permissions"},{id:"edu-resources",icon:Vl,label:"Resource Rules"},{id:"edu-news",icon:EV,label:"Announcements"},{id:"edu-partners",icon:ao,label:"Partnerships"},{id:"edu-evaluations",icon:kh,label:"Grading & Evals"},{id:"edu-cohorts",icon:Gr,label:"Cohorts"},{id:"edu-audit",icon:iE,label:"Audit Logs"},{id:"edu-settings",icon:wu,label:"School Settings"}],a=u=>{e(u),r&&r(!1)},l=()=>o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700",children:[o.jsxs("button",{onClick:()=>e("dashboard"),className:"flex items-center gap-2 text-xs font-bold text-gray-500 hover:text-brand-blue transition mb-4",children:[o.jsx(fb,{size:14})," Back to Studio"]}),o.jsx("h2",{className:"text-lg font-extrabold dark:text-white tracking-tight px-1",children:"EDU Control"})]}),o.jsx("div",{className:"flex-1 py-4 overflow-y-auto custom-scrollbar px-3 space-y-1",children:i.map(u=>o.jsxs("button",{onClick:()=>a(u.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors
                        ${t===u.id?"bg-indigo-50 text-indigo-600 dark:bg-indigo-900/20 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}
                        `,children:[o.jsx(u.icon,{size:18}),u.label]},u.id))}),o.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 shrink-0 bg-gray-50 dark:bg-[#23262f]",children:o.jsxs("div",{className:"flex items-center gap-3 px-2",children:[o.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-700 dark:text-indigo-300 font-bold text-xs",children:"EA"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs font-bold dark:text-white truncate",children:"EDU Admin"}),o.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:"School Management"})]}),o.jsx("button",{onClick:()=>dS(Sd),className:"text-gray-400 hover:text-red-500",children:o.jsx(TV,{size:16})})]})})]});return o.jsxs(o.Fragment,{children:[o.jsx("aside",{className:"hidden lg:flex w-64 bg-white dark:bg-[#1f2128] border-r border-gray-200 dark:border-gray-700 flex-col h-full shrink-0 relative z-30",children:o.jsx(l,{})}),o.jsx("div",{className:`fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] transition-opacity duration-300 lg:hidden ${n?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>r(!1)}),o.jsx("aside",{className:`fixed inset-y-0 left-0 z-[10000] w-72 bg-white dark:bg-[#1f2128] shadow-2xl transform transition-transform duration-300 cubic-bezier(0.4, 0, 0.2, 1) flex flex-col h-full lg:hidden ${n?"translate-x-0":"-translate-x-full"}`,children:o.jsx(l,{})})]})}function I6(){return new Proxy({},{get(t,e){if(e===Symbol.toStringTag)return"ConvexApi";if(!(e==="then"||e==="catch"||e==="finally"))return I6()},has(t,e){return!0}})}const Fle=I6(),zr=Fle,A6="http://127.0.0.1:3210",zle=A6,Ble=new W9(zle),Ig=()=>A6!=="";function Qo({title:t,value:e,icon:n,sub:r,bg:s="bg-white dark:bg-[#2c2e36]",text:i="text-gray-900 dark:text-white"}){return o.jsxs("div",{className:`${s} p-5 rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm flex flex-col justify-between h-28`,children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("div",{className:`text-sm font-medium ${i==="text-white"?"text-blue-100":"text-gray-500"}`,children:t}),o.jsx("div",{className:`text-2xl font-extrabold ${i}`,children:e})]}),o.jsx("div",{className:"opacity-80",children:n})]}),r&&o.jsx("div",{className:"text-xs mt-auto opacity-75",children:r})]})}const X0=["Artist","Musician","Engineer","Producer","Composer","Studio","Technician","Fan","Student","Instructor","Label","Agent"],$le={FREE:"FREE"},Ule=["Xfer Serum","NI Massive","Sylenth1","FabFilter Pro-Q 3","Valhalla VintageVerb","RC-20 Retro Color","Omnisphere","Kontakt","Auto-Tune","Soundtoys Decapitator","Waves CLA-2A","SerumFX","Vital","Diva"],qle=[{id:"single",label:"Single",maxTracks:1},{id:"ep",label:"EP",maxTracks:6},{id:"album",label:"Album",maxTracks:100}],hm=[{id:"spotify",name:"Spotify",icon:"spotify"},{id:"apple",name:"Apple Music",icon:"apple"},{id:"tiktok",name:"TikTok / Resso",icon:"music"},{id:"instagram",name:"Instagram & Facebook",icon:"instagram"},{id:"youtube",name:"YouTube Music",icon:"youtube"},{id:"amazon",name:"Amazon Music",icon:"shopping-cart"},{id:"tidal",name:"Tidal",icon:"music"},{id:"deezer",name:"Deezer",icon:"music"},{id:"soundcloud",name:"SoundCloud",icon:"cloud"}],Wle=["Alternative","Blues","Children's Music","Christian & Gospel","Classical","Comedy","Country","Dance","Electronic","Fitness & Workout","Folk","Hip Hop/Rap","Holiday","Indie Pop","Instrumental","Jazz","K-Pop","Latin","Metal","New Age","Pop","R&B/Soul","Reggae","Rock","Singer/Songwriter","Soundtrack","Spoken Word","World"],B1=[{id:"manage_roster",label:"Manage Roster",description:"Add, remove, or edit student details."},{id:"manage_enrollment",label:"Admissions",description:"Process applications and handle intake."},{id:"approve_hours",label:"Approve Hours",description:"Verify and approve internship time logs."},{id:"manage_partners",label:"Manage Partners",description:"Add or edit approved internship studios."},{id:"grade_students",label:"Grading",description:"Submit technical and soft-skill evaluations."},{id:"post_announcements",label:"Announcements",description:"Post news to the student dashboard."},{id:"manage_resources",label:"Resource Rules",description:"Set quotas and booking restrictions."},{id:"manage_staff",label:"Manage Staff",description:"Add new instructors and assign roles."},{id:"view_audit",label:"View Audit Logs",description:"See history of administrative actions."},{id:"edit_settings",label:"School Settings",description:"Change school name, address, and branding."}],$1={Vocals:["Soprano","Tenor","Baritone","Bass","Falsetto","Rapping","Beatboxing","Growling"],Guitars:["Electric Guitar","Acoustic Guitar","Bass Guitar","Classical/Nylon","12-String Acoustic","Upright Bass"],Percussion:["Drum Kit","Electronic Drums","Congas","Bongos","Djembe","Cajon","Timbales","Tabla","Marimba","Vibraphone"],Keys:["Grand Piano","Upright Piano","Electric Piano","Clavinet","Hammond Organ","Pipe Organ","Synthesizer","MIDI Controller","Accordion"],Strings:["Violin","Viola","Cello","Double Bass","Harp","Banjo","Mandolin","Ukulele","Sitar","Oud"],Wind:["Flute","Clarinet","Oboe","Bassoon","Saxophone","Trumpet","Trombone","French Horn","Tuba","Harmonica","Didgeridoo","Bagpipes"]},ld=["Rock","Alternative","Indie","Metal","Punk","Pop","Electronic","House","Techno","Dubstep","Hip Hop","Rap","Trap","R&B","Soul","Funk","Jazz","Blues","Country","Folk","Americana","Bluegrass","Classical","Reggae","Latin","World","Experimental"],R6=["Wi-Fi","Kitchen","Lounge","Private Parking","Shower","Sleep/Lodging","Accessibility Ramps","Video Feed","Loading Dock","Isolation Booth","Live Room","Grand Piano","Tape Machine"],ec=[{key:"useRealName",label:"Use Primary Name?",type:"checkbox",isToggle:!0},{key:"profileName",label:"Profile/Stage Name",type:"text"}],J0={Artist:[{key:"profileName",label:"Artist / Band Name",type:"text"},{key:"bio",label:"Artist Bio",type:"textarea"},{key:"genres",label:"Primary Genres",type:"multi_select",data:ld},{key:"rates",label:"Booking/Feature Rate ($)",type:"number"},{key:"website",label:"Official Website",type:"text"},{key:"label",label:"Record Label (Optional)",type:"text"},{key:"touring",label:"Currently Touring?",type:"select",options:["Yes","No"]}],Label:[{key:"profileName",label:"Label Name",type:"text"},{key:"bio",label:"Label Description / Mission",type:"textarea"},{key:"genres",label:"Focus Genres",type:"multi_select",data:ld},{key:"website",label:"Website",type:"text"},{key:"acceptingDemos",label:"Accepting Demos?",type:"select",options:["Yes","No"]}],Agent:[...ec,{key:"agencyName",label:"Agency Name",type:"text"},{key:"rosterSize",label:"Roster Size",type:"number"},{key:"territory",label:"Territory Focus",type:"text"}],Musician:[...ec,{key:"bio",label:"Biography",type:"textarea"},{key:"instruments",label:"Instruments & Skills",type:"nested_select",data:$1},{key:"genres",label:"Genres",type:"multi_select",data:ld},{key:"rates",label:"Session Rate ($/hr)",type:"number"},{key:"dayRate",label:"Day Rate ($)",type:"number"},{key:"travelDist",label:"Max Travel (mi)",type:"number"},{key:"gearHighlights",label:"Key Gear (Guitars, Amps, etc.)",type:"textarea"},{key:"readingSkill",label:"Sight Reading",type:"select",options:["None","Charts/Lead Sheets","Standard Notation","Expert"]},{key:"remoteWork",label:"Remote Recording Capable?",type:"select",options:["Yes","No"]}],Fan:[{key:"bio",label:"About Me",type:"textarea"},{key:"genres",label:"Favorite Genres",type:"multi_select",data:ld},{key:"lookingFor",label:"Interested In",type:"multi_select",data:["Discovering Music","Booking Talent","Learning"]}],Studio:[...ec,{key:"profileName",label:"Studio Name",type:"text"},{key:"bio",label:"Description",type:"textarea"},{key:"address",label:"Address",type:"text"},{key:"hours",label:"Hours of Operation",type:"text"},{key:"dimensions",label:"Live Room Dimensions",type:"text"},{key:"parking",label:"Parking Situation",type:"text"},{key:"amenities",label:"Amenities",type:"multi_select",data:R6}],Engineer:[...ec,{key:"bio",label:"Bio",type:"textarea"},{key:"skills",label:"Specialties",type:"multi_select",data:["Tracking","Mixing","Mastering","Live Sound","Broadcast","Dolby Atmos","Editing/Tuning"]},{key:"daw",label:"DAWs",type:"multi_select",data:["Pro Tools","Logic Pro","Ableton","FL Studio","Cubase","Reaper","Studio One","Luna"]},{key:"outboard",label:"Favorite Outboard Gear",type:"textarea"},{key:"credits",label:"Selected Credits",type:"textarea"}],Producer:[...ec,{key:"bio",label:"Bio",type:"textarea"},{key:"genres",label:"Genres",type:"multi_select",data:ld},{key:"daw",label:"Primary DAW",type:"select",options:["Pro Tools","Logic Pro","Ableton","FL Studio","Cubase","Studio One"]},{key:"credits",label:"Discography / Credits",type:"textarea"}],Composer:[...ec,{key:"bio",label:"Bio",type:"textarea"},{key:"compType",label:"Type",type:"multi_select",options:["Film/TV","Game Audio","Pop/Songwriting","Classical/Orchestral","Library Music","Jingles"]},{key:"instruments",label:"Primary Instruments",type:"nested_select",data:$1},{key:"libraries",label:"Key Sample Libraries",type:"textarea"},{key:"credits",label:"Credits",type:"textarea"}],Technician:[...ec,{key:"bio",label:"Bio",type:"textarea"},{key:"skills",label:"Skills",type:"textarea"}]},ev=[{id:"repair",label:"Equipment Repair"},{id:"wiring",label:"Studio Wiring/Install"},{id:"acoustics",label:"Acoustic Calibration"},{id:"computer",label:"DAW/Computer Support"},{id:"mods",label:"Custom Mods"}],P6=["Luthier (Guitar/Bass)","Drum Tech","Amp Tech (Tube)","Amp Tech (Solid State)","Studio Electrician","Acoustician","Piano Tuner/Tech","Synth/Keyboard Tech","Computer/IT Systems","Soldering/Cabling","Console Maintenance","Live Sound Tech"],zp=[{id:"computer_audio_and_interfaces",label:"Computer Audio & Interfaces"},{id:"microphones_and_input_transducers",label:"Microphones"},{id:"mixing_consoles_and_control",label:"Mixing Consoles"},{id:"monitoring_and_playback",label:"Monitoring & Playback"},{id:"outboard_signal_processing",label:"Outboard Gear"}];function sP({user:t,userData:e,setActiveTab:n,bookingCount:r=0,subProfiles:s={},notifications:i=[],tokenBalance:a=0}){var P,R;const[l,u]=N.useState([]),[d,f]=N.useState(null),m=(P=e==null?void 0:e.accountTypes)==null?void 0:P.includes("Studio"),p=((R=s==null?void 0:s.Studio)==null?void 0:R.rooms)||[],v=(e==null?void 0:e.profileViews)||0,x=(e==null?void 0:e.accountTypes)||[];let _=0,E=0;x.forEach(I=>{const j=(s==null?void 0:s[I])||{},O=J0[I]||[];if(O.length===0)return;const V=O.filter(D=>!D.isToggle&&D.type!=="list").length||1,z=O.filter(D=>!D.isToggle&&D.type!=="list"&&j[D.key]&&j[D.key].length).length;_+=z/V,E++});const k=E>0?Math.round(_/E*100):100,b=k<60,S=Zp(zr.conversations.getConversations,t!=null&&t.uid&&Ig()?{userId:t.uid}:"skip");N.useEffect(()=>{if(!S){u([]);return}const I=S.map(j=>({uid:j.otherUserId||j.chatId,name:j.chatName||"Unknown",lastMessage:j.lastMessage||"",timestamp:j.lastMessageTime||0,isMe:j.lastSenderId===t.uid})).sort((j,O)=>O.timestamp-j.timestamp).slice(0,3);u(I)},[S,t==null?void 0:t.uid]),N.useEffect(()=>{const I=mt(Ce(Y,`artifacts/${qe}/public/data/market_items`),_n("timestamp","desc"),fs(1)),j=Qt(I,O=>{O.empty||f({id:O.docs[0].id,...O.docs[0].data()})});return()=>j()},[]);const C=I=>{if(!I)return"Just now";let j;if(typeof I.toMillis=="function")j=new Date(I.toMillis());else if(typeof I=="number")j=new Date(I);else if(I instanceof Date)j=I;else return"Just now";if(isNaN(j.getTime()))return"Just now";const O=new Date;return j.getDate()===O.getDate()&&j.getMonth()===O.getMonth()&&j.getFullYear()===O.getFullYear()?j.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):j.toLocaleDateString()};return o.jsxs("div",{className:"space-y-8 max-w-6xl mx-auto pb-20 animate-in fade-in duration-500",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-end gap-4",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight",children:["Welcome, ",e==null?void 0:e.firstName]}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Your creative command center."})]}),o.jsx("div",{className:"flex items-center gap-3",children:o.jsxs("div",{className:"text-sm font-medium text-gray-500 bg-white dark:bg-[#2c2e36] px-4 py-2 rounded-full border dark:border-gray-700 shadow-sm flex items-center gap-2",children:[o.jsx(Zr,{size:14}),new Date().toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})]})})]}),b&&o.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-xl p-4 flex items-center justify-between gap-4 animate-in slide-in-from-top-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-orange-100 dark:bg-orange-900/50 p-2 rounded-full text-orange-600 dark:text-orange-400",children:o.jsx(kl,{size:20})}),o.jsxs("div",{children:[o.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-300 text-sm",children:["Profile Incomplete (",k,"%)"]}),o.jsx("p",{className:"text-xs text-orange-700 dark:text-orange-400",children:"Please complete your profile details before booking sessions."})]})]}),o.jsx("button",{onClick:()=>n("profile"),className:"bg-orange-600 hover:bg-orange-700 text-white text-xs font-bold px-4 py-2 rounded-lg transition",children:"Complete Profile"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-600 p-5 rounded-xl text-white shadow-lg cursor-pointer transform transition hover:scale-[1.02] relative overflow-hidden group",onClick:()=>n("payments"),children:[o.jsxs("div",{className:"relative z-10",children:[o.jsxs("div",{className:"text-yellow-100 text-sm font-medium mb-1 flex items-center gap-1",children:["SeshFx Balance ",o.jsx(kx,{size:12,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsxs("div",{className:"text-3xl font-extrabold flex items-center gap-2",children:[o.jsx(ps,{fill:"currentColor",size:28})," ",a]}),o.jsx("div",{className:"text-xs text-yellow-100 mt-2 opacity-80 bg-white/20 inline-block px-2 py-0.5 rounded-full",children:"+ Add Funds"})]}),o.jsx(ps,{size:120,className:"absolute -bottom-6 -right-6 text-white opacity-20 rotate-12 group-hover:rotate-0 transition-transform duration-500"})]}),o.jsx("div",{className:"cursor-pointer transform transition hover:scale-[1.02]",onClick:()=>n("bookings"),children:o.jsx(Qo,{title:"Pending Bookings",value:r,icon:o.jsx(to,{className:"text-white"}),bg:"bg-gradient-to-br from-brand-blue to-blue-600",text:"text-white",sub:r>0?"Action Required":"No pending requests"})}),o.jsx("div",{className:"cursor-pointer transform transition hover:scale-[1.02]",onClick:()=>n("messages"),children:o.jsx(Qo,{title:"Active Chats",value:l.length,icon:o.jsx(ou,{className:"text-brand-blue"}),sub:"Check Inbox"})}),o.jsx("div",{className:"cursor-pointer transform transition hover:scale-[1.02]",onClick:()=>n("profile"),children:o.jsx(Qo,{title:"Profile Views",value:v,icon:o.jsx(DV,{className:"text-brand-blue"}),sub:"Lifetime views"})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[o.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 overflow-hidden shadow-sm",children:[o.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50/50 dark:bg-[#23262f]",children:[o.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[o.jsx(iu,{size:18,className:"text-gray-500"})," Activity Feed"]}),i&&i.length>0&&o.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full animate-pulse",children:[i.length," New"]})]}),o.jsx("div",{className:"divide-y dark:divide-gray-700",children:!i||i.length===0?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3",children:o.jsx(iu,{size:20,className:"text-gray-400"})}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"You're all caught up!"})]}):i.map((I,j)=>o.jsxs("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-[#25272e] transition flex justify-between items-center group cursor-pointer",onClick:()=>n("bookings"),children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`h-2 w-2 rounded-full ${I.type==="booking"?"bg-brand-blue":"bg-yellow-500"}`}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm dark:text-gray-200 font-medium",children:I.text}),o.jsx("p",{className:"text-xs text-gray-500",children:C(I.timestamp)})]})]}),o.jsx(lo,{size:14,className:"text-gray-300"})]},I.id||j))})]}),m&&o.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-5 relative overflow-hidden shadow-sm",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[o.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[o.jsx(wg,{size:18,className:"text-brand-blue"})," Studio Status"]}),o.jsxs("button",{onClick:()=>n("studio-ops"),className:"text-sm text-brand-blue hover:underline flex items-center gap-1",children:["Manage Ops ",o.jsx(kx,{size:14})]})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 relative z-10",children:p.length===0?o.jsxs("div",{className:"col-span-full text-center py-6 text-gray-400 text-sm border-2 border-dashed dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-[#1f2128]",children:[o.jsx("div",{className:"mb-2",children:"No rooms configured."}),o.jsx("button",{className:"text-brand-blue font-bold hover:underline",onClick:()=>n("studio-ops"),children:"+ Add Room"})]}):p.map((I,j)=>{var O;return o.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] p-3 rounded-lg border dark:border-gray-700 flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-sm dark:text-gray-200",children:I.name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[((O=I.equipment)==null?void 0:O.length)||0," items  $",I.rate,"/hr"]})]}),o.jsxs("span",{className:`text-xs px-2 py-1 rounded-full font-bold flex items-center gap-1 ${I.active?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700"}`,children:[I.active?o.jsx(kr,{size:10}):o.jsx(kl,{size:10}),I.active?"Active":"Maint."]})]},j)})})]}),o.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-5 shadow-sm",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[o.jsx(ou,{size:18,className:"text-gray-400"})," Recent Messages"]}),o.jsx("button",{onClick:()=>n("messages"),className:"text-sm text-brand-blue hover:underline",children:"View All"})]}),o.jsx("div",{className:"space-y-3",children:l.length===0?o.jsx("div",{className:"text-center text-gray-400 text-sm py-4",children:"No recent messages."}):l.map((I,j)=>o.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-[#25272e] rounded-lg cursor-pointer transition",onClick:()=>n("messages"),children:[o.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-600 dark:text-gray-300",children:I.name?I.name.charAt(0):"?"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"text-sm font-bold dark:text-gray-200 flex justify-between",children:[I.name||"Unknown User",o.jsx("span",{className:"text-[10px] text-gray-400 font-normal",children:new Date(I.timestamp).toLocaleDateString()})]}),o.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[I.isMe?"You: ":"",I.lastMessage]})]})]},I.uid+j))})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-4 shadow-sm",children:[o.jsx("h3",{className:"font-bold mb-3 dark:text-white text-sm uppercase tracking-wide text-gray-500",children:"Quick Actions"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{className:"w-full text-left px-4 py-3 rounded-lg border dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-sm flex items-center gap-3 dark:text-gray-300 transition group",onClick:()=>n("feed"),children:[o.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded text-brand-blue group-hover:scale-110 transition-transform",children:o.jsx(dE,{size:16})}),o.jsx("span",{className:"font-medium",children:"Create Post"})]}),o.jsxs("button",{className:"w-full text-left px-4 py-3 rounded-lg border dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-sm flex items-center gap-3 dark:text-gray-300 transition group",onClick:()=>n("bookings"),children:[o.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-2 rounded text-purple-600 group-hover:scale-110 transition-transform",children:o.jsx(ur,{size:16})}),o.jsx("span",{className:"font-medium",children:"Find Talent"})]}),o.jsxs("button",{className:"w-full text-left px-4 py-3 rounded-lg border dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-sm flex items-center gap-3 dark:text-gray-300 transition group",onClick:()=>n("marketplace"),children:[o.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 p-2 rounded text-yellow-600 group-hover:scale-110 transition-transform",children:o.jsx(PV,{size:16})}),o.jsx("span",{className:"font-medium",children:"Browse Marketplace"})]})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-black text-white rounded-xl p-5 relative overflow-hidden shadow-lg",children:[o.jsxs("div",{className:"relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(ps,{size:16,className:"text-yellow-400",fill:"currentColor"}),o.jsx("span",{className:"text-xs font-bold text-yellow-400 uppercase",children:"Trending on SeshFx"})]}),d?o.jsxs(o.Fragment,{children:[o.jsx("h4",{className:"font-bold text-lg mb-1 truncate",children:d.title}),o.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:["by ",d.author,"  ",d.price," Tokens"]})]}):o.jsxs(o.Fragment,{children:[o.jsx("h4",{className:"font-bold text-lg mb-1",children:"Discover Sounds"}),o.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Fresh beats & presets added daily."})]}),o.jsxs("button",{onClick:()=>n("seshfx"),className:"w-full bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition",children:["Visit Store ",o.jsx(kx,{size:12})]})]}),o.jsx("div",{className:"absolute -right-4 -bottom-4 w-24 h-24 bg-yellow-500 rounded-full blur-3xl opacity-20 animate-pulse"})]}),o.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-4 shadow-sm",children:[o.jsx("h3",{className:"font-bold dark:text-white text-sm mb-3",children:"Completion"}),o.jsx("div",{className:"space-y-3",children:((e==null?void 0:e.accountTypes)||[]).map(I=>{const j=(s==null?void 0:s[I])||{},O=J0[I]||[];if(O.length===0)return null;const V=O.filter(F=>!F.isToggle&&F.type!=="list").length||1,z=O.filter(F=>!F.isToggle&&F.type!=="list"&&j[F.key]&&j[F.key].length).length,D=Math.round(z/V*100);return o.jsxs("div",{className:"space-y-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 p-2 rounded transition",onClick:()=>n("profile"),title:"Click to edit profile",children:[o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:I}),o.jsxs("span",{className:D===100?"text-green-500 font-bold":"text-gray-500",children:[D,"%"]})]}),o.jsx("div",{className:"w-full h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full transition-all duration-1000 ${D>=80?"bg-green-500":D>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${D}%`}})})]},I)})})]})]})]})]})}function L6(t,e){const n=N.useRef(e);N.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}function Hle(t,e,n){e.center!==n.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==n.radius&&t.setRadius(e.radius)}const Gle=1;function Kle(t){return Object.freeze({__version:Gle,map:t})}function M6(t,e){return Object.freeze({...t,...e})}const O6=N.createContext(null),D6=O6.Provider;function Sb(){const t=N.useContext(O6);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function V6(t){function e(n,r){const{instance:s,context:i}=t(n).current;return N.useImperativeHandle(r,()=>s),n.children==null?null:Ve.createElement(D6,{value:i},n.children)}return N.forwardRef(e)}function Qle(t){function e(n,r){const[s,i]=N.useState(!1),{instance:a}=t(n,i).current;N.useImperativeHandle(r,()=>a),N.useEffect(function(){s&&a.update()},[a,s,n.children]);const l=a._contentNode;return l?sO.createPortal(n.children,l):null}return N.forwardRef(e)}function Zle(t){function e(n,r){const{instance:s}=t(n).current;return N.useImperativeHandle(r,()=>s),null}return N.forwardRef(e)}function ZE(t,e){const n=N.useRef();N.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function Tb(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function Yle(t,e){return function(r,s){const i=Sb(),a=t(Tb(r,i),i);return L6(i.map,r.attribution),ZE(a.current,r.eventHandlers),e(a.current,i,r,s),a}}var U1={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(eB,function(n){var r="1.9.4";function s(c){var h,y,w,A;for(y=1,w=arguments.length;y<w;y++){A=arguments[y];for(h in A)c[h]=A[h]}return c}var i=Object.create||function(){function c(){}return function(h){return c.prototype=h,new c}}();function a(c,h){var y=Array.prototype.slice;if(c.bind)return c.bind.apply(c,y.call(arguments,1));var w=y.call(arguments,2);return function(){return c.apply(h,w.length?w.concat(y.call(arguments)):arguments)}}var l=0;function u(c){return"_leaflet_id"in c||(c._leaflet_id=++l),c._leaflet_id}function d(c,h,y){var w,A,B,q;return q=function(){w=!1,A&&(B.apply(y,A),A=!1)},B=function(){w?A=arguments:(c.apply(y,arguments),setTimeout(q,h),w=!0)},B}function f(c,h,y){var w=h[1],A=h[0],B=w-A;return c===w&&y?c:((c-A)%B+B)%B+A}function m(){return!1}function p(c,h){if(h===!1)return c;var y=Math.pow(10,h===void 0?6:h);return Math.round(c*y)/y}function v(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function x(c){return v(c).split(/\s+/)}function _(c,h){Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?i(c.options):{});for(var y in h)c.options[y]=h[y];return c.options}function E(c,h,y){var w=[];for(var A in c)w.push(encodeURIComponent(y?A.toUpperCase():A)+"="+encodeURIComponent(c[A]));return(!h||h.indexOf("?")===-1?"?":"&")+w.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function b(c,h){return c.replace(k,function(y,w){var A=h[w];if(A===void 0)throw new Error("No value provided for variable "+y);return typeof A=="function"&&(A=A(h)),A})}var S=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};function C(c,h){for(var y=0;y<c.length;y++)if(c[y]===h)return y;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var I=0;function j(c){var h=+new Date,y=Math.max(0,16-(h-I));return I=h+y,window.setTimeout(c,y)}var O=window.requestAnimationFrame||R("RequestAnimationFrame")||j,V=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function z(c,h,y){if(y&&O===j)c.call(h);else return O.call(window,a(c,h))}function D(c){c&&V.call(window,c)}var F={__proto__:null,extend:s,create:i,bind:a,get lastId(){return l},stamp:u,throttle:d,wrapNum:f,falseFn:m,formatNum:p,trim:v,splitWords:x,setOptions:_,getParamString:E,template:b,isArray:S,indexOf:C,emptyImageUrl:P,requestFn:O,cancelFn:V,requestAnimFrame:z,cancelAnimFrame:D};function ee(){}ee.extend=function(c){var h=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},y=h.__super__=this.prototype,w=i(y);w.constructor=h,h.prototype=w;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(h[A]=this[A]);return c.statics&&s(h,c.statics),c.includes&&(ue(c.includes),s.apply(null,[w].concat(c.includes))),s(w,c),delete w.statics,delete w.includes,w.options&&(w.options=y.options?i(y.options):{},s(w.options,c.options)),w._initHooks=[],w.callInitHooks=function(){if(!this._initHooksCalled){y.callInitHooks&&y.callInitHooks.call(this),this._initHooksCalled=!0;for(var B=0,q=w._initHooks.length;B<q;B++)w._initHooks[B].call(this)}},h},ee.include=function(c){var h=this.prototype.options;return s(this.prototype,c),c.options&&(this.prototype.options=h,this.mergeOptions(c.options)),this},ee.mergeOptions=function(c){return s(this.prototype.options,c),this},ee.addInitHook=function(c){var h=Array.prototype.slice.call(arguments,1),y=typeof c=="function"?c:function(){this[c].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(y),this};function ue(c){if(!(typeof L>"u"||!L||!L.Mixin)){c=S(c)?c:[c];for(var h=0;h<c.length;h++)c[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ve={on:function(c,h,y){if(typeof c=="object")for(var w in c)this._on(w,c[w],h);else{c=x(c);for(var A=0,B=c.length;A<B;A++)this._on(c[A],h,y)}return this},off:function(c,h,y){if(!arguments.length)delete this._events;else if(typeof c=="object")for(var w in c)this._off(w,c[w],h);else{c=x(c);for(var A=arguments.length===1,B=0,q=c.length;B<q;B++)A?this._off(c[B]):this._off(c[B],h,y)}return this},_on:function(c,h,y,w){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(c,h,y)===!1){y===this&&(y=void 0);var A={fn:h,ctx:y};w&&(A.once=!0),this._events=this._events||{},this._events[c]=this._events[c]||[],this._events[c].push(A)}},_off:function(c,h,y){var w,A,B;if(this._events&&(w=this._events[c],!!w)){if(arguments.length===1){if(this._firingCount)for(A=0,B=w.length;A<B;A++)w[A].fn=m;delete this._events[c];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var q=this._listens(c,h,y);if(q!==!1){var X=w[q];this._firingCount&&(X.fn=m,this._events[c]=w=w.slice()),w.splice(q,1)}}},fire:function(c,h,y){if(!this.listens(c,y))return this;var w=s({},h,{type:c,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var A=this._events[c];if(A){this._firingCount=this._firingCount+1||1;for(var B=0,q=A.length;B<q;B++){var X=A[B],te=X.fn;X.once&&this.off(c,te,X.ctx),te.call(X.ctx||this,w)}this._firingCount--}}return y&&this._propagateEvent(w),this},listens:function(c,h,y,w){typeof c!="string"&&console.warn('"string" type argument expected');var A=h;typeof h!="function"&&(w=!!h,A=void 0,y=void 0);var B=this._events&&this._events[c];if(B&&B.length&&this._listens(c,A,y)!==!1)return!0;if(w){for(var q in this._eventParents)if(this._eventParents[q].listens(c,h,y,w))return!0}return!1},_listens:function(c,h,y){if(!this._events)return!1;var w=this._events[c]||[];if(!h)return!!w.length;y===this&&(y=void 0);for(var A=0,B=w.length;A<B;A++)if(w[A].fn===h&&w[A].ctx===y)return A;return!1},once:function(c,h,y){if(typeof c=="object")for(var w in c)this._on(w,c[w],h,!0);else{c=x(c);for(var A=0,B=c.length;A<B;A++)this._on(c[A],h,y,!0)}return this},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[u(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[u(c)],this},_propagateEvent:function(c){for(var h in this._eventParents)this._eventParents[h].fire(c.type,s({layer:c.target,propagatedFrom:c.target},c),!0)}};ve.addEventListener=ve.on,ve.removeEventListener=ve.clearAllEventListeners=ve.off,ve.addOneTimeEventListener=ve.once,ve.fireEvent=ve.fire,ve.hasEventListeners=ve.listens;var ae=ee.extend(ve);function H(c,h,y){this.x=y?Math.round(c):c,this.y=y?Math.round(h):h}var Q=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(c){return this.clone()._add(W(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(W(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new H(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new H(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Q(this.x),this.y=Q(this.y),this},distanceTo:function(c){c=W(c);var h=c.x-this.x,y=c.y-this.y;return Math.sqrt(h*h+y*y)},equals:function(c){return c=W(c),c.x===this.x&&c.y===this.y},contains:function(c){return c=W(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function W(c,h,y){return c instanceof H?c:S(c)?new H(c[0],c[1]):c==null?c:typeof c=="object"&&"x"in c&&"y"in c?new H(c.x,c.y):new H(c,h,y)}function re(c,h){if(c)for(var y=h?[c,h]:c,w=0,A=y.length;w<A;w++)this.extend(y[w])}re.prototype={extend:function(c){var h,y;if(!c)return this;if(c instanceof H||typeof c[0]=="number"||"x"in c)h=y=W(c);else if(c=he(c),h=c.min,y=c.max,!h||!y)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=y.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(y.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(y.y,this.max.y)),this},getCenter:function(c){return W((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return W(this.min.x,this.max.y)},getTopRight:function(){return W(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var h,y;return typeof c[0]=="number"||c instanceof H?c=W(c):c=he(c),c instanceof re?(h=c.min,y=c.max):h=y=c,h.x>=this.min.x&&y.x<=this.max.x&&h.y>=this.min.y&&y.y<=this.max.y},intersects:function(c){c=he(c);var h=this.min,y=this.max,w=c.min,A=c.max,B=A.x>=h.x&&w.x<=y.x,q=A.y>=h.y&&w.y<=y.y;return B&&q},overlaps:function(c){c=he(c);var h=this.min,y=this.max,w=c.min,A=c.max,B=A.x>h.x&&w.x<y.x,q=A.y>h.y&&w.y<y.y;return B&&q},isValid:function(){return!!(this.min&&this.max)},pad:function(c){var h=this.min,y=this.max,w=Math.abs(h.x-y.x)*c,A=Math.abs(h.y-y.y)*c;return he(W(h.x-w,h.y-A),W(y.x+w,y.y+A))},equals:function(c){return c?(c=he(c),this.min.equals(c.getTopLeft())&&this.max.equals(c.getBottomRight())):!1}};function he(c,h){return!c||c instanceof re?c:new re(c,h)}function ye(c,h){if(c)for(var y=h?[c,h]:c,w=0,A=y.length;w<A;w++)this.extend(y[w])}ye.prototype={extend:function(c){var h=this._southWest,y=this._northEast,w,A;if(c instanceof Fe)w=c,A=c;else if(c instanceof ye){if(w=c._southWest,A=c._northEast,!w||!A)return this}else return c?this.extend(G(c)||Me(c)):this;return!h&&!y?(this._southWest=new Fe(w.lat,w.lng),this._northEast=new Fe(A.lat,A.lng)):(h.lat=Math.min(w.lat,h.lat),h.lng=Math.min(w.lng,h.lng),y.lat=Math.max(A.lat,y.lat),y.lng=Math.max(A.lng,y.lng)),this},pad:function(c){var h=this._southWest,y=this._northEast,w=Math.abs(h.lat-y.lat)*c,A=Math.abs(h.lng-y.lng)*c;return new ye(new Fe(h.lat-w,h.lng-A),new Fe(y.lat+w,y.lng+A))},getCenter:function(){return new Fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new Fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){typeof c[0]=="number"||c instanceof Fe||"lat"in c?c=G(c):c=Me(c);var h=this._southWest,y=this._northEast,w,A;return c instanceof ye?(w=c.getSouthWest(),A=c.getNorthEast()):w=A=c,w.lat>=h.lat&&A.lat<=y.lat&&w.lng>=h.lng&&A.lng<=y.lng},intersects:function(c){c=Me(c);var h=this._southWest,y=this._northEast,w=c.getSouthWest(),A=c.getNorthEast(),B=A.lat>=h.lat&&w.lat<=y.lat,q=A.lng>=h.lng&&w.lng<=y.lng;return B&&q},overlaps:function(c){c=Me(c);var h=this._southWest,y=this._northEast,w=c.getSouthWest(),A=c.getNorthEast(),B=A.lat>h.lat&&w.lat<y.lat,q=A.lng>h.lng&&w.lng<y.lng;return B&&q},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,h){return c?(c=Me(c),this._southWest.equals(c.getSouthWest(),h)&&this._northEast.equals(c.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Me(c,h){return c instanceof ye?c:new ye(c,h)}function Fe(c,h,y){if(isNaN(c)||isNaN(h))throw new Error("Invalid LatLng object: ("+c+", "+h+")");this.lat=+c,this.lng=+h,y!==void 0&&(this.alt=+y)}Fe.prototype={equals:function(c,h){if(!c)return!1;c=G(c);var y=Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng));return y<=(h===void 0?1e-9:h)},toString:function(c){return"LatLng("+p(this.lat,c)+", "+p(this.lng,c)+")"},distanceTo:function(c){return De.distance(this,G(c))},wrap:function(){return De.wrapLatLng(this)},toBounds:function(c){var h=180*c/40075017,y=h/Math.cos(Math.PI/180*this.lat);return Me([this.lat-h,this.lng-y],[this.lat+h,this.lng+y])},clone:function(){return new Fe(this.lat,this.lng,this.alt)}};function G(c,h,y){return c instanceof Fe?c:S(c)&&typeof c[0]!="object"?c.length===3?new Fe(c[0],c[1],c[2]):c.length===2?new Fe(c[0],c[1]):null:c==null?c:typeof c=="object"&&"lat"in c?new Fe(c.lat,"lng"in c?c.lng:c.lon,c.alt):h===void 0?null:new Fe(c,h,y)}var le={latLngToPoint:function(c,h){var y=this.projection.project(c),w=this.scale(h);return this.transformation._transform(y,w)},pointToLatLng:function(c,h){var y=this.scale(h),w=this.transformation.untransform(c,y);return this.projection.unproject(w)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var h=this.projection.bounds,y=this.scale(c),w=this.transformation.transform(h.min,y),A=this.transformation.transform(h.max,y);return new re(w,A)},infinite:!1,wrapLatLng:function(c){var h=this.wrapLng?f(c.lng,this.wrapLng,!0):c.lng,y=this.wrapLat?f(c.lat,this.wrapLat,!0):c.lat,w=c.alt;return new Fe(y,h,w)},wrapLatLngBounds:function(c){var h=c.getCenter(),y=this.wrapLatLng(h),w=h.lat-y.lat,A=h.lng-y.lng;if(w===0&&A===0)return c;var B=c.getSouthWest(),q=c.getNorthEast(),X=new Fe(B.lat-w,B.lng-A),te=new Fe(q.lat-w,q.lng-A);return new ye(X,te)}},De=s({},le,{wrapLng:[-180,180],R:6371e3,distance:function(c,h){var y=Math.PI/180,w=c.lat*y,A=h.lat*y,B=Math.sin((h.lat-c.lat)*y/2),q=Math.sin((h.lng-c.lng)*y/2),X=B*B+Math.cos(w)*Math.cos(A)*q*q,te=2*Math.atan2(Math.sqrt(X),Math.sqrt(1-X));return this.R*te}}),Qe=6378137,ie={R:Qe,MAX_LATITUDE:85.0511287798,project:function(c){var h=Math.PI/180,y=this.MAX_LATITUDE,w=Math.max(Math.min(y,c.lat),-y),A=Math.sin(w*h);return new H(this.R*c.lng*h,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(c){var h=180/Math.PI;return new Fe((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*h,c.x*h/this.R)},bounds:function(){var c=Qe*Math.PI;return new re([-c,-c],[c,c])}()};function Ae(c,h,y,w){if(S(c)){this._a=c[0],this._b=c[1],this._c=c[2],this._d=c[3];return}this._a=c,this._b=h,this._c=y,this._d=w}Ae.prototype={transform:function(c,h){return this._transform(c.clone(),h)},_transform:function(c,h){return h=h||1,c.x=h*(this._a*c.x+this._b),c.y=h*(this._c*c.y+this._d),c},untransform:function(c,h){return h=h||1,new H((c.x/h-this._b)/this._a,(c.y/h-this._d)/this._c)}};function Ge(c,h,y,w){return new Ae(c,h,y,w)}var me=s({},De,{code:"EPSG:3857",projection:ie,transformation:function(){var c=.5/(Math.PI*ie.R);return Ge(c,.5,-c,.5)}()}),dt=s({},me,{code:"EPSG:900913"});function Dt(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function dr(c,h){var y="",w,A,B,q,X,te;for(w=0,B=c.length;w<B;w++){for(X=c[w],A=0,q=X.length;A<q;A++)te=X[A],y+=(A?"L":"M")+te.x+" "+te.y;y+=h?He.svg?"z":"x":""}return y||"M0 0"}var Wn=document.documentElement.style,st="ActiveXObject"in window,pe=st&&!document.addEventListener,U="msLaunchUri"in navigator&&!("documentMode"in document),K=Fs("webkit"),ne=Fs("android"),Ee=Fs("android 2")||Fs("android 3"),Ne=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),xe=ne&&Fs("Google")&&Ne<537&&!("AudioNode"in window),je=!!window.opera,et=!U&&Fs("chrome"),Tt=Fs("gecko")&&!K&&!je&&!st,hr=!et&&Fs("safari"),Mi=Fs("phantom"),gs="OTransition"in Wn,po=navigator.platform.indexOf("Win")===0,go=st&&"transition"in Wn,Oi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ee,fa="MozPerspective"in Wn,Su=!window.L_DISABLE_3D&&(go||Oi||fa)&&!gs&&!Mi,yo=typeof orientation<"u"||Fs("mobile"),ma=yo&&K,Pg=yo&&Oi,Yh=!window.PointerEvent&&window.MSPointerEvent,pa=!!(window.PointerEvent||Yh),Tu="ontouchstart"in window||!!window.TouchEvent,Xh=!window.L_NO_TOUCH&&(Tu||pa),xo=yo&&je,Lg=yo&&Tt,Eu=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Mg=function(){var c=!1;try{var h=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",m,h),window.removeEventListener("testPassiveEventSupport",m,h)}catch{}return c}(),$l=function(){return!!document.createElement("canvas").getContext}(),Cu=!!(document.createElementNS&&Dt("svg").createSVGRect),fr=!!Cu&&function(){var c=document.createElement("div");return c.innerHTML="<svg/>",(c.firstChild&&c.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Og=!Cu&&function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var h=c.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),Ul=navigator.platform.indexOf("Mac")===0,ql=navigator.platform.indexOf("Linux")===0;function Fs(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var He={ie:st,ielt9:pe,edge:U,webkit:K,android:ne,android23:Ee,androidStock:xe,opera:je,chrome:et,gecko:Tt,safari:hr,phantom:Mi,opera12:gs,win:po,ie3d:go,webkit3d:Oi,gecko3d:fa,any3d:Su,mobile:yo,mobileWebkit:ma,mobileWebkit3d:Pg,msPointer:Yh,pointer:pa,touch:Xh,touchNative:Tu,mobileOpera:xo,mobileGecko:Lg,retina:Eu,passiveEvents:Mg,canvas:$l,svg:Cu,vml:Og,inlineSvg:fr,mac:Ul,linux:ql},vo=He.msPointer?"MSPointerDown":"pointerdown",Dg=He.msPointer?"MSPointerMove":"pointermove",Vg=He.msPointer?"MSPointerUp":"pointerup",Wl=He.msPointer?"MSPointerCancel":"pointercancel",ju={touchstart:vo,touchmove:Dg,touchend:Vg,touchcancel:Wl},Iu={touchstart:Ru,touchmove:Au,touchend:Au,touchcancel:Au},ci={},ui=!1;function Fg(c,h,y){return h==="touchstart"&&Bg(),Iu[h]?(y=Iu[h].bind(this,y),c.addEventListener(ju[h],y,!1),y):(console.warn("wrong event specified:",h),m)}function zg(c,h,y){if(!ju[h]){console.warn("wrong event specified:",h);return}c.removeEventListener(ju[h],y,!1)}function Jh(c){ci[c.pointerId]=c}function ef(c){ci[c.pointerId]&&(ci[c.pointerId]=c)}function tf(c){delete ci[c.pointerId]}function Bg(){ui||(document.addEventListener(vo,Jh,!0),document.addEventListener(Dg,ef,!0),document.addEventListener(Vg,tf,!0),document.addEventListener(Wl,tf,!0),ui=!0)}function Au(c,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var y in ci)h.touches.push(ci[y]);h.changedTouches=[h],c(h)}}function Ru(c,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&fn(h),Au(c,h)}function $g(c){var h={},y,w;for(w in c)y=c[w],h[w]=y&&y.bind?y.bind(c):y;return c=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var nf=200;function Hl(c,h){c.addEventListener("dblclick",h);var y=0,w;function A(B){if(B.detail!==1){w=B.detail;return}if(!(B.pointerType==="mouse"||B.sourceCapabilities&&!B.sourceCapabilities.firesTouchEvents)){var q=pf(B);if(!(q.some(function(te){return te instanceof HTMLLabelElement&&te.attributes.for})&&!q.some(function(te){return te instanceof HTMLInputElement||te instanceof HTMLSelectElement}))){var X=Date.now();X-y<=nf?(w++,w===2&&h($g(B))):w=1,y=X}}}return c.addEventListener("click",A),{dblclick:h,simDblclick:A}}function bo(c,h){c.removeEventListener("dblclick",h.dblclick),c.removeEventListener("click",h.simDblclick)}var Gl=wo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Kl=wo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),rf=Kl==="webkitTransition"||Kl==="OTransition"?Kl+"End":"transitionend";function sf(c){return typeof c=="string"?document.getElementById(c):c}function ga(c,h){var y=c.style[h]||c.currentStyle&&c.currentStyle[h];if((!y||y==="auto")&&document.defaultView){var w=document.defaultView.getComputedStyle(c,null);y=w?w[h]:null}return y==="auto"?null:y}function kt(c,h,y){var w=document.createElement(c);return w.className=h||"",y&&y.appendChild(w),w}function Kt(c){var h=c.parentNode;h&&h.removeChild(c)}function Ql(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function _o(c){var h=c.parentNode;h&&h.lastChild!==c&&h.appendChild(c)}function ya(c){var h=c.parentNode;h&&h.firstChild!==c&&h.insertBefore(c,h.firstChild)}function of(c,h){if(c.classList!==void 0)return c.classList.contains(h);var y=zs(c);return y.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(y)}function ct(c,h){if(c.classList!==void 0)for(var y=x(h),w=0,A=y.length;w<A;w++)c.classList.add(y[w]);else if(!of(c,h)){var B=zs(c);af(c,(B?B+" ":"")+h)}}function cn(c,h){c.classList!==void 0?c.classList.remove(h):af(c,v((" "+zs(c)+" ").replace(" "+h+" "," ")))}function af(c,h){c.className.baseVal===void 0?c.className=h:c.className.baseVal=h}function zs(c){return c.correspondingElement&&(c=c.correspondingElement),c.className.baseVal===void 0?c.className:c.className.baseVal}function Nn(c,h){"opacity"in c.style?c.style.opacity=h:"filter"in c.style&&Pu(c,h)}function Pu(c,h){var y=!1,w="DXImageTransform.Microsoft.Alpha";try{y=c.filters.item(w)}catch{if(h===1)return}h=Math.round(h*100),y?(y.Enabled=h!==100,y.Opacity=h):c.style.filter+=" progid:"+w+"(opacity="+h+")"}function wo(c){for(var h=document.documentElement.style,y=0;y<c.length;y++)if(c[y]in h)return c[y];return!1}function Di(c,h,y){var w=h||new H(0,0);c.style[Gl]=(He.ie3d?"translate("+w.x+"px,"+w.y+"px)":"translate3d("+w.x+"px,"+w.y+"px,0)")+(y?" scale("+y+")":"")}function it(c,h){c._leaflet_pos=h,He.any3d?Di(c,h):(c.style.left=h.x+"px",c.style.top=h.y+"px")}function Bs(c){return c._leaflet_pos||new H(0,0)}var di,hi,lf;if("onselectstart"in document)di=function(){Xe(window,"selectstart",fn)},hi=function(){Ut(window,"selectstart",fn)};else{var xa=wo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);di=function(){if(xa){var c=document.documentElement.style;lf=c[xa],c[xa]="none"}},hi=function(){xa&&(document.documentElement.style[xa]=lf,lf=void 0)}}function cf(){Xe(window,"dragstart",fn)}function uf(){Ut(window,"dragstart",fn)}var Lu,df;function ko(c){for(;c.tabIndex===-1;)c=c.parentNode;c.style&&(ys(),Lu=c,df=c.style.outlineStyle,c.style.outlineStyle="none",Xe(window,"keydown",ys))}function ys(){Lu&&(Lu.style.outlineStyle=df,Lu=void 0,df=void 0,Ut(window,"keydown",ys))}function hf(c){do c=c.parentNode;while((!c.offsetWidth||!c.offsetHeight)&&c!==document.body);return c}function Mu(c){var h=c.getBoundingClientRect();return{x:h.width/c.offsetWidth||1,y:h.height/c.offsetHeight||1,boundingClientRect:h}}var Ug={__proto__:null,TRANSFORM:Gl,TRANSITION:Kl,TRANSITION_END:rf,get:sf,getStyle:ga,create:kt,remove:Kt,empty:Ql,toFront:_o,toBack:ya,hasClass:of,addClass:ct,removeClass:cn,setClass:af,getClass:zs,setOpacity:Nn,testProp:wo,setTransform:Di,setPosition:it,getPosition:Bs,get disableTextSelection(){return di},get enableTextSelection(){return hi},disableImageDrag:cf,enableImageDrag:uf,preventOutline:ko,restoreOutline:ys,getSizedParentNode:hf,getScale:Mu};function Xe(c,h,y,w){if(h&&typeof h=="object")for(var A in h)ff(c,A,h[A],y);else{h=x(h);for(var B=0,q=h.length;B<q;B++)ff(c,h[B],y,w)}return this}var $s="_leaflet_events";function Ut(c,h,y,w){if(arguments.length===1)qg(c),delete c[$s];else if(h&&typeof h=="object")for(var A in h)mf(c,A,h[A],y);else if(h=x(h),arguments.length===2)qg(c,function(X){return C(h,X)!==-1});else for(var B=0,q=h.length;B<q;B++)mf(c,h[B],y,w);return this}function qg(c,h){for(var y in c[$s]){var w=y.split(/\d/)[0];(!h||h(w))&&mf(c,w,null,null,y)}}var Us={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ff(c,h,y,w){var A=h+u(y)+(w?"_"+u(w):"");if(c[$s]&&c[$s][A])return this;var B=function(X){return y.call(w||c,X||window.event)},q=B;!He.touchNative&&He.pointer&&h.indexOf("touch")===0?B=Fg(c,h,B):He.touch&&h==="dblclick"?B=Hl(c,B):"addEventListener"in c?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?c.addEventListener(Us[h]||h,B,He.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(B=function(X){X=X||window.event,gf(c,X)&&q(X)},c.addEventListener(Us[h],B,!1)):c.addEventListener(h,q,!1):c.attachEvent("on"+h,B),c[$s]=c[$s]||{},c[$s][A]=B}function mf(c,h,y,w,A){A=A||h+u(y)+(w?"_"+u(w):"");var B=c[$s]&&c[$s][A];if(!B)return this;!He.touchNative&&He.pointer&&h.indexOf("touch")===0?zg(c,h,B):He.touch&&h==="dblclick"?bo(c,B):"removeEventListener"in c?c.removeEventListener(Us[h]||h,B,!1):c.detachEvent("on"+h,B),c[$s][A]=null}function qs(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,this}function va(c){return ff(c,"wheel",qs),this}function ba(c){return Xe(c,"mousedown touchstart dblclick contextmenu",qs),c._leaflet_disable_click=!0,this}function fn(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function xs(c){return fn(c),qs(c),this}function pf(c){if(c.composedPath)return c.composedPath();for(var h=[],y=c.target;y;)h.push(y),y=y.parentNode;return h}function Ou(c,h){if(!h)return new H(c.clientX,c.clientY);var y=Mu(h),w=y.boundingClientRect;return new H((c.clientX-w.left)/y.x-h.clientLeft,(c.clientY-w.top)/y.y-h.clientTop)}var un=He.linux&&He.chrome?window.devicePixelRatio:He.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Wg(c){return He.edge?c.wheelDeltaY/2:c.deltaY&&c.deltaMode===0?-c.deltaY/un:c.deltaY&&c.deltaMode===1?-c.deltaY*20:c.deltaY&&c.deltaMode===2?-c.deltaY*60:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?-c.detail*20:c.detail?c.detail/-32765*60:0}function gf(c,h){var y=h.relatedTarget;if(!y)return!0;try{for(;y&&y!==c;)y=y.parentNode}catch{return!1}return y!==c}var Hg={__proto__:null,on:Xe,off:Ut,stopPropagation:qs,disableScrollPropagation:va,disableClickPropagation:ba,preventDefault:fn,stop:xs,getPropagationPath:pf,getMousePosition:Ou,getWheelDelta:Wg,isExternalTarget:gf,addListener:Xe,removeListener:Ut},yf=ae.extend({run:function(c,h,y,w){this.stop(),this._el=c,this._inProgress=!0,this._duration=y||.25,this._easeOutPower=1/Math.max(w||.5,.2),this._startPos=Bs(c),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=z(this._animate,this),this._step()},_step:function(c){var h=+new Date-this._startTime,y=this._duration*1e3;h<y?this._runFrame(this._easeOut(h/y),c):(this._runFrame(1),this._complete())},_runFrame:function(c,h){var y=this._startPos.add(this._offset.multiplyBy(c));h&&y._round(),it(this._el,y),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),_t=ae.extend({options:{crs:me,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,h){h=_(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(G(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Kl&&He.any3d&&!He.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Xe(this._proxy,rf,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,h,y){if(h=h===void 0?this._zoom:this._limitZoom(h),c=this._limitCenter(G(c),h,this.options.maxBounds),y=y||{},this._stop(),this._loaded&&!y.reset&&y!==!0){y.animate!==void 0&&(y.zoom=s({animate:y.animate},y.zoom),y.pan=s({animate:y.animate,duration:y.duration},y.pan));var w=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,h,y.zoom):this._tryAnimatedPan(c,y.pan);if(w)return clearTimeout(this._sizeTimer),this}return this._resetView(c,h,y.pan&&y.pan.noMoveStart),this},setZoom:function(c,h){return this._loaded?this.setView(this.getCenter(),c,{zoom:h}):(this._zoom=c,this)},zoomIn:function(c,h){return c=c||(He.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+c,h)},zoomOut:function(c,h){return c=c||(He.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-c,h)},setZoomAround:function(c,h,y){var w=this.getZoomScale(h),A=this.getSize().divideBy(2),B=c instanceof H?c:this.latLngToContainerPoint(c),q=B.subtract(A).multiplyBy(1-1/w),X=this.containerPointToLatLng(A.add(q));return this.setView(X,h,{zoom:y})},_getBoundsCenterZoom:function(c,h){h=h||{},c=c.getBounds?c.getBounds():Me(c);var y=W(h.paddingTopLeft||h.padding||[0,0]),w=W(h.paddingBottomRight||h.padding||[0,0]),A=this.getBoundsZoom(c,!1,y.add(w));if(A=typeof h.maxZoom=="number"?Math.min(h.maxZoom,A):A,A===1/0)return{center:c.getCenter(),zoom:A};var B=w.subtract(y).divideBy(2),q=this.project(c.getSouthWest(),A),X=this.project(c.getNorthEast(),A),te=this.unproject(q.add(X).divideBy(2).add(B),A);return{center:te,zoom:A}},fitBounds:function(c,h){if(c=Me(c),!c.isValid())throw new Error("Bounds are not valid.");var y=this._getBoundsCenterZoom(c,h);return this.setView(y.center,y.zoom,h)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,h){return this.setView(c,this._zoom,{pan:h})},panBy:function(c,h){if(c=W(c).round(),h=h||{},!c.x&&!c.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new yf,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){ct(this._mapPane,"leaflet-pan-anim");var y=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,y,h.duration||.25,h.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,h,y){if(y=y||{},y.animate===!1||!He.any3d)return this.setView(c,h,y);this._stop();var w=this.project(this.getCenter()),A=this.project(c),B=this.getSize(),q=this._zoom;c=G(c),h=h===void 0?q:h;var X=Math.max(B.x,B.y),te=X*this.getZoomScale(q,h),de=A.distanceTo(w)||1,Re=1.42,Je=Re*Re;function gt(Fn){var ly=Fn?-1:1,Kz=Fn?te:X,Qz=te*te-X*X+ly*Je*Je*de*de,Zz=2*Kz*Je*de,Bb=Qz/Zz,j2=Math.sqrt(Bb*Bb+1)-Bb,Yz=j2<1e-9?-18:Math.log(j2);return Yz}function Dr(Fn){return(Math.exp(Fn)-Math.exp(-Fn))/2}function er(Fn){return(Math.exp(Fn)+Math.exp(-Fn))/2}function Hs(Fn){return Dr(Fn)/er(Fn)}var Xr=gt(0);function Qu(Fn){return X*(er(Xr)/er(Xr+Re*Fn))}function qz(Fn){return X*(er(Xr)*Hs(Xr+Re*Fn)-Dr(Xr))/Je}function Wz(Fn){return 1-Math.pow(1-Fn,1.5)}var Hz=Date.now(),E2=(gt(1)-Xr)/Re,Gz=y.duration?1e3*y.duration:1e3*E2*.8;function C2(){var Fn=(Date.now()-Hz)/Gz,ly=Wz(Fn)*E2;Fn<=1?(this._flyToFrame=z(C2,this),this._move(this.unproject(w.add(A.subtract(w).multiplyBy(qz(ly)/de)),q),this.getScaleZoom(X/Qu(ly),q),{flyTo:!0})):this._move(c,h)._moveEnd(!0)}return this._moveStart(!0,y.noMoveStart),C2.call(this),this},flyToBounds:function(c,h){var y=this._getBoundsCenterZoom(c,h);return this.flyTo(y.center,y.zoom,h)},setMaxBounds:function(c){return c=Me(c),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),c.isValid()?(this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(c){var h=this.options.minZoom;return this.options.minZoom=c,this._loaded&&h!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var h=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&h!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,h){this._enforcingBounds=!0;var y=this.getCenter(),w=this._limitCenter(y,this._zoom,Me(c));return y.equals(w)||this.panTo(w,h),this._enforcingBounds=!1,this},panInside:function(c,h){h=h||{};var y=W(h.paddingTopLeft||h.padding||[0,0]),w=W(h.paddingBottomRight||h.padding||[0,0]),A=this.project(this.getCenter()),B=this.project(c),q=this.getPixelBounds(),X=he([q.min.add(y),q.max.subtract(w)]),te=X.getSize();if(!X.contains(B)){this._enforcingBounds=!0;var de=B.subtract(X.getCenter()),Re=X.extend(B).getSize().subtract(te);A.x+=de.x<0?-Re.x:Re.x,A.y+=de.y<0?-Re.y:Re.y,this.panTo(this.unproject(A),h),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=s({animate:!1,pan:!0},c===!0?{animate:!0}:c);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var y=this.getSize(),w=h.divideBy(2).round(),A=y.divideBy(2).round(),B=w.subtract(A);return!B.x&&!B.y?this:(c.animate&&c.pan?this.panBy(B):(c.pan&&this._rawPanBy(B),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:y}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=s({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=a(this._handleGeolocationResponse,this),y=a(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,y,c):navigator.geolocation.getCurrentPosition(h,y,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){if(this._container._leaflet_id){var h=c.code,y=c.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+y+"."})}},_handleGeolocationResponse:function(c){if(this._container._leaflet_id){var h=c.coords.latitude,y=c.coords.longitude,w=new Fe(h,y),A=w.toBounds(c.coords.accuracy*2),B=this._locateOptions;if(B.setView){var q=this.getBoundsZoom(A);this.setView(w,B.maxZoom?Math.min(q,B.maxZoom):q)}var X={latlng:w,bounds:A,timestamp:c.timestamp};for(var te in c.coords)typeof c.coords[te]=="number"&&(X[te]=c.coords[te]);this.fire("locationfound",X)}},addHandler:function(c,h){if(!h)return this;var y=this[c]=new h(this);return this._handlers.push(y),this.options[c]&&y.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Kt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var c;for(c in this._layers)this._layers[c].remove();for(c in this._panes)Kt(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,h){var y="leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),w=kt("div",y,h||this._mapPane);return c&&(this._panes[c]=w),w},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds(),h=this.unproject(c.getBottomLeft()),y=this.unproject(c.getTopRight());return new ye(h,y)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,h,y){c=Me(c),y=W(y||[0,0]);var w=this.getZoom()||0,A=this.getMinZoom(),B=this.getMaxZoom(),q=c.getNorthWest(),X=c.getSouthEast(),te=this.getSize().subtract(y),de=he(this.project(X,w),this.project(q,w)).getSize(),Re=He.any3d?this.options.zoomSnap:1,Je=te.x/de.x,gt=te.y/de.y,Dr=h?Math.max(Je,gt):Math.min(Je,gt);return w=this.getScaleZoom(Dr,w),Re&&(w=Math.round(w/(Re/100))*(Re/100),w=h?Math.ceil(w/Re)*Re:Math.floor(w/Re)*Re),Math.max(A,Math.min(B,w))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,h){var y=this._getTopLeftPoint(c,h);return new re(y,y.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(c===void 0?this.getZoom():c)},getPane:function(c){return typeof c=="string"?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,h){var y=this.options.crs;return h=h===void 0?this._zoom:h,y.scale(c)/y.scale(h)},getScaleZoom:function(c,h){var y=this.options.crs;h=h===void 0?this._zoom:h;var w=y.zoom(c*y.scale(h));return isNaN(w)?1/0:w},project:function(c,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(G(c),h)},unproject:function(c,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(W(c),h)},layerPointToLatLng:function(c){var h=W(c).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(c){var h=this.project(G(c))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(G(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(Me(c))},distance:function(c,h){return this.options.crs.distance(G(c),G(h))},containerPointToLayerPoint:function(c){return W(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return W(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var h=this.containerPointToLayerPoint(W(c));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(c)))},mouseEventToContainerPoint:function(c){return Ou(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var h=this._container=sf(c);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Xe(h,"scroll",this._onScroll,this),this._containerId=u(h)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&He.any3d,ct(c,"leaflet-container"+(He.touch?" leaflet-touch":"")+(He.retina?" leaflet-retina":"")+(He.ielt9?" leaflet-oldie":"")+(He.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=ga(c,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),it(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ct(c.markerPane,"leaflet-zoom-hide"),ct(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,h,y){it(this._mapPane,new H(0,0));var w=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var A=this._zoom!==h;this._moveStart(A,y)._move(c,h)._moveEnd(A),this.fire("viewreset"),w&&this.fire("load")},_moveStart:function(c,h){return c&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(c,h,y,w){h===void 0&&(h=this._zoom);var A=this._zoom!==h;return this._zoom=h,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),w?y&&y.pinch&&this.fire("zoom",y):((A||y&&y.pinch)&&this.fire("zoom",y),this.fire("move",y)),this},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){it(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[u(this._container)]=this;var h=c?Ut:Xe;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),He.any3d&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=z(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,h){for(var y=[],w,A=h==="mouseout"||h==="mouseover",B=c.target||c.srcElement,q=!1;B;){if(w=this._targets[u(B)],w&&(h==="click"||h==="preclick")&&this._draggableMoved(w)){q=!0;break}if(w&&w.listens(h,!0)&&(A&&!gf(B,c)||(y.push(w),A))||B===this._container)break;B=B.parentNode}return!y.length&&!q&&!A&&this.listens(h,!0)&&(y=[this]),y},_isClickDisabled:function(c){for(;c&&c!==this._container;){if(c._leaflet_disable_click)return!0;c=c.parentNode}},_handleDOMEvent:function(c){var h=c.target||c.srcElement;if(!(!this._loaded||h._leaflet_disable_events||c.type==="click"&&this._isClickDisabled(h))){var y=c.type;y==="mousedown"&&ko(h),this._fireDOMEvent(c,y)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,h,y){if(c.type==="click"){var w=s({},c);w.type="preclick",this._fireDOMEvent(w,w.type,y)}var A=this._findEventTargets(c,h);if(y){for(var B=[],q=0;q<y.length;q++)y[q].listens(h,!0)&&B.push(y[q]);A=B.concat(A)}if(A.length){h==="contextmenu"&&fn(c);var X=A[0],te={originalEvent:c};if(c.type!=="keypress"&&c.type!=="keydown"&&c.type!=="keyup"){var de=X.getLatLng&&(!X._radius||X._radius<=10);te.containerPoint=de?this.latLngToContainerPoint(X.getLatLng()):this.mouseEventToContainerPoint(c),te.layerPoint=this.containerPointToLayerPoint(te.containerPoint),te.latlng=de?X.getLatLng():this.layerPointToLatLng(te.layerPoint)}for(q=0;q<A.length;q++)if(A[q].fire(h,te,!0),te.originalEvent._stopped||A[q].options.bubblingMouseEvents===!1&&C(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(c){return c=c.dragging&&c.dragging.enabled()?c:this,c.dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,h=this._handlers.length;c<h;c++)this._handlers[c].disable()},whenReady:function(c,h){return this._loaded?c.call(h||this,{target:this}):this.on("load",c,h),this},_getMapPanePos:function(){return Bs(this._mapPane)||new H(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,h){var y=c&&h!==void 0?this._getNewPixelOrigin(c,h):this.getPixelOrigin();return y.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,h){var y=this.getSize()._divideBy(2);return this.project(c,h)._subtract(y)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,h,y){var w=this._getNewPixelOrigin(y,h);return this.project(c,h)._subtract(w)},_latLngBoundsToNewLayerBounds:function(c,h,y){var w=this._getNewPixelOrigin(y,h);return he([this.project(c.getSouthWest(),h)._subtract(w),this.project(c.getNorthWest(),h)._subtract(w),this.project(c.getSouthEast(),h)._subtract(w),this.project(c.getNorthEast(),h)._subtract(w)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,h,y){if(!y)return c;var w=this.project(c,h),A=this.getSize().divideBy(2),B=new re(w.subtract(A),w.add(A)),q=this._getBoundsOffset(B,y,h);return Math.abs(q.x)<=1&&Math.abs(q.y)<=1?c:this.unproject(w.add(q),h)},_limitOffset:function(c,h){if(!h)return c;var y=this.getPixelBounds(),w=new re(y.min.add(c),y.max.add(c));return c.add(this._getBoundsOffset(w,h))},_getBoundsOffset:function(c,h,y){var w=he(this.project(h.getNorthEast(),y),this.project(h.getSouthWest(),y)),A=w.min.subtract(c.min),B=w.max.subtract(c.max),q=this._rebound(A.x,-B.x),X=this._rebound(A.y,-B.y);return new H(q,X)},_rebound:function(c,h){return c+h>0?Math.round(c-h)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(h))},_limitZoom:function(c){var h=this.getMinZoom(),y=this.getMaxZoom(),w=He.any3d?this.options.zoomSnap:1;return w&&(c=Math.round(c/w)*w),Math.max(h,Math.min(y,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,h){var y=this._getCenterOffset(c)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(y)?!1:(this.panBy(y,h),!0)},_createAnimProxy:function(){var c=this._proxy=kt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(h){var y=Gl,w=this._proxy.style[y];Di(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),w===this._proxy.style[y]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Kt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),h=this.getZoom();Di(this._proxy,this.project(c,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,h,y){if(this._animatingZoom)return!0;if(y=y||{},!this._zoomAnimated||y.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var w=this.getZoomScale(h),A=this._getCenterOffset(c)._divideBy(1-1/w);return y.animate!==!0&&!this.getSize().contains(A)?!1:(z(function(){this._moveStart(!0,y.noMoveStart||!1)._animateZoom(c,h,!0)},this),!0)},_animateZoom:function(c,h,y,w){this._mapPane&&(y&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=h,ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:h,noUpdate:w}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Du(c,h){return new _t(c,h)}var Yr=ee.extend({options:{position:"topright"},initialize:function(c){_(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var h=this._map;return h&&h.removeControl(this),this.options.position=c,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var h=this._container=this.onAdd(c),y=this.getPosition(),w=c._controlCorners[y];return ct(h,"leaflet-control"),y.indexOf("bottom")!==-1?w.insertBefore(h,w.firstChild):w.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Kt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),Or=function(c){return new Yr(c)};_t.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},h="leaflet-",y=this._controlContainer=kt("div",h+"control-container",this._container);function w(A,B){var q=h+A+" "+h+B;c[A+B]=kt("div",q,y)}w("top","left"),w("top","right"),w("bottom","left"),w("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)Kt(this._controlCorners[c]);Kt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var xf=Yr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,h,y,w){return y<w?-1:w<y?1:0}},initialize:function(c,h,y){_(this,y),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var w in c)this._addLayer(c[w],w);for(w in h)this._addLayer(h[w],w,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return Yr.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,h){return this._addLayer(c,h),this._map?this._update():this},addOverlay:function(c,h){return this._addLayer(c,h,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var h=this._getLayer(u(c));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):cn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",h=this._container=kt("div",c),y=this.options.collapsed;h.setAttribute("aria-haspopup",!0),ba(h),va(h);var w=this._section=kt("section",c+"-list");y&&(this._map.on("click",this.collapse,this),Xe(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=kt("a",c+"-toggle",h);A.href="#",A.title="Layers",A.setAttribute("role","button"),Xe(A,{keydown:function(B){B.keyCode===13&&this._expandSafely()},click:function(B){fn(B),this._expandSafely()}},this),y||this.expand(),this._baseLayersList=kt("div",c+"-base",w),this._separator=kt("div",c+"-separator",w),this._overlaysList=kt("div",c+"-overlays",w),h.appendChild(w)},_getLayer:function(c){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&u(this._layers[h].layer)===c)return this._layers[h]},_addLayer:function(c,h,y){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:h,overlay:y}),this.options.sortLayers&&this._layers.sort(a(function(w,A){return this.options.sortFunction(w.layer,A.layer,w.name,A.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ql(this._baseLayersList),Ql(this._overlaysList),this._layerControlInputs=[];var c,h,y,w,A=0;for(y=0;y<this._layers.length;y++)w=this._layers[y],this._addItem(w),h=h||w.overlay,c=c||!w.overlay,A+=w.overlay?0:1;return this.options.hideSingleBase&&(c=c&&A>1,this._baseLayersList.style.display=c?"":"none"),this._separator.style.display=h&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var h=this._getLayer(u(c.target)),y=h.overlay?c.type==="add"?"overlayadd":"overlayremove":c.type==="add"?"baselayerchange":null;y&&this._map.fire(y,h)},_createRadioElement:function(c,h){var y='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(h?' checked="checked"':"")+"/>",w=document.createElement("div");return w.innerHTML=y,w.firstChild},_addItem:function(c){var h=document.createElement("label"),y=this._map.hasLayer(c.layer),w;c.overlay?(w=document.createElement("input"),w.type="checkbox",w.className="leaflet-control-layers-selector",w.defaultChecked=y):w=this._createRadioElement("leaflet-base-layers_"+u(this),y),this._layerControlInputs.push(w),w.layerId=u(c.layer),Xe(w,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+c.name;var B=document.createElement("span");h.appendChild(B),B.appendChild(w),B.appendChild(A);var q=c.overlay?this._overlaysList:this._baseLayersList;return q.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var c=this._layerControlInputs,h,y,w=[],A=[];this._handlingClick=!0;for(var B=c.length-1;B>=0;B--)h=c[B],y=this._getLayer(h.layerId).layer,h.checked?w.push(y):h.checked||A.push(y);for(B=0;B<A.length;B++)this._map.hasLayer(A[B])&&this._map.removeLayer(A[B]);for(B=0;B<w.length;B++)this._map.hasLayer(w[B])||this._map.addLayer(w[B]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var c=this._layerControlInputs,h,y,w=this._map.getZoom(),A=c.length-1;A>=0;A--)h=c[A],y=this._getLayer(h.layerId).layer,h.disabled=y.options.minZoom!==void 0&&w<y.options.minZoom||y.options.maxZoom!==void 0&&w>y.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var c=this._section;this._preventClick=!0,Xe(c,"click",fn),this.expand();var h=this;setTimeout(function(){Ut(c,"click",fn),h._preventClick=!1})}}),Mb=function(c,h,y){return new xf(c,h,y)},No=Yr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(c){var h="leaflet-control-zoom",y=kt("div",h+" leaflet-bar"),w=this.options;return this._zoomInButton=this._createButton(w.zoomInText,w.zoomInTitle,h+"-in",y,this._zoomIn),this._zoomOutButton=this._createButton(w.zoomOutText,w.zoomOutTitle,h+"-out",y,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),y},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,h,y,w,A){var B=kt("a",y,w);return B.innerHTML=c,B.href="#",B.title=h,B.setAttribute("role","button"),B.setAttribute("aria-label",h),ba(B),Xe(B,"click",xs),Xe(B,"click",A,this),Xe(B,"click",this._refocusOnMap,this),B},_updateDisabled:function(){var c=this._map,h="leaflet-disabled";cn(this._zoomInButton,h),cn(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||c._zoom===c.getMinZoom())&&(ct(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||c._zoom===c.getMaxZoom())&&(ct(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});_t.mergeOptions({zoomControl:!0}),_t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new No,this.addControl(this.zoomControl))});var Gg=function(c){return new No(c)},Vu=Yr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var h="leaflet-control-scale",y=kt("div",h),w=this.options;return this._addScales(w,h+"-line",y),c.on(w.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),y},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,h,y){c.metric&&(this._mScale=kt("div",h,y)),c.imperial&&(this._iScale=kt("div",h,y))},_update:function(){var c=this._map,h=c.getSize().y/2,y=c.distance(c.containerPointToLatLng([0,h]),c.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(y)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var h=this._getRoundNum(c),y=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,y,h/c)},_updateImperial:function(c){var h=c*3.2808399,y,w,A;h>5280?(y=h/5280,w=this._getRoundNum(y),this._updateScale(this._iScale,w+" mi",w/y)):(A=this._getRoundNum(h),this._updateScale(this._iScale,A+" ft",A/h))},_updateScale:function(c,h,y){c.style.width=Math.round(this.options.maxWidth*y)+"px",c.innerHTML=h},_getRoundNum:function(c){var h=Math.pow(10,(Math.floor(c)+"").length-1),y=c/h;return y=y>=10?10:y>=5?5:y>=3?3:y>=2?2:1,h*y}}),Fu=function(c){return new Vu(c)},Kg='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',_a=Yr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(He.inlineSvg?Kg+" ":"")+"Leaflet</a>"},initialize:function(c){_(this,c),this._attributions={}},onAdd:function(c){c.attributionControl=this,this._container=kt("div","leaflet-control-attribution"),ba(this._container);for(var h in c._layers)c._layers[h].getAttribution&&this.addAttribution(c._layers[h].getAttribution());return this._update(),c.on("layeradd",this._addAttribution,this),this._container},onRemove:function(c){c.off("layeradd",this._addAttribution,this)},_addAttribution:function(c){c.layer.getAttribution&&(this.addAttribution(c.layer.getAttribution()),c.layer.once("remove",function(){this.removeAttribution(c.layer.getAttribution())},this))},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var h in this._attributions)this._attributions[h]&&c.push(h);var y=[];this.options.prefix&&y.push(this.options.prefix),c.length&&y.push(c.join(", ")),this._container.innerHTML=y.join(' <span aria-hidden="true">|</span> ')}}});_t.mergeOptions({attributionControl:!0}),_t.addInitHook(function(){this.options.attributionControl&&new _a().addTo(this)});var Ob=function(c){return new _a(c)};Yr.Layers=xf,Yr.Zoom=No,Yr.Scale=Vu,Yr.Attribution=_a,Or.layers=Mb,Or.zoom=Gg,Or.scale=Fu,Or.attribution=Ob;var vs=ee.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});vs.addTo=function(c,h){return c.addHandler(h,this),this};var Zl={Events:ve},vf=He.touch?"touchstart mousedown":"mousedown",fi=ae.extend({options:{clickTolerance:3},initialize:function(c,h,y,w){_(this,w),this._element=c,this._dragStartTarget=h||c,this._preventOutline=y},enable:function(){this._enabled||(Xe(this._dragStartTarget,vf,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(fi._dragging===this&&this.finishDrag(!0),Ut(this._dragStartTarget,vf,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(this._enabled&&(this._moved=!1,!of(this._element,"leaflet-zoom-anim"))){if(c.touches&&c.touches.length!==1){fi._dragging===this&&this.finishDrag();return}if(!(fi._dragging||c.shiftKey||c.which!==1&&c.button!==1&&!c.touches)&&(fi._dragging=this,this._preventOutline&&ko(this._element),cf(),di(),!this._moving)){this.fire("down");var h=c.touches?c.touches[0]:c,y=hf(this._element);this._startPoint=new H(h.clientX,h.clientY),this._startPos=Bs(this._element),this._parentScale=Mu(y);var w=c.type==="mousedown";Xe(document,w?"mousemove":"touchmove",this._onMove,this),Xe(document,w?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(c){if(this._enabled){if(c.touches&&c.touches.length>1){this._moved=!0;return}var h=c.touches&&c.touches.length===1?c.touches[0]:c,y=new H(h.clientX,h.clientY)._subtract(this._startPoint);!y.x&&!y.y||Math.abs(y.x)+Math.abs(y.y)<this.options.clickTolerance||(y.x/=this._parentScale.x,y.y/=this._parentScale.y,fn(c),this._moved||(this.fire("dragstart"),this._moved=!0,ct(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(y),this._moving=!0,this._lastEvent=c,this._updatePosition())}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),it(this._element,this._newPos),this.fire("drag",c)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(c){cn(document.body,"leaflet-dragging"),this._lastTarget&&(cn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ut(document,"mousemove touchmove",this._onMove,this),Ut(document,"mouseup touchend touchcancel",this._onUp,this),uf(),hi();var h=this._moved&&this._moving;this._moving=!1,fi._dragging=!1,h&&this.fire("dragend",{noInertia:c,distance:this._newPos.distanceTo(this._startPos)})}});function zu(c,h,y){var w,A=[1,4,2,8],B,q,X,te,de,Re,Je,gt;for(B=0,Re=c.length;B<Re;B++)c[B]._code=Vi(c[B],h);for(X=0;X<4;X++){for(Je=A[X],w=[],B=0,Re=c.length,q=Re-1;B<Re;q=B++)te=c[B],de=c[q],te._code&Je?de._code&Je||(gt=Jn(de,te,Je,h,y),gt._code=Vi(gt,h),w.push(gt)):(de._code&Je&&(gt=Jn(de,te,Je,h,y),gt._code=Vi(gt,h),w.push(gt)),w.push(te));c=w}return c}function Bu(c,h){var y,w,A,B,q,X,te,de,Re;if(!c||c.length===0)throw new Error("latlngs not passed");g(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var Je=G([0,0]),gt=Me(c),Dr=gt.getNorthWest().distanceTo(gt.getSouthWest())*gt.getNorthEast().distanceTo(gt.getNorthWest());Dr<1700&&(Je=$u(c));var er=c.length,Hs=[];for(y=0;y<er;y++){var Xr=G(c[y]);Hs.push(h.project(G([Xr.lat-Je.lat,Xr.lng-Je.lng])))}for(X=te=de=0,y=0,w=er-1;y<er;w=y++)A=Hs[y],B=Hs[w],q=A.y*B.x-B.y*A.x,te+=(A.x+B.x)*q,de+=(A.y+B.y)*q,X+=q*3;X===0?Re=Hs[0]:Re=[te/X,de/X];var Qu=h.unproject(W(Re));return G([Qu.lat+Je.lat,Qu.lng+Je.lng])}function $u(c){for(var h=0,y=0,w=0,A=0;A<c.length;A++){var B=G(c[A]);h+=B.lat,y+=B.lng,w++}return G([h/w,y/w])}var Uu={__proto__:null,clipPolygon:zu,polygonCenter:Bu,centroid:$u};function bf(c,h){if(!h||!c.length)return c.slice();var y=h*h;return c=Zg(c,y),c=Qg(c,y),c}function _f(c,h,y){return Math.sqrt(Ws(c,h,y,!0))}function So(c,h,y){return Ws(c,h,y)}function Qg(c,h){var y=c.length,w=typeof Uint8Array<"u"?Uint8Array:Array,A=new w(y);A[0]=A[y-1]=1,qu(c,A,h,0,y-1);var B,q=[];for(B=0;B<y;B++)A[B]&&q.push(c[B]);return q}function qu(c,h,y,w,A){var B=0,q,X,te;for(X=w+1;X<=A-1;X++)te=Ws(c[X],c[w],c[A],!0),te>B&&(q=X,B=te);B>y&&(h[q]=1,qu(c,h,y,w,q),qu(c,h,y,q,A))}function Zg(c,h){for(var y=[c[0]],w=1,A=0,B=c.length;w<B;w++)Yg(c[w],c[A])>h&&(y.push(c[w]),A=w);return A<B-1&&y.push(c[B-1]),y}var wf;function Yl(c,h,y,w,A){var B=w?wf:Vi(c,y),q=Vi(h,y),X,te,de;for(wf=q;;){if(!(B|q))return[c,h];if(B&q)return!1;X=B||q,te=Jn(c,h,X,y,A),de=Vi(te,y),X===B?(c=te,B=de):(h=te,q=de)}}function Jn(c,h,y,w,A){var B=h.x-c.x,q=h.y-c.y,X=w.min,te=w.max,de,Re;return y&8?(de=c.x+B*(te.y-c.y)/q,Re=te.y):y&4?(de=c.x+B*(X.y-c.y)/q,Re=X.y):y&2?(de=te.x,Re=c.y+q*(te.x-c.x)/B):y&1&&(de=X.x,Re=c.y+q*(X.x-c.x)/B),new H(de,Re,A)}function Vi(c,h){var y=0;return c.x<h.min.x?y|=1:c.x>h.max.x&&(y|=2),c.y<h.min.y?y|=4:c.y>h.max.y&&(y|=8),y}function Yg(c,h){var y=h.x-c.x,w=h.y-c.y;return y*y+w*w}function Ws(c,h,y,w){var A=h.x,B=h.y,q=y.x-A,X=y.y-B,te=q*q+X*X,de;return te>0&&(de=((c.x-A)*q+(c.y-B)*X)/te,de>1?(A=y.x,B=y.y):de>0&&(A+=q*de,B+=X*de)),q=c.x-A,X=c.y-B,w?q*q+X*X:new H(A,B)}function g(c){return!S(c[0])||typeof c[0][0]!="object"&&typeof c[0][0]<"u"}function T(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),g(c)}function M(c,h){var y,w,A,B,q,X,te,de;if(!c||c.length===0)throw new Error("latlngs not passed");g(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var Re=G([0,0]),Je=Me(c),gt=Je.getNorthWest().distanceTo(Je.getSouthWest())*Je.getNorthEast().distanceTo(Je.getNorthWest());gt<1700&&(Re=$u(c));var Dr=c.length,er=[];for(y=0;y<Dr;y++){var Hs=G(c[y]);er.push(h.project(G([Hs.lat-Re.lat,Hs.lng-Re.lng])))}for(y=0,w=0;y<Dr-1;y++)w+=er[y].distanceTo(er[y+1])/2;if(w===0)de=er[0];else for(y=0,B=0;y<Dr-1;y++)if(q=er[y],X=er[y+1],A=q.distanceTo(X),B+=A,B>w){te=(B-w)/A,de=[X.x-te*(X.x-q.x),X.y-te*(X.y-q.y)];break}var Xr=h.unproject(W(de));return G([Xr.lat+Re.lat,Xr.lng+Re.lng])}var $={__proto__:null,simplify:bf,pointToSegmentDistance:_f,closestPointOnSegment:So,clipSegment:Yl,_getEdgeIntersection:Jn,_getBitCode:Vi,_sqClosestPointOnSegment:Ws,isFlat:g,_flat:T,polylineCenter:M},Z={project:function(c){return new H(c.lng,c.lat)},unproject:function(c){return new Fe(c.y,c.x)},bounds:new re([-180,-90],[180,90])},se={R:6378137,R_MINOR:6356752314245179e-9,bounds:new re([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(c){var h=Math.PI/180,y=this.R,w=c.lat*h,A=this.R_MINOR/y,B=Math.sqrt(1-A*A),q=B*Math.sin(w),X=Math.tan(Math.PI/4-w/2)/Math.pow((1-q)/(1+q),B/2);return w=-y*Math.log(Math.max(X,1e-10)),new H(c.lng*h*y,w)},unproject:function(c){for(var h=180/Math.PI,y=this.R,w=this.R_MINOR/y,A=Math.sqrt(1-w*w),B=Math.exp(-c.y/y),q=Math.PI/2-2*Math.atan(B),X=0,te=.1,de;X<15&&Math.abs(te)>1e-7;X++)de=A*Math.sin(q),de=Math.pow((1-de)/(1+de),A/2),te=Math.PI/2-2*Math.atan(B*de)-q,q+=te;return new Fe(q*h,c.x*h/y)}},Se={__proto__:null,LonLat:Z,Mercator:se,SphericalMercator:ie},Vt=s({},De,{code:"EPSG:3395",projection:se,transformation:function(){var c=.5/(Math.PI*se.R);return Ge(c,.5,-c,.5)}()}),Vn=s({},De,{code:"EPSG:4326",projection:Z,transformation:Ge(1/180,1,-1/180,.5)}),Et=s({},le,{projection:Z,transformation:Ge(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,h){var y=h.lng-c.lng,w=h.lat-c.lat;return Math.sqrt(y*y+w*w)},infinite:!0});le.Earth=De,le.EPSG3395=Vt,le.EPSG3857=me,le.EPSG900913=dt,le.EPSG4326=Vn,le.Simple=Et;var qt=ae.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[u(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[u(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var h=c.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var y=this.getEvents();h.on(y,this),this.once("remove",function(){h.off(y,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});_t.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var h=u(c);return this._layers[h]?this:(this._layers[h]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c),this)},removeLayer:function(c){var h=u(c);return this._layers[h]?(this._loaded&&c.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return u(c)in this._layers},eachLayer:function(c,h){for(var y in this._layers)c.call(h,this._layers[y]);return this},_addLayers:function(c){c=c?S(c)?c:[c]:[];for(var h=0,y=c.length;h<y;h++)this.addLayer(c[h])},_addZoomLimit:function(c){(!isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[u(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var h=u(c);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,h=-1/0,y=this._getZoomSpan();for(var w in this._zoomBoundLayers){var A=this._zoomBoundLayers[w].options;c=A.minZoom===void 0?c:Math.min(c,A.minZoom),h=A.maxZoom===void 0?h:Math.max(h,A.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=c===1/0?void 0:c,y!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var mn=qt.extend({initialize:function(c,h){_(this,h),this._layers={};var y,w;if(c)for(y=0,w=c.length;y<w;y++)this.addLayer(c[y])},addLayer:function(c){var h=this.getLayerId(c);return this._layers[h]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var h=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(c){var h=typeof c=="number"?c:this.getLayerId(c);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var h=Array.prototype.slice.call(arguments,1),y,w;for(y in this._layers)w=this._layers[y],w[c]&&w[c].apply(w,h);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,h){for(var y in this._layers)c.call(h,this._layers[y]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return u(c)}}),wa=function(c,h){return new mn(c,h)},An=mn.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),mn.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),mn.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new ye;for(var h in this._layers){var y=this._layers[h];c.extend(y.getBounds?y.getBounds():y.getLatLng())}return c}}),Wu=function(c,h){return new An(c,h)},Fi=ee.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(c){_(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,h){var y=this._getIconUrl(c);if(!y){if(c==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var w=this._createImg(y,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(w,c),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),w},_setIconStyles:function(c,h){var y=this.options,w=y[h+"Size"];typeof w=="number"&&(w=[w,w]);var A=W(w),B=W(h==="shadow"&&y.shadowAnchor||y.iconAnchor||A&&A.divideBy(2,!0));c.className="leaflet-marker-"+h+" "+(y.className||""),B&&(c.style.marginLeft=-B.x+"px",c.style.marginTop=-B.y+"px"),A&&(c.style.width=A.x+"px",c.style.height=A.y+"px")},_createImg:function(c,h){return h=h||document.createElement("img"),h.src=c,h},_getIconUrl:function(c){return He.retina&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});function Sz(c){return new Fi(c)}var kf=Fi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return typeof kf.imagePath!="string"&&(kf.imagePath=this._detectIconPath()),(this.options.imagePath||kf.imagePath)+Fi.prototype._getIconUrl.call(this,c)},_stripUrl:function(c){var h=function(y,w,A){var B=w.exec(y);return B&&B[A]};return c=h(c,/^url\((['"])?(.+)\1\)$/,2),c&&h(c,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var c=kt("div","leaflet-default-icon-path",document.body),h=ga(c,"background-image")||ga(c,"backgroundImage");if(document.body.removeChild(c),h=this._stripUrl(h),h)return h;var y=document.querySelector('link[href$="leaflet.css"]');return y?y.href.substring(0,y.href.length-11-1):""}}),l2=vs.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new fi(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ct(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var h=this._marker,y=h._map,w=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,B=Bs(h._icon),q=y.getPixelBounds(),X=y.getPixelOrigin(),te=he(q.min._subtract(X).add(A),q.max._subtract(X).subtract(A));if(!te.contains(B)){var de=W((Math.max(te.max.x,B.x)-te.max.x)/(q.max.x-te.max.x)-(Math.min(te.min.x,B.x)-te.min.x)/(q.min.x-te.min.x),(Math.max(te.max.y,B.y)-te.max.y)/(q.max.y-te.max.y)-(Math.min(te.min.y,B.y)-te.min.y)/(q.min.y-te.min.y)).multiplyBy(w);y.panBy(de,{animate:!1}),this._draggable._newPos._add(de),this._draggable._startPos._add(de),it(h._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=z(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=z(this._adjustPan.bind(this,c)))},_onDrag:function(c){var h=this._marker,y=h._shadow,w=Bs(h._icon),A=h._map.layerPointToLatLng(w);y&&it(y,w),h._latlng=A,c.latlng=A,c.oldLatLng=this._oldLatLng,h.fire("move",c).fire("drag",c)},_onDragEnd:function(c){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),Xg=qt.extend({options:{icon:new kf,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,h){_(this,h),this._latlng=G(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var h=this._latlng;return this._latlng=G(c),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),y=c.icon.createIcon(this._icon),w=!1;y!==this._icon&&(this._icon&&this._removeIcon(),w=!0,c.title&&(y.title=c.title),y.tagName==="IMG"&&(y.alt=c.alt||"")),ct(y,h),c.keyboard&&(y.tabIndex="0",y.setAttribute("role","button")),this._icon=y,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xe(y,"focus",this._panOnFocus,this);var A=c.icon.createShadow(this._shadow),B=!1;A!==this._shadow&&(this._removeShadow(),B=!0),A&&(ct(A,h),A.alt=""),this._shadow=A,c.opacity<1&&this._updateOpacity(),w&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&B&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(this._icon,"focus",this._panOnFocus,this),Kt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Kt(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&it(this._icon,c),this._shadow&&it(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var h=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),l2)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new l2(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&Nn(this._icon,c),this._shadow&&Nn(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var c=this._map;if(c){var h=this.options.icon.options,y=h.iconSize?W(h.iconSize):W(0,0),w=h.iconAnchor?W(h.iconAnchor):W(0,0);c.panInside(this._latlng,{paddingTopLeft:w,paddingBottomRight:y.subtract(w)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Tz(c,h){return new Xg(c,h)}var ka=qt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return _(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Jg=ka.extend({options:{fill:!0,radius:10},initialize:function(c,h){_(this,h),this._latlng=G(c),this._radius=this.options.radius},setLatLng:function(c){var h=this._latlng;return this._latlng=G(c),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var h=c&&c.radius||this._radius;return ka.prototype.setStyle.call(this,c),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,h=this._radiusY||c,y=this._clickTolerance(),w=[c+y,h+y];this._pxBounds=new re(this._point.subtract(w),this._point.add(w))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ez(c,h){return new Jg(c,h)}var Db=Jg.extend({initialize:function(c,h,y){if(typeof h=="number"&&(h=s({},y,{radius:h})),_(this,h),this._latlng=G(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new ye(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:ka.prototype.setStyle,_project:function(){var c=this._latlng.lng,h=this._latlng.lat,y=this._map,w=y.options.crs;if(w.distance===De.distance){var A=Math.PI/180,B=this._mRadius/De.R/A,q=y.project([h+B,c]),X=y.project([h-B,c]),te=q.add(X).divideBy(2),de=y.unproject(te).lat,Re=Math.acos((Math.cos(B*A)-Math.sin(h*A)*Math.sin(de*A))/(Math.cos(h*A)*Math.cos(de*A)))/A;(isNaN(Re)||Re===0)&&(Re=B/Math.cos(Math.PI/180*h)),this._point=te.subtract(y.getPixelOrigin()),this._radius=isNaN(Re)?0:te.x-y.project([de,c-Re]).x,this._radiusY=te.y-q.y}else{var Je=w.unproject(w.project(this._latlng).subtract([this._mRadius,0]));this._point=y.latLngToLayerPoint(this._latlng),this._radius=this._point.x-y.latLngToLayerPoint(Je).x}this._updateBounds()}});function Cz(c,h,y){return new Db(c,h,y)}var To=ka.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,h){_(this,h),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var h=1/0,y=null,w=Ws,A,B,q=0,X=this._parts.length;q<X;q++)for(var te=this._parts[q],de=1,Re=te.length;de<Re;de++){A=te[de-1],B=te[de];var Je=w(c,A,B,!0);Je<h&&(h=Je,y=w(c,A,B))}return y&&(y.distance=Math.sqrt(h)),y},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return M(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(c,h){return h=h||this._defaultShape(),c=G(c),h.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new ye,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return g(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var h=[],y=g(c),w=0,A=c.length;w<A;w++)y?(h[w]=G(c[w]),this._bounds.extend(h[w])):h[w]=this._convertLatLngs(c[w]);return h},_project:function(){var c=new re;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),h=new H(c,c);this._rawPxBounds&&(this._pxBounds=new re([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(c,h,y){var w=c[0]instanceof Fe,A=c.length,B,q;if(w){for(q=[],B=0;B<A;B++)q[B]=this._map.latLngToLayerPoint(c[B]),y.extend(q[B]);h.push(q)}else for(B=0;B<A;B++)this._projectLatlngs(c[B],h,y)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,y,w,A,B,q,X,te;for(y=0,A=0,B=this._rings.length;y<B;y++)for(te=this._rings[y],w=0,q=te.length;w<q-1;w++)X=Yl(te[w],te[w+1],c,w,!0),X&&(h[A]=h[A]||[],h[A].push(X[0]),(X[1]!==te[w+1]||w===q-2)&&(h[A].push(X[1]),A++))}},_simplifyPoints:function(){for(var c=this._parts,h=this.options.smoothFactor,y=0,w=c.length;y<w;y++)c[y]=bf(c[y],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,h){var y,w,A,B,q,X,te=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(y=0,B=this._parts.length;y<B;y++)for(X=this._parts[y],w=0,q=X.length,A=q-1;w<q;A=w++)if(!(!h&&w===0)&&_f(c,X[A],X[w])<=te)return!0;return!1}});function jz(c,h){return new To(c,h)}To._flat=T;var Hu=To.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Bu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(c){var h=To.prototype._convertLatLngs.call(this,c),y=h.length;return y>=2&&h[0]instanceof Fe&&h[0].equals(h[y-1])&&h.pop(),h},_setLatLngs:function(c){To.prototype._setLatLngs.call(this,c),g(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return g(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,h=this.options.weight,y=new H(h,h);if(c=new re(c.min.subtract(y),c.max.add(y)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}for(var w=0,A=this._rings.length,B;w<A;w++)B=zu(this._rings[w],c,!0),B.length&&this._parts.push(B)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var h=!1,y,w,A,B,q,X,te,de;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(B=0,te=this._parts.length;B<te;B++)for(y=this._parts[B],q=0,de=y.length,X=de-1;q<de;X=q++)w=y[q],A=y[X],w.y>c.y!=A.y>c.y&&c.x<(A.x-w.x)*(c.y-w.y)/(A.y-w.y)+w.x&&(h=!h);return h||To.prototype._containsPoint.call(this,c,!0)}});function Iz(c,h){return new Hu(c,h)}var Eo=An.extend({initialize:function(c,h){_(this,h),this._layers={},c&&this.addData(c)},addData:function(c){var h=S(c)?c:c.features,y,w,A;if(h){for(y=0,w=h.length;y<w;y++)A=h[y],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var B=this.options;if(B.filter&&!B.filter(c))return this;var q=ey(c,B);return q?(q.feature=ry(c),q.defaultOptions=q.options,this.resetStyle(q),B.onEachFeature&&B.onEachFeature(c,q),this.addLayer(q)):this},resetStyle:function(c){return c===void 0?this.eachLayer(this.resetStyle,this):(c.options=s({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(h){this._setLayerStyle(h,c)},this)},_setLayerStyle:function(c,h){c.setStyle&&(typeof h=="function"&&(h=h(c.feature)),c.setStyle(h))}});function ey(c,h){var y=c.type==="Feature"?c.geometry:c,w=y?y.coordinates:null,A=[],B=h&&h.pointToLayer,q=h&&h.coordsToLatLng||Vb,X,te,de,Re;if(!w&&!y)return null;switch(y.type){case"Point":return X=q(w),c2(B,c,X,h);case"MultiPoint":for(de=0,Re=w.length;de<Re;de++)X=q(w[de]),A.push(c2(B,c,X,h));return new An(A);case"LineString":case"MultiLineString":return te=ty(w,y.type==="LineString"?0:1,q),new To(te,h);case"Polygon":case"MultiPolygon":return te=ty(w,y.type==="Polygon"?1:2,q),new Hu(te,h);case"GeometryCollection":for(de=0,Re=y.geometries.length;de<Re;de++){var Je=ey({geometry:y.geometries[de],type:"Feature",properties:c.properties},h);Je&&A.push(Je)}return new An(A);case"FeatureCollection":for(de=0,Re=y.features.length;de<Re;de++){var gt=ey(y.features[de],h);gt&&A.push(gt)}return new An(A);default:throw new Error("Invalid GeoJSON object.")}}function c2(c,h,y,w){return c?c(h,y):new Xg(y,w&&w.markersInheritOptions&&w)}function Vb(c){return new Fe(c[1],c[0],c[2])}function ty(c,h,y){for(var w=[],A=0,B=c.length,q;A<B;A++)q=h?ty(c[A],h-1,y):(y||Vb)(c[A]),w.push(q);return w}function Fb(c,h){return c=G(c),c.alt!==void 0?[p(c.lng,h),p(c.lat,h),p(c.alt,h)]:[p(c.lng,h),p(c.lat,h)]}function ny(c,h,y,w){for(var A=[],B=0,q=c.length;B<q;B++)A.push(h?ny(c[B],g(c[B])?0:h-1,y,w):Fb(c[B],w));return!h&&y&&A.length>0&&A.push(A[0].slice()),A}function Gu(c,h){return c.feature?s({},c.feature,{geometry:h}):ry(h)}function ry(c){return c.type==="Feature"||c.type==="FeatureCollection"?c:{type:"Feature",properties:{},geometry:c}}var zb={toGeoJSON:function(c){return Gu(this,{type:"Point",coordinates:Fb(this.getLatLng(),c)})}};Xg.include(zb),Db.include(zb),Jg.include(zb),To.include({toGeoJSON:function(c){var h=!g(this._latlngs),y=ny(this._latlngs,h?1:0,!1,c);return Gu(this,{type:(h?"Multi":"")+"LineString",coordinates:y})}}),Hu.include({toGeoJSON:function(c){var h=!g(this._latlngs),y=h&&!g(this._latlngs[0]),w=ny(this._latlngs,y?2:h?1:0,!0,c);return h||(w=[w]),Gu(this,{type:(y?"Multi":"")+"Polygon",coordinates:w})}}),mn.include({toMultiPoint:function(c){var h=[];return this.eachLayer(function(y){h.push(y.toGeoJSON(c).geometry.coordinates)}),Gu(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(c){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(c);var y=h==="GeometryCollection",w=[];return this.eachLayer(function(A){if(A.toGeoJSON){var B=A.toGeoJSON(c);if(y)w.push(B.geometry);else{var q=ry(B);q.type==="FeatureCollection"?w.push.apply(w,q.features):w.push(q)}}}),y?Gu(this,{geometries:w,type:"GeometryCollection"}):{type:"FeatureCollection",features:w}}});function u2(c,h){return new Eo(c,h)}var Az=u2,sy=qt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,h,y){this._url=c,this._bounds=Me(h),_(this,y)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Kt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&_o(this._image),this},bringToBack:function(){return this._map&&ya(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=Me(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c=this._url.tagName==="IMG",h=this._image=c?this._url:kt("img");if(ct(h,"leaflet-image-layer"),this._zoomAnimated&&ct(h,"leaflet-zoom-animated"),this.options.className&&ct(h,this.options.className),h.onselectstart=m,h.onmousemove=m,h.onload=a(this.fire,this,"load"),h.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(c){var h=this._map.getZoomScale(c.zoom),y=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;Di(this._image,y,h)},_reset:function(){var c=this._image,h=new re(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),y=h.getSize();it(c,h.min),c.style.width=y.x+"px",c.style.height=y.y+"px"},_updateOpacity:function(){Nn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)},getCenter:function(){return this._bounds.getCenter()}}),Rz=function(c,h,y){return new sy(c,h,y)},d2=sy.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var c=this._url.tagName==="VIDEO",h=this._image=c?this._url:kt("video");if(ct(h,"leaflet-image-layer"),this._zoomAnimated&&ct(h,"leaflet-zoom-animated"),this.options.className&&ct(h,this.options.className),h.onselectstart=m,h.onmousemove=m,h.onloadeddata=a(this.fire,this,"load"),c){for(var y=h.getElementsByTagName("source"),w=[],A=0;A<y.length;A++)w.push(y[A].src);this._url=y.length>0?w:[h.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var B=0;B<this._url.length;B++){var q=kt("source");q.src=this._url[B],h.appendChild(q)}}});function Pz(c,h,y){return new d2(c,h,y)}var h2=sy.extend({_initImage:function(){var c=this._image=this._url;ct(c,"leaflet-image-layer"),this._zoomAnimated&&ct(c,"leaflet-zoom-animated"),this.options.className&&ct(c,this.options.className),c.onselectstart=m,c.onmousemove=m}});function Lz(c,h,y){return new h2(c,h,y)}var zi=qt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(c,h){c&&(c instanceof Fe||S(c))?(this._latlng=G(c),_(this,h)):(_(this,c),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(c){return c=arguments.length?c:this._source._map,c.hasLayer(this)||c.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(c){return this._map?this.close():(arguments.length?this._source=c:c=this._source,this._prepareOpen(),this.openOn(c._map)),this},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&Nn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&Nn(this._container,1),this.bringToFront(),this.options.interactive&&(ct(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(c){c._fadeAnimated?(Nn(this._container,0),this._removeTimeout=setTimeout(a(Kt,void 0,this._container),200)):Kt(this._container),this.options.interactive&&(cn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=G(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&_o(this._container),this},bringToBack:function(){return this._map&&ya(this._container),this},_prepareOpen:function(c){var h=this._source;if(!h._map)return!1;if(h instanceof An){h=null;var y=this._source._layers;for(var w in y)if(y[w]._map){h=y[w];break}if(!h)return!1;this._source=h}if(!c)if(h.getCenter)c=h.getCenter();else if(h.getLatLng)c=h.getLatLng();else if(h.getBounds)c=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(c),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var c=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")c.innerHTML=h;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),h=W(this.options.offset),y=this._getAnchor();this._zoomAnimated?it(this._container,c.add(y)):h=h.add(c).add(y);var w=this._containerBottom=-h.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=w+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});_t.include({_initOverlay:function(c,h,y,w){var A=h;return A instanceof c||(A=new c(w).setContent(h)),y&&A.setLatLng(y),A}}),qt.include({_initOverlay:function(c,h,y,w){var A=y;return A instanceof c?(_(A,w),A._source=this):(A=h&&!w?h:new c(w,this),A.setContent(y)),A}});var iy=zi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return c=arguments.length?c:this._source._map,!c.hasLayer(this)&&c._popup&&c._popup.options.autoClose&&c.removeLayer(c._popup),c._popup=this,zi.prototype.openOn.call(this,c)},onAdd:function(c){zi.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ka||this._source.on("preclick",qs))},onRemove:function(c){zi.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ka||this._source.off("preclick",qs))},getEvents:function(){var c=zi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this.close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_initLayout:function(){var c="leaflet-popup",h=this._container=kt("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),y=this._wrapper=kt("div",c+"-content-wrapper",h);if(this._contentNode=kt("div",c+"-content",y),ba(h),va(this._contentNode),Xe(h,"contextmenu",qs),this._tipContainer=kt("div",c+"-tip-container",h),this._tip=kt("div",c+"-tip",this._tipContainer),this.options.closeButton){var w=this._closeButton=kt("a",c+"-close-button",h);w.setAttribute("role","button"),w.setAttribute("aria-label","Close popup"),w.href="#close",w.innerHTML='<span aria-hidden="true">&#215;</span>',Xe(w,"click",function(A){fn(A),this.close()},this)}},_updateLayout:function(){var c=this._contentNode,h=c.style;h.width="",h.whiteSpace="nowrap";var y=c.offsetWidth;y=Math.min(y,this.options.maxWidth),y=Math.max(y,this.options.minWidth),h.width=y+1+"px",h.whiteSpace="",h.height="";var w=c.offsetHeight,A=this.options.maxHeight,B="leaflet-popup-scrolled";A&&w>A?(h.height=A+"px",ct(c,B)):cn(c,B),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var h=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),y=this._getAnchor();it(this._container,h.add(y))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var c=this._map,h=parseInt(ga(this._container,"marginBottom"),10)||0,y=this._container.offsetHeight+h,w=this._containerWidth,A=new H(this._containerLeft,-y-this._containerBottom);A._add(Bs(this._container));var B=c.layerPointToContainerPoint(A),q=W(this.options.autoPanPadding),X=W(this.options.autoPanPaddingTopLeft||q),te=W(this.options.autoPanPaddingBottomRight||q),de=c.getSize(),Re=0,Je=0;B.x+w+te.x>de.x&&(Re=B.x+w-de.x+te.x),B.x-Re-X.x<0&&(Re=B.x-X.x),B.y+y+te.y>de.y&&(Je=B.y+y-de.y+te.y),B.y-Je-X.y<0&&(Je=B.y-X.y),(Re||Je)&&(this.options.keepInView&&(this._autopanning=!0),c.fire("autopanstart").panBy([Re,Je]))}},_getAnchor:function(){return W(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Mz=function(c,h){return new iy(c,h)};_t.mergeOptions({closePopupOnClick:!0}),_t.include({openPopup:function(c,h,y){return this._initOverlay(iy,c,h,y).openOn(this),this},closePopup:function(c){return c=arguments.length?c:this._popup,c&&c.close(),this}}),qt.include({bindPopup:function(c,h){return this._popup=this._initOverlay(iy,this._popup,c,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c){return this._popup&&(this instanceof An||(this._popup._source=this),this._popup._prepareOpen(c||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){if(!(!this._popup||!this._map)){xs(c);var h=c.layer||c.target;if(this._popup._source===h&&!(h instanceof ka)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(c.latlng);return}this._popup._source=h,this.openPopup(c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){c.originalEvent.keyCode===13&&this._openPopup(c)}});var oy=zi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(c){zi.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(c){zi.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var c=zi.prototype.getEvents.call(this);return this.options.permanent||(c.preclick=this.close),c},_initLayout:function(){var c="leaflet-tooltip",h=c+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=kt("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var h,y,w=this._map,A=this._container,B=w.latLngToContainerPoint(w.getCenter()),q=w.layerPointToContainerPoint(c),X=this.options.direction,te=A.offsetWidth,de=A.offsetHeight,Re=W(this.options.offset),Je=this._getAnchor();X==="top"?(h=te/2,y=de):X==="bottom"?(h=te/2,y=0):X==="center"?(h=te/2,y=de/2):X==="right"?(h=0,y=de/2):X==="left"?(h=te,y=de/2):q.x<B.x?(X="right",h=0,y=de/2):(X="left",h=te+(Re.x+Je.x)*2,y=de/2),c=c.subtract(W(h,y,!0)).add(Re).add(Je),cn(A,"leaflet-tooltip-right"),cn(A,"leaflet-tooltip-left"),cn(A,"leaflet-tooltip-top"),cn(A,"leaflet-tooltip-bottom"),ct(A,"leaflet-tooltip-"+X),it(A,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&Nn(this._container,c)},_animateZoom:function(c){var h=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(h)},_getAnchor:function(){return W(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Oz=function(c,h){return new oy(c,h)};_t.include({openTooltip:function(c,h,y){return this._initOverlay(oy,c,h,y).openOn(this),this},closeTooltip:function(c){return c.close(),this}}),qt.include({bindTooltip:function(c,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(oy,this._tooltip,c,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(!(!c&&this._tooltipHandlersAdded)){var h=c?"off":"on",y={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?y.add=this._openTooltip:(y.mouseover=this._openTooltip,y.mouseout=this.closeTooltip,y.click=this._openTooltip,this._map?this._addFocusListeners():y.add=this._addFocusListeners),this._tooltip.options.sticky&&(y.mousemove=this._moveTooltip),this[h](y),this._tooltipHandlersAdded=!c}},openTooltip:function(c){return this._tooltip&&(this instanceof An||(this._tooltip._source=this),this._tooltip._prepareOpen(c)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(c){var h=typeof c.getElement=="function"&&c.getElement();h&&(Xe(h,"focus",function(){this._tooltip._source=c,this.openTooltip()},this),Xe(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(c){var h=typeof c.getElement=="function"&&c.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(c){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(c)});return}this._tooltip._source=c.layer||c.target,this.openTooltip(this._tooltip.options.sticky?c.latlng:void 0)}},_moveTooltip:function(c){var h=c.latlng,y,w;this._tooltip.options.sticky&&c.originalEvent&&(y=this._map.mouseEventToContainerPoint(c.originalEvent),w=this._map.containerPointToLayerPoint(y),h=this._map.layerPointToLatLng(w)),this._tooltip.setLatLng(h)}});var f2=Fi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var h=c&&c.tagName==="DIV"?c:document.createElement("div"),y=this.options;if(y.html instanceof Element?(Ql(h),h.appendChild(y.html)):h.innerHTML=y.html!==!1?y.html:"",y.bgPos){var w=W(y.bgPos);h.style.backgroundPosition=-w.x+"px "+-w.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function Dz(c){return new f2(c)}Fi.Default=kf;var Nf=qt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:He.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){_(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),Kt(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(_o(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ya(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var c=this._clampZoom(this._map.getZoom());c!==this._tileZoom&&(this._tileZoom=c,this._updateLevels()),this._update()}return this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof H?c:new H(c,c)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var h=this.getPane().children,y=-c(-1/0,1/0),w=0,A=h.length,B;w<A;w++)B=h[w].style.zIndex,h[w]!==this._container&&B&&(y=c(y,+B));isFinite(y)&&(this.options.zIndex=y+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!He.ielt9){Nn(this._container,this.options.opacity);var c=+new Date,h=!1,y=!1;for(var w in this._tiles){var A=this._tiles[w];if(!(!A.current||!A.loaded)){var B=Math.min(1,(c-A.loaded)/200);Nn(A.el,B),B<1?h=!0:(A.active?y=!0:this._onOpaqueTile(A),A.active=!0)}}y&&!this._noPrune&&this._pruneTiles(),h&&(D(this._fadeFrame),this._fadeFrame=z(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=kt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,h=this.options.maxZoom;if(c!==void 0){for(var y in this._levels)y=Number(y),this._levels[y].el.children.length||y===c?(this._levels[y].el.style.zIndex=h-Math.abs(c-y),this._onUpdateLevel(y)):(Kt(this._levels[y].el),this._removeTilesAtZoom(y),this._onRemoveLevel(y),delete this._levels[y]);var w=this._levels[c],A=this._map;return w||(w=this._levels[c]={},w.el=kt("div","leaflet-tile-container leaflet-zoom-animated",this._container),w.el.style.zIndex=h,w.origin=A.project(A.unproject(A.getPixelOrigin()),c).round(),w.zoom=c,this._setZoomTransform(w,A.getCenter(),A.getZoom()),m(w.el.offsetWidth),this._onCreateLevel(w)),this._level=w,w}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var c,h,y=this._map.getZoom();if(y>this.options.maxZoom||y<this.options.minZoom){this._removeAllTiles();return}for(c in this._tiles)h=this._tiles[c],h.retain=h.current;for(c in this._tiles)if(h=this._tiles[c],h.current&&!h.active){var w=h.coords;this._retainParent(w.x,w.y,w.z,w.z-5)||this._retainChildren(w.x,w.y,w.z,w.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var h in this._tiles)this._tiles[h].coords.z===c&&this._removeTile(h)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)Kt(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,h,y,w){var A=Math.floor(c/2),B=Math.floor(h/2),q=y-1,X=new H(+A,+B);X.z=+q;var te=this._tileCoordsToKey(X),de=this._tiles[te];return de&&de.active?(de.retain=!0,!0):(de&&de.loaded&&(de.retain=!0),q>w?this._retainParent(A,B,q,w):!1)},_retainChildren:function(c,h,y,w){for(var A=2*c;A<2*c+2;A++)for(var B=2*h;B<2*h+2;B++){var q=new H(A,B);q.z=y+1;var X=this._tileCoordsToKey(q),te=this._tiles[X];if(te&&te.active){te.retain=!0;continue}else te&&te.loaded&&(te.retain=!0);y+1<w&&this._retainChildren(A,B,y+1,w)}},_resetView:function(c){var h=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var h=this.options;return h.minNativeZoom!==void 0&&c<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<c?h.maxNativeZoom:c},_setView:function(c,h,y,w){var A=Math.round(h);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var B=this.options.updateWhenZooming&&A!==this._tileZoom;(!w||B)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(c),y||this._pruneTiles(),this._noPrune=!!y),this._setZoomTransforms(c,h)},_setZoomTransforms:function(c,h){for(var y in this._levels)this._setZoomTransform(this._levels[y],c,h)},_setZoomTransform:function(c,h,y){var w=this._map.getZoomScale(y,c.zoom),A=c.origin.multiplyBy(w).subtract(this._map._getNewPixelOrigin(h,y)).round();He.any3d?Di(c.el,A,w):it(c.el,A)},_resetGrid:function(){var c=this._map,h=c.options.crs,y=this._tileSize=this.getTileSize(),w=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,h.wrapLng[0]],w).x/y.x),Math.ceil(c.project([0,h.wrapLng[1]],w).x/y.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([h.wrapLat[0],0],w).y/y.x),Math.ceil(c.project([h.wrapLat[1],0],w).y/y.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var h=this._map,y=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),w=h.getZoomScale(y,this._tileZoom),A=h.project(c,this._tileZoom).floor(),B=h.getSize().divideBy(w*2);return new re(A.subtract(B),A.add(B))},_update:function(c){var h=this._map;if(h){var y=this._clampZoom(h.getZoom());if(c===void 0&&(c=h.getCenter()),this._tileZoom!==void 0){var w=this._getTiledPixelBounds(c),A=this._pxBoundsToTileRange(w),B=A.getCenter(),q=[],X=this.options.keepBuffer,te=new re(A.getBottomLeft().subtract([X,-X]),A.getTopRight().add([X,-X]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var de in this._tiles){var Re=this._tiles[de].coords;(Re.z!==this._tileZoom||!te.contains(new H(Re.x,Re.y)))&&(this._tiles[de].current=!1)}if(Math.abs(y-this._tileZoom)>1){this._setView(c,y);return}for(var Je=A.min.y;Je<=A.max.y;Je++)for(var gt=A.min.x;gt<=A.max.x;gt++){var Dr=new H(gt,Je);if(Dr.z=this._tileZoom,!!this._isValidTile(Dr)){var er=this._tiles[this._tileCoordsToKey(Dr)];er?er.current=!0:q.push(Dr)}}if(q.sort(function(Xr,Qu){return Xr.distanceTo(B)-Qu.distanceTo(B)}),q.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Hs=document.createDocumentFragment();for(gt=0;gt<q.length;gt++)this._addTile(q[gt],Hs);this._level.el.appendChild(Hs)}}}},_isValidTile:function(c){var h=this._map.options.crs;if(!h.infinite){var y=this._globalTileRange;if(!h.wrapLng&&(c.x<y.min.x||c.x>y.max.x)||!h.wrapLat&&(c.y<y.min.y||c.y>y.max.y))return!1}if(!this.options.bounds)return!0;var w=this._tileCoordsToBounds(c);return Me(this.options.bounds).overlaps(w)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var h=this._map,y=this.getTileSize(),w=c.scaleBy(y),A=w.add(y),B=h.unproject(w,c.z),q=h.unproject(A,c.z);return[B,q]},_tileCoordsToBounds:function(c){var h=this._tileCoordsToNwSe(c),y=new ye(h[0],h[1]);return this.options.noWrap||(y=this._map.wrapLatLngBounds(y)),y},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var h=c.split(":"),y=new H(+h[0],+h[1]);return y.z=+h[2],y},_removeTile:function(c){var h=this._tiles[c];h&&(Kt(h.el),delete this._tiles[c],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){ct(c,"leaflet-tile");var h=this.getTileSize();c.style.width=h.x+"px",c.style.height=h.y+"px",c.onselectstart=m,c.onmousemove=m,He.ielt9&&this.options.opacity<1&&Nn(c,this.options.opacity)},_addTile:function(c,h){var y=this._getTilePos(c),w=this._tileCoordsToKey(c),A=this.createTile(this._wrapCoords(c),a(this._tileReady,this,c));this._initTile(A),this.createTile.length<2&&z(a(this._tileReady,this,c,null,A)),it(A,y),this._tiles[w]={el:A,coords:c,current:!0},h.appendChild(A),this.fire("tileloadstart",{tile:A,coords:c})},_tileReady:function(c,h,y){h&&this.fire("tileerror",{error:h,tile:y,coords:c});var w=this._tileCoordsToKey(c);y=this._tiles[w],y&&(y.loaded=+new Date,this._map._fadeAnimated?(Nn(y.el,0),D(this._fadeFrame),this._fadeFrame=z(this._updateOpacity,this)):(y.active=!0,this._pruneTiles()),h||(ct(y.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:y.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),He.ielt9||!this._map._fadeAnimated?z(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var h=new H(this._wrapX?f(c.x,this._wrapX):c.x,this._wrapY?f(c.y,this._wrapY):c.y);return h.z=c.z,h},_pxBoundsToTileRange:function(c){var h=this.getTileSize();return new re(c.min.unscaleBy(h).floor(),c.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});function Vz(c){return new Nf(c)}var Ku=Nf.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(c,h){this._url=c,h=_(this,h),h.detectRetina&&He.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(c,h){return this._url===c&&h===void 0&&(h=!0),this._url=c,h||this.redraw(),this},createTile:function(c,h){var y=document.createElement("img");return Xe(y,"load",a(this._tileOnLoad,this,h,y)),Xe(y,"error",a(this._tileOnError,this,h,y)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(y.referrerPolicy=this.options.referrerPolicy),y.alt="",y.src=this.getTileUrl(c),y},getTileUrl:function(c){var h={r:He.retina?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var y=this._globalTileRange.max.y-c.y;this.options.tms&&(h.y=y),h["-y"]=y}return b(this._url,s(h,this.options))},_tileOnLoad:function(c,h){He.ielt9?setTimeout(a(c,this,null,h),0):c(null,h)},_tileOnError:function(c,h,y){var w=this.options.errorTileUrl;w&&h.getAttribute("src")!==w&&(h.src=w),c(y,h)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom,h=this.options.maxZoom,y=this.options.zoomReverse,w=this.options.zoomOffset;return y&&(c=h-c),c+w},_getSubdomain:function(c){var h=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var c,h;for(c in this._tiles)if(this._tiles[c].coords.z!==this._tileZoom&&(h=this._tiles[c].el,h.onload=m,h.onerror=m,!h.complete)){h.src=P;var y=this._tiles[c].coords;Kt(h),delete this._tiles[c],this.fire("tileabort",{tile:h,coords:y})}},_removeTile:function(c){var h=this._tiles[c];if(h)return h.el.setAttribute("src",P),Nf.prototype._removeTile.call(this,c)},_tileReady:function(c,h,y){if(!(!this._map||y&&y.getAttribute("src")===P))return Nf.prototype._tileReady.call(this,c,h,y)}});function m2(c,h){return new Ku(c,h)}var p2=Ku.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,h){this._url=c;var y=s({},this.defaultWmsParams);for(var w in h)w in this.options||(y[w]=h[w]);h=_(this,h);var A=h.detectRetina&&He.retina?2:1,B=this.getTileSize();y.width=B.x*A,y.height=B.y*A,this.wmsParams=y},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,Ku.prototype.onAdd.call(this,c)},getTileUrl:function(c){var h=this._tileCoordsToNwSe(c),y=this._crs,w=he(y.project(h[0]),y.project(h[1])),A=w.min,B=w.max,q=(this._wmsVersion>=1.3&&this._crs===Vn?[A.y,A.x,B.y,B.x]:[A.x,A.y,B.x,B.y]).join(","),X=Ku.prototype.getTileUrl.call(this,c);return X+E(this.wmsParams,X,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+q},setParams:function(c,h){return s(this.wmsParams,c),h||this.redraw(),this}});function Fz(c,h){return new p2(c,h)}Ku.WMS=p2,m2.wms=Fz;var Co=qt.extend({options:{padding:.1},initialize:function(c){_(this,c),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,h){var y=this._map.getZoomScale(h,this._zoom),w=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,h),B=w.multiplyBy(-y).add(A).subtract(this._map._getNewPixelOrigin(c,h));He.any3d?Di(this._container,B,y):it(this._container,B)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var c in this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,h=this._map.getSize(),y=this._map.containerPointToLayerPoint(h.multiplyBy(-c)).round();this._bounds=new re(y,y.add(h.multiplyBy(1+c*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),g2=Co.extend({options:{tolerance:0},getEvents:function(){var c=Co.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Co.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");Xe(c,"mousemove",this._onMouseMove,this),Xe(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Xe(c,"mouseout",this._handleMouseOut,this),c._leaflet_disable_events=!0,this._ctx=c.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,Kt(this._container),Ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var c;this._redrawBounds=null;for(var h in this._layers)c=this._layers[h],c._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Co.prototype._update.call(this);var c=this._bounds,h=this._container,y=c.getSize(),w=He.retina?2:1;it(h,c.min),h.width=w*y.x,h.height=w*y.y,h.style.width=y.x+"px",h.style.height=y.y+"px",He.retina&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){Co.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[u(c)]=c;var h=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var h=c._order,y=h.next,w=h.prev;y?y.prev=w:this._drawLast=w,w?w.next=y:this._drawFirst=y,delete c._order,delete this._layers[u(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if(typeof c.options.dashArray=="string"){var h=c.options.dashArray.split(/[, ]+/),y=[],w,A;for(A=0;A<h.length;A++){if(w=Number(h[A]),isNaN(w))return;y.push(w)}c.options._dashArray=y}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){this._map&&(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||z(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var h=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new re,this._redrawBounds.extend(c._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(c._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var h=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,h=this._redrawBounds;if(this._ctx.save(),h){var y=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,y.x,y.y),this._ctx.clip()}this._drawing=!0;for(var w=this._drawFirst;w;w=w.next)c=w.layer,(!h||c._pxBounds&&c._pxBounds.intersects(h))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,h){if(this._drawing){var y,w,A,B,q=c._parts,X=q.length,te=this._ctx;if(X){for(te.beginPath(),y=0;y<X;y++){for(w=0,A=q[y].length;w<A;w++)B=q[y][w],te[w?"lineTo":"moveTo"](B.x,B.y);h&&te.closePath()}this._fillStroke(te,c)}}},_updateCircle:function(c){if(!(!this._drawing||c._empty())){var h=c._point,y=this._ctx,w=Math.max(Math.round(c._radius),1),A=(Math.max(Math.round(c._radiusY),1)||w)/w;A!==1&&(y.save(),y.scale(1,A)),y.beginPath(),y.arc(h.x,h.y/A,w,0,Math.PI*2,!1),A!==1&&y.restore(),this._fillStroke(y,c)}},_fillStroke:function(c,h){var y=h.options;y.fill&&(c.globalAlpha=y.fillOpacity,c.fillStyle=y.fillColor||y.color,c.fill(y.fillRule||"evenodd")),y.stroke&&y.weight!==0&&(c.setLineDash&&c.setLineDash(h.options&&h.options._dashArray||[]),c.globalAlpha=y.opacity,c.lineWidth=y.weight,c.strokeStyle=y.color,c.lineCap=y.lineCap,c.lineJoin=y.lineJoin,c.stroke())},_onClick:function(c){for(var h=this._map.mouseEventToLayerPoint(c),y,w,A=this._drawFirst;A;A=A.next)y=A.layer,y.options.interactive&&y._containsPoint(h)&&(!(c.type==="click"||c.type==="preclick")||!this._map._draggableMoved(y))&&(w=y);this._fireEvent(w?[w]:!1,c)},_onMouseMove:function(c){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,h)}},_handleMouseOut:function(c){var h=this._hoveredLayer;h&&(cn(this._container,"leaflet-interactive"),this._fireEvent([h],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,h){if(!this._mouseHoverThrottled){for(var y,w,A=this._drawFirst;A;A=A.next)y=A.layer,y.options.interactive&&y._containsPoint(h)&&(w=y);w!==this._hoveredLayer&&(this._handleMouseOut(c),w&&(ct(this._container,"leaflet-interactive"),this._fireEvent([w],c,"mouseover"),this._hoveredLayer=w)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,c),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,h,y){this._map._fireDOMEvent(h,y||h.type,c)},_bringToFront:function(c){var h=c._order;if(h){var y=h.next,w=h.prev;if(y)y.prev=w;else return;w?w.next=y:y&&(this._drawFirst=y),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(c)}},_bringToBack:function(c){var h=c._order;if(h){var y=h.next,w=h.prev;if(w)w.next=y;else return;y?y.prev=w:w&&(this._drawLast=w),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(c)}}});function y2(c){return He.canvas?new g2(c):null}var Sf=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch{}return function(c){return document.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),zz={_initContainer:function(){this._container=kt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Co.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var h=c._container=Sf("shape");ct(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",c._path=Sf("path"),h.appendChild(c._path),this._updateStyle(c),this._layers[u(c)]=c},_addPath:function(c){var h=c._container;this._container.appendChild(h),c.options.interactive&&c.addInteractiveTarget(h)},_removePath:function(c){var h=c._container;Kt(h),c.removeInteractiveTarget(h),delete this._layers[u(c)]},_updateStyle:function(c){var h=c._stroke,y=c._fill,w=c.options,A=c._container;A.stroked=!!w.stroke,A.filled=!!w.fill,w.stroke?(h||(h=c._stroke=Sf("stroke")),A.appendChild(h),h.weight=w.weight+"px",h.color=w.color,h.opacity=w.opacity,w.dashArray?h.dashStyle=S(w.dashArray)?w.dashArray.join(" "):w.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=w.lineCap.replace("butt","flat"),h.joinstyle=w.lineJoin):h&&(A.removeChild(h),c._stroke=null),w.fill?(y||(y=c._fill=Sf("fill")),A.appendChild(y),y.color=w.fillColor||w.color,y.opacity=w.fillOpacity):y&&(A.removeChild(y),c._fill=null)},_updateCircle:function(c){var h=c._point.round(),y=Math.round(c._radius),w=Math.round(c._radiusY||y);this._setPath(c,c._empty()?"M0 0":"AL "+h.x+","+h.y+" "+y+","+w+" 0,"+65535*360)},_setPath:function(c,h){c._path.v=h},_bringToFront:function(c){_o(c._container)},_bringToBack:function(c){ya(c._container)}},ay=He.vml?Sf:Dt,Tf=Co.extend({_initContainer:function(){this._container=ay("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ay("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Kt(this._container),Ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Co.prototype._update.call(this);var c=this._bounds,h=c.getSize(),y=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,y.setAttribute("width",h.x),y.setAttribute("height",h.y)),it(y,c.min),y.setAttribute("viewBox",[c.min.x,c.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(c){var h=c._path=ay("path");c.options.className&&ct(h,c.options.className),c.options.interactive&&ct(h,"leaflet-interactive"),this._updateStyle(c),this._layers[u(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){Kt(c._path),c.removeInteractiveTarget(c._path),delete this._layers[u(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var h=c._path,y=c.options;h&&(y.stroke?(h.setAttribute("stroke",y.color),h.setAttribute("stroke-opacity",y.opacity),h.setAttribute("stroke-width",y.weight),h.setAttribute("stroke-linecap",y.lineCap),h.setAttribute("stroke-linejoin",y.lineJoin),y.dashArray?h.setAttribute("stroke-dasharray",y.dashArray):h.removeAttribute("stroke-dasharray"),y.dashOffset?h.setAttribute("stroke-dashoffset",y.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),y.fill?(h.setAttribute("fill",y.fillColor||y.color),h.setAttribute("fill-opacity",y.fillOpacity),h.setAttribute("fill-rule",y.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(c,h){this._setPath(c,dr(c._parts,h))},_updateCircle:function(c){var h=c._point,y=Math.max(Math.round(c._radius),1),w=Math.max(Math.round(c._radiusY),1)||y,A="a"+y+","+w+" 0 1,0 ",B=c._empty()?"M0 0":"M"+(h.x-y)+","+h.y+A+y*2+",0 "+A+-y*2+",0 ";this._setPath(c,B)},_setPath:function(c,h){c._path.setAttribute("d",h)},_bringToFront:function(c){_o(c._path)},_bringToBack:function(c){ya(c._path)}});He.vml&&Tf.include(zz);function x2(c){return He.svg||He.vml?new Tf(c):null}_t.include({getRenderer:function(c){var h=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(c){if(c==="overlayPane"||c===void 0)return!1;var h=this._paneRenderers[c];return h===void 0&&(h=this._createRenderer({pane:c}),this._paneRenderers[c]=h),h},_createRenderer:function(c){return this.options.preferCanvas&&y2(c)||x2(c)}});var v2=Hu.extend({initialize:function(c,h){Hu.prototype.initialize.call(this,this._boundsToLatLngs(c),h)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return c=Me(c),[c.getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});function Bz(c,h){return new v2(c,h)}Tf.create=ay,Tf.pointsToPath=dr,Eo.geometryToLayer=ey,Eo.coordsToLatLng=Vb,Eo.coordsToLatLngs=ty,Eo.latLngToCoords=Fb,Eo.latLngsToCoords=ny,Eo.getFeature=Gu,Eo.asFeature=ry,_t.mergeOptions({boxZoom:!0});var b2=vs.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){Xe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Kt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||c.which!==1&&c.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),di(),cf(),this._startPoint=this._map.mouseEventToContainerPoint(c),Xe(document,{contextmenu:xs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=kt("div","leaflet-zoom-box",this._container),ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var h=new re(this._point,this._startPoint),y=h.getSize();it(this._box,h.min),this._box.style.width=y.x+"px",this._box.style.height=y.y+"px"},_finish:function(){this._moved&&(Kt(this._box),cn(this._container,"leaflet-crosshair")),hi(),uf(),Ut(document,{contextmenu:xs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if(!(c.which!==1&&c.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var h=new ye(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(c){c.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});_t.addInitHook("addHandler","boxZoom",b2),_t.mergeOptions({doubleClickZoom:!0});var _2=vs.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var h=this._map,y=h.getZoom(),w=h.options.zoomDelta,A=c.originalEvent.shiftKey?y-w:y+w;h.options.doubleClickZoom==="center"?h.setZoom(A):h.setZoomAround(c.containerPoint,A)}});_t.addInitHook("addHandler","doubleClickZoom",_2),_t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var w2=vs.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new fi(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cn(this._map._container,"leaflet-grab"),cn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=Me(this._map.options.maxBounds);this._offsetLimit=he(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var h=this._lastTime=+new Date,y=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(y),this._times.push(h),this._prunePositions(h)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,h){return c-(c-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var c=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;c.x<h.min.x&&(c.x=this._viscousLimit(c.x,h.min.x)),c.y<h.min.y&&(c.y=this._viscousLimit(c.y,h.min.y)),c.x>h.max.x&&(c.x=this._viscousLimit(c.x,h.max.x)),c.y>h.max.y&&(c.y=this._viscousLimit(c.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,h=Math.round(c/2),y=this._initialWorldOffset,w=this._draggable._newPos.x,A=(w-h+y)%c+h-y,B=(w+h+y)%c-h-y,q=Math.abs(A+y)<Math.abs(B+y)?A:B;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=q},_onDragEnd:function(c){var h=this._map,y=h.options,w=!y.inertia||c.noInertia||this._times.length<2;if(h.fire("dragend",c),w)h.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),B=(this._lastTime-this._times[0])/1e3,q=y.easeLinearity,X=A.multiplyBy(q/B),te=X.distanceTo([0,0]),de=Math.min(y.inertiaMaxSpeed,te),Re=X.multiplyBy(de/te),Je=de/(y.inertiaDeceleration*q),gt=Re.multiplyBy(-Je/2).round();!gt.x&&!gt.y?h.fire("moveend"):(gt=h._limitOffset(gt,h.options.maxBounds),z(function(){h.panBy(gt,{duration:Je,easeLinearity:q,noMoveStart:!0,animate:!0})}))}}});_t.addInitHook("addHandler","dragging",w2),_t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var k2=vs.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),Xe(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,h=document.documentElement,y=c.scrollTop||h.scrollTop,w=c.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(w,y)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var h=this._panKeys={},y=this.keyCodes,w,A;for(w=0,A=y.left.length;w<A;w++)h[y.left[w]]=[-1*c,0];for(w=0,A=y.right.length;w<A;w++)h[y.right[w]]=[c,0];for(w=0,A=y.down.length;w<A;w++)h[y.down[w]]=[0,c];for(w=0,A=y.up.length;w<A;w++)h[y.up[w]]=[0,-1*c]},_setZoomDelta:function(c){var h=this._zoomKeys={},y=this.keyCodes,w,A;for(w=0,A=y.zoomIn.length;w<A;w++)h[y.zoomIn[w]]=c;for(w=0,A=y.zoomOut.length;w<A;w++)h[y.zoomOut[w]]=-c},_addHooks:function(){Xe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var h=c.keyCode,y=this._map,w;if(h in this._panKeys){if(!y._panAnim||!y._panAnim._inProgress)if(w=this._panKeys[h],c.shiftKey&&(w=W(w).multiplyBy(3)),y.options.maxBounds&&(w=y._limitOffset(W(w),y.options.maxBounds)),y.options.worldCopyJump){var A=y.wrapLatLng(y.unproject(y.project(y.getCenter()).add(w)));y.panTo(A)}else y.panBy(w)}else if(h in this._zoomKeys)y.setZoom(y.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&y._popup&&y._popup.options.closeOnEscapeKey)y.closePopup();else return;xs(c)}}});_t.addInitHook("addHandler","keyboard",k2),_t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var N2=vs.extend({addHooks:function(){Xe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var h=Wg(c),y=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var w=Math.max(y-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),w),xs(c)},_performZoom:function(){var c=this._map,h=c.getZoom(),y=this._map.options.zoomSnap||0;c._stop();var w=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(w))))/Math.LN2,B=y?Math.ceil(A/y)*y:A,q=c._limitZoom(h+(this._delta>0?B:-B))-h;this._delta=0,this._startTime=null,q&&(c.options.scrollWheelZoom==="center"?c.setZoom(h+q):c.setZoomAround(this._lastMousePos,h+q))}});_t.addInitHook("addHandler","scrollWheelZoom",N2);var $z=600;_t.mergeOptions({tapHold:He.touchNative&&He.safari&&He.mobile,tapTolerance:15});var S2=vs.extend({addHooks:function(){Xe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(clearTimeout(this._holdTimeout),c.touches.length===1){var h=c.touches[0];this._startPos=this._newPos=new H(h.clientX,h.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(Xe(document,"touchend",fn),Xe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),$z),Xe(document,"touchend touchcancel contextmenu",this._cancel,this),Xe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function c(){Ut(document,"touchend",fn),Ut(document,"touchend touchcancel",c)},_cancel:function(){clearTimeout(this._holdTimeout),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)},_onMove:function(c){var h=c.touches[0];this._newPos=new H(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(c,h){var y=new MouseEvent(c,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});y._simulated=!0,h.target.dispatchEvent(y)}});_t.addInitHook("addHandler","tapHold",S2),_t.mergeOptions({touchZoom:He.touch,bounceAtZoomLimits:!0});var T2=vs.extend({addHooks:function(){ct(this._map._container,"leaflet-touch-zoom"),Xe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cn(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var h=this._map;if(!(!c.touches||c.touches.length!==2||h._animatingZoom||this._zooming)){var y=h.mouseEventToContainerPoint(c.touches[0]),w=h.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(y.add(w)._divideBy(2))),this._startDist=y.distanceTo(w),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),Xe(document,"touchmove",this._onTouchMove,this),Xe(document,"touchend touchcancel",this._onTouchEnd,this),fn(c)}},_onTouchMove:function(c){if(!(!c.touches||c.touches.length!==2||!this._zooming)){var h=this._map,y=h.mouseEventToContainerPoint(c.touches[0]),w=h.mouseEventToContainerPoint(c.touches[1]),A=y.distanceTo(w)/this._startDist;if(this._zoom=h.getScaleZoom(A,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&A<1||this._zoom>h.getMaxZoom()&&A>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var B=y._add(w)._divideBy(2)._subtract(this._centerPoint);if(A===1&&B.x===0&&B.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(B),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var q=a(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=z(q,this,!0),fn(c)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,D(this._animRequest),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});_t.addInitHook("addHandler","touchZoom",T2),_t.BoxZoom=b2,_t.DoubleClickZoom=_2,_t.Drag=w2,_t.Keyboard=k2,_t.ScrollWheelZoom=N2,_t.TapHold=S2,_t.TouchZoom=T2,n.Bounds=re,n.Browser=He,n.CRS=le,n.Canvas=g2,n.Circle=Db,n.CircleMarker=Jg,n.Class=ee,n.Control=Yr,n.DivIcon=f2,n.DivOverlay=zi,n.DomEvent=Hg,n.DomUtil=Ug,n.Draggable=fi,n.Evented=ae,n.FeatureGroup=An,n.GeoJSON=Eo,n.GridLayer=Nf,n.Handler=vs,n.Icon=Fi,n.ImageOverlay=sy,n.LatLng=Fe,n.LatLngBounds=ye,n.Layer=qt,n.LayerGroup=mn,n.LineUtil=$,n.Map=_t,n.Marker=Xg,n.Mixin=Zl,n.Path=ka,n.Point=H,n.PolyUtil=Uu,n.Polygon=Hu,n.Polyline=To,n.Popup=iy,n.PosAnimation=yf,n.Projection=Se,n.Rectangle=v2,n.Renderer=Co,n.SVG=Tf,n.SVGOverlay=h2,n.TileLayer=Ku,n.Tooltip=oy,n.Transformation=Ae,n.Util=F,n.VideoOverlay=d2,n.bind=a,n.bounds=he,n.canvas=y2,n.circle=Cz,n.circleMarker=Ez,n.control=Or,n.divIcon=Dz,n.extend=s,n.featureGroup=Wu,n.geoJSON=u2,n.geoJson=Az,n.gridLayer=Vz,n.icon=Sz,n.imageOverlay=Rz,n.latLng=G,n.latLngBounds=Me,n.layerGroup=wa,n.map=Du,n.marker=Tz,n.point=W,n.polygon=Iz,n.polyline=jz,n.popup=Mz,n.rectangle=Bz,n.setOptions=_,n.stamp=u,n.svg=x2,n.svgOverlay=Lz,n.tileLayer=m2,n.tooltip=Oz,n.transformation=Ge,n.version=r,n.videoOverlay=Pz;var Uz=window.L;n.noConflict=function(){return window.L=Uz,this},window.L=n})})(U1,U1.exports);var Zh=U1.exports;const F6=WP(Zh);function Eb(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function Cb(t,e){return e==null?function(r,s){const i=N.useRef();return i.current||(i.current=t(r,s)),i}:function(r,s){const i=N.useRef();i.current||(i.current=t(r,s));const a=N.useRef(r),{instance:l}=i.current;return N.useEffect(function(){a.current!==r&&(e(l,r,a.current),a.current=r)},[l,r,s]),i}}function z6(t,e){N.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var i;(i=e.layerContainer)==null||i.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function B6(t){return function(n){const r=Sb(),s=t(Tb(n,r),r);return L6(r.map,n.attribution),ZE(s.current,n.eventHandlers),z6(s.current,r),s}}function Xle(t,e){const n=N.useRef();N.useEffect(function(){if(e.pathOptions!==n.current){const s=e.pathOptions??{};t.instance.setStyle(s),n.current=s}},[t,e])}function Jle(t){return function(n){const r=Sb(),s=t(Tb(n,r),r);return ZE(s.current,n.eventHandlers),z6(s.current,r),Xle(s.current,n),s}}function ece(t,e){const n=Cb(t,e),r=B6(n);return V6(r)}function tce(t,e){const n=Cb(t),r=Yle(n,e);return Qle(r)}function nce(t,e){const n=Cb(t,e),r=Jle(n);return V6(r)}function rce(t,e){const n=Cb(t,e),r=B6(n);return Zle(r)}function sce(t,e,n){const{opacity:r,zIndex:s}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),s!=null&&s!==n.zIndex&&t.setZIndex(s)}function $6(){return Sb().map}const Cx=nce(function({center:e,children:n,...r},s){const i=new Zh.Circle(e,r);return Eb(i,M6(s,{overlayContainer:i}))},Hle);function q1(){return q1=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},q1.apply(this,arguments)}function ice({bounds:t,boundsOptions:e,center:n,children:r,className:s,id:i,placeholder:a,style:l,whenReady:u,zoom:d,...f},m){const[p]=N.useState({className:s,id:i,style:l}),[v,x]=N.useState(null);N.useImperativeHandle(m,()=>(v==null?void 0:v.map)??null,[v]);const _=N.useCallback(k=>{if(k!==null&&v===null){const b=new Zh.Map(k,f);n!=null&&d!=null?b.setView(n,d):t!=null&&b.fitBounds(t,e),u!=null&&b.whenReady(u),x(Kle(b))}},[]);N.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const E=v?Ve.createElement(D6,{value:v},r):a??null;return Ve.createElement("div",q1({},p,{ref:_}),E)}const U6=N.forwardRef(ice),oce=ece(function({position:e,...n},r){const s=new Zh.Marker(e,n);return Eb(s,M6(r,{overlayContainer:s}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),ace=tce(function(e,n){const r=new Zh.Popup(e,n.overlayContainer);return Eb(r,n)},function(e,n,{position:r},s){N.useEffect(function(){const{instance:a}=e;function l(d){d.popup===a&&(a.update(),s(!0))}function u(d){d.popup===a&&s(!1)}return n.map.on({popupopen:l,popupclose:u}),n.overlayContainer==null?(r!=null&&a.setLatLng(r),a.openOn(n.map)):n.overlayContainer.bindPopup(a),function(){var f;n.map.off({popupopen:l,popupclose:u}),(f=n.overlayContainer)==null||f.unbindPopup(),n.map.removeLayer(a)}},[e,n,s,r])}),q6=rce(function({url:e,...n},r){const s=new Zh.TileLayer(e,Tb(n,r));return Eb(s,r)},function(e,n,r){sce(e,n,r);const{url:s}=n;s!=null&&s!==r.url&&e.setUrl(s)}),jb=async t=>{if(!t||t.length<5)return null;try{const e=await fetch(`https://api.zippopotam.us/us/${t}`);if(!e.ok)return null;const r=(await e.json()).places[0];return{lat:parseFloat(r.latitude),lng:parseFloat(r.longitude),name:r["place name"],state:r["state abbreviation"],cityState:`${r["place name"]}, ${r["state abbreviation"]}`}}catch(e){return console.warn("Geocoding failed:",e),null}},lce=async t=>{if(!t||t.length<3)return{count:0,density:"#6B7280",label:"Scanning..."};try{const e=t.substring(0,3),n=e+"",r=Ce(Y,"artifacts",qe,"public","data","profiles"),s=mt(r,zt("zip",">=",e),zt("zip","<=",n)),a=(await fT(s)).data().count;let l="#3D84ED",u="Quiet Area";return a>25&&(l="#10B981",u="Active Area"),a>100&&(l="#F59E0B",u="Buzzing"),a>500&&(l="#EF4444",u="Hotspot"),{count:a,density:l,label:u}}catch(e){return console.warn("Regional stats failed:",e),{count:0,density:"#9CA3AF",label:"Unknown Region"}}};function W6({isEmbedded:t=!1}){const[e,n]=N.useState("tos"),r=[{id:"tos",label:"Terms of Service",icon:Nl},{id:"privacy",label:"Privacy Policy",icon:Vl},{id:"cookies",label:"Cookie Policy",icon:fne},{id:"dmca",label:"DMCA & Copyright",icon:uo}];return o.jsxs("div",{className:`flex flex-col md:flex-row bg-white dark:bg-[#1f2128] h-full ${t?"":"max-w-6xl mx-auto rounded-2xl shadow-xl border dark:border-gray-700 overflow-hidden my-8 min-h-[600px]"}`,children:[o.jsxs("div",{className:"w-full md:w-72 bg-gray-50 dark:bg-[#23262f] border-r dark:border-gray-700 flex flex-col shrink-0",children:[!t&&o.jsx("div",{className:"p-6 border-b dark:border-gray-700",children:o.jsxs("h2",{className:"text-2xl font-extrabold dark:text-white flex items-center gap-2",children:[o.jsx(uo,{className:"text-brand-blue"})," Legal Center"]})}),o.jsx("div",{className:"p-4 space-y-1 overflow-y-auto flex-1",children:r.map(s=>o.jsxs("button",{onClick:()=>n(s.id),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all duration-200 group text-left
                            ${e===s.id?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm border border-gray-200 dark:border-gray-600":"text-gray-600 dark:text-gray-400 hover:bg-gray-200/50 dark:hover:bg-white/5"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(s.icon,{size:18,className:e===s.id?"text-brand-blue":"text-gray-400 group-hover:text-gray-500"}),o.jsx("span",{className:"font-bold text-sm",children:s.label})]}),e===s.id&&o.jsx(lo,{size:16,className:"text-brand-blue"})]},s.id))}),o.jsxs("div",{className:"p-6 bg-blue-50 dark:bg-blue-900/10 border-t border-blue-100 dark:border-blue-800/30",children:[o.jsxs("div",{className:"flex items-center gap-2 text-blue-700 dark:text-blue-400 font-bold text-xs mb-2",children:[o.jsx(_g,{size:14})," US Compliance Standard"]}),o.jsx("p",{className:"text-[10px] text-blue-600 dark:text-blue-300 leading-relaxed opacity-80",children:"Documents compliant with CCPA, DMCA, and federal payment regulations."})]})]}),o.jsx("div",{className:"flex-1 bg-white dark:bg-[#1f2128] relative overflow-hidden flex flex-col",children:o.jsx("div",{className:"flex-1 overflow-y-auto p-6 md:p-12 custom-scrollbar",children:o.jsxs("div",{className:"max-w-3xl mx-auto animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e==="tos"&&o.jsx(cce,{}),e==="privacy"&&o.jsx(uce,{}),e==="cookies"&&o.jsx(dce,{}),e==="dmca"&&o.jsx(hce,{}),o.jsx("div",{className:"mt-20 pt-8 border-t dark:border-gray-800",children:o.jsx("p",{className:"text-xs text-gray-400 text-center font-medium",children:"Last updated: November 29, 2025  SeshNx Legal Department"})})]})})})]})}const Ib=({children:t})=>o.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-white mb-8 tracking-tight",children:t}),ks=({title:t,children:e})=>o.jsxs("div",{className:"mb-10",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:t}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300 leading-7 text-sm md:text-base space-y-4",children:e})]}),Bp=({items:t})=>o.jsx("ul",{className:"space-y-2 mt-2",children:t.map((e,n)=>o.jsxs("li",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"mt-2 w-1.5 h-1.5 rounded-full bg-brand-blue shrink-0"}),o.jsx("span",{dangerouslySetInnerHTML:{__html:e}})]},n))}),cce=()=>o.jsxs(o.Fragment,{children:[o.jsx(Ib,{children:"Terms of Service"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"Welcome to SeshNx. By accessing or using our platform, you agree to be bound by these Terms of Service. Please read them carefully."}),o.jsx(ks,{title:"1. Platform Services",children:o.jsx("p",{children:'SeshNx provides a marketplace and collaboration tool for music professionals ("Creatives") and educational institutions ("Schools"). We facilitate bookings, payments, and content sharing but are not a party to the actual service contracts between users.'})}),o.jsx(ks,{title:"2. User Accounts",children:o.jsx("p",{children:"You are responsible for maintaining the confidentiality of your account credentials. You must be at least 13 years old to use SeshNx. Users under 18 require parental consent or School authorization to participate in educational programs."})}),o.jsxs(ks,{title:"3. Payments & Fees",children:[o.jsxs("p",{children:["Payments are processed securely via Stripe. By using our payment features, you agree to the ",o.jsx("a",{href:"https://stripe.com/connect-account/legal",target:"_blank",rel:"noreferrer",className:"text-brand-blue hover:underline font-bold",children:"Stripe Connected Account Agreement"}),"."]}),o.jsx("p",{children:"SeshNx charges a platform fee on transactions (ranging from 0% to 20% depending on your subscription tier), which is automatically deducted at the time of payout."})]}),o.jsx(ks,{title:"4. User Generated Content",children:o.jsx("p",{children:"You retain full ownership of the content you upload (audio, images, text). By uploading, you grant SeshNx a non-exclusive, worldwide license to display, transcode, and distribute your content strictly for the purpose of operating the service."})}),o.jsxs(ks,{title:"5. Prohibited Conduct",children:[o.jsx("p",{children:"You agree not to use SeshNx for:"}),o.jsx(Bp,{items:["Harassment, hate speech, or bullying.","Distribution of malware or unauthorized automated scraping.","Fraudulent transactions or money laundering.","Copyright infringement or uploading content you do not own."]}),o.jsx("p",{className:"mt-2",children:"We reserve the right to suspend or ban accounts violating these rules without prior notice."})]})]}),uce=()=>o.jsxs(o.Fragment,{children:[o.jsx(Ib,{children:"Privacy Policy"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"Your privacy is critical to us. This policy explains how we collect, use, and share your data in compliance with US and international standards."}),o.jsx(ks,{title:"1. Information We Collect",children:o.jsx(Bp,{items:["<strong>Account Data:</strong> Name, email, password (hashed), and profile bio.","<strong>Financial Data:</strong> Bank account and tax info (processed and stored securely via Stripe; SeshNx does not store full credit card numbers).","<strong>Usage Data:</strong> Location (for studio search), IP address, and browser type.","<strong>Content:</strong> Direct messages, audio files, and images you upload."]})}),o.jsx(ks,{title:"2. How We Use Information",children:o.jsx("p",{children:"We use your data to: provide and personalize services, process payments, verify student enrollment with partner schools, improve platform performance, and comply with legal obligations."})}),o.jsxs(ks,{title:"3. Data Sharing",children:[o.jsx("p",{children:"We do not sell your personal data. We only share data with:"}),o.jsx(Bp,{items:["<strong>Service Providers:</strong> Google (Hosting/Auth), Stripe (Payments).","<strong>Educational Institutions:</strong> If you link a student account, your School Administrators can view your internship activity logs.","<strong>Legal Authorities:</strong> When required by valid legal process or subpoena."]})]}),o.jsx(ks,{title:"4. CCPA / California Rights",children:o.jsxs("p",{children:["California residents have the right to request access to or deletion of their personal data. Please contact ",o.jsx("strong",{children:"legal@seshnx.com"})," to exercise these rights."]})})]}),dce=()=>o.jsxs(o.Fragment,{children:[o.jsx(Ib,{children:"Cookie Policy"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"SeshNx uses cookies to enhance your experience. By using our site, you consent to our use of cookies."}),o.jsx(ks,{title:"Types of Cookies We Use",children:o.jsx(Bp,{items:["<strong>Essential Cookies:</strong> Required for login authentication (e.g., Firebase Auth tokens). The site cannot function without these.","<strong>Functional Cookies:</strong> Remember your preferences, such as Dark Mode settings and Sidebar state.","<strong>Analytics Cookies:</strong> Help us understand how you use the site to improve features. These are aggregated and anonymous."]})}),o.jsx(ks,{title:"Managing Cookies",children:o.jsx("p",{children:"You can control or delete cookies through your browser settings. However, please note that disabling Essential Cookies will prevent you from logging in to SeshNx."})})]}),hce=()=>o.jsxs(o.Fragment,{children:[o.jsx(Ib,{children:"DMCA & Copyright"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"SeshNx respects the intellectual property rights of others and complies with the Digital Millennium Copyright Act (DMCA)."}),o.jsxs(ks,{title:"Reporting Infringement",children:[o.jsxs("p",{children:["If you believe your copyrighted work has been infringed on SeshNx, please send a notice to our Designated Agent at ",o.jsx("strong",{children:"legal@seshnx.com"})," including:"]}),o.jsx(Bp,{items:["Identification of the copyrighted work claimed to have been infringed.","Identification of the infringing material (URL or Post ID).","Your contact information (Email, Phone).","A statement of good faith belief that the use is unauthorized.","A statement, under penalty of perjury, that the information is accurate and you are the copyright owner."]})]}),o.jsx(ks,{title:"Counter-Notices",children:o.jsx("p",{children:"If your content was removed by mistake, you may file a counter-notice. We may restore the content within 10-14 business days if the complainant does not file a court action against you."})})]}),fce=["Student","Instructor","Intern","Admin"];function mce({lat:t,lng:e}){const n=$6();return N.useEffect(()=>{n.setView([t,e],11)},[t,e,n]),null}function pce({zip:t}){const[e,n]=N.useState({center:[34.0522,-118.2437],userCount:0,densityColor:"gray",locationName:"",regionLabel:"",isValid:!1,loading:!1});return N.useEffect(()=>{if(!t||t.length<5)return;const s=setTimeout(async()=>{n(a=>({...a,loading:!0}));const i=await jb(t);if(i){const{count:a,density:l,label:u}=await lce(t);n({center:[i.lat,i.lng],userCount:a,densityColor:l,locationName:i.cityState,regionLabel:u,isValid:!0,loading:!1})}else n(a=>({...a,loading:!1}))},800);return()=>clearTimeout(s)},[t]),o.jsxs("div",{className:"w-full h-36 rounded-xl overflow-hidden relative border dark:border-gray-600 shadow-inner animate-in fade-in duration-500 bg-gray-100 dark:bg-[#1f2128]",children:[o.jsxs(U6,{center:e.center,zoom:11,scrollWheelZoom:!1,zoomControl:!1,className:"h-full w-full",style:{background:"transparent"},children:[o.jsx(q6,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://carto.com/attributions">CARTO</a>'}),o.jsx(mce,{lat:e.center[0],lng:e.center[1]}),e.isValid&&o.jsxs(o.Fragment,{children:[o.jsx(Cx,{center:e.center,radius:8e3,pathOptions:{color:e.densityColor,fillColor:e.densityColor,fillOpacity:.05,stroke:!1}}),o.jsx(Cx,{center:e.center,radius:4e3,pathOptions:{color:e.densityColor,fillColor:e.densityColor,fillOpacity:.15,stroke:!1}}),o.jsx(Cx,{center:e.center,radius:400,pathOptions:{color:"white",fillColor:e.densityColor,fillOpacity:.9,weight:2}})]})]}),o.jsxs("div",{className:"absolute bottom-3 right-3 bg-white/95 dark:bg-black/85 backdrop-blur-md p-2.5 rounded-xl shadow-lg z-[400] border border-gray-100 dark:border-gray-700 flex flex-col items-end min-w-[120px]",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${e.loading?"animate-ping":""} shadow-sm`,style:{backgroundColor:e.isValid?e.densityColor:"gray"}}),o.jsx("div",{className:"text-xs font-extrabold text-gray-700 dark:text-gray-100 leading-none",children:e.loading?"Scanning...":e.isValid?`${e.userCount} Nearby`:"Enter Zip"})]}),e.isValid&&!e.loading&&o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 font-medium uppercase tracking-wider",children:e.regionLabel}),o.jsx("span",{className:"text-[9px] text-gray-400 font-normal truncate max-w-[140px]",children:e.locationName})]})]})]})}function iP({darkMode:t,toggleTheme:e,user:n,onSuccess:r}){const[s,i]=N.useState(1),[a,l]=N.useState("login"),[u,d]=N.useState(!1),[f,m]=N.useState({email:"",password:"",firstName:"",lastName:"",zip:"",roles:[]}),[p,v]=N.useState(""),[x,_]=N.useState(!1),[E,k]=N.useState("auto"),[b,S]=N.useState(!1),[C,P]=N.useState(!1),R=N.useRef(null),[I,j]=N.useState(!1),[O,V]=N.useState(""),[z,D]=N.useState([]),[F,ee]=N.useState(null),[ue,ve]=N.useState(""),[ae,H]=N.useState(""),[Q,W]=N.useState(""),[re,he]=N.useState(null),[ye,Me]=N.useState(null),Fe=X0.filter(pe=>!fce.includes(pe)),G=()=>a==="signup"?"Create your Account":a==="forgot"?"Password Recovery":a==="onboarding"?"Finalize Setup":null;N.useEffect(()=>{if(n){l("onboarding"),i(1);const pe=n.displayName?n.displayName.split(" "):["User",""];m(U=>({...U,email:n.email,firstName:pe[0]||"",lastName:pe.slice(1).join(" ")||""})),d(!1)}else l("login"),i(1),m({email:"",password:"",firstName:"",lastName:"",zip:"",roles:[]})},[n]);const[le,De]=N.useState({hasUpper:!1,hasLower:!1,hasNumber:!1,isLength:!1});N.useEffect(()=>{const pe=f.password;De({hasUpper:/[A-Z]/.test(pe),hasLower:/[a-z]/.test(pe),hasNumber:/[0-9]/.test(pe),isLength:pe.length>=6})},[f.password]);const Qe=Object.values(le).every(Boolean);N.useEffect(()=>{if(!R.current)return;const pe=new ResizeObserver(()=>{if(R.current){const U=R.current.scrollHeight+80;U>200&&k(`${U}px`)}});return pe.observe(R.current),()=>pe.disconnect()},[s,a,p,x,f.zip,I,z,re]),N.useEffect(()=>{v("")},[s]);const ie=async()=>{if(!f.email||!f.password)return v("Please fill in all fields.");d(!0);try{await Rq(Sd,f.email,f.password)}catch{v("Invalid email or password."),d(!1)}},Ae=async()=>{v(""),d(!0);try{const pe=new Do;pe.setCustomParameters({prompt:"select_account"}),await sW(Sd,pe)}catch(pe){console.error("Google Sign-In Error:",pe),v(pe.message),d(!1)}},Ge=async()=>{if(a==="signup"&&!Qe)return v("Password requirements not met.");d(!0);try{let pe;a==="onboarding"&&n?pe=n.uid:pe=(await Aq(Sd,f.email,f.password)).user.uid;let U=f.roles.length>0?f.roles:["Fan"];if(ye&&!U.includes("Student")&&U.push("Student"),ye){await Pi(ye.ref);const ne=ye.data();await Ka(ke(Y,`schools/${F.id}/students`,pe),{...ne,uid:pe,email:f.email,status:"Active"})}const K={firstName:f.firstName,lastName:f.lastName,zip:f.zip,accountTypes:U,activeProfileRole:U[0],schoolId:(F==null?void 0:F.id)||null,studentId:ue||null,createdAt:jt(),email:f.email,photoURL:(n==null?void 0:n.photoURL)||null};await Promise.all([Ka(ke(Y,Le(pe).userProfile),K,{merge:!0}),Ka(ke(Y,Le(pe).userPublicProfile),{...K,uid:pe,searchTerms:[f.firstName.toLowerCase(),f.lastName.toLowerCase(),f.zip,...U.map(ne=>ne.toLowerCase())]},{merge:!0}),Ka(ke(Y,Le(pe).userWallet),{balance:0,createdAt:jt()},{merge:!0})]),r&&r()}catch(pe){v(pe.message.replace("Firebase: ","").replace("auth/","")),d(!1)}},me=async()=>{if(!f.email)return v("Enter email address.");d(!0);try{await Iq(Sd,f.email),_(!0),v("")}catch(pe){v(pe.message)}d(!1)},dt=()=>{if(!navigator.geolocation)return v("Geolocation not supported.");S(!0),navigator.geolocation.getCurrentPosition(async pe=>{try{const K=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${pe.coords.latitude}&lon=${pe.coords.longitude}`)).json();K.address.postcode?m(ne=>({...ne,zip:K.address.postcode.split("-")[0]})):v("Could not determine Zip Code.")}catch{v("Failed to find location.")}S(!1)},()=>{v("Location permission denied."),S(!1)})};N.useEffect(()=>{if(O.length<2){D([]);return}const pe=setTimeout(async()=>{const U=mt(Ce(Y,"schools"),zt("name",">=",O),zt("name","<=",O+"")),K=await Pt(U);D(K.docs.map(ne=>({id:ne.id,...ne.data()})))},300);return()=>clearTimeout(pe)},[O]);const Dt=async()=>{if(!F||!ue||!ae)return v("All fields required.");d(!0);try{const pe=mt(Ce(Y,`schools/${F.id}/students`),zt("studentId","==",ue)),U=await Pt(pe);if(U.empty){v("Student ID not found in this school's roster."),d(!1);return}const K=U.docs[0].data();if(K.email.toLowerCase()!==ae.toLowerCase()){v("Email provided does not match the student record."),d(!1);return}m(Ee=>({...Ee,firstName:K.firstName||K.displayName.split(" ")[0],lastName:K.lastName||K.displayName.split(" ").slice(1).join(" ")}));const ne=Math.floor(1e5+Math.random()*9e5).toString();console.log("MOCK AUTH CODE SENT:",ne),he(ne),Me(U.docs[0]),alert(`Code sent to ${ae}. (Dev: ${ne})`),d(!1)}catch(pe){console.error(pe),v("Verification failed."),d(!1)}},dr=()=>{Q===re?(m(pe=>({...pe,roles:[...pe.roles,"Student"]})),i(5)):v("Invalid authorization code.")},Wn=(pe,U)=>{pe.key==="Enter"&&U()},st=({met:pe,text:U})=>o.jsxs("div",{className:`flex items-center gap-1.5 text-xs transition-colors ${pe?"text-green-600 dark:text-green-400":"text-gray-400 dark:text-gray-500"}`,children:[pe?o.jsx(Cs,{size:12,strokeWidth:3}):o.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300 dark:border-gray-600"}),U]});return o.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200 p-4 dark:from-gray-900 dark:to-black transition-colors duration-500 relative",children:[o.jsx("div",{className:"absolute top-6 right-6 z-20",children:o.jsx("button",{onClick:e,className:"p-3 rounded-full bg-white/80 dark:bg-black/50 backdrop-blur-md border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:scale-110 transition-transform shadow-sm",children:t?o.jsx(OV,{size:20}):o.jsx(uE,{size:20})})}),o.jsx("div",{className:"bg-white dark:bg-dark-card dark:border dark:border-gray-700 rounded-3xl shadow-2xl w-full max-w-md relative overflow-hidden transition-[height] duration-500 z-10",style:{height:E,minHeight:"500px"},children:o.jsxs("div",{ref:R,className:"pt-12 px-8 pb-8",children:[o.jsxs("div",{className:"relative w-full h-48 mb-6 flex justify-center shrink-0",children:[o.jsx("div",{className:`absolute transition-all duration-500 ease-[cubic-bezier(0.34,1.56,0.64,1)] ${a==="signup"||a==="onboarding"?"top-0 scale-90":"top-8 scale-100"} z-0`,children:o.jsx("div",{className:`w-96 h-40 ${a==="signup"||a==="onboarding"?"":"animate-float"}`,children:o.jsx("img",{src:t?b6:_6,alt:"SeshNx",className:"w-full h-full object-contain drop-shadow-md"})})}),o.jsx("div",{className:"absolute bottom-2 w-full text-center z-10 pointer-events-none",children:G()&&o.jsx("p",{className:"text-sm font-bold text-gray-500 dark:text-gray-300 uppercase tracking-wider animate-pulse transition-opacity duration-300",children:G()})})]}),p&&o.jsxs("div",{className:"absolute top-4 left-0 right-0 mx-8 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-300 p-3 rounded-xl text-sm flex items-center gap-2 animate-in fade-in slide-in-from-top-2 z-30 border border-red-100 dark:border-red-800/30",children:[o.jsx(da,{size:16}),o.jsx("span",{className:"capitalize font-medium",children:p})]}),x&&o.jsxs("div",{className:"absolute top-4 left-0 right-0 mx-8 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-300 p-3 rounded-xl text-sm flex items-center gap-2 animate-in fade-in slide-in-from-top-2 z-30 border border-green-100 dark:border-green-800/30",children:[o.jsx(Cs,{size:16}),o.jsx("span",{children:"Check your email."})]}),o.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4 duration-500 fill-mode-forwards",children:[a==="login"&&o.jsxs("div",{className:"space-y-4 w-full",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",placeholder:"Email Address",type:"email",value:f.email,onChange:pe=>m({...f,email:pe.target.value}),onKeyDown:pe=>Wn(pe,ie),disabled:u}),o.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",type:"password",placeholder:"Password",value:f.password,onChange:pe=>m({...f,password:pe.target.value}),onKeyDown:pe=>Wn(pe,ie),disabled:u})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>l("forgot"),className:"text-xs text-gray-500 hover:text-brand-blue font-medium transition-colors",children:"Forgot Password?"})}),o.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all shadow-lg flex justify-center disabled:opacity-70",onClick:ie,disabled:u,children:u?o.jsx(Ye,{className:"animate-spin"}):"Sign In"}),o.jsxs("button",{onClick:Ae,className:"w-full bg-white dark:bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-white py-3.5 rounded-xl font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-all flex justify-center items-center gap-2",disabled:u,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),o.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),o.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),o.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),o.jsxs("div",{className:"relative py-2",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-2 bg-white dark:bg-dark-card text-gray-500",children:"or"})})]}),o.jsx("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 cursor-pointer hover:text-brand-blue font-medium transition-colors pt-2",onClick:()=>l("signup"),children:"New here? Create an Account"})]}),a==="forgot"&&o.jsxs("div",{className:"space-y-4 w-full",children:[o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center mb-2",children:"Enter your email to receive reset instructions."}),o.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",placeholder:"Email Address",type:"email",value:f.email,onChange:pe=>m({...f,email:pe.target.value}),onKeyDown:pe=>Wn(pe,me),disabled:u||x}),o.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all flex justify-center items-center gap-2 disabled:opacity-50",onClick:me,disabled:u||x,children:u?o.jsx(Ye,{className:"animate-spin"}):x?"Sent!":"Send Reset Link"}),o.jsx("button",{className:"w-full text-gray-500 text-sm hover:text-gray-800 dark:hover:text-gray-200 mt-2",onClick:()=>l("login"),children:"Back to Login"})]}),(a==="signup"||a==="onboarding")&&o.jsxs("div",{className:"w-full",children:[s===1&&o.jsx("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-8 duration-500",children:a==="signup"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",placeholder:"Email Address",type:"email",value:f.email,onChange:pe=>m({...f,email:pe.target.value}),disabled:u}),o.jsx("input",{className:`w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border ${!Qe&&f.password?"border-red-300 focus:ring-red-200":"border-gray-200 dark:border-gray-600 focus:ring-brand-blue"} rounded-xl focus:ring-2 outline-none dark:text-white transition-all`,type:"password",placeholder:"Create Password",value:f.password,onChange:pe=>m({...f,password:pe.target.value}),disabled:u})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("div",{className:"grid grid-cols-2 gap-2 pl-1",children:[o.jsx(st,{met:le.hasUpper,text:"Uppercase Letter"}),o.jsx(st,{met:le.hasLower,text:"Lowercase Letter"}),o.jsx(st,{met:le.hasNumber,text:"Number (0-9)"}),o.jsx(st,{met:le.isLength,text:"6+ Characters"})]})}),o.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all shadow-lg flex justify-center disabled:opacity-50",onClick:()=>{if(!f.email)return v("Email required");if(!Qe)return v("Fix password issues");i(2)},disabled:u||!Qe||!f.email,children:"Continue"}),o.jsxs("button",{onClick:Ae,className:"w-full bg-white dark:bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-white py-3.5 rounded-xl font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-all flex justify-center items-center gap-2",disabled:u,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),o.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),o.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),o.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),o.jsxs("div",{className:"relative py-2",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-2 bg-white dark:bg-dark-card text-gray-500",children:"or"})})]}),o.jsx("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 cursor-pointer hover:text-brand-blue font-medium transition-colors pt-2",onClick:()=>l("login"),children:"Already have an account? Log In"})]}):o.jsxs("div",{className:"space-y-6 text-center",children:[o.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-gray-100 dark:bg-gray-800 p-1 border-2 border-brand-blue shadow-lg overflow-hidden",children:n!=null&&n.photoURL?o.jsx("img",{src:n.photoURL,alt:"Profile",className:"w-full h-full object-cover rounded-full"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center text-brand-blue",children:o.jsx(wr,{size:40})})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-2xl font-bold dark:text-white",children:["Welcome, ",f.firstName,"!"]}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Let's finish setting up your creative profile."})]}),o.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all shadow-lg flex justify-center",onClick:()=>i(2),children:"Let's Go"})]})}),s===2&&o.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-8 duration-500",children:[o.jsxs("div",{className:"flex gap-3",children:[o.jsx("input",{className:"w-1/2 p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white",placeholder:"First Name",value:f.firstName,onChange:pe=>m({...f,firstName:pe.target.value}),autoFocus:!0}),o.jsx("input",{className:"w-1/2 p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white",placeholder:"Last Name",value:f.lastName,onChange:pe=>m({...f,lastName:pe.target.value})})]}),o.jsxs("div",{className:"relative flex gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx("input",{className:"w-full p-3.5 pl-10 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white",placeholder:"Zip Code",maxLength:5,value:f.zip,onChange:pe=>m({...f,zip:pe.target.value.replace(/\D/g,"")})}),o.jsx(cr,{className:"absolute left-3 top-3.5 text-gray-400",size:18})]}),o.jsx("button",{onClick:dt,className:"p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 text-brand-blue transition-colors",children:b?o.jsx(Ye,{size:20,className:"animate-spin"}):o.jsx(kV,{size:20})})]}),o.jsx(pce,{zip:f.zip}),o.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-3 rounded-xl border dark:border-gray-700 flex items-center gap-3 cursor-pointer transition-colors hover:bg-gray-100 dark:hover:bg-[#2a2d36]",onClick:()=>j(!I),children:[o.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${I?"bg-brand-blue border-brand-blue":"border-gray-400"}`,children:I&&o.jsx(Cs,{size:12,className:"text-white",strokeWidth:3})}),o.jsx("span",{className:"text-sm font-bold dark:text-white flex-1",children:"Are you a student?"}),o.jsx(Sl,{size:18,className:I?"text-brand-blue":"text-gray-400"})]}),o.jsxs("div",{className:"flex justify-between pt-2",children:[o.jsxs("button",{className:`text-gray-500 flex items-center gap-1 text-sm font-medium ${a==="onboarding"?"opacity-0 pointer-events-none":""}`,onClick:()=>i(1),children:[o.jsx(fb,{size:16})," Back"]}),o.jsx("button",{className:"bg-gray-900 dark:bg-white dark:text-black text-white px-6 py-2.5 rounded-xl font-bold transition-transform active:scale-95",onClick:()=>{f.firstName&&f.zip?i(I?3:5):v("Info required")},children:"Next Step"})]})]}),s===3&&o.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-8 duration-500",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold dark:text-white text-lg mb-2",children:"Find your School"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Search for your institution to link your enrollment."})]}),o.jsxs("div",{className:"relative",children:[o.jsx(ur,{className:"absolute left-3 top-3 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none",placeholder:"Search School Name...",value:O,onChange:pe=>V(pe.target.value),autoFocus:!0}),z.length>0&&o.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-xl max-h-48 overflow-y-auto p-1",children:z.map(pe=>o.jsxs("div",{onClick:()=>{ee(pe),i(4)},className:"p-3 hover:bg-gray-50 dark:hover:bg-white/10 cursor-pointer rounded-lg flex items-center gap-3 transition",children:[o.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-gray-700 rounded flex items-center justify-center text-gray-500",children:o.jsx(Sl,{size:16})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold dark:text-white text-sm",children:pe.name}),o.jsx("div",{className:"text-xs text-gray-500",children:pe.city||"Location N/A"})]})]},pe.id))})]}),o.jsx("button",{className:"w-full text-gray-400 text-sm hover:text-gray-600",onClick:()=>i(2),children:"Back"})]}),s===4&&F&&o.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-8 duration-500",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"font-bold dark:text-white text-lg",children:F.name}),o.jsx("p",{className:"text-xs text-gray-500",children:"Verify your enrollment"})]}),re?o.jsxs("div",{className:"space-y-4 text-center animate-in fade-in",children:[o.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg border border-green-100 dark:border-green-800",children:o.jsxs("p",{className:"text-xs text-green-700 dark:text-green-400",children:["Code sent to ",ae]})}),o.jsxs("div",{className:"relative",children:[o.jsx(Rp,{className:"absolute left-3 top-3 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white text-center font-mono tracking-widest text-lg",placeholder:"000000",maxLength:6,value:Q,onChange:pe=>W(pe.target.value)})]}),o.jsx("button",{onClick:dr,className:"w-full bg-green-600 text-white py-3 rounded-xl font-bold hover:bg-green-700 transition",children:"Confirm Code"})]}):o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx(wr,{className:"absolute left-3 top-3 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Student ID Number",value:ue,onChange:pe=>ve(pe.target.value)})]}),o.jsxs("div",{className:"relative",children:[o.jsx(Pp,{className:"absolute left-3 top-3 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"School Email Address",value:ae,onChange:pe=>H(pe.target.value)})]}),o.jsx("button",{onClick:Dt,disabled:u,className:"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 transition",children:u?"Verifying...":"Verify & Send Code"})]}),o.jsx("button",{className:"w-full text-gray-400 text-sm hover:text-gray-600",onClick:()=>i(3),children:"Change School"})]}),s===5&&o.jsxs("div",{className:"space-y-5 animate-in fade-in slide-in-from-right-8 duration-500",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h4",{className:"font-bold dark:text-white",children:"Select Additional Roles"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"You can change these later."})]}),o.jsx("div",{className:"grid grid-cols-2 gap-2.5 h-auto",children:Fe.map(pe=>o.jsxs("div",{onClick:()=>{const U=f.roles.includes(pe)?f.roles.filter(K=>K!==pe):[...f.roles,pe];m({...f,roles:U})},className:`relative p-3 border-2 rounded-xl cursor-pointer text-sm font-bold text-center transition-colors duration-200 select-none ${f.roles.includes(pe)?"bg-blue-50 border-brand-blue text-brand-blue dark:bg-blue-900/20 dark:border-blue-500 dark:text-blue-300 shadow-sm":"bg-white border-gray-100 text-gray-500 hover:border-gray-300 dark:bg-[#1f2128] dark:border-gray-700 dark:text-gray-400"}`,children:[pe,f.roles.includes(pe)&&o.jsx("div",{className:"absolute top-1 right-1 text-brand-blue",children:o.jsx(Cs,{size:10,strokeWidth:4})})]},pe))}),o.jsxs("p",{className:"text-[10px] text-gray-400 text-center px-4 leading-tight",children:["By completing setup, you agree to our ",o.jsx("button",{onClick:()=>P(!0),className:"underline hover:text-brand-blue mx-1",children:"Terms of Service"})," and ",o.jsx("button",{onClick:()=>P(!0),className:"underline hover:text-brand-blue mx-1",children:"Privacy Policy"}),"."]}),o.jsx("button",{className:"w-full bg-green-600 text-white py-3.5 rounded-xl font-bold mt-2 hover:bg-green-700 transition-colors flex justify-center items-center gap-2 disabled:opacity-50",onClick:Ge,disabled:u,children:u?o.jsx(Ye,{className:"animate-spin"}):"Complete Setup"}),o.jsx("button",{className:"w-full text-gray-400 text-xs hover:text-gray-600 transition-colors",onClick:()=>i(2),children:"Back to Personal Info"})]})]})]},a)]})}),o.jsx("div",{className:"absolute bottom-6 z-20",children:o.jsxs("button",{onClick:()=>P(!0),className:"text-xs text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 transition-colors flex items-center gap-2 opacity-80 hover:opacity-100 backdrop-blur-sm px-3 py-1.5 rounded-full",children:[o.jsx(U0,{size:14})," Legal Center & Terms"]})}),C&&o.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-white dark:bg-[#1f2128] w-full max-w-5xl h-[85vh] rounded-2xl shadow-2xl overflow-hidden flex flex-col border border-gray-200 dark:border-gray-700 relative animate-in slide-in-from-bottom-4",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] shrink-0",children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white flex items-center gap-2",children:[o.jsx(U0,{size:20,className:"text-brand-blue"})," Legal Center"]}),o.jsx("button",{onClick:()=>P(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:o.jsx(ut,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto relative",children:o.jsx(W6,{isEmbedded:!0})})]})})]})}function $r(t,e,n,r){return new(n||(n=Promise))(function(s,i){function a(d){try{u(r.next(d))}catch(f){i(f)}}function l(d){try{u(r.throw(d))}catch(f){i(f)}}function u(d){var f;d.done?s(d.value):(f=d.value,f instanceof n?f:new n(function(m){m(f)})).then(a,l)}u((r=r.apply(t,e||[])).next())})}class Ag{constructor(){this.listeners={}}on(e,n,r){if(this.listeners[e]||(this.listeners[e]=new Set),r==null?void 0:r.once){const s=(...i)=>{this.un(e,s),n(...i)};return this.listeners[e].add(s),()=>this.un(e,s)}return this.listeners[e].add(n),()=>this.un(e,n)}un(e,n){var r;(r=this.listeners[e])===null||r===void 0||r.delete(n)}once(e,n){return this.on(e,n,{once:!0})}unAll(){this.listeners={}}emit(e,...n){this.listeners[e]&&this.listeners[e].forEach(r=>r(...n))}}const qy={decode:function(t,e){return $r(this,void 0,void 0,function*(){const n=new AudioContext({sampleRate:e});try{return yield n.decodeAudioData(t)}finally{n.close()}})},createBuffer:function(t,e){if(!t||t.length===0)throw new Error("channelData must be a non-empty array");if(e<=0)throw new Error("duration must be greater than 0");if(typeof t[0]=="number"&&(t=[t]),!t[0]||t[0].length===0)throw new Error("channelData must contain non-empty channel arrays");(function(r){const s=r[0];if(s.some(i=>i>1||i<-1)){const i=s.length;let a=0;for(let l=0;l<i;l++){const u=Math.abs(s[l]);u>a&&(a=u)}for(const l of r)for(let u=0;u<i;u++)l[u]/=a}})(t);const n=t.map(r=>r instanceof Float32Array?r:Float32Array.from(r));return{duration:e,length:n[0].length,sampleRate:n[0].length/e,numberOfChannels:n.length,getChannelData:r=>{const s=n[r];if(!s)throw new Error(`Channel ${r} not found`);return s},copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function H6(t,e){const n=e.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);for(const[r,s]of Object.entries(e))if(r==="children"&&s)for(const[i,a]of Object.entries(s))a instanceof Node?n.appendChild(a):typeof a=="string"?n.appendChild(document.createTextNode(a)):n.appendChild(H6(i,a));else r==="style"?Object.assign(n.style,s):r==="textContent"?n.textContent=s:n.setAttribute(r,s.toString());return n}function oP(t,e,n){const r=H6(t,e||{});return n==null||n.appendChild(r),r}var gce=Object.freeze({__proto__:null,createElement:oP,default:oP});const yce={fetchBlob:function(t,e,n){return $r(this,void 0,void 0,function*(){const r=yield fetch(t,n);if(r.status>=400)throw new Error(`Failed to fetch ${t}: ${r.status} (${r.statusText})`);return function(s,i){$r(this,void 0,void 0,function*(){if(!s.body||!s.headers)return;const a=s.body.getReader(),l=Number(s.headers.get("Content-Length"))||0;let u=0;const d=f=>{u+=(f==null?void 0:f.length)||0;const m=Math.round(u/l*100);i(m)};try{for(;;){const f=yield a.read();if(f.done)break;d(f.value)}}catch(f){console.warn("Progress tracking error:",f)}})}(r.clone(),e),r.blob()})}};function Ln(t){let e=t;const n=new Set;return{get value(){return e},set(r){Object.is(e,r)||(e=r,n.forEach(s=>s(e)))},update(r){this.set(r(e))},subscribe:r=>(n.add(r),()=>n.delete(r))}}function hc(t,e){const n=Ln(t());return e.forEach(r=>r.subscribe(()=>{const s=t();Object.is(n.value,s)||n.set(s)})),{get value(){return n.value},subscribe:r=>n.subscribe(r)}}function La(t,e){let n;const r=()=>{n&&(n(),n=void 0),n=t()},s=e.map(i=>i.subscribe(r));return r(),()=>{n&&(n(),n=void 0),s.forEach(i=>i())}}class xce extends Ag{get isPlayingSignal(){return this._isPlaying}get currentTimeSignal(){return this._currentTime}get durationSignal(){return this._duration}get volumeSignal(){return this._volume}get mutedSignal(){return this._muted}get playbackRateSignal(){return this._playbackRate}get seekingSignal(){return this._seeking}constructor(e){super(),this.isExternalMedia=!1,this.reactiveMediaEventCleanups=[],e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),this._isPlaying=Ln(!1),this._currentTime=Ln(0),this._duration=Ln(0),this._volume=Ln(this.media.volume),this._muted=Ln(this.media.muted),this._playbackRate=Ln(this.media.playbackRate||1),this._seeking=Ln(!1),this.setupReactiveMediaEvents(),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}setupReactiveMediaEvents(){this.reactiveMediaEventCleanups.push(this.onMediaEvent("play",()=>{this._isPlaying.set(!0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("pause",()=>{this._isPlaying.set(!1)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("ended",()=>{this._isPlaying.set(!1)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("timeupdate",()=>{this._currentTime.set(this.media.currentTime)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("durationchange",()=>{this._duration.set(this.media.duration||0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("loadedmetadata",()=>{this._duration.set(this.media.duration||0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("seeking",()=>{this._seeking.set(!0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("seeked",()=>{this._seeking.set(!1)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("volumechange",()=>{this._volume.set(this.media.volume),this._muted.set(this.media.muted)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("ratechange",()=>{this._playbackRate.set(this.media.playbackRate)}))}onMediaEvent(e,n,r){return this.media.addEventListener(e,n,r),()=>this.media.removeEventListener(e,n,r)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,n){const r=this.getSrc();if(e&&r===e)return;this.revokeSrc();const s=n instanceof Blob&&(this.canPlayType(n.type)||!e)?URL.createObjectURL(n):e;if(r&&this.media.removeAttribute("src"),s||e)try{this.media.src=s}catch{this.media.src=e}}destroy(){this.reactiveMediaEventCleanups.forEach(e=>e()),this.reactiveMediaEventCleanups=[],this.isExternalMedia||(this.media.pause(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load(),this.media.remove())}setMediaElement(e){this.reactiveMediaEventCleanups.forEach(n=>n()),this.reactiveMediaEventCleanups=[],this.media=e,this.setupReactiveMediaEvents()}play(){return $r(this,void 0,void 0,function*(){try{return yield this.media.play()}catch(e){if(e instanceof DOMException&&e.name==="AbortError")return;throw e}})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,n){n!=null&&(this.media.preservesPitch=n),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}function vce({maxTop:t,maxBottom:e,halfHeight:n,vScale:r,barMinHeight:s=0,barAlign:i}){let a=Math.round(t*n*r),l=a+Math.round(e*n*r)||1;return l<s&&(l=s,i||(a=l/2)),{topHeight:a,totalHeight:l}}function bce({barAlign:t,halfHeight:e,topHeight:n,totalHeight:r,canvasHeight:s}){return t==="top"?0:t==="bottom"?s-r:e-n}function aP(t,e,n){const r=e-t.left,s=n-t.top;return[r/t.width,s/t.height]}function G6(t){return!!(t.barWidth||t.barGap||t.barAlign)}function lP(t,e){if(!G6(e))return t;const n=e.barWidth||.5,r=n+(e.barGap||n/2);return r===0?t:Math.floor(t/r)*r}function cP({scrollLeft:t,totalWidth:e,numCanvases:n}){if(e===0)return[0];const r=t/e,s=Math.floor(r*n);return[s-1,s,s+1]}function K6(t){const e=t._cleanup;typeof e=="function"&&e()}function _ce(t){const e=Ln({scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth}),n=hc(()=>function(i){const{scrollLeft:a,scrollWidth:l,clientWidth:u}=i;if(l===0)return{startX:0,endX:1};const d=a/l,f=(a+u)/l;return{startX:Math.max(0,Math.min(1,d)),endX:Math.max(0,Math.min(1,f))}}(e.value),[e]),r=hc(()=>function(i){return{left:i.scrollLeft,right:i.scrollLeft+i.clientWidth}}(e.value),[e]),s=()=>{e.set({scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth})};return t.addEventListener("scroll",s,{passive:!0}),{scrollData:e,percentages:n,bounds:r,cleanup:()=>{t.removeEventListener("scroll",s),K6(e)}}}class wce extends Ag{constructor(e,n){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.dragStream=null,this.scrollStream=null,this.subscriptions=[],this.options=e;const r=this.parentFromOptionsContainer(e.container);this.parent=r;const[s,i]=this.initHtml();r.appendChild(s),this.container=s,this.scrollContainer=i.querySelector(".scroll"),this.wrapper=i.querySelector(".wrapper"),this.canvasWrapper=i.querySelector(".canvases"),this.progressWrapper=i.querySelector(".progress"),this.cursor=i.querySelector(".cursor"),n&&i.appendChild(n),this.initEvents()}parentFromOptionsContainer(e){let n;if(typeof e=="string"?n=document.querySelector(e):e instanceof HTMLElement&&(n=e),!n)throw new Error("Container not found");return n}initEvents(){this.wrapper.addEventListener("click",n=>{const r=this.wrapper.getBoundingClientRect(),[s,i]=aP(r,n.clientX,n.clientY);this.emit("click",s,i)}),this.wrapper.addEventListener("dblclick",n=>{const r=this.wrapper.getBoundingClientRect(),[s,i]=aP(r,n.clientX,n.clientY);this.emit("dblclick",s,i)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollStream=_ce(this.scrollContainer);const e=La(()=>{const{startX:n,endX:r}=this.scrollStream.percentages.value,{left:s,right:i}=this.scrollStream.bounds.value;this.emit("scroll",n,r,s,i)},[this.scrollStream.percentages,this.scrollStream.bounds]);if(this.subscriptions.push(e),typeof ResizeObserver=="function"){const n=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{n().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender(),this.emit("resize"))}initDrag(){if(this.dragStream)return;this.dragStream=function(n,r={}){const{threshold:s=3,mouseButton:i=0,touchDelay:a=100}=r,l=Ln(null),u=new Map,d=matchMedia("(pointer: coarse)").matches;let f=()=>{};const m=p=>{if(p.button!==i||(u.set(p.pointerId,p),u.size>1))return;let v=p.clientX,x=p.clientY,_=!1;const E=Date.now(),k=n.getBoundingClientRect(),{left:b,top:S}=k,C=O=>{if(O.defaultPrevented||u.size>1||d&&Date.now()-E<a)return;const V=O.clientX,z=O.clientY,D=V-v,F=z-x;(_||Math.abs(D)>s||Math.abs(F)>s)&&(O.preventDefault(),O.stopPropagation(),_||(l.set({type:"start",x:v-b,y:x-S}),_=!0),l.set({type:"move",x:V-b,y:z-S,deltaX:D,deltaY:F}),v=V,x=z)},P=O=>{if(u.delete(O.pointerId),_){const V=O.clientX,z=O.clientY;l.set({type:"end",x:V-b,y:z-S})}f()},R=O=>{u.delete(O.pointerId),O.relatedTarget&&O.relatedTarget!==document.documentElement||P(O)},I=O=>{_&&(O.stopPropagation(),O.preventDefault())},j=O=>{O.defaultPrevented||u.size>1||_&&O.preventDefault()};document.addEventListener("pointermove",C),document.addEventListener("pointerup",P),document.addEventListener("pointerout",R),document.addEventListener("pointercancel",R),document.addEventListener("touchmove",j,{passive:!1}),document.addEventListener("click",I,{capture:!0}),f=()=>{document.removeEventListener("pointermove",C),document.removeEventListener("pointerup",P),document.removeEventListener("pointerout",R),document.removeEventListener("pointercancel",R),document.removeEventListener("touchmove",j),setTimeout(()=>{document.removeEventListener("click",I,{capture:!0})},10)}};return n.addEventListener("pointerdown",m),{signal:l,cleanup:()=>{f(),n.removeEventListener("pointerdown",m),u.clear(),K6(l)}}}(this.wrapper);const e=La(()=>{const n=this.dragStream.signal.value;if(!n)return;const r=this.wrapper.getBoundingClientRect().width,s=(i=n.x/r)<0?0:i>1?1:i;var i;n.type==="start"?(this.isDragging=!0,this.emit("dragstart",s)):n.type==="move"?this.emit("drag",s):n.type==="end"&&(this.isDragging=!1,this.emit("dragend",s))},[this.dragStream.signal]);this.subscriptions.push(e)}initHtml(){const e=document.createElement("div"),n=e.attachShadow({mode:"open"}),r=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return n.innerHTML=`
      <style${r?` nonce="${r}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
          pointer-events: none;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,n]}setOptions(e){if(this.options.container!==e.container){const n=this.parentFromOptionsContainer(e.container);n.appendChild(this.container),this.parent=n}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:n}=this.scrollContainer,r=n*e;this.setScroll(r)}destroy(){var e;this.subscriptions.forEach(n=>n()),this.container.remove(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),(e=this.unsubscribeOnScroll)===null||e===void 0||e.forEach(n=>n()),this.unsubscribeOnScroll=[],this.dragStream&&(this.dragStream.cleanup(),this.dragStream=null),this.scrollStream&&(this.scrollStream.cleanup(),this.scrollStream=null)}createDelay(e=10){let n,r;const s=()=>{n&&(clearTimeout(n),n=void 0),r&&(r(),r=void 0)};return this.timeouts.push(s),()=>new Promise((i,a)=>{s(),r=a,n=setTimeout(()=>{n=void 0,r=void 0,i()},e)})}getHeight(e,n){var r;const s=((r=this.audioData)===null||r===void 0?void 0:r.numberOfChannels)||1;return function({optionsHeight:i,optionsSplitChannels:a,parentHeight:l,numberOfChannels:u,defaultHeight:d=128}){if(i==null)return d;const f=Number(i);if(!isNaN(f))return f;if(i==="auto"){const m=l||d;return a!=null&&a.every(p=>!p.overlay)?m/u:m}return d}({optionsHeight:e,optionsSplitChannels:n,parentHeight:this.parent.clientHeight,numberOfChannels:s,defaultHeight:128})}convertColorValues(e,n){return function(r,s,i){if(!Array.isArray(r))return r||"";if(r.length===0)return"#999";if(r.length<2)return r[0]||"";const a=document.createElement("canvas"),l=a.getContext("2d"),u=i??a.height*s,d=l.createLinearGradient(0,0,0,u||s),f=1/(r.length-1);return r.forEach((m,p)=>{d.addColorStop(p*f,m)}),d}(e,this.getPixelRatio(),n==null?void 0:n.canvas.height)}getPixelRatio(){return e=window.devicePixelRatio,Math.max(1,e||1);var e}renderBarWaveform(e,n,r,s){const{width:i,height:a}=r.canvas,{halfHeight:l,barWidth:u,barRadius:d,barIndexScale:f,barSpacing:m,barMinHeight:p}=function({width:x,height:_,length:E,options:k,pixelRatio:b}){const S=_/2,C=k.barWidth?k.barWidth*b:1,P=k.barGap?k.barGap*b:k.barWidth?C/2:0,R=C+P||1;return{halfHeight:S,barWidth:C,barGap:P,barRadius:k.barRadius||0,barMinHeight:k.barMinHeight?k.barMinHeight*b:0,barIndexScale:E>0?x/R/E:0,barSpacing:R}}({width:i,height:a,length:(e[0]||[]).length,options:n,pixelRatio:this.getPixelRatio()}),v=function({channelData:x,barIndexScale:_,barSpacing:E,barWidth:k,halfHeight:b,vScale:S,canvasHeight:C,barAlign:P,barMinHeight:R}){const I=x[0]||[],j=x[1]||I,O=I.length,V=[];let z=0,D=0,F=0;for(let ee=0;ee<=O;ee++){const ue=Math.round(ee*_);if(ue>z){const{topHeight:H,totalHeight:Q}=vce({maxTop:D,maxBottom:F,halfHeight:b,vScale:S,barMinHeight:R,barAlign:P}),W=bce({barAlign:P,halfHeight:b,topHeight:H,totalHeight:Q,canvasHeight:C});V.push({x:z*E,y:W,width:k,height:Q}),z=ue,D=0,F=0}const ve=Math.abs(I[ee]||0),ae=Math.abs(j[ee]||0);ve>D&&(D=ve),ae>F&&(F=ae)}return V}({channelData:e,barIndexScale:f,barSpacing:m,barWidth:u,halfHeight:l,vScale:s,canvasHeight:a,barAlign:n.barAlign,barMinHeight:p});r.beginPath();for(const x of v)d&&"roundRect"in r?r.roundRect(x.x,x.y,x.width,x.height,d):r.rect(x.x,x.y,x.width,x.height);r.fill(),r.closePath()}renderLineWaveform(e,n,r,s){const{width:i,height:a}=r.canvas,l=function({channelData:u,width:d,height:f,vScale:m}){const p=f/2,v=u[0]||[];return[v,u[1]||v].map((x,_)=>{const E=x.length,k=E?d/E:0,b=p,S=_===0?-1:1,C=[{x:0,y:b}];let P=0,R=0;for(let I=0;I<=E;I++){const j=Math.round(I*k);if(j>P){const V=b+(Math.round(R*p*m)||1)*S;C.push({x:P,y:V}),P=j,R=0}const O=Math.abs(x[I]||0);O>R&&(R=O)}return C.push({x:P,y:b}),C})}({channelData:e,width:i,height:a,vScale:s});r.beginPath();for(const u of l)if(u.length){r.moveTo(u[0].x,u[0].y);for(let d=1;d<u.length;d++){const f=u[d];r.lineTo(f.x,f.y)}}r.fill(),r.closePath()}renderWaveform(e,n,r){if(r.fillStyle=this.convertColorValues(n.waveColor,r),n.renderFunction)return void n.renderFunction(e,r);const s=function({channelData:i,barHeight:a,normalize:l,maxPeak:u}){var d;const f=a||1;if(!l)return f;const m=i[0];if(!m||m.length===0)return f;let p=u??0;if(!u)for(let v=0;v<m.length;v++){const x=(d=m[v])!==null&&d!==void 0?d:0,_=Math.abs(x);_>p&&(p=_)}return p?f/p:f}({channelData:e,barHeight:n.barHeight,normalize:n.normalize,maxPeak:n.maxPeak});G6(n)?this.renderBarWaveform(e,n,r,s):this.renderLineWaveform(e,n,r,s)}renderSingleCanvas(e,n,r,s,i,a,l){const u=this.getPixelRatio(),d=document.createElement("canvas");d.width=Math.round(r*u),d.height=Math.round(s*u),d.style.width=`${r}px`,d.style.height=`${s}px`,d.style.left=`${Math.round(i)}px`,a.appendChild(d);const f=d.getContext("2d");if(n.renderFunction?(f.fillStyle=this.convertColorValues(n.waveColor,f),n.renderFunction(e,f)):this.renderWaveform(e,n,f),d.width>0&&d.height>0){const m=d.cloneNode(),p=m.getContext("2d");p.drawImage(d,0,0),p.globalCompositeOperation="source-in",p.fillStyle=this.convertColorValues(n.progressColor,p),p.fillRect(0,0,d.width,d.height),l.appendChild(m)}}renderMultiCanvas(e,n,r,s,i,a){const l=this.getPixelRatio(),{clientWidth:u}=this.scrollContainer,d=r/l,f=function({clientWidth:x,totalWidth:_,options:E}){return lP(Math.min(8e3,x,_),E)}({clientWidth:u,totalWidth:d,options:n});let m={};if(f===0)return;const p=x=>{if(x<0||x>=v||m[x])return;m[x]=!0;const _=x*f;let E=Math.min(d-_,f);if(E=lP(E,n),E<=0)return;const k=function({channelData:b,offset:S,clampedWidth:C,totalWidth:P}){return b.map(R=>{const I=Math.floor(S/P*R.length),j=Math.floor((S+C)/P*R.length);return R.slice(I,j)})}({channelData:e,offset:_,clampedWidth:E,totalWidth:d});this.renderSingleCanvas(k,n,E,s,_,i,a)},v=Math.ceil(d/f);if(!this.isScrollable){for(let x=0;x<v;x++)p(x);return}if(cP({scrollLeft:this.scrollContainer.scrollLeft,totalWidth:d,numCanvases:v}).forEach(x=>p(x)),v>1){const x=this.on("scroll",()=>{const{scrollLeft:_}=this.scrollContainer;Object.keys(m).length>10&&(i.innerHTML="",a.innerHTML="",m={}),cP({scrollLeft:_,totalWidth:d,numCanvases:v}).forEach(E=>p(E))});this.unsubscribeOnScroll.push(x)}}renderChannel(e,n,r,s){var{overlay:i}=n,a=function(f,m){var p={};for(var v in f)Object.prototype.hasOwnProperty.call(f,v)&&m.indexOf(v)<0&&(p[v]=f[v]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function"){var x=0;for(v=Object.getOwnPropertySymbols(f);x<v.length;x++)m.indexOf(v[x])<0&&Object.prototype.propertyIsEnumerable.call(f,v[x])&&(p[v[x]]=f[v[x]])}return p}(n,["overlay"]);const l=document.createElement("div"),u=this.getHeight(a.height,a.splitChannels);l.style.height=`${u}px`,i&&s>0&&(l.style.marginTop=`-${u}px`),this.canvasWrapper.style.minHeight=`${u}px`,this.canvasWrapper.appendChild(l);const d=l.cloneNode();this.progressWrapper.appendChild(d),this.renderMultiCanvas(e,a,r,u,l,d)}render(e){return $r(this,void 0,void 0,function*(){var n;this.timeouts.forEach(d=>d()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const r=this.getPixelRatio(),s=this.scrollContainer.clientWidth,{scrollWidth:i,isScrollable:a,useParentWidth:l,width:u}=function({duration:d,minPxPerSec:f=0,parentWidth:m,fillParent:p,pixelRatio:v}){const x=Math.ceil(d*f),_=x>m,E=!!(p&&!_);return{scrollWidth:x,isScrollable:_,useParentWidth:E,width:(E?m:x)*v}}({duration:e.duration,minPxPerSec:this.options.minPxPerSec||0,parentWidth:s,fillParent:this.options.fillParent,pixelRatio:r});if(this.isScrollable=a,this.wrapper.style.width=l?"100%":`${i}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let d=0;d<e.numberOfChannels;d++){const f=Object.assign(Object.assign({},this.options),(n=this.options.splitChannels)===null||n===void 0?void 0:n[d]);this.renderChannel([e.getChannelData(d)],f,u,d)}else{const d=[e.getChannelData(0)];e.numberOfChannels>1&&d.push(e.getChannelData(1)),this.renderChannel(d,this.options,u,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(r=>r()),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:n}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:r}=this.progressWrapper.getBoundingClientRect(),s=function(i){const a=2*i;return(a<0?Math.floor(a):Math.ceil(a))/2}(r-n);this.scrollContainer.scrollLeft+=s}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,n=!1){const{scrollLeft:r,scrollWidth:s,clientWidth:i}=this.scrollContainer,a=e*s,l=r,u=r+i,d=i/2;if(this.isDragging)a+30>u?this.scrollContainer.scrollLeft+=30:a-30<l&&(this.scrollContainer.scrollLeft-=30);else{(a<l||a>u)&&(this.scrollContainer.scrollLeft=a-(this.options.autoCenter?d:0));const f=a-r-d;n&&this.options.autoCenter&&f>0&&(this.scrollContainer.scrollLeft+=f)}}renderProgress(e,n){if(isNaN(e))return;const r=100*e;this.canvasWrapper.style.clipPath=`polygon(${r}% 0%, 100% 0%, 100% 100%, ${r}% 100%)`,this.progressWrapper.style.width=`${r}%`,this.cursor.style.left=`${r}%`,this.cursor.style.transform=this.options.cursorWidth?`translateX(-${e*this.options.cursorWidth}px)`:"",this.isScrollable&&this.options.autoScroll&&this.audioData&&this.audioData.duration>0&&this.scrollIntoView(e,n)}exportImage(e,n,r){return $r(this,void 0,void 0,function*(){const s=this.canvasWrapper.querySelectorAll("canvas");if(!s.length)throw new Error("No waveform data");if(r==="dataURL"){const i=Array.from(s).map(a=>a.toDataURL(e,n));return Promise.resolve(i)}return Promise.all(Array.from(s).map(i=>new Promise((a,l)=>{i.toBlob(u=>{u?a(u):l(new Error("Could not export image"))},e,n)})))})}}class kce extends Ag{constructor(){super(...arguments),this.animationFrameId=null,this.isRunning=!1}start(){if(this.isRunning)return;this.isRunning=!0;const e=()=>{this.isRunning&&(this.emit("tick"),this.animationFrameId=requestAnimationFrame(e))};e()}stop(){this.isRunning=!1,this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop()}}class cw extends Ag{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return $r(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(n=>{if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return n.arrayBuffer()}).then(n=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(n)).then(n=>{this.currentSrc===e&&(this.buffer=n,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())}).catch(n=>{console.error("WebAudioPlayer load error:",n)})}_play(){if(!this.paused)return;this.paused=!1,this.bufferNode&&(this.bufferNode.onended=null,this.bufferNode.disconnect()),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let e=this.playedDuration*this._playbackRate;(e>=this.duration||e<0)&&(e=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,e),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return $r(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){const n=e-this.currentTime,r=this.bufferNode;r==null||r.stop(this.audioContext.currentTime+n),r==null||r.addEventListener("ended",()=>{r===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(e){return $r(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const n=!this.paused;n&&this._pause(),this.playedDuration=e/this._playbackRate,n&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,n;return(e=this._duration)!==null&&e!==void 0?e:((n=this.buffer)===null||n===void 0?void 0:n.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const n=this.buffer.numberOfChannels;for(let r=0;r<n;r++)e.push(this.buffer.getChannelData(r));return e}removeAttribute(e){switch(e){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}const Nce={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class $p extends xce{static create(e){return new $p(e)}getState(){return this.wavesurferState}getRenderer(){return this.renderer}constructor(e){const n=e.media||(e.backend==="WebAudio"?new cw:void 0);super({media:n,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.reactiveCleanups=[],this.options=Object.assign({},Nce,e);const{state:r,actions:s}=function(l){var u,d,f,m,p,v;const x=(u=l==null?void 0:l.currentTime)!==null&&u!==void 0?u:Ln(0),_=(d=l==null?void 0:l.duration)!==null&&d!==void 0?d:Ln(0),E=(f=l==null?void 0:l.isPlaying)!==null&&f!==void 0?f:Ln(!1),k=(m=l==null?void 0:l.isSeeking)!==null&&m!==void 0?m:Ln(!1),b=(p=l==null?void 0:l.volume)!==null&&p!==void 0?p:Ln(1),S=(v=l==null?void 0:l.playbackRate)!==null&&v!==void 0?v:Ln(1),C=Ln(null),P=Ln(null),R=Ln(""),I=Ln(0),j=Ln(0),O=hc(()=>!E.value,[E]),V=hc(()=>C.value!==null,[C]),z=hc(()=>V.value&&_.value>0,[V,_]),D=hc(()=>x.value,[x]),F=hc(()=>_.value>0?x.value/_.value:0,[x,_]);return{state:{currentTime:x,duration:_,isPlaying:E,isPaused:O,isSeeking:k,volume:b,playbackRate:S,audioBuffer:C,peaks:P,url:R,zoom:I,scrollPosition:j,canPlay:V,isReady:z,progress:D,progressPercent:F},actions:{setCurrentTime:ee=>{const ue=Math.max(0,Math.min(_.value||1/0,ee));x.set(ue)},setDuration:ee=>{_.set(Math.max(0,ee))},setPlaying:ee=>{E.set(ee)},setSeeking:ee=>{k.set(ee)},setVolume:ee=>{const ue=Math.max(0,Math.min(1,ee));b.set(ue)},setPlaybackRate:ee=>{const ue=Math.max(.1,Math.min(16,ee));S.set(ue)},setAudioBuffer:ee=>{C.set(ee),ee&&_.set(ee.duration)},setPeaks:ee=>{P.set(ee)},setUrl:ee=>{R.set(ee)},setZoom:ee=>{I.set(Math.max(0,ee))},setScrollPosition:ee=>{j.set(Math.max(0,ee))}}}}({isPlaying:this.isPlayingSignal,currentTime:this.currentTimeSignal,duration:this.durationSignal,volume:this.volumeSignal,playbackRate:this.playbackRateSignal,isSeeking:this.seekingSignal});this.wavesurferState=r,this.wavesurferActions=s,this.timer=new kce;const i=n?void 0:this.getMediaElement();this.renderer=new wce(this.options,i),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initReactiveState(),this.initPlugins();const a=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:l,duration:u}=this.options;(a||l&&u)&&this.load(a,l,u).catch(d=>{this.emit("error",d instanceof Error?d:new Error(String(d)))})})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}}))}initReactiveState(){this.reactiveCleanups.push(function(e,n){const r=[];r.push(La(()=>{const a=e.isPlaying.value;n.emit(a?"play":"pause")},[e.isPlaying])),r.push(La(()=>{const a=e.currentTime.value;n.emit("timeupdate",a),e.isPlaying.value&&n.emit("audioprocess",a)},[e.currentTime,e.isPlaying])),r.push(La(()=>{e.isSeeking.value&&n.emit("seeking",e.currentTime.value)},[e.isSeeking,e.currentTime]));let s=!1;r.push(La(()=>{e.isReady.value&&!s&&(s=!0,n.emit("ready",e.duration.value))},[e.isReady,e.duration]));let i=!1;return r.push(La(()=>{const a=e.isPlaying.value,l=e.currentTime.value,u=e.duration.value,d=u>0&&l>=u;i&&!a&&d&&n.emit("finish"),i=a&&d},[e.isPlaying,e.currentTime,e.duration])),r.push(La(()=>{const a=e.zoom.value;a>0&&n.emit("zoom",a)},[e.zoom])),()=>{r.forEach(a=>a())}}(this.wavesurferState,{emit:this.emit.bind(this)}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,n)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,n))}),this.renderer.on("dblclick",(e,n)=>{this.emit("dblclick",e,n)}),this.renderer.on("scroll",(e,n,r,s)=>{const i=this.getDuration();this.emit("scroll",e*i,n*i,r,s)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}),this.renderer.on("resize",()=>{this.emit("resize")}));{let e;const n=this.renderer.on("drag",r=>{var s;if(!this.options.interact)return;this.renderer.renderProgress(r),clearTimeout(e);let i=0;const a=this.options.dragToSeek;this.isPlaying()?i=0:a===!0?i=200:a&&typeof a=="object"&&(i=(s=a.debounceTime)!==null&&s!==void 0?s:200),e=setTimeout(()=>{this.seekTo(r)},i),this.emit("interaction",r*this.getDuration()),this.emit("drag",r)});this.subscriptions.push(()=>{clearTimeout(e),n()})}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(n=>{this.registerPlugin(n)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=qy.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=qy.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){if(this.plugins.includes(e))return e;e._init(this),this.plugins.push(e);const n=e.once("destroy",()=>{this.plugins=this.plugins.filter(r=>r!==e),this.subscriptions=this.subscriptions.filter(r=>r!==n)});return this.subscriptions.push(n),e}unregisterPlugin(e){this.plugins=this.plugins.filter(n=>n!==e),e.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const n=e/this.getDuration();this.renderer.setScrollPercentage(n)}getActivePlugins(){return this.plugins}loadAudio(e,n,r,s){return $r(this,void 0,void 0,function*(){var i;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,(i=this.abortController)===null||i===void 0||i.abort(),this.abortController=null,!n&&!r){const l=this.options.fetchParams||{};window.AbortController&&!l.signal&&(this.abortController=new AbortController,l.signal=this.abortController.signal);const u=f=>this.emit("loading",f);n=yield yce.fetchBlob(e,u,l);const d=this.options.blobMimeType;d&&(n=new Blob([n],{type:d}))}this.setSrc(e,n);const a=yield new Promise(l=>{const u=s||this.getDuration();u?l(u):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>l(this.getDuration()),{once:!0}))});if(!e&&!n){const l=this.getMediaElement();l instanceof cw&&(l.duration=a)}if(r)this.decodedData=qy.createBuffer(r,a||0);else if(n){const l=yield n.arrayBuffer();this.decodedData=yield qy.decode(l,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,n,r){return $r(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,n,r)}catch(s){throw this.emit("error",s),s}})}loadBlob(e,n,r){return $r(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,n,r)}catch(s){throw this.emit("error",s),s}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:n=8e3,precision:r=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const s=Math.min(e,this.decodedData.numberOfChannels),i=[];for(let a=0;a<s;a++){const l=this.decodedData.getChannelData(a),u=[],d=l.length/n;for(let f=0;f<n;f++){const m=l.slice(Math.floor(f*d),Math.ceil((f+1)*d));let p=0;for(let v=0;v<m.length;v++){const x=m[v];Math.abs(x)>Math.abs(p)&&(p=x)}u.push(Math.round(p*r)/r)}i.push(u)}return i}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const n=this.getDuration()*e;this.setTime(n)}play(e,n){const r=Object.create(null,{play:{get:()=>super.play}});return $r(this,void 0,void 0,function*(){e!=null&&this.setTime(e);const s=yield r.play.call(this);return n!=null&&(this.media instanceof cw?this.media.stopAt(n):this.stopAtPosition=n),s})}playPause(){return $r(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return $r(this,arguments,void 0,function*(e="image/png",n=1,r="dataURL"){return this.renderer.exportImage(e,n,r)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(n=>n.destroy()),this.subscriptions.forEach(n=>n()),this.unsubscribePlayerEvents(),this.reactiveCleanups.forEach(n=>n()),this.reactiveCleanups=[],this.timer.destroy(),this.renderer.destroy(),super.destroy()}}$p.BasePlugin=class extends Ag{constructor(t){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=t}onInit(){}_init(t){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(t=>t()),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},$p.dom=gce;const Sce="/assets/Fevicon-TMLO4Pj9.png";function W1({audioUrl:t,fileName:e="Audio Track",previewMode:n=!1}){const r=N.useRef(null),s=N.useRef(null),i=N.useRef(null),a=N.useRef(null),l=N.useRef(null),u=N.useRef(null),d=N.useRef(Math.random().toString(36).substr(2,9)),f=N.useRef(null),m=N.useRef(null),p=N.useRef(null),[v,x]=N.useState(!1),[_,E]=N.useState(!1),[k,b]=N.useState(!1),[S,C]=N.useState(!1),[P,R]=N.useState(document.documentElement.classList.contains("dark")),I=N.useRef(P),j={dark:{star:"rgba(255, 255, 255, 0.5)",special:"#3D84ED",wave:"rgba(255, 255, 255, 0.3)"},light:{star:"rgba(0, 0, 0, 0.5)",special:"#2563EB",wave:"rgba(0, 0, 0, 0.2)"}},O=400,V=120,z=80,D=N.useRef({stars:[],avg:0,width:0,height:0,cx:0,cy:0});N.useEffect(()=>{const ae=new MutationObserver(H=>{H.forEach(Q=>{if(Q.attributeName==="class"){const W=document.documentElement.classList.contains("dark");R(W),I.current=W,l.current&&l.current.setOptions({waveColor:W?j.dark.wave:j.light.wave})}})});return ae.observe(document.documentElement,{attributes:!0}),()=>ae.disconnect()},[]),N.useEffect(()=>{if(!i.current||!a.current)return;const ae=P?j.dark:j.light;l.current=$p.create({container:a.current,waveColor:ae.wave,progressColor:"#3D84ED",cursorColor:"#3D84ED",barWidth:4,barGap:3,barRadius:3,height:100,responsive:!0,normalize:!0,backend:"MediaElement",media:i.current,minPxPerSec:50,fillParent:!0,interact:!n,cursorWidth:2,barAlign:"bottom"});const H=Q=>{Q.detail.id!==d.current&&l.current&&l.current.isPlaying()&&l.current.pause()};return window.addEventListener("seshnx-audio-play",H),l.current.on("ready",()=>E(!0)),l.current.on("play",()=>{x(!0),window.dispatchEvent(new CustomEvent("seshnx-audio-play",{detail:{id:d.current}}))}),l.current.on("pause",()=>x(!1)),l.current.on("finish",()=>{x(!1),cancelAnimationFrame(u.current)}),()=>{window.removeEventListener("seshnx-audio-play",H),l.current&&l.current.destroy(),cancelAnimationFrame(u.current)}},[t,n]),N.useEffect(()=>{const ae=()=>{if(r.current&&s.current){const{clientWidth:H,clientHeight:Q}=r.current;s.current.width=H,s.current.height=Q,D.current.width=H,D.current.height=Q,D.current.cx=H/2,D.current.cy=Q/2,F()}};return window.addEventListener("resize",ae),ae(),()=>{window.removeEventListener("resize",ae),f.current&&f.current.state!=="closed"&&f.current.close()}},[]);const F=()=>{D.current.stars=[];for(let ae=0;ae<O;ae++)D.current.stars.push({x:Math.random()*D.current.width-D.current.cx,y:Math.random()*D.current.height-D.current.cy,z:Math.random()*D.current.width})},ee=()=>{if(!(S||k||!i.current))try{const ae=window.AudioContext||window.webkitAudioContext;f.current=new ae,m.current=f.current.createAnalyser(),m.current.fftSize=2048,p.current=f.current.createMediaElementSource(i.current),p.current.connect(m.current),m.current.connect(f.current.destination),C(!0)}catch(ae){console.warn("Audio Context Error:",ae)}},ue=async ae=>{var H;ae.stopPropagation(),S||ee(),((H=f.current)==null?void 0:H.state)==="suspended"&&await f.current.resume(),l.current&&l.current.playPause(),v||ve()},ve=()=>{if(!s.current)return;const ae=s.current.getContext("2d"),{width:H,height:Q,cx:W,cy:re,stars:he}=D.current;let ye=0;if(m.current){const G=m.current.frequencyBinCount,le=new Uint8Array(G);m.current.getByteFrequencyData(le);let De=0;for(let Qe=0;Qe<le.length;Qe++)De+=le[Qe];ye=De/le.length}D.current.avg=ye,ae.clearRect(0,0,H,Q);const Me=I.current?j.dark:j.light,Fe=ye>z?ye/10:ye/30+.5;he.forEach(G=>{G.z-=Fe,G.z<=0&&(G.z=H,G.x=Math.random()*H-W,G.y=Math.random()*Q-re);const le=G.x/G.z*H+W,De=G.y/G.z*Q+re,Qe=(1-G.z/H)*2.5;le>=0&&le<=H&&De>=0&&De<=Q&&(ae.fillStyle=ye>V?Me.special:Me.star,ae.globalAlpha=1-G.z/H,ae.beginPath(),ae.arc(le,De,Qe,0,Math.PI*2),ae.fill(),ae.globalAlpha=1)}),l.current&&l.current.isPlaying()&&(u.current=requestAnimationFrame(ve))};return o.jsxs("div",{ref:r,className:"relative w-full h-32 rounded-xl overflow-hidden group bg-transparent transition-colors",children:[o.jsx("canvas",{ref:s,className:"w-full h-full absolute inset-0 z-0 pointer-events-none"}),o.jsx("div",{className:"absolute inset-0 z-20 flex flex-col justify-end pointer-events-none",children:o.jsx("div",{ref:a,className:"w-full pointer-events-auto opacity-80 hover:opacity-100 transition-opacity"})}),o.jsxs("div",{className:"absolute top-0 left-0 right-0 p-3 z-30 flex justify-between items-start pointer-events-none",children:[o.jsxs("div",{className:"flex items-center gap-2 text-black dark:text-white/90",children:[o.jsx(co,{size:16,className:"text-brand-blue"}),o.jsx("span",{className:"text-sm font-medium truncate max-w-[200px] shadow-sm",children:e}),n&&o.jsxs("span",{className:"text-[10px] bg-yellow-500 text-black px-2 rounded font-bold flex items-center gap-1",children:[o.jsx(Vl,{size:8})," PREVIEW"]})]}),k&&o.jsxs("div",{className:"bg-red-500/80 text-white text-[10px] px-2 py-0.5 rounded flex items-center gap-1",children:[o.jsx(da,{size:10})," Visuals Disabled"]})]}),o.jsx("div",{className:"absolute bottom-2 left-2 z-30 opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none",children:o.jsx("img",{src:Sce,alt:"SeshNx",className:"w-5 h-5 object-contain"})}),o.jsx("div",{className:`absolute inset-0 z-40 flex items-center justify-center transition-opacity duration-300 pointer-events-none
                ${v?"opacity-0 group-hover:opacity-100 bg-white/20 dark:bg-black/20":"opacity-100 bg-white/10 dark:bg-black/10"}`,children:_?o.jsx("button",{onClick:ue,className:"w-14 h-14 bg-white/80 dark:bg-black/40 rounded-full flex items-center justify-center border border-gray-200 dark:border-white/40 text-brand-blue shadow-lg hover:scale-110 transition-transform pointer-events-auto",children:v?o.jsx(AV,{fill:"currentColor",className:"ml-0.5",size:24}):o.jsx(hE,{fill:"currentColor",className:"ml-1",size:24})}):o.jsx(Ye,{className:"animate-spin text-brand-blue",size:32})}),o.jsx("audio",{ref:i,src:t,crossOrigin:"anonymous",onError:()=>b(!0)})]})}function Tce({post:t,currentUser:e,currentUserData:n,blockedUsers:r,onCountChange:s}){const[i,a]=N.useState([]),[l,u]=N.useState(""),[d,f]=N.useState(!1);N.useEffect(()=>{const v=mt(Ce(Y,`artifacts/${qe}/public/data/posts/${t.id}/replies`),_n("timestamp","asc")),x=Qt(v,_=>{const k=_.docs.map(b=>({id:b.id,...b.data()})).filter(b=>!(r!=null&&r.includes(b.userId)));a(k),s(k.length)});return()=>x()},[t.id]);const m=async v=>{var _;if(v.preventDefault(),!l.trim()||!(e!=null&&e.uid))return;f(!0);const x=(n==null?void 0:n.effectiveDisplayName)||(n==null?void 0:n.firstName)||(e==null?void 0:e.displayName)||"User";try{await Gt(Ce(Y,`artifacts/${qe}/public/data/posts/${t.id}/replies`),{text:l,userId:e.uid,displayName:x,userPhoto:(n==null?void 0:n.photoURL)||null,timestamp:jt()}),t.userId!==e.uid&&C6({targetUserId:t.userId,type:"comment",fromUserId:e.uid,fromUserName:x,fromUserPhoto:n==null?void 0:n.photoURL,postId:t.id,postPreview:(_=t.text)==null?void 0:_.substring(0,50),message:"commented on your post"}),u("")}catch(E){console.error(E)}f(!1)},p=async v=>{if(window.confirm("Delete comment?"))try{await Pi(ke(Y,`artifacts/${qe}/public/data/posts/${t.id}/replies`,v))}catch(x){console.error("Delete comment error:",x)}};return o.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] border-t dark:border-gray-700 p-4 animate-in slide-in-from-top-2",children:[o.jsxs("div",{className:"space-y-4 mb-4 max-h-80 overflow-y-auto custom-scrollbar pr-2",children:[i.length===0&&o.jsx("div",{className:"text-center text-gray-400 text-xs py-2",children:"No comments yet. Be the first!"}),i.map(v=>o.jsxs("div",{className:"group flex gap-3 text-sm",children:[o.jsx(ai,{src:v.userPhoto,name:v.displayName,size:"xs",className:"shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"bg-white dark:bg-dark-card border dark:border-gray-700 p-3 rounded-2xl rounded-tl-none inline-block max-w-full",children:[o.jsxs("div",{className:"flex justify-between items-baseline gap-2 mb-1",children:[o.jsx("span",{className:"font-bold dark:text-white text-xs truncate",children:v.displayName}),o.jsx("span",{className:"text-[10px] text-gray-400 shrink-0",children:v.timestamp?new Date(v.timestamp.toMillis()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"..."})]}),o.jsx("p",{className:"text-gray-700 dark:text-gray-300 break-words",children:v.text})]}),o.jsxs("div",{className:"flex gap-3 mt-1 ml-2",children:[o.jsx("button",{className:"text-[10px] font-bold text-gray-500 hover:text-brand-blue transition",children:"Reply"}),v.userId===(e==null?void 0:e.uid)&&o.jsx("button",{onClick:()=>p(v.id),className:"text-[10px] font-bold text-gray-400 hover:text-red-500 transition",children:"Delete"})]})]})]},v.id))]}),o.jsxs("form",{onSubmit:m,className:"flex gap-2",children:[o.jsx(ai,{src:n==null?void 0:n.photoURL,name:(n==null?void 0:n.firstName)||"You",size:"xs",className:"shrink-0 hidden sm:block"}),o.jsx("input",{className:"flex-1 bg-white dark:bg-dark-card border dark:border-gray-600 rounded-full px-4 py-2 text-sm focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition",placeholder:"Write a comment...",value:l,onChange:v=>u(v.target.value)}),o.jsx("button",{type:"submit",disabled:!l.trim()||d,className:"bg-brand-blue text-white p-2 rounded-full hover:bg-blue-600 disabled:opacity-50 transition shadow-sm",children:o.jsx(pb,{size:16,className:d?"animate-pulse":""})})]})]})}function YE({isFollowing:t,onToggle:e,size:n="md",variant:r="default",disabled:s=!1,showIcon:i=!0,className:a=""}){const[l,u]=N.useState(!1),[d,f]=N.useState(!1),m=async b=>{if(b.stopPropagation(),!(s||l)){u(!0);try{await e()}catch(S){console.error("Follow toggle error:",S)}u(!1)}},p={sm:"px-3 py-1 text-xs",md:"px-4 py-1.5 text-sm",lg:"px-6 py-2 text-base"},v={sm:12,md:14,lg:16},x=()=>t?r==="outline"||r==="minimal"?d?"border-red-300 text-red-500 hover:bg-red-50 dark:border-red-800 dark:hover:bg-red-900/20":"border-gray-300 text-gray-700 dark:border-gray-600 dark:text-gray-300":d?"bg-red-500 text-white hover:bg-red-600":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200":r==="outline"?"border-brand-blue text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20":r==="minimal"?"text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20":"bg-brand-blue text-white hover:bg-blue-600",_=`
        font-semibold rounded-full transition-all duration-200 
        flex items-center justify-center gap-1.5
        disabled:opacity-50 disabled:cursor-not-allowed
        ${r==="outline"?"border-2 bg-transparent":""}
        ${r==="minimal"?"bg-transparent":""}
        ${p[n]}
        ${x()}
        ${a}
    `,E=()=>l?o.jsx(Ye,{className:"animate-spin",size:v[n]}):t?d?o.jsx(Lne,{size:v[n]}):o.jsx(_1,{size:v[n]}):o.jsx(Fl,{size:v[n]}),k=()=>t?d?"Unfollow":"Following":"Follow";return o.jsx(tt.button,{whileHover:{scale:s?1:1.02},whileTap:{scale:s?1:.98},className:_,onClick:m,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),disabled:s||l,children:o.jsx(Zn,{mode:"wait",children:o.jsxs(tt.span,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},transition:{duration:.15},className:"flex items-center gap-1.5",children:[i&&E(),o.jsx("span",{children:k()})]},`${t}-${d}`)})})}const Ece=["","","","","",""],Cce=t=>t?t.split(/(\s+)/).map((e,n)=>e.match(/^#\w+/)?o.jsx("span",{className:"text-brand-blue font-bold cursor-pointer hover:underline",children:e},n):e.match(/^@\w+/)?o.jsx("span",{className:"text-purple-600 font-bold cursor-pointer hover:underline",children:e},n):e):null,jce={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:24}},exit:{opacity:0,scale:.95,transition:{duration:.2}}};function Ice({post:t,currentUser:e,currentUserData:n,openPublicProfile:r,onReport:s,isFollowingAuthor:i,onToggleFollow:a}){var ve,ae,H;const[l,u]=N.useState(!1),[d,f]=N.useState(t.commentCount||0),[m,p]=N.useState(!1),[v,x]=N.useState(!1),[_,E]=N.useState(!1),[k,b]=N.useState(!1),[S,C]=N.useState(!1),P=N.useRef(null),R=N.useRef(null),I=t.userId===(e==null?void 0:e.uid),j=(ve=t.reactions)==null?void 0:ve[e==null?void 0:e.uid],O=t.reactions?Object.values(t.reactions).reduce((Q,W)=>(Q[W]=(Q[W]||0)+1,Q),{}):{},V=Object.values(O).reduce((Q,W)=>Q+W,0);N.useEffect(()=>{if(!(e!=null&&e.uid))return;(async()=>{try{const W=ke(Y,Le(e.uid).savedPosts,t.id),re=await ki(W);p(re.exists())}catch(W){console.error("Error checking saved status:",W)}})()},[e==null?void 0:e.uid,t.id]),N.useEffect(()=>{const Q=W=>{P.current&&!P.current.contains(W.target)&&x(!1),R.current&&!R.current.contains(W.target)&&E(!1)};return document.addEventListener("mousedown",Q),()=>document.removeEventListener("mousedown",Q)},[]);const z=async Q=>{var re;if(x(!1),!(e!=null&&e.uid))return;const W=ke(Y,`artifacts/${qe}/public/data/posts/${t.id}`);try{const he={},ye=!!j;j===Q?(he[`reactions.${e.uid}`]=wQ(),he.reactionCount=Ni(-1)):(he[`reactions.${e.uid}`]=Q,j||(he.reactionCount=Ni(1)),!ye&&!I&&C6({targetUserId:t.userId,type:"like",fromUserId:e.uid,fromUserName:(n==null?void 0:n.effectiveDisplayName)||(n==null?void 0:n.firstName)||"Someone",fromUserPhoto:n==null?void 0:n.photoURL,postId:t.id,postPreview:(re=t.text)==null?void 0:re.substring(0,50),message:`reacted ${Q} to your post`})),await ft(W,he)}catch(he){console.error("Reaction failed",he),Wt.error("Couldn't add reaction")}},D=async()=>{var Q,W;if(!(!(e!=null&&e.uid)||S)){C(!0);try{const re=ke(Y,Le(e.uid).savedPosts,t.id),he=ke(Y,`artifacts/${qe}/public/data/posts/${t.id}`);m?(await Pi(re),await ft(he,{saveCount:Ni(-1)}),p(!1),Wt.success("Removed from saved")):(await Ka(re,{postId:t.id,authorId:t.userId,authorName:t.displayName,preview:((Q=t.text)==null?void 0:Q.substring(0,100))||"Media post",savedAt:new Date,hasMedia:!!((W=t.attachments)!=null&&W.length||t.imageUrl||t.audioUrl)}),await ft(he,{saveCount:Ni(1)}),p(!0),Wt.success("Post saved!"))}catch(re){console.error("Save failed",re),Wt.error("Couldn't save post")}C(!1)}},F=async()=>{var W;const Q=`${window.location.origin}/post/${t.id}`;if(navigator.share)try{await navigator.share({title:`Post by ${t.displayName}`,text:((W=t.text)==null?void 0:W.substring(0,100))||"Check out this post",url:Q})}catch(re){re.name!=="AbortError"&&ee(Q)}else ee(Q)},ee=Q=>{navigator.clipboard.writeText(Q),b(!0),Wt.success("Link copied to clipboard!"),setTimeout(()=>b(!1),2e3)},ue=async()=>{if(I&&window.confirm("Are you sure you want to delete this post?"))try{const Q=ke(Y,`artifacts/${qe}/public/data/posts/${t.id}`);await Pi(Q),Wt.success("Post deleted")}catch(Q){console.error("Delete failed:",Q),Wt.error("Couldn't delete post")}};return o.jsxs(tt.div,{variants:jce,initial:"hidden",animate:"show",exit:"exit",layout:!0,className:"bg-white dark:bg-dark-card border dark:border-gray-700 rounded-xl overflow-visible shadow-sm mb-4 relative",children:[o.jsxs("div",{className:"p-4 flex justify-between items-start",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden cursor-pointer shrink-0",onClick:()=>r(t.userId),children:t.authorPhoto?o.jsx("img",{src:t.authorPhoto,className:"h-full w-full object-cover",alt:"avatar"}):o.jsx("div",{className:"h-full w-full bg-gradient-to-tr from-brand-blue to-purple-500 flex items-center justify-center text-white font-bold",children:((ae=t.displayName)==null?void 0:ae[0])||o.jsx(wr,{size:16})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"font-bold dark:text-white text-sm hover:underline decoration-brand-blue cursor-pointer truncate",onClick:()=>r(t.userId),children:t.displayName}),!I&&a&&!i&&o.jsx("button",{onClick:Q=>{Q.stopPropagation(),a()},className:"text-xs font-bold text-brand-blue hover:text-blue-700 transition shrink-0",children:" Follow"})]}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[o.jsx("span",{className:"truncate",children:t.role}),o.jsx("span",{children:""}),o.jsx("span",{className:"shrink-0",children:t.timestamp?new Date(t.timestamp.toMillis?t.timestamp.toMillis():t.timestamp).toLocaleDateString():"Just now"})]})]})]}),o.jsxs("div",{className:"relative",ref:R,children:[o.jsx("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-white transition p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>E(!_),children:o.jsx(jne,{size:20})}),o.jsx(Zn,{children:_&&o.jsxs(tt.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-xl border dark:border-gray-700 overflow-hidden z-50",children:[o.jsxs("button",{onClick:()=>{ee(`${window.location.origin}/post/${t.id}`),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:[o.jsx(Sne,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"dark:text-gray-200",children:"Copy link"})]}),!I&&o.jsxs(o.Fragment,{children:[a&&o.jsxs("button",{onClick:()=>{a(),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:[o.jsx(Fl,{size:16,className:"text-gray-400"}),o.jsxs("span",{className:"dark:text-gray-200",children:[i?"Unfollow":"Follow"," ",(H=t.displayName)==null?void 0:H.split(" ")[0]]})]}),o.jsxs("button",{onClick:()=>{s(),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition text-red-500",children:[o.jsx(wh,{size:16}),o.jsx("span",{children:"Report post"})]})]}),I&&o.jsxs("button",{onClick:()=>{ue(),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition text-red-500",children:[o.jsx(Mr,{size:16}),o.jsx("span",{children:"Delete post"})]})]})})]})]}),o.jsxs("div",{className:"px-4 pb-2",children:[t.text&&o.jsx("p",{className:"text-gray-800 dark:text-gray-200 whitespace-pre-wrap text-sm leading-relaxed mb-3",children:Cce(t.text)}),t.attachments&&t.attachments.length>0&&o.jsx("div",{className:`grid gap-2 mb-3 ${t.attachments.length>1?"grid-cols-2":"grid-cols-1"}`,children:t.attachments.map((Q,W)=>o.jsxs("div",{className:"rounded-lg overflow-hidden bg-transparent relative",children:[Q.type==="image"&&o.jsx("img",{src:Q.url,className:"w-full h-full object-cover max-h-96",alt:"content"}),Q.type==="video"&&o.jsx("video",{src:Q.url,controls:!0,className:"w-full h-full max-h-96 bg-black"}),Q.type==="audio"&&o.jsx("div",{className:"w-full",children:o.jsx(W1,{audioUrl:Q.url,fileName:Q.name||"Audio Track"})})]},W))}),t.audioUrl&&!t.attachments&&o.jsx("div",{className:"rounded-lg overflow-hidden bg-transparent mb-3",children:o.jsx(W1,{audioUrl:t.audioUrl,fileName:t.audioName||"Track"})}),t.imageUrl&&!t.attachments&&o.jsx("img",{src:t.imageUrl,className:"rounded-lg w-full mb-3 border dark:border-gray-700",alt:"legacy content"})]}),(V>0||t.saveCount>0)&&o.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[o.jsx("div",{className:"flex gap-1",children:Object.entries(O).map(([Q,W])=>o.jsxs(tt.div,{initial:{scale:0},animate:{scale:1},className:`text-xs px-2 py-1 rounded-full border flex items-center gap-1 ${j===Q?"bg-blue-50 border-blue-200 dark:bg-blue-900/30 dark:border-blue-800":"bg-gray-50 border-gray-100 dark:bg-gray-800 dark:border-gray-700"} dark:text-gray-300`,children:[o.jsx("span",{children:Q}),o.jsx("span",{className:"font-bold",children:W})]},Q))}),t.saveCount>0&&o.jsxs("span",{className:"text-xs text-gray-400",children:[t.saveCount," save",t.saveCount!==1?"s":""]})]}),o.jsxs("div",{className:"px-4 py-3 border-t dark:border-gray-700 flex items-center justify-between relative",children:[o.jsxs("div",{className:"flex gap-2 sm:gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsxs(tt.button,{whileTap:{scale:.9},onClick:()=>x(!v),className:`flex items-center gap-1.5 sm:gap-2 text-sm font-medium transition px-2 py-1 rounded-lg ${j?"text-blue-600 bg-blue-50 dark:bg-blue-900/20":"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[j?o.jsx("span",{className:"text-lg",children:j}):o.jsx(LV,{size:18}),o.jsx("span",{className:"hidden sm:inline",children:j?"Reacted":"React"})]}),o.jsx(Zn,{children:v&&o.jsx(tt.div,{ref:P,initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:10},className:"absolute bottom-full left-0 mb-2 bg-white dark:bg-gray-800 shadow-xl rounded-full p-2 flex gap-1 sm:gap-2 z-50 border dark:border-gray-600 origin-bottom-left",children:Ece.map(Q=>o.jsx(tt.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:W=>{W.stopPropagation(),z(Q)},className:`text-xl p-1 sm:p-1.5 rounded-full ${j===Q?"bg-blue-100 dark:bg-blue-900":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:Q},Q))})})]}),o.jsxs(tt.button,{whileTap:{scale:.95},onClick:()=>u(!l),className:"flex items-center gap-1.5 sm:gap-2 text-sm font-medium text-gray-500 hover:text-brand-blue transition px-2 py-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:[o.jsx(ou,{size:18}),o.jsx("span",{className:"hidden sm:inline",children:d>0?d:"Comment"}),d>0&&o.jsx("span",{className:"sm:hidden",children:d})]}),o.jsxs(tt.button,{whileTap:{scale:.95},onClick:F,className:`flex items-center gap-1.5 sm:gap-2 text-sm font-medium transition px-2 py-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 ${k?"text-green-500":"text-gray-500 hover:text-green-500"}`,children:[k?o.jsx(Cs,{size:18}):o.jsx(Ane,{size:18}),o.jsx("span",{className:"hidden sm:inline",children:k?"Copied!":"Share"})]})]}),o.jsx(tt.button,{whileTap:{scale:.8},onClick:D,disabled:S,className:`${m?"text-brand-blue":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"} transition p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full disabled:opacity-50`,title:m?"Remove from saved":"Save post",children:o.jsx(vV,{size:18,fill:m?"currentColor":"none"})})]}),o.jsx(Zn,{children:l&&o.jsx(tt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:o.jsx(Tce,{post:t,currentUser:e,currentUserData:n,blockedUsers:[],onCountChange:f})})})]})}const ha=()=>{const[t,e]=N.useState(!1),[n,r]=N.useState(null);return{uploadMedia:async(i,a)=>{if(!i)return null;if(!B0)return r("Firebase Storage is not configured. Please set VITE_FIREBASE_STORAGE_BUCKET in your environment variables."),console.error("Firebase Storage is not available. storageBucket is missing from Firebase config."),null;e(!0),r(null);try{const u=`${Date.now()}_${i.name.replace(/[^a-zA-Z0-9.]/g,"_")}`,d=`${a}/${u}`,f=e3(B0,d),m=await X5(f,i),p=await J5(m.ref);return e(!1),{url:p,type:i.type.startsWith("video/")?"video":i.type.startsWith("audio/")?"audio":"image",name:i.name}}catch(l){return console.error("Upload failed:",l),r(l),e(!1),null}},uploading:t,error:n}};function Q6({text:t,onRemove:e}){return o.jsxs("span",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-700 text-sm px-2 py-1 rounded-full text-gray-700 dark:text-gray-300",children:[t,o.jsx(ut,{size:12,className:"cursor-pointer hover:text-red-500",onClick:e})]})}function XE({label:t,fieldKey:e,options:n,initialValues:r,onChange:s}){const[i,a]=N.useState(""),[l,u]=N.useState(r||[]);N.useEffect(()=>{u(r||[])},[r]);const d=()=>{if(i&&!l.includes(i)){const m=[...l,i];u(m),s(e,m),a("")}},f=m=>{const p=l.filter(v=>v!==m);u(p),s(e,p)};return o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:t}),o.jsxs("div",{className:"flex gap-2 mb-2",children:[o.jsxs("select",{className:"flex-1 p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:i,onChange:m=>a(m.target.value),children:[o.jsx("option",{value:"",children:"Select..."}),n.map(m=>o.jsx("option",{value:m,children:m},m))]}),o.jsx("button",{type:"button",onClick:d,className:"bg-brand-blue text-white px-3 rounded-lg text-sm",children:"Add"})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(m=>o.jsx(Q6,{text:m,onRemove:()=>f(m)},m))})]})}function Ace({label:t,fieldKey:e,data:n,initialValues:r,onChange:s}){const[i,a]=N.useState(""),[l,u]=N.useState(""),[d,f]=N.useState(r||[]);N.useEffect(()=>{f(r||[])},[r]);const m=n[i]||[],p=()=>{const x=i&&l?`${i} - ${l}`:"";if(x&&!d.includes(x)){const _=[...d,x];f(_),s(e,_),u("")}},v=x=>{const _=d.filter(E=>E!==x);f(_),s(e,_)};return o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:t}),o.jsxs("div",{className:"flex gap-2 mb-2",children:[o.jsxs("select",{className:"w-1/3 p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:i,onChange:x=>{a(x.target.value),u("")},children:[o.jsx("option",{value:"",children:"Category..."}),Object.keys(n).map(x=>o.jsx("option",{value:x,children:x},x))]}),o.jsxs("select",{className:"w-1/3 p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:l,onChange:x=>u(x.target.value),disabled:!i,children:[o.jsx("option",{value:"",children:"Select..."}),m.map(x=>o.jsx("option",{value:x,children:x},x))]}),o.jsx("button",{type:"button",onClick:p,className:"bg-brand-blue text-white px-3 rounded-lg text-sm",children:"Add"})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(x=>o.jsx(Q6,{text:x,onRemove:()=>v(x)},x))})]})}function Rce({user:t,userData:e,onPost:n}){const[r,s]=N.useState(""),[i,a]=N.useState([]),[l,u]=N.useState(!1),[d,f]=N.useState([]),[m,p]=N.useState(null),[v,x]=N.useState(!1),{uploadMedia:_}=ha(),E=(S,C)=>{if(S.target.files&&S.target.files[0]){const P=S.target.files[0],R=URL.createObjectURL(P);a([...i,{file:P,type:C,previewUrl:R}])}},k=S=>{a(i.filter((C,P)=>P!==S))},b=async()=>{if(!(!r.trim()&&i.length===0)){x(!0);try{const S=await Promise.all(i.map(async R=>{const I=R.type==="video"?"postVideos":R.type==="audio"?"postAudio":"postImages",j=`artifacts/${t.uid}/${I}`,O=await _(R.file,j);return O?{...O,type:R.type}:null}));let C=null;if(m){const R=await _(m,`artifacts/${t.uid}/postPresets`);C=R==null?void 0:R.url}const P={text:r,attachments:S.filter(R=>R!==null),seshFx:l&&(d.length>0||C)?{plugins:d,presetUrl:C,presetName:m?m.name:null}:null};await n(P),s(""),a([]),u(!1),f([]),p(null)}catch(S){console.error("Error creating post:",S),alert("Failed to create post. Please try again.")}finally{x(!1)}}};return o.jsx("div",{className:"bg-white dark:bg-dark-card p-4 rounded-xl border dark:border-gray-700 shadow-sm mb-6",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden shrink-0",children:e!=null&&e.photoURL?o.jsx("img",{src:e.photoURL,className:"h-full w-full object-cover"}):o.jsx("div",{className:"h-full w-full bg-brand-blue"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("textarea",{className:"w-full bg-transparent outline-none text-gray-900 dark:text-white placeholder-gray-500 min-h-[80px] resize-none",placeholder:"What's creating sound today? (#tags @mentions)",value:r,onChange:S=>s(S.target.value)}),i.length>0&&o.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:i.map((S,C)=>o.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-black/5 border dark:border-gray-600 aspect-video group flex items-center justify-center",children:[S.type==="image"&&o.jsx("img",{src:S.previewUrl,className:"h-full w-full object-cover"}),S.type==="video"&&o.jsx("video",{src:S.previewUrl,className:"h-full w-full object-cover"}),S.type==="audio"&&o.jsxs("div",{className:"flex flex-col items-center justify-center text-brand-blue bg-gray-100 dark:bg-gray-800 w-full h-full",children:[o.jsx(co,{size:32}),o.jsx("span",{className:"text-xs text-gray-500 mt-2 truncate max-w-[90%] px-2",children:S.file.name})]}),o.jsx("button",{onClick:()=>k(C),className:"absolute top-1 right-1 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition hover:bg-red-500",children:o.jsx(ut,{size:12})})]},C))}),l&&o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg mb-3 border border-blue-100 dark:border-blue-800/50 animate-in slide-in-from-top-2",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"text-xs font-bold text-brand-blue uppercase",children:"SeshFx Data"}),o.jsx("button",{onClick:()=>u(!1),children:o.jsx(ut,{size:14,className:"text-gray-400 hover:text-brand-blue"})})]}),o.jsx(XE,{label:"",options:Ule,initialValues:d,onChange:(S,C)=>f(C)}),o.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[o.jsx(IV,{size:14,className:"text-gray-400"}),o.jsx("input",{type:"file",className:"text-xs text-gray-500 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-xs file:bg-white dark:file:bg-gray-700 dark:file:text-white",onChange:S=>p(S.target.files[0])})]})]}),o.jsxs("div",{className:"flex justify-between items-center pt-2 border-t dark:border-gray-700",children:[o.jsxs("div",{className:"flex gap-1",children:[o.jsxs("label",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-brand-blue cursor-pointer transition",title:"Add Image",children:[o.jsx($0,{size:20}),o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:S=>E(S,"image")})]}),o.jsxs("label",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-green-500 cursor-pointer transition",title:"Add Video",children:[o.jsx(ku,{size:20}),o.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:S=>E(S,"video")})]}),o.jsxs("label",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-purple-500 cursor-pointer transition",title:"Add Audio Track",children:[o.jsx(co,{size:20}),o.jsx("input",{type:"file",className:"hidden",accept:"audio/*",onChange:S=>E(S,"audio")})]}),o.jsx("button",{onClick:()=>u(!l),className:`p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition ${l?"bg-blue-50 dark:bg-blue-900/20 text-brand-blue":"text-gray-400"}`,title:"Add Plugin Data",children:o.jsx(wg,{size:20})})]}),o.jsx("button",{onClick:b,disabled:v||!r&&i.length===0,className:"bg-brand-blue text-white px-5 py-1.5 rounded-full font-bold text-sm hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition",children:v?o.jsx(Ye,{className:"animate-spin",size:16}):o.jsxs(o.Fragment,{children:["Post ",o.jsx(pb,{size:14})]})})]})]})]})})}const uP=["Spam or commercial solicitation","Harassment or bullying","Hate speech","Nudity or sexual activity","Violence or dangerous organizations","Copyright / Intellectual Property Violation","Scam or fraud","Other"],Pce=async({contentId:t,contentType:e,contentSummary:n,reporterId:r,reporterName:s,reason:i,description:a="",schoolId:l=null,isFacultyAction:u=!1})=>{try{if(await Gt(Ce(Y,`artifacts/${qe}/moderation_queue`),{type:"Report",status:"Open",priority:u?"High":"Normal",targetId:t,targetType:e,targetSummary:n||"No preview available",reporterId:r,reporterName:s,reason:i,description:a,schoolId:l,timestamp:jt()}),u&&(e==="post"||e==="comment")){const d=e==="post"?`artifacts/${qe}/public/data/posts`:`artifacts/${qe}/public/data/comments`;await ft(ke(Y,d,t),{visibility:"Hidden",moderationStatus:"Flagged",flaggedBy:r,flaggedAt:jt()})}return{success:!0}}catch(d){return console.error("Reporting failed:",d),{success:!1,error:d}}};function Z6({user:t,target:e,onClose:n}){const[r,s]=N.useState(uP[0]),[i,a]=N.useState(""),[l,u]=N.useState(!1),[d,f]=N.useState(!1),m=async()=>{if(!(!r||!(t!=null&&t.uid))){u(!0);try{(await Pce({contentId:e.id,contentType:e.type,contentSummary:e.summary,reporterId:t.uid,reporterName:t.displayName||"Anonymous User",reason:r,description:i})).success?(f(!0),setTimeout(n,2e3)):alert("Failed to submit report. Please try again.")}catch(p){console.error("Submission error:",p),alert("An unexpected error occurred during submission.")}u(!1)}};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:o.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-lg animate-in fade-in zoom-in-95 duration-200",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("h3",{className:"font-bold text-xl dark:text-white flex items-center gap-2 text-red-500",children:[o.jsx(kl,{size:24})," Report Violation"]}),o.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-800 dark:text-gray-400 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 mb-6",children:["You are reporting a violation regarding: ",o.jsx("strong",{className:"font-bold",children:e.summary})," (",e.type,")"]}),d?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(wh,{size:48,className:"text-green-500 mx-auto mb-4"}),o.jsx("h4",{className:"font-bold text-lg dark:text-white",children:"Report Submitted!"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for helping keep the community safe. We will review this shortly."})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Reason for Report"}),o.jsx("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:r,onChange:p=>s(p.target.value),children:uP.map(p=>o.jsx("option",{value:p,children:p},p))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Additional Details (Optional)"}),o.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm resize-none",rows:"3",placeholder:"Provide any further context or relevant details.",value:i,onChange:p=>a(p.target.value)})]}),o.jsx("button",{onClick:m,disabled:l,className:"w-full bg-red-600 text-white py-3 rounded-xl font-bold hover:bg-red-700 transition disabled:opacity-50 flex items-center justify-center gap-2 shadow-md",children:l?o.jsx(Ye,{className:"animate-spin",size:18}):o.jsxs(o.Fragment,{children:[o.jsx(wh,{size:18})," Submit Report"]})})]})]})})})}function Y6(t,e){const[n,r]=N.useState([]),[s,i]=N.useState([]),[a,l]=N.useState({followersCount:0,followingCount:0}),[u,d]=N.useState(!0);N.useEffect(()=>{if(!t){d(!1);return}const E=Ce(Y,Le(t).following),k=Ce(Y,Le(t).followers),b=ke(Y,Le(t).socialStats),S=Qt(mt(E,_n("timestamp","desc")),R=>{const I=R.docs.map(j=>({odId:j.id,...j.data()}));r(I)},R=>console.error("Following listener error:",R)),C=Qt(mt(k,_n("timestamp","desc")),R=>{const I=R.docs.map(j=>({odId:j.id,...j.data()}));i(I)},R=>console.error("Followers listener error:",R)),P=Qt(b,R=>{R.exists()&&l(R.data()),d(!1)});return()=>{S(),C(),P()}},[t]);const f=N.useCallback(E=>n.some(k=>k.odId===E),[n]),m=N.useCallback(async(E,k)=>{if(!t||!E||t===E)return;const b=T0(Y),S=ke(Y,Le(t).following,E);b.set(S,{displayName:(k==null?void 0:k.displayName)||(k==null?void 0:k.firstName)||"User",photoURL:(k==null?void 0:k.photoURL)||null,role:(k==null?void 0:k.activeProfileRole)||"User",timestamp:jt()});const C=ke(Y,Le(E).followers,t);b.set(C,{displayName:(e==null?void 0:e.displayName)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim()||"User",photoURL:(e==null?void 0:e.photoURL)||null,role:(e==null?void 0:e.activeProfileRole)||"User",timestamp:jt()});const P=ke(Y,Le(t).socialStats);b.set(P,{followingCount:Ni(1)},{merge:!0});const R=ke(Y,Le(E).socialStats);b.set(R,{followersCount:Ni(1)},{merge:!0});const I=ke(Ce(Y,Le(E).notifications));b.set(I,{type:"follow",fromUserId:t,fromUserName:(e==null?void 0:e.displayName)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim()||"Someone",fromUserPhoto:(e==null?void 0:e.photoURL)||null,message:"started following you",read:!1,timestamp:jt()});try{return await b.commit(),{success:!0}}catch(j){return console.error("Follow error:",j),{success:!1,error:j}}},[t,e]),p=N.useCallback(async E=>{if(!t||!E)return;const k=T0(Y),b=ke(Y,Le(t).following,E);k.delete(b);const S=ke(Y,Le(E).followers,t);k.delete(S);const C=ke(Y,Le(t).socialStats);k.set(C,{followingCount:Ni(-1)},{merge:!0});const P=ke(Y,Le(E).socialStats);k.set(P,{followersCount:Ni(-1)},{merge:!0});try{return await k.commit(),{success:!0}}catch(R){return console.error("Unfollow error:",R),{success:!1,error:R}}},[t]),v=N.useCallback(async(E,k)=>f(E)?p(E):m(E,k),[f,m,p]),x=N.useCallback(async E=>{try{const k=await ki(ke(Y,Le(E).socialStats));return k.exists()?k.data():{followersCount:0,followingCount:0}}catch(k){return console.error("Get stats error:",k),{followersCount:0,followingCount:0}}},[]),_=N.useCallback(()=>n.map(E=>E.odId),[n]);return{following:n,followers:s,stats:a,loading:u,isFollowing:f,followUser:m,unfollowUser:p,toggleFollow:v,getUserStats:x,getFollowingIds:_}}function Lce(t){const[e,n]=N.useState({followersCount:0,followingCount:0}),[r,s]=N.useState(!0);return N.useEffect(()=>{if(!t){s(!1);return}const i=ke(Y,Le(t).socialStats),a=Qt(i,l=>{l.exists()&&n(l.data()),s(!1)});return()=>a()},[t]),{stats:e,loading:r}}const bs={FOR_YOU:"for_you",FOLLOWING:"following"};function Mce({user:t,userData:e,openPublicProfile:n}){const[r,s]=N.useState([]),[i,a]=N.useState(!0),[l,u]=N.useState(null),[d,f]=N.useState(bs.FOR_YOU),[m,p]=N.useState([]),[v,x]=N.useState(!1),{following:_,stats:E,loading:k,isFollowing:b,toggleFollow:S,getFollowingIds:C}=Y6(t==null?void 0:t.uid,e),P=N.useMemo(()=>C(),[_]);N.useEffect(()=>{d===bs.FOLLOWING&&P.length===0&&(t!=null&&t.uid)&&R()},[d,P.length,t==null?void 0:t.uid]);const R=async()=>{x(!0);try{const V=mt(Ce(Y,`artifacts/${qe}/public/data/posts`),_n("timestamp","desc"),fs(20)),z=await Pt(V),D=new Map;z.docs.forEach(F=>{const ee=F.data();ee.userId!==(t==null?void 0:t.uid)&&!D.has(ee.userId)&&D.set(ee.userId,{userId:ee.userId,displayName:ee.displayName,photoURL:ee.authorPhoto,role:ee.role})}),p(Array.from(D.values()).slice(0,5))}catch(V){console.error("Error loading suggestions:",V)}x(!1)};N.useEffect(()=>{a(!0);const V=`artifacts/${qe}/public/data/posts`;let z;d===bs.FOLLOWING&&P.length>0?z=mt(Ce(Y,V),_n("timestamp","desc"),fs(50)):z=mt(Ce(Y,V),_n("timestamp","desc"),fs(20));const D=Qt(z,F=>{let ee=F.docs.map(ue=>({id:ue.id,...ue.data()}));d===bs.FOLLOWING&&P.length>0&&(ee=ee.filter(ue=>P.includes(ue.userId)||ue.userId===(t==null?void 0:t.uid))),s(ee),a(!1)},F=>{console.error("Feed error:",F),a(!1)});return()=>D()},[d,P,t==null?void 0:t.uid]);const I=async V=>{if(t)try{await Gt(Ce(Y,`artifacts/${qe}/public/data/posts`),{...V,userId:t.uid,displayName:(e==null?void 0:e.effectiveDisplayName)||`${(e==null?void 0:e.firstName)||"User"} ${(e==null?void 0:e.lastName)||""}`.trim(),authorPhoto:(e==null?void 0:e.photoURL)||null,role:(e==null?void 0:e.activeProfileRole)||"User",timestamp:jt(),reactions:{},reactionCount:0,commentCount:0,saveCount:0,visibility:"Public"})}catch(z){console.error("Failed to post:",z),alert("Could not post update. Please try again.")}},j={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.08}}},O=({suggestedUser:V})=>o.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-between p-3 bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 hover:border-brand-blue/30 transition-all",children:[o.jsxs("div",{className:"flex items-center gap-3 cursor-pointer flex-1 min-w-0",onClick:()=>n==null?void 0:n(V.userId),children:[o.jsx(ai,{src:V.photoURL,name:V.displayName,size:"md"}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("h4",{className:"font-bold text-sm dark:text-white truncate hover:text-brand-blue transition",children:V.displayName}),o.jsx("p",{className:"text-xs text-gray-500 truncate",children:V.role})]})]}),o.jsx(YE,{isFollowing:b(V.userId),onToggle:()=>S(V.userId,V),size:"sm",variant:"default"})]});return o.jsxs("div",{className:"max-w-2xl mx-auto pb-20",children:[o.jsx(Rce,{user:t,userData:e,onPost:I}),o.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-white dark:bg-dark-card p-1.5 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("button",{onClick:()=>f(bs.FOR_YOU),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold transition-all ${d===bs.FOR_YOU?"bg-brand-blue text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx(hne,{size:16}),o.jsx("span",{children:"For You"})]}),o.jsxs("button",{onClick:()=>f(bs.FOLLOWING),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold transition-all ${d===bs.FOLLOWING?"bg-brand-blue text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx(Gr,{size:16}),o.jsx("span",{children:"Following"}),E.followingCount>0&&o.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d===bs.FOLLOWING?"bg-white/20":"bg-gray-200 dark:bg-gray-700"}`,children:E.followingCount})]})]}),i||k?o.jsx("div",{className:"flex justify-center py-10",children:o.jsx(Ye,{className:"animate-spin text-brand-blue",size:32})}):o.jsxs(o.Fragment,{children:[d===bs.FOLLOWING&&P.length===0&&o.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-2xl p-6 mb-6 border border-blue-100 dark:border-blue-800/30",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-brand-blue/10 flex items-center justify-center",children:o.jsx(Fl,{size:28,className:"text-brand-blue"})}),o.jsx("h3",{className:"text-lg font-bold dark:text-white mb-2",children:"Start following creators"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-sm mx-auto",children:"Follow artists, engineers, and studios to see their posts in your Following feed."})]}),v?o.jsx("div",{className:"flex justify-center py-4",children:o.jsx(Ye,{className:"animate-spin text-brand-blue",size:24})}):m.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Suggested for you"}),m.map(V=>o.jsx(O,{suggestedUser:V},V.userId))]})]}),o.jsxs(tt.div,{variants:j,initial:"hidden",animate:"show",className:"space-y-4",children:[o.jsx(Zn,{mode:"popLayout",children:r.map(V=>o.jsx(Ice,{post:V,currentUser:t,currentUserData:e,openPublicProfile:n||(()=>{}),onReport:()=>u(V),isFollowingAuthor:b(V.userId),onToggleFollow:()=>S(V.userId,{displayName:V.displayName,photoURL:V.authorPhoto,role:V.role})},V.id))}),r.length===0&&d===bs.FOR_YOU&&o.jsxs(tt.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-10 text-gray-500",children:[o.jsx(Lp,{className:"mx-auto mb-2 opacity-50",size:32}),o.jsx("p",{children:"No posts yet. Be the first to share something!"})]}),r.length===0&&d===bs.FOLLOWING&&P.length>0&&o.jsxs(tt.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-10 text-gray-500",children:[o.jsx(Gr,{className:"mx-auto mb-2 opacity-50",size:32}),o.jsx("p",{children:"No recent posts from people you follow."}),o.jsx("button",{onClick:()=>f(bs.FOR_YOU),className:"mt-3 text-brand-blue hover:underline text-sm font-medium",children:"Browse For You feed "})]})]})]}),l&&o.jsx(Z6,{user:t,target:{id:l.id,type:"Post",summary:l.text?l.text.substring(0,50):"Media Post"},onClose:()=>u(null)})]})}function X6({initialZip:t="",onLocationChange:e,showMap:n=!1,label:r="Location"}){const[s,i]=N.useState(t),[a,l]=N.useState(""),[u,d]=N.useState(!1),[f,m]=N.useState(null);N.useEffect(()=>{t&&t!==s&&(i(t),p(t))},[t]);const p=async x=>{const _=x.replace(/\D/g,"").slice(0,5);if(i(_),_.length===5){d(!0);const E=await jb(_);E?(l(E.cityState),m({lat:E.lat,lng:E.lng}),e({zip:_,...E})):(l("Unknown Location"),e({zip:_,valid:!1})),d(!1)}else l("")},v=()=>{if(!navigator.geolocation)return alert("Geolocation not supported");d(!0),navigator.geolocation.getCurrentPosition(async x=>{const{latitude:_,longitude:E}=x.coords;try{const S=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${_}&lon=${E}`)).json()).address.postcode;if(S){const C=S.split("-")[0];i(C),p(C)}else m({lat:_,lng:E}),l("Current Location"),e({lat:_,lng:E,name:"Current Location",valid:!0})}catch(k){console.error(k),alert("Failed to determine location.")}d(!1)},x=>{console.warn(x),alert("Location access denied."),d(!1)})};return o.jsxs("div",{className:"w-full",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:r}),o.jsxs("div",{className:"relative flex gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx("input",{className:"w-full pl-9 p-2.5 bg-white dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all text-sm",placeholder:"Zip Code",maxLength:5,value:s,onChange:x=>p(x.target.value)}),o.jsx(cr,{className:`absolute left-3 top-3 text-gray-400 ${u?"animate-pulse":""}`,size:16})]}),o.jsx("button",{onClick:v,disabled:u,className:"p-2.5 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 text-brand-blue transition-colors",title:"Use my location",children:u?o.jsx(Ye,{size:18,className:"animate-spin"}):o.jsx(kV,{size:18})})]}),a&&o.jsxs("div",{className:"mt-1.5 text-xs font-medium text-gray-500 dark:text-gray-400 flex items-center gap-1 animate-in fade-in",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),a]})]})}const Oce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",Dce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let Vce=F6.icon({iconUrl:Oce,shadowUrl:Dce,iconSize:[25,41],iconAnchor:[12,41]});F6.Marker.prototype.options.icon=Vce;function Fce({center:t,zoom:e}){const n=$6();return N.useEffect(()=>{n.setView(t,e)},[t,e,n]),null}function J6({locations:t=[],center:e=[34.0522,-118.2437],zoom:n=10,height:r="400px",drawRadius:s=!1,radiusMiles:i=0}){const a=t.filter(u=>u.lat&&u.lng&&(!u.hideAddress||u.forceReveal)),l=i*1609.34;return o.jsx("div",{className:"rounded-xl overflow-hidden shadow-inner border dark:border-gray-700 relative z-0",style:{height:r,width:"100%"},children:o.jsxs(U6,{center:e,zoom:n,style:{height:"100%",width:"100%"},scrollWheelZoom:!1,children:[o.jsx(q6,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),o.jsx(Fce,{center:e,zoom:n}),s&&i>0&&o.jsx(Cx,{center:e,pathOptions:{fillColor:"#3D84ED",color:"#3D84ED",fillOpacity:.2},radius:l}),a.map(u=>o.jsx(oce,{position:[u.lat,u.lng],children:o.jsx(ace,{children:o.jsxs("div",{className:"text-sm",children:[o.jsx("strong",{className:"block mb-1",children:u.name}),o.jsx("span",{className:"text-xs text-gray-500",children:u.address||"Location Hidden"})]})})},u.id))]})})}function dP(t,e,n,r){const i=(n-t)*(Math.PI/180),a=(r-e)*(Math.PI/180),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(t*(Math.PI/180))*Math.cos(n*(Math.PI/180))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))*.621371}function zce({userData:t,sessionParams:e,setSessionParams:n,onNext:r}){var v,x;const[s,i]=N.useState(1),[a,l]=N.useState(!1),[u,d]=N.useState([]),f=_=>{_.preventDefault(),i(2),m()},m=async()=>{l(!0);try{const _=mt(Zc(Y,"public_profile"),zt("accountTypes","array-contains","Studio")),b=(await Pt(_)).docs.map(S=>({id:S.ref.parent.parent.id,...S.data()})).filter(S=>!S.location||!e.location?!1:dP(e.location.lat,e.location.lng,S.location.lat,S.location.lng)<=e.radius).map(S=>({...S,distance:dP(e.location.lat,e.location.lng,S.location.lat,S.location.lng)})).sort((S,C)=>S.distance-C.distance);d(b)}catch(_){console.error("Studio fetch error:",_)}l(!1)},p=_=>{n(E=>({...E,venue:_})),r()};return o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 shadow-sm overflow-hidden min-h-[600px]",children:[o.jsxs("div",{className:"p-6 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:[o.jsxs("h2",{className:"text-xl font-extrabold dark:text-white flex items-center gap-2",children:[o.jsx("span",{className:"bg-brand-blue text-white w-8 h-8 rounded-full flex items-center justify-center text-sm",children:s}),s===1?"Session Logistics":"Select Studio"]}),o.jsx("p",{className:"text-sm text-gray-500 mt-1 ml-10",children:s===1?"Define the when and where.":`Found ${u.length} studios within range.`})]}),s===1&&o.jsxs("form",{onSubmit:f,className:"p-8 space-y-6 max-w-2xl mx-auto",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:[o.jsx(to,{size:14,className:"inline mr-1"})," Date"]}),o.jsx("input",{type:"date",required:!0,className:"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-brand-blue",value:e.date,onChange:_=>n({...e,date:_.target.value})})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:[o.jsx(Zr,{size:14,className:"inline mr-1"})," Start Time"]}),o.jsx("input",{type:"time",required:!0,className:"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-brand-blue",value:e.time,onChange:_=>n({...e,time:_.target.value})})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx(X6,{initialZip:t==null?void 0:t.zip,label:"Center Location",onLocationChange:_=>n({...e,location:_})}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between mb-2",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Max Distance"}),o.jsxs("span",{className:"text-xs font-bold text-brand-blue",children:[e.radius," miles"]})]}),o.jsx("input",{type:"range",min:"5",max:"100",step:"5",value:e.radius,onChange:_=>n({...e,radius:parseInt(_.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:[o.jsx(da,{size:14,className:"inline mr-1"})," Urgency"]}),o.jsx("div",{className:"flex gap-2",children:["Low","Normal","High"].map(_=>o.jsx("button",{type:"button",onClick:()=>n({...e,urgency:_}),className:`flex-1 py-2 rounded-lg text-sm font-bold border transition ${e.urgency===_?"bg-brand-blue text-white border-brand-blue":"border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:_},_))})]})]}),o.jsx("div",{className:"pt-6",children:o.jsxs("button",{type:"submit",className:"w-full bg-brand-blue text-white py-4 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex justify-center items-center gap-2",children:["Find Studios ",o.jsx(lo,{size:20})]})})]}),s===2&&o.jsx("div",{className:"flex flex-col h-[600px]",children:a?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[o.jsx(Ye,{className:"animate-spin text-brand-blue mb-4",size:40}),o.jsx("p",{className:"text-gray-500",children:"Scouting locations..."})]}):o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"w-full md:w-1/2 overflow-y-auto p-4 space-y-3",children:[o.jsx("button",{onClick:()=>i(1),className:"text-xs text-gray-500 hover:text-brand-blue mb-2 flex items-center gap-1",children:" Change Filters"}),o.jsxs("div",{onClick:()=>p({id:"remote",name:"Remote / TBD",address:"No physical location set"}),className:"p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer text-center",children:[o.jsx("h4",{className:"font-bold text-gray-600 dark:text-gray-300",children:"No Studio Needed / Remote"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Skip venue selection"})]}),u.map(_=>o.jsxs("div",{onClick:()=>p(_),className:"bg-white dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-700 hover:border-brand-blue dark:hover:border-blue-500 cursor-pointer transition shadow-sm group",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h4",{className:"font-bold dark:text-white group-hover:text-brand-blue",children:_.name||"Studio"}),o.jsxs("span",{className:"text-xs font-mono bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-600 dark:text-gray-300",children:["$",_.rate,"/hr"]})]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[o.jsx(cr,{size:10})," ",_.distance.toFixed(1)," miles away"]}),o.jsx("div",{className:"flex gap-1 mt-2",children:(_.equipmentList||[]).slice(0,3).map(E=>o.jsx("span",{className:"text-[10px] bg-blue-50 dark:bg-blue-900/20 text-blue-600 px-1.5 py-0.5 rounded",children:E},E))})]},_.id))]}),o.jsx("div",{className:"hidden md:block w-1/2 h-full border-l dark:border-gray-700 relative",children:o.jsx(J6,{locations:u,center:[(v=e.location)==null?void 0:v.lat,(x=e.location)==null?void 0:x.lng],height:"100%",drawRadius:!0,radiusMiles:e.radius})})]})})]})}function hP({user:t,userData:e,openPublicProfile:n,onAddToCart:r,sessionCartIds:s=[],onBook:i,mode:a="direct"}){const[l,u]=N.useState(""),[d,f]=N.useState([]),[m,p]=N.useState(!1),[v,x]=N.useState("list"),[_,E]=N.useState(!0),[k,b]=N.useState({role:"All",minRate:0,maxRate:500}),S=async()=>{p(!0);try{const C=Zc(Y,Le().publicProfileCollectionGroup),P=[];k.role!=="All"&&P.push(zt("accountTypes","array-contains",k.role)),P.push(fs(50));const R=mt(C,...P);let j=(await Pt(R)).docs.map(O=>{const V=O.data();return{id:V.uid||O.ref.parent.parent.id,...V}}).filter(O=>O.id!==t.uid);if(l){const O=l.toLowerCase();j=j.filter(V=>{var z,D,F;return((z=V.firstName)==null?void 0:z.toLowerCase().includes(O))||((D=V.lastName)==null?void 0:D.toLowerCase().includes(O))||((F=V.searchTerms)==null?void 0:F.includes(O))})}f(j)}catch(C){console.error("Search failed:",C)}p(!1)};return o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-full",children:[o.jsx("div",{className:`lg:col-span-3 space-y-4 ${_?"block":"hidden lg:block"}`,children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm h-fit sticky top-4",children:[o.jsx("div",{className:"flex justify-between items-center mb-2",children:o.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[o.jsx(lE,{size:18})," Filters"]})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Profile Type"}),o.jsxs("select",{className:"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:k.role,onChange:C=>b({...k,role:C.target.value}),children:[o.jsx("option",{value:"All",children:"All Profiles"}),o.jsx("option",{value:"Musician",children:"Musician"}),o.jsx("option",{value:"Producer",children:"Producer"}),o.jsx("option",{value:"Engineer",children:"Audio Engineer"})]})]}),o.jsx("button",{onClick:S,className:"w-full bg-brand-blue text-white py-2 rounded-lg text-sm font-bold hover:bg-blue-600 transition",children:"Update Results"})]})]})}),o.jsxs("div",{className:"lg:col-span-9 space-y-4",children:[o.jsx("div",{className:"bg-white dark:bg-[#2c2e36] p-3 rounded-xl border dark:border-gray-700 flex gap-3 items-center shadow-sm",children:o.jsxs("div",{className:"relative flex-1 w-full",children:[o.jsx(ur,{className:"absolute left-3 top-3 text-gray-400",size:18}),o.jsx("input",{className:"w-full pl-10 p-2.5 bg-gray-50 dark:bg-[#1f2128] border-transparent focus:bg-white dark:focus:bg-black focus:border-brand-blue border rounded-lg dark:text-white transition-all outline-none",placeholder:"Search talent...",value:l,onChange:C=>u(C.target.value),onKeyDown:C=>C.key==="Enter"&&S()})]})}),o.jsx("div",{className:"min-h-[400px]",children:m?o.jsx("div",{className:"text-center py-10 text-gray-500",children:"Searching..."}):d.length>0?o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(C=>{var R;const P=s.includes(C.id);return o.jsxs("div",{className:`bg-white dark:bg-[#2c2e36] p-4 rounded-xl border flex flex-col transition ${P?"border-brand-blue ring-1 ring-brand-blue bg-blue-50 dark:bg-blue-900/10":"dark:border-gray-700 hover:border-gray-400"}`,children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3 cursor-pointer",onClick:()=>n(C.id,C.firstName),children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center font-bold",children:(R=C.firstName)==null?void 0:R[0]}),o.jsxs("div",{children:[o.jsxs("h4",{className:"font-bold dark:text-white",children:[C.firstName," ",C.lastName]}),o.jsxs("p",{className:"text-xs text-gray-500",children:[C.accountTypes[0],"  $",C.rate||"?","/hr"]})]})]}),a==="planner"&&o.jsx("button",{onClick:()=>!P&&r(C),disabled:P,className:`mt-auto w-full py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 ${P?"bg-green-100 text-green-700 cursor-default":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-white hover:bg-brand-blue hover:text-white transition"}`,children:P?o.jsxs(o.Fragment,{children:[o.jsx(Cs,{size:14})," Added to Session"]}):o.jsxs(o.Fragment,{children:[o.jsx(ms,{size:14})," Add to Session"]})}),a==="direct"&&o.jsxs("button",{onClick:()=>i(C),className:"mt-auto w-full py-2 rounded-lg text-xs font-bold bg-brand-blue text-white hover:bg-blue-600 transition flex items-center justify-center gap-2",children:[o.jsx(to,{size:14})," Book Now"]})]},C.id)})}):o.jsx("div",{className:"text-center py-20 text-gray-400",children:"Try adjusting filters to find talent."})})]})]})}function Bce({user:t,userData:e,broadcast:n,onClose:r}){const[s,i]=N.useState(Math.floor(n.offerAmount/(n.duration||1))),[a,l]=N.useState(""),[u,d]=N.useState(!1),f=s*(n.duration||1),m=n.offerAmount,p=f>m,v=async()=>{if(!s||!a)return alert("Please enter a rate and a message.");if(p)return alert("Your bid exceeds the client's budget.");d(!0);try{const x={type:"Bid",broadcastId:n.id,targetId:n.senderId,targetName:n.senderName,senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,serviceType:`Bid: ${n.serviceType||"Session"}`,offerAmount:f,ratePerHour:parseInt(s),message:a,status:"Pending",date:"Flexible",timestamp:jt()};await Gt(Ce(Y,`artifacts/${qe}/public/data/bookings`),x),alert("Bid submitted successfully! The client has been notified."),r()}catch(x){console.error("Error submitting bid:",x),alert("Failed to submit bid.")}d(!1)};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md animate-in zoom-in-95",children:[o.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center",children:[o.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Place Your Bid"}),o.jsx("button",{onClick:r,children:o.jsx(ut,{size:20,className:"text-gray-500 hover:text-white"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800",children:[o.jsx("div",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 uppercase mb-1",children:"Client's Budget"}),o.jsxs("div",{className:"text-2xl font-extrabold dark:text-white",children:["$",m," ",o.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["Total (",n.duration," hrs)"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Your Hourly Rate ($)"}),o.jsxs("div",{className:"relative",children:[o.jsx(js,{size:16,className:"absolute left-3 top-3.5 text-gray-400"}),o.jsx("input",{type:"number",className:`w-full pl-8 p-3 border rounded-xl font-bold text-lg outline-none dark:bg-[#1f2128] dark:text-white ${p?"border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-brand-blue"}`,value:s,onChange:x=>i(x.target.value)})]}),o.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm",children:[o.jsx("span",{className:"text-gray-500",children:"Total Bid:"}),o.jsxs("span",{className:`font-bold ${p?"text-red-500":"text-green-600"}`,children:["$",f]})]}),p&&o.jsxs("div",{className:"text-xs text-red-500 mt-1 flex items-center gap-1",children:[o.jsx(da,{size:12})," Bid exceeds budget. Consider lowering your rate."]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Message to Client"}),o.jsx("textarea",{className:"w-full p-3 border rounded-xl text-sm dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none resize-none",rows:"3",placeholder:"Introduce yourself and your gear...",value:a,onChange:x=>l(x.target.value)})]}),o.jsx("button",{onClick:v,disabled:u||p,className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:shadow-none",children:u?o.jsx(Ye,{className:"animate-spin"}):"Submit Proposal"})]})]})})}function fP(t,e,n,r){var s=6371,i=Wy(n-t),a=Wy(r-e),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(Wy(t))*Math.cos(Wy(n))*Math.sin(a/2)*Math.sin(a/2),u=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return s*u*.621371}function Wy(t){return t*(Math.PI/180)}function $ce({user:t,userData:e,onBid:n}){const[r,s]=N.useState([]),[i,a]=N.useState([]),[l,u]=N.useState(null),[d,f]=N.useState(null),[m,p]=N.useState(50);N.useEffect(()=>{(async()=>{if(e!=null&&e.zip){const _=await jb(e.zip);_&&f({lat:_.lat,lng:_.lng})}else navigator.geolocation&&navigator.geolocation.getCurrentPosition(_=>f({lat:_.coords.latitude,lng:_.coords.longitude}))})()},[e]),N.useEffect(()=>{const x=mt(Ce(Y,`artifacts/${qe}/public/data/bookings`),zt("type","==","Broadcast"),zt("status","==","Broadcasting"),_n("timestamp","desc")),_=Qt(x,E=>{s(E.docs.map(k=>({id:k.id,...k.data()})))});return()=>_()},[]),N.useEffect(()=>{if(!d){a(r);return}const x=r.filter(_=>!_.location||!_.location.lat||!_.location.lng?!0:fP(d.lat,d.lng,_.location.lat,_.location.lng)<=m).map(_=>{const E=_.location?fP(d.lat,d.lng,_.location.lat,_.location.lng):null;return{..._,distance:E}}).sort((_,E)=>(_.distance||9999)-(E.distance||9999));a(x)},[r,d,m]);const v=async x=>{if(window.confirm("Cancel this broadcast? This will remove it from the board."))try{await ft(ke(Y,`artifacts/${qe}/public/data/bookings`,x),{status:"Cancelled"})}catch(_){console.error(_),alert("Failed to cancel.")}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end gap-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(ps,{className:"text-yellow-500",size:20})," Open Sessions"]}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Live opportunities near you."})]}),o.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[o.jsx(cr,{size:14,className:"ml-2 text-gray-500"}),o.jsxs("select",{className:"bg-transparent text-sm font-bold text-gray-700 dark:text-gray-300 p-1 outline-none cursor-pointer",value:m,onChange:x=>p(Number(x.target.value)),children:[o.jsx("option",{value:10,children:"Within 10 mi"}),o.jsx("option",{value:25,children:"Within 25 mi"}),o.jsx("option",{value:50,children:"Within 50 mi"}),o.jsx("option",{value:100,children:"Within 100 mi"}),o.jsx("option",{value:5e3,children:"Anywhere"})]})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.length===0?o.jsx("div",{className:"col-span-full text-center py-12 bg-white dark:bg-[#2c2e36] rounded-xl border border-dashed dark:border-gray-700 text-gray-500",children:"No open sessions found."}):i.map(x=>o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm hover:shadow-md transition-all group relative overflow-hidden",children:[o.jsxs("div",{className:"absolute top-0 right-0 bg-brand-blue text-white text-[10px] font-bold px-3 py-1 rounded-bl-lg",children:["BUDGET: $",x.offerAmount||"N/A"]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 flex justify-between",children:[o.jsx("span",{children:x.serviceType}),typeof x.distance=="number"&&o.jsxs("span",{className:"text-brand-blue flex items-center gap-1",children:[o.jsx(cr,{size:10})," ",x.distance.toFixed(1)," mi"]})]}),o.jsx("h4",{className:"text-lg font-bold dark:text-white truncate pr-16",children:x.targetName||"Session Request"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-300 mt-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(wr,{size:14})," ",x.senderName]}),x.date&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Zr,{size:14})," ",x.date==="Flexible"?"Flexible":new Date(x.date).toLocaleDateString()]})]})]}),o.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:x.requirements&&x.requirements.slice(0,3).map((_,E)=>o.jsx("span",{className:"text-[10px] bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-600 dark:text-gray-300 border dark:border-gray-600",children:_.value},E))}),o.jsx("div",{className:"flex gap-2",children:x.senderId===t.uid?o.jsxs("button",{onClick:()=>v(x.id),className:"w-full bg-red-100 text-red-600 py-2.5 rounded-lg font-bold text-sm hover:bg-red-200 transition flex items-center justify-center gap-2",children:[o.jsx(Mr,{size:16})," Cancel"]}):o.jsxs("button",{onClick:()=>u(x),className:"w-full bg-gray-900 dark:bg-white dark:text-black text-white py-2.5 rounded-lg font-bold text-sm hover:opacity-90 transition flex justify-center items-center gap-2",children:["View & Bid ",o.jsx(lo,{size:16})]})})]},x.id))}),l&&o.jsx(Bce,{user:t,userData:e,broadcast:l,onClose:()=>u(null)})]})}const mP=[{id:"computer_audio_and_interfaces",label:"Computer Audio & Interfaces"},{id:"microphones_and_input_transducers",label:"Microphones"},{id:"mixing_consoles_and_control",label:"Mixing Consoles"},{id:"monitoring_and_playback",label:"Monitoring & Playback"},{id:"outboard_signal_processing",label:"Outboard Gear"}],ez=()=>{const[t,e]=N.useState({}),[n,r]=N.useState(!0);return N.useEffect(()=>{(async()=>{r(!0);const i={};try{const a=`artifacts/${qe}/public/data/equipment_database`;await Promise.all(mP.map(async l=>{const u=ke(Y,a,l.id),d=Ce(u,"items"),f=await Pt(d),m={};f.forEach(p=>{m[p.id]=p.data()}),i[l.id]=m})),e(i)}catch(a){console.error("Failed to load equipment database:",a)}r(!1)})()},[]),{loading:n,data:t,categories:mP}};function Uce({user:t,userData:e,onBack:n,onSuccess:r}){const{loading:s,data:i,categories:a}=ez(),[l,u]=N.useState(2),d=[5,10,15,25,50,100,250,500],f=d[l],[m,p]=N.useState({lat:34.0522,lng:-118.2437,name:"Default"});N.useEffect(()=>{(async()=>{if(e!=null&&e.zip){const Ae=await jb(e.zip);if(Ae){p({lat:Ae.lat,lng:Ae.lng,name:Ae.cityState});return}}navigator.geolocation&&navigator.geolocation.getCurrentPosition(Ae=>{p({lat:Ae.coords.latitude,lng:Ae.coords.longitude,name:"Current Location"})})})()},[e]);const v=ie=>{ie.lat&&ie.lng&&p({lat:ie.lat,lng:ie.lng,name:ie.cityState||"Selected Location"})},[x,_]=N.useState("Musician"),[E,k]=N.useState("Play"),[b,S]=N.useState(""),[C,P]=N.useState(""),[R,I]=N.useState(""),[j,O]=N.useState(""),[V,z]=N.useState(""),[D,F]=N.useState(""),[ee,ue]=N.useState(""),[ve,ae]=N.useState("Any"),[H,Q]=N.useState("Flat Rate"),[W,re]=N.useState([{id:Date.now(),type:"General",value:""}]),he=X0.filter(ie=>ie!=="Technician"),ye=ie=>{switch(ie){case"Musician":return["Play","Compose","Improvise"];case"Engineer":return["Mix","Master","Record","Edit"];case"Producer":return["Produce","Remix","Arrange"];case"Studio":return["Host Session","Rent Gear"];default:return["Work"]}},Me=()=>re([...W,{id:Date.now(),type:"Gear",value:"",gearSelection:{}}]),Fe=ie=>{W.length!==1&&re(W.filter(Ae=>Ae.id!==ie))},G=(ie,Ae,Ge)=>re(W.map(me=>me.id===ie?{...me,[Ae]:Ge}:me)),le=(ie,Ae,Ge)=>{re(W.map(me=>{if(me.id!==ie)return me;const dt={...me.gearSelection,[Ae]:Ge};return Ae==="category"&&(delete dt.subCategory,delete dt.type,delete dt.item),Ae==="subCategory"&&(delete dt.type,delete dt.item),Ae==="type"&&delete dt.item,{...me,gearSelection:dt,value:Ge}}))},De=async()=>{if(!R||!C)return alert("Please complete the request sentence.");if(x==="Musician"&&E==="Play"&&!b)return alert("Please select an instrument.");const ie=W.filter(Ge=>Ge.value.trim()!=="");let Ae=`${x} - ${E}`;b&&(Ae+=` ${b}`);try{await Gt(Ce(Y,`artifacts/${qe}/public/data/bookings`),{senderId:t.uid,senderName:"Broadcast Request",targetId:"BROADCAST",targetName:R,role:x,action:E,instrument:b||null,genre:C,serviceType:Ae,date:j||"Flexible",time:V||"Flexible",offerAmount:D?parseInt(D):null,references:ee,experienceLevel:ve,paymentType:H,requirements:ie,message:ie.map(Ge=>`[${Ge.type}] ${Ge.value}`).join(`
`),range:f,status:"Broadcasting",type:"Broadcast",location:{lat:m.lat,lng:m.lng},timestamp:jt()}),alert(`Broadcast sent to ${x}s within ${f} miles!`),r()}catch(Ge){console.error(Ge),alert("Failed to send broadcast.")}},Qe=[{label:"Gear / Equipment",value:"Gear",icon:wu},{label:"Technique / Skill",value:"Technique",icon:ps},{label:"Feel / Vibe",value:"Vibe",icon:co},{label:"Logistics",value:"Logistics",icon:Zr},{label:"General Note",value:"General",icon:Ine}];return o.jsxs("div",{className:"max-w-5xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 animate-in fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center mb-8",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg text-brand-blue",children:o.jsx(cr,{size:24})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold dark:text-white",children:"Broadcast Builder"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Reach professionals in your area."})]})]}),o.jsx("button",{onClick:n,className:"text-sm font-medium text-gray-500 hover:text-brand-blue transition",children:"Cancel & Exit"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[o.jsx("div",{className:"lg:col-span-4 space-y-5",children:o.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] p-5 rounded-2xl border dark:border-gray-700",children:[o.jsx(X6,{initialZip:e==null?void 0:e.zip,onLocationChange:v,label:"Broadcast Center"}),o.jsxs("div",{className:"mt-4 flex justify-between items-center mb-2",children:[o.jsx("label",{className:"text-xs font-extrabold text-gray-400 uppercase tracking-wider",children:"Range"}),o.jsxs("span",{className:"bg-brand-blue text-white text-xs font-bold px-2 py-1 rounded-md",children:[f," Miles"]})]}),o.jsx("div",{className:"mb-5 rounded-xl overflow-hidden border dark:border-gray-600 shadow-md relative h-48",children:o.jsx(J6,{center:[m.lat,m.lng],zoom:9,height:"100%",drawRadius:!0,radiusMiles:f})}),o.jsx("input",{type:"range",min:"0",max:d.length-1,value:l,onChange:ie=>u(parseInt(ie.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-brand-blue"})]})}),o.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl border-2 border-blue-100 dark:border-gray-700 shadow-sm relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-brand-blue"}),o.jsx("label",{className:"text-xs font-extrabold text-brand-blue uppercase tracking-widest mb-4 block",children:"Step 1: Core Request"}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-lg md:text-xl text-gray-700 dark:text-gray-200 leading-relaxed font-medium",children:[o.jsx("span",{children:"I need a"}),o.jsxs("div",{className:"relative inline-block",children:[o.jsx("select",{value:x,onChange:ie=>{_(ie.target.value),k(ye(ie.target.value)[0])},className:"appearance-none bg-blue-50 dark:bg-gray-700 text-blue-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-blue-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-blue-100 dark:hover:bg-gray-600 transition",children:he.map(ie=>o.jsx("option",{value:ie,children:ie},ie))}),o.jsx(Td,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-blue-500 dark:text-gray-400 pointer-events-none",size:16})]}),o.jsx("span",{children:"that can"}),o.jsxs("div",{className:"relative inline-block",children:[o.jsx("select",{value:E,onChange:ie=>k(ie.target.value),className:"appearance-none bg-purple-50 dark:bg-gray-700 text-purple-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-purple-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-purple-100 dark:hover:bg-gray-600 transition",children:ye(x).map(ie=>o.jsx("option",{value:ie,children:ie},ie))}),o.jsx(Td,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-purple-500 dark:text-gray-400 pointer-events-none",size:16})]}),(E==="Play"||E==="Improvise")&&o.jsxs("div",{className:"relative inline-block",children:[o.jsxs("select",{value:b,onChange:ie=>S(ie.target.value),className:"appearance-none bg-green-50 dark:bg-gray-700 text-green-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-green-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-green-100 dark:hover:bg-gray-600 transition",children:[o.jsx("option",{value:"",children:"(Select Instrument)"}),Object.entries($1).map(([ie,Ae])=>o.jsx("optgroup",{label:ie,children:Ae.map(Ge=>o.jsx("option",{value:Ge,children:Ge},Ge))},ie))]}),o.jsx(Td,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-green-500 dark:text-gray-400 pointer-events-none",size:16})]}),o.jsx("span",{children:"for a song in the"}),o.jsxs("div",{className:"relative inline-block",children:[o.jsxs("select",{value:C,onChange:ie=>P(ie.target.value),className:"appearance-none bg-orange-50 dark:bg-gray-700 text-orange-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-orange-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-orange-100 dark:hover:bg-gray-600 transition",children:[o.jsx("option",{value:"",children:"(Select Genre)"}),ld.map(ie=>o.jsx("option",{value:ie,children:ie},ie))]}),o.jsx(Td,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-orange-500 dark:text-gray-400 pointer-events-none",size:16})]})]}),o.jsxs("div",{className:"mt-6 pt-4 border-t dark:border-gray-700",children:[o.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Project Title"}),o.jsx("input",{className:"w-full bg-gray-50 dark:bg-black/20 border-none rounded-lg p-3 text-gray-700 dark:text-gray-200 font-medium placeholder-gray-400 focus:ring-2 focus:ring-brand-blue",placeholder:"e.g. Summer Hit Single - Drum Tracking",value:R,onChange:ie=>I(ie.target.value)})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-5 rounded-xl border dark:border-gray-700",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-3 block",children:"Logistics"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Date"}),o.jsx("input",{type:"date",className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:j,onChange:ie=>O(ie.target.value)})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Time"}),o.jsx("input",{type:"time",className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:V,onChange:ie=>z(ie.target.value)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Budget ($)"}),o.jsxs("div",{className:"relative",children:[o.jsx(js,{className:"absolute left-3 top-2.5 text-green-500",size:14}),o.jsx("input",{type:"number",className:"w-full pl-8 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm font-bold",placeholder:"Flexible",value:D,onChange:ie=>F(ie.target.value)})]})]})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-5 rounded-xl border dark:border-gray-700",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-3 block",children:"Project Details"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Payment Type"}),o.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:H,onChange:ie=>Q(ie.target.value),children:[o.jsx("option",{children:"Flat Rate"}),o.jsx("option",{children:"Hourly"}),o.jsx("option",{children:"Royalty Split"}),o.jsx("option",{children:"Trade / Barter"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Experience Required"}),o.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:ve,onChange:ie=>ae(ie.target.value),children:[o.jsx("option",{children:"Any"}),o.jsx("option",{children:"Intermediate"}),o.jsx("option",{children:"Pro / Expert"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Reference Link"}),o.jsxs("div",{className:"relative",children:[o.jsx(cE,{className:"absolute left-3 top-2.5 text-gray-400",size:14}),o.jsx("input",{className:"w-full pl-8 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Spotify / SoundCloud...",value:ee,onChange:ie=>ue(ie.target.value)})]})]})]})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("div",{className:"flex justify-between items-end mb-4",children:[o.jsx("label",{className:"text-xs font-extrabold text-brand-blue uppercase tracking-widest",children:"Step 2: Specific Needs"}),o.jsxs("button",{onClick:Me,className:"text-xs bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-white px-3 py-1.5 rounded-full font-bold flex items-center gap-1 transition",children:[o.jsx(ms,{size:14})," Add Condition"]})]}),o.jsx("div",{className:"flex flex-col gap-3",children:W.map(ie=>{var Ae,Ge,me,dt,Dt,dr,Wn;return o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 bg-gray-50 dark:bg-black/20 p-3 rounded-xl border dark:border-gray-700 animate-in slide-in-from-bottom-2",children:[o.jsx("div",{className:"w-full sm:w-1/3 min-w-[140px]",children:o.jsx("select",{className:"w-full p-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-[#2c2e36] dark:text-white focus:ring-2 focus:ring-brand-blue outline-none",value:ie.type,onChange:st=>G(ie.id,"type",st.target.value),children:Qe.map(st=>o.jsx("option",{value:st.value,children:st.label},st.value))})}),o.jsxs("div",{className:"flex-1 flex gap-2",children:[ie.type==="Gear"&&!s?o.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[o.jsxs("select",{className:"w-full p-2 text-xs border rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white",value:((Ae=ie.gearSelection)==null?void 0:Ae.category)||"",onChange:st=>le(ie.id,"category",st.target.value),children:[o.jsx("option",{value:"",children:"Select Category..."}),a.map(st=>o.jsx("option",{value:st.id,children:st.label},st.id))]}),((Ge=ie.gearSelection)==null?void 0:Ge.category)&&i[ie.gearSelection.category]&&o.jsxs("select",{className:"w-full p-2 text-xs border rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white",value:((me=ie.gearSelection)==null?void 0:me.subCategory)||"",onChange:st=>le(ie.id,"subCategory",st.target.value),children:[o.jsx("option",{value:"",children:"Select Type..."}),Object.keys(i[ie.gearSelection.category]).map(st=>o.jsx("option",{value:st,children:st.replace(/_/g," ")},st))]}),((dt=ie.gearSelection)==null?void 0:dt.subCategory)&&o.jsxs("select",{className:"w-full p-2 text-xs border rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white",value:((Dt=ie.gearSelection)==null?void 0:Dt.type)||"",onChange:st=>le(ie.id,"type",st.target.value),children:[o.jsx("option",{value:"",children:"Select Subtype..."}),Object.keys(i[ie.gearSelection.category][ie.gearSelection.subCategory]).map(st=>o.jsx("option",{value:st,children:st.replace(/_/g," ")},st))]}),((dr=ie.gearSelection)==null?void 0:dr.type)&&o.jsxs("select",{className:"w-full p-2 text-sm font-bold border-l-4 border-brand-blue rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white shadow-sm",value:((Wn=ie.gearSelection)==null?void 0:Wn.item)||"",onChange:st=>le(ie.id,"item",st.target.value),children:[o.jsx("option",{value:"",children:"Select Specific Item..."}),i[ie.gearSelection.category][ie.gearSelection.subCategory][ie.gearSelection.type].map(st=>o.jsx("option",{value:st,children:st},st))]})]}):o.jsx("input",{className:"w-full p-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-[#2c2e36] dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-brand-blue",placeholder:"Describe requirement...",value:ie.value,onChange:st=>G(ie.id,"value",st.target.value)}),o.jsx("button",{onClick:()=>Fe(ie.id),className:"text-gray-400 hover:text-red-500 px-2",children:o.jsx(Mr,{size:18})})]})]},ie.id)})}),o.jsx("div",{className:"h-6 w-0.5 bg-gray-200 dark:bg-gray-700 mx-auto my-2"}),o.jsxs("button",{className:"w-full bg-gradient-to-r from-brand-blue to-blue-600 text-white py-4 rounded-xl font-bold shadow-lg hover:scale-[1.01] transition-all text-lg flex items-center justify-center gap-2",onClick:De,children:[o.jsx(ps,{fill:"currentColor",size:20})," Broadcast Opportunity"]})]})]})]})]})}function qce({user:t,userData:e,target:n,onClose:r}){var _;const[s,i]=N.useState(!1),[a,l]=N.useState([]),[u,d]=N.useState("me"),f=(_=e==null?void 0:e.accountTypes)==null?void 0:_.some(E=>["Label","Agent"].includes(E)),[m,p]=N.useState({date:"",time:"",duration:2,serviceType:"Session",offerAmount:n.rate?n.rate*2:100,message:""});N.useEffect(()=>{f&&(async()=>{try{const b=(await Pt(Ce(Y,Le(t.uid).labelRoster(t.uid)))).docs.map(S=>({id:S.id,...S.data()}));l(b)}catch(k){console.error("Roster fetch error",k)}})()},[f,t.uid]);const v=E=>{const k=E.target.value,b=k===""?"":parseInt(k);p(S=>({...S,duration:b,offerAmount:b&&n.rate?n.rate*b:S.offerAmount}))},x=async()=>{if(!m.date||!m.time||!m.message)return alert("Please fill in all required fields.");if(!m.duration||m.duration<=0)return alert("Duration must be at least 1 hour.");i(!0);try{const E=new Date(`${m.date}T${m.time}`);let k={senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,onBehalfOf:null};if(u!=="me"){const b=a.find(S=>S.artistId===u);b&&(k.senderName=`${e.firstName} (for ${b.name})`,k.onBehalfOf={id:b.artistId,name:b.name,photo:b.photoURL})}await Gt(Ce(Y,`artifacts/${qe}/public/data/bookings`),{...k,targetId:n.id,targetName:n.firstName?`${n.firstName} ${n.lastName}`:n.name,serviceType:m.serviceType,date:m.date,time:m.time,duration:Number(m.duration),offerAmount:Number(m.offerAmount),message:m.message,status:"Pending",timestamp:jt(),bookingStart:E,type:"Direct"}),alert("Booking request sent successfully!"),r()}catch(E){console.error("Booking failed:",E),alert("Failed to send booking request.")}i(!1)};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4 animate-in fade-in zoom-in-95",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700 flex flex-col max-h-[90vh]",children:[o.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Book Session"}),o.jsxs("p",{className:"text-xs text-gray-500",children:["with ",o.jsx("span",{className:"text-brand-blue font-bold",children:n.firstName||n.name})]})]}),o.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition text-gray-500 dark:text-gray-400",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto space-y-5",children:[f&&a.length>0&&o.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-xl border border-purple-100 dark:border-purple-800",children:[o.jsxs("label",{className:"text-xs font-bold text-purple-700 dark:text-purple-300 uppercase mb-1 flex items-center gap-1",children:[o.jsx(ao,{size:12})," Booking On Behalf Of:"]}),o.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-[#1f2128] dark:border-purple-800/50 dark:text-white text-sm font-bold",value:u,onChange:E=>d(E.target.value),children:[o.jsxs("option",{value:"me",children:["Myself (",e.firstName,")"]}),a.map(E=>o.jsxs("option",{value:E.artistId,children:["Artist: ",E.name]},E.artistId))]})]}),n.rate&&o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl border border-blue-100 dark:border-blue-800 flex items-center gap-2 text-xs text-blue-700 dark:text-blue-300",children:[o.jsx(da,{size:14}),o.jsxs("span",{children:["Standard Rate: ",o.jsxs("strong",{children:["$",n.rate,"/hr"]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Date"}),o.jsxs("div",{className:"relative",children:[o.jsx(to,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),o.jsx("input",{type:"date",className:"w-full pl-10 p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:m.date,onChange:E=>p({...m,date:E.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Start Time"}),o.jsxs("div",{className:"relative",children:[o.jsx(Zr,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),o.jsx("input",{type:"time",className:"w-full pl-10 p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:m.time,onChange:E=>p({...m,time:E.target.value})})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Duration (Hrs)"}),o.jsx("input",{type:"number",min:"1",className:"w-full p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm font-bold",value:m.duration,onChange:v})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Total Offer ($)"}),o.jsxs("div",{className:"relative",children:[o.jsx(js,{className:"absolute left-3 top-2.5 text-green-500",size:16}),o.jsx("input",{type:"number",className:"w-full pl-9 p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm font-bold text-green-600",value:m.offerAmount,onChange:E=>p({...m,offerAmount:E.target.value})})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Type"}),o.jsxs("select",{className:"w-full p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:m.serviceType,onChange:E=>p({...m,serviceType:E.target.value}),children:[o.jsx("option",{children:"Session"}),o.jsx("option",{children:"Lesson"}),o.jsx("option",{children:"Consultation"}),o.jsx("option",{children:"Mixing/Mastering"}),o.jsx("option",{children:"Rehearsal"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Message / Requirements"}),o.jsx("textarea",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm min-h-[100px] resize-none",placeholder:"Describe what you need...",value:m.message,onChange:E=>p({...m,message:E.target.value})})]})]}),o.jsx("div",{className:"p-5 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:o.jsx("button",{onClick:x,disabled:s,className:"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 transition flex items-center justify-center gap-2 shadow-lg disabled:opacity-50",children:s?o.jsx(Ye,{className:"animate-spin"}):"Send Request"})})]})})}var Rg=t=>t.type==="checkbox",vc=t=>t instanceof Date,ts=t=>t==null;const tz=t=>typeof t=="object";var qn=t=>!ts(t)&&!Array.isArray(t)&&tz(t)&&!vc(t),nz=t=>qn(t)&&t.target?Rg(t.target)?t.target.checked:t.target.value:t,Wce=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,rz=(t,e)=>t.has(Wce(e)),Hce=t=>{const e=t.constructor&&t.constructor.prototype;return qn(e)&&e.hasOwnProperty("isPrototypeOf")},JE=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function rn(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(JE&&(t instanceof Blob||r))&&(n||qn(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!Hce(t))e=t;else for(const s in t)t.hasOwnProperty(s)&&(e[s]=rn(t[s]));else return t;return e}var Ab=t=>/^\w*$/.test(t),Jt=t=>t===void 0,Rb=t=>Array.isArray(t)?t.filter(Boolean):[],e2=t=>Rb(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Te=(t,e,n)=>{if(!e||!qn(t))return n;const r=(Ab(e)?[e]:e2(e)).reduce((s,i)=>ts(s)?s:s[i],t);return Jt(r)||r===t?Jt(t[e])?n:t[e]:r},ws=t=>typeof t=="boolean",Lt=(t,e,n)=>{let r=-1;const s=Ab(e)?[e]:e2(e),i=s.length,a=i-1;for(;++r<i;){const l=s[r];let u=n;if(r!==a){const d=t[l];u=qn(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;t[l]=u,t=t[l]}};const tv={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Js={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ro={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},sz=Ve.createContext(null);sz.displayName="HookFormContext";const Pb=()=>Ve.useContext(sz);var iz=(t,e,n,r=!0)=>{const s={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(s,i,{get:()=>{const a=i;return e._proxyFormState[a]!==Js.all&&(e._proxyFormState[a]=!r||Js.all),n&&(n[a]=!0),t[a]}});return s};const Lb=typeof window<"u"?Ve.useLayoutEffect:Ve.useEffect;function Gce(t){const e=Pb(),{control:n=e.control,disabled:r,name:s,exact:i}=t||{},[a,l]=Ve.useState(n._formState),u=Ve.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Lb(()=>n._subscribe({name:s,formState:u.current,exact:i,callback:d=>{!r&&l({...n._formState,...d})}}),[s,r,i]),Ve.useEffect(()=>{u.current.isValid&&n._setValid(!0)},[n]),Ve.useMemo(()=>iz(a,n,u.current,!1),[a,n])}var Ns=t=>typeof t=="string",H1=(t,e,n,r,s)=>Ns(t)?(r&&e.watch.add(t),Te(n,t,s)):Array.isArray(t)?t.map(i=>(r&&e.watch.add(i),Te(n,i))):(r&&(e.watchAll=!0),n),G1=t=>ts(t)||!tz(t);function _i(t,e,n=new WeakSet){if(G1(t)||G1(e))return Object.is(t,e);if(vc(t)&&vc(e))return t.getTime()===e.getTime();const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const i of r){const a=t[i];if(!s.includes(i))return!1;if(i!=="ref"){const l=e[i];if(vc(a)&&vc(l)||qn(a)&&qn(l)||Array.isArray(a)&&Array.isArray(l)?!_i(a,l,n):!Object.is(a,l))return!1}}return!0}function Kce(t){const e=Pb(),{control:n=e.control,name:r,defaultValue:s,disabled:i,exact:a,compute:l}=t||{},u=Ve.useRef(s),d=Ve.useRef(l),f=Ve.useRef(void 0),m=Ve.useRef(n),p=Ve.useRef(r);d.current=l;const[v,x]=Ve.useState(()=>{const C=n._getWatch(r,u.current);return d.current?d.current(C):C}),_=Ve.useCallback(C=>{const P=H1(r,n._names,C||n._formValues,!1,u.current);return d.current?d.current(P):P},[n._formValues,n._names,r]),E=Ve.useCallback(C=>{if(!i){const P=H1(r,n._names,C||n._formValues,!1,u.current);if(d.current){const R=d.current(P);_i(R,f.current)||(x(R),f.current=R)}else x(P)}},[n._formValues,n._names,i,r]);Lb(()=>((m.current!==n||!_i(p.current,r))&&(m.current=n,p.current=r,E()),n._subscribe({name:r,formState:{values:!0},exact:a,callback:C=>{E(C.values)}})),[n,a,r,E]),Ve.useEffect(()=>n._removeUnmounted());const k=m.current!==n,b=p.current,S=Ve.useMemo(()=>{if(i)return null;const C=!k&&!_i(b,r);return k||C?_():null},[i,k,r,b,_]);return S!==null?S:v}function Qce(t){const e=Pb(),{name:n,disabled:r,control:s=e.control,shouldUnregister:i,defaultValue:a,exact:l=!0}=t,u=rz(s._names.array,n),d=Ve.useMemo(()=>Te(s._formValues,n,Te(s._defaultValues,n,a)),[s,n,a]),f=Kce({control:s,name:n,defaultValue:d,exact:l}),m=Gce({control:s,name:n,exact:l}),p=Ve.useRef(t),v=Ve.useRef(void 0),x=Ve.useRef(s.register(n,{...t.rules,value:f,...ws(t.disabled)?{disabled:t.disabled}:{}}));p.current=t;const _=Ve.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Te(m.errors,n)},isDirty:{enumerable:!0,get:()=>!!Te(m.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Te(m.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Te(m.validatingFields,n)},error:{enumerable:!0,get:()=>Te(m.errors,n)}}),[m,n]),E=Ve.useCallback(C=>x.current.onChange({target:{value:nz(C),name:n},type:tv.CHANGE}),[n]),k=Ve.useCallback(()=>x.current.onBlur({target:{value:Te(s._formValues,n),name:n},type:tv.BLUR}),[n,s._formValues]),b=Ve.useCallback(C=>{const P=Te(s._fields,n);P&&C&&(P._f.ref={focus:()=>C.focus&&C.focus(),select:()=>C.select&&C.select(),setCustomValidity:R=>C.setCustomValidity(R),reportValidity:()=>C.reportValidity()})},[s._fields,n]),S=Ve.useMemo(()=>({name:n,value:f,...ws(r)||m.disabled?{disabled:m.disabled||r}:{},onChange:E,onBlur:k,ref:b}),[n,r,m.disabled,E,k,b,f]);return Ve.useEffect(()=>{const C=s._options.shouldUnregister||i,P=v.current;P&&P!==n&&!u&&s.unregister(P),s.register(n,{...p.current.rules,...ws(p.current.disabled)?{disabled:p.current.disabled}:{}});const R=(I,j)=>{const O=Te(s._fields,I);O&&O._f&&(O._f.mount=j)};if(R(n,!0),C){const I=rn(Te(s._options.defaultValues,n,p.current.defaultValue));Lt(s._defaultValues,n,I),Jt(Te(s._formValues,n))&&Lt(s._formValues,n,I)}return!u&&s.register(n),v.current=n,()=>{(u?C&&!s._state.action:C)?s.unregister(n):R(n,!1)}},[n,s,u,i]),Ve.useEffect(()=>{s._setDisabledField({disabled:r,name:n})},[r,n,s]),Ve.useMemo(()=>({field:S,formState:m,fieldState:_}),[S,m,_])}const Zce=t=>t.render(Qce(t));var oz=(t,e,n,r,s)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:s||!0}}:{},cs=t=>Array.isArray(t)?t:[t],pP=()=>{let t=[];return{get observers(){return t},next:s=>{for(const i of t)i.next&&i.next(s)},subscribe:s=>(t.push(s),{unsubscribe:()=>{t=t.filter(i=>i!==s)}}),unsubscribe:()=>{t=[]}}};function az(t,e){const n={};for(const r in t)if(t.hasOwnProperty(r)){const s=t[r],i=e[r];if(s&&qn(s)&&i){const a=az(s,i);qn(a)&&(n[r]=a)}else t[r]&&(n[r]=i)}return n}var Er=t=>qn(t)&&!Object.keys(t).length,t2=t=>t.type==="file",wi=t=>typeof t=="function",nv=t=>{if(!JE)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},lz=t=>t.type==="select-multiple",n2=t=>t.type==="radio",Yce=t=>n2(t)||Rg(t),uw=t=>nv(t)&&t.isConnected;function Xce(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=Jt(t)?r++:t[e[r++]];return t}function Jce(t){for(const e in t)if(t.hasOwnProperty(e)&&!Jt(t[e]))return!1;return!0}function Rn(t,e){const n=Array.isArray(e)?e:Ab(e)?[e]:e2(e),r=n.length===1?t:Xce(t,n),s=n.length-1,i=n[s];return r&&delete r[i],s!==0&&(qn(r)&&Er(r)||Array.isArray(r)&&Jce(r))&&Rn(t,n.slice(0,-1)),t}var eue=t=>{for(const e in t)if(wi(t[e]))return!0;return!1};function cz(t){return Array.isArray(t)||qn(t)&&!eue(t)}function K1(t,e={}){for(const n in t){const r=t[n];cz(r)?(e[n]=Array.isArray(r)?[]:{},K1(r,e[n])):Jt(r)||(e[n]=!0)}return e}function cd(t,e,n){n||(n=K1(e));for(const r in t){const s=t[r];if(cz(s))Jt(e)||G1(n[r])?n[r]=K1(s,Array.isArray(s)?[]:{}):cd(s,ts(e)?{}:e[r],n[r]);else{const i=e[r];n[r]=!_i(s,i)}}return n}const gP={value:!1,isValid:!1},yP={value:!0,isValid:!0};var uz=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Jt(t[0].attributes.value)?Jt(t[0].value)||t[0].value===""?yP:{value:t[0].value,isValid:!0}:yP:gP}return gP},dz=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>Jt(t)?t:e?t===""?NaN:t&&+t:n&&Ns(t)?new Date(t):r?r(t):t;const xP={isValid:!1,value:null};var hz=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,xP):xP;function vP(t){const e=t.ref;return t2(e)?e.files:n2(e)?hz(t.refs).value:lz(e)?[...e.selectedOptions].map(({value:n})=>n):Rg(e)?uz(t.refs).value:dz(Jt(e.value)?t.ref.value:e.value,t)}var tue=(t,e,n,r)=>{const s={};for(const i of t){const a=Te(e,i);a&&Lt(s,i,a._f)}return{criteriaMode:n,names:[...t],fields:s,shouldUseNativeValidation:r}},rv=t=>t instanceof RegExp,Kf=t=>Jt(t)?t:rv(t)?t.source:qn(t)?rv(t.value)?t.value.source:t.value:t,Rd=t=>({isOnSubmit:!t||t===Js.onSubmit,isOnBlur:t===Js.onBlur,isOnChange:t===Js.onChange,isOnAll:t===Js.all,isOnTouch:t===Js.onTouched});const bP="AsyncFunction";var nue=t=>!!t&&!!t.validate&&!!(wi(t.validate)&&t.validate.constructor.name===bP||qn(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===bP)),rue=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Q1=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const Hd=(t,e,n,r)=>{for(const s of n||Object.keys(t)){const i=Te(t,s);if(i){const{_f:a,...l}=i;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],s)&&!r)return!0;if(a.ref&&e(a.ref,a.name)&&!r)return!0;if(Hd(l,e))break}else if(qn(l)&&Hd(l,e))break}}};function _P(t,e,n){const r=Te(t,n);if(r||Ab(n))return{error:r,name:n};const s=n.split(".");for(;s.length;){const i=s.join("."),a=Te(e,i),l=Te(t,i);if(a&&!Array.isArray(a)&&n!==i)return{name:n};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};s.pop()}return{name:n}}var sue=(t,e,n,r)=>{n(t);const{name:s,...i}=t;return Er(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(a=>e[a]===(!r||Js.all))},iue=(t,e,n)=>!t||!e||t===e||cs(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),oue=(t,e,n,r,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(e||t):(n?r.isOnBlur:s.isOnBlur)?!t:(n?r.isOnChange:s.isOnChange)?t:!0,aue=(t,e)=>!Rb(Te(t,e)).length&&Rn(t,e),fz=(t,e,n)=>{const r=cs(Te(t,n));return Lt(r,"root",e[n]),Lt(t,n,r),t};function wP(t,e,n="validate"){if(Ns(t)||Array.isArray(t)&&t.every(Ns)||ws(t)&&!t)return{type:n,message:Ns(t)?t:"",ref:e}}var rd=t=>qn(t)&&!rv(t)?t:{value:t,message:""},Z1=async(t,e,n,r,s,i)=>{const{ref:a,refs:l,required:u,maxLength:d,minLength:f,min:m,max:p,pattern:v,validate:x,name:_,valueAsNumber:E,mount:k}=t._f,b=Te(n,_);if(!k||e.has(_))return{};const S=l?l[0]:a,C=D=>{s&&S.reportValidity&&(S.setCustomValidity(ws(D)?"":D||""),S.reportValidity())},P={},R=n2(a),I=Rg(a),j=R||I,O=(E||t2(a))&&Jt(a.value)&&Jt(b)||nv(a)&&a.value===""||b===""||Array.isArray(b)&&!b.length,V=oz.bind(null,_,r,P),z=(D,F,ee,ue=Ro.maxLength,ve=Ro.minLength)=>{const ae=D?F:ee;P[_]={type:D?ue:ve,message:ae,ref:a,...V(D?ue:ve,ae)}};if(i?!Array.isArray(b)||!b.length:u&&(!j&&(O||ts(b))||ws(b)&&!b||I&&!uz(l).isValid||R&&!hz(l).isValid)){const{value:D,message:F}=Ns(u)?{value:!!u,message:u}:rd(u);if(D&&(P[_]={type:Ro.required,message:F,ref:S,...V(Ro.required,F)},!r))return C(F),P}if(!O&&(!ts(m)||!ts(p))){let D,F;const ee=rd(p),ue=rd(m);if(!ts(b)&&!isNaN(b)){const ve=a.valueAsNumber||b&&+b;ts(ee.value)||(D=ve>ee.value),ts(ue.value)||(F=ve<ue.value)}else{const ve=a.valueAsDate||new Date(b),ae=W=>new Date(new Date().toDateString()+" "+W),H=a.type=="time",Q=a.type=="week";Ns(ee.value)&&b&&(D=H?ae(b)>ae(ee.value):Q?b>ee.value:ve>new Date(ee.value)),Ns(ue.value)&&b&&(F=H?ae(b)<ae(ue.value):Q?b<ue.value:ve<new Date(ue.value))}if((D||F)&&(z(!!D,ee.message,ue.message,Ro.max,Ro.min),!r))return C(P[_].message),P}if((d||f)&&!O&&(Ns(b)||i&&Array.isArray(b))){const D=rd(d),F=rd(f),ee=!ts(D.value)&&b.length>+D.value,ue=!ts(F.value)&&b.length<+F.value;if((ee||ue)&&(z(ee,D.message,F.message),!r))return C(P[_].message),P}if(v&&!O&&Ns(b)){const{value:D,message:F}=rd(v);if(rv(D)&&!b.match(D)&&(P[_]={type:Ro.pattern,message:F,ref:a,...V(Ro.pattern,F)},!r))return C(F),P}if(x){if(wi(x)){const D=await x(b,n),F=wP(D,S);if(F&&(P[_]={...F,...V(Ro.validate,F.message)},!r))return C(F.message),P}else if(qn(x)){let D={};for(const F in x){if(!Er(D)&&!r)break;const ee=wP(await x[F](b,n),S,F);ee&&(D={...ee,...V(F,ee.message)},C(ee.message),r&&(P[_]=D))}if(!Er(D)&&(P[_]={ref:S,...D},!r))return P}}return C(!0),P};const lue={mode:Js.onSubmit,reValidateMode:Js.onChange,shouldFocusError:!0};function cue(t={}){let e={...lue,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:wi(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=qn(e.defaultValues)||qn(e.values)?rn(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:rn(s),a={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,d=0;const f={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let m={...f};const p={array:pP(),state:pP()},v=e.criteriaMode===Js.all,x=U=>K=>{clearTimeout(d),d=setTimeout(U,K)},_=async U=>{if(!e.disabled&&(f.isValid||m.isValid||U)){const K=e.resolver?Er((await I()).errors):await O(r,!0);K!==n.isValid&&p.state.next({isValid:K})}},E=(U,K)=>{!e.disabled&&(f.isValidating||f.validatingFields||m.isValidating||m.validatingFields)&&((U||Array.from(l.mount)).forEach(ne=>{ne&&(K?Lt(n.validatingFields,ne,K):Rn(n.validatingFields,ne))}),p.state.next({validatingFields:n.validatingFields,isValidating:!Er(n.validatingFields)}))},k=(U,K=[],ne,Ee,Ne=!0,xe=!0)=>{if(Ee&&ne&&!e.disabled){if(a.action=!0,xe&&Array.isArray(Te(r,U))){const je=ne(Te(r,U),Ee.argA,Ee.argB);Ne&&Lt(r,U,je)}if(xe&&Array.isArray(Te(n.errors,U))){const je=ne(Te(n.errors,U),Ee.argA,Ee.argB);Ne&&Lt(n.errors,U,je),aue(n.errors,U)}if((f.touchedFields||m.touchedFields)&&xe&&Array.isArray(Te(n.touchedFields,U))){const je=ne(Te(n.touchedFields,U),Ee.argA,Ee.argB);Ne&&Lt(n.touchedFields,U,je)}(f.dirtyFields||m.dirtyFields)&&(n.dirtyFields=cd(s,i)),p.state.next({name:U,isDirty:z(U,K),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Lt(i,U,K)},b=(U,K)=>{Lt(n.errors,U,K),p.state.next({errors:n.errors})},S=U=>{n.errors=U,p.state.next({errors:n.errors,isValid:!1})},C=(U,K,ne,Ee)=>{const Ne=Te(r,U);if(Ne){const xe=Te(i,U,Jt(ne)?Te(s,U):ne);Jt(xe)||Ee&&Ee.defaultChecked||K?Lt(i,U,K?xe:vP(Ne._f)):ee(U,xe),a.mount&&!a.action&&_()}},P=(U,K,ne,Ee,Ne)=>{let xe=!1,je=!1;const et={name:U};if(!e.disabled){if(!ne||Ee){(f.isDirty||m.isDirty)&&(je=n.isDirty,n.isDirty=et.isDirty=z(),xe=je!==et.isDirty);const Tt=_i(Te(s,U),K);je=!!Te(n.dirtyFields,U),Tt?Rn(n.dirtyFields,U):Lt(n.dirtyFields,U,!0),et.dirtyFields=n.dirtyFields,xe=xe||(f.dirtyFields||m.dirtyFields)&&je!==!Tt}if(ne){const Tt=Te(n.touchedFields,U);Tt||(Lt(n.touchedFields,U,ne),et.touchedFields=n.touchedFields,xe=xe||(f.touchedFields||m.touchedFields)&&Tt!==ne)}xe&&Ne&&p.state.next(et)}return xe?et:{}},R=(U,K,ne,Ee)=>{const Ne=Te(n.errors,U),xe=(f.isValid||m.isValid)&&ws(K)&&n.isValid!==K;if(e.delayError&&ne?(u=x(()=>b(U,ne)),u(e.delayError)):(clearTimeout(d),u=null,ne?Lt(n.errors,U,ne):Rn(n.errors,U)),(ne?!_i(Ne,ne):Ne)||!Er(Ee)||xe){const je={...Ee,...xe&&ws(K)?{isValid:K}:{},errors:n.errors,name:U};n={...n,...je},p.state.next(je)}},I=async U=>{E(U,!0);const K=await e.resolver(i,e.context,tue(U||l.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return E(U),K},j=async U=>{const{errors:K}=await I(U);if(U)for(const ne of U){const Ee=Te(K,ne);Ee?Lt(n.errors,ne,Ee):Rn(n.errors,ne)}else n.errors=K;return K},O=async(U,K,ne={valid:!0})=>{for(const Ee in U){const Ne=U[Ee];if(Ne){const{_f:xe,...je}=Ne;if(xe){const et=l.array.has(xe.name),Tt=Ne._f&&nue(Ne._f);Tt&&f.validatingFields&&E([xe.name],!0);const hr=await Z1(Ne,l.disabled,i,v,e.shouldUseNativeValidation&&!K,et);if(Tt&&f.validatingFields&&E([xe.name]),hr[xe.name]&&(ne.valid=!1,K))break;!K&&(Te(hr,xe.name)?et?fz(n.errors,hr,xe.name):Lt(n.errors,xe.name,hr[xe.name]):Rn(n.errors,xe.name))}!Er(je)&&await O(je,K,ne)}}return ne.valid},V=()=>{for(const U of l.unMount){const K=Te(r,U);K&&(K._f.refs?K._f.refs.every(ne=>!uw(ne)):!uw(K._f.ref))&&le(U)}l.unMount=new Set},z=(U,K)=>!e.disabled&&(U&&K&&Lt(i,U,K),!_i(W(),s)),D=(U,K,ne)=>H1(U,l,{...a.mount?i:Jt(K)?s:Ns(U)?{[U]:K}:K},ne,K),F=U=>Rb(Te(a.mount?i:s,U,e.shouldUnregister?Te(s,U,[]):[])),ee=(U,K,ne={})=>{const Ee=Te(r,U);let Ne=K;if(Ee){const xe=Ee._f;xe&&(!xe.disabled&&Lt(i,U,dz(K,xe)),Ne=nv(xe.ref)&&ts(K)?"":K,lz(xe.ref)?[...xe.ref.options].forEach(je=>je.selected=Ne.includes(je.value)):xe.refs?Rg(xe.ref)?xe.refs.forEach(je=>{(!je.defaultChecked||!je.disabled)&&(Array.isArray(Ne)?je.checked=!!Ne.find(et=>et===je.value):je.checked=Ne===je.value||!!Ne)}):xe.refs.forEach(je=>je.checked=je.value===Ne):t2(xe.ref)?xe.ref.value="":(xe.ref.value=Ne,xe.ref.type||p.state.next({name:U,values:rn(i)})))}(ne.shouldDirty||ne.shouldTouch)&&P(U,Ne,ne.shouldTouch,ne.shouldDirty,!0),ne.shouldValidate&&Q(U)},ue=(U,K,ne)=>{for(const Ee in K){if(!K.hasOwnProperty(Ee))return;const Ne=K[Ee],xe=U+"."+Ee,je=Te(r,xe);(l.array.has(U)||qn(Ne)||je&&!je._f)&&!vc(Ne)?ue(xe,Ne,ne):ee(xe,Ne,ne)}},ve=(U,K,ne={})=>{const Ee=Te(r,U),Ne=l.array.has(U),xe=rn(K);Lt(i,U,xe),Ne?(p.array.next({name:U,values:rn(i)}),(f.isDirty||f.dirtyFields||m.isDirty||m.dirtyFields)&&ne.shouldDirty&&p.state.next({name:U,dirtyFields:cd(s,i),isDirty:z(U,xe)})):Ee&&!Ee._f&&!ts(xe)?ue(U,xe,ne):ee(U,xe,ne),Q1(U,l)&&p.state.next({...n,name:U}),p.state.next({name:a.mount?U:void 0,values:rn(i)})},ae=async U=>{a.mount=!0;const K=U.target;let ne=K.name,Ee=!0;const Ne=Te(r,ne),xe=Tt=>{Ee=Number.isNaN(Tt)||vc(Tt)&&isNaN(Tt.getTime())||_i(Tt,Te(i,ne,Tt))},je=Rd(e.mode),et=Rd(e.reValidateMode);if(Ne){let Tt,hr;const Mi=K.type?vP(Ne._f):nz(U),gs=U.type===tv.BLUR||U.type===tv.FOCUS_OUT,po=!rue(Ne._f)&&!e.resolver&&!Te(n.errors,ne)&&!Ne._f.deps||oue(gs,Te(n.touchedFields,ne),n.isSubmitted,et,je),go=Q1(ne,l,gs);Lt(i,ne,Mi),gs?(!K||!K.readOnly)&&(Ne._f.onBlur&&Ne._f.onBlur(U),u&&u(0)):Ne._f.onChange&&Ne._f.onChange(U);const Oi=P(ne,Mi,gs),fa=!Er(Oi)||go;if(!gs&&p.state.next({name:ne,type:U.type,values:rn(i)}),po)return(f.isValid||m.isValid)&&(e.mode==="onBlur"?gs&&_():gs||_()),fa&&p.state.next({name:ne,...go?{}:Oi});if(!gs&&go&&p.state.next({...n}),e.resolver){const{errors:Su}=await I([ne]);if(xe(Mi),Ee){const yo=_P(n.errors,r,ne),ma=_P(Su,r,yo.name||ne);Tt=ma.error,ne=ma.name,hr=Er(Su)}}else E([ne],!0),Tt=(await Z1(Ne,l.disabled,i,v,e.shouldUseNativeValidation))[ne],E([ne]),xe(Mi),Ee&&(Tt?hr=!1:(f.isValid||m.isValid)&&(hr=await O(r,!0)));Ee&&(Ne._f.deps&&(!Array.isArray(Ne._f.deps)||Ne._f.deps.length>0)&&Q(Ne._f.deps),R(ne,hr,Tt,Oi))}},H=(U,K)=>{if(Te(n.errors,K)&&U.focus)return U.focus(),1},Q=async(U,K={})=>{let ne,Ee;const Ne=cs(U);if(e.resolver){const xe=await j(Jt(U)?U:Ne);ne=Er(xe),Ee=U?!Ne.some(je=>Te(xe,je)):ne}else U?(Ee=(await Promise.all(Ne.map(async xe=>{const je=Te(r,xe);return await O(je&&je._f?{[xe]:je}:je)}))).every(Boolean),!(!Ee&&!n.isValid)&&_()):Ee=ne=await O(r);return p.state.next({...!Ns(U)||(f.isValid||m.isValid)&&ne!==n.isValid?{}:{name:U},...e.resolver||!U?{isValid:ne}:{},errors:n.errors}),K.shouldFocus&&!Ee&&Hd(r,H,U?Ne:l.mount),Ee},W=(U,K)=>{let ne={...a.mount?i:s};return K&&(ne=az(K.dirtyFields?n.dirtyFields:n.touchedFields,ne)),Jt(U)?ne:Ns(U)?Te(ne,U):U.map(Ee=>Te(ne,Ee))},re=(U,K)=>({invalid:!!Te((K||n).errors,U),isDirty:!!Te((K||n).dirtyFields,U),error:Te((K||n).errors,U),isValidating:!!Te(n.validatingFields,U),isTouched:!!Te((K||n).touchedFields,U)}),he=U=>{U&&cs(U).forEach(K=>Rn(n.errors,K)),p.state.next({errors:U?n.errors:{}})},ye=(U,K,ne)=>{const Ee=(Te(r,U,{_f:{}})._f||{}).ref,Ne=Te(n.errors,U)||{},{ref:xe,message:je,type:et,...Tt}=Ne;Lt(n.errors,U,{...Tt,...K,ref:Ee}),p.state.next({name:U,errors:n.errors,isValid:!1}),ne&&ne.shouldFocus&&Ee&&Ee.focus&&Ee.focus()},Me=(U,K)=>wi(U)?p.state.subscribe({next:ne=>"values"in ne&&U(D(void 0,K),ne)}):D(U,K,!0),Fe=U=>p.state.subscribe({next:K=>{iue(U.name,K.name,U.exact)&&sue(K,U.formState||f,Wn,U.reRenderRoot)&&U.callback({values:{...i},...n,...K,defaultValues:s})}}).unsubscribe,G=U=>(a.mount=!0,m={...m,...U.formState},Fe({...U,formState:m})),le=(U,K={})=>{for(const ne of U?cs(U):l.mount)l.mount.delete(ne),l.array.delete(ne),K.keepValue||(Rn(r,ne),Rn(i,ne)),!K.keepError&&Rn(n.errors,ne),!K.keepDirty&&Rn(n.dirtyFields,ne),!K.keepTouched&&Rn(n.touchedFields,ne),!K.keepIsValidating&&Rn(n.validatingFields,ne),!e.shouldUnregister&&!K.keepDefaultValue&&Rn(s,ne);p.state.next({values:rn(i)}),p.state.next({...n,...K.keepDirty?{isDirty:z()}:{}}),!K.keepIsValid&&_()},De=({disabled:U,name:K})=>{(ws(U)&&a.mount||U||l.disabled.has(K))&&(U?l.disabled.add(K):l.disabled.delete(K))},Qe=(U,K={})=>{let ne=Te(r,U);const Ee=ws(K.disabled)||ws(e.disabled);return Lt(r,U,{...ne||{},_f:{...ne&&ne._f?ne._f:{ref:{name:U}},name:U,mount:!0,...K}}),l.mount.add(U),ne?De({disabled:ws(K.disabled)?K.disabled:e.disabled,name:U}):C(U,!0,K.value),{...Ee?{disabled:K.disabled||e.disabled}:{},...e.progressive?{required:!!K.required,min:Kf(K.min),max:Kf(K.max),minLength:Kf(K.minLength),maxLength:Kf(K.maxLength),pattern:Kf(K.pattern)}:{},name:U,onChange:ae,onBlur:ae,ref:Ne=>{if(Ne){Qe(U,K),ne=Te(r,U);const xe=Jt(Ne.value)&&Ne.querySelectorAll&&Ne.querySelectorAll("input,select,textarea")[0]||Ne,je=Yce(xe),et=ne._f.refs||[];if(je?et.find(Tt=>Tt===xe):xe===ne._f.ref)return;Lt(r,U,{_f:{...ne._f,...je?{refs:[...et.filter(uw),xe,...Array.isArray(Te(s,U))?[{}]:[]],ref:{type:xe.type,name:U}}:{ref:xe}}}),C(U,!1,void 0,xe)}else ne=Te(r,U,{}),ne._f&&(ne._f.mount=!1),(e.shouldUnregister||K.shouldUnregister)&&!(rz(l.array,U)&&a.action)&&l.unMount.add(U)}}},ie=()=>e.shouldFocusError&&Hd(r,H,l.mount),Ae=U=>{ws(U)&&(p.state.next({disabled:U}),Hd(r,(K,ne)=>{const Ee=Te(r,ne);Ee&&(K.disabled=Ee._f.disabled||U,Array.isArray(Ee._f.refs)&&Ee._f.refs.forEach(Ne=>{Ne.disabled=Ee._f.disabled||U}))},0,!1))},Ge=(U,K)=>async ne=>{let Ee;ne&&(ne.preventDefault&&ne.preventDefault(),ne.persist&&ne.persist());let Ne=rn(i);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:xe,values:je}=await I();n.errors=xe,Ne=rn(je)}else await O(r);if(l.disabled.size)for(const xe of l.disabled)Rn(Ne,xe);if(Rn(n.errors,"root"),Er(n.errors)){p.state.next({errors:{}});try{await U(Ne,ne)}catch(xe){Ee=xe}}else K&&await K({...n.errors},ne),ie(),setTimeout(ie);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Er(n.errors)&&!Ee,submitCount:n.submitCount+1,errors:n.errors}),Ee)throw Ee},me=(U,K={})=>{Te(r,U)&&(Jt(K.defaultValue)?ve(U,rn(Te(s,U))):(ve(U,K.defaultValue),Lt(s,U,rn(K.defaultValue))),K.keepTouched||Rn(n.touchedFields,U),K.keepDirty||(Rn(n.dirtyFields,U),n.isDirty=K.defaultValue?z(U,rn(Te(s,U))):z()),K.keepError||(Rn(n.errors,U),f.isValid&&_()),p.state.next({...n}))},dt=(U,K={})=>{const ne=U?rn(U):s,Ee=rn(ne),Ne=Er(U),xe=Ne?s:Ee;if(K.keepDefaultValues||(s=ne),!K.keepValues){if(K.keepDirtyValues){const je=new Set([...l.mount,...Object.keys(cd(s,i))]);for(const et of Array.from(je))Te(n.dirtyFields,et)?Lt(xe,et,Te(i,et)):ve(et,Te(xe,et))}else{if(JE&&Jt(U))for(const je of l.mount){const et=Te(r,je);if(et&&et._f){const Tt=Array.isArray(et._f.refs)?et._f.refs[0]:et._f.ref;if(nv(Tt)){const hr=Tt.closest("form");if(hr){hr.reset();break}}}}if(K.keepFieldsRef)for(const je of l.mount)ve(je,Te(xe,je));else r={}}i=e.shouldUnregister?K.keepDefaultValues?rn(s):{}:rn(xe),p.array.next({values:{...xe}}),p.state.next({values:{...xe}})}l={mount:K.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!f.isValid||!!K.keepIsValid||!!K.keepDirtyValues||!e.shouldUnregister&&!Er(xe),a.watch=!!e.shouldUnregister,a.action=!1,K.keepErrors||(n.errors={}),p.state.next({submitCount:K.keepSubmitCount?n.submitCount:0,isDirty:Ne?!1:K.keepDirty?n.isDirty:!!(K.keepDefaultValues&&!_i(U,s)),isSubmitted:K.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Ne?{}:K.keepDirtyValues?K.keepDefaultValues&&i?cd(s,i):n.dirtyFields:K.keepDefaultValues&&U?cd(s,U):K.keepDirty?n.dirtyFields:{},touchedFields:K.keepTouched?n.touchedFields:{},errors:K.keepErrors?n.errors:{},isSubmitSuccessful:K.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},Dt=(U,K)=>dt(wi(U)?U(i):U,K),dr=(U,K={})=>{const ne=Te(r,U),Ee=ne&&ne._f;if(Ee){const Ne=Ee.refs?Ee.refs[0]:Ee.ref;Ne.focus&&(Ne.focus(),K.shouldSelect&&wi(Ne.select)&&Ne.select())}},Wn=U=>{n={...n,...U}},pe={control:{register:Qe,unregister:le,getFieldState:re,handleSubmit:Ge,setError:ye,_subscribe:Fe,_runSchema:I,_focusError:ie,_getWatch:D,_getDirty:z,_setValid:_,_setFieldArray:k,_setDisabledField:De,_setErrors:S,_getFieldArray:F,_reset:dt,_resetDefaultValues:()=>wi(e.defaultValues)&&e.defaultValues().then(U=>{Dt(U,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:V,_disableForm:Ae,_subjects:p,_proxyFormState:f,get _fields(){return r},get _formValues(){return i},get _state(){return a},set _state(U){a=U},get _defaultValues(){return s},get _names(){return l},set _names(U){l=U},get _formState(){return n},get _options(){return e},set _options(U){e={...e,...U}}},subscribe:G,trigger:Q,register:Qe,handleSubmit:Ge,watch:Me,setValue:ve,getValues:W,reset:Dt,resetField:me,clearErrors:he,unregister:le,setError:ye,setFocus:dr,getFieldState:re};return{...pe,formControl:pe}}var Ia=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const t=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(Math.random()*16+t)%16|0;return(e=="x"?n:n&3|8).toString(16)})},dw=(t,e,n={})=>n.shouldFocus||Jt(n.shouldFocus)?n.focusName||`${t}.${Jt(n.focusIndex)?e:n.focusIndex}.`:"",hw=(t,e)=>[...t,...cs(e)],fw=t=>Array.isArray(t)?t.map(()=>{}):void 0;function mw(t,e,n){return[...t.slice(0,e),...cs(n),...t.slice(e)]}var pw=(t,e,n)=>Array.isArray(t)?(Jt(t[n])&&(t[n]=void 0),t.splice(n,0,t.splice(e,1)[0]),t):[],gw=(t,e)=>[...cs(e),...cs(t)];function uue(t,e){let n=0;const r=[...t];for(const s of e)r.splice(s-n,1),n++;return Rb(r).length?r:[]}var yw=(t,e)=>Jt(e)?[]:uue(t,cs(e).sort((n,r)=>n-r)),xw=(t,e,n)=>{[t[e],t[n]]=[t[n],t[e]]},kP=(t,e,n)=>(t[e]=n,t);function due(t){const e=Pb(),{control:n=e.control,name:r,keyName:s="id",shouldUnregister:i,rules:a}=t,[l,u]=Ve.useState(n._getFieldArray(r)),d=Ve.useRef(n._getFieldArray(r).map(Ia)),f=Ve.useRef(!1);n._names.array.add(r),Ve.useMemo(()=>a&&l.length>=0&&n.register(r,a),[n,r,l.length,a]),Lb(()=>n._subjects.array.subscribe({next:({values:C,name:P})=>{if(P===r||!P){const R=Te(C,r);Array.isArray(R)&&(u(R),d.current=R.map(Ia))}}}).unsubscribe,[n,r]);const m=Ve.useCallback(C=>{f.current=!0,n._setFieldArray(r,C)},[n,r]),p=(C,P)=>{const R=cs(rn(C)),I=hw(n._getFieldArray(r),R);n._names.focus=dw(r,I.length-1,P),d.current=hw(d.current,R.map(Ia)),m(I),u(I),n._setFieldArray(r,I,hw,{argA:fw(C)})},v=(C,P)=>{const R=cs(rn(C)),I=gw(n._getFieldArray(r),R);n._names.focus=dw(r,0,P),d.current=gw(d.current,R.map(Ia)),m(I),u(I),n._setFieldArray(r,I,gw,{argA:fw(C)})},x=C=>{const P=yw(n._getFieldArray(r),C);d.current=yw(d.current,C),m(P),u(P),!Array.isArray(Te(n._fields,r))&&Lt(n._fields,r,void 0),n._setFieldArray(r,P,yw,{argA:C})},_=(C,P,R)=>{const I=cs(rn(P)),j=mw(n._getFieldArray(r),C,I);n._names.focus=dw(r,C,R),d.current=mw(d.current,C,I.map(Ia)),m(j),u(j),n._setFieldArray(r,j,mw,{argA:C,argB:fw(P)})},E=(C,P)=>{const R=n._getFieldArray(r);xw(R,C,P),xw(d.current,C,P),m(R),u(R),n._setFieldArray(r,R,xw,{argA:C,argB:P},!1)},k=(C,P)=>{const R=n._getFieldArray(r);pw(R,C,P),pw(d.current,C,P),m(R),u(R),n._setFieldArray(r,R,pw,{argA:C,argB:P},!1)},b=(C,P)=>{const R=rn(P),I=kP(n._getFieldArray(r),C,R);d.current=[...I].map((j,O)=>!j||O===C?Ia():d.current[O]),m(I),u([...I]),n._setFieldArray(r,I,kP,{argA:C,argB:R},!0,!1)},S=C=>{const P=cs(rn(C));d.current=P.map(Ia),m([...P]),u([...P]),n._setFieldArray(r,[...P],R=>R,{},!0,!1)};return Ve.useEffect(()=>{if(n._state.action=!1,Q1(r,n._names)&&n._subjects.state.next({...n._formState}),f.current&&(!Rd(n._options.mode).isOnSubmit||n._formState.isSubmitted)&&!Rd(n._options.reValidateMode).isOnSubmit)if(n._options.resolver)n._runSchema([r]).then(C=>{const P=Te(C.errors,r),R=Te(n._formState.errors,r);(R?!P&&R.type||P&&(R.type!==P.type||R.message!==P.message):P&&P.type)&&(P?Lt(n._formState.errors,r,P):Rn(n._formState.errors,r),n._subjects.state.next({errors:n._formState.errors}))});else{const C=Te(n._fields,r);C&&C._f&&!(Rd(n._options.reValidateMode).isOnSubmit&&Rd(n._options.mode).isOnSubmit)&&Z1(C,n._names.disabled,n._formValues,n._options.criteriaMode===Js.all,n._options.shouldUseNativeValidation,!0).then(P=>!Er(P)&&n._subjects.state.next({errors:fz(n._formState.errors,P,r)}))}n._subjects.state.next({name:r,values:rn(n._formValues)}),n._names.focus&&Hd(n._fields,(C,P)=>{if(n._names.focus&&P.startsWith(n._names.focus)&&C.focus)return C.focus(),1}),n._names.focus="",n._setValid(),f.current=!1},[l,r,n]),Ve.useEffect(()=>(!Te(n._formValues,r)&&n._setFieldArray(r),()=>{const C=(P,R)=>{const I=Te(n._fields,P);I&&I._f&&(I._f.mount=R)};n._options.shouldUnregister||i?n.unregister(r):C(r,!1)}),[r,n,s,i]),{swap:Ve.useCallback(E,[m,r,n]),move:Ve.useCallback(k,[m,r,n]),prepend:Ve.useCallback(v,[m,r,n]),append:Ve.useCallback(p,[m,r,n]),remove:Ve.useCallback(x,[m,r,n]),insert:Ve.useCallback(_,[m,r,n]),update:Ve.useCallback(b,[m,r,n]),replace:Ve.useCallback(S,[m,r,n]),fields:Ve.useMemo(()=>l.map((C,P)=>({...C,[s]:d.current[P]||Ia()})),[l,s])}}function r2(t={}){const e=Ve.useRef(void 0),n=Ve.useRef(void 0),[r,s]=Ve.useState({isDirty:!1,isValidating:!1,isLoading:wi(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:wi(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!wi(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:a,...l}=cue(t);e.current={...l,formState:r}}const i=e.current.control;return i._options=t,Lb(()=>{const a=i._subscribe({formState:i._proxyFormState,callback:()=>s({...i._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),i._formState.isReady=!0,a},[i]),Ve.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),Ve.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),Ve.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),Ve.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),Ve.useEffect(()=>{if(i._proxyFormState.isDirty){const a=i._getDirty();a!==r.isDirty&&i._subjects.state.next({isDirty:a})}},[i,r.isDirty]),Ve.useEffect(()=>{var a;t.values&&!_i(t.values,n.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),!((a=i._options.resetOptions)===null||a===void 0)&&a.keepIsValid||i._setValid(),n.current=t.values,s(l=>({...l}))):i._resetDefaultValues()},[i,t.values]),Ve.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=iz(r,i),e.current}const NP=(t,e,n)=>{if(t&&"reportValidity"in t){const r=Te(n,e);t.setCustomValidity(r&&r.message||""),t.reportValidity()}},mz=(t,e)=>{for(const n in e.fields){const r=e.fields[n];r&&r.ref&&"reportValidity"in r.ref?NP(r.ref,n,t):r.refs&&r.refs.forEach(s=>NP(s,n,t))}},hue=(t,e)=>{e.shouldUseNativeValidation&&mz(t,e);const n={};for(const r in t){const s=Te(e.fields,r),i=Object.assign(t[r]||{},{ref:s&&s.ref});if(fue(e.names||Object.keys(t),r)){const a=Object.assign({},Te(n,r));Lt(a,"root",i),Lt(n,r,a)}else Lt(n,r,i)}return n},fue=(t,e)=>t.some(n=>n.startsWith(e+"."));var mue=function(t,e){for(var n={};t.length;){var r=t[0],s=r.code,i=r.message,a=r.path.join(".");if(!n[a])if("unionErrors"in r){var l=r.unionErrors[0].errors[0];n[a]={message:l.message,type:l.code}}else n[a]={message:i,type:s};if("unionErrors"in r&&r.unionErrors.forEach(function(f){return f.errors.forEach(function(m){return t.push(m)})}),e){var u=n[a].types,d=u&&u[r.code];n[a]=oz(a,e,n,s,d?[].concat(d,r.message):r.message)}t.shift()}return n},s2=function(t,e,n){return n===void 0&&(n={}),function(r,s,i){try{return Promise.resolve(function(a,l){try{var u=Promise.resolve(t[n.mode==="sync"?"parse":"parseAsync"](r,e)).then(function(d){return i.shouldUseNativeValidation&&mz({},i),{errors:{},values:n.raw?r:d}})}catch(d){return l(d)}return u&&u.then?u.then(void 0,l):u}(0,function(a){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(a))return{values:{},errors:hue(mue(a.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw a}))}catch(a){return Promise.reject(a)}}},Rt;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),a={};for(const l of i)a[l]=s[l];return t.objectValues(a)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},t.find=(s,i)=>{for(const a of s)if(i(a))return a},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Rt||(Rt={}));var SP;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(SP||(SP={}));const $e=Rt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ma=t=>{switch(typeof t){case"undefined":return $e.undefined;case"string":return $e.string;case"number":return Number.isNaN(t)?$e.nan:$e.number;case"boolean":return $e.boolean;case"function":return $e.function;case"bigint":return $e.bigint;case"symbol":return $e.symbol;case"object":return Array.isArray(t)?$e.array:t===null?$e.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?$e.promise:typeof Map<"u"&&t instanceof Map?$e.map:typeof Set<"u"&&t instanceof Set?$e.set:typeof Date<"u"&&t instanceof Date?$e.date:$e.object;default:return $e.unknown}},be=Rt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class oa extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let l=r,u=0;for(;u<a.path.length;){const d=a.path[u];u===a.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(n(a))):l[d]=l[d]||{_errors:[]},l=l[d],u++}}};return s(this),r}static assert(e){if(!(e instanceof oa))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Rt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const i=s.path[0];n[i]=n[i]||[],n[i].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}oa.create=t=>new oa(t);const Y1=(t,e)=>{let n;switch(t.code){case be.invalid_type:t.received===$e.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case be.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Rt.jsonStringifyReplacer)}`;break;case be.unrecognized_keys:n=`Unrecognized key(s) in object: ${Rt.joinValues(t.keys,", ")}`;break;case be.invalid_union:n="Invalid input";break;case be.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Rt.joinValues(t.options)}`;break;case be.invalid_enum_value:n=`Invalid enum value. Expected ${Rt.joinValues(t.options)}, received '${t.received}'`;break;case be.invalid_arguments:n="Invalid function arguments";break;case be.invalid_return_type:n="Invalid function return type";break;case be.invalid_date:n="Invalid date";break;case be.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Rt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case be.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case be.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case be.custom:n="Invalid input";break;case be.invalid_intersection_types:n="Intersection results could not be merged";break;case be.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case be.not_finite:n="Number must be finite";break;default:n=e.defaultError,Rt.assertNever(t)}return{message:n}};let pue=Y1;function gue(){return pue}const yue=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let l="";const u=r.filter(d=>!!d).slice().reverse();for(const d of u)l=d(a,{data:e,defaultError:l}).message;return{...s,path:i,message:l}};function Pe(t,e){const n=gue(),r=yue({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Y1?void 0:Y1].filter(s=>!!s)});t.common.issues.push(r)}class Os{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return at;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return Os.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return at;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:e.value,value:r}}}const at=Object.freeze({status:"aborted"}),fm=t=>({status:"dirty",value:t}),li=t=>({status:"valid",value:t}),TP=t=>t.status==="aborted",EP=t=>t.status==="dirty",Eh=t=>t.status==="valid",sv=t=>typeof Promise<"u"&&t instanceof Promise;var Ue;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Ue||(Ue={}));class Cl{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const CP=(t,e)=>{if(Eh(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new oa(t.common.issues);return this._error=n,this._error}}};function bt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,l)=>{const{message:u}=t;return a.code==="invalid_enum_value"?{message:u??l.defaultError}:typeof l.data>"u"?{message:u??r??l.defaultError}:a.code!=="invalid_type"?{message:l.defaultError}:{message:u??n??l.defaultError}},description:s}}class At{get description(){return this._def.description}_getType(e){return Ma(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Ma(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Os,ctx:{common:e.parent.common,data:e.data,parsedType:Ma(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(sv(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ma(e)},s=this._parseSync({data:e,path:r.path,parent:r});return CP(r,s)}"~validate"(e){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ma(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return Eh(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>Eh(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ma(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(sv(s)?s:Promise.resolve(s));return CP(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=e(s),l=()=>i.addIssue({code:be.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(l(),!1)):a?!0:(l(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Ih({schema:this,typeName:lt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return ml.create(this,this._def)}nullable(){return Ah.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return so.create(this)}promise(){return lv.create(this,this._def)}or(e){return ov.create([this,e],this._def)}and(e){return av.create(this,e,this._def)}transform(e){return new Ih({...bt(this._def),schema:this,typeName:lt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new eN({...bt(this._def),innerType:this,defaultValue:n,typeName:lt.ZodDefault})}brand(){return new zue({typeName:lt.ZodBranded,type:this,...bt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new tN({...bt(this._def),innerType:this,catchValue:n,typeName:lt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return i2.create(this,e)}readonly(){return nN.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const xue=/^c[^\s-]{8,}$/i,vue=/^[0-9a-z]+$/,bue=/^[0-9A-HJKMNP-TV-Z]{26}$/i,_ue=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,wue=/^[a-z0-9_-]{21}$/i,kue=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Nue=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Sue=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Tue="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let vw;const Eue=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Cue=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,jue=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Iue=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Aue=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Rue=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,pz="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Pue=new RegExp(`^${pz}$`);function gz(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function Lue(t){return new RegExp(`^${gz(t)}$`)}function Mue(t){let e=`${pz}T${gz(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function Oue(t,e){return!!((e==="v4"||!e)&&Eue.test(t)||(e==="v6"||!e)&&jue.test(t))}function Due(t,e){if(!kue.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function Vue(t,e){return!!((e==="v4"||!e)&&Cue.test(t)||(e==="v6"||!e)&&Iue.test(t))}class Ya extends At{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==$e.string){const i=this._getOrReturnCtx(e);return Pe(i,{code:be.invalid_type,expected:$e.string,received:i.parsedType}),at}const r=new Os;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,l=e.data.length<i.value;(a||l)&&(s=this._getOrReturnCtx(e,s),a?Pe(s,{code:be.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&Pe(s,{code:be.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Sue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"email",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")vw||(vw=new RegExp(Tue,"u")),vw.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"emoji",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")_ue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"uuid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")wue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"nanoid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")xue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"cuid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")vue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"cuid2",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")bue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"ulid",code:be.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Pe(s,{validation:"url",code:be.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"regex",code:be.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Mue(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?Pue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?Lue(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Nue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"duration",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Oue(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"ip",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Due(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"jwt",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Vue(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"cidr",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Aue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"base64",code:be.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Rue.test(e.data)||(s=this._getOrReturnCtx(e,s),Pe(s,{validation:"base64url",code:be.invalid_string,message:i.message}),r.dirty()):Rt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:be.invalid_string,...Ue.errToObj(r)})}_addCheck(e){return new Ya({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ue.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ue.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ue.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ue.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ue.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ue.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ue.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ue.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ue.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ue.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ue.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ue.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ue.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Ue.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Ue.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Ue.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Ue.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Ue.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Ue.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Ue.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Ue.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Ue.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Ue.errToObj(n)})}nonempty(e){return this.min(1,Ue.errToObj(e))}trim(){return new Ya({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ya({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ya({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ya.create=t=>new Ya({checks:[],typeName:lt.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...bt(t)});function Fue(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(t.toFixed(s).replace(".","")),a=Number.parseInt(e.toFixed(s).replace(".",""));return i%a/10**s}class Ch extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==$e.number){const i=this._getOrReturnCtx(e);return Pe(i,{code:be.invalid_type,expected:$e.number,received:i.parsedType}),at}let r;const s=new Os;for(const i of this._def.checks)i.kind==="int"?Rt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Fue(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.not_finite,message:i.message}),s.dirty()):Rt.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Ue.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ue.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ue.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ue.toString(n))}setLimit(e,n,r,s){return new Ch({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ue.toString(s)}]})}_addCheck(e){return new Ch({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ue.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ue.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ue.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ue.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ue.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ue.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Ue.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ue.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ue.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Rt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ch.create=t=>new Ch({checks:[],typeName:lt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...bt(t)});class Up extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==$e.bigint)return this._getInvalidInput(e);let r;const s=new Os;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Pe(r,{code:be.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Rt.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Pe(n,{code:be.invalid_type,expected:$e.bigint,received:n.parsedType}),at}gte(e,n){return this.setLimit("min",e,!0,Ue.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ue.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ue.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ue.toString(n))}setLimit(e,n,r,s){return new Up({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ue.toString(s)}]})}_addCheck(e){return new Up({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ue.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ue.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ue.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ue.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ue.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Up.create=t=>new Up({checks:[],typeName:lt.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...bt(t)});class jP extends At{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==$e.boolean){const r=this._getOrReturnCtx(e);return Pe(r,{code:be.invalid_type,expected:$e.boolean,received:r.parsedType}),at}return li(e.data)}}jP.create=t=>new jP({typeName:lt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...bt(t)});class iv extends At{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==$e.date){const i=this._getOrReturnCtx(e);return Pe(i,{code:be.invalid_type,expected:$e.date,received:i.parsedType}),at}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Pe(i,{code:be.invalid_date}),at}const r=new Os;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Pe(s,{code:be.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Rt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new iv({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Ue.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Ue.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}iv.create=t=>new iv({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:lt.ZodDate,...bt(t)});class IP extends At{_parse(e){if(this._getType(e)!==$e.symbol){const r=this._getOrReturnCtx(e);return Pe(r,{code:be.invalid_type,expected:$e.symbol,received:r.parsedType}),at}return li(e.data)}}IP.create=t=>new IP({typeName:lt.ZodSymbol,...bt(t)});class AP extends At{_parse(e){if(this._getType(e)!==$e.undefined){const r=this._getOrReturnCtx(e);return Pe(r,{code:be.invalid_type,expected:$e.undefined,received:r.parsedType}),at}return li(e.data)}}AP.create=t=>new AP({typeName:lt.ZodUndefined,...bt(t)});class RP extends At{_parse(e){if(this._getType(e)!==$e.null){const r=this._getOrReturnCtx(e);return Pe(r,{code:be.invalid_type,expected:$e.null,received:r.parsedType}),at}return li(e.data)}}RP.create=t=>new RP({typeName:lt.ZodNull,...bt(t)});class PP extends At{constructor(){super(...arguments),this._any=!0}_parse(e){return li(e.data)}}PP.create=t=>new PP({typeName:lt.ZodAny,...bt(t)});class LP extends At{constructor(){super(...arguments),this._unknown=!0}_parse(e){return li(e.data)}}LP.create=t=>new LP({typeName:lt.ZodUnknown,...bt(t)});class jl extends At{_parse(e){const n=this._getOrReturnCtx(e);return Pe(n,{code:be.invalid_type,expected:$e.never,received:n.parsedType}),at}}jl.create=t=>new jl({typeName:lt.ZodNever,...bt(t)});class MP extends At{_parse(e){if(this._getType(e)!==$e.undefined){const r=this._getOrReturnCtx(e);return Pe(r,{code:be.invalid_type,expected:$e.void,received:r.parsedType}),at}return li(e.data)}}MP.create=t=>new MP({typeName:lt.ZodVoid,...bt(t)});class so extends At{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==$e.array)return Pe(n,{code:be.invalid_type,expected:$e.array,received:n.parsedType}),at;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,l=n.data.length<s.exactLength.value;(a||l)&&(Pe(n,{code:a?be.too_big:be.too_small,minimum:l?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Pe(n,{code:be.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Pe(n,{code:be.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,l)=>s.type._parseAsync(new Cl(n,a,n.path,l)))).then(a=>Os.mergeArray(r,a));const i=[...n.data].map((a,l)=>s.type._parseSync(new Cl(n,a,n.path,l)));return Os.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new so({...this._def,minLength:{value:e,message:Ue.toString(n)}})}max(e,n){return new so({...this._def,maxLength:{value:e,message:Ue.toString(n)}})}length(e,n){return new so({...this._def,exactLength:{value:e,message:Ue.toString(n)}})}nonempty(e){return this.min(1,e)}}so.create=(t,e)=>new so({type:t,minLength:null,maxLength:null,exactLength:null,typeName:lt.ZodArray,...bt(e)});function ud(t){if(t instanceof $n){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=ml.create(ud(r))}return new $n({...t._def,shape:()=>e})}else return t instanceof so?new so({...t._def,type:ud(t.element)}):t instanceof ml?ml.create(ud(t.unwrap())):t instanceof Ah?Ah.create(ud(t.unwrap())):t instanceof lu?lu.create(t.items.map(e=>ud(e))):t}class $n extends At{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Rt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==$e.object){const d=this._getOrReturnCtx(e);return Pe(d,{code:be.invalid_type,expected:$e.object,received:d.parsedType}),at}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),l=[];if(!(this._def.catchall instanceof jl&&this._def.unknownKeys==="strip"))for(const d in s.data)a.includes(d)||l.push(d);const u=[];for(const d of a){const f=i[d],m=s.data[d];u.push({key:{status:"valid",value:d},value:f._parse(new Cl(s,m,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof jl){const d=this._def.unknownKeys;if(d==="passthrough")for(const f of l)u.push({key:{status:"valid",value:f},value:{status:"valid",value:s.data[f]}});else if(d==="strict")l.length>0&&(Pe(s,{code:be.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const f of l){const m=s.data[f];u.push({key:{status:"valid",value:f},value:d._parse(new Cl(s,m,s.path,f)),alwaysSet:f in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const f of u){const m=await f.key,p=await f.value;d.push({key:m,value:p,alwaysSet:f.alwaysSet})}return d}).then(d=>Os.mergeObjectSync(r,d)):Os.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return Ue.errToObj,new $n({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Ue.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new $n({...this._def,unknownKeys:"strip"})}passthrough(){return new $n({...this._def,unknownKeys:"passthrough"})}extend(e){return new $n({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new $n({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:lt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new $n({...this._def,catchall:e})}pick(e){const n={};for(const r of Rt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new $n({...this._def,shape:()=>n})}omit(e){const n={};for(const r of Rt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new $n({...this._def,shape:()=>n})}deepPartial(){return ud(this)}partial(e){const n={};for(const r of Rt.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}return new $n({...this._def,shape:()=>n})}required(e){const n={};for(const r of Rt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof ml;)i=i._def.innerType;n[r]=i}return new $n({...this._def,shape:()=>n})}keyof(){return yz(Rt.objectKeys(this.shape))}}$n.create=(t,e)=>new $n({shape:()=>t,unknownKeys:"strip",catchall:jl.create(),typeName:lt.ZodObject,...bt(e)});$n.strictCreate=(t,e)=>new $n({shape:()=>t,unknownKeys:"strict",catchall:jl.create(),typeName:lt.ZodObject,...bt(e)});$n.lazycreate=(t,e)=>new $n({shape:t,unknownKeys:"strip",catchall:jl.create(),typeName:lt.ZodObject,...bt(e)});class ov extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return n.common.issues.push(...l.ctx.common.issues),l.result;const a=i.map(l=>new oa(l.ctx.common.issues));return Pe(n,{code:be.invalid_union,unionErrors:a}),at}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const u of r){const d={...n,common:{...n.common,issues:[]},parent:null},f=u._parseSync({data:n.data,path:n.path,parent:d});if(f.status==="valid")return f;f.status==="dirty"&&!i&&(i={result:f,ctx:d}),d.common.issues.length&&a.push(d.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const l=a.map(u=>new oa(u));return Pe(n,{code:be.invalid_union,unionErrors:l}),at}}get options(){return this._def.options}}ov.create=(t,e)=>new ov({options:t,typeName:lt.ZodUnion,...bt(e)});function X1(t,e){const n=Ma(t),r=Ma(e);if(t===e)return{valid:!0,data:t};if(n===$e.object&&r===$e.object){const s=Rt.objectKeys(e),i=Rt.objectKeys(t).filter(l=>s.indexOf(l)!==-1),a={...t,...e};for(const l of i){const u=X1(t[l],e[l]);if(!u.valid)return{valid:!1};a[l]=u.data}return{valid:!0,data:a}}else if(n===$e.array&&r===$e.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const a=t[i],l=e[i],u=X1(a,l);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return n===$e.date&&r===$e.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class av extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,a)=>{if(TP(i)||TP(a))return at;const l=X1(i.value,a.value);return l.valid?((EP(i)||EP(a))&&n.dirty(),{status:n.value,value:l.data}):(Pe(r,{code:be.invalid_intersection_types}),at)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}av.create=(t,e,n)=>new av({left:t,right:e,typeName:lt.ZodIntersection,...bt(n)});class lu extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.array)return Pe(r,{code:be.invalid_type,expected:$e.array,received:r.parsedType}),at;if(r.data.length<this._def.items.length)return Pe(r,{code:be.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),at;!this._def.rest&&r.data.length>this._def.items.length&&(Pe(r,{code:be.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,l)=>{const u=this._def.items[l]||this._def.rest;return u?u._parse(new Cl(r,a,r.path,l)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>Os.mergeArray(n,a)):Os.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new lu({...this._def,rest:e})}}lu.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new lu({items:t,typeName:lt.ZodTuple,rest:null,...bt(e)})};class OP extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.map)return Pe(r,{code:be.invalid_type,expected:$e.map,received:r.parsedType}),at;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([l,u],d)=>({key:s._parse(new Cl(r,l,r.path,[d,"key"])),value:i._parse(new Cl(r,u,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const u of a){const d=await u.key,f=await u.value;if(d.status==="aborted"||f.status==="aborted")return at;(d.status==="dirty"||f.status==="dirty")&&n.dirty(),l.set(d.value,f.value)}return{status:n.value,value:l}})}else{const l=new Map;for(const u of a){const d=u.key,f=u.value;if(d.status==="aborted"||f.status==="aborted")return at;(d.status==="dirty"||f.status==="dirty")&&n.dirty(),l.set(d.value,f.value)}return{status:n.value,value:l}}}}OP.create=(t,e,n)=>new OP({valueType:e,keyType:t,typeName:lt.ZodMap,...bt(n)});class qp extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.set)return Pe(r,{code:be.invalid_type,expected:$e.set,received:r.parsedType}),at;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Pe(r,{code:be.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Pe(r,{code:be.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(u){const d=new Set;for(const f of u){if(f.status==="aborted")return at;f.status==="dirty"&&n.dirty(),d.add(f.value)}return{status:n.value,value:d}}const l=[...r.data.values()].map((u,d)=>i._parse(new Cl(r,u,r.path,d)));return r.common.async?Promise.all(l).then(u=>a(u)):a(l)}min(e,n){return new qp({...this._def,minSize:{value:e,message:Ue.toString(n)}})}max(e,n){return new qp({...this._def,maxSize:{value:e,message:Ue.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}qp.create=(t,e)=>new qp({valueType:t,minSize:null,maxSize:null,typeName:lt.ZodSet,...bt(e)});class DP extends At{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}DP.create=(t,e)=>new DP({getter:t,typeName:lt.ZodLazy,...bt(e)});class J1 extends At{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Pe(n,{received:n.data,code:be.invalid_literal,expected:this._def.value}),at}return{status:"valid",value:e.data}}get value(){return this._def.value}}J1.create=(t,e)=>new J1({value:t,typeName:lt.ZodLiteral,...bt(e)});function yz(t,e){return new jh({values:t,typeName:lt.ZodEnum,...bt(e)})}class jh extends At{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Pe(n,{expected:Rt.joinValues(r),received:n.parsedType,code:be.invalid_type}),at}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Pe(n,{received:n.data,code:be.invalid_enum_value,options:r}),at}return li(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return jh.create(e,{...this._def,...n})}exclude(e,n=this._def){return jh.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}jh.create=yz;class VP extends At{_parse(e){const n=Rt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==$e.string&&r.parsedType!==$e.number){const s=Rt.objectValues(n);return Pe(r,{expected:Rt.joinValues(s),received:r.parsedType,code:be.invalid_type}),at}if(this._cache||(this._cache=new Set(Rt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=Rt.objectValues(n);return Pe(r,{received:r.data,code:be.invalid_enum_value,options:s}),at}return li(e.data)}get enum(){return this._def.values}}VP.create=(t,e)=>new VP({values:t,typeName:lt.ZodNativeEnum,...bt(e)});class lv extends At{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==$e.promise&&n.common.async===!1)return Pe(n,{code:be.invalid_type,expected:$e.promise,received:n.parsedType}),at;const r=n.parsedType===$e.promise?n.data:Promise.resolve(n.data);return li(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}lv.create=(t,e)=>new lv({type:t,typeName:lt.ZodPromise,...bt(e)});class Ih extends At{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===lt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{Pe(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async l=>{if(n.value==="aborted")return at;const u=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return u.status==="aborted"?at:u.status==="dirty"||n.value==="dirty"?fm(u.value):u});{if(n.value==="aborted")return at;const l=this._def.schema._parseSync({data:a,path:r.path,parent:r});return l.status==="aborted"?at:l.status==="dirty"||n.value==="dirty"?fm(l.value):l}}if(s.type==="refinement"){const a=l=>{const u=s.refinement(l,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?at:(l.status==="dirty"&&n.dirty(),a(l.value),{status:n.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?at:(l.status==="dirty"&&n.dirty(),a(l.value).then(()=>({status:n.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Eh(a))return at;const l=s.transform(a.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Eh(a)?Promise.resolve(s.transform(a.value,i)).then(l=>({status:n.value,value:l})):at);Rt.assertNever(s)}}Ih.create=(t,e,n)=>new Ih({schema:t,typeName:lt.ZodEffects,effect:e,...bt(n)});Ih.createWithPreprocess=(t,e,n)=>new Ih({schema:e,effect:{type:"preprocess",transform:t},typeName:lt.ZodEffects,...bt(n)});class ml extends At{_parse(e){return this._getType(e)===$e.undefined?li(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ml.create=(t,e)=>new ml({innerType:t,typeName:lt.ZodOptional,...bt(e)});class Ah extends At{_parse(e){return this._getType(e)===$e.null?li(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ah.create=(t,e)=>new Ah({innerType:t,typeName:lt.ZodNullable,...bt(e)});class eN extends At{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===$e.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}eN.create=(t,e)=>new eN({innerType:t,typeName:lt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...bt(e)});class tN extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return sv(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new oa(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new oa(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}tN.create=(t,e)=>new tN({innerType:t,typeName:lt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...bt(e)});class FP extends At{_parse(e){if(this._getType(e)!==$e.nan){const r=this._getOrReturnCtx(e);return Pe(r,{code:be.invalid_type,expected:$e.nan,received:r.parsedType}),at}return{status:"valid",value:e.data}}}FP.create=t=>new FP({typeName:lt.ZodNaN,...bt(t)});class zue extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class i2 extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?at:i.status==="dirty"?(n.dirty(),fm(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?at:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new i2({in:e,out:n,typeName:lt.ZodPipeline})}}class nN extends At{_parse(e){const n=this._def.innerType._parse(e),r=s=>(Eh(s)&&(s.value=Object.freeze(s.value)),s);return sv(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}nN.create=(t,e)=>new nN({innerType:t,typeName:lt.ZodReadonly,...bt(e)});var lt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(lt||(lt={}));const jr=Ya.create,cv=Ch.create;jl.create;const zP=so.create,uv=$n.create;ov.create;av.create;lu.create;const BP=J1.create;jh.create;lv.create;ml.create;Ah.create;const Bue=uv({sessionName:jr().min(3,"Session name must be at least 3 chars"),date:jr().optional(),time:jr().optional(),duration:cv().min(1).max(24)});function $ue({user:t,userData:e,cart:n,onRemoveFromCart:r,onClose:s,onComplete:i}){const[a,l]=N.useState(!1),{register:u,handleSubmit:d,watch:f,formState:{errors:m,isValid:p}}=r2({resolver:s2(Bue),defaultValues:{sessionName:`${e.lastName} Session`,duration:4,date:"",time:""},mode:"onChange"}),v=f("duration")||0,x=()=>{let R=0;const I=parseInt(v)||0,j=n.map(D=>{const F=D.rate||0,ee=F*I;return R+=ee,{...D,itemTotal:ee,hourlyRate:F}}),O=n.length>=3,V=O?R*.1:0,z=R-V;return{subtotal:R,discountAmount:V,finalTotal:z,lineItems:j,shouldDiscount:O}},{subtotal:_,discountAmount:E,finalTotal:k,lineItems:b,shouldDiscount:S}=x(),C=async R=>{l(!0);const I=Wt.loading("Initializing Session...");try{let j=null;const O=`session_${Date.now()}`,V=b.map(z=>{var D;return Gt(Ce(Y,`artifacts/${qe}/public/data/bookings`),{groupId:O,sessionName:R.sessionName,senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,targetId:z.id,targetName:`${z.firstName} ${z.lastName}`,serviceType:((D=z.accountTypes)==null?void 0:D[0])||"Session",date:R.date||"Flexible",time:R.time||"Flexible",duration:R.duration,offerAmount:z.itemTotal*(S?.9:1),status:"Pending",paymentIntentId:j,timestamp:jt(),type:"GroupSession"})});await Promise.all(V),Wt.success("Session Created!",{id:I}),i()}catch(j){console.error("Booking Error:",j),Wt.error("Failed: "+j.message,{id:I})}finally{l(!1)}},P=R=>Cg("w-full p-2 border rounded-lg dark:bg-black/20 dark:text-white transition-colors focus:ring-2 focus:ring-brand-blue outline-none",R?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-200 dark:border-gray-600");return o.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4 animate-in fade-in",children:o.jsxs("form",{onSubmit:d(C),className:"bg-white dark:bg-[#2c2e36] w-full max-w-2xl rounded-2xl shadow-2xl border dark:border-gray-700 flex flex-col max-h-[90vh]",children:[o.jsxs("div",{className:"p-6 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] rounded-t-2xl",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-extrabold dark:text-white flex items-center gap-2",children:[o.jsx(Gr,{className:"text-brand-blue"})," Session Builder"]}),o.jsxs("p",{className:"text-xs text-gray-500",children:[n.length," Members Selected"]})]}),o.jsx("button",{type:"button",onClick:s,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Session Name"}),o.jsx("input",{...u("sessionName"),className:P(m.sessionName),placeholder:"e.g. My Album Recording"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Date (Optional)"}),o.jsx("input",{type:"date",...u("date"),className:P(m.date)})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Time (Optional)"}),o.jsx("input",{type:"time",...u("time"),className:P(m.time)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Duration (Hours)"}),o.jsx("input",{type:"number",...u("duration",{valueAsNumber:!0}),className:P(m.duration)})]})]}),o.jsxs("div",{className:"bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[o.jsx("h3",{className:"text-sm font-bold dark:text-white mb-3",children:"Session Roster"}),o.jsxs("div",{className:"space-y-2",children:[n.map(R=>{var I;return o.jsxs("div",{className:"flex justify-between items-center bg-white dark:bg-[#2c2e36] p-2 rounded-lg border dark:border-gray-600 shadow-sm animate-in slide-in-from-right-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold",children:R.firstName[0]}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-xs font-bold dark:text-white",children:[R.firstName," ",R.lastName]}),o.jsx("div",{className:"text-[10px] text-gray-500",children:(I=R.accountTypes)==null?void 0:I[0]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-xs font-mono",children:["$",R.rate,"/hr"]}),o.jsx("button",{type:"button",onClick:()=>r(R.id),className:"text-red-400 hover:text-red-600 transition-colors",children:o.jsx(Mr,{size:14})})]})]},R.id)}),n.length===0&&o.jsx("div",{className:"text-center text-xs text-gray-400 py-4 italic",children:"No members added yet."})]})]})]}),o.jsxs("div",{className:"border-t dark:border-gray-700 pt-6",children:[o.jsxs("h3",{className:"text-lg font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(js,{size:20})," Cost Breakdown"]}),o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-6 rounded-xl border border-blue-100 dark:border-blue-800 transition-all",children:[o.jsx("div",{className:"space-y-2 mb-4 text-sm",children:b.map(R=>o.jsxs("div",{className:"flex justify-between text-blue-900 dark:text-blue-100",children:[o.jsxs("span",{children:[R.firstName," (",R.accountTypes[0],") x ",v,"hrs"]}),o.jsxs("span",{className:"font-mono",children:["$",R.itemTotal.toFixed(2)]})]},R.id))}),o.jsxs("div",{className:"border-t border-blue-200 dark:border-blue-700 pt-2 flex justify-between items-center",children:[o.jsx("span",{className:"text-blue-800 dark:text-blue-300 font-bold",children:"Subtotal"}),o.jsxs("span",{className:"text-blue-800 dark:text-blue-300 font-bold font-mono",children:["$",_.toFixed(2)]})]}),S&&o.jsxs("div",{className:"flex justify-between items-center text-green-600 dark:text-green-400 font-bold mt-2 animate-in slide-in-from-right-2",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(ps,{size:14,fill:"currentColor"})," Bundle Discount (10%)"]}),o.jsxs("span",{className:"font-mono",children:["-$",E.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between items-center mt-4 text-2xl font-black dark:text-white",children:[o.jsx("span",{children:"Total Due"}),o.jsxs("span",{className:"font-mono",children:["$",k.toFixed(2)]})]})]})]})]}),o.jsx("div",{className:"p-6 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] rounded-b-2xl",children:o.jsx("button",{type:"submit",disabled:a||n.length===0||!p,className:au("w-full py-4 rounded-xl font-bold text-lg transition-all shadow-lg flex items-center justify-center gap-2",a||n.length===0||!p?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-blue-600 hover:scale-[1.01]"),children:a?o.jsx(Ye,{className:"animate-spin"}):o.jsxs(o.Fragment,{children:[o.jsx(kr,{size:20})," Confirm & Book"]})})})]})})}const bw=[{id:"Pending",label:"Created",icon:to},{id:"Confirmed",label:"Deposit",icon:js},{id:"En Route",label:"En Route",icon:bV},{id:"In Progress",label:"Started",icon:Ene},{id:"Completed",label:"Done",icon:kr}];function Uue({booking:t,user:e,onClose:n}){var v;const[r,s]=N.useState(t.status),[i,a]=N.useState(!1),l=e.uid===t.targetId,u=e.uid===t.senderId,f=(x=>{const _=bw.findIndex(E=>E.id===x);return _===-1?0:_})(r),m=async x=>{a(!0);try{await ft(ke(Y,`artifacts/${qe}/public/data/bookings`,t.id),{status:x,[`statusTimestamps.${x}`]:jt()}),s(x),Wt.success(`Session ${x}`)}catch(_){console.error("Update failed:",_),Wt.error("Failed to update status")}a(!1)},p=f/(bw.length-1)*100;return o.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[90] p-4 animate-in fade-in",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-3xl rounded-2xl shadow-2xl border dark:border-gray-700 flex flex-col max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"p-6 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-extrabold dark:text-white flex items-center gap-2",children:["Session Details ",o.jsxs("span",{className:"text-xs bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded-full font-medium",children:["#",t.id.slice(-6).toUpperCase()]})]}),o.jsxs("p",{className:"text-sm text-gray-500",children:["With ",u?t.targetName:t.senderName]})]}),o.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"overflow-y-auto p-6 space-y-8",children:[o.jsxs("div",{className:"relative pt-4 pb-8 px-4",children:[o.jsx("div",{className:"absolute top-8 left-0 w-full h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full -z-10"}),o.jsx("div",{className:"absolute top-8 left-0 h-1.5 bg-brand-blue rounded-full -z-10 transition-all duration-700 ease-in-out",style:{width:`${p}%`}}),o.jsx("div",{className:"flex justify-between",children:bw.map((x,_)=>{const E=_<=f,k=_===f;return o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx("div",{className:`
                                                w-10 h-10 rounded-full flex items-center justify-center border-4 transition-all duration-500
                                                ${E?"bg-brand-blue border-white dark:border-[#2c2e36] text-white":"bg-gray-200 dark:bg-gray-700 border-white dark:border-[#2c2e36] text-gray-400"}
                                                ${k?"scale-125 shadow-lg ring-4 ring-blue-100 dark:ring-blue-900/50":""}
                                            `,children:o.jsx(x.icon,{size:k?18:16,fill:E?"currentColor":"none"})}),o.jsx("span",{className:`text-xs font-bold uppercase tracking-wider transition-colors ${E?"text-brand-blue":"text-gray-400"}`,children:x.label})]},x.id)})})]}),l&&r!=="Completed"&&o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800 flex flex-wrap items-center justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-bold text-blue-800 dark:text-blue-300",children:"Update Session Status"}),o.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Keep the client informed."})]}),o.jsxs("div",{className:"flex gap-2",children:[r==="Pending"&&o.jsx("button",{onClick:()=>m("Confirmed"),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-green-700 transition shadow-sm",children:"Accept & Confirm"}),r==="Confirmed"&&o.jsxs("button",{onClick:()=>m("En Route"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-blue-700 transition shadow-sm flex items-center gap-1",children:[o.jsx(bV,{size:14})," I'm En Route"]}),r==="En Route"&&o.jsxs("button",{onClick:()=>m("In Progress"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-purple-700 transition shadow-sm flex items-center gap-1",children:[o.jsx(hE,{size:14})," Start Session"]}),r==="In Progress"&&o.jsxs("button",{onClick:()=>m("Completed"),className:"bg-gray-900 dark:bg-white dark:text-black text-white px-4 py-2 rounded-lg font-bold text-xs hover:opacity-90 transition shadow-sm flex items-center gap-1",children:[o.jsx(kr,{size:14})," Complete Session"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase border-b dark:border-gray-700 pb-2",children:"Logistics"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:o.jsx(to,{size:20,className:"text-brand-blue"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Date"}),o.jsx("div",{className:"dark:text-white font-medium",children:t.date})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:o.jsx(Zr,{size:20,className:"text-brand-blue"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Time"}),o.jsxs("div",{className:"dark:text-white font-medium",children:[t.time," (",t.duration," hrs)"]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:o.jsx(cr,{size:20,className:"text-brand-blue"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Location"}),o.jsx("div",{className:"dark:text-white font-medium",children:((v=t.venue)==null?void 0:v.name)||"Remote / TBD"})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase border-b dark:border-gray-700 pb-2",children:"Financials"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:o.jsx(js,{size:20,className:"text-green-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Total Value"}),o.jsxs("div",{className:"dark:text-white font-mono font-bold text-lg",children:["$",t.offerAmount]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:o.jsx(Nl,{size:20,className:"text-gray-500"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Agreement"}),o.jsx("div",{className:"text-brand-blue text-xs font-bold cursor-pointer hover:underline",children:"View Contract"})]})]})]})]}),t.message&&o.jsxs("div",{className:"bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[o.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Notes"}),o.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 italic",children:['"',t.message,'"']})]})]})]})})}function que({user:t,userData:e,openPublicProfile:n}){var Q;const[r,s]=N.useState("search"),[i,a]=N.useState("list"),[l,u]=N.useState("outgoing"),[d,f]=N.useState([]),[m,p]=N.useState([]),[v,x]=N.useState(!0),[_,E]=N.useState("wizard"),[k,b]=N.useState(!1),[S,C]=N.useState({date:"",time:"",location:null,radius:25,urgency:"Normal",venue:null}),[P,R]=N.useState([]),[I,j]=N.useState(!1),[O,V]=N.useState(null),[z,D]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;x(!0);const W=mt(Ce(Y,`artifacts/${qe}/public/data/bookings`),zt("senderId","==",t.uid)),re=mt(Ce(Y,`artifacts/${qe}/public/data/bookings`),zt("targetId","==",t.uid)),he=Qt(W,Me=>{p(Me.docs.map(Fe=>({id:Fe.id,...Fe.data()}))),x(!1)}),ye=Qt(re,Me=>{f(Me.docs.map(Fe=>({id:Fe.id,...Fe.data()}))),x(!1)});return()=>{he(),ye()}},[t==null?void 0:t.uid]);const F=W=>{V(W),j(!0)},ee=()=>E("talent"),ue=W=>{if(P.find(re=>re.id===W.id))return Wt.error("Already added.");R([...P,W]),Wt.success("Added to Session")},ve=W=>R(P.filter(re=>re.id!==W)),ae=()=>{b(!1),E("wizard"),R([]),C({date:"",time:"",location:null,radius:25,urgency:"Normal",venue:null}),s("requests")},H=(W,re)=>W.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400 border-2 border-dashed dark:border-gray-700 rounded-2xl",children:[o.jsx(to,{size:48,className:"mb-4 opacity-20"}),o.jsxs("p",{children:["No ",re==="outgoing"?"outgoing":"incoming"," bookings found."]})]}):o.jsx("div",{className:"grid gap-4",children:W.map(he=>{var ye,Me;return o.jsx("div",{onClick:()=>D(he),className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm hover:border-brand-blue transition group cursor-pointer",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-lg font-bold",children:re==="outgoing"?(ye=he.targetName)==null?void 0:ye[0]:(Me=he.senderName)==null?void 0:Me[0]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold dark:text-white text-lg",children:re==="outgoing"?he.targetName:he.senderName}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-xs",children:he.serviceType||"Session"}),he.date&&o.jsxs("span",{children:[" ",he.date]})]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:`text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide inline-block mb-1 ${he.status==="Pending"?"bg-yellow-100 text-yellow-700":he.status==="Confirmed"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:he.status}),o.jsxs("div",{className:"font-mono font-bold dark:text-white",children:["$",he.offerAmount]})]})]})},he.id)})});return o.jsxs("div",{className:"max-w-7xl mx-auto relative min-h-screen pb-20",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end mb-6 border-b dark:border-gray-700 gap-4",children:[o.jsxs("div",{className:"flex gap-6 w-full sm:w-auto",children:[o.jsxs("button",{onClick:()=>s("broadcasts"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="broadcasts"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[o.jsx(ps,{size:16})," Open Jobs"]}),o.jsxs("button",{onClick:()=>s("search"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="search"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[o.jsx(ur,{size:16})," Talent Search"]})]}),o.jsxs("div",{className:"flex gap-6 w-full sm:w-auto justify-end",children:[o.jsxs("button",{onClick:()=>s("planner"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="planner"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[o.jsx(to,{size:16})," Session Planner"]}),o.jsxs("button",{onClick:()=>s("requests"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="requests"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[o.jsx(Zr,{size:16})," My Bookings"]})]})]}),o.jsxs(Zn,{mode:"wait",children:[r==="broadcasts"&&o.jsx(tt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i==="create_broadcast"?o.jsx(Uce,{user:t,userData:e,onBack:()=>a("list"),onSuccess:()=>a("list")}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex justify-end mb-4",children:o.jsxs("button",{onClick:()=>a("create_broadcast"),className:"bg-brand-blue text-white px-4 py-2 rounded-lg font-bold text-sm shadow-lg hover:bg-blue-600 transition flex items-center gap-2",children:[o.jsx(ps,{size:16})," New Broadcast"]})}),o.jsx($ce,{user:t,userData:e})]})},"broadcasts"),r==="search"&&o.jsx(tt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:o.jsx(hP,{user:t,userData:e,openPublicProfile:n,onBook:F,mode:"direct"})},"search"),r==="requests"&&o.jsxs(tt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold dark:text-white",children:"Booking Management"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Track your sessions and requests."})]}),o.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-1 rounded-lg flex",children:[o.jsx("button",{onClick:()=>u("outgoing"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all ${l==="outgoing"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"I Booked"}),o.jsx("button",{onClick:()=>u("incoming"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all ${l==="incoming"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"Booked Me"})]})]}),l==="outgoing"?H(m,"outgoing"):H(d,"incoming")]},"requests"),r==="planner"&&o.jsxs(tt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[_==="wizard"&&o.jsx(zce,{userData:e,sessionParams:S,setSessionParams:C,onNext:ee}),_==="talent"&&o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 mb-6 flex justify-between items-center shadow-lg sticky top-4 z-40",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[o.jsx(to,{size:18,className:"text-brand-blue"})," ",S.date||"Flexible Date"," @ ",((Q=S.venue)==null?void 0:Q.name)||"Remote"]}),o.jsxs("p",{className:"text-xs text-gray-500",children:[P.length," talent added"]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>E("wizard"),className:"text-xs font-bold text-gray-500 hover:text-gray-900 dark:hover:text-white px-3 py-2",children:"Back"}),o.jsxs("button",{onClick:()=>b(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-green-700 shadow flex items-center gap-2",children:[o.jsx(kr,{size:16})," Review Session"]})]})]}),o.jsx(hP,{user:t,userData:e,openPublicProfile:n,onAddToCart:ue,sessionCartIds:P.map(W=>W.id),mode:"planner"})]})]},"planner")]}),o.jsxs(Zn,{children:[I&&O&&o.jsx(qce,{user:t,userData:e,target:O,allInstruments:[],onClose:()=>j(!1)}),k&&o.jsx($ue,{user:t,userData:e,cart:[...S.venue&&S.venue.id!=="remote"?[{...S.venue,accountTypes:["Studio"]}]:[],...P],onRemoveFromCart:ve,onClose:()=>b(!1),onComplete:ae}),z&&o.jsx(Uue,{booking:z,user:t,onClose:()=>D(null)})]})]})}const Wue=({data:t,setData:e})=>o.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4",children:[o.jsx("h3",{className:"text-lg font-bold dark:text-white mb-4",children:"Release Essentials"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Release Title"}),o.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.title,onChange:n=>e({...t,title:n.target.value}),placeholder:"e.g. Dark Side of the Moon"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Primary Artist"}),o.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.primaryArtist,onChange:n=>e({...t,primaryArtist:n.target.value}),placeholder:"e.g. Pink Floyd"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Release Type"}),o.jsx("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.type,onChange:n=>e({...t,type:n.target.value}),children:qle.map(n=>o.jsx("option",{value:n.id,children:n.label},n.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Primary Genre"}),o.jsxs("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.genre,onChange:n=>e({...t,genre:n.target.value}),children:[o.jsx("option",{value:"",children:"Select Genre..."}),Wle.map(n=>o.jsx("option",{value:n,children:n},n))]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Release Date"}),o.jsx("input",{type:"date",className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.releaseDate,onChange:n=>e({...t,releaseDate:n.target.value})}),o.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Standard: 2 weeks out. Express: 48hrs."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Label Name"}),o.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.labelName,onChange:n=>e({...t,labelName:n.target.value}),placeholder:"Optional (Default: Independent)"})]})]})]}),Hue=({data:t,setData:e,user:n})=>{const{uploadMedia:r,uploading:s}=ha(),[i,a]=N.useState(t.artworkUrl||null),[l,u]=N.useState(""),d=async f=>{const m=f.target.files[0];if(!m)return;const p=new Image;p.src=URL.createObjectURL(m),p.onload=async()=>{if(p.width<3e3||p.height<3e3){u("Error: Image must be at least 3000 x 3000 pixels.");return}p.width!==p.height?u("Warning: Image should be a perfect square (1:1 ratio)."):u("");const v=await r(m,`distribution/${n.uid}/artwork`);v!=null&&v.url&&(a(v.url),e({...t,artworkUrl:v.url}))}};return o.jsxs("div",{className:"flex flex-col items-center justify-center space-y-6 animate-in slide-in-from-right-4",children:[o.jsxs("div",{className:"text-center space-y-2",children:[o.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"Upload Cover Art"}),o.jsx("p",{className:"text-sm text-gray-500",children:"3000 x 3000 px  JPG or PNG  No Blurry Text"})]}),o.jsxs("div",{className:"relative group w-64 h-64 bg-gray-100 dark:bg-[#1f2128] rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 flex items-center justify-center overflow-hidden",children:[i?o.jsx("img",{src:i,className:"w-full h-full object-cover"}):o.jsxs("div",{className:"text-gray-400 flex flex-col items-center",children:[o.jsx($0,{size:48,className:"mb-2"}),o.jsx("span",{className:"text-xs font-bold",children:"Click to Upload"})]}),o.jsxs("label",{className:"absolute inset-0 cursor-pointer bg-black/0 hover:bg-black/20 transition flex items-center justify-center",children:[o.jsx("input",{type:"file",className:"hidden",accept:"image/png, image/jpeg",onChange:d,disabled:s}),s&&o.jsx(Ye,{className:"animate-spin text-white",size:32})]})]}),l&&o.jsxs("div",{className:"text-red-500 text-sm font-bold flex items-center gap-2 bg-red-50 dark:bg-red-900/20 px-4 py-2 rounded-lg",children:[o.jsx(da,{size:16})," ",l]})]})},Gue=({data:t,setData:e,user:n})=>{var u,d;const{uploadMedia:r,uploading:s}=ha(),i=async f=>{if(!f.name.toLowerCase().endsWith(".wav")){alert("Only .WAV files are accepted for distribution.");return}const m={id:Date.now(),title:f.name.replace(".wav",""),fileUrl:"",status:"uploading",isExplicit:!1,isInstrumental:!1},p=[...t.tracks||[],m];e({...t,tracks:p});try{const v=await r(f,`distribution/${n.uid}/audio_vault`);if(v!=null&&v.url){const x=p.map(_=>_.id===m.id?{..._,fileUrl:v.url,status:"ready",duration:0}:_);e({...t,tracks:x})}}catch(v){console.error("Track upload failed",v),alert("Upload failed.")}},a=f=>{e({...t,tracks:t.tracks.filter(m=>m.id!==f)})},l=(f,m,p)=>{e({...t,tracks:t.tracks.map(v=>v.id===f?{...v,[m]:p}:v)})};return o.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right-4",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"Upload Audio"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Stereo WAV files only (16-bit / 44.1kHz minimum)"})]}),o.jsxs("label",{className:"bg-brand-blue hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-xs cursor-pointer flex items-center gap-2 transition",children:[o.jsx(gb,{size:14})," Add Track",o.jsx("input",{type:"file",className:"hidden",accept:".wav",onChange:f=>i(f.target.files[0]),disabled:s})]})]}),o.jsxs("div",{className:"space-y-3",children:[((u=t.tracks)==null?void 0:u.length)===0&&o.jsx("div",{className:"text-center py-12 border-2 border-dashed dark:border-gray-700 rounded-xl text-gray-400",children:"No tracks added yet."}),(d=t.tracks)==null?void 0:d.map((f,m)=>o.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-700 flex flex-col gap-3",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-gray-500 font-mono text-xs",children:["#",m+1]}),o.jsx("div",{className:"font-bold dark:text-white text-sm",children:f.status==="uploading"?o.jsxs("span",{className:"flex items-center gap-2 text-brand-blue",children:[o.jsx(Ye,{className:"animate-spin",size:14})," Uploading..."]}):f.title})]}),o.jsx("button",{onClick:()=>a(f.id),className:"text-gray-400 hover:text-red-500",children:o.jsx(ut,{size:16})})]}),f.status==="ready"&&o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[o.jsx("input",{className:"col-span-2 p-2 text-xs border rounded bg-transparent dark:border-gray-600 dark:text-white",placeholder:"Track Title",value:f.title,onChange:p=>l(f.id,"title",p.target.value)}),o.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300 p-2 bg-gray-50 dark:bg-gray-800 rounded cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:f.isExplicit,onChange:p=>l(f.id,"isExplicit",p.target.checked)})," Explicit"]}),o.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300 p-2 bg-gray-50 dark:bg-gray-800 rounded cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:f.isInstrumental,onChange:p=>l(f.id,"isInstrumental",p.target.checked)})," Instrumental"]})]})]},f.id))]})]})},Kue=({data:t,setData:e})=>{var s;const n=i=>{const a=t.stores||[],l=a.includes(i)?a.filter(u=>u!==i):[...a,i];e({...t,stores:l})},r=()=>{var i;((i=t.stores)==null?void 0:i.length)===hm.length?e({...t,stores:[]}):e({...t,stores:hm.map(a=>a.id)})};return o.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"Select Stores"}),o.jsx("button",{onClick:r,className:"text-xs font-bold text-brand-blue hover:underline",children:((s=t.stores)==null?void 0:s.length)===hm.length?"Deselect All":"Select All"})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:hm.map(i=>{var l;const a=(l=t.stores)==null?void 0:l.includes(i.id);return o.jsxs("div",{onClick:()=>n(i.id),className:`p-3 rounded-xl border flex items-center gap-3 cursor-pointer transition-all ${a?"bg-blue-50 border-brand-blue dark:bg-blue-900/20":"bg-white dark:bg-[#1f2128] dark:border-gray-700 hover:border-gray-300"}`,children:[o.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center ${a?"bg-brand-blue border-brand-blue":"border-gray-400"}`,children:a&&o.jsx(kr,{size:12,className:"text-white"})}),o.jsx("span",{className:`text-sm font-bold ${a?"text-brand-blue dark:text-white":"text-gray-600 dark:text-gray-400"}`,children:i.name})]},i.id)})}),o.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/10 p-4 rounded-xl border border-yellow-200 dark:border-yellow-800 text-sm text-yellow-800 dark:text-yellow-200 flex items-start gap-3",children:[o.jsx(SV,{size:18,className:"mt-0.5 shrink-0"}),o.jsx("p",{children:"Deliveries usually take 2-5 days for Spotify/Apple, and up to 2 weeks for other stores. Please plan your release date accordingly."})]})]})};function Que({user:t,userData:e,initialData:n,onCancel:r,onSuccess:s}){const[i,a]=N.useState(1),[l,u]=N.useState(!1),[d,f]=N.useState(n||{title:"",primaryArtist:`${e.firstName} ${e.lastName}`,type:"single",genre:"",releaseDate:"",labelName:"",artworkUrl:"",tracks:[],stores:hm.map(v=>v.id),status:"Draft"}),m=()=>i===1?d.title&&d.primaryArtist&&d.genre&&d.releaseDate:i===2?!!d.artworkUrl:i===3?d.tracks.length>0&&d.tracks.every(v=>v.status==="ready"):i===4?d.stores.length>0:!0,p=async()=>{u(!0);try{const v={...d,uploaderId:t.uid,updatedAt:jt(),status:"Processing"};n!=null&&n.id?await ft(ke(Y,Le(t.uid).distributionReleases,n.id),v):await Gt(Ce(Y,Le(t.uid).distributionReleases),{...v,createdAt:jt()}),alert("Release submitted successfully! It is now in the review queue."),s()}catch(v){console.error("Submission error:",v),alert("Failed to submit release.")}u(!1)};return o.jsxs("div",{className:"max-w-4xl mx-auto bg-white dark:bg-[#2c2e36] rounded-2xl shadow-xl overflow-hidden border dark:border-gray-700 min-h-[600px] flex flex-col",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-6 border-b dark:border-gray-700 flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-extrabold dark:text-white",children:"New Release"}),o.jsxs("p",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mt-1",children:["Step ",i," of 4"]})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-white",children:o.jsx(ut,{})})]}),o.jsx("div",{className:"h-1 bg-gray-200 dark:bg-gray-700 w-full",children:o.jsx("div",{className:"h-full bg-brand-blue transition-all duration-300",style:{width:`${i/4*100}%`}})}),o.jsxs("div",{className:"flex-1 p-8 overflow-y-auto",children:[i===1&&o.jsx(Wue,{data:d,setData:f}),i===2&&o.jsx(Hue,{data:d,setData:f,user:t}),i===3&&o.jsx(Gue,{data:d,setData:f,user:t}),i===4&&o.jsx(Kue,{data:d,setData:f})]}),o.jsxs("div",{className:"p-6 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] flex justify-between items-center",children:[i>1?o.jsxs("button",{onClick:()=>a(i-1),className:"flex items-center gap-2 text-gray-500 font-bold hover:text-gray-800 dark:hover:text-white transition",children:[o.jsx(_V,{size:18})," Back"]}):o.jsx("div",{}),i<4?o.jsxs("button",{onClick:()=>a(i+1),disabled:!m(),className:"bg-brand-blue text-white px-6 py-2.5 rounded-xl font-bold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-blue-600 transition",children:["Next Step ",o.jsx(lo,{size:18})]}):o.jsx("button",{onClick:p,disabled:l||!m(),className:"bg-green-600 text-white px-8 py-2.5 rounded-xl font-bold flex items-center gap-2 disabled:opacity-50 hover:bg-green-700 transition shadow-lg",children:l?o.jsx(Ye,{className:"animate-spin"}):"Submit Release"})]})]})}function Zue({user:t,userData:e}){const[n,r]=N.useState("list"),[s,i]=N.useState([]),[a,l]=N.useState(!0),[u,d]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;const p=mt(Ce(Y,Le(t.uid).distributionReleases),zt("uploaderId","==",t.uid),_n("updatedAt","desc")),v=Qt(p,x=>{i(x.docs.map(_=>({id:_.id,..._.data()}))),l(!1)});return()=>v()},[t==null?void 0:t.uid]);const f=async(p,v)=>{if(confirm(`Are you sure you want to delete "${v}"? This cannot be undone if already distributed.`))try{await Pi(ke(Y,Le(t.uid).distributionReleases,p))}catch(x){console.error(x),alert("Failed to delete release.")}},m=p=>{if(p.status!=="Draft"&&p.status!=="Action Needed")return alert("Cannot edit a release that is currently processing or live. Contact support for takedowns.");d(p),r("create")};return n==="create"?o.jsx(Que,{user:t,userData:e,initialData:u,onCancel:()=>{r("list"),d(null)},onSuccess:()=>{r("list"),d(null)}}):o.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-in fade-in",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(_g,{className:"text-brand-blue"})," Distribution Portal"]}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your catalog across Spotify, Apple Music, and 150+ stores."})]}),o.jsxs("button",{onClick:()=>r("create"),className:"bg-brand-blue text-white px-6 py-3 rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 shadow-lg hover:shadow-blue-500/20",children:[o.jsx(ms,{size:20})," New Release"]})]}),o.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 overflow-hidden min-h-[400px]",children:a?o.jsx("div",{className:"p-12 text-center text-gray-500",children:"Loading catalog..."}):s.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-6 rounded-full mb-4",children:o.jsx(aE,{size:48,className:"text-gray-400"})}),o.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"No Releases Yet"}),o.jsx("p",{className:"text-gray-500 max-w-sm mt-2 mb-6",children:"Start your journey by uploading your first single, EP, or album to the world."}),o.jsx("button",{onClick:()=>r("create"),className:"text-brand-blue font-bold hover:underline",children:"Create First Release"})]}):o.jsx("div",{className:"divide-y dark:divide-gray-700",children:s.map(p=>{var v;return o.jsxs("div",{className:"p-5 hover:bg-gray-50 dark:hover:bg-white/5 transition flex flex-col md:flex-row md:items-center justify-between gap-4 group",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"h-16 w-16 bg-gray-200 dark:bg-black rounded-lg shadow-sm overflow-hidden shrink-0 border dark:border-gray-700",children:p.artworkUrl?o.jsx("img",{src:p.artworkUrl,alt:"Art",className:"h-full w-full object-cover"}):o.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:o.jsx(co,{size:20})})}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide border ${p.status==="Live"?"bg-green-100 text-green-700 border-green-200":p.status==="Processing"?"bg-blue-100 text-blue-700 border-blue-200":p.status==="Action Needed"?"bg-red-100 text-red-700 border-red-200":"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600"}`,children:p.status}),o.jsx("span",{className:"text-xs text-gray-400 uppercase font-bold",children:p.type})]}),o.jsx("h4",{className:"font-bold text-lg dark:text-white leading-tight",children:p.title||"Untitled Release"}),o.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[p.primaryArtist,"  ",((v=p.tracks)==null?void 0:v.length)||0," Tracks"]})]})]}),o.jsxs("div",{className:"flex items-center gap-4 pl-4 md:pl-0 border-l md:border-l-0 dark:border-gray-700",children:[o.jsxs("div",{className:"text-right hidden md:block mr-4",children:[o.jsx("div",{className:"text-xs text-gray-400 uppercase font-bold",children:"Release Date"}),o.jsx("div",{className:"text-sm font-medium dark:text-gray-200",children:p.releaseDate?new Date(p.releaseDate).toLocaleDateString():"TBD"})]}),o.jsx("button",{onClick:()=>m(p),className:"p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",title:"Edit / View Details",children:o.jsx(dE,{size:18})}),(p.status==="Draft"||p.status==="Action Needed")&&o.jsx("button",{onClick:()=>f(p.id,p.title),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",title:"Delete Release",children:o.jsx(Mr,{size:18})})]})]},p.id)})})})]})}const Yue=[{id:"guitar_electric",label:"Electric Guitar"},{id:"guitar_acoustic",label:"Acoustic Guitar"},{id:"amp_head",label:"Amplifier Head"},{id:"amp_combo",label:"Combo Amp"},{id:"keyboard",label:"Keyboard/Synth"},{id:"rack_unit",label:"Rack Gear (1U/2U)"},{id:"pedal",label:"Pedal/Stompbox"}],xz=({type:t,view:e,onClick:n,markers:r=[]})=>{var d;const s=()=>r.map((f,m)=>o.jsxs("g",{transform:`translate(${f.x}, ${f.y})`,children:[o.jsx("circle",{r:"6",fill:"#ef4444",stroke:"white",strokeWidth:"2",className:"drop-shadow-md"}),o.jsx("text",{y:"-10",textAnchor:"middle",fill:"#ef4444",fontSize:"10",fontWeight:"bold",children:m+1})]},m)),i={width:"100%",height:"400",viewBox:"0 0 300 400",className:"w-full h-full cursor-crosshair touch-none select-none",onClick:f=>{const m=f.target.getBoundingClientRect(),p=(f.clientX-m.left)*(300/m.width),v=(f.clientY-m.top)*(400/m.height);n(p,v)}},a={guitar_electric:{front:o.jsx("path",{d:"M150,20 C140,20 135,25 135,40 L135,100 C110,110 90,140 90,170 C90,190 100,200 110,210 C100,220 90,240 90,270 C90,330 110,360 150,360 C190,360 210,330 210,270 C210,240 200,220 190,210 C200,200 210,190 210,170 C210,140 190,110 165,100 L165,40 C165,25 160,20 150,20 Z",fill:"#e5e7eb",stroke:"#374151",strokeWidth:"2"}),back:o.jsx("path",{d:"M150,20 C140,20 135,25 135,40 L135,100 C110,110 90,140 90,170 C90,190 100,200 110,210 C100,220 90,240 90,270 C90,330 110,360 150,360 C190,360 210,330 210,270 C210,240 200,220 190,210 C200,200 210,190 210,170 C210,140 190,110 165,100 L165,40 C165,25 160,20 150,20 Z",fill:"#d1d5db",stroke:"#374151",strokeWidth:"2",strokeDasharray:"5,5"})},amp_combo:{front:o.jsx("rect",{x:"50",y:"50",width:"200",height:"250",rx:"5",fill:"#e5e7eb",stroke:"#374151",strokeWidth:"2"}),back:o.jsxs("g",{children:[o.jsx("rect",{x:"50",y:"50",width:"200",height:"250",rx:"5",fill:"#d1d5db",stroke:"#374151",strokeWidth:"2"}),o.jsx("rect",{x:"70",y:"200",width:"160",height:"80",fill:"#9ca3af",opacity:"0.5"})]})}},l=()=>o.jsx("rect",{x:"50",y:"50",width:"200",height:"300",rx:"10",fill:"#f3f4f6",stroke:"#9ca3af",strokeWidth:"2",strokeDasharray:"4"}),u=((d=a[t])==null?void 0:d[e])||o.jsx(l,{});return o.jsxs("svg",{...i,children:[u,s()]})};function Xue({initialData:t,onSave:e,onCancel:n,type:r}){const[s,i]=N.useState((t==null?void 0:t.gearType)||"guitar_electric"),[a,l]=N.useState("front"),[u,d]=N.useState((t==null?void 0:t.markers)||[]),[f,m]=N.useState((t==null?void 0:t.notes)||""),[p,v]=N.useState((t==null?void 0:t.photos)||[]),[x,_]=N.useState(null),[E,k]=N.useState(""),{uploadMedia:b,uploading:S}=ha(),C=(I,j)=>{const O={x:I,y:j,view:a,id:Date.now(),label:""};d([...u,O]),_(O),k("")},P=()=>{x&&(d(u.map(I=>I.id===x.id?{...I,label:E}:I)),_(null))},R=async I=>{const j=I.target.files[0];if(!j)return;const O=await b(j,`inspections/${Date.now()}`);O&&v(V=>[...V,O])};return o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden flex flex-col h-[80vh]",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[o.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[o.jsx(da,{className:r==="Pre"?"text-orange-500":"text-green-500",size:20})," ",r,"-Inspection Report"]}),o.jsx("button",{onClick:n,children:o.jsx(ut,{className:"text-gray-500"})})]}),o.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[o.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-black/40 relative flex flex-col items-center justify-center p-4",children:[o.jsxs("div",{className:"absolute top-4 left-4 z-10 flex flex-col gap-2",children:[o.jsx("select",{className:"p-2 rounded-lg border dark:border-gray-600 bg-white dark:bg-[#1f2128] text-sm font-bold dark:text-white shadow-sm",value:s,onChange:I=>i(I.target.value),children:Yue.map(I=>o.jsx("option",{value:I.id,children:I.label},I.id))}),o.jsx("div",{className:"flex bg-white dark:bg-[#1f2128] rounded-lg border dark:border-gray-600 p-1 shadow-sm",children:["front","back","sides"].map(I=>o.jsx("button",{onClick:()=>l(I),className:`px-3 py-1 text-xs font-bold rounded-md capitalize ${a===I?"bg-brand-blue text-white":"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:I},I))})]}),o.jsxs("div",{className:"w-full max-w-md h-full aspect-[3/4] bg-white dark:bg-[#1f2128] rounded-xl shadow-inner border dark:border-gray-700 relative",children:[o.jsx(xz,{type:s,view:a,markers:u.filter(I=>I.view===a),onClick:C}),x&&o.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 bg-white dark:bg-[#2c2e36] p-4 rounded-xl shadow-2xl border border-brand-blue z-20 animate-in zoom-in-95",children:[o.jsx("h4",{className:"text-xs font-bold uppercase text-gray-500 mb-2",children:"Identify Issue"}),o.jsx("input",{autoFocus:!0,className:"w-full p-2 border rounded mb-2 text-sm dark:bg-black/20 dark:text-white",placeholder:"e.g. Scratch",value:E,onChange:I=>k(I.target.value),onKeyDown:I=>I.key==="Enter"&&P()}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>{d(u.filter(I=>I.id!==x.id)),_(null)},className:"flex-1 bg-red-100 text-red-600 py-1 rounded text-xs font-bold",children:"Delete"}),o.jsx("button",{onClick:P,className:"flex-1 bg-brand-blue text-white py-1 rounded text-xs font-bold",children:"Save"})]})]})]})]}),o.jsxs("div",{className:"w-full md:w-80 bg-white dark:bg-[#2c2e36] border-l dark:border-gray-700 flex flex-col",children:[o.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Damage Log"}),o.jsx("div",{className:"space-y-2",children:u.map((I,j)=>o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-black/20 rounded border dark:border-gray-700",children:[o.jsx("span",{className:"w-5 h-5 rounded-full bg-red-500 text-white flex items-center justify-center text-xs font-bold shrink-0",children:j+1}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-sm font-bold dark:text-white",children:I.label||"Unlabeled"}),o.jsxs("div",{className:"text-[10px] text-gray-500 uppercase",children:[I.view," View"]})]}),o.jsx("button",{onClick:()=>d(u.filter(O=>O.id!==I.id)),children:o.jsx(ut,{size:14,className:"text-gray-400 hover:text-red-500"})})]},j))})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Notes"}),o.jsx("textarea",{className:"w-full p-3 border rounded-lg text-sm dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Overall condition...",value:f,onChange:I=>m(I.target.value)})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Evidence Photos"}),o.jsxs("label",{className:"cursor-pointer text-brand-blue hover:text-blue-600",children:[o.jsx(gb,{size:16}),o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:R,disabled:S})]})]}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:p.map((I,j)=>o.jsxs("div",{className:"aspect-square rounded-lg overflow-hidden border dark:border-gray-600 relative group",children:[o.jsx("img",{src:I.url,className:"w-full h-full object-cover"}),o.jsx("button",{onClick:()=>v(p.filter((O,V)=>V!==j)),className:"absolute top-1 right-1 bg-red-500 text-white p-0.5 rounded opacity-0 group-hover:opacity-100 transition",children:o.jsx(ut,{size:12})})]},j))})]})]}),o.jsx("div",{className:"p-4 border-t dark:border-gray-700",children:o.jsxs("button",{onClick:()=>e({gearType:s,markers:u,notes:f,photos:p,timestamp:new Date().toISOString()}),className:"w-full bg-green-600 text-white py-3 rounded-xl font-bold hover:bg-green-700 flex items-center justify-center gap-2",children:[o.jsx(_u,{size:18})," Finalize Report"]})})]})]})]})}const Jue=["Mint","Excellent","Good","Fair","Non-Functioning"];function ede({user:t,userData:e,setActiveTab:n}){const[r,s]=N.useState("browse"),[i,a]=N.useState([]),[l,u]=N.useState("All"),[d,f]=N.useState(""),[m,p]=N.useState(null);N.useEffect(()=>{const x=mt(Ce(Y,Le(t.uid).gearListings),_n("timestamp","desc")),_=Qt(x,E=>{a(E.docs.map(k=>({id:k.id,...k.data()})))});return()=>_()},[t.uid]);const v=i.filter(x=>(l==="All"||x.category===l)&&(x.title.toLowerCase().includes(d.toLowerCase())||x.brand.toLowerCase().includes(d.toLowerCase())));return o.jsxs("div",{className:"max-w-7xl mx-auto pb-24 animate-in fade-in",children:[r==="browse"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 mb-6",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(Hh,{className:"text-orange-500"})," Gear Exchange"]}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Buy and sell verified studio equipment."})]}),o.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[o.jsxs("div",{className:"relative flex-1 md:w-64",children:[o.jsx(ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-9 pr-4 py-2 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-[#2c2e36] text-sm dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Search gear...",value:d,onChange:x=>f(x.target.value)})]}),o.jsxs("button",{onClick:()=>s("create"),className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg transition",children:[o.jsx(ms,{size:16})," Sell Gear"]})]})]}),o.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 scrollbar-hide mb-2",children:[o.jsx("button",{onClick:()=>u("All"),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition ${l==="All"?"bg-white dark:bg-white text-black shadow":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:"All Gear"}),zp.map(x=>o.jsx("button",{onClick:()=>u(x.id),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition ${l===x.id?"bg-white dark:bg-white text-black shadow":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:x.label},x.id))]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:v.map(x=>{var _;return o.jsxs("div",{onClick:()=>p(x),className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden hover:shadow-xl transition cursor-pointer group flex flex-col",children:[o.jsxs("div",{className:"aspect-square bg-gray-100 dark:bg-black/40 relative flex items-center justify-center overflow-hidden",children:[(_=x.images)!=null&&_[0]?o.jsx("img",{src:x.images[0],className:"w-full h-full object-cover group-hover:scale-105 transition duration-500"}):o.jsx(mb,{size:32,className:"text-gray-400"}),o.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 text-white text-xs font-bold px-2 py-1 rounded backdrop-blur-md",children:["$",x.price]}),x.conditionReport&&o.jsxs("div",{className:"absolute bottom-2 left-2 bg-green-500/90 text-white text-[10px] font-bold px-2 py-0.5 rounded flex items-center gap-1",children:[o.jsx(kr,{size:10})," Inspected"]})]}),o.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[o.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1",children:x.brand}),o.jsx("h4",{className:"font-bold dark:text-white text-sm mb-1 line-clamp-1",children:x.title}),o.jsxs("div",{className:"text-xs text-gray-500 mb-3",children:[x.condition," Condition"]}),o.jsx("div",{className:"mt-auto pt-3 border-t dark:border-gray-700 flex justify-between items-center text-xs text-gray-400",children:o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(cr,{size:10})," ",x.location||"Shipped"]})})]})]},x.id)})})]}),r==="create"&&o.jsx(tde,{user:t,userData:e,onCancel:()=>s("browse"),onSuccess:()=>s("browse")}),m&&o.jsx(nde,{item:m,onClose:()=>p(null),currentUser:t})]})}function tde({user:t,userData:e,onCancel:n,onSuccess:r}){const[s,i]=N.useState(1),[a,l]=N.useState({title:"",brand:"",category:zp[0].id,condition:"Good",price:"",description:"",location:e.city||"",weight:"",length:"",width:"",height:""}),[u,d]=N.useState([]),[f,m]=N.useState(null),[p,v]=N.useState(!1),{uploadMedia:x,uploading:_}=ha(),E=async b=>{const S=b.target.files[0];if(!S)return;const C=await x(S,`gear/${t.uid}`);C!=null&&C.url&&d([...u,C.url])},k=async()=>{if(!a.title||!a.price)return alert("Title and Price required.");v(!0);try{await Gt(Ce(Y,Le(t.uid).gearListings),{...a,price:parseInt(a.price),images:u,conditionReport:f,sellerId:t.uid,sellerName:`${e.firstName} ${e.lastName}`,sellerPhoto:e.photoURL||null,timestamp:jt(),status:"Active"}),alert("Listing posted!"),r()}catch(b){console.error(b),alert("Failed to post listing.")}v(!1)};return s==="inspection"?o.jsx("div",{className:"h-[600px]",children:o.jsx(Xue,{type:"Pre",onSave:b=>{m(b),i(1)},onCancel:()=>i(1)})}):o.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-8 rounded-2xl border dark:border-gray-700 shadow-xl",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h3",{className:"text-xl font-bold dark:text-white",children:"List Gear for Sale"}),o.jsx("button",{onClick:n,children:o.jsx(ut,{className:"text-gray-400"})})]}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Brand"}),o.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:a.brand,onChange:b=>l({...a,brand:b.target.value}),placeholder:"e.g. Fender"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Model / Title"}),o.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:a.title,onChange:b=>l({...a,title:b.target.value}),placeholder:"e.g. Stratocaster"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Category"}),o.jsx("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:a.category,onChange:b=>l({...a,category:b.target.value}),children:zp.map(b=>o.jsx("option",{value:b.id,children:b.label},b.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Condition"}),o.jsx("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:a.condition,onChange:b=>l({...a,condition:b.target.value}),children:Jue.map(b=>o.jsx("option",{value:b,children:b},b))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Price ($)"}),o.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",value:a.price,onChange:b=>l({...a,price:b.target.value})})]}),o.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Weight (lb)"}),o.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"lbs",value:a.weight,onChange:b=>l({...a,weight:b.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"L (in)"}),o.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Len",value:a.length,onChange:b=>l({...a,length:b.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"W (in)"}),o.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Wid",value:a.width,onChange:b=>l({...a,width:b.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"H (in)"}),o.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Hgt",value:a.height,onChange:b=>l({...a,height:b.target.value})})]})]}),o.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/10 p-4 rounded-xl border border-orange-100 dark:border-orange-800 flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-orange-800 dark:text-orange-400 text-sm mb-1",children:"Tech Inspection Report"}),o.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-300",children:f?o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(kr,{size:12})," Report Attached (",f.markers.length," points)"]}):"Mark scratches, dents, or issues on a diagram to build trust."})]}),o.jsx("button",{onClick:()=>i("inspection"),className:`text-xs font-bold px-3 py-2 rounded-lg border transition ${f?"bg-white text-green-600 border-green-200":"bg-orange-100 text-orange-700 border-orange-200 hover:bg-orange-200"}`,children:f?"Edit Report":"Create Report"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Photos"}),o.jsxs("div",{className:"flex gap-2",children:[u.map((b,S)=>o.jsx("img",{src:b,className:"w-16 h-16 rounded-lg object-cover border dark:border-gray-600"},S)),o.jsxs("label",{className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 flex items-center justify-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",children:[_?o.jsx(Ye,{className:"animate-spin text-gray-400"}):o.jsx(ms,{className:"text-gray-400"}),o.jsx("input",{type:"file",className:"hidden",onChange:E,disabled:_})]})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx("button",{onClick:n,className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition",children:"Cancel"}),o.jsx("button",{onClick:k,disabled:p||_,className:"flex-1 bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition shadow-lg flex items-center justify-center gap-2",children:p?o.jsx(Ye,{className:"animate-spin"}):"Post Listing"})]})]})]})}function nde({item:t,onClose:e,currentUser:n}){var i,a;const[r,s]=N.useState(!1);return o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-4xl h-[90vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-hidden border dark:border-gray-700",children:[o.jsxs("div",{className:"md:w-1/2 bg-black relative flex flex-col",children:[o.jsxs("div",{className:"flex-1 flex items-center justify-center p-4 relative",children:[r&&t.conditionReport?o.jsxs("div",{className:"w-full h-full bg-white rounded-xl overflow-hidden",children:[o.jsx(xz,{type:t.conditionReport.gearType,view:"front",markers:t.conditionReport.markers,onClick:()=>{}}),o.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/80 text-white px-3 py-1 rounded-full text-xs",children:"Inspection View"})]}):(i=t.images)!=null&&i[0]?o.jsx("img",{src:t.images[0],className:"max-h-full max-w-full object-contain"}):o.jsx(mb,{size:48,className:"text-gray-600"}),o.jsx("button",{onClick:e,className:"absolute top-4 left-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70",children:o.jsx(ut,{size:20})})]}),t.conditionReport&&o.jsxs("div",{className:"p-4 bg-[#1f2128] border-t border-gray-800 flex gap-2 justify-center",children:[o.jsx("button",{onClick:()=>s(!1),className:`px-4 py-2 rounded text-xs font-bold ${r?"bg-gray-800 text-gray-400":"bg-orange-600 text-white"}`,children:"Photos"}),o.jsxs("button",{onClick:()=>s(!0),className:`px-4 py-2 rounded text-xs font-bold flex items-center gap-1 ${r?"bg-orange-600 text-white":"bg-gray-800 text-gray-400"}`,children:[o.jsx(kl,{size:12})," Condition Map"]})]})]}),o.jsxs("div",{className:"md:w-1/2 p-8 overflow-y-auto bg-white dark:bg-[#2c2e36]",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-1",children:t.brand}),o.jsx("h2",{className:"text-3xl font-extrabold dark:text-white mb-2",children:t.title}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-xl font-bold text-green-600",children:["$",t.price]}),o.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded text-xs font-bold",children:t.condition})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl border dark:border-gray-700",children:[o.jsx("img",{src:t.sellerPhoto,className:"w-10 h-10 rounded-full bg-gray-300"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Seller"}),o.jsx("div",{className:"font-bold dark:text-white text-sm",children:t.sellerName})]})]}),((a=t.conditionReport)==null?void 0:a.notes)&&o.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/10 p-4 rounded-xl border border-orange-100 dark:border-orange-800/50",children:[o.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-400 text-sm mb-2 flex items-center gap-2",children:[o.jsx(Hh,{size:16})," Tech Notes"]}),o.jsxs("p",{className:"text-sm text-orange-900 dark:text-orange-200 italic",children:['"',t.conditionReport.notes,'"']})]}),o.jsxs("div",{className:"prose dark:prose-invert text-sm text-gray-600 dark:text-gray-300",children:[o.jsx("h4",{className:"font-bold dark:text-white text-sm uppercase",children:"Description"}),o.jsx("p",{children:t.description||"No description provided."})]})]}),o.jsxs("div",{className:"mt-8 pt-6 border-t dark:border-gray-700",children:[t.sellerId===n.uid?o.jsx("button",{className:"w-full bg-gray-100 dark:bg-gray-700 text-gray-500 font-bold py-3 rounded-xl cursor-not-allowed",children:"You own this listing"}):o.jsxs("button",{className:"w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-4 rounded-xl shadow-lg flex items-center justify-center gap-2 transition transform hover:scale-[1.02]",children:[o.jsx(js,{size:20})," Buy Now"]}),o.jsxs("p",{className:"text-center text-[10px] text-gray-400 mt-3 flex items-center justify-center gap-1",children:[o.jsx(kr,{size:10})," Purchases covered by SeshNx Buyer Protection"]})]})]})]})})}function rde({user:t,userData:e,tokenBalance:n,refreshWallet:r}){const[s,i]=N.useState([]),[a,l]=N.useState("All"),[u,d]=N.useState(""),[f,m]=N.useState(new Set),[p,v]=N.useState(!1),[x,_]=N.useState(null),[E,k]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;const C=mt(Ce(Y,Le(t.uid).marketplaceItems),_n("timestamp","desc")),P=Qt(C,R=>{i(R.docs.map(I=>({id:I.id,...I.data()})))});return()=>P()},[t.uid]),N.useEffect(()=>{if(!(t!=null&&t.uid))return;const C=Ce(Y,Le(t.uid).userLibrary),P=Qt(C,R=>{m(new Set(R.docs.map(I=>I.data().itemId)))});return()=>P()},[t==null?void 0:t.uid]);const b=async C=>{if(n<C.price){alert("Insufficient tokens! Please top up.");return}if(window.confirm(`Purchase ${C.title} for ${C.price} Tokens?`))try{const P=ke(Y,Le(t.uid).userWallet);await ft(P,{balance:Ni(-C.price)}),await Gt(Ce(Y,Le(t.uid).userLibrary),{itemId:C.id,title:C.title,type:C.type,pricePaid:C.price,purchaseDate:jt(),downloadUrl:C.downloadUrl}),r&&r(),alert("Purchased successfully!")}catch(P){console.error(P),alert("Transaction failed.")}},S=s.filter(C=>(a==="All"||C.type===a)&&C.title.toLowerCase().includes(u.toLowerCase()));return o.jsxs("div",{className:"pb-32",children:[o.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[o.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 md:pb-0 scrollbar-hide",children:["All","Presets","Samples","Beats"].map(C=>o.jsx("button",{onClick:()=>l(C),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-all ${a===C?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:C},C))}),o.jsxs("div",{className:"ml-auto flex gap-2 w-full md:w-auto",children:[o.jsxs("div",{className:"relative flex-1 md:w-64",children:[o.jsx(ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-9 pr-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-dark-card text-sm dark:text-white focus:outline-none",placeholder:"Search...",value:u,onChange:C=>d(C.target.value)})]}),o.jsxs("button",{onClick:()=>v(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-green-700",children:[o.jsx(gb,{size:16})," Upload"]})]})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:S.map(C=>{const P=f.has(C.id);return o.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 overflow-hidden hover:shadow-lg transition flex flex-col group",children:[o.jsxs("div",{className:"aspect-square relative bg-gray-100 dark:bg-gray-800 flex items-center justify-center cursor-pointer",onClick:()=>_(C),children:[C.type==="Presets"?o.jsx(wg,{size:40,className:"text-gray-400"}):o.jsx(aE,{size:40,className:"text-gray-400"}),P&&o.jsxs("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded flex items-center gap-1",children:[o.jsx(kr,{size:8})," OWNED"]})]}),o.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[o.jsx("div",{className:"text-[10px] font-bold text-brand-blue uppercase mb-1",children:C.type}),o.jsx("h4",{className:"font-bold text-sm dark:text-white truncate mb-1",title:C.title,children:C.title}),o.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[o.jsxs("span",{className:"text-xs font-bold text-yellow-600 dark:text-yellow-400 flex items-center gap-1",children:[o.jsx(ps,{size:10,fill:"currentColor"})," ",C.price]}),!P&&o.jsx("button",{onClick:()=>b(C),className:"bg-gray-900 dark:bg-white dark:text-black text-white px-3 py-1 rounded text-[10px] font-bold hover:opacity-80",children:"Buy"})]})]})]},C.id)})}),p&&o.jsx(sde,{user:t,userData:e,onClose:()=>v(!1)}),x&&o.jsx(ide,{item:x,isOwned:f.has(x.id),user:t,onClose:()=>_(null),onBuy:()=>b(x),onDownload:()=>handleDownload(x),onReport:()=>k({id:x.id,type:"market_item",summary:x.title})}),E&&o.jsx(Z6,{user:t,target:E,onClose:()=>k(null)})]})}function sde({user:t,userData:e,onClose:n}){const[r,s]=N.useState({title:"",price:"",type:"Presets",tags:"",description:""}),[i,a]=N.useState(null),[l,u]=N.useState(""),{uploadMedia:d,uploading:f}=ha(),m=async()=>{if(!r.title||!r.price||!i)return alert("Title, Price, and Audio File are required.");try{u("Uploading Audio Asset...");const p=await d(i,Le(t.uid).marketAssets);u("Listing Item..."),await Gt(Ce(Y,Le(t.uid).marketplaceItems),{...r,price:parseInt(r.price),tags:r.tags.split(",").map(v=>v.trim()).filter(v=>v),author:`${e.firstName} ${e.lastName}`,authorId:t.uid,downloadUrl:p,timestamp:jt()}),u("Success!"),setTimeout(n,1e3)}catch(p){console.error(p),u("Error listing item."),alert("Failed to submit item to market. Check console.")}};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[60] p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl p-8 w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl border dark:border-gray-700",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold dark:text-white",children:"Creator Studio"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"List a new sound for sale"})]}),o.jsx("button",{onClick:n,children:o.jsx(ut,{})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Title"}),o.jsx("input",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.title,onChange:p=>s({...r,title:p.target.value}),placeholder:"e.g. Midnight Lofi"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Type"}),o.jsxs("select",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.type,onChange:p=>s({...r,type:p.target.value}),children:[o.jsx("option",{children:"Presets"}),o.jsx("option",{children:"Samples"}),o.jsx("option",{children:"Beats"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Price (TK)"}),o.jsx("input",{type:"number",className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.price,onChange:p=>s({...r,price:p.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Description"}),o.jsx("textarea",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",rows:"3",value:r.description,onChange:p=>s({...r,description:p.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Tags (Comma Separated)"}),o.jsx("input",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.tags,onChange:p=>s({...r,tags:p.target.value}),placeholder:"lofi, hiphop, boom-bap"})]})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"border-2 border-dashed dark:border-gray-600 rounded-xl p-6 text-center hover:bg-gray-50 dark:hover:bg-gray-800 transition relative bg-blue-50/50 dark:bg-blue-900/10 h-full flex flex-col justify-center items-center",children:[o.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",accept:"audio/*",onChange:p=>a(p.target.files[0])}),o.jsx(co,{size:48,className:"mx-auto text-blue-500 mb-2"}),o.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:i?i.name:"Upload Audio File (Product Asset)"}),o.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"MP3/WAV (Max 50MB)"}),i&&o.jsx("div",{className:"mt-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"Selected"})]})})]}),o.jsx("div",{className:"mt-8",children:o.jsx("button",{onClick:m,disabled:f||!r.title||!r.price||!i,className:"w-full bg-brand-blue text-white py-4 rounded-xl font-bold text-lg hover:bg-blue-600 transition flex items-center justify-center gap-2 disabled:opacity-50",children:f?o.jsxs(o.Fragment,{children:[o.jsx(Ye,{className:"animate-spin"})," ",l]}):"List Item for Sale"})})]})})}function ide({item:t,isOwned:e,onClose:n,onBuy:r,onDownload:s,onReport:i}){return o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-[60] p-4",children:o.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-2xl overflow-hidden w-full max-w-4xl shadow-2xl flex flex-col md:flex-row h-[80vh] md:h-[600px]",children:[o.jsxs("div",{className:"md:w-5/12 bg-gray-100 dark:bg-black/40 relative p-8 flex flex-col justify-center items-center text-center",children:[o.jsx("div",{className:"w-64 h-64 bg-gradient-to-br from-brand-blue to-purple-600 rounded-lg shadow-2xl mb-6 flex items-center justify-center text-white",children:t.type==="Presets"?o.jsx(wg,{size:80}):o.jsx(aE,{size:80})}),o.jsx("h2",{className:"text-2xl font-bold dark:text-white mb-2",children:t.title}),o.jsxs("div",{className:"text-brand-blue font-medium mb-6",children:["by ",t.author]}),t.downloadUrl&&o.jsx("div",{className:"w-full",children:o.jsx(W1,{audioUrl:t.downloadUrl,fileName:"Preview Track",previewMode:!e})})]}),o.jsxs("div",{className:"md:w-7/12 p-8 overflow-y-auto flex flex-col",children:[o.jsxs("div",{className:"flex justify-between items-start mb-6",children:[o.jsxs("div",{children:[o.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded uppercase tracking-wide",children:t.type}),o.jsx("h1",{className:"text-3xl font-extrabold dark:text-white mt-2",children:t.title})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:i,className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-400 hover:text-red-500 rounded-full transition",title:"Report Violation",children:o.jsx(wh,{size:20})}),o.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:o.jsx(ut,{size:20})})]})]}),o.jsxs("div",{className:"prose dark:prose-invert text-sm text-gray-600 dark:text-gray-300 mb-8",children:[o.jsx("p",{children:t.description||"No description provided by the creator."}),!e&&o.jsxs("div",{className:"mt-4 bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded text-yellow-800 dark:text-yellow-200 text-xs flex items-center gap-2",children:[o.jsx(Info,{size:14})," Audio preview is truncated to 15 seconds. Purchase to unlock full track."]})]}),o.jsx("div",{className:"mt-auto",children:e?o.jsxs("button",{onClick:s,className:"w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-bold text-lg flex items-center justify-center gap-2 shadow-lg transition-transform hover:scale-[1.02]",children:[o.jsx(Wh,{size:24})," Download Now"]}):o.jsxs("button",{onClick:r,className:"w-full bg-gray-900 dark:bg-white dark:text-black text-white py-4 rounded-xl font-bold text-lg flex items-center justify-center gap-3 shadow-lg transition-transform hover:scale-[1.02]",children:[o.jsx("span",{children:"Buy for"}),o.jsxs("span",{className:"bg-yellow-400 text-black px-2 py-0.5 rounded text-sm flex items-center gap-1",children:[o.jsx(ps,{size:12,fill:"black"})," ",t.price]})]})})]})]})})}function ode({user:t,userData:e,tokenBalance:n}){const[r,s]=N.useState("distribution"),i=[{id:"distribution",label:"Music Distribution"},{id:"gear",label:"Gear Exchange"},{id:"fx",label:"SeshFX Store"}];return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold dark:text-white",children:"Marketplace"}),o.jsx("div",{className:"bg-white dark:bg-gray-800 p-1 rounded-lg border dark:border-gray-700 flex gap-1",children:i.map(a=>o.jsx("button",{onClick:()=>s(a.id),className:`px-4 py-2 text-sm font-bold rounded-md transition-all ${r===a.id?"bg-brand-blue text-white shadow-md":"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:a.label},a.id))})]}),o.jsx(Zn,{mode:"wait",children:o.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[r==="distribution"&&o.jsx(Zue,{user:t,userData:e}),r==="gear"&&o.jsx(ede,{user:t}),r==="fx"&&o.jsx(rde,{user:t,tokenBalance:n})]},r)})]})}function ade(t){const e=N.useRef(!1),n=qi(zr.presence.updatePresence);N.useEffect(()=>{if(!t)return;n({userId:t,online:!0,lastSeen:Date.now()}).then(()=>{e.current=!0}).catch(s=>{console.error("Presence online error:",s)});const r=setInterval(()=>{e.current&&n({userId:t,online:!0,lastSeen:Date.now()}).catch(console.error)},3e4);return()=>{clearInterval(r),e.current&&(n({userId:t,online:!1,lastSeen:Date.now()}).catch(console.error),e.current=!1)}},[t,n])}function vz(t){const e=Zp(zr.presence.getPresence,t&&Ig()?{userId:t}:"skip");return e?{online:e.online===!0,lastSeen:e.lastSeen,loading:!1}:{online:!1,lastSeen:null,loading:!1}}function lde(t){if(!t)return"Never";const e=t,r=Date.now()-e,s=Math.floor(r/6e4),i=Math.floor(s/60),a=Math.floor(i/24);return s<1?"Just now":s<60?`${s}m ago`:i<24?`${i}h ago`:a<7?`${a}d ago`:new Date(e).toLocaleDateString()}function bz({online:t,lastSeen:e,showText:n=!1,size:r="sm"}){const s={xs:"w-1.5 h-1.5",sm:"w-2 h-2",md:"w-2.5 h-2.5"},i={xs:"text-[10px]",sm:"text-xs",md:"text-sm"};return o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsxs("div",{className:"relative",children:[o.jsx(DA,{className:`${s[r]} ${t?"fill-green-500 text-green-500":"fill-gray-400 text-gray-400"}`}),t&&o.jsx("div",{className:"absolute inset-0 animate-ping",children:o.jsx(DA,{className:`${s[r]} fill-green-500 opacity-75`})})]}),n&&o.jsx("span",{className:`${i[r]} ${t?"text-green-500":"text-gray-400"} font-medium`,children:t?"Online":lde(e)})]})}function cde({conversation:t,activeChat:e,currentUserId:n,onSelect:r,onDelete:s}){const i=t.type==="direct"?t.uid||(t.id.includes("_")?t.id.split("_").find(u=>u!==n):null):null,{online:a,lastSeen:l}=vz(i||"");return o.jsxs("div",{onClick:()=>r(t),className:`group relative flex gap-3 p-4 cursor-pointer transition border-b dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-white/5 ${(e==null?void 0:e.id)===t.id?"bg-blue-50 dark:bg-blue-900/10 border-l-4 border-l-brand-blue":""}`,children:[o.jsxs("div",{className:"relative shrink-0",children:[o.jsx(ai,{src:t.photo,name:t.n,size:"lg",isGroup:t.type==="group"}),t.type==="direct"&&i&&o.jsx("div",{className:"absolute -bottom-0.5 -right-0.5",children:o.jsx(bz,{online:a,lastSeen:l,size:"xs"})}),t.uc>0&&o.jsx("div",{className:"absolute -top-1 -right-1 h-5 w-5 bg-brand-blue text-white text-[10px] font-bold flex items-center justify-center rounded-full border-2 border-white dark:border-[#2c2e36]",children:t.uc>99?"99+":t.uc})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[o.jsx("h4",{className:`text-sm truncate ${t.uc>0?"font-extrabold text-gray-900 dark:text-white":"font-bold text-gray-700 dark:text-gray-300"}`,children:t.n}),o.jsx("span",{className:"text-[10px] text-gray-400 shrink-0 ml-2",children:t.lmt?new Date(t.lmt).toLocaleDateString():""})]}),o.jsxs("p",{className:`text-xs truncate ${t.uc>0?"text-gray-800 dark:text-gray-200 font-medium":"text-gray-500"}`,children:[t.ls===n?"You: ":"",t.lm]})]}),o.jsx("button",{onClick:u=>{u.stopPropagation(),s==null||s(t.id)},className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-white dark:bg-gray-800 shadow-md rounded-full text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all z-10",children:o.jsx(Mr,{size:16})})]})}function ude({user:t,conversations:e=[],activeChat:n,onSelectChat:r}){const[s,i]=N.useState(!1),[a,l]=N.useState(!1),[u,d]=N.useState("direct"),[f,m]=N.useState(!1),[p,v]=N.useState(""),[x,_]=N.useState([]),[E,k]=N.useState(""),[b,S]=N.useState([]),C=async z=>{k(z);const D=z.trim();if(D.length>1){const F=D.toLowerCase(),ee=F.charAt(0).toUpperCase()+F.slice(1),ue=mt(Zc(Y,"public_profile"),zt("firstName",">=",ee),zt("firstName","<=",ee+"")),ve=mt(Zc(Y,"public_profile"),zt("lastName",">=",ee),zt("lastName","<=",ee+""));try{const[ae,H]=await Promise.all([Pt(ue),Pt(ve)]),Q=new Map,W=re=>{const he=re.ref.parent.parent.id;he!==t.uid&&Q.set(he,{id:he,...re.data()})};ae.forEach(W),H.forEach(W),S(Array.from(Q.values()))}catch(ae){console.error("Search error:",ae),S([])}}else S([])},P=z=>{if(u==="direct"){const D=[t.uid,z.id].sort().join("_");r({id:D,uid:z.id,name:`${z.firstName} ${z.lastName}`,type:"direct"}),R()}else u==="add_member"&&(x.find(D=>D.id===z.id)||_(D=>[...D,z]),R())},R=()=>{i(!1),k(""),S([])},I=()=>{v(""),_([]),l(!0)},j=()=>{d("add_member"),i(!0)},O=async()=>{if(!p||x.length===0)return alert("Name and members required.");if(!Br){alert("Chat functionality is not available. Realtime Database is not configured.");return}m(!0);try{const D=Fte(Za(Br,"chats")).key,F=ine(),ee=[t.uid,...x.map(ae=>ae.id)],ue={meta:{name:p,createdBy:t.uid,createdAt:F},members:{}};ee.forEach(ae=>ue.members[ae]=!0),await gV(Za(Br,`chats/${D}`),ue);const ve={};ee.forEach(ae=>{ve[`conversations/${ae}/${D}`]={uid:D,n:p,type:"group",lmt:F,lm:"Group created",ls:t.uid,uc:ae===t.uid?0:1}}),await wx(Za(Br),ve),l(!1),r({id:D,name:p,type:"group"})}catch(z){console.error("Group creation failed",z),alert("Group creation failed: "+z.message)}finally{m(!1)}},V=async(z,D)=>{if(window.confirm("Delete this conversation?")){if(!Br){alert("Chat functionality is not available. Realtime Database is not configured.");return}try{await zte(Za(Br,`conversations/${t.uid}/${D}`)),(n==null?void 0:n.id)===D&&r(null)}catch(F){console.error(F)}}};return o.jsxs("div",{className:"flex flex-col h-full relative overflow-hidden bg-white dark:bg-[#1f2128]",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] shrink-0",children:[o.jsx("h2",{className:"font-extrabold text-lg dark:text-white tracking-tight",children:"Messages"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:I,className:"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition",title:"New Group",children:o.jsx(Gr,{size:18})}),o.jsx("button",{onClick:()=>{d("direct"),i(!0)},className:"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition",title:"New Chat",children:o.jsx(ms,{size:18})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:e.map(z=>o.jsx(cde,{conversation:z,activeChat:n,currentUserId:t.uid,onSelect:r,onDelete:D=>{window.confirm("Delete this conversation?")&&V({},D)}},z.id))}),a&&o.jsxs("div",{className:"absolute inset-0 bg-white dark:bg-[#1f2128] z-20 flex flex-col animate-in slide-in-from-right-10 duration-200",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center gap-3 bg-gray-50 dark:bg-[#23262f]",children:[o.jsx("button",{onClick:()=>l(!1),className:"hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded-full",children:o.jsx(fb,{size:20})}),o.jsx("h3",{className:"font-bold dark:text-white",children:"New Group"})]}),o.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"1. Group Name"}),o.jsx("input",{className:"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none",placeholder:"Enter group name...",value:p,onChange:z=>v(z.target.value),autoFocus:!0})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase",children:["2. Members (",x.length,")"]}),o.jsxs("button",{onClick:j,className:"text-xs font-bold text-brand-blue flex items-center gap-1 hover:underline",children:[o.jsx(ms,{size:14})," Add Member"]})]}),o.jsx("div",{className:"space-y-2",children:x.length===0?o.jsx("div",{className:"text-center py-8 border-2 border-dashed dark:border-gray-700 rounded-xl text-gray-400 text-sm",children:"No members selected"}):x.map(z=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-white/5 rounded-lg border dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ai,{src:z.photoURL,name:z.firstName,size:"sm"}),o.jsxs("span",{className:"text-sm font-bold dark:text-white",children:[z.firstName," ",z.lastName]})]}),o.jsx("button",{onClick:()=>_(D=>D.filter(F=>F.id!==z.id)),className:"text-gray-400 hover:text-red-500",children:o.jsx(ut,{size:16})})]},z.id))})]})]}),o.jsx("div",{className:"p-4 border-t dark:border-gray-700",children:o.jsx("button",{onClick:O,disabled:!p||x.length===0||f,className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition shadow-lg flex justify-center items-center gap-2",children:f?o.jsx(Ye,{className:"animate-spin",size:20}):o.jsxs(o.Fragment,{children:["Create Group ",o.jsx(lo,{size:18})]})})})]}),s&&o.jsxs("div",{className:"absolute inset-0 bg-white dark:bg-[#1f2128] z-30 flex flex-col animate-in fade-in duration-200",children:[o.jsxs("div",{className:"p-3 border-b dark:border-gray-700 flex items-center gap-2 bg-white dark:bg-[#1f2128]",children:[o.jsx(ur,{size:18,className:"text-gray-400 ml-2"}),o.jsx("input",{autoFocus:!0,className:"flex-1 p-2 bg-transparent outline-none dark:text-white placeholder-gray-400",placeholder:"Search...",value:E,onChange:z=>C(z.target.value)}),o.jsx("button",{onClick:R,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:o.jsx(ut,{size:20,className:"text-gray-500"})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[b.length===0&&E.length>1&&o.jsx("div",{className:"text-center py-10 text-gray-400 text-sm",children:"No users found."}),b.map(z=>{const D=u==="add_member"&&x.find(F=>F.id===z.id);return o.jsxs("div",{onClick:()=>P(z),className:`flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl cursor-pointer transition mb-1 ${D?"opacity-50 pointer-events-none":""}`,children:[o.jsx(ai,{src:z.photoURL,name:z.firstName,size:"md"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"text-sm font-bold dark:text-white",children:[z.firstName," ",z.lastName]}),o.jsx("div",{className:"text-xs text-gray-500",children:z.role||"User"})]}),u==="add_member"&&o.jsx(ms,{size:18,className:"text-brand-blue"})]},z.id)})]})]})]})}const jx={Recent:["","","","","","","",""],Smileys:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Gestures:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Hearts:["","","","","","","","","","","","","","","","","","","",""],Objects:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Flags:["","","","","","","","","","","","","","","","","","","",""],Music:["","","","","","","","","","","","","","","","","","","",""],Reactions:["","","","","","","","","","","","","","","","","","","",""]},dde=Object.values(jx).flat();function hde({onSelect:t,onClose:e,position:n="bottom"}){const[r,s]=N.useState("Recent"),[i,a]=N.useState(""),[l,u]=N.useState(()=>{const p=localStorage.getItem("recentEmojis");return p?JSON.parse(p):jx.Recent}),d=N.useMemo(()=>i.trim()?dde.filter(p=>p.includes(i)||i.includes(p)):r==="Recent"?l:jx[r]||[],[i,r,l]),f=p=>{const v=[p,...l.filter(x=>x!==p)].slice(0,8);u(v),localStorage.setItem("recentEmojis",JSON.stringify(v)),t(p),e&&e()},m=Object.keys(jx);return o.jsxs(tt.div,{initial:{opacity:0,scale:.95,y:n==="bottom"?-10:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:`
                absolute ${n==="bottom"?"bottom-full mb-2":"top-full mt-2"} 
                left-0
                w-[340px] bg-white dark:bg-gray-800 
                rounded-2xl shadow-2xl border dark:border-gray-700
                z-50 overflow-hidden
            `,children:[o.jsxs("div",{className:"p-3 border-b dark:border-gray-700",children:[o.jsxs("div",{className:"relative mb-3",children:[o.jsx(ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search emojis...",value:i,onChange:p=>a(p.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white"}),i&&o.jsx("button",{onClick:()=>a(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o.jsx(ut,{size:16})})]}),o.jsx("div",{className:"flex gap-1 overflow-x-auto scrollbar-hide",children:m.map(p=>o.jsxs("button",{onClick:()=>s(p),className:`
                                px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition
                                ${r===p?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}
                            `,children:[p==="Recent"?o.jsx(Zr,{size:12,className:"inline mr-1"}):null,p]},p))})]}),o.jsx("div",{className:"h-[280px] overflow-y-auto custom-scrollbar p-3",children:d.length===0?o.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:o.jsx("p",{className:"text-sm",children:"No emojis found"})}):o.jsx("div",{className:"grid grid-cols-8 gap-1",children:d.map((p,v)=>o.jsx(tt.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>f(p),className:"w-10 h-10 flex items-center justify-center text-xl rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:p},`${p}-${v}`))})})]})}const $P="lfDGNSxY36zoFTAiGMVIOxjovvzFoBRp",UP="https://api.giphy.com/v1/gifs";function fde({onSelect:t,onClose:e,position:n="bottom"}){const[r,s]=N.useState(""),[i,a]=N.useState([]),[l,u]=N.useState([]),[d,f]=N.useState(!1),[m,p]=N.useState("trending"),v=N.useRef(null);N.useEffect(()=>{x()},[]),N.useEffect(()=>(r.trim()?(p("search"),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{_(r)},500)):(p("trending"),a([])),()=>{v.current&&clearTimeout(v.current)}),[r]);const x=async()=>{f(!0);try{const S=await(await fetch(`${UP}/trending?api_key=${$P}&limit=24&rating=g`)).json();S.data&&u(S.data)}catch(b){console.error("Giphy trending error:",b)}f(!1)},_=async b=>{if(b.trim()){f(!0);try{const C=await(await fetch(`${UP}/search?api_key=${$P}&q=${encodeURIComponent(b)}&limit=24&rating=g`)).json();C.data&&a(C.data)}catch(S){console.error("Giphy search error:",S)}f(!1)}},E=b=>{t==null||t({url:b.images.fixed_height.url||b.images.original.url,previewUrl:b.images.preview_gif.url||b.images.fixed_height_small.url,width:b.images.fixed_height.width,height:b.images.fixed_height.height,title:b.title||"GIF"}),e&&e()},k=m==="trending"?l:i;return o.jsxs(tt.div,{initial:{opacity:0,scale:.95,y:n==="bottom"?-10:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:`
                absolute ${n==="bottom"?"bottom-full mb-2":"top-full mt-2"} 
                left-0
                w-[380px] bg-white dark:bg-gray-800 
                rounded-2xl shadow-2xl border dark:border-gray-700
                z-50 overflow-hidden
            `,children:[o.jsx("div",{className:"p-3 border-b dark:border-gray-700",children:o.jsxs("div",{className:"relative",children:[o.jsx(ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search GIFs...",value:r,onChange:b=>s(b.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white"}),r&&o.jsx("button",{onClick:()=>s(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o.jsx(ut,{size:16})})]})}),o.jsx("div",{className:"h-[320px] overflow-y-auto custom-scrollbar p-3",children:d?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[o.jsx(Ye,{className:"animate-spin text-brand-blue mb-2",size:24}),o.jsx("p",{className:"text-sm text-gray-500",children:"Loading GIFs..."})]}):k.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[o.jsx(DV,{size:32,className:"mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:m==="search"?"No GIFs found. Try a different search.":"Loading trending GIFs..."})]}):o.jsx("div",{className:"grid grid-cols-2 gap-2",children:k.map(b=>o.jsxs(tt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>E(b),className:"relative aspect-square rounded-lg overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-700 group",children:[o.jsx("img",{src:b.images.fixed_height_small.url||b.images.preview_gif.url,alt:b.title,className:"w-full h-full object-cover",loading:"lazy"}),o.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition"})]},b.id))})}),o.jsx("div",{className:"p-2 border-t dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-center",children:o.jsxs("p",{className:"text-[10px] text-gray-400",children:["Powered by ",o.jsx("span",{className:"font-bold",children:"GIPHY"})]})})]})}function mde({onRecorded:t,onClose:e,maxDuration:n=60}){const[r,s]=N.useState(!1),[i,a]=N.useState(null),[l,u]=N.useState(0),[d,f]=N.useState(null),[m,p]=N.useState(null),v=N.useRef(null),x=N.useRef(null),_=N.useRef(null),E=N.useRef([]),k=N.useRef(null);N.useEffect(()=>(b(),()=>{S()}),[]);const b=async()=>{try{const O=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!0});x.current=O,v.current&&(v.current.srcObject=O),f(!0),p(null)}catch(O){console.error("Permission error:",O),f(!1),p("Camera/microphone access denied")}},S=()=>{x.current&&(x.current.getTracks().forEach(O=>O.stop()),x.current=null),k.current&&clearInterval(k.current)},C=async()=>{if(!x.current){await b();return}try{E.current=[];const O={mimeType:"video/webm;codecs=vp9,opus",videoBitsPerSecond:25e5};_.current=new MediaRecorder(x.current,O),_.current.ondataavailable=V=>{V.data.size>0&&E.current.push(V.data)},_.current.onstop=()=>{const V=new Blob(E.current,{type:"video/webm"});a(V),s(!1),u(0),k.current&&clearInterval(k.current)},_.current.start(),s(!0),u(0),k.current=setInterval(()=>{u(V=>{const z=V+1;return z>=n&&P(),z})},1e3)}catch(O){console.error("Recording error:",O),p("Failed to start recording")}},P=()=>{_.current&&r&&_.current.stop()},R=()=>{a(null),u(0),s(!1)},I=()=>{if(i){const O=new File([i],`video_${Date.now()}.webm`,{type:"video/webm"});t==null||t(O),S(),e==null||e()}},j=O=>{const V=Math.floor(O/60),z=O%60;return`${V}:${z.toString().padStart(2,"0")}`};return!d&&d!==null?o.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:o.jsx(tt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-[#2c2e36] rounded-2xl p-6 max-w-sm",children:o.jsxs("div",{className:"text-center",children:[o.jsx(dne,{size:48,className:"text-red-500 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-bold dark:text-white mb-2",children:"Camera Access Required"}),o.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please allow camera and microphone access to record video messages."}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200 transition",children:"Cancel"}),o.jsx("button",{onClick:b,className:"flex-1 px-4 py-2 bg-brand-blue text-white rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Allow Access"})]})]})})}):o.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-[80]",children:o.jsxs(tt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"relative w-full max-w-2xl aspect-video bg-black rounded-2xl overflow-hidden",children:[o.jsx("video",{ref:v,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),r&&o.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 flex items-center gap-2 bg-red-500 text-white px-4 py-2 rounded-full",children:[o.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),o.jsx("span",{className:"text-sm font-bold",children:j(l)})]}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent",children:o.jsx("div",{className:"flex items-center justify-center gap-4",children:i?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:R,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:o.jsx(ut,{size:24})}),o.jsx("button",{onClick:I,className:"p-4 bg-green-500 hover:bg-green-600 rounded-full text-white transition shadow-lg",children:o.jsx(Cs,{size:28})}),o.jsx("div",{className:"w-12"})," "]}):o.jsx(o.Fragment,{children:r?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:R,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:o.jsx(ut,{size:24})}),o.jsx("button",{onClick:P,className:"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg animate-pulse",children:o.jsx(MV,{size:28})}),o.jsx("div",{className:"w-12"})," "]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:e,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:o.jsx(ut,{size:24})}),o.jsx("button",{onClick:C,className:"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg",children:o.jsx(ku,{size:28})}),o.jsx("div",{className:"w-12"})," "]})})})}),m&&o.jsx("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-4 py-2 rounded-lg text-sm",children:m})]})})}function pde({activeChatId:t,uid:e,onSend:n,replyingTo:r,editingMessage:s,onCancelReply:i,typingUsers:a=[]}){const[l,u]=N.useState(""),[d,f]=N.useState(null),[m,p]=N.useState(!1),[v,x]=N.useState(!1),[_,E]=N.useState(!1),[k,b]=N.useState(!1),[S,C]=N.useState(!1),P=N.useRef(null),R=N.useRef(null),I=N.useRef(null),j=N.useRef(null),O=N.useRef([]),V=N.useRef(null),z=N.useRef(null),{uploadMedia:D,uploading:F}=ha();N.useEffect(()=>{var G;s&&(u(s.b||""),(G=I.current)==null||G.focus())},[s]),N.useEffect(()=>{var G;r&&((G=I.current)==null||G.focus())},[r]),N.useEffect(()=>{const G=le=>{V.current&&!V.current.contains(le.target)&&E(!1),z.current&&!z.current.contains(le.target)&&b(!1)};return document.addEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[]);const ee=async G=>{try{const De=await(await fetch(G.url)).blob(),Qe=new File([De],`gif_${Date.now()}.gif`,{type:"image/gif"}),ie=await D(Qe,`chat_media/${t}`);if(ie){const Ae={url:ie.url,type:"image",name:G.title||"GIF",gif:!0};n("",Ae)}}catch(le){console.error("GIF upload error:",le),alert("Failed to send GIF")}b(!1)},ue=async G=>{try{const le=await D(G,`chat_media/${t}`);if(le){const De={url:le.url,type:"video",name:G.name};n("",De)}}catch(le){console.error("Video upload error:",le),alert("Failed to send video")}C(!1)},ve=G=>{u(G.target.value),t&&e&&Br&&(wx(Za(Br,`chats/${t}/typing`),{[e]:!0}),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{Br&&wx(Za(Br,`chats/${t}/typing`),{[e]:!1})},2e3))},ae=G=>{const le=I.current;if(le){const De=le.selectionStart,Qe=le.selectionEnd,ie=l.substring(0,De)+G+l.substring(Qe);u(ie),setTimeout(()=>{le.selectionStart=le.selectionEnd=De+G.length,le.focus()},0)}else u(De=>De+G)},H=async()=>{try{const G=await navigator.mediaDevices.getUserMedia({audio:!0});j.current=new MediaRecorder(G),O.current=[],j.current.ondataavailable=le=>O.current.push(le.data),j.current.onstop=()=>{const le=new Blob(O.current,{type:"audio/mp3"}),De=new File([le],`voice_note_${Date.now()}.mp3`,{type:"audio/mp3"});f({file:De,type:"audio",previewUrl:URL.createObjectURL(le)}),G.getTracks().forEach(Qe=>Qe.stop())},j.current.start(),p(!0)}catch{alert("Microphone access denied.")}},Q=()=>{j.current&&j.current.stop(),p(!1)},W=G=>{G.preventDefault(),G.stopPropagation(),G.type==="dragenter"||G.type==="dragover"?x(!0):x(!1)},re=G=>{G.preventDefault(),G.stopPropagation(),x(!1),G.dataTransfer.files&&G.dataTransfer.files[0]&&he(G.dataTransfer.files[0])},he=G=>{const le=G.type.startsWith("image/")?"image":G.type.startsWith("video/")?"video":G.type.startsWith("audio/")?"audio":"file";f({file:G,type:le,previewUrl:URL.createObjectURL(G)})},ye=async G=>{if(G.preventDefault(),!l.trim()&&!d||F)return;let le=null;if(d){const De=await D(d.file,`chat_media/${t}`);De&&(le={url:De.url,type:De.type,name:De.name})}n(l,le),u(""),f(null),t&&e&&Br&&wx(Za(Br,`chats/${t}/typing`),{[e]:!1})},Me=()=>{s&&u(""),i==null||i()},Fe=()=>{var G,le;return s?((G=s.b)==null?void 0:G.substring(0,50))||"Message":r?((le=r.b)==null?void 0:le.substring(0,50))||"Media":""};return o.jsxs("div",{className:`p-3 bg-white dark:bg-[#2c2e36] border-t dark:border-gray-700 shrink-0 transition-colors ${v?"bg-blue-50 dark:bg-blue-900/20 border-blue-400":""}`,onDragEnter:W,onDragLeave:W,onDragOver:W,onDrop:re,children:[o.jsx(Zn,{children:a.length>0&&o.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mb-2 px-2 flex items-center gap-2",children:[o.jsxs("div",{className:"flex gap-1",children:[o.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"}),o.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),o.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),o.jsxs("span",{className:"text-xs text-gray-400 italic",children:[a.length>1?"Multiple people are":"Someone is"," typing..."]})]})}),o.jsx(Zn,{children:(r||s)&&o.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-between items-center bg-gray-100 dark:bg-gray-800 p-2.5 px-4 rounded-xl border-l-4 border-brand-blue mb-2",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s?o.jsx(RV,{size:16,className:"text-brand-blue shrink-0"}):o.jsx(wV,{size:16,className:"text-brand-blue shrink-0"}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("span",{className:"text-xs font-bold text-brand-blue block",children:s?"Editing Message":`Replying to ${(r==null?void 0:r.n)||"User"}`}),o.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate block",children:Fe()})]})]}),o.jsx("button",{onClick:Me,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:o.jsx(ut,{size:16,className:"text-gray-400 hover:text-red-500"})})]})}),o.jsx(Zn,{children:d&&o.jsxs(tt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800 rounded-xl mb-2 border dark:border-gray-700",children:[d.type==="image"?o.jsx("img",{src:d.previewUrl,className:"h-14 w-14 object-cover rounded-lg"}):d.type==="video"?o.jsx("video",{src:d.previewUrl,className:"h-14 w-14 object-cover rounded-lg"}):o.jsx("div",{className:"h-14 w-14 bg-purple-100 dark:bg-purple-900/30 text-purple-600 flex items-center justify-center rounded-lg",children:o.jsx(xne,{size:24})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-bold dark:text-white truncate",children:d.file.name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[(d.file.size/1024).toFixed(1)," KB"]})]}),o.jsx("button",{onClick:()=>f(null),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:o.jsx(ut,{size:18,className:"text-gray-400 hover:text-red-500"})})]})}),o.jsxs("form",{onSubmit:ye,className:"flex items-end gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"file",ref:R,className:"hidden",accept:"image/*,audio/*,video/*,.pdf,.doc,.docx,.txt,.zip",onChange:G=>he(G.target.files[0])}),o.jsx("button",{type:"button",onClick:()=>{var G;return(G=R.current)==null?void 0:G.click()},className:"p-2.5 text-gray-500 hover:text-brand-blue hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition shrink-0",title:"Attach file",children:o.jsx(IV,{size:20})})]}),o.jsxs("div",{className:"flex items-center gap-1 border-r dark:border-gray-700 pr-2",children:[o.jsx("button",{type:"button",onClick:()=>{C(!0),E(!1),b(!1)},className:"p-2 text-gray-500 hover:text-red-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition",title:"Record video",children:o.jsx(ku,{size:18})}),o.jsxs("button",{type:"button",onClick:()=>{b(!k),E(!1)},className:"p-2 text-gray-500 hover:text-purple-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition relative",title:"GIF",ref:z,children:[o.jsx(wne,{size:18}),k&&o.jsx(fde,{onSelect:ee,onClose:()=>b(!1),position:"bottom"})]})]}),o.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-[#1f2128] rounded-2xl border dark:border-gray-700 focus-within:ring-2 focus-within:ring-brand-blue transition-all flex items-end relative",children:[o.jsx("textarea",{ref:I,className:"w-full bg-transparent p-3 max-h-32 min-h-[44px] text-sm resize-none outline-none dark:text-white custom-scrollbar pr-20",placeholder:s?"Update message...":v?"Drop files here...":"Type a message...",value:l,onChange:ve,onKeyDown:G=>{G.key==="Enter"&&!G.shiftKey&&(G.preventDefault(),ye(G))},rows:1}),o.jsxs("div",{className:"absolute right-2 bottom-1.5 flex items-center gap-1",children:[o.jsxs("div",{className:"relative",ref:V,children:[o.jsx("button",{type:"button",onClick:()=>{E(!_),b(!1)},className:`p-1.5 rounded-full transition ${_?"bg-brand-blue/20 text-brand-blue":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"}`,title:"Emoji",children:o.jsx(LV,{size:18})}),o.jsx(Zn,{children:_&&o.jsx(hde,{onSelect:ae,onClose:()=>E(!1),position:"bottom"})})]}),o.jsx("button",{type:"button",onClick:m?Q:H,className:`p-1.5 rounded-full transition ${m?"bg-red-500 text-white animate-pulse":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"}`,children:m?o.jsx(MV,{size:18}):o.jsx(Cne,{size:18})})]})]}),o.jsx("button",{type:"submit",disabled:!l.trim()&&!d||F,className:`p-2.5 text-white rounded-full shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all shrink-0 ${s?"bg-green-600 hover:bg-green-700":"bg-brand-blue hover:bg-blue-600"}`,children:F?o.jsx(Ye,{size:20,className:"animate-spin"}):s?o.jsx(kr,{size:20}):o.jsx(pb,{size:20})})]}),S&&o.jsx(mde,{onRecorded:ue,onClose:()=>C(!1),maxDuration:60})]})}function gde(...t){return Cg(au(t))}const Ix=Ve.forwardRef(({className:t,variant:e="default",size:n="default",...r},s)=>{const i={default:"bg-blue-600 text-white hover:bg-blue-700 shadow-sm",destructive:"bg-red-500 text-white hover:bg-red-600 shadow-sm",outline:"border border-gray-200 bg-transparent hover:bg-gray-100 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 hover:text-gray-900 text-gray-600",link:"text-blue-600 underline-offset-4 hover:underline"},a={default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"};return o.jsx("button",{ref:s,className:gde("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50",i[e],a[n],t),...r})});Ix.displayName="Button";function yde({url:t,isOpen:e,onClose:n,previewData:r}){if(!e||!t)return null;const s=new URL(t).pathname;let i="Content";s.startsWith("/profile/")?i="User Profile":s.startsWith("/session/")?i="Session Details":s.startsWith("/studio/")&&(i="Studio Listing");const a=(r==null?void 0:r.title)||`${i} Preview`;return o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black bg-opacity-70 backdrop-blur-sm",onClick:n,children:o.jsxs("div",{className:"bg-gray-900 rounded-xl shadow-2xl w-full max-w-2xl h-3/4 max-h-[800px] flex flex-col transform transition-all duration-300 scale-100 opacity-100",onClick:l=>l.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800 rounded-t-xl sticky top-0",children:[o.jsx("h3",{className:"text-xl font-bold text-white truncate max-w-[80%]",children:a}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:o.jsx(Ix,{variant:"ghost",size:"icon",className:"text-blue-400 hover:text-blue-300",children:o.jsx(NV,{className:"w-5 h-5"})})}),o.jsx(Ix,{onClick:n,variant:"ghost",size:"icon",className:"text-white hover:bg-gray-700",children:o.jsx(ut,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"flex-1 p-4 overflow-y-auto custom-scrollbar text-gray-400 flex flex-col items-center justify-center text-center",children:[o.jsx("p",{className:"mb-4 text-lg font-medium text-white",children:"Embedded Content Simulation"}),o.jsx("p",{className:"mb-2",children:"This is where the actual SeshNx content (e.g., profile card, session details) would be rendered, based on the URL:"}),o.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline break-all p-2 bg-gray-700 rounded-lg text-sm",children:t}),o.jsx("p",{className:"mt-4 text-sm",children:'In a real implementation, you would use a dedicated component (e.g., `ProfileCard id="..."`) here instead of an iframe to display the content securely and natively.'})]}),o.jsx("div",{className:"p-3 border-t border-gray-700 bg-gray-800 rounded-b-xl flex justify-end",children:o.jsx(Ix,{onClick:n,variant:"secondary",children:"Done"})})]})})}function xde({status:t="sent",size:e=12,className:n=""}){const r={sending:{icon:Zr,color:"text-gray-400",animate:!0},sent:{icon:Cs,color:"text-gray-400",animate:!1},delivered:{icon:v1,color:"text-gray-400",animate:!1},read:{icon:v1,color:"text-brand-blue",animate:!1}},s=r[t]||r.sent,i=s.icon;return o.jsx(tt.div,{animate:s.animate?{rotate:[0,360]}:{},transition:s.animate?{duration:2,repeat:1/0,ease:"linear"}:{},className:`inline-flex items-center ${s.color} ${n}`,children:o.jsx(i,{size:e,className:t==="read"?"fill-current":""})})}function vde({audioUrl:t,color:e="brand-blue",height:n=40}){const r=N.useRef(null),s=N.useRef(null),i=N.useRef(null),a=N.useRef(null),l=N.useRef(null),[u,d]=N.useState(!1);N.useEffect(()=>{if(!t||!r.current)return;const p=r.current,v=p.getContext("2d"),x=new Audio(t);s.current=x,p.width=p.offsetWidth,p.height=n;const _=new(window.AudioContext||window.webkitAudioContext),E=_.createAnalyser(),k=_.createMediaElementSource(x);E.fftSize=256,k.connect(E),E.connect(_.destination),a.current=_,l.current=E;const b=E.frequencyBinCount,S=new Uint8Array(b),C=()=>{if(x.paused){f(v,p.width,p.height);return}i.current=requestAnimationFrame(C),E.getByteFrequencyData(S),v.clearRect(0,0,p.width,p.height);const P=p.width/b*2;let R=0;for(let I=0;I<b;I++){const j=S[I]/255*p.height,O=v.createLinearGradient(0,0,0,p.height);O.addColorStop(0,"#3b82f6"),O.addColorStop(1,"#8b5cf6"),v.fillStyle=O,v.fillRect(R,p.height-j,P-1,j),R+=P}};return x.addEventListener("play",()=>{d(!0),C()}),x.addEventListener("pause",()=>{d(!1),i.current&&cancelAnimationFrame(i.current),f(v,p.width,p.height)}),x.addEventListener("ended",()=>{d(!1),i.current&&cancelAnimationFrame(i.current),f(v,p.width,p.height)}),f(v,p.width,p.height),()=>{var P;i.current&&cancelAnimationFrame(i.current),x.pause(),(P=a.current)==null||P.close()}},[t,n,u]);const f=(p,v,x)=>{p.clearRect(0,0,v,x),p.fillStyle="#3b82f6";const _=50,E=v/_,k=2;for(let b=0;b<_;b++){const S=Math.random()*x*.3+x*.1,C=b*E;p.fillRect(C,x-S,E-k,S)}},m=()=>{s.current&&(u?s.current.pause():s.current.play())};return o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:m,className:"w-10 h-10 flex items-center justify-center bg-brand-blue text-white rounded-full hover:bg-blue-600 transition shrink-0",children:u?o.jsx(AV,{size:16}):o.jsx(hE,{size:16,className:"ml-0.5"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("canvas",{ref:r,className:"w-full rounded",style:{height:`${n}px`}}),o.jsx("audio",{ref:s,src:t})]})]})}const bde=["","","","","",""];function _de({message:t,isCurrentUser:e,previousMessage:n,currentUserId:r,chatId:s,linkPreviewData:i,messageStatus:a="sent",onReaction:l,onReply:u,onEdit:d,onDelete:f,onForward:m,onSeshNxLinkClick:p,onUserClick:v}){var he;const[x,_]=N.useState(!1),[E,k]=N.useState(!1),[b,S]=N.useState(!1),C=N.useRef(null),P=N.useRef(null),R=!n||n.s!==t.s,I=n&&new Date(t.t).toDateString()===new Date(n.t).toDateString(),j=t.t||Date.now(),O=(n==null?void 0:n.t)||0,V=n&&j-O>3e5,z=!I||!n,D=R||V,F=!e&&R,ee=new Date(t.t||Date.now());N.useEffect(()=>{const ye=Me=>{C.current&&!C.current.contains(Me.target)&&(_(!1),k(!1))};return document.addEventListener("mousedown",ye),()=>document.removeEventListener("mousedown",ye)},[]);const ue=()=>{navigator.clipboard.writeText(t.b||""),S(!0),setTimeout(()=>S(!1),2e3),_(!1)},ve=ye=>{l==null||l(t.id,ye),k(!1),_(!1)},ae=t.reactions?Object.entries(t.reactions).reduce((ye,[Me,Fe])=>{const G=typeof Fe=="object"?Object.keys(Fe).length:0;return G>0&&(ye[Me]=G),ye},{}):{},H=Object.keys(ae).length>0,Q=t.reactions?(he=Object.entries(t.reactions).find(([ye,Me])=>typeof Me=="object"&&Me[r]))==null?void 0:he[0]:null,W=e?"bg-brand-blue text-white rounded-br-sm":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white rounded-bl-sm";if(t.deleted||t.deletedForAll)return o.jsx("div",{className:`flex ${e?"justify-end":"justify-start"} ${R?"mt-3":"mt-0.5"}`,children:o.jsx("div",{className:"px-4 py-2 rounded-2xl bg-gray-100 dark:bg-gray-800 text-gray-400 italic text-sm",children:" This message was deleted"})});if(t.deletedFor&&t.deletedFor[r])return null;const re=()=>{var Me;if(!i)return null;const ye=(Me=i.url)==null?void 0:Me.includes("seshnx.net");return o.jsx("div",{className:"mt-2 block border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden bg-white dark:bg-gray-800 max-w-[280px]",children:ye?o.jsxs("button",{onClick:()=>p==null?void 0:p(i),className:"w-full text-left",children:[i.image&&o.jsx("div",{className:"h-28 w-full bg-cover bg-center",style:{backgroundImage:`url(${i.image})`}}),o.jsxs("div",{className:"p-2",children:[o.jsxs("p",{className:"font-semibold text-xs text-brand-blue truncate flex items-center",children:[o.jsx(cE,{className:"w-3 h-3 mr-1"}),i.title||"SeshNx Link"]}),i.description&&o.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 line-clamp-2",children:i.description})]})]}):o.jsxs("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",children:[i.image&&o.jsx("div",{className:"h-28 w-full bg-cover bg-center",style:{backgroundImage:`url(${i.image})`}}),o.jsxs("div",{className:"p-2",children:[o.jsx("p",{className:"font-semibold text-xs text-brand-blue truncate",children:i.title||i.url}),i.description&&o.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 line-clamp-2",children:i.description}),o.jsxs("p",{className:"text-[10px] text-gray-400 mt-1 flex items-center",children:[o.jsx(_g,{className:"w-2.5 h-2.5 mr-1"}),new URL(i.url).hostname]})]})]})})};return o.jsxs(o.Fragment,{children:[z&&o.jsx("div",{className:"text-center my-4",children:o.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-bold uppercase tracking-wider bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full",children:ee.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})}),o.jsxs("div",{className:`group flex items-end gap-2 ${e?"flex-row-reverse":"flex-row"} ${R?"mt-3":"mt-0.5"}`,ref:P,children:[!e&&o.jsx("div",{className:"w-8 shrink-0",children:F&&o.jsx(ai,{src:t.photo,name:t.n,size:"xs",className:"cursor-pointer",onClick:()=>v==null?void 0:v(t.s)})}),o.jsxs("div",{className:`relative max-w-[75%] ${e?"items-end":"items-start"}`,children:[!e&&R&&t.n&&o.jsx("p",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 mb-1 ml-1",children:t.n}),t.replyTo&&o.jsxs("div",{className:`mb-1 px-3 py-1.5 rounded-lg text-xs border-l-2 border-brand-blue ${e?"bg-blue-400/30 text-blue-100":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}`,children:[o.jsx("p",{className:"font-bold text-[10px] mb-0.5",children:t.replyTo.sender}),o.jsx("p",{className:"truncate opacity-80",children:t.replyTo.text})]}),o.jsxs("div",{className:`relative px-3 py-2 rounded-2xl shadow-sm ${W} cursor-pointer transition-all hover:shadow-md`,onClick:()=>_(!x),children:[t.media&&o.jsxs("div",{className:"mb-2",children:[t.media.type==="image"&&o.jsxs("div",{className:"relative rounded-lg overflow-hidden",children:[t.media.gif&&o.jsx("span",{className:"absolute top-2 left-2 bg-black/60 text-white text-xs px-2 py-0.5 rounded-full font-bold",children:"GIF"}),o.jsx("img",{src:t.media.url,alt:"Shared",className:"max-w-full h-auto rounded-lg max-h-60 object-cover"})]}),t.media.type==="video"&&o.jsx("video",{controls:!0,src:t.media.url,className:"max-w-full h-auto rounded-lg max-h-60"}),t.media.type==="audio"&&o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 max-w-[280px]",children:o.jsx(vde,{audioUrl:t.media.url,height:50})}),t.media.type==="file"&&o.jsxs("a",{href:t.media.url,target:"_blank",rel:"noopener noreferrer",download:t.media.name,className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition group",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center shrink-0",children:o.jsx(Nl,{size:20,className:"text-blue-600 dark:text-blue-400"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-semibold dark:text-white truncate",children:t.media.name||"File"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Click to download"})]}),o.jsx(Wh,{size:18,className:"text-gray-400 group-hover:text-brand-blue transition shrink-0"})]})]}),t.b&&o.jsx("p",{className:"text-sm break-words whitespace-pre-wrap leading-relaxed",children:t.b}),t.b&&re(),t.edited&&o.jsx("span",{className:`text-[9px] ${e?"text-blue-200":"text-gray-400"} ml-1`,children:"(edited)"})]}),H&&o.jsx("div",{className:`flex flex-wrap gap-1 mt-1 ${e?"justify-end":"justify-start"}`,children:Object.entries(ae).map(([ye,Me])=>o.jsxs(tt.button,{initial:{scale:0},animate:{scale:1},onClick:()=>ve(ye),className:`flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-xs border transition-all ${Q===ye?"bg-brand-blue/20 border-brand-blue text-brand-blue":"bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:[o.jsx("span",{children:ye}),o.jsx("span",{className:"text-[10px] font-bold",children:Me})]},ye))}),D&&o.jsxs("div",{className:`flex items-center gap-1 mt-1 ${e?"justify-end":"justify-start"}`,children:[o.jsx("span",{className:"text-[10px] text-gray-400",children:ee.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}),e&&o.jsx(xde,{status:a,size:10,className:"ml-0.5"})]}),o.jsx(Zn,{children:x&&o.jsxs(tt.div,{ref:C,initial:{opacity:0,scale:.9,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-10},className:`absolute z-50 ${e?"right-0":"left-0"} bottom-full mb-2 bg-white dark:bg-gray-800 rounded-xl shadow-xl border dark:border-gray-700 overflow-hidden min-w-[180px]`,children:[o.jsx("div",{className:"flex justify-center gap-1 p-2 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:bde.map(ye=>o.jsx(tt.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>ve(ye),className:`text-lg p-1 rounded-full transition ${Q===ye?"bg-brand-blue/20":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:ye},ye))}),o.jsxs("div",{className:"p-1",children:[o.jsxs("button",{onClick:()=>{u==null||u(t),_(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[o.jsx(wV,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"dark:text-gray-200",children:"Reply"})]}),o.jsxs("button",{onClick:ue,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[o.jsx(oE,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"dark:text-gray-200",children:b?"Copied!":"Copy"})]}),o.jsxs("button",{onClick:()=>{m==null||m(t),_(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[o.jsx(b1,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"dark:text-gray-200",children:"Forward"})]}),e&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>{d==null||d(t),_(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[o.jsx(RV,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"dark:text-gray-200",children:"Edit"})]}),o.jsxs("button",{onClick:()=>{f==null||f(t,"everyone"),_(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition text-red-500",children:[o.jsx(Mr,{size:16}),o.jsx("span",{children:"Delete for Everyone"})]})]}),o.jsxs("button",{onClick:()=>{f==null||f(t,"me"),_(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition text-gray-500",children:[o.jsx(Mr,{size:16}),o.jsx("span",{children:"Delete for Me"})]})]})]})})]}),e&&o.jsx("div",{className:"w-8 shrink-0"})]})]})}function wde({message:t,conversations:e,currentUserId:n,onForward:r,onClose:s}){const[i,a]=N.useState(""),[l,u]=N.useState([]),[d,f]=N.useState(!1),m=i.trim()?e.filter(_=>{var E;return(E=_.n)==null?void 0:E.toLowerCase().includes(i.toLowerCase())}):e,p=_=>{u(E=>E.includes(_)?E.filter(k=>k!==_):[...E,_])},v=async()=>{if(l.length!==0){f(!0);try{await r(t,l),s()}catch(_){console.error("Forward error:",_),alert("Failed to forward message")}f(!1)}},x=()=>{var _;return t.media?t.media.type==="image"?" Image":t.media.type==="video"?" Video":t.media.type==="audio"?" Audio":" File":((_=t.b)==null?void 0:_.substring(0,100))||"Message"};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:o.jsxs(tt.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(b1,{className:"text-brand-blue",size:20}),o.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Forward Message"})]}),o.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 shrink-0",children:[o.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Forwarding:"}),o.jsx("div",{className:"bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600",children:o.jsx("p",{className:"text-sm dark:text-gray-200 line-clamp-2",children:x()})})]}),o.jsx("div",{className:"px-4 py-3 border-b dark:border-gray-700 shrink-0",children:o.jsxs("div",{className:"relative",children:[o.jsx(ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search conversations...",value:i,onChange:_=>a(_.target.value),className:"w-full pl-9 pr-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white transition"})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:m.length===0?o.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:o.jsx("p",{className:"text-sm",children:"No conversations found"})}):m.map(_=>{const E=l.includes(_.id);return o.jsxs(tt.div,{whileTap:{scale:.98},onClick:()=>p(_.id),className:`
                                        flex items-center gap-3 p-4 cursor-pointer transition
                                        border-b dark:border-gray-700/50
                                        ${E?"bg-brand-blue/10 dark:bg-brand-blue/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}
                                    `,children:[o.jsxs("div",{className:"relative",children:[o.jsx(ai,{src:_.photo,name:_.n,size:"md",isGroup:_.type==="group"}),E&&o.jsx(tt.div,{initial:{scale:0},animate:{scale:1},className:"absolute -bottom-1 -right-1 w-5 h-5 bg-brand-blue rounded-full flex items-center justify-center",children:o.jsx(Cs,{size:12,className:"text-white"})})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-semibold text-sm dark:text-white truncate",children:_.n}),o.jsx("p",{className:"text-xs text-gray-500 truncate",children:_.type==="group"?"Group":"Direct message"})]}),o.jsx("div",{className:`
                                        w-5 h-5 rounded-full border-2 transition
                                        ${E?"border-brand-blue bg-brand-blue":"border-gray-300 dark:border-gray-600"}
                                    `,children:E&&o.jsx(Cs,{size:12,className:"text-white m-auto"})})]},_.id)})}),o.jsxs("div",{className:"p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] shrink-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("span",{className:"text-sm text-gray-500",children:[l.length," conversation",l.length!==1?"s":""," selected"]}),l.length>0&&o.jsx("button",{onClick:()=>u([]),className:"text-xs text-brand-blue hover:underline",children:"Clear all"})]}),o.jsx("button",{onClick:v,disabled:l.length===0||d,className:"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-2",children:d?o.jsxs(o.Fragment,{children:[o.jsx(Ye,{className:"animate-spin",size:18}),"Forwarding..."]}):o.jsxs(o.Fragment,{children:[o.jsx(b1,{size:18}),"Forward"]})})]})]})})}function kde(t,e){var m;const n=Zp(zr.readReceipts.getReadReceipts,t&&e&&Ig()?{chatId:t}:"skip"),r=qi(zr.readReceipts.markAsRead),s=qi(zr.readReceipts.markMultipleAsRead),i=N.useMemo(()=>{if(!n)return{};const p={};return n.forEach(v=>{p[v.userId]?v.readAt>p[v.userId].readAt&&(p[v.userId]={lastReadMessageId:v.messageId,readAt:v.readAt}):p[v.userId]={lastReadMessageId:v.messageId,readAt:v.readAt}}),p},[n]),a=((m=i[e])==null?void 0:m.lastReadMessageId)||null,l=N.useCallback(async p=>{if(!(!t||!e||!p||!r||!s))try{const v=Array.isArray(p)?p:[p];v.length===1?await r({chatId:t,messageId:v[0],userId:e}):await s({chatId:t,messageIds:v,userId:e})}catch(v){console.error("Mark as read error:",v)}},[t,e,r,s]),u=N.useCallback((p,v,x=null)=>{if(!p||!v)return!1;const _=i[v];if(!_||!_.lastReadMessageId)return!1;const E=_.lastReadMessageId;if(E===p)return!0;if(x&&Array.isArray(x)){const k=x.find(S=>S.id===p),b=x.find(S=>S.id===E);if(k&&b&&k.t&&b.t)return k.t<=b.t}return E>=p},[i]),d=N.useCallback(p=>{var v;return((v=i[p])==null?void 0:v.lastReadMessageId)||null},[i]),f=N.useCallback(p=>a===p||a&&a>=p,[a]);return{readReceipts:i,myLastRead:a,markAsRead:l,isMessageRead:u,getLastReadMessage:d,hasCurrentUserRead:f}}async function Nde(t){const e=t.match(/(https?:\/\/[^\s]+)/);if(!e)return null;const n=e[0];await new Promise(s=>setTimeout(s,500));const r={url:n,title:null,description:null,image:null};return n.includes("seshnx.net")?(r.title="SeshNx Official Platform Link",r.description="Shared content from the SeshNx platform. Tap to view embed.",r.image="https://placehold.co/600x400/374151/f9fafb?text=SeshNx+Link"):n.includes("youtube.com")?(r.title="YouTube Video",r.description="Watch this video on YouTube.",r.image="https://img.youtube.com/vi/dQw4w9WgXcQ/mqdefault.jpg"):n.includes("spotify.com")?(r.title="New Track on Spotify",r.description="Listen to the latest release now!",r.image="https://placehold.co/600x400/1DB954/f9fafb?text=Spotify+Album"):n.includes("github.com")?(r.title="SeshNx WebApp Repository",r.description="Check out the source code and contribute.",r.image="https://placehold.co/600x400/000000/ffffff?text=GitHub"):(r.title=`External Link: ${n}`,r.description=`Click to visit ${n}.`),r}function Sde({user:t,userData:e,activeChat:n,conversations:r,onBack:s,toggleDetails:i,openPublicProfile:a}){const[l,u]=N.useState({}),[d,f]=N.useState({isOpen:!1,url:"",previewData:null}),[m,p]=N.useState(null),[v,x]=N.useState(null),[_,E]=N.useState(null),k=N.useRef(null),b=n==null?void 0:n.id,S=(n==null?void 0:n.name)||(n==null?void 0:n.n)||"Unknown User",C=N.useMemo(()=>(n==null?void 0:n.type)==="group"?null:n!=null&&n.uid?n.uid:b&&b.includes("_")?b.split("_").find(le=>le!==(t==null?void 0:t.uid)):null,[n,b,t==null?void 0:t.uid]),{online:P,lastSeen:R,loading:I}=vz(C),{markAsRead:j,hasCurrentUserRead:O,isMessageRead:V}=kde(b,t==null?void 0:t.uid),z=Zp(zr.messages.getMessages,b&&Ig()?{chatId:b,limit:100}:"skip"),D=N.useMemo(()=>z?z.map(G=>({id:G._id,b:G.content||"",s:G.senderId,n:G.senderName,photo:G.senderPhoto||"",t:G.timestamp,edited:G.edited||!1,editedAt:G.editedAt,deleted:G.deleted||!1,deletedForAll:G.deletedForAll||!1,media:G.media,replyTo:G.replyTo,reactions:G.reactions||{}})):[],[z]),F=qi(zr.messages.sendMessage),ee=qi(zr.messages.editMessage),ue=qi(zr.messages.deleteMessage),ve=qi(zr.messages.addReaction),ae=qi(zr.messages.removeReaction),H=qi(zr.conversations.updateConversation),Q=qi(zr.conversations.updateUnreadCount);N.useEffect(()=>{k.current&&D.length>0&&k.current.scrollIntoView({behavior:"smooth"})},[D]),N.useEffect(()=>{b&&(t!=null&&t.uid)&&D.length>0&&j(D.map(G=>G.id))},[b,t==null?void 0:t.uid,D.length]),N.useEffect(()=>{D.forEach(G=>{if(G.b){const le=G.b.match(/(https?:\/\/[^\s]+)/);if(le){const De=le[0];l[G.id]||Nde(De).then(Qe=>u(ie=>({...ie,[G.id]:Qe}))).catch(Qe=>console.error(Qe))}}})},[D]);const W=async(G,le)=>{var De,Qe;if(!(!b||!(t!=null&&t.uid)))try{const ie=D.find(Ge=>Ge.id===G);if(!ie)return;((Qe=(De=ie.reactions)==null?void 0:De[le])==null?void 0:Qe.includes(t.uid))?await ae({messageId:G,userId:t.uid,emoji:le}):await ve({messageId:G,userId:t.uid,emoji:le})}catch(ie){console.error("Reaction error:",ie)}},re=async(G,le)=>{if(!F||!H){alert("Chat functionality is not available. Convex is not configured.");return}const De=G.b||"",Qe=G.media||null;for(const ie of le)try{await F({chatId:ie,senderId:t.uid,senderName:e.firstName||"User",senderPhoto:e.photoURL||null,content:` Forwarded: ${De}`,media:Qe});const Ae=r==null?void 0:r.find(me=>me.id===ie),Ge=De||(Qe?`Forwarded ${Qe.type}`:"Forwarded message");await H({userId:t.uid,chatId:ie,lastMessage:` ${Ge}`,lastMessageTime:Date.now(),lastSenderId:t.uid,chatName:(Ae==null?void 0:Ae.name)||(Ae==null?void 0:Ae.n),chatPhoto:(Ae==null?void 0:Ae.photo)||"",chatType:(Ae==null?void 0:Ae.type)||"direct",otherUserId:Ae==null?void 0:Ae.uid})}catch(Ae){console.error("Forward error for chat:",ie,Ae)}},he=async(G,le)=>{var Qe;if(!b||!(G!=null&&G.trim())&&!le||!F||!ee||!H||!Q)return;let De=G?G.trim():"";if(De.length===0&&le&&(De=le.type==="image"?" Image":le.type==="video"?" Video":le.type==="audio"?" Audio":" File"),v)try{await ee({messageId:v.id,content:De,senderId:t.uid}),x(null);return}catch(ie){console.error("Edit error:",ie);return}try{await F({chatId:b,senderId:t.uid,senderName:e.firstName||"User",senderPhoto:e.photoURL||null,content:De,media:le,replyTo:m?{messageId:m.id,text:((Qe=m.b)==null?void 0:Qe.substring(0,100))||"Media",sender:m.n||"User"}:void 0});const ie=De||(le?`Sent ${le.type}`:"Message");let Ae=[],Ge=n.uid;!Ge&&n.type!=="group"&&b&&b.includes("_")&&(Ge=b.split("_").find(dt=>dt!==t.uid)),n.type==="group"?Ae=[t.uid]:Ge?Ae=[t.uid,Ge]:Ae=[t.uid];for(const me of Ae)await H({userId:me,chatId:b,lastMessage:ie,lastMessageTime:Date.now(),lastSenderId:t.uid,chatName:n.type==="group"?S:n.name||n.n,chatPhoto:n.photo||"",chatType:n.type||"direct",otherUserId:n.type==="direct"?me===t.uid?Ge:t.uid:void 0}),me===t.uid?await Q({userId:me,chatId:b,setTo:0}):await Q({userId:me,chatId:b,increment:1});p(null)}catch(ie){console.error("Send message error:",ie)}},ye=async(G,le=!1)=>{if(!(!b||!(t!=null&&t.uid)||!ue))try{await ue({messageId:G,senderId:t.uid,forEveryone:le})}catch(De){console.error("Delete error:",De)}},Me=N.useMemo(()=>{var G;return o.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-800 bg-white dark:bg-[#1f2128]",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[o.jsx("button",{onClick:s,className:"md:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:o.jsx(fb,{className:"w-5 h-5"})}),o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 cursor-pointer",onClick:()=>a==null?void 0:a(C?{uid:C}:null),children:[o.jsx(ai,{src:(n==null?void 0:n.photo)||((G=n==null?void 0:n.n)==null?void 0:G.photo)||"",name:S,size:"md"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white truncate",children:S}),(n==null?void 0:n.type)!=="group"&&o.jsx(bz,{online:P,lastSeen:R,loading:I})]}),(n==null?void 0:n.type)!=="group"&&o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:P?"Online":R?`Last seen ${Fe(R)}`:"Offline"})]})]})]}),o.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:o.jsx(SV,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})},[n,S,P,R,I,C,s,i,a]),Fe=G=>{if(!G)return"Never";const le=G,Qe=Date.now()-le,ie=Math.floor(Qe/6e4),Ae=Math.floor(ie/60),Ge=Math.floor(Ae/24);return ie<1?"Just now":ie<60?`${ie}m ago`:Ae<24?`${Ae}h ago`:Ge<7?`${Ge}d ago`:new Date(le).toLocaleDateString()};return!n||!b?o.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-[#1f2128] items-center justify-center text-gray-400",children:[o.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:o.jsx("span",{className:"text-4xl",children:""})}),o.jsx("p",{children:"Select a conversation to start chatting"})]}):o.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-[#1f2128]",children:[Me,o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 scrollbar-hide",children:[D.length===0?o.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:o.jsx("p",{children:"No messages yet. Start the conversation!"})}):D.map((G,le)=>{const De=le>0?D[le-1]:null,Qe=G.s===(t==null?void 0:t.uid),ie=V(G.id),Ae=O(G.id);return o.jsx(_de,{message:G,isCurrentUser:Qe,previousMessage:De,currentUserId:t==null?void 0:t.uid,chatId:b,linkPreviewData:l[G.id],messageStatus:ie?"read":Ae?"delivered":"sent",onReaction:Ge=>W(G.id,Ge),onReply:()=>p(G),onEdit:()=>x(G),onDelete:Ge=>ye(G.id,Ge),onForward:()=>E(G),onSeshNxLinkClick:Ge=>f({isOpen:!0,url:Ge,previewData:null}),onUserClick:()=>a==null?void 0:a({uid:G.s})},G.id)}),o.jsx("div",{ref:k})]}),o.jsx(pde,{onSend:he,replyingTo:m,editingMessage:v,onCancelReply:()=>p(null),onCancelEdit:()=>x(null)}),_&&o.jsx(wde,{message:_,conversations:r,onClose:()=>E(null),onForward:re}),d.isOpen&&o.jsx(yde,{url:d.url,previewData:d.previewData,onClose:()=>f({isOpen:!1,url:"",previewData:null})})]})}function Tde({chatId:t,onClose:e,onMediaSelect:n}){const[r,s]=N.useState([]),[i,a]=N.useState(!0),[l,u]=N.useState(null),[d,f]=N.useState("all");N.useEffect(()=>{if(!t||!Br)return;const x=Gte(Za(Br,`messages/${t}`),Hte("t"),qte(500)),_=$te(x,E=>{const k=E.val();if(k){const S=Object.entries(k).map(([C,P])=>({id:C,...P})).filter(C=>C.media&&!C.deleted&&!C.deletedForAll).map(C=>({id:C.id,...C.media,messageId:C.id,timestamp:C.t,sender:C.n})).sort((C,P)=>(C.timestamp||0)-(P.timestamp||0));s(S)}else s([]);a(!1)});return()=>_()},[t,Br]);const m=d==="all"?r:r.filter(x=>d==="images"?x.type==="image":d==="videos"?x.type==="video":d==="audio"?x.type==="audio":d==="files"?x.type==="file":!0),p=x=>{u(x),n&&n(x)},v=x=>{const _=document.createElement("a");_.href=x.url,_.download=x.name||"download",_.target="_blank",document.body.appendChild(_),_.click(),document.body.removeChild(_)};return o.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:[o.jsxs(tt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0",children:[o.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Media Gallery"}),o.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:o.jsx(ut,{size:20})})]}),o.jsx("div",{className:"p-3 border-b dark:border-gray-700 flex gap-2 overflow-x-auto scrollbar-hide shrink-0",children:[{key:"all",label:"All",icon:null},{key:"images",label:"Images",icon:$0},{key:"videos",label:"Videos",icon:ku},{key:"audio",label:"Audio",icon:co},{key:"files",label:"Files",icon:Nl}].map(x=>o.jsxs("button",{onClick:()=>f(x.key),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition ${d===x.key?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200"}`,children:[x.icon&&o.jsx(x.icon,{size:16}),x.label,o.jsxs("span",{className:"text-xs opacity-70",children:["(",m.filter(_=>x.key==="all"||_.type===x.key).length,")"]})]},x.key))}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:i?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[o.jsx("div",{className:"w-8 h-8 border-2 border-brand-blue border-t-transparent rounded-full animate-spin mb-2"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Loading media..."})]}):m.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[o.jsx($0,{size:48,className:"mb-4 opacity-30"}),o.jsx("p",{className:"text-sm",children:"No media found"})]}):o.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:m.map(x=>o.jsxs(tt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(x),className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 cursor-pointer group",children:[x.type==="image"?o.jsx("img",{src:x.url,alt:"Media",className:"w-full h-full object-cover"}):x.type==="video"?o.jsx("video",{src:x.url,className:"w-full h-full object-cover"}):x.type==="audio"?o.jsx("div",{className:"w-full h-full flex items-center justify-center bg-purple-100 dark:bg-purple-900/30",children:o.jsx(co,{size:32,className:"text-purple-600 dark:text-purple-400"})}):o.jsx("div",{className:"w-full h-full flex items-center justify-center bg-blue-100 dark:bg-blue-900/30",children:o.jsx(Nl,{size:32,className:"text-blue-600 dark:text-blue-400"})}),o.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition flex items-center justify-center",children:o.jsx(Wh,{size:20,className:"text-white opacity-0 group-hover:opacity-100 transition"})})]},x.id))})})]}),o.jsx(Zn,{children:l&&o.jsx(Ede,{media:l,onClose:()=>u(null),onDownload:v})})]})}function Ede({media:t,onClose:e,onDownload:n}){const[r,s]=N.useState([]),[i,a]=N.useState(0);N.useEffect(()=>{s([t]),a(0)},[t]);const l=()=>{i<r.length-1&&a(i+1)},u=()=>{i>0&&a(i-1)},d=r[i]||t;return o.jsx(tt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/95 z-[90] flex items-center justify-center",onClick:e,children:o.jsxs("div",{className:"relative max-w-7xl max-h-[90vh] w-full h-full flex items-center justify-center p-4",onClick:f=>f.stopPropagation(),children:[o.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 transition z-10",children:o.jsx(ut,{size:24})}),d.type==="image"&&o.jsx("img",{src:d.url,alt:"Media",className:"max-w-full max-h-full object-contain rounded-lg"}),d.type==="video"&&o.jsx("video",{src:d.url,controls:!0,className:"max-w-full max-h-full rounded-lg",autoPlay:!0}),d.type==="audio"&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md",children:[o.jsx("div",{className:"w-32 h-32 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center mx-auto mb-6",children:o.jsx(co,{size:48,className:"text-purple-600 dark:text-purple-400"})}),o.jsx("audio",{src:d.url,controls:!0,className:"w-full",autoPlay:!0}),o.jsx("p",{className:"text-center mt-4 text-sm text-gray-500",children:d.name})]}),d.type==="file"&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md text-center",children:[o.jsx(Nl,{size:64,className:"text-blue-600 dark:text-blue-400 mx-auto mb-4"}),o.jsx("h4",{className:"text-lg font-bold dark:text-white mb-2",children:d.name}),o.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-4 px-6 py-2 bg-brand-blue text-white rounded-lg hover:bg-blue-600 transition",children:"Open File"})]}),r.length>1&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:u,disabled:i===0,className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition",children:o.jsx(_V,{size:24})}),o.jsx("button",{onClick:l,disabled:i===r.length-1,className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition",children:o.jsx(lo,{size:24})})]}),o.jsx("button",{onClick:()=>n(d),className:"absolute bottom-4 left-1/2 -translate-x-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 transition",children:o.jsx(Wh,{size:20})})]})})}function Cde({activeChat:t,onClose:e,currentUser:n}){const[r,s]=N.useState([]),[i,a]=N.useState({sessions:0,rating:0,responseTime:"N/A"}),[l,u]=N.useState(!0),[d,f]=N.useState(!1),[m,p]=N.useState(!1),v=t.type==="group",x=t.uid,_=t.name||t.n||"Unknown";N.useEffect(()=>{const b=async()=>{u(!0);try{if(s([]),!v&&x){const S=ke(Y,`artifacts/${qe}/users/${x}/public_profile/main`),C=await ki(S),P=C.exists()?C.data():{},R=Ce(Y,`artifacts/${qe}/public/data/bookings`),I=mt(R,zt("senderId","==",n.uid||""),zt("targetId","==",x),zt("status","==","Completed")),j=await fT(I);a({sessions:j.data().count,rating:P.rating||"New",responseTime:P.responseTime||"~1hr"})}}catch(S){console.error("Failed to load details:",S)}u(!1)};t!=null&&t.id&&b()},[t.id,x,v,n==null?void 0:n.uid]);const E=async()=>{if(!(v||!x||!n)&&confirm(`Are you sure you want to block ${_}?`)){f(!0);try{const b=ke(Y,Le(n.uid).userProfile);await ft(b,{"settings.social.blockedUsers":_p(x)}),alert("User blocked."),e()}catch(b){console.error("Block failed:",b),alert("Failed to block user.")}f(!1)}},k=()=>{alert("Please use the report option on their profile page for full moderation tools.")};return o.jsxs("div",{className:"absolute right-0 top-0 h-full w-full md:w-80 bg-gray-800 shadow-xl z-20 flex flex-col transition-transform duration-300 ease-in-out border-l border-gray-700",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-900",children:[o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Details"}),o.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-full transition duration-150","aria-label":"Close details",children:o.jsx(ut,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"p-6 flex flex-col items-center border-b border-gray-700 bg-gray-800",children:[o.jsxs("div",{className:"relative w-24 h-24 rounded-full overflow-hidden mb-4 bg-gray-700 flex items-center justify-center shadow-lg border-4 border-gray-600",children:[o.jsx("img",{src:t.photo,className:"w-full h-full object-cover",onError:b=>b.target.src="",alt:_}),!t.photo&&(v?o.jsx(Gr,{className:"w-10 h-10 text-gray-500"}):o.jsx(wr,{className:"w-10 h-10 text-gray-500"}))]}),o.jsx("h4",{className:"text-xl font-bold text-white text-center leading-tight",children:_}),o.jsxs("p",{className:"text-xs text-gray-400 mt-2 flex items-center px-3 py-1 bg-gray-700 rounded-full",children:[v?o.jsx(Gr,{className:"w-3 h-3 mr-1"}):o.jsx(ao,{className:"w-3 h-3 mr-1"}),v?"Group Chat":t.role||"Creative"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:[!v&&o.jsxs("div",{className:"p-4 border-b border-gray-700",children:[o.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase mb-3 tracking-wider",children:"Performance"}),l?o.jsx("div",{className:"flex justify-center py-4",children:o.jsx(Ye,{className:"animate-spin text-brand-blue"})}):o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsx(Qo,{title:"Sessions",value:i.sessions,icon:ao,color:"text-blue-400"}),o.jsx(Qo,{title:"Rating",value:i.rating,icon:wh,color:"text-yellow-400"}),o.jsx(Qo,{title:"Reply Time",value:i.responseTime,icon:Zr,color:"text-green-400"})]})]}),o.jsxs("div",{className:"p-4 border-b border-gray-700",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Shared Media"}),o.jsx("button",{onClick:()=>p(!0),className:"text-xs text-brand-blue hover:underline font-medium",children:"View All"})]}),r.length>0?o.jsx("div",{className:"grid grid-cols-3 gap-2",children:r.slice(0,6).map((b,S)=>o.jsxs("div",{className:"aspect-square rounded-lg overflow-hidden bg-gray-700 cursor-pointer hover:opacity-80 transition",children:[b.type==="image"&&o.jsx("img",{src:b.url,className:"w-full h-full object-cover",alt:"Media"}),b.type==="video"&&o.jsx("div",{className:"w-full h-full flex items-center justify-center",children:o.jsx(ku,{size:20,className:"text-gray-400"})})]},S))}):o.jsx("p",{className:"text-xs text-gray-500 text-center py-4",children:"No shared media yet"})]}),o.jsxs("div",{className:"p-4 space-y-2",children:[o.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition",children:[o.jsx(iu,{className:"w-4 h-4 text-yellow-500"}),o.jsx("span",{children:"Mute Notifications"})]}),o.jsxs("button",{onClick:()=>p(!0),className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition",children:[o.jsx(kne,{className:"w-4 h-4 text-purple-500"}),o.jsx("span",{children:"Media Gallery"})]}),!v&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:E,disabled:d,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition disabled:opacity-50",children:[d?o.jsx(Ye,{className:"w-4 h-4 animate-spin"}):o.jsx(Vl,{className:"w-4 h-4"}),o.jsx("span",{children:"Block User"})]}),o.jsxs("button",{onClick:k,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition",children:[o.jsx(wh,{className:"w-4 h-4"}),o.jsx("span",{children:"Report User"})]})]})]})]}),m&&o.jsx(Tde,{chatId:t.id,onClose:()=>p(!1)})]})}function jde({user:t,userData:e,openPublicProfile:n}){const[r,s]=N.useState(null),[i,a]=N.useState(!1);ade(t==null?void 0:t.uid);const l=Zp(zr.conversations.getConversations,t!=null&&t.uid&&Ig()?{userId:t.uid}:"skip"),u=N.useMemo(()=>l?l.map(d=>({id:d.chatId,uid:d.otherUserId||d.chatId,name:d.chatName||"Unknown",n:d.chatName||"Unknown",photo:d.chatPhoto||"",type:d.chatType||"direct",lm:d.lastMessage||"",lmt:d.lastMessageTime||0,ls:d.lastSenderId||"",uc:d.unreadCount||0})).sort((d,f)=>(f.lmt||0)-(d.lmt||0)):[],[l]);return N.useEffect(()=>{},[]),o.jsxs("div",{className:"flex h-[calc(100vh-100px)] bg-white dark:bg-[#1f2128] rounded-2xl overflow-hidden border dark:border-gray-800 shadow-xl",children:[o.jsx(tt.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:`w-full md:w-80 border-r dark:border-gray-800 flex flex-col ${r?"hidden md:flex":"flex"}`,children:o.jsx(ude,{user:t,userData:e,conversations:u,activeChat:r,onSelectChat:s})}),o.jsxs("div",{className:`flex-1 flex flex-col relative ${r?"flex":"hidden md:flex"}`,children:[o.jsx(Sde,{activeChat:r,user:t,userData:e,conversations:u,onBack:()=>s(null),toggleDetails:()=>a(!i),openPublicProfile:n}),o.jsx(Zn,{children:i&&r&&o.jsx(tt.div,{initial:{width:0,opacity:0},animate:{width:300,opacity:1},exit:{width:0,opacity:0},className:"border-l dark:border-gray-800 bg-gray-50 dark:bg-[#23262f] overflow-hidden relative z-20",children:o.jsx(Cde,{activeChat:r,currentUser:e,onClose:()=>a(!1)})})})]})]})}const Ide=()=>{const{data:t,loading:e}=ez(),[n,r]=N.useState([]),s=N.useMemo(()=>{if(e||!t)return[];let a=[];try{Object.keys(t).forEach(l=>{const u=t[l];u&&Object.entries(u).forEach(([d,f])=>{if(!f||typeof f!="object")return;const m=f.brand||f.searchTokens&&f.searchTokens[0]||"Unknown",p=f.name||f.searchTokens&&f.searchTokens[1]||"Unknown Item",v=f.searchTokens||[],x=[p,m,...v].join(" ").toLowerCase();a.push({id:d,name:p,brand:m,category:f.category||l,subCategory:f.subCategory||"General",searchString:x,original:f})})})}catch(l){console.warn("Error processing equipment data:",l)}return a},[t,e]);return{searchEquipment:a=>{if(!a||a.trim().length<1){r([]);return}const l=a.toLowerCase().trim().split(/\s+/),u=s.filter(d=>l.every(f=>d.searchString.includes(f))).slice(0,50);r(u)},results:n,loading:e}};function _z({onSelect:t,placeholder:e="Search for gear (e.g. U87, SSL)...",className:n="",value:r,onChange:s,multi:i=!1}){const{searchEquipment:a,results:l,loading:u}=Ide(),[d,f]=N.useState(""),[m,p]=N.useState(!1),v=N.useRef(null),x=r!==void 0?r:d;N.useEffect(()=>{function k(b){v.current&&!v.current.contains(b.target)&&p(!1)}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[v]);const _=k=>{const b=k.target.value;s?s(b):f(b);const S=i?b.split(",").pop().trim():b;S.length>=2?(a(S),p(!0)):p(!1)},E=k=>{const b=k.brand!=="Various"&&k.brand!=="Unknown"?`${k.brand} ${k.name}`:k.name;if(i){const S=x.split(",");S.pop();const P=[...S.map(R=>R.trim()).filter(Boolean),b].join(", ")+", ";s?s(P):f(P)}else t&&t({...k,fullName:b}),s?s(b):f(b);p(!1)};return o.jsxs("div",{ref:v,className:`relative ${n}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx(ur,{className:"absolute left-3 top-3 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-9 pr-8 p-3 text-sm border rounded-xl bg-white dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none transition-all",placeholder:e,value:x,onChange:_,onFocus:k=>_(k)}),x&&o.jsx("button",{type:"button",onClick:()=>{s?s(""):f(""),p(!1)},className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:o.jsx(ut,{size:16})})]}),m&&l.length>0&&o.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl max-h-60 overflow-y-auto animate-in fade-in slide-in-from-top-2",children:o.jsx("div",{className:"py-1",children:l.map(k=>{var b;return o.jsxs("button",{type:"button",onClick:()=>E(k),className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b dark:border-gray-700/50 last:border-0 group",children:[o.jsx("div",{className:"font-bold text-sm dark:text-white group-hover:text-brand-blue transition-colors",children:k.name}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1.5 mt-0.5",children:[o.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:k.brand}),o.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600"}),o.jsx("span",{className:"opacity-75",children:(b=k.subCategory)==null?void 0:b.replace(/_/g," ")})]})]},k.id)})})}),m&&u&&o.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl p-4 text-center text-gray-500 flex items-center justify-center gap-2",children:[o.jsx(Ye,{className:"animate-spin",size:16})," Searching database..."]})]})}const Ade=uv({studioName:jr().min(3,"Studio name is required"),address:jr().min(5,"Address is required"),description:jr().max(1e3).optional(),rules:jr().optional(),amenities:zP(jr()).optional(),rooms:zP(uv({name:jr().min(1,"Room name required"),rate:cv().min(0),capacity:cv().min(1),equipment:jr().optional()})).optional()});function Rde({user:t,userData:e}){const[n,r]=N.useState(!1),{register:s,control:i,handleSubmit:a,watch:l,setValue:u,formState:{errors:d,isDirty:f}}=r2({resolver:s2(Ade),defaultValues:{studioName:(e==null?void 0:e.studioName)||"",address:(e==null?void 0:e.address)||"",description:(e==null?void 0:e.studioDescription)||"",rules:(e==null?void 0:e.studioRules)||"",amenities:(e==null?void 0:e.amenities)||[],rooms:(e==null?void 0:e.rooms)||[{name:"Main Room",rate:50,capacity:5,equipment:""}]}}),{fields:m,append:p,remove:v}=due({control:i,name:"rooms"}),x=l("amenities"),_=b=>{const S=x||[];S.includes(b)?u("amenities",S.filter(C=>C!==b),{shouldDirty:!0}):u("amenities",[...S,b],{shouldDirty:!0})},E=async b=>{r(!0);const S=Wt.loading("Saving Studio Settings...");try{const C=ke(Y,`artifacts/${qe}/users/${t.uid}/profiles/main`);await ft(C,{studioName:b.studioName,address:b.address,studioDescription:b.description,studioRules:b.rules,amenities:b.amenities,rooms:b.rooms,isStudio:!0}),Wt.success("Studio Settings Saved!",{id:S})}catch(C){console.error("Studio update failed",C),Wt.error("Failed to save settings.",{id:S})}finally{r(!1)}},k=b=>Cg("w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none",b?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-200 dark:border-gray-700");return o.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[o.jsxs("h1",{className:"text-3xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(_ne,{className:"text-brand-blue"})," Studio Manager"]}),o.jsxs("form",{onSubmit:a(E),className:"space-y-8",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm space-y-4",children:[o.jsx("h3",{className:"text-lg font-bold dark:text-white mb-4",children:"General Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Studio Name"}),o.jsx("input",{...s("studioName"),className:k(d.studioName)}),d.studioName&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.studioName.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Location Address"}),o.jsx("input",{...s("address"),className:k(d.address),placeholder:"123 Music Row, Nashville TN"}),d.address&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.address.message})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Description"}),o.jsx("textarea",{...s("description"),rows:"3",className:k(d.description),placeholder:"Describe the vibe and gear..."})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"text-lg font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(Mne,{size:20})," Amenities"]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:R6.map(b=>o.jsx("button",{type:"button",onClick:()=>_(b),className:au("px-3 py-2 rounded-lg text-sm font-medium transition-all border",x!=null&&x.includes(b)?"bg-brand-blue text-white border-brand-blue shadow-md":"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"),children:b},b))})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-bold dark:text-white flex items-center gap-2",children:[o.jsx(jV,{size:20})," Rooms & Rates"]}),o.jsxs("button",{type:"button",onClick:()=>p({name:"New Room",rate:0,capacity:1,equipment:""}),className:"text-sm bg-green-100 text-green-700 px-3 py-1.5 rounded-lg font-bold hover:bg-green-200 transition flex items-center gap-1",children:[o.jsx(ms,{size:16})," Add Room"]})]}),o.jsxs("div",{className:"space-y-4",children:[m.map((b,S)=>{var C,P,R,I,j,O;return o.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-600 relative group",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-2",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Room Name"}),o.jsx("input",{...s(`rooms.${S}.name`),className:k((P=(C=d.rooms)==null?void 0:C[S])==null?void 0:P.name)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Hourly Rate ($)"}),o.jsx("input",{type:"number",...s(`rooms.${S}.rate`,{valueAsNumber:!0}),className:k((I=(R=d.rooms)==null?void 0:R[S])==null?void 0:I.rate)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Capacity"}),o.jsx("input",{type:"number",...s(`rooms.${S}.capacity`,{valueAsNumber:!0}),className:k((O=(j=d.rooms)==null?void 0:j[S])==null?void 0:O.capacity)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Equipment (Comma separated)"}),o.jsx(Zce,{control:i,name:`rooms.${S}.equipment`,render:({field:{onChange:V,value:z}})=>o.jsx(_z,{value:z||"",onChange:V,placeholder:"Console, Monitors, Mics...",multi:!0})})]}),o.jsx("button",{type:"button",onClick:()=>v(S),className:"absolute top-2 right-2 p-2 text-gray-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",children:o.jsx(Mr,{size:18})})]},b.id)}),m.length===0&&o.jsx("p",{className:"text-center text-gray-400 py-4 italic",children:"No rooms listed."})]})]}),o.jsx("div",{className:"flex justify-end pt-4",children:o.jsx("button",{type:"submit",disabled:n||!f,className:au("px-8 py-4 rounded-xl font-bold text-lg flex items-center gap-2 transition-all shadow-xl",n||!f?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-blue-600 hover:scale-[1.01]"),children:n?o.jsx(Ye,{className:"animate-spin",size:24}):o.jsxs(o.Fragment,{children:[o.jsx(_u,{size:24})," Save Changes"]})})})]})]})}const o2=()=>{const[t,e]=N.useState(!1),[n,r]=N.useState(null);return{uploadImage:async(i,a)=>{if(!i)return null;if(!B0)return r("Firebase Storage is not configured. Please set VITE_FIREBASE_STORAGE_BUCKET in your environment variables."),console.error("Firebase Storage is not available. storageBucket is missing from Firebase config."),null;e(!0),r(null);try{const u=`${Date.now()}_${i.name}`,d=`${a}/${u}`,f=e3(B0,d),m=await X5(f,i),p=await J5(m.ref);return e(!1),p}catch(l){return console.error("Upload failed:",l),r(l),e(!1),null}},uploading:t,error:n}},Pde=["Student","Instructor","Intern","Admin"];function wz({user:t,userData:e,onUpdate:n,onRoleSwitch:r}){var G,le,De,Qe,ie,Ae,Ge;const[s,i]=N.useState(e.settings||{notifications:{email:!0,push:!0,marketing:!1},privacy:{publicProfile:!0,showLocation:!0,hideProfile:!1},theme:"system",social:{mutedUsers:[],blockedUsers:[]},messenger:{mutedThreads:[],blockedContacts:[]},preferences:{seeAllProfiles:!1}}),[a,l]=N.useState(e.accountTypes||[]),[u,d]=N.useState(e.preferredRole||a[0]),[f,m]=N.useState(e.activeProfileRole||a[0]),[p,v]=N.useState(!1),[x,_]=N.useState(!1),[E,k]=N.useState(!1),[b,S]=N.useState(""),[C,P]=N.useState(!1),[R,I]=N.useState(!1),[j,O]=N.useState(null),[V,z]=N.useState({newEmail:"",newPassword:"",currentPassword:""}),[D,F]=N.useState(!1),[ee,ue]=N.useState(!1);N.useEffect(()=>{e.activeProfileRole&&m(e.activeProfileRole)},[e.activeProfileRole]);const ve=(me,dt)=>{i(Dt=>{var Wn;const dr={...Dt,[me]:{...Dt[me],[dt]:!((Wn=Dt[me])!=null&&Wn[dt])}};return n(dr),dr})},ae=me=>{i(dt=>{const Dt={...dt,theme:me};return n(Dt),Dt})},H=async()=>{if(a.length===0)return alert("You must have at least one role.");v(!0);try{await ft(ke(Y,Le(t.uid).userProfile),{accountTypes:a,preferredRole:u,activeProfileRole:f}),f!==e.activeProfileRole&&r&&r(f);for(const me of a){const dt=ke(Y,Le(t.uid).userSubProfile(me));(await ki(dt)).exists()||await Ka(dt,{useRealName:!0,useGlobalName:!0})}alert("Roles & Preferences updated!")}catch(me){console.error(me),alert("Failed to update.")}v(!1)},Q=me=>{l(dt=>dt.includes(me)?dt.filter(Dt=>Dt!==me):[...dt,me])},W=me=>{O(me),z({newEmail:"",newPassword:"",currentPassword:""}),I(!0)},re=async()=>{if(!V.currentPassword)return alert("Current password is required to verify your identity.");F(!0);try{const me=hu.credential(t.email,V.currentPassword);if(await jq(t,me),j==="email"){if(!V.newEmail)throw new Error("New email address is required.");await Pq(t,V.newEmail),await ft(ke(Y,Le(t.uid).userProfile),{email:V.newEmail}),alert("Email updated successfully.")}else if(j==="password"){if(V.newPassword.length<6)throw new Error("Password must be at least 6 characters.");await Lq(t,V.newPassword),alert("Password updated successfully.")}I(!1),z({newEmail:"",newPassword:"",currentPassword:""})}catch(me){console.error("Security Update Error:",me),me.code==="auth/wrong-password"?alert("Incorrect current password."):me.code==="auth/email-already-in-use"?alert("This email is already associated with another account."):alert("Failed to update: "+me.message)}F(!1)},he=async()=>{_(!0);try{throw new Error("Data export functionality is temporarily unavailable. Firebase Functions service is not configured.")}catch(me){console.error(me),alert("Failed to export data. Please try again later.")}_(!1)},ye=async()=>{if(b==="DELETE"){k(!0);try{await Vq(t)}catch(me){console.error("Deletion Error:",me),me.code==="auth/requires-recent-login"?alert("For security, please log out and log back in before deleting your account."):alert("Failed to delete account: "+me.message),k(!1)}}},Me=({title:me,items:dt,type:Dt,icon:dr})=>o.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[o.jsxs("h5",{className:"text-sm font-bold dark:text-gray-300 mb-2 flex items-center gap-2",children:[o.jsx(dr,{size:14})," ",me]}),dt&&dt.length>0?o.jsx("div",{className:"flex flex-wrap gap-2",children:dt.map((Wn,st)=>o.jsxs("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded flex items-center gap-1 text-gray-600 dark:text-gray-300",children:[Wn.substring(0,8),"... ",o.jsx(ut,{size:10,className:"cursor-pointer hover:text-red-500"})]},st))}):o.jsxs("p",{className:"text-xs text-gray-400 italic",children:["No active ",Dt,"."]})]}),Fe=ee?[...new Set([...X0,...Pde])]:X0;return o.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-300 pb-20",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(Gr,{size:18,className:"text-purple-500"})," Roles & Workflow"]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block",children:"Active Account Types"}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-yellow-50 dark:bg-yellow-900/10 px-2 py-1 rounded border border-yellow-200 dark:border-yellow-800",children:[o.jsx("input",{type:"checkbox",checked:ee,onChange:me=>ue(me.target.checked),className:"rounded text-yellow-600 focus:ring-yellow-500"}),o.jsx("span",{className:"text-[10px] font-bold text-yellow-700 dark:text-yellow-400",children:"Unlock All Roles"})]})]}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:Fe.map(me=>o.jsx("button",{onClick:()=>Q(me),className:`px-3 py-1.5 rounded-full text-xs font-bold transition border ${a.includes(me)?"bg-purple-100 border-purple-200 text-purple-700 dark:bg-purple-900/30 dark:border-purple-700 dark:text-purple-300":"bg-gray-50 border-gray-200 text-gray-500 dark:bg-transparent dark:border-gray-600 dark:text-gray-400"}`,children:me},me))})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[o.jsx(fE,{size:12})," Preferred Profile"]}),o.jsx("select",{className:"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:u,onChange:me=>d(me.target.value),children:a.map(me=>o.jsx("option",{value:me,children:me},me))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[o.jsx(Lp,{size:12})," Active Workflow Context"]}),o.jsx("select",{className:"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:f,onChange:me=>m(me.target.value),children:a.map(me=>o.jsx("option",{value:me,children:me},me))})]})]}),o.jsxs("label",{className:"flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded transition border border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(lE,{size:16,className:"text-brand-blue"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-200",children:"See All (Unfiltered View)"}),o.jsx("p",{className:"text-[10px] text-gray-500",children:"Show all content types regardless of active workflow."})]})]}),o.jsxs("div",{className:`w-10 h-5 rounded-full p-0.5 flex transition-colors ${(G=s.preferences)!=null&&G.seeAllProfiles?"bg-brand-blue justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:[o.jsx("input",{type:"checkbox",className:"hidden",checked:((le=s.preferences)==null?void 0:le.seeAllProfiles)||!1,onChange:()=>ve("preferences","seeAllProfiles")}),o.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})]})]}),o.jsx("div",{className:"mt-4 pt-4 border-t dark:border-gray-700",children:o.jsxs("button",{onClick:H,disabled:p,className:"w-full bg-purple-600 text-white px-4 py-2.5 rounded-lg font-bold hover:bg-purple-700 disabled:opacity-50 flex items-center justify-center gap-2 shadow-md transition",children:[p?o.jsx(Ye,{className:"animate-spin",size:16}):o.jsx(Lp,{size:16})," Save Workflow Settings"]})})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(uo,{size:18,className:"text-blue-500"})," Account Security"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full text-blue-600 dark:text-blue-400",children:o.jsx(Pp,{size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-bold dark:text-white",children:"Email Address"}),o.jsx("div",{className:"text-xs text-gray-500",children:t.email})]})]}),o.jsx("button",{onClick:()=>W("email"),className:"text-xs font-bold bg-white dark:bg-gray-700 border dark:border-gray-600 px-3 py-1.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition",children:"Change Email"})]}),o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full text-blue-600 dark:text-blue-400",children:o.jsx(Rp,{size:18})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-bold dark:text-white",children:"Password"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Last changed: Never (or unknown)"})]})]}),o.jsx("button",{onClick:()=>W("password"),className:"text-xs font-bold bg-white dark:bg-gray-700 border dark:border-gray-600 px-3 py-1.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition",children:"Change Password"})]})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(wu,{size:18,className:"text-gray-500"})," Content & Safety"]}),o.jsx(Me,{title:"Blocked Users",items:(De=s.social)==null?void 0:De.blockedUsers,type:"blocks",icon:FA}),o.jsx(Me,{title:"Muted Threads",items:(Qe=s.messenger)==null?void 0:Qe.mutedThreads,type:"mutes",icon:CV})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(iu,{size:18,className:"text-brand-blue"})," Notification Preferences"]}),o.jsx("div",{className:"space-y-3",children:Object.entries({email:"Email Notifications",push:"Push Notifications",marketing:"Marketing & Updates"}).map(([me,dt])=>{var Dt;return o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm dark:text-gray-300",children:dt}),o.jsx("div",{onClick:()=>ve("notifications",me),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(Dt=s.notifications)!=null&&Dt[me]?"bg-brand-blue justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:o.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]},me)})})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(uo,{size:18,className:"text-green-500"})," Privacy & Visibility"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(yne,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"text-sm dark:text-gray-300",children:"Public Profile Visibility"})]}),o.jsx("div",{onClick:()=>ve("privacy","publicProfile"),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(ie=s.privacy)!=null&&ie.publicProfile?"bg-green-500 justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:o.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(cr,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"text-sm dark:text-gray-300",children:"Show Location on Map"})]}),o.jsx("div",{onClick:()=>ve("privacy","showLocation"),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(Ae=s.privacy)!=null&&Ae.showLocation?"bg-green-500 justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:o.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(FA,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"text-sm dark:text-gray-300",children:"Hide Profile Completely"})]}),o.jsx("div",{onClick:()=>ve("privacy","hideProfile"),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(Ge=s.privacy)!=null&&Ge.hideProfile?"bg-brand-blue justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:o.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]}),o.jsx("div",{className:"pt-4 mt-2 border-t dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-bold dark:text-white",children:"Your Data"}),o.jsx("p",{className:"text-[10px] text-gray-500",children:"Download a copy of your personal data (GDPR/CCPA)."})]}),o.jsxs("button",{onClick:he,disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs font-bold text-gray-700 dark:text-gray-200 transition",children:[x?o.jsx(Ye,{size:14,className:"animate-spin"}):o.jsx(Wh,{size:14}),"Download Data"]})]})})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(uE,{size:18,className:"text-purple-500"})," Appearance"]}),o.jsx("div",{className:"flex bg-gray-100 dark:bg-black/20 p-1 rounded-lg",children:["light","dark","system"].map(me=>o.jsx("button",{onClick:()=>ae(me),className:`flex-1 py-2 text-xs font-bold rounded-md capitalize transition-all ${s.theme===me?"bg-white dark:bg-gray-700 shadow-sm text-brand-blue":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:me},me))})]}),o.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 p-6 rounded-xl border border-red-100 dark:border-red-800/30 shadow-sm",children:[o.jsxs("h3",{className:"font-bold text-lg text-red-600 dark:text-red-400 mb-2 flex items-center gap-2",children:[o.jsx(Vl,{size:18})," Danger Zone"]}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Deleting your account is permanent. This action will trigger the data cleanup process, removing your profile, posts, and messages."}),C?o.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-4 rounded-xl border border-red-200 dark:border-red-900 shadow-lg animate-in fade-in slide-in-from-bottom-2",children:[o.jsxs("h4",{className:"font-bold text-red-600 dark:text-red-400 mb-2 flex items-center gap-2",children:[o.jsx(kl,{size:16})," Confirm Deletion"]}),o.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-3",children:["Type ",o.jsx("strong",{children:"DELETE"})," below to confirm. This cannot be undone."]}),o.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 dark:border-red-900 rounded mb-3 text-sm focus:ring-2 focus:ring-red-500 outline-none dark:bg-black/20 dark:text-white",placeholder:"Type DELETE",value:b,onChange:me=>S(me.target.value)}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:ye,disabled:b!=="DELETE"||E,className:"flex-1 bg-red-600 text-white py-2 rounded font-bold text-xs hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:E?o.jsx(Ye,{className:"animate-spin",size:14}):"Confirm Delete"}),o.jsx("button",{onClick:()=>{P(!1),S("")},className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-xs hover:opacity-80",children:"Cancel"})]})]}):o.jsx("button",{onClick:()=>P(!0),className:"bg-red-100 hover:bg-red-200 dark:bg-red-900/40 dark:hover:bg-red-900/60 text-red-700 dark:text-red-300 px-4 py-2 rounded-lg text-sm font-bold transition",children:"Delete Account"})]}),R&&o.jsx("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 shadow-2xl animate-in zoom-in-95 border dark:border-gray-700",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-bold dark:text-white flex items-center gap-2",children:[j==="email"?o.jsx(Pp,{size:20}):o.jsx(Rp,{size:20}),"Update ",j==="email"?"Email":"Password"]}),o.jsx("button",{onClick:()=>I(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-white",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Current Password (Required)"}),o.jsx("input",{type:"password",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Verify your identity",value:V.currentPassword,onChange:me=>z({...V,currentPassword:me.target.value})})]}),j==="email"?o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"New Email Address"}),o.jsx("input",{type:"email",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"name@example.com",value:V.newEmail,onChange:me=>z({...V,newEmail:me.target.value})})]}):o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"New Password"}),o.jsx("input",{type:"password",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Min 6 characters",value:V.newPassword,onChange:me=>z({...V,newPassword:me.target.value})})]}),o.jsxs("button",{onClick:re,disabled:D,className:"w-full bg-blue-600 text-white py-2.5 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2 shadow-lg mt-2",children:[D?o.jsx(Ye,{className:"animate-spin",size:18}):o.jsx(kr,{size:18}),"Confirm Update"]})]})]})})]})}const Lde=uv({firstName:jr().min(2,"First name too short"),lastName:jr().min(2,"Last name too short"),displayName:jr().optional(),bio:jr().max(500,"Bio exceeds 500 characters").optional(),zip:jr().regex(/^\d{5}$/,"Invalid ZIP code").optional().or(BP("")),hourlyRate:cv().min(0,"Rate cannot be negative").optional(),website:jr().url("Invalid URL").optional().or(BP(""))}),Mde=(t,e,n)=>n?n.substring(0,2).toUpperCase():(((t==null?void 0:t[0])||"")+((e==null?void 0:e[0])||"")).toUpperCase()||"U";function Ode({user:t,userData:e,subProfiles:n={},handleLogout:r}){const[s,i]=N.useState("details"),[a,l]=N.useState("Main"),[u,d]=N.useState(!1),{uploadImage:f,uploading:m}=o2(),[p,v]=N.useState((e==null?void 0:e.useLegalNameOnly)||!1),[x,_]=N.useState((e==null?void 0:e.useUserNameOnly)||!1);N.useEffect(()=>{v((e==null?void 0:e.useLegalNameOnly)||!1),_((e==null?void 0:e.useUserNameOnly)||!1)},[e]);const E=()=>{const V=!p;v(V),V&&_(!1)},k=()=>{const V=!x;_(V),V&&v(!1)},{register:b,handleSubmit:S,formState:{errors:C,isDirty:P}}=r2({resolver:s2(Lde),defaultValues:{firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",displayName:(e==null?void 0:e.displayName)||"",bio:(e==null?void 0:e.bio)||"",zip:(e==null?void 0:e.zip)||"",hourlyRate:(e==null?void 0:e.hourlyRate)||0,website:(e==null?void 0:e.website)||""}}),R=async V=>{d(!0);const z=Wt.loading("Saving main profile...");try{let D=`${V.firstName} ${V.lastName}`;p?D=`${V.firstName} ${V.lastName}`:x&&V.displayName?D=V.displayName:V.displayName&&(D=`${V.firstName} "${V.displayName}" ${V.lastName}`);const F=ke(Y,Le(t.uid).userProfile);await ft(F,{...V,useLegalNameOnly:p,useUserNameOnly:x,effectiveDisplayName:D,searchTerms:[V.firstName.toLowerCase(),V.lastName.toLowerCase(),(V.displayName||"").toLowerCase(),D.toLowerCase()].filter(Boolean)}),Wt.success("Main Profile Updated!",{id:z})}catch(D){console.error("Update failed",D),Wt.error("Failed to update profile.",{id:z})}finally{d(!1)}},I=async V=>{const z=V.target.files[0];if(!z)return;const D=Wt.loading("Uploading photo...");try{const F=await f(z,`users/${t.uid}/avatars`),ee=ke(Y,Le(t.uid).userProfile);await ft(ee,{photoURL:F}),Wt.success("Photo uploaded!",{id:D})}catch(F){console.error(F),Wt.error("Photo upload failed",{id:D})}},j=async V=>{try{const z=ke(Y,Le(t.uid).userProfile);await ft(z,{settings:V}),Wt.success("Settings saved.")}catch(z){console.error("Settings save failed",z),Wt.error("Failed to save settings.")}},O=V=>Cg("w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none",V?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-200 dark:border-gray-700");return o.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[o.jsxs("h1",{className:"text-3xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(wr,{className:"text-brand-blue"})," ",s==="details"?"Edit Profile":"Account Settings"]}),o.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-1 rounded-lg flex gap-1 self-start md:self-auto",children:[o.jsx("button",{onClick:()=>i("details"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all ${s==="details"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"Edit Details"}),o.jsxs("button",{onClick:()=>i("settings"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all flex items-center gap-1 ${s==="settings"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:[o.jsx(wu,{size:14})," Settings"]})]})]}),s==="details"?o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 animate-in fade-in slide-in-from-bottom-2",children:[o.jsxs("div",{className:"lg:col-span-1 space-y-2",children:[o.jsx("div",{className:"font-bold text-xs text-gray-500 uppercase tracking-wider mb-2 px-1",children:"Profiles"}),o.jsxs("button",{onClick:()=>l("Main"),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all ${a==="Main"?"bg-brand-blue text-white shadow-md":"bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(wr,{size:16})," ",o.jsx("span",{className:"font-bold text-sm",children:"Main Profile"})]}),a==="Main"&&o.jsx(lo,{size:16})]}),((e==null?void 0:e.accountTypes)||[]).map(V=>J0[V]?o.jsxs("button",{onClick:()=>l(V),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all ${a===V?"bg-brand-blue text-white shadow-md":"bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ao,{size:16})," ",o.jsx("span",{className:"font-bold text-sm",children:V})]}),a===V&&o.jsx(lo,{size:16})]},V):null)]}),o.jsx("div",{className:"lg:col-span-3",children:a==="Main"?o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"md:col-span-1 space-y-4",children:[o.jsxs("div",{className:"relative group w-full aspect-square rounded-full overflow-hidden bg-gray-100 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 shadow-md",children:[e!=null&&e.photoURL?o.jsx("img",{src:e.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):o.jsx("div",{className:"flex items-center justify-center h-full bg-gradient-to-tr from-brand-blue to-purple-500 text-white font-bold text-4xl",children:Mde(e==null?void 0:e.firstName,e==null?void 0:e.lastName,e==null?void 0:e.displayName)}),o.jsxs("label",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity",children:[o.jsx("span",{className:"text-white font-bold text-sm",children:"Change Photo"}),o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:I,disabled:m})]}),m&&o.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:o.jsx(Ye,{className:"animate-spin text-white"})})]}),o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl text-xs text-blue-800 dark:text-blue-200",children:[o.jsx("p",{className:"font-bold mb-1",children:"Pro Tip:"}),"High-quality profile photos increase booking rates by 40%."]})]}),o.jsx("div",{className:"md:col-span-2",children:o.jsxs("form",{onSubmit:S(R),className:"space-y-6 bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"First Name (Legal)"}),o.jsx("input",{...b("firstName"),className:O(C.firstName)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Last Name (Legal)"}),o.jsx("input",{...b("lastName"),className:O(C.lastName)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"User Name (Display Name)"}),o.jsx("input",{...b("displayName"),className:O(C.displayName),placeholder:"e.g. SeshMaster"})]}),o.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Display Name Preferences"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use Legal Name Only"}),o.jsx("button",{type:"button",onClick:E,className:"text-brand-blue",children:p?o.jsx(jc,{size:28}):o.jsx(Cc,{size:28,className:"text-gray-400"})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use User Name Only"}),o.jsx("button",{type:"button",onClick:k,className:"text-brand-blue",children:x?o.jsx(jc,{size:28}):o.jsx(Cc,{size:28,className:"text-gray-400"})})]}),o.jsxs("div",{className:"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2",children:["Preview: ",o.jsx("strong",{className:"text-brand-blue",children:p?`${e.firstName} ${e.lastName}`:x?e.displayName||"Not Set":`${e.firstName} "${e.displayName||"User"}" ${e.lastName}`})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Bio / About"}),o.jsx("textarea",{...b("bio"),rows:"4",className:O(C.bio),placeholder:"Tell us about your musical journey..."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[o.jsx(cr,{size:12})," ZIP Code"]}),o.jsx("input",{...b("zip"),className:O(C.zip)})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[o.jsx(js,{size:12})," Hourly Rate ($)"]}),o.jsx("input",{type:"number",...b("hourlyRate",{valueAsNumber:!0}),className:O(C.hourlyRate)})]})]}),o.jsx("div",{className:"pt-4 border-t dark:border-gray-700 flex justify-end",children:o.jsx("button",{type:"button",onClick:S(R),disabled:u,className:au("px-8 py-3 rounded-xl font-bold flex items-center gap-2 transition-all shadow-lg",u?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-blue-600 hover:scale-105"),children:u?o.jsx(Ye,{className:"animate-spin",size:20}):o.jsxs(o.Fragment,{children:[o.jsx(_u,{size:20})," Save Changes"]})})})]})})]}):o.jsx(Dde,{user:t,userData:e,role:a,initialData:n[a]||{},schema:J0[a]||[]})})]}):o.jsx("div",{className:"animate-in fade-in slide-in-from-right-2",children:o.jsx(wz,{user:t,userData:e,handleLogout:r,onUpdate:j})})]})}function Dde({user:t,userData:e,role:n,initialData:r,schema:s}){const[i,a]=N.useState(r),[l,u]=N.useState(!1),[d,f]=N.useState(r.followMainProfile??!0),[m,p]=N.useState(r.useLegalNameOnly??!1),[v,x]=N.useState(r.useUserNameOnly??!1),[_,E]=N.useState(r.syncStudioOps??!1);N.useEffect(()=>{a(r||{}),f(r.followMainProfile??!0),p(r.useLegalNameOnly??!1),x(r.useUserNameOnly??!1),E(r.syncStudioOps??!1)},[r]);const k=(R,I)=>a(j=>({...j,[R]:I})),b=()=>{p(!m),m||x(!1)},S=()=>{x(!v),v||p(!1)},C=async R=>{R.preventDefault(),u(!0);const I=Wt.loading(`Saving ${n} profile...`);try{let j="";d?j=e.effectiveDisplayName||`${e.firstName} ${e.lastName}`:m?j=`${e.firstName} ${e.lastName}`:v?j=e.displayName||`${e.firstName} ${e.lastName}`:j=i.profileName||`${e.firstName} ${e.lastName}`;const O={...i,followMainProfile:d,useLegalNameOnly:m,useUserNameOnly:v,syncStudioOps:_,displayName:j},V=ke(Y,Le(t.uid).userSubProfile(n));if(await Ka(V,O,{merge:!0}),e.activeProfileRole===n){const z=ke(Y,Le(t.uid).userPublicProfile);await ft(z,{displayName:j,searchTerms:[j.toLowerCase()]})}if(n==="Studio"&&_){const z=ke(Y,Le(t.uid).userProfile);await ft(z,{studioName:j})}Wt.success(`${n} Profile Saved!`,{id:I})}catch(j){console.error(j),Wt.error("Failed to save.",{id:I})}finally{u(!1)}};if(s.length===0)return o.jsx("div",{className:"p-10 text-center text-gray-500",children:"No configuration available for this role."});const P=s.filter(R=>R.key!=="profileName"&&R.key!=="useRealName");return o.jsxs("form",{onSubmit:C,className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm space-y-6",children:[o.jsxs("h2",{className:"text-xl font-bold dark:text-white border-b dark:border-gray-700 pb-2",children:[n," Identity & Details"]}),o.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Identity Settings"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-bold dark:text-white",children:"Follow Main Profile Name"}),o.jsxs("div",{className:"text-xs text-gray-500",children:['Use "',e.effectiveDisplayName||`${e.firstName} ${e.lastName}`,'"']})]}),o.jsx("button",{type:"button",onClick:()=>f(!d),className:"text-brand-blue",children:d?o.jsx(jc,{size:28}):o.jsx(Cc,{size:28,className:"text-gray-400"})})]}),!d&&o.jsxs("div",{className:"space-y-3 animate-in slide-in-from-top-1 pt-3 border-t dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use Legal Name Only"}),o.jsx("button",{type:"button",onClick:b,className:"text-brand-blue",children:m?o.jsx(jc,{size:28}):o.jsx(Cc,{size:28,className:"text-gray-400"})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use Main User Name Only"}),o.jsx("button",{type:"button",onClick:S,className:"text-brand-blue",children:v?o.jsx(jc,{size:28}):o.jsx(Cc,{size:28,className:"text-gray-400"})})]}),!m&&!v&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("label",{className:"text-xs font-bold text-brand-blue uppercase mb-1 block",children:[n," Name"]}),o.jsx("input",{type:"text",className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none font-bold",placeholder:`e.g. ${n==="Studio"?"Sound City":"The Weeknd"}`,value:i.profileName||"",onChange:R=>k("profileName",R.target.value)}),n==="Studio"&&o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[o.jsx("input",{type:"checkbox",checked:_,onChange:R=>E(R.target.checked),className:"rounded text-brand-blue focus:ring-brand-blue"}),o.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Force "Studio Ops" to use this name'})]})]}),o.jsxs("div",{className:"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2",children:["Preview: ",o.jsx("strong",{className:"text-brand-blue",children:m?`${e.firstName} ${e.lastName}`:v?e.displayName||"Not Set":i.profileName||"Not Set"})]})]})]}),P.map(R=>{var I;return R.isToggle?null:o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:R.label}),R.type==="textarea"?o.jsx("textarea",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none",rows:4,value:i[R.key]||"",onChange:j=>k(R.key,j.target.value)}):R.type==="select"?o.jsx("select",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none",value:i[R.key]||"",onChange:j=>k(R.key,j.target.value),children:(I=R.options)==null?void 0:I.map(j=>o.jsx("option",{value:j,children:j},j))}):R.type==="multi_select"?o.jsx(XE,{label:"",fieldKey:R.key,options:R.data||R.options||[],initialValues:i[R.key]||[],onChange:k}):R.type==="nested_select"?o.jsx(Ace,{label:"",fieldKey:R.key,data:R.data,initialValues:i[R.key]||[],onChange:k}):R.key==="equipment"?o.jsx(_z,{multi:!0,value:i[R.key]||"",onChange:j=>k(R.key,j),placeholder:"Add gear..."}):o.jsx("input",{type:R.type==="number"?"number":"text",className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none",value:i[R.key]||"",onChange:j=>k(R.key,j.target.value)})]},R.key)}),o.jsx("div",{className:"pt-4 border-t dark:border-gray-700 flex justify-end",children:o.jsx("button",{type:"submit",disabled:l,className:"px-8 py-3 rounded-xl font-bold bg-brand-blue text-white hover:bg-blue-600 flex items-center gap-2 transition shadow-lg disabled:opacity-50",children:l?o.jsx(Ye,{className:"animate-spin",size:20}):o.jsxs(o.Fragment,{children:[o.jsx(_u,{size:20})," Save ",n," Profile"]})})})]})}function Vde({rating:t=0,setRating:e,interactive:n=!1,size:r=16}){const[s,i]=N.useState(0);return o.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(a=>o.jsx(fE,{size:r,className:`transition-colors ${n?"cursor-pointer":""} ${(n&&s||t)>=a?"fill-yellow-400 text-yellow-400":"text-gray-300 dark:text-gray-600"}`,fill:(n&&s||t)>=a?"currentColor":"none",onMouseEnter:()=>n&&i(a),onMouseLeave:()=>n&&i(0),onClick:()=>n&&e(a)},a))})}const pi={FOLLOWERS:"followers",FOLLOWING:"following"};function Fde({userId:t,userName:e,initialTab:n=pi.FOLLOWERS,currentUser:r,currentUserData:s,isFollowing:i,toggleFollow:a,onClose:l,openPublicProfile:u}){const[d,f]=N.useState(n),[m,p]=N.useState([]),[v,x]=N.useState([]),[_,E]=N.useState(!0),[k,b]=N.useState("");N.useEffect(()=>{if(!t)return;E(!0);const j=Ce(Y,Le(t).followers),O=mt(j,_n("timestamp","desc"),fs(100)),V=Qt(O,z=>{const D=z.docs.map(F=>({odId:F.id,userId:F.id,...F.data()}));p(D),E(!1)},z=>{console.error("Followers fetch error:",z),E(!1)});return()=>V()},[t]),N.useEffect(()=>{if(!t)return;const j=Ce(Y,Le(t).following),O=mt(j,_n("timestamp","desc"),fs(100)),V=Qt(O,z=>{const D=z.docs.map(F=>({odId:F.id,userId:F.id,...F.data()}));x(D)},z=>{console.error("Following fetch error:",z)});return()=>V()},[t]);const S=d===pi.FOLLOWERS?m:v,C=k.trim()?S.filter(j=>{var O;return(O=j.displayName)==null?void 0:O.toLowerCase().includes(k.toLowerCase())}):S,P=t===(r==null?void 0:r.uid),R=j=>{u&&(u(j),l())},I=async j=>{a&&await a(j.userId,{displayName:j.displayName,photoURL:j.photoURL,role:j.role})};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:o.jsxs(tt.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 shrink-0",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"font-bold text-lg dark:text-white",children:e||"User"}),o.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-800 rounded-xl p-1",children:[o.jsxs("button",{onClick:()=>f(pi.FOLLOWERS),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${d===pi.FOLLOWERS?"bg-white dark:bg-gray-700 shadow-sm text-brand-blue":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[o.jsx(Gr,{size:16}),o.jsx("span",{children:"Followers"}),o.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d===pi.FOLLOWERS?"bg-brand-blue/10 text-brand-blue":"bg-gray-200 dark:bg-gray-600"}`,children:m.length})]}),o.jsxs("button",{onClick:()=>f(pi.FOLLOWING),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${d===pi.FOLLOWING?"bg-white dark:bg-gray-700 shadow-sm text-brand-blue":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[o.jsx(_1,{size:16}),o.jsx("span",{children:"Following"}),o.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d===pi.FOLLOWING?"bg-brand-blue/10 text-brand-blue":"bg-gray-200 dark:bg-gray-600"}`,children:v.length})]})]})]}),S.length>5&&o.jsx("div",{className:"px-4 py-3 border-b dark:border-gray-700 shrink-0",children:o.jsxs("div",{className:"relative",children:[o.jsx(ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search...",value:k,onChange:j=>b(j.target.value),className:"w-full pl-9 pr-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white transition"})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:_?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Ye,{className:"animate-spin text-brand-blue mb-2",size:28}),o.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."})]}):C.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[o.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-4",children:d===pi.FOLLOWERS?o.jsx(Gr,{size:24,className:"text-gray-400"}):o.jsx(_1,{size:24,className:"text-gray-400"})}),o.jsx("p",{className:"text-gray-500 text-center",children:k?`No results for "${k}"`:d===pi.FOLLOWERS?P?"You don't have any followers yet":"No followers yet":P?"You're not following anyone yet":"Not following anyone yet"}),!k&&d===pi.FOLLOWING&&P&&o.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Find artists and creators to follow in the feed!"})]}):o.jsx(Zn,{mode:"popLayout",children:C.map((j,O)=>o.jsx(zde,{user:j,index:O,currentUserId:r==null?void 0:r.uid,isFollowingUser:i==null?void 0:i(j.userId),onToggleFollow:()=>I(j),onUserClick:()=>R(j.userId)},j.userId))})})]})})}function zde({user:t,index:e,currentUserId:n,isFollowingUser:r,onToggleFollow:s,onUserClick:i}){const a=t.userId===n;return o.jsxs(tt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-10},transition:{delay:e*.03},className:"flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition border-b dark:border-gray-700/50 last:border-0",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 cursor-pointer",onClick:i,children:[o.jsx(ai,{src:t.photoURL,name:t.displayName,size:"md"}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("h4",{className:"font-semibold text-sm dark:text-white truncate hover:text-brand-blue transition",children:t.displayName}),t.role&&o.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.role})]})]}),!a&&o.jsx(YE,{isFollowing:r,onToggle:s,size:"sm",variant:"outline"}),a&&o.jsx("span",{className:"text-xs text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded-full",children:"You"})]})}function Bde({followersCount:t=0,followingCount:e=0,onFollowersClick:n,onFollowingClick:r,size:s="md"}){const i={sm:"text-xs gap-3",md:"text-sm gap-4",lg:"text-base gap-5"},a={sm:"text-sm",md:"text-base",lg:"text-lg"};return o.jsxs("div",{className:`flex items-center ${i[s]}`,children:[o.jsxs("button",{onClick:n,className:"flex items-center gap-1 hover:text-brand-blue transition group",children:[o.jsx("span",{className:`font-bold dark:text-white group-hover:text-brand-blue ${a[s]}`,children:t.toLocaleString()}),o.jsx("span",{className:"text-gray-500",children:t===1?"Follower":"Followers"})]}),o.jsx("span",{className:"text-gray-300 dark:text-gray-600",children:""}),o.jsxs("button",{onClick:r,className:"flex items-center gap-1 hover:text-brand-blue transition group",children:[o.jsx("span",{className:`font-bold dark:text-white group-hover:text-brand-blue ${a[s]}`,children:e.toLocaleString()}),o.jsx("span",{className:"text-gray-500",children:"Following"})]})]})}function $de({userId:t,currentUser:e,currentUserData:n,onClose:r,onMessage:s}){var V,z,D,F,ee;const[i,a]=N.useState(null),[l,u]=N.useState(!0),[d,f]=N.useState(null),[m,p]=N.useState(!1),[v,x]=N.useState(!1),[_,E]=N.useState("followers"),k=(e==null?void 0:e.uid)===t,{uploadImage:b}=o2(),{isFollowing:S,toggleFollow:C}=Y6(e==null?void 0:e.uid,n),{stats:P}=Lce(t),R=(ue="followers")=>{E(ue),x(!0)},I=async()=>{try{const ue=ke(Y,Le(t).userPublicProfile),ve=await ki(ue);if(ve.exists())a(ve.data());else{const ae=ke(Y,Le(t).userProfile),H=await ki(ae);H.exists()?a(H.data()):f("Profile not found or is private.")}}catch(ue){console.error("Failed to load profile:",ue),f("Unable to load profile. Please try again later.")}finally{u(!1)}};N.useEffect(()=>{t&&I()},[t]);const j=async ue=>{const ve=ue.target.files[0];if(!(!ve||!k)){p(!0);try{const ae=await b(ve,`artifacts/${t}/images/banners`);ae&&(await ft(ke(Y,Le(t).userPublicProfile),{bannerURL:ae}),a(H=>({...H,bannerURL:ae})))}catch(ae){console.error("Banner upload failed:",ae),alert("Failed to upload banner.")}p(!1)}};if(!t)return null;const O=()=>o.jsxs("div",{className:"p-8 flex flex-col items-center space-y-6 animate-pulse",children:[o.jsx("div",{className:"h-40 w-full bg-gray-200 dark:bg-gray-700 rounded-xl"}),o.jsx("div",{className:"h-28 w-28 bg-gray-300 dark:bg-gray-600 rounded-full -mt-20 border-4 border-white dark:border-dark-card"}),o.jsx("div",{className:"h-6 w-1/2 bg-gray-200 dark:bg-gray-700 rounded"}),o.jsx("div",{className:"h-4 w-1/3 bg-gray-200 dark:bg-gray-700 rounded"})]});return o.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:[o.jsxs("div",{className:"bg-white dark:bg-[#1f2128] w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] border border-gray-200 dark:border-gray-700",onClick:ue=>ue.stopPropagation(),children:[o.jsx("button",{onClick:r,className:"absolute top-4 right-4 z-30 p-2 bg-black/30 hover:bg-black/50 text-white rounded-full transition-colors backdrop-blur-md",children:o.jsx(ut,{size:20})}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar relative",children:l?o.jsx(O,{}):d||!i?o.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-12 text-gray-500",children:[o.jsx(kl,{size:48,className:"text-yellow-500 mb-4 opacity-80"}),o.jsx("h3",{className:"text-xl font-bold dark:text-gray-200 mb-2",children:"Profile Unavailable"}),o.jsx("p",{className:"text-sm text-center max-w-xs",children:d||"This user's profile information could not be retrieved."}),o.jsx("button",{onClick:r,className:"mt-6 px-6 py-2 bg-gray-200 dark:bg-gray-700 rounded-full font-bold text-sm hover:bg-gray-300 transition",children:"Close"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"h-48 relative bg-gray-800 group",children:[i.bannerURL?o.jsx("img",{src:i.bannerURL,alt:"Cover",className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full bg-gradient-to-r from-brand-blue to-purple-600",children:o.jsx("div",{className:"absolute inset-0 opacity-30 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"})}),k&&o.jsxs("label",{className:"absolute top-4 left-4 cursor-pointer bg-black/40 hover:bg-black/60 text-white px-3 py-1.5 rounded-lg text-xs font-bold backdrop-blur-md transition-all flex items-center gap-2 border border-white/10",children:[m?o.jsx(Ye,{size:14,className:"animate-spin"}):o.jsx(mb,{size:14}),m?"Uploading...":"Edit Cover",o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:j,disabled:m})]}),o.jsxs("div",{className:"absolute bottom-4 right-6 flex gap-3 opacity-90",children:[i.rate>0&&o.jsxs("span",{className:"bg-black/60 backdrop-blur-md text-white text-xs font-bold px-3 py-1 rounded-full border border-white/10 flex items-center gap-1 shadow-sm",children:[o.jsx(js,{size:12})," $",i.rate,"/hr"]}),i.city&&o.jsxs("span",{className:"bg-black/60 backdrop-blur-md text-white text-xs font-bold px-3 py-1 rounded-full border border-white/10 flex items-center gap-1 shadow-sm",children:[o.jsx(cr,{size:12})," ",i.city,", ",i.state]})]})]}),o.jsxs("div",{className:"px-8 pb-8 relative",children:[o.jsxs("div",{className:"flex justify-between items-end -mt-14 mb-6",children:[o.jsx("div",{className:"relative z-10 group",children:o.jsx("div",{className:"h-32 w-32 rounded-full border-[5px] border-white dark:border-[#1f2128] bg-gray-200 dark:bg-gray-700 overflow-hidden shadow-xl",children:i.photoURL?o.jsx("img",{src:i.photoURL,alt:"Profile",className:"h-full w-full object-cover"}):o.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400",children:o.jsx(wr,{size:48})})})}),e&&!k&&o.jsxs("div",{className:"flex gap-2 mb-2",children:[o.jsx(YE,{isFollowing:S(t),onToggle:()=>{var ue;return C(t,{displayName:`${i.firstName||""} ${i.lastName||""}`.trim(),photoURL:i.photoURL,role:((ue=i.accountTypes)==null?void 0:ue[0])||"User"})},size:"md"}),o.jsxs("button",{onClick:()=>s(t,`${i.firstName} ${i.lastName}`),className:"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 px-5 py-2.5 rounded-xl font-bold text-sm hover:bg-gray-200 dark:hover:bg-gray-700 transition flex items-center gap-2 border dark:border-gray-700",children:[o.jsx(ou,{size:18})," Message"]})]}),k&&o.jsx("div",{className:"mb-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs font-bold rounded-lg border border-green-200 dark:border-green-800",children:"Public View Mode"})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("h1",{className:"text-3xl font-extrabold dark:text-white flex items-center gap-2 mb-2",children:[i.firstName||"User"," ",i.lastName||"",i.isVerified&&o.jsx(uo,{size:22,className:"text-blue-500 fill-blue-500 text-white"})]}),o.jsx("div",{className:"flex flex-wrap gap-2 text-sm text-gray-500 dark:text-gray-400 font-medium mb-4",children:(i.accountTypes||["Creative"]).map((ue,ve)=>o.jsx("span",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full text-xs font-bold",children:ue},ve))}),o.jsx(Bde,{followersCount:P.followersCount||0,followingCount:P.followingCount||0,onFollowersClick:()=>R("followers"),onFollowingClick:()=>R("following"),size:"md"})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 py-6 border-y dark:border-gray-800 mb-8",children:[o.jsxs("div",{className:"text-center md:text-left",children:[o.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Rating"}),o.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-1",children:[o.jsx("span",{className:"text-xl font-bold dark:text-white",children:i.rating||"New"}),i.rating>0&&o.jsx(Vde,{rating:i.rating,size:14})]})]}),o.jsxs("div",{className:"text-center md:text-left",children:[o.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Experience"}),o.jsxs("div",{className:"text-xl font-bold dark:text-white",children:[i.yearsExp||"1+"," ",o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Yrs"})]})]}),o.jsxs("div",{className:"text-center md:text-left",children:[o.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Response"}),o.jsxs("div",{className:"text-xl font-bold dark:text-white",children:["~1 ",o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Hr"})]})]}),o.jsxs("div",{className:"text-center md:text-left",children:[o.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Bookings"}),o.jsx("div",{className:"text-xl font-bold dark:text-white",children:i.completedJobs||0})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[o.jsx(wr,{size:14})," About"]}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#252830] p-5 rounded-xl border dark:border-gray-800",children:o.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-sm whitespace-pre-line",children:i.bio||"No biography provided yet."})})]}),(((V=i.genres)==null?void 0:V.length)>0||((z=i.instruments)==null?void 0:z.length)>0)&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[o.jsx(co,{size:14})," Sound Profile"]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[(D=i.genres)==null?void 0:D.map(ue=>o.jsx("span",{className:"px-3 py-1.5 bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300 rounded-lg text-xs font-bold border border-purple-100 dark:border-purple-800",children:ue},ue)),(F=i.instruments)==null?void 0:F.map(ue=>o.jsx("span",{className:"px-3 py-1.5 bg-blue-50 dark:bg-blue-900/20 text-brand-blue dark:text-blue-300 rounded-lg text-xs font-bold border border-blue-100 dark:border-blue-800",children:ue},ue))]})]}),((ee=i.equipmentList)==null?void 0:ee.length)>0&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[o.jsx(ao,{size:14})," Select Gear"]}),o.jsxs("div",{className:"bg-gray-50 dark:bg-[#252830] rounded-xl p-4 border dark:border-gray-800",children:[o.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm text-gray-600 dark:text-gray-400",children:i.equipmentList.slice(0,10).map((ue,ve)=>o.jsxs("li",{className:"flex items-start gap-2",children:[o.jsx(kr,{size:14,className:"text-brand-blue shrink-0 mt-0.5"}),o.jsx("span",{className:"truncate",children:ue})]},ve))}),i.equipmentList.length>10&&o.jsx("div",{className:"mt-3 pt-3 border-t dark:border-gray-700 text-center",children:o.jsxs("span",{className:"text-xs text-gray-400 font-medium italic",children:["+",i.equipmentList.length-10," more items available"]})})]})]})]})]})})]}),v&&o.jsx(Fde,{userId:t,userName:`${(i==null?void 0:i.firstName)||""} ${(i==null?void 0:i.lastName)||""}`.trim()||"User",initialTab:_,currentUser:e,currentUserData:n,isFollowing:S,toggleFollow:C,onClose:()=>x(!1),openPublicProfile:ue=>{x(!1)}})]})}function Ude({user:t}){const[e,n]=N.useState([]),[r,s]=N.useState("All");return N.useEffect(()=>{const i=mt(Ce(Y,`artifacts/${qe}/public/data/service_requests`),_n("timestamp","desc"),fs(50)),a=Qt(i,l=>n(l.docs.map(u=>({id:u.id,...u.data()}))));return()=>a()},[]),o.jsxs("div",{className:"animate-in fade-in",children:[o.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 scrollbar-hide mb-2",children:[o.jsx("button",{onClick:()=>s("All"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap border transition ${r==="All"?"bg-orange-500 text-white border-orange-600":"bg-white dark:bg-dark-card border-gray-200 dark:border-gray-700 dark:text-gray-300"}`,children:"All Jobs"}),ev.map(i=>o.jsx("button",{onClick:()=>s(i.label),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap border transition ${r===i.label?"bg-orange-500 text-white border-orange-600":"bg-white dark:bg-dark-card border-gray-200 dark:border-gray-700 dark:text-gray-300"}`,children:i.label},i.id))]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.filter(i=>r==="All"||i.category===r).map(i=>o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 hover:border-orange-400 transition shadow-sm group",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("span",{className:"text-[10px] font-bold uppercase text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/20 px-2 py-0.5 rounded",children:i.category}),i.budget&&o.jsxs("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:["$",i.budget]})]}),o.jsx("h3",{className:"font-bold text-lg dark:text-white mb-1",children:i.topic}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-2 mb-4",children:i.description}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 border-t dark:border-gray-700 pt-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(wr,{size:12})," ",i.userName]}),i.userId!==t.uid&&o.jsxs("button",{className:"bg-gray-900 dark:bg-white dark:text-black text-white px-3 py-1.5 rounded font-bold hover:opacity-80 flex items-center gap-1",children:[o.jsx(ou,{size:12})," Message"]})]})]},i.id)),e.length===0&&o.jsx("div",{className:"col-span-full text-center py-12 text-gray-400",children:"No active requests."})]})]})}function qde({user:t,userData:e,target:n,onClose:r}){const[s,i]=N.useState(!1),[a,l]=N.useState({serviceCategory:"Repair",equipmentName:"",issueDescription:"",logistics:"Drop-off",preferredDate:"",budgetCap:""}),[u,d]=N.useState([]),{uploadMedia:f,uploading:m}=ha(),p=async x=>{const _=x.target.files[0];if(!_)return;const E=await f(_,`tech_requests/${t.uid}`);E&&d(k=>[...k,E])},v=async()=>{if(!a.equipmentName||!a.issueDescription)return alert("Please describe the equipment and the issue.");i(!0);try{await Gt(Ce(Y,`artifacts/${qe}/public/data/bookings`),{senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,targetId:n.id,targetName:n.firstName?`${n.firstName} ${n.lastName}`:n.name,type:"TechRequest",serviceType:a.serviceCategory,equipment:a.equipmentName,description:a.issueDescription,logistics:a.logistics,budgetCap:a.budgetCap,status:"Pending",date:a.preferredDate||"Flexible",message:`[${a.serviceCategory}] ${a.equipmentName}: ${a.issueDescription}`,attachments:u,timestamp:jt()}),alert("Service request sent!"),r()}catch{alert("Failed to send.")}i(!1)};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4 animate-in fade-in zoom-in-95",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700 flex flex-col max-h-[90vh]",children:[o.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white flex items-center gap-2",children:[o.jsx(Hh,{size:18,className:"text-orange-500"})," Service Request"]}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Hiring ",o.jsxs("span",{className:"font-bold text-orange-600 dark:text-orange-400",children:[n.firstName," ",n.lastName]})]})]}),o.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:o.jsx(ut,{size:20})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Type"}),o.jsx("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:a.serviceCategory,onChange:x=>l({...a,serviceCategory:x.target.value}),children:ev.map(x=>o.jsx("option",{value:x.label,children:x.label},x.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Logistics"}),o.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:a.logistics,onChange:x=>l({...a,logistics:x.target.value}),children:[o.jsx("option",{value:"Drop-off",children:"I will drop it off"}),o.jsx("option",{value:"On-site",children:"Tech comes to me"}),o.jsx("option",{value:"Ship",children:"I will ship it"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Equipment"}),o.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"e.g. Fender Twin Reverb",value:a.equipmentName,onChange:x=>l({...a,equipmentName:x.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Issue Description"}),o.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px] text-sm",placeholder:"Describe symptoms...",value:a.issueDescription,onChange:x=>l({...a,issueDescription:x.target.value})})]}),o.jsxs("div",{className:"pt-4 border-t dark:border-gray-700",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-brand-blue hover:text-blue-600 font-bold mb-3",children:[o.jsx(ku,{size:16})," Add Video/Photo ",o.jsx("input",{type:"file",className:"hidden",accept:"image/*,video/*",onChange:p,disabled:m})]}),o.jsx("div",{className:"flex gap-2 overflow-x-auto",children:u.map((x,_)=>o.jsx("div",{className:"h-12 w-12 bg-black rounded border dark:border-gray-600 overflow-hidden",children:o.jsx("img",{src:x.url,className:"h-full w-full object-cover"})},_))})]})]}),o.jsx("div",{className:"p-5 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:o.jsx("button",{onClick:v,disabled:s||m,className:"w-full bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition shadow-lg",children:s?o.jsx(Ye,{className:"animate-spin mx-auto"}):"Submit Request"})})]})})}function Wde({user:t,userData:e,openPublicProfile:n}){const[r,s]=N.useState([]),[i,a]=N.useState(!1),[l,u]=N.useState(""),[d,f]=N.useState(""),[m,p]=N.useState(null),v=async()=>{a(!0);try{const x=[zt("accountTypes","array-contains","Technician"),fs(20)];l&&x.push(zt("searchTerms","array-contains",l.toLowerCase()));const _=mt(Zc(Y,"public_profile"),...x);let k=(await Pt(_)).docs.map(b=>({id:b.ref.parent.parent.id,...b.data()})).filter(b=>b.id!==t.uid);d&&(k=k.filter(b=>b.subRoles&&b.subRoles.includes(d))),s(k)}catch(x){console.error(x)}a(!1)};return N.useEffect(()=>{v()},[d]),o.jsxs("div",{className:"animate-in fade-in",children:[o.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(ur,{className:"absolute left-4 top-3.5 text-gray-400",size:18}),o.jsx("input",{className:"w-full pl-12 p-3 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-orange-500 dark:text-white",placeholder:"Search technicians...",value:l,onChange:x=>u(x.target.value),onKeyDown:x=>x.key==="Enter"&&v()})]}),o.jsx("div",{className:"md:w-1/3",children:o.jsxs("select",{className:"w-full p-3 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-orange-500 dark:text-white cursor-pointer",value:d,onChange:x=>f(x.target.value),children:[o.jsx("option",{value:"",children:"All Specialties"}),P6.map(x=>o.jsx("option",{value:x,children:x},x))]})})]}),i?o.jsx("div",{className:"text-center py-12",children:o.jsx(Ye,{className:"animate-spin mx-auto text-orange-500"})}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(x=>{var _,E,k;return o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden shadow-sm hover:shadow-lg transition group",children:[o.jsx("div",{className:"h-24 bg-gradient-to-r from-slate-700 to-slate-600 relative",children:o.jsx("div",{className:"absolute -bottom-8 left-6",children:o.jsx("div",{className:"h-16 w-16 rounded-full border-4 border-white dark:border-[#2c2e36] bg-gray-200 overflow-hidden",children:x.photoURL?o.jsx("img",{src:x.photoURL,className:"h-full w-full object-cover"}):o.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:o.jsx(wr,{})})})})}),o.jsxs("div",{className:"pt-10 px-6 pb-6",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold dark:text-white text-lg",children:[x.firstName," ",x.lastName]}),o.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400 font-bold mb-2 flex items-center gap-1",children:[o.jsx(ao,{size:12})," ",((_=x.subRoles)==null?void 0:_[0])||"Technician"]})]}),x.rate>0&&o.jsxs("div",{className:"text-sm font-bold dark:text-gray-300 border border-gray-200 dark:border-gray-600 px-2 py-1 rounded-lg",children:["$",x.rate,"/hr"]})]}),o.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:(E=x.subRoles)==null?void 0:E.slice(0,3).map(b=>o.jsx("span",{className:"text-[10px] bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-200 px-2 py-0.5 rounded border border-orange-200 dark:border-orange-800",children:b},b))}),o.jsx("div",{className:"flex flex-wrap gap-1 mb-4 h-6 overflow-hidden",children:(((k=x.skills)==null?void 0:k.split(","))||[]).slice(0,3).map((b,S)=>o.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 pr-2 border-r border-gray-300 dark:border-gray-600 last:border-0",children:b.trim()},S))}),o.jsxs("div",{className:"flex gap-2 mt-auto",children:[o.jsx("button",{onClick:()=>n(x.id),className:"flex-1 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg text-xs font-bold transition",children:"Profile"}),o.jsxs("button",{onClick:()=>p(x),className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg text-xs font-bold transition shadow-sm flex items-center justify-center gap-1",children:[o.jsx(Hh,{size:14})," Request"]})]})]})]},x.id)})}),m&&o.jsx(qde,{user:t,userData:e,target:m,onClose:()=>p(null)})]})}function Hde({user:t,userData:e,onSuccess:n,onCancel:r}){const[s,i]=N.useState(ev[0].label),[a,l]=N.useState(""),[u,d]=N.useState("Normal"),[f,m]=N.useState(""),[p,v]=N.useState(""),[x,_]=N.useState(!1),[E,k]=N.useState(null),{uploadMedia:b,uploading:S}=ha(),C=async R=>{const I=R.target.files[0];if(!I)return;const j=await b(I,`service_requests/${t.uid}`);j&&k(j)},P=async()=>{if(!a||!p)return alert("Please complete the request.");_(!0);try{await Gt(Ce(Y,`artifacts/${qe}/public/data/service_requests`),{topic:`${s} for ${a}`,category:s,equipment:a,urgency:u,budget:f?parseInt(f):null,description:p,userId:t.uid,userName:`${e.firstName} ${e.lastName}`,status:"Open",timestamp:jt(),attachment:E||null}),alert("Tech Request Broadcasted!"),n()}catch(R){console.error(R),alert("Failed.")}_(!1)};return o.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-8 rounded-2xl border border-orange-200 dark:border-gray-700 shadow-xl animate-in zoom-in-95",children:[o.jsxs("h2",{className:"text-2xl font-extrabold dark:text-white mb-6 flex items-center gap-2 text-orange-600",children:[o.jsx(ps,{})," Broadcast Tech Need"]}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"p-6 bg-orange-50 dark:bg-gray-800 rounded-xl border border-orange-100 dark:border-gray-700",children:o.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-lg font-medium text-gray-700 dark:text-gray-200",children:[o.jsx("span",{children:"I need"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:s,onChange:R=>i(R.target.value),className:"appearance-none bg-white dark:bg-gray-700 border border-orange-300 dark:border-orange-700 rounded-lg py-1 pl-3 pr-8 font-bold text-orange-700 dark:text-white focus:outline-none",children:ev.map(R=>o.jsx("option",{value:R.label,children:R.label},R.id))}),o.jsx(Td,{size:14,className:"absolute right-2 top-1/2 -translate-y-1/2 text-orange-500 dark:text-white pointer-events-none"})]}),o.jsx("span",{children:"for my"}),o.jsx("input",{className:"bg-transparent border-b-2 border-orange-300 dark:border-orange-700 text-center w-40 font-bold focus:outline-none focus:border-orange-500 dark:text-white",placeholder:"Equipment Name",value:a,onChange:R=>l(R.target.value)})]})}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Urgency"}),o.jsxs("select",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:u,onChange:R=>d(R.target.value),children:[o.jsx("option",{children:"Normal"}),o.jsx("option",{children:"High (Session Blocked)"}),o.jsx("option",{children:"Emergency (24h)"}),o.jsx("option",{children:"Flexible"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Est. Budget ($)"}),o.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Optional",value:f,onChange:R=>m(R.target.value)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Details"}),o.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Describe the issue, specific model, symptoms...",value:p,onChange:R=>v(R.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Visual Reference"}),!E&&!S&&o.jsxs("label",{className:"flex items-center justify-center gap-2 w-full p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition text-gray-500",children:[o.jsx(ku,{size:20}),o.jsx("span",{className:"text-sm font-bold",children:"Upload Video or Image"}),o.jsx("input",{type:"file",className:"hidden",accept:"video/*,image/*",onChange:C})]}),E&&o.jsxs("div",{className:"relative w-full rounded-xl overflow-hidden border dark:border-gray-700 bg-black",children:[E.type==="video"?o.jsx("video",{src:E.url,controls:!0,className:"w-full h-48 object-contain"}):o.jsx("img",{src:E.url,className:"w-full h-48 object-contain"}),o.jsx("button",{onClick:()=>k(null),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:o.jsx(ut,{size:14})})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx("button",{onClick:r,className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition",children:"Cancel"}),o.jsx("button",{onClick:P,disabled:x||S,className:"flex-1 bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition flex items-center justify-center gap-2 disabled:opacity-50",children:x?o.jsx(Ye,{className:"animate-spin"}):"Broadcast Now"})]})]})]})}function Gde({user:t,isTech:e}){const[n,r]=N.useState("feed"),[s,i]=N.useState([]),[a,l]=N.useState(!0);N.useEffect(()=>{const d=mt(Ce(Y,Le(t.uid).equipmentSubmissions),zt("status","==","pending"),_n("timestamp","desc"),fs(20)),f=Qt(d,m=>{i(m.docs.map(p=>({id:p.id,...p.data()}))),l(!1)});return()=>f()},[t.uid]);const u=async(d,f,m)=>{var p,v,x,_,E,k;if(!e)return alert("Only verified Technicians can vote on gear accuracy.");try{const b=ke(Y,Le(t.uid).equipmentSubmissions,d),S=`votes.${f}`;await ft(b,{[S]:_p(t.uid)});const C=3,P=3,R=(((v=(p=m.votes)==null?void 0:p.yes)==null?void 0:v.length)||0)+(f==="yes"?1:0),I=(((_=(x=m.votes)==null?void 0:x.fake)==null?void 0:_.length)||0)+(f==="fake"?1:0),j=(((k=(E=m.votes)==null?void 0:E.duplicate)==null?void 0:k.length)||0)+(f==="duplicate"?1:0);if(R>=C){const O=ke(Y,`artifacts/${qe}/public/data/equipment_database/${m.category}/items`,m.model.replace(/\s+/g,"_"));await Ka(O,{name:m.model,brand:m.brand,category:m.category,subCategory:m.subCategory,specs:m.specs,verifiedBy:_p(t.uid),addedBy:m.submittedBy,addedAt:jt()}),await ft(b,{status:"approved"}),await ft(ke(Y,Le(m.submittedBy).userWallet),{balance:Ni(50)}),await ft(ke(Y,Le(t.uid).userWallet),{balance:Ni(5)}),alert("Consensus reached! Item approved and rewards distributed.")}else(I>=P||j>=P)&&await ft(b,{status:"rejected"})}catch(b){console.error("Voting failed:",b)}};return o.jsxs("div",{className:"animate-in fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(gne,{className:"text-orange-500"})," Gear Knowledge Base"]}),o.jsx("p",{className:"text-sm text-gray-500",children:"Crowdsourced equipment specs verified by pros."})]}),o.jsxs("div",{className:"flex gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[o.jsx("button",{onClick:()=>r("feed"),className:`px-4 py-2 rounded-md text-xs font-bold transition ${n==="feed"?"bg-white dark:bg-gray-600 shadow text-orange-600 dark:text-orange-400":"text-gray-500"}`,children:"The Bench (Queue)"}),o.jsx("button",{onClick:()=>r("submit"),className:`px-4 py-2 rounded-md text-xs font-bold transition ${n==="submit"?"bg-white dark:bg-gray-600 shadow text-orange-600 dark:text-orange-400":"text-gray-500"}`,children:"Submit New Gear"})]})]}),n==="feed"&&o.jsx("div",{className:"grid grid-cols-1 gap-4",children:a?o.jsx("div",{className:"p-10 text-center",children:o.jsx(Ye,{className:"animate-spin mx-auto"})}):s.length===0?o.jsxs("div",{className:"text-center py-12 border-2 border-dashed dark:border-gray-700 rounded-xl",children:[o.jsx(kr,{size:48,className:"mx-auto text-green-500 mb-2 opacity-50"}),o.jsx("p",{className:"text-gray-500",children:"The bench is clear. No pending submissions."})]}):s.map(d=>{var f,m,p,v,x,_,E,k,b,S,C,P,R;return o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row gap-6",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"text-[10px] font-bold uppercase bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-gray-500",children:d.brand}),o.jsx("span",{className:"text-[10px] font-bold uppercase bg-blue-50 dark:bg-blue-900/20 text-blue-600 px-2 py-0.5 rounded",children:(f=d.category)==null?void 0:f.replace(/_/g," ")})]}),o.jsx("h4",{className:"text-lg font-extrabold dark:text-white mb-2",children:d.model}),o.jsx("div",{className:"bg-gray-50 dark:bg-black/20 p-3 rounded-lg text-sm text-gray-600 dark:text-gray-300 mb-2 border dark:border-gray-700",children:d.specs}),o.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[o.jsx(wr,{size:12})," Submitted by ",d.submitterName||"Unknown","  50 TK Reward Pending"]})]}),o.jsxs("div",{className:"w-full md:w-48 flex flex-col justify-center gap-2 border-l dark:border-gray-700 pl-0 md:pl-6",children:[o.jsxs("button",{onClick:()=>u(d.id,"yes",d),disabled:(p=(m=d.votes)==null?void 0:m.yes)==null?void 0:p.includes(t.uid),className:"w-full py-2 bg-green-100 dark:bg-green-900/20 hover:bg-green-200 text-green-700 dark:text-green-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[o.jsx(Pne,{size:14})," Yes (",((x=(v=d.votes)==null?void 0:v.yes)==null?void 0:x.length)||0,")"]}),o.jsxs("button",{onClick:()=>u(d.id,"fake",d),disabled:(E=(_=d.votes)==null?void 0:_.fake)==null?void 0:E.includes(t.uid),className:"w-full py-2 bg-red-100 dark:bg-red-900/20 hover:bg-red-200 text-red-700 dark:text-red-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[o.jsx(Rne,{size:14})," Fake (",((b=(k=d.votes)==null?void 0:k.fake)==null?void 0:b.length)||0,")"]}),o.jsxs("button",{onClick:()=>u(d.id,"duplicate",d),disabled:(C=(S=d.votes)==null?void 0:S.duplicate)==null?void 0:C.includes(t.uid),className:"w-full py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 text-gray-600 dark:text-gray-300 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[o.jsx(oE,{size:14})," Dup (",((R=(P=d.votes)==null?void 0:P.duplicate)==null?void 0:R.length)||0,")"]})]})]},d.id)})}),n==="submit"&&o.jsx(Kde,{user:t,userData,onSuccess:()=>r("feed")})]})}function Kde({user:t,userData:e,onSuccess:n}){const[r,s]=N.useState({brand:"",model:"",category:zp[0].id,subCategory:"",specs:""}),[i,a]=N.useState(!1),l=async()=>{if(!r.brand||!r.model||!r.specs)return alert("All fields required.");a(!0);try{await Gt(Ce(Y,Le(t.uid).equipmentSubmissions),{...r,submittedBy:t.uid,submitterName:`${e.firstName} ${e.lastName}`,status:"pending",timestamp:jt(),votes:{yes:[],fake:[],duplicate:[]}}),alert("Submission Received! You'll earn 50 TK once verified."),n()}catch(u){console.error(u),alert("Submission failed.")}a(!1)};return o.jsxs("div",{className:"max-w-xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border border-orange-200 dark:border-gray-700 shadow-lg",children:[o.jsx("h4",{className:"font-bold text-lg dark:text-white mb-4",children:"Submit New Equipment"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Category"}),o.jsx("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:r.category,onChange:u=>s({...r,category:u.target.value}),children:zp.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Sub-Category"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. Compressor",value:r.subCategory,onChange:u=>s({...r,subCategory:u.target.value})})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Brand"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. Neve",value:r.brand,onChange:u=>s({...r,brand:u.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Model"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. 1073LB",value:r.model,onChange:u=>s({...r,model:u.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Specs / Description"}),o.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm h-24",placeholder:"Brief technical specs...",value:r.specs,onChange:u=>s({...r,specs:u.target.value})})]}),o.jsx("button",{onClick:l,disabled:i,className:"w-full bg-orange-600 text-white py-2.5 rounded-lg font-bold hover:bg-orange-700 flex items-center justify-center gap-2",children:i?o.jsx(Ye,{className:"animate-spin"}):"Submit for Verification"})]})]})}function Qde({user:t}){const[e,n]=N.useState({skills:"",rate:"",serviceRadius:"",subRoles:[]}),[r,s]=N.useState(!0);N.useEffect(()=>{ki(ke(Y,Le(t.uid).userSubProfile("Technician"))).then(a=>{a.exists()&&n(a.data()),s(!1)})},[t.uid]);const i=async()=>{try{await ft(ke(Y,Le(t.uid).userSubProfile("Technician")),e);const a=[...e.skills?e.skills.toLowerCase().split(",").map(l=>l.trim()):[],...e.subRoles?e.subRoles.map(l=>l.toLowerCase()):[]];await ft(ke(Y,Le(t.uid).userPublicProfile),{rate:parseInt(e.rate)||0,subRoles:e.subRoles||[],searchTerms:a}),alert("Tech Profile Updated Successfully")}catch{alert("Update failed")}};return r?o.jsx("div",{className:"p-10 text-center",children:o.jsx(Ye,{className:"animate-spin mx-auto"})}):o.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm animate-in fade-in",children:[o.jsx("h3",{className:"font-bold text-lg dark:text-white mb-6 border-b dark:border-gray-700 pb-2",children:"Your Technician Settings"}),o.jsxs("div",{className:"space-y-5",children:[o.jsx(XE,{label:"Primary Specialties",fieldKey:"subRoles",options:P6,initialValues:e.subRoles,onChange:(a,l)=>n(u=>({...u,[a]:l}))}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Detailed Skills (Comma Separated)"}),o.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:e.skills||"",onChange:a=>n({...e,skills:a.target.value}),placeholder:"e.g. SSL 4000 Maintenance, Tube Bias..."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Hourly Rate ($)"}),o.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:e.rate||"",onChange:a=>n({...e,rate:a.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Radius (Miles)"}),o.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:e.serviceRadius||"",onChange:a=>n({...e,serviceRadius:a.target.value})})]})]}),o.jsx("div",{className:"pt-4",children:o.jsxs("button",{onClick:i,className:"w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 flex items-center justify-center gap-2",children:[o.jsx(_u,{size:18})," Save Changes"]})})]})]})}function Zde({user:t,userData:e,openPublicProfile:n}){var a;const[r,s]=N.useState("board"),i=(a=e==null?void 0:e.accountTypes)==null?void 0:a.includes("Technician");return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 pb-20",children:[o.jsxs("div",{className:"bg-gradient-to-r from-orange-900 to-slate-900 p-8 rounded-2xl text-white shadow-xl relative overflow-hidden flex flex-col md:flex-row justify-between items-end",children:[o.jsxs("div",{className:"relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-2 text-orange-400 font-bold uppercase tracking-widest text-xs mb-2",children:[o.jsx(Hh,{size:14})," SeshNx Technical"]}),o.jsx("h1",{className:"text-3xl font-extrabold mb-2",children:"Studio Tech Services"}),o.jsx("p",{className:"text-slate-300 max-w-lg",children:"Hire professionals for equipment repair, studio wiring, and acoustic calibration."})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 relative z-10 mt-4 md:mt-0",children:[o.jsx("button",{onClick:()=>s("board"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="board"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Job Board"}),o.jsx("button",{onClick:()=>s("directory"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="directory"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Find a Tech"}),o.jsx("button",{onClick:()=>s("broadcast"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="broadcast"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Post Request"}),o.jsx("button",{onClick:()=>s("database"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="database"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Gear DB"}),i&&o.jsx("button",{onClick:()=>s("profile"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="profile"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Tech Portal"})]}),o.jsx(wu,{size:200,className:"absolute -right-10 -top-10 text-white opacity-5 rotate-12 pointer-events-none"})]}),o.jsxs("div",{className:"min-h-[400px]",children:[r==="board"&&o.jsx(Ude,{user:t}),r==="directory"&&o.jsx(Wde,{user:t,userData:e,openPublicProfile:n}),r==="broadcast"&&o.jsx(Hde,{user:t,userData:e,onSuccess:()=>s("board"),onCancel:()=>s("board")}),r==="database"&&o.jsx(Gde,{user:t,isTech:i}),r==="profile"&&i&&o.jsx(Qde,{user:t})]})]})}const Yde=()=>{const[t,e]=N.useState({tierData:null,tokenPackages:null}),[n,r]=N.useState(!0),{DEFAULT_TIER_DATA:s,FALLBACK_TOKEN_PACKAGES:i}=N.useMemo(()=>({DEFAULT_TIER_DATA:{FREE:{name:"Free",price:0,feeMultiplier:1.2,features:["1 Broadcast Request / month","Cannot list on SeshFx Market"],limits:{broadcastsPerMonth:1,sessionsPerWeek:2,canListMarket:!1,monthlyTokens:0}},BASIC:{name:"Basic",price:4.99,feeMultiplier:1.1,features:["3 Broadcast Requests / month","10 Booked Sessions / week","Can list on SeshFx Market (5 items)"],limits:{broadcastsPerMonth:3,sessionsPerWeek:10,canListMarket:!0,monthlyTokens:25}},PRO:{name:"Pro Creative",price:14.99,feeMultiplier:1.02,features:["15 Broadcast Requests / month","Unlimited Booked Sessions","Profile Search Boost"],limits:{broadcastsPerMonth:15,sessionsPerWeek:999,canListMarket:!0,monthlyTokens:100}},STUDIO:{name:"Studio Business",price:29.99,feeMultiplier:1,features:["Studio Manager Component Access","Unlimited Broadcast Requests","0% Session Fees"],limits:{broadcastsPerMonth:999,sessionsPerWeek:999,canListMarket:!0,monthlyTokens:100}}},FALLBACK_TOKEN_PACKAGES:[{id:"pack_small",tokens:100,price:4.99,label:"Starter Stash"},{id:"pack_medium",tokens:550,price:19.99,label:"Producer Pack",highlight:!0},{id:"pack_large",tokens:1200,price:39.99,label:"Studio Vault"}]}),[]);N.useEffect(()=>{const l=ke(Y,"artifacts",qe,"public","config","subscriptions","tier_config"),u=Qt(l,m=>{let p=m.exists()?m.data():{};const v=Object.keys(s).reduce((x,_)=>(x[_]={...s[_],...p[_]},x),{});e(x=>({...x,tierData:v}))}),d=ke(Y,"artifacts",qe,"public","config","subscriptions","token_packages"),f=Qt(d,m=>{let p=m.exists()?Object.values(m.data()):i;(!Array.isArray(p)||p.length===0)&&(p=i),e(v=>({...v,tokenPackages:p}))});return r(!1),()=>{u(),f()}},[s,i]);const a=l=>{var d,f;const u=((d=t.tierData)==null?void 0:d[l])||((f=t.tierData)==null?void 0:f.FREE);return u?u.feeMultiplier:s.FREE.feeMultiplier};return{tierData:t.tierData||s,tokenPackages:t.tokenPackages||i,loading:n,getFeeMultiplier:a}};var kz="https://js.stripe.com/v3",Xde=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var Jde=function(){for(var e=document.querySelectorAll('script[src^="'.concat(kz,'"]')),n=0;n<e.length;n++){var r=e[n];if(Xde.test(r.src))return r}return null},qP=function(e){var n="",r=document.createElement("script");r.src="".concat(kz).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},Qf=null,Hy=null,Gy=null,ehe=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},the=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},nhe=function(e){return Qf!==null?Qf:(Qf=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var s=Jde();if(!(s&&e)){if(!s)s=qP(e);else if(s&&Gy!==null&&Hy!==null){var i;s.removeEventListener("load",Gy),s.removeEventListener("error",Hy),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=qP(e)}}Gy=the(n,r),Hy=ehe(r),s.addEventListener("load",Gy),s.addEventListener("error",Hy)}catch(a){r(a);return}}),Qf.catch(function(n){return Qf=null,Promise.reject(n)}))},Zf,rhe=function(){return Zf||(Zf=nhe(null).catch(function(e){return Zf=null,Promise.reject(e)}),Zf)};Promise.resolve().then(function(){return rhe()}).catch(function(t){console.warn(t)});const she=async t=>{throw t<=0?new Error("No funds available to cash out."):new Error("Payout functionality is temporarily unavailable. Firebase Functions service is not configured.")};function ihe({user:t,userData:e}){var S;const[n,r]=N.useState("store"),[s,i]=N.useState({balance:0,escrowBalance:0,payoutBalance:0}),[a,l]=N.useState(!1),{tierData:u,tokenPackages:d,loading:f}=Yde(),m=(e==null?void 0:e.currentTier)||$le.FREE,p=(S=e==null?void 0:e.accountTypes)==null?void 0:S.some(C=>["Artist","Musician","Producer","Engineer","Studio","Composer","Technician","Label","Agent"].includes(C));N.useEffect(()=>{if(!(t!=null&&t.uid))return;const C=Qt(ke(Y,Le(t.uid).userWallet),P=>{if(P.exists()){const R=P.data();i({balance:R.balance||0,escrowBalance:R.escrowBalance||0,payoutBalance:R.payoutBalance||0})}});return()=>C()},[t.uid]);const v=async(C,P="payment")=>{l(!0);try{throw new Error("Checkout functionality is temporarily unavailable. Firebase Functions service is not configured.")}catch(R){console.error("Checkout Error:",R),alert(`Checkout failed: ${R.message}`)}finally{l(!1)}},x=C=>{if(!C.stripePriceId)return alert("Configuration Error: This package is missing a Stripe Price ID.");v(C.stripePriceId,"payment")},_=C=>{if(!C.stripePriceId)return alert("Configuration Error: This plan is missing a Stripe Price ID.");v(C.stripePriceId,"subscription")},E=async()=>{if(p){if(s.payoutBalance<=0)return alert("No funds available for cash out.");if(window.confirm(`Cash out $${s.payoutBalance.toFixed(2)} to your connected account?`)){l(!0);try{await she(s.payoutBalance),alert("Cash out initiated! Funds should arrive in your bank account shortly.")}catch(C){alert(C.message)}finally{l(!1)}}}},k=Object.values(u).sort((C,P)=>C.id===m?-1:P.id===m?1:C.price-P.price),b=C=>{const P=(C-1)*100;return P>0?`+${P.toFixed(0)}% Service Fee`:P===0?"0% Service Fee":`-${Math.abs(P).toFixed(0)}% Fee (Discount)`};return o.jsxs("div",{className:"max-w-6xl mx-auto p-4 pb-24",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-6",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-3xl font-extrabold dark:text-white flex items-center gap-2",children:[o.jsx(js,{size:32,className:"text-green-500"})," My Wallet"]}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage tokens, subscriptions, and earnings."})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] px-5 py-3 rounded-2xl border dark:border-gray-700 shadow-sm flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-full",children:o.jsx(ps,{fill:"currentColor",className:"text-yellow-500",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wide",children:"Spending Tokens"}),o.jsxs("div",{className:"font-mono font-extrabold text-xl dark:text-white leading-none",children:[s.balance.toLocaleString()," TK"]})]})]}),p&&o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] px-5 py-3 rounded-2xl border dark:border-gray-700 shadow-sm flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-green-500/10 rounded-full",children:o.jsx(js,{className:"text-green-500",size:20})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wide",children:"Available USD"}),o.jsxs("div",{className:"font-mono font-extrabold text-xl dark:text-white leading-none",children:["$",s.payoutBalance.toFixed(2)]})]})]})]})]}),o.jsxs("div",{className:"flex gap-4 border-b dark:border-gray-700 mb-8 overflow-x-auto",children:[o.jsx("button",{onClick:()=>r("store"),className:`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${n==="store"?"border-brand-blue text-brand-blue":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Token Store"}),o.jsx("button",{onClick:()=>r("plans"),className:`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${n==="plans"?"border-brand-blue text-brand-blue":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Membership Plans"}),p&&o.jsx("button",{onClick:()=>r("earnings"),className:`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${n==="earnings"?"border-brand-blue text-brand-blue":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Earnings & Escrow"})]}),n==="store"&&o.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[o.jsxs("div",{className:"bg-gradient-to-r from-brand-blue to-purple-600 rounded-2xl p-8 text-white shadow-lg relative overflow-hidden",children:[o.jsxs("div",{className:"relative z-10 max-w-lg",children:[o.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Power Up Your Creativity"}),o.jsx("p",{className:"opacity-90 mb-6",children:"Use tokens to buy beats, presets, booking requests, and more on the SeshFx Marketplace."})]}),o.jsx(ps,{size:200,className:"absolute -right-10 -bottom-20 text-white opacity-10 rotate-12 pointer-events-none"})]}),f?o.jsx("div",{className:"text-center py-20",children:o.jsx(Ye,{className:"animate-spin text-brand-blue mx-auto",size:32})}):o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(C=>o.jsxs("div",{className:`relative bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border transition-all duration-200 hover:-translate-y-1 hover:shadow-xl ${C.highlight?"border-yellow-500 ring-2 ring-yellow-500/20":"dark:border-gray-700"}`,children:[C.highlight&&o.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-yellow-500 text-black text-[10px] font-extrabold px-3 py-1 rounded-full tracking-wide shadow-sm",children:"BEST VALUE"}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs font-bold uppercase tracking-widest mb-2",children:C.label}),o.jsxs("div",{className:"text-5xl font-extrabold dark:text-white flex items-center justify-center gap-1",children:[C.tokens,o.jsx("span",{className:"text-lg font-medium text-gray-400",children:"TK"})]})]}),o.jsx("button",{onClick:()=>x(C),disabled:a,className:`w-full py-3 rounded-xl font-bold flex justify-center items-center gap-2 transition-all ${C.highlight?"bg-yellow-500 text-black hover:bg-yellow-400":"bg-gray-900 dark:bg-white text-white dark:text-black hover:opacity-90"}`,children:a?o.jsx(Ye,{className:"animate-spin",size:18}):`Buy for $${C.price}`})]},C.id))})]}),n==="plans"&&o.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[o.jsxs("div",{className:"text-center max-w-2xl mx-auto mb-8",children:[o.jsx("h3",{className:"text-2xl font-bold dark:text-white mb-2",children:"Upgrade Your Workflow"}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Unlock lower fees, unlimited bookings, and premium visibility."})]}),f?o.jsx("div",{className:"text-center py-10",children:o.jsx(Ye,{className:"animate-spin text-brand-blue mx-auto",size:24})}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:k.map(C=>{const P=C.id===m;return o.jsxs("div",{className:`bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border flex flex-col ${P?"border-brand-blue ring-1 ring-brand-blue":"dark:border-gray-700"} shadow-sm`,children:[P&&o.jsxs("div",{className:"text-xs font-bold text-brand-blue uppercase tracking-wide mb-2 flex items-center gap-1",children:[o.jsx(fE,{size:12,fill:"currentColor"})," Current Plan"]}),o.jsx("h3",{className:"text-xl font-bold dark:text-white mb-1",children:C.name}),o.jsxs("div",{className:"text-3xl font-extrabold mb-6 dark:text-white",children:["$",C.price,o.jsx("span",{className:"text-sm font-normal text-gray-500",children:"/mo"})]}),o.jsxs("div",{className:"space-y-3 mb-8 flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-gray-700 dark:text-gray-200",children:[o.jsx(js,{size:16,className:C.feeMultiplier<=1?"text-green-500":"text-gray-400"}),b(C.feeMultiplier)]}),C.features.map((R,I)=>o.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-600 dark:text-gray-400",children:[o.jsx(Cs,{size:14,className:"text-green-500 shrink-0 mt-0.5"}),o.jsx("span",{children:R})]},I))]}),o.jsx("button",{onClick:()=>_(C),className:`w-full py-2.5 rounded-lg font-bold text-sm transition-colors mt-auto ${P?"bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-default":"bg-brand-blue text-white hover:bg-blue-600 shadow-lg shadow-blue-500/20"}`,disabled:P||a,children:P?"Active":a?o.jsx(Ye,{className:"animate-spin mx-auto"}):"Upgrade"})]},C.id)})})]}),n==="earnings"&&p&&o.jsx("div",{className:"space-y-6 animate-in fade-in duration-300",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm relative overflow-hidden",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-lg",children:o.jsx(Vl,{size:24})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold dark:text-white",children:"Escrow Balance"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Funds held for active sessions"})]})]}),o.jsxs("div",{className:"text-4xl font-extrabold dark:text-white mb-4",children:["$",s.escrowBalance.toLocaleString(void 0,{minimumFractionDigits:2})]}),o.jsxs("div",{className:"text-xs bg-orange-50 dark:bg-orange-900/10 text-orange-700 dark:text-orange-300 p-3 rounded-lg flex items-start gap-2",children:[o.jsx(da,{size:14,className:"mt-0.5 shrink-0"}),' Funds are released to "Available" 24 hours after a session is successfully completed.']})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border border-green-500/30 shadow-lg relative overflow-hidden",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-lg",children:o.jsx(js,{size:24})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold dark:text-white",children:"Available for Payout"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Cleared funds ready to transfer"})]})]}),o.jsxs("div",{className:"text-4xl font-extrabold text-green-600 dark:text-green-400 mb-6",children:["$",s.payoutBalance.toLocaleString(void 0,{minimumFractionDigits:2})]}),o.jsx("button",{onClick:E,disabled:a||s.payoutBalance<=0,className:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold shadow-lg hover:shadow-green-500/30 transition-all flex justify-center items-center gap-2 disabled:opacity-50 disabled:shadow-none",children:a?o.jsx(Ye,{className:"animate-spin",size:20}):o.jsxs(o.Fragment,{children:["Cash Out Now ",o.jsx(kx,{size:20})]})}),o.jsx("div",{className:"text-[10px] text-center text-gray-400 mt-3",children:"Transfers handled securely via Stripe Connect."})]})]})})]})}function ohe({user:t}){const[e,n]=N.useState([]),[r,s]=N.useState(""),[i,a]=N.useState([]),[l,u]=N.useState(!1),[d,f]=N.useState("list");N.useEffect(()=>{if(!(t!=null&&t.uid))return;const x=Ce(Y,Le(t.uid).labelRoster(t.uid)),_=Qt(x,E=>{n(E.docs.map(k=>({id:k.id,...k.data()})))});return()=>_()},[t==null?void 0:t.uid]);const m=async()=>{if(!(r.length<3)){u(!0);try{const x=mt(Zc(Y,"public_profile"),zt("searchTerms","array-contains",r.toLowerCase())),E=(await Pt(x)).docs.map(k=>({id:k.ref.parent.parent.id,...k.data()})).filter(k=>k.id!==t.uid&&!e.some(b=>b.artistId===k.id));a(E)}catch(x){console.error("Search failed:",x)}u(!1)}},p=async x=>{try{await Gt(Ce(Y,Le(t.uid).labelRoster(t.uid)),{artistId:x.id,name:`${x.firstName} ${x.lastName}`,email:x.email||"N/A",photoURL:x.photoURL||null,signedAt:jt(),status:"Active"}),alert(`Signed ${x.firstName} to roster!`),s(""),a([]),f("list")}catch(_){console.error("Signing failed:",_),alert("Failed to add artist.")}},v=async(x,_)=>{if(confirm(`Release ${_} from your roster?`))try{await Pi(ke(Y,Le(t.uid).labelRoster(t.uid),x))}catch(E){console.error(E)}};return o.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 animate-in fade-in pb-20",children:[o.jsxs("div",{className:"flex justify-between items-center bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(uo,{className:"text-purple-600"})," Label Management"]}),o.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your artist roster and bookings."})]}),o.jsx("button",{onClick:()=>f(d==="list"?"search":"list"),className:"bg-purple-600 text-white px-5 py-2.5 rounded-xl font-bold hover:bg-purple-700 transition flex items-center gap-2",children:d==="list"?o.jsxs(o.Fragment,{children:[o.jsx(Fl,{size:18})," Sign Artist"]}):"Back to Roster"})]}),d==="search"&&o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm animate-in slide-in-from-top-4",children:[o.jsx("h3",{className:"font-bold dark:text-white mb-4",children:"Find Talent"}),o.jsxs("div",{className:"flex gap-2 mb-6",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(ur,{className:"absolute left-3 top-3 text-gray-400",size:18}),o.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"Search by name...",value:r,onChange:x=>s(x.target.value),onKeyDown:x=>x.key==="Enter"&&m()})]}),o.jsx("button",{onClick:m,disabled:l,className:"bg-gray-900 dark:bg-white dark:text-black text-white px-6 rounded-xl font-bold",children:l?"...":"Search"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.map(x=>{var _;return o.jsxs("div",{className:"p-4 border dark:border-gray-700 rounded-xl flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden",children:x.photoURL?o.jsx("img",{src:x.photoURL,className:"h-full w-full object-cover"}):o.jsx(wr,{className:"m-2 text-gray-400"})}),o.jsxs("div",{children:[o.jsxs("div",{className:"font-bold dark:text-white text-sm",children:[x.firstName," ",x.lastName]}),o.jsx("div",{className:"text-xs text-gray-500",children:((_=x.accountTypes)==null?void 0:_[0])||"User"})]})]}),o.jsx("button",{onClick:()=>p(x),className:"text-xs bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-3 py-1.5 rounded-lg font-bold hover:bg-purple-200",children:"Sign"})]},x.id)}),i.length===0&&r&&!l&&o.jsx("div",{className:"col-span-full text-center text-gray-500 text-sm",children:"No artists found."})]})]}),d==="list"&&o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 overflow-hidden",children:[o.jsx("div",{className:"p-4 bg-gray-50 dark:bg-[#23262f] border-b dark:border-gray-700 flex justify-between items-center",children:o.jsxs("span",{className:"font-bold text-sm text-gray-500 uppercase tracking-wide",children:["Current Roster (",e.length,")"]})}),e.length===0?o.jsxs("div",{className:"p-12 text-center text-gray-500",children:[o.jsx(Gr,{size:48,className:"mx-auto mb-3 opacity-20"}),o.jsx("p",{children:"No artists signed yet."})]}):o.jsx("div",{className:"divide-y dark:divide-gray-700",children:e.map(x=>{var _;return o.jsxs("div",{className:"p-5 hover:bg-gray-50 dark:hover:bg-white/5 transition flex items-center justify-between group",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center text-indigo-600 font-bold text-lg overflow-hidden",children:x.photoURL?o.jsx("img",{src:x.photoURL,className:"h-full w-full object-cover"}):x.name[0]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold dark:text-white text-lg",children:x.name}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Signed: ",(_=x.signedAt)!=null&&_.toDate?x.signedAt.toDate().toLocaleDateString():"Recent"]})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("span",{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 px-2 py-1 rounded text-xs font-bold",children:x.status}),o.jsx("button",{onClick:()=>v(x.id,x.name),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",title:"Release Artist",children:o.jsx(Mr,{size:18})})]})]},x.id)})})]})]})}function ahe({user:t,userData:e}){const{schoolData:n,studentProfile:r}=jg(),[s,i]=N.useState(""),[a,l]=N.useState([]),[u,d]=N.useState(!1),f=(e==null?void 0:e.internshipCities)||[],m=async()=>{const _=s.trim();if(_&&f.length<3)try{await ft(ke(Y,"users",t.uid),{internshipCities:_p(_)}),i("")}catch(E){console.error("Error adding interest:",E)}},p=async _=>{try{await ft(ke(Y,"users",t.uid),{internshipCities:kQ(_)})}catch(E){console.error("Error removing interest:",E)}};N.useEffect(()=>{e!=null&&e.programComplete&&v()},[e==null?void 0:e.programComplete,f]);const v=async()=>{d(!0);try{const _=mt(Ce(Y,"studios"),zt("allowInternship","==",!0));let k=(await Pt(_)).docs.map(b=>({id:b.id,...b.data()}));f.length>0&&(k=k.filter(b=>f.some(S=>{var C,P;return((C=b.city)==null?void 0:C.toLowerCase().includes(S.toLowerCase()))||((P=b.zipCode)==null?void 0:P.includes(S))}))),l(k)}catch(_){console.error("Error fetching studios:",_)}finally{d(!1)}},x=((r==null?void 0:r.hoursLogged)||0)/((n==null?void 0:n.requiredHours)||100);return o.jsxs("div",{className:"max-w-5xl mx-auto space-y-8 pb-20",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6",children:[o.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-2",children:n!=null&&n.logoURL?o.jsx("img",{src:n.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):o.jsx(Sl,{size:32,className:"text-gray-400"})}),o.jsxs("div",{className:"flex-1 text-center md:text-left",children:[o.jsx("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight mb-1",children:(n==null?void 0:n.name)||"Student Dashboard"}),o.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:[o.jsx("span",{className:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Student Portal"}),o.jsx("span",{children:""}),o.jsxs("span",{children:["ID: ",(e==null?void 0:e.studentId)||"N/A"]}),o.jsx("span",{children:""}),o.jsxs("span",{children:["Cohort: ",(r==null?void 0:r.cohort)||"General"]})]})]}),o.jsxs("div",{className:"w-full md:w-64 bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[o.jsxs("div",{className:"flex justify-between text-sm font-bold mb-2",children:[o.jsx("span",{className:"dark:text-gray-300",children:"Progress"}),o.jsxs("span",{className:"text-indigo-600",children:[Math.round(x*100),"%"]})]}),o.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-2",children:o.jsx("div",{className:"h-full bg-indigo-600",style:{width:`${Math.min(100,x*100)}%`}})}),o.jsxs("p",{className:"text-xs text-gray-500 text-right",children:[(r==null?void 0:r.hoursLogged)||0," / ",(n==null?void 0:n.requiredHours)||100," Hours"]})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm space-y-6",children:[o.jsxs("h2",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(cr,{size:20,className:"text-indigo-500"})," Internship Locations"]}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Add up to 3 target locations (City, Zip, or County) to find matched studios."}),o.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(_=>o.jsxs("span",{className:"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-800 dark:text-indigo-300 text-sm font-medium px-3 py-1 rounded-full flex items-center gap-1",children:[_,o.jsx("button",{onClick:()=>p(_),className:"ml-1 hover:text-indigo-800",children:""})]},_))}),f.length<3&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:"Enter City or Zip Code",value:s,onChange:_=>i(_.target.value),onKeyDown:_=>_.key==="Enter"&&m(),className:"flex-1 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none"}),o.jsx("button",{onClick:m,disabled:!s.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg font-bold disabled:opacity-50",children:"Add"})]})]}),(e==null?void 0:e.programComplete)&&o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm space-y-4",children:[o.jsxs("h2",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[o.jsx(ur,{size:20,className:"text-indigo-500"})," Available Studios"]}),u?o.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[o.jsx(Zr,{className:"animate-spin",size:16})," Searching..."]}):a.length>0?o.jsx("div",{className:"space-y-3",children:a.map(_=>o.jsxs("div",{className:"p-4 border rounded-lg dark:border-gray-700 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-bold dark:text-white text-lg",children:_.name}),o.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[o.jsx(cr,{size:12})," ",_.city,", ",_.state]})]}),o.jsx("button",{className:"text-indigo-600 font-bold text-sm hover:underline",children:"View Details"})]},_.id))}):o.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[o.jsx(kr,{size:16})," No studios found matching your criteria yet."]})]})]})}const a2=(t,e="export")=>{if(!t||!t.length){console.warn("No data to export.");return}const n=new Set;t.forEach(u=>Object.keys(u).forEach(d=>n.add(d)));const r=Array.from(n),s=[];s.push(r.join(",")),t.forEach(u=>{const d=r.map(f=>{const m=u[f];return m&&typeof m=="object"?m.toMillis?`"${new Date(m.toMillis()).toLocaleString()}"`:`"${JSON.stringify(m).replace(/"/g,'""')}"`:`"${(""+(m??"")).replace(/"/g,'""')}"`});s.push(d.join(","))});const i=new Blob([s.join(`
`)],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.setAttribute("download",`${e}_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)};function lhe({schoolId:t,schoolData:e}){const[n,r]=N.useState({students:0,interns:0,pending:0}),[s,i]=N.useState([]),[a,l]=N.useState(!0);return N.useEffect(()=>{t&&(async()=>{l(!0);try{const d=await fT(Ce(Y,`schools/${t}/students`)),m=(await Pt(Ce(Y,`schools/${t}/students`))).docs.filter(_=>_.data().internshipStudioId).length,v=(await Pt(Ce(Y,`schools/${t}/internship_logs`))).docs.filter(_=>_.data().status==="pending_approval").length;r({students:d.data().count,interns:m,pending:v});const x=await Pt(mt(Ce(Y,`schools/${t}/audit_logs`),_n("timestamp","desc"),fs(5)));i(x.docs.map(_=>({id:_.id,..._.data()})))}catch(d){console.error("Overview load failed:",d)}l(!1)})()},[t]),a?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Overview..."}):o.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-2",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(Qo,{title:"Total Students",value:n.students,icon:o.jsx(Gr,{className:"text-white"}),bg:"bg-gradient-to-br from-indigo-500 to-blue-600",text:"text-white"}),o.jsx(Qo,{title:"Active Internships",value:n.interns,icon:o.jsx(ao,{className:"text-white"}),bg:"bg-gradient-to-br from-purple-500 to-pink-600",text:"text-white"}),o.jsx(Qo,{title:"Pending Approvals",value:n.pending,icon:o.jsx(Zr,{className:"text-white"}),bg:"bg-gradient-to-br from-yellow-500 to-orange-600",text:"text-white"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-4 bg-gray-50 dark:bg-gray-800/50",children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(iE,{size:18,className:"text-gray-400"})," Recent Activity"]}),o.jsx("div",{className:"space-y-3",children:s.length===0?o.jsx("p",{className:"text-sm text-gray-500 italic",children:"No recent activity recorded."}):s.map(u=>{var d;return o.jsxs("div",{className:"text-xs border-b dark:border-gray-700 pb-2 last:border-0",children:[o.jsxs("div",{className:"flex justify-between font-bold dark:text-gray-200",children:[o.jsx("span",{children:u.action}),o.jsx("span",{className:"text-gray-500 font-normal",children:(d=u.timestamp)!=null&&d.toDate?u.timestamp.toDate().toLocaleTimeString():""})]}),o.jsxs("div",{className:"text-gray-500 mt-0.5",children:[u.details," ",o.jsxs("span",{className:"opacity-70",children:[" ",u.adminName]})]})]},u.id)})})]}),o.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-6 flex flex-col items-center justify-center text-center bg-white dark:bg-black/20 shadow-sm",children:[o.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center shadow-lg mb-4 overflow-hidden border-4 border-white dark:border-gray-700",children:e!=null&&e.logoURL?o.jsx("img",{src:e.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):o.jsx(Sl,{size:40,className:"text-indigo-500"})}),o.jsx("h2",{className:"text-2xl font-extrabold dark:text-white mb-1",children:(e==null?void 0:e.name)||"School Name"}),o.jsx("p",{className:"text-sm text-gray-500 mb-4",children:(e==null?void 0:e.address)||"No Address Set"}),(e==null?void 0:e.website)&&o.jsxs("a",{href:e.website,target:"_blank",rel:"noreferrer",className:"text-xs font-bold text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1.5 rounded-full hover:bg-indigo-100 transition flex items-center gap-1",children:[o.jsx(_g,{size:12})," Visit Website"]})]})]})]})}function che({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState([]),[a,l]=N.useState(!0),[u,d]=N.useState(""),[f,m]=N.useState(!1),[p,v]=N.useState(!1),[x,_]=N.useState(null),[E,k]=N.useState(!1),[b,S]=N.useState({firstName:"",lastName:"",email:"",studentId:"",cohort:"",status:"Enrolled"}),[C,P]=N.useState("");N.useEffect(()=>{(async()=>{l(!0);try{const F=await Pt(Ce(Y,`schools/${t}/students`));r(F.docs.map(ue=>({id:ue.id,...ue.data()})));const ee=await Pt(Ce(Y,`schools/${t}/partners`));i(ee.docs.map(ue=>({id:ue.id,...ue.data()})))}catch(F){console.error("Roster load failed:",F)}l(!1)})()},[t]);const R=()=>{S({firstName:"",lastName:"",email:"",studentId:"",cohort:"",status:"Enrolled"}),k(!1),_(null),m(!0)},I=D=>{var F,ee;S({firstName:((F=D.displayName)==null?void 0:F.split(" ")[0])||"",lastName:((ee=D.displayName)==null?void 0:ee.split(" ").slice(1).join(" "))||"",email:D.email||"",studentId:D.studentId||"",cohort:D.cohort||"",status:D.status||"Enrolled"}),k(!0),_(D),m(!0)},j=async()=>{const D=`${b.firstName} ${b.lastName}`.trim();if(!D||!b.email)return alert("Name and Email required.");try{if(E&&x)await ft(ke(Y,`schools/${t}/students/${x.id}`),{...b,displayName:D}),r(F=>F.map(ee=>ee.id===x.id?{...ee,...b,displayName:D}:ee)),await e("Edit Student",`Updated ${D}`);else{const F=await Gt(Ce(Y,`schools/${t}/students`),{...b,displayName:D,hoursLogged:0,createdAt:jt()});r(ee=>[...ee,{id:F.id,...b,displayName:D,hoursLogged:0}]),await e("Add Student",`Added ${D}`)}m(!1)}catch(F){console.error("Save student failed:",F),alert("Failed to save student.")}},O=async(D,F)=>{if(confirm(`Remove ${F} from the roster? This does not delete their user account.`))try{await Pi(ke(Y,`schools/${t}/students/${D}`)),r(ee=>ee.filter(ue=>ue.id!==D)),await e("Remove Student",`Removed ${F}`)}catch(ee){console.error("Delete failed:",ee)}},V=async()=>{if(!(!x||!C))try{await ft(ke(Y,`schools/${t}/students/${x.id}`),{internshipStudioId:C}),r(D=>D.map(F=>F.id===x.id?{...F,internshipStudioId:C}:F)),v(!1),P(""),alert(`Assigned ${x.displayName} to studio.`),await e("Assign Internship",`Assigned ${x.displayName}`)}catch(D){console.error("Assignment failed:",D)}},z=n.filter(D=>{var F,ee;return((F=D.displayName)==null?void 0:F.toLowerCase().includes(u.toLowerCase()))||((ee=D.studentId)==null?void 0:ee.includes(u))});return a?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roster..."}):o.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-between",children:[o.jsxs("div",{className:"relative flex-1 max-w-md",children:[o.jsx(ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-9 p-2 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Search by Name or ID...",value:u,onChange:D=>d(D.target.value)})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>a2(n,"student_roster"),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-bold text-xs",children:"Export CSV"}),o.jsxs("button",{onClick:R,className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-indigo-700",children:[o.jsx(Fl,{size:16})," Add Student"]})]})]}),o.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-3",children:"Name"}),o.jsx("th",{className:"p-3",children:"ID"}),o.jsx("th",{className:"p-3",children:"Cohort"}),o.jsx("th",{className:"p-3",children:"Internship"}),o.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:z.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"5",className:"p-6 text-center text-gray-500",children:"No students found."})}):z.map(D=>o.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[o.jsx("td",{className:"p-3 font-bold dark:text-white",children:D.displayName}),o.jsx("td",{className:"p-3 text-gray-500",children:D.studentId||"--"}),o.jsx("td",{className:"p-3",children:D.cohort||"General"}),o.jsx("td",{className:"p-3 text-gray-500",children:D.internshipStudioId?o.jsxs("span",{className:"flex items-center gap-1 text-green-600 font-medium text-xs bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded w-fit",children:[o.jsx(ao,{size:12})," Assigned"]}):o.jsx("span",{className:"text-gray-400 italic text-xs",children:"Pending"})}),o.jsx("td",{className:"p-3 text-right",children:o.jsxs("div",{className:"flex justify-end gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:()=>{_(D),v(!0)},className:"p-1.5 bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-300 rounded hover:bg-indigo-100",title:"Assign Internship",children:o.jsx(cE,{size:14})}),o.jsx("button",{onClick:()=>I(D),className:"p-1.5 bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 rounded hover:bg-gray-200",title:"Edit Details",children:o.jsx(dE,{size:14})}),o.jsx("button",{onClick:()=>O(D.id,D.displayName),className:"p-1.5 bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400 rounded hover:bg-red-100",title:"Remove Student",children:o.jsx(Mr,{size:14})})]})})]},D.id))})]})}),f&&o.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 space-y-4 animate-in zoom-in-95 shadow-2xl",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"font-bold text-xl dark:text-white",children:E?"Edit Student":"Add New Student"}),o.jsx("button",{onClick:()=>m(!1),children:o.jsx(ut,{className:"text-gray-400 hover:text-red-500"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"First Name"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:b.firstName,onChange:D=>S({...b,firstName:D.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Last Name"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:b.lastName,onChange:D=>S({...b,lastName:D.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Email Address"}),o.jsx("input",{type:"email",className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:b.email,onChange:D=>S({...b,email:D.target.value})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Student ID"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:b.studentId,onChange:D=>S({...b,studentId:D.target.value}),placeholder:"e.g. S123"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Cohort"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:b.cohort,onChange:D=>S({...b,cohort:D.target.value}),placeholder:"Fall 2024"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Enrollment Status"}),o.jsxs("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:b.status,onChange:D=>S({...b,status:D.target.value}),children:[o.jsx("option",{value:"Enrolled",children:"Enrolled"}),o.jsx("option",{value:"Graduated",children:"Graduated"}),o.jsx("option",{value:"Dropped",children:"Dropped"}),o.jsx("option",{value:"Leave",children:"On Leave"})]})]}),o.jsx("button",{onClick:j,className:"w-full bg-indigo-600 text-white py-2.5 rounded-lg font-bold hover:bg-indigo-700 mt-2",children:E?"Update Student":"Create Student Record"})]})}),p&&x&&o.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-sm rounded-xl p-6 space-y-4 animate-in zoom-in-95 shadow-2xl",children:[o.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Assign Internship"}),o.jsxs("p",{className:"text-sm text-gray-500",children:["Select a partner studio for ",o.jsx("strong",{children:x.displayName}),"."]}),o.jsxs("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:C,onChange:D=>P(D.target.value),children:[o.jsx("option",{value:"",children:"Select Studio..."}),s.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>v(!1),className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-sm",children:"Cancel"}),o.jsx("button",{onClick:V,disabled:!C,className:"flex-1 bg-indigo-600 text-white py-2 rounded font-bold disabled:opacity-50",children:"Confirm"})]})]})})]})}const uhe=(t,e)=>{if(!t||!e)return 0;const n=t.toMillis?t.toMillis():new Date(t).getTime(),s=(e.toMillis?e.toMillis():new Date(e).getTime())-n;return Math.max(0,Math.floor(s/6e4))},dhe=t=>{const e=Math.floor(t/60),n=Math.floor(t%60);return`${e}h ${n>0?`${n}m`:""}`};function hhe({schoolId:t}){const[e,n]=N.useState([]),[r,s]=N.useState(!0),[i,a]=N.useState("all");N.useEffect(()=>{t&&(async()=>{s(!0);try{let f=mt(Ce(Y,`schools/${t}/internship_logs`),_n("checkIn","desc"),fs(100));const p=(await Pt(f)).docs.map(v=>{const x=v.data(),_=uhe(x.checkIn,x.checkOut);return{id:v.id,...x,duration:_}});n(p)}catch(f){console.error("Error fetching logs:",f)}s(!1)})()},[t]);const l=async(d,f)=>{try{await ft(ke(Y,`schools/${t}/internship_logs/${d}`),{status:f}),n(m=>m.map(p=>p.id===d?{...p,status:f}:p))}catch(m){console.error("Error updating log:",m),alert("Failed to update log status.")}},u=i==="all"?e:e.filter(d=>d.status===i);return r?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Internship Hours..."}):o.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(lE,{size:16,className:"text-gray-500"}),o.jsxs("select",{className:"bg-white dark:bg-[#1f2128] border dark:border-gray-600 text-sm rounded-md p-1.5 outline-none dark:text-white",value:i,onChange:d=>a(d.target.value),children:[o.jsx("option",{value:"all",children:"All Activity"}),o.jsx("option",{value:"pending_approval",children:"Pending Approval"}),o.jsx("option",{value:"approved",children:"Approved"}),o.jsx("option",{value:"rejected",children:"Rejected"}),o.jsx("option",{value:"active",children:"Active (Clocked In)"})]})]}),o.jsxs("button",{onClick:()=>a2(u,"internship_hours"),className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-[#1f2128] border dark:border-gray-600 rounded-md text-xs font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[o.jsx(Wh,{size:14})," Export CSV"]})]}),o.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 shadow-sm",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-3",children:"Date"}),o.jsx("th",{className:"p-3",children:"Student"}),o.jsx("th",{className:"p-3",children:"Activity / Description"}),o.jsx("th",{className:"p-3",children:"Duration"}),o.jsx("th",{className:"p-3",children:"Status"}),o.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:u.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"6",className:"p-8 text-center text-gray-500",children:"No logs found matching criteria."})}):u.map(d=>{var f,m;return o.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[o.jsxs("td",{className:"p-3 text-gray-600 dark:text-gray-300 whitespace-nowrap",children:[o.jsx("div",{className:"font-medium",children:(f=d.checkIn)!=null&&f.toDate?d.checkIn.toDate().toLocaleDateString():"N/A"}),o.jsx("div",{className:"text-[10px] text-gray-400",children:(m=d.checkIn)!=null&&m.toDate?d.checkIn.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),o.jsx("td",{className:"p-3 font-bold dark:text-white",children:d.studentName}),o.jsxs("td",{className:"p-3 max-w-xs",children:[o.jsxs("span",{className:"block text-[10px] uppercase font-bold text-gray-400 mb-0.5",children:[d.type,"  ",d.location]}),o.jsx("span",{className:"text-gray-700 dark:text-gray-300 truncate block",title:d.description,children:d.description||o.jsx("span",{className:"italic opacity-50",children:"No description provided"})})]}),o.jsx("td",{className:"p-3 font-mono font-bold text-indigo-600 dark:text-indigo-400",children:d.checkOut?dhe(d.duration):o.jsx("span",{className:"animate-pulse text-green-500",children:"Active..."})}),o.jsx("td",{className:"p-3",children:o.jsx(fhe,{status:d.status})}),o.jsx("td",{className:"p-3 text-right",children:d.status==="pending_approval"&&o.jsxs("div",{className:"flex justify-end gap-1",children:[o.jsx("button",{onClick:()=>l(d.id,"approved"),className:"p-1.5 bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded hover:bg-green-200 transition",title:"Approve",children:o.jsx(kr,{size:16})}),o.jsx("button",{onClick:()=>l(d.id,"rejected"),className:"p-1.5 bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded hover:bg-red-200 transition",title:"Reject",children:o.jsx(One,{size:16})})]})})]},d.id)})})]})})]})}function fhe({status:t}){const e={approved:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",rejected:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",pending_approval:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",active:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 animate-pulse"},n={approved:"Approved",rejected:"Rejected",pending_approval:"Pending",active:"In Progress"};return o.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-[10px] uppercase font-bold tracking-wide ${e[t]||"bg-gray-100 text-gray-500"}`,children:n[t]||t})}function mhe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState([]),[a,l]=N.useState(!0),[u,d]=N.useState(""),[f,m]=N.useState("");N.useEffect(()=>{(async()=>{l(!0);try{const x=await Pt(Ce(Y,`schools/${t}/staff`));r(x.docs.map(E=>({id:E.id,...E.data()})));const _=await Pt(Ce(Y,`schools/${t}/roles`));i(_.docs.map(E=>({id:E.id,...E.data()})))}catch(x){console.error("Staff load failed:",x)}l(!1)})()},[t]);const p=async()=>{if(!u||!f)return alert("Email and Role are required.");try{const v=mt(Zc(Y,"public_profile"),zt("email","==",u)),x=await Pt(v);if(x.empty)return alert("User not found. They must sign up for SeshNx first.");const _=x.docs[0],E=_.data(),k=_.ref.parent.parent.id,b=s.find(P=>P.id===f),S={uid:k,email:E.email,name:`${E.firstName} ${E.lastName}`,roleId:f,roleName:(b==null?void 0:b.name)||"Unknown",addedAt:jt()};await Gt(Ce(Y,`schools/${t}/staff`),S);const C=Le(k).userProfile;await ft(ke(Y,C),{schoolId:t,accountTypes:_p("Instructor")}),r(P=>[...P,S]),d(""),alert(`${E.firstName} added as ${b==null?void 0:b.name}.`),await e("Add Staff",`Added ${E.email} as ${b==null?void 0:b.name}`)}catch(v){console.error("Add staff error:",v),alert("Failed to add staff member. Check console.")}};return a?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Staff..."}):o.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(Fl,{size:18,className:"text-indigo-600"})," Add New Staff Member"]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Pp,{size:16,className:"absolute left-3 top-3 text-gray-400"}),o.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"User Email Address",value:u,onChange:v=>d(v.target.value)})]}),o.jsxs("div",{className:"relative min-w-[200px]",children:[o.jsx(uo,{size:16,className:"absolute left-3 top-3 text-gray-400"}),o.jsxs("select",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white appearance-none",value:f,onChange:v=>m(v.target.value),children:[o.jsx("option",{value:"",children:"Select Role..."}),s.map(v=>o.jsx("option",{value:v.id,children:v.name},v.id))]})]}),o.jsx("button",{onClick:p,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 transition shadow-md",children:"Add Staff"})]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["* The user must already have a SeshNx account. This will grant them ",o.jsx("strong",{children:"Instructor"})," access to this school."]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[o.jsx("span",{className:"font-bold text-sm dark:text-gray-200",children:"Authorized Personnel"}),o.jsxs("span",{className:"text-xs bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded-full font-bold",children:[n.length," Active"]})]}),o.jsx("div",{className:"divide-y dark:divide-gray-700",children:n.length===0?o.jsx("div",{className:"p-8 text-center text-gray-500",children:"No staff members found."}):n.map(v=>o.jsxs("div",{className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold shadow-sm",children:v.name?v.name.charAt(0):"?"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-bold dark:text-white text-sm",children:v.name}),o.jsx("div",{className:"text-xs text-gray-500",children:v.email})]})]}),o.jsx("div",{className:"flex items-center gap-4",children:o.jsx("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-bold border dark:border-gray-600",children:v.roleName})})]},v.id))})]})]})}function phe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState(!0),[a,l]=N.useState(!1),[u,d]=N.useState({name:"",color:"#3b82f6",permissions:[]}),[f,m]=N.useState(!1);N.useEffect(()=>{t&&(async()=>{i(!0);try{const b=await Pt(Ce(Y,`schools/${t}/roles`));r(b.docs.map(S=>({id:S.id,...S.data()})))}catch(b){console.error("Error loading roles:",b)}i(!1)})()},[t]);const p=async()=>{if(u.name){m(!0);try{const k=await Gt(Ce(Y,`schools/${t}/roles`),u);r(b=>[...b,{id:k.id,...u}]),await e("Create Role",`Created role: ${u.name}`),d({name:"",color:"#3b82f6",permissions:[]}),l(!1)}catch(k){console.error("Create role failed:",k),alert("Failed to create role.")}m(!1)}},v=async(k,b)=>{if(confirm(`Delete role "${b}"? Staff assigned to this role will lose their permissions.`))try{await Pi(ke(Y,`schools/${t}/roles/${k}`)),r(S=>S.filter(C=>C.id!==k)),await e("Delete Role",`Deleted role: ${b}`)}catch(S){console.error("Delete role failed:",S)}},x=async(k,b)=>{r(S=>S.map(C=>C.id===k?{...C,permissions:b}:C));try{await ft(ke(Y,`schools/${t}/roles/${k}`),{permissions:b})}catch(S){console.error("Update perms failed:",S)}},_=k=>{d(b=>({...b,permissions:b.permissions.includes(k)?b.permissions.filter(S=>S!==k):[...b.permissions,k]}))},E=(k,b)=>{const S=k.permissions||[],C=S.includes(b)?S.filter(P=>P!==b):[...S,b];x(k.id,C)};return s?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roles..."}):o.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[o.jsxs("button",{onClick:()=>l(!0),className:"w-full py-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-500 font-bold hover:bg-gray-50 dark:hover:bg-white/5 transition flex items-center justify-center gap-2",children:[o.jsx(ms,{size:20})," Create New Role"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(k=>{var b;return o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-start bg-gray-50 dark:bg-gray-800/50",children:[o.jsxs("div",{children:[o.jsxs("h4",{className:"font-bold dark:text-white flex items-center gap-2",children:[o.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:k.color}}),k.name]}),o.jsxs("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider font-bold",children:[((b=k.permissions)==null?void 0:b.length)||0," Permissions"]})]}),o.jsx("button",{onClick:()=>v(k.id,k.name),className:"text-gray-400 hover:text-red-500 transition p-1",title:"Delete Role",children:o.jsx(Mr,{size:16})})]}),o.jsx("div",{className:"p-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar",children:o.jsx("div",{className:"space-y-0.5",children:B1.map(S=>{var P;const C=(P=k.permissions)==null?void 0:P.includes(S.id);return o.jsxs("label",{className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition ${C?"bg-indigo-50 dark:bg-indigo-900/20":"hover:bg-gray-50 dark:hover:bg-white/5"}`,children:[o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${C?"bg-indigo-600 border-indigo-600":"border-gray-400"}`,children:C&&o.jsx(Cs,{size:10,className:"text-white",strokeWidth:4})}),o.jsx("input",{type:"checkbox",className:"hidden",checked:C,onChange:()=>E(k,S.id)}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:`text-xs font-bold ${C?"text-indigo-700 dark:text-indigo-300":"text-gray-600 dark:text-gray-400"}`,children:S.label}),o.jsx("div",{className:"text-[10px] text-gray-400 leading-tight",children:S.description})]})]},S.id)})})})]},k.id)})}),a&&o.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-xl p-6 space-y-4 max-h-[90vh] overflow-y-auto animate-in zoom-in-95 shadow-2xl",children:[o.jsxs("h3",{className:"font-bold text-xl dark:text-white flex items-center gap-2",children:[o.jsx(Rp,{className:"text-indigo-600"})," Create New Role"]}),o.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[o.jsxs("div",{className:"col-span-3",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Role Name"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g. Academic Advisor",value:u.name,onChange:k=>d({...u,name:k.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Color"}),o.jsx("div",{className:"flex items-center border rounded dark:border-gray-600 p-1 dark:bg-black/20",children:o.jsx("input",{type:"color",className:"h-8 w-8 rounded cursor-pointer border-none bg-transparent",value:u.color,onChange:k=>d({...u,color:k.target.value})})})]})]}),o.jsxs("div",{className:"border-t dark:border-gray-700 pt-4",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-3 block",children:"Assign Initial Permissions"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:B1.map(k=>o.jsxs("label",{className:`flex items-start gap-2 p-2 border rounded cursor-pointer transition ${u.permissions.includes(k.id)?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-white/5"}`,children:[o.jsx("input",{type:"checkbox",className:"mt-1",checked:u.permissions.includes(k.id),onChange:()=>_(k.id)}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-bold dark:text-gray-200",children:k.label}),o.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:k.description})]})]},k.id))})]}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsx("button",{onClick:()=>l(!1),className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-sm",children:"Cancel"}),o.jsx("button",{onClick:p,disabled:f,className:"flex-1 bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700 disabled:opacity-50",children:f?"Saving...":"Create Role"})]})]})})]})}function ghe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState(!0),[a,l]=N.useState({resource:"",limit:4,unit:"hours/week",role:"Student"});N.useEffect(()=>{t&&(async()=>{i(!0);try{const m=await Pt(Ce(Y,`schools/${t}/rules`));r(m.docs.map(p=>({id:p.id,...p.data()})))}catch(m){console.error("Error loading rules:",m)}i(!1)})()},[t]);const u=async()=>{if(!a.resource)return alert("Resource name required.");try{const m={id:(await Gt(Ce(Y,`schools/${t}/rules`),a)).id,...a};r(p=>[...p,m]),await e("Add Resource Rule",`Set ${a.limit} ${a.unit} limit for ${a.resource}`),l({resource:"",limit:4,unit:"hours/week",role:"Student"})}catch(f){console.error("Add rule failed:",f)}},d=async(f,m)=>{if(confirm("Delete this rule?"))try{await Pi(ke(Y,`schools/${t}/rules/${f}`)),r(p=>p.filter(v=>v.id!==f)),await e("Delete Rule",`Removed rule for ${m}`)}catch(p){console.error("Delete failed:",p)}};return s?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Rules..."}):o.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(Vl,{size:18,className:"text-indigo-600"})," Add Restriction / Quota"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Resource Name"}),o.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g. Studio A, SSL Room",value:a.resource,onChange:f=>l({...a,resource:f.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Limit"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"number",className:"w-20 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:a.limit,onChange:f=>l({...a,limit:f.target.value})}),o.jsxs("select",{className:"flex-1 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:a.unit,onChange:f=>l({...a,unit:f.target.value}),children:[o.jsx("option",{value:"hours/week",children:"Hrs/Wk"}),o.jsx("option",{value:"hours/term",children:"Hrs/Term"}),o.jsx("option",{value:"bookings/week",children:"Bookings/Wk"})]})]})]}),o.jsx("div",{className:"flex items-end",children:o.jsxs("button",{onClick:u,className:"w-full bg-indigo-600 text-white py-2.5 rounded-lg font-bold hover:bg-indigo-700 flex items-center justify-center gap-2",children:[o.jsx(ms,{size:18})," Add Rule"]})})]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Applies To Role"}),o.jsxs("select",{className:"w-full md:w-1/2 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:a.role,onChange:f=>l({...a,role:f.target.value}),children:[o.jsx("option",{value:"Student",children:"All Students"}),o.jsx("option",{value:"Senior",children:"Seniors Only"}),o.jsx("option",{value:"Junior",children:"Juniors Only"}),o.jsx("option",{value:"Probation",children:"Probationary"})]})]})]}),o.jsx("div",{className:"space-y-3",children:n.length===0?o.jsx("div",{className:"text-center text-gray-500 py-8 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No active restrictions. Students have default access."}):n.map(f=>o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 flex justify-between items-center shadow-sm hover:shadow-md transition",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold dark:text-white text-lg",children:f.resource}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300 mt-1",children:[o.jsxs("span",{className:"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300 px-2 py-0.5 rounded text-xs font-bold border border-indigo-100 dark:border-indigo-800",children:[f.limit," ",f.unit]}),o.jsx("span",{className:"text-gray-400",children:""}),o.jsxs("span",{children:["Applies to: ",o.jsx("strong",{children:f.role})]})]})]}),o.jsx("button",{onClick:()=>d(f.id,f.resource),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:o.jsx(Mr,{size:18})})]},f.id))})]})}function yhe({schoolId:t,logAction:e,user:n,userData:r}){const[s,i]=N.useState([]),[a,l]=N.useState(!0),[u,d]=N.useState(!1),[f,m]=N.useState({title:"",message:"",target:"All"});N.useEffect(()=>{t&&(async()=>{l(!0);try{const _=mt(Ce(Y,`schools/${t}/announcements`),_n("createdAt","desc")),E=await Pt(_);i(E.docs.map(k=>({id:k.id,...k.data()})))}catch(_){console.error("Error loading announcements:",_)}l(!1)})()},[t]);const p=async()=>{if(!f.title.trim()||!f.message.trim())return alert("Title and Message required.");d(!0);try{const x={...f,schoolId:t,authorId:n.uid,authorName:r.displayName||"School Admin",authorRole:r.activeProfileRole||"Admin",createdAt:jt()},_=await Gt(Ce(Y,`schools/${t}/announcements`),x);i(E=>[{id:_.id,...x,createdAt:new Date},...E]),await e("Post Announcement",`Posted: ${f.title}`),m({title:"",message:"",target:"All"})}catch(x){console.error("Post failed:",x),alert("Failed to post announcement.")}d(!1)},v=async x=>{if(confirm("Delete this announcement?"))try{await Pi(ke(Y,`schools/${t}/announcements/${x}`)),i(_=>_.filter(E=>E.id!==x)),await e("Delete Announcement","Removed a post")}catch(_){console.error("Delete failed:",_)}};return a?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading News..."}):o.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(EV,{size:18,className:"text-indigo-600"})," Post New Announcement"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[o.jsx("div",{className:"flex-1",children:o.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"Headline / Title",value:f.title,onChange:x=>m({...f,title:x.target.value})})}),o.jsx("div",{className:"sm:w-1/4",children:o.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white cursor-pointer",value:f.target,onChange:x=>m({...f,target:x.target.value}),children:[o.jsx("option",{value:"All",children:"Everyone"}),o.jsx("option",{value:"Student",children:"Students Only"}),o.jsx("option",{value:"Instructor",children:"Staff Only"})]})})]}),o.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Write your message here...",value:f.message,onChange:x=>m({...f,message:x.target.value})}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:p,disabled:u||!f.title,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 transition",children:u?"Posting...":o.jsxs(o.Fragment,{children:[o.jsx(pb,{size:16})," Post Announcement"]})})})]})]}),o.jsx("div",{className:"space-y-4",children:s.length===0?o.jsx("div",{className:"text-center text-gray-500 py-10 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No announcements yet."}):s.map(x=>{var _;return o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm relative group",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-bold dark:text-white",children:x.title}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2 mt-1",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(wr,{size:12})," ",x.authorName]}),o.jsx("span",{children:""}),o.jsxs("span",{className:"flex items-center gap-1",children:[x.target==="All"?o.jsx(Gr,{size:12}):o.jsx(uo,{size:12}),x.target]}),o.jsx("span",{children:""}),o.jsx("span",{children:(_=x.createdAt)!=null&&_.toDate?x.createdAt.toDate().toLocaleDateString():"Just now"})]})]}),o.jsx("button",{onClick:()=>v(x.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition opacity-0 group-hover:opacity-100",title:"Delete Post",children:o.jsx(Mr,{size:16})})]}),o.jsx("div",{className:"text-gray-700 dark:text-gray-300 text-sm whitespace-pre-wrap leading-relaxed bg-gray-50 dark:bg-black/20 p-3 rounded-lg",children:x.message})]},x.id)})})]})}function xhe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState(!0),[a,l]=N.useState({name:"",address:"",website:"",contactEmail:""});N.useEffect(()=>{t&&(async()=>{i(!0);try{const m=mt(Ce(Y,`schools/${t}/partners`),_n("name")),p=await Pt(m);r(p.docs.map(v=>({id:v.id,...v.data()})))}catch(m){console.error("Error loading partners:",m)}i(!1)})()},[t]);const u=async()=>{if(!a.name)return alert("Partner Name is required.");try{const f={...a,status:"Approved"},m=await Gt(Ce(Y,`schools/${t}/partners`),f);r(p=>[...p,{id:m.id,...f}]),await e("Add Partner",`Added studio: ${a.name}`),l({name:"",address:"",website:"",contactEmail:""})}catch(f){console.error("Add partner failed:",f),alert("Failed to add partner.")}},d=async(f,m)=>{if(confirm(`Remove ${m} from approved partners?`))try{await Pi(ke(Y,`schools/${t}/partners/${f}`)),r(p=>p.filter(v=>v.id!==f)),await e("Remove Partner",`Removed: ${m}`)}catch(p){console.error("Delete failed:",p)}};return s?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Partners..."}):o.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(ao,{size:18,className:"text-indigo-600"})," Add Approved Partner"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Studio / Company Name"}),o.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"e.g. Sound City Studios",value:a.name,onChange:f=>l({...a,name:f.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Address"}),o.jsxs("div",{className:"relative",children:[o.jsx(cr,{size:14,className:"absolute left-3 top-3 text-gray-400"}),o.jsx("input",{className:"w-full pl-9 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"123 Main St...",value:a.address,onChange:f=>l({...a,address:f.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Contact Email"}),o.jsxs("div",{className:"relative",children:[o.jsx(VA,{size:14,className:"absolute left-3 top-3 text-gray-400"}),o.jsx("input",{className:"w-full pl-9 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"manager@studio.com",value:a.contactEmail,onChange:f=>l({...a,contactEmail:f.target.value})})]})]})]}),o.jsx("div",{className:"mt-3 flex justify-end",children:o.jsxs("button",{onClick:u,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 flex items-center gap-2 shadow-md transition",children:[o.jsx(ms,{size:18})," Add Partner"]})})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.length===0?o.jsx("div",{className:"col-span-full text-center py-10 text-gray-500 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No partners added yet."}):n.map(f=>o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 shadow-sm hover:shadow-md transition group relative",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("h4",{className:"font-bold dark:text-white text-lg truncate pr-8",children:f.name}),o.jsx("button",{onClick:()=>d(f.id,f.name),className:"text-gray-400 hover:text-red-500 absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition",children:o.jsx(Mr,{size:16})})]}),o.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[f.address&&o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(cr,{size:14,className:"mt-0.5 text-indigo-500 shrink-0"}),o.jsx("span",{className:"truncate",children:f.address})]}),f.contactEmail&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(VA,{size:14,className:"text-green-500 shrink-0"}),o.jsx("a",{href:`mailto:${f.contactEmail}`,className:"hover:underline truncate",children:f.contactEmail})]})]}),o.jsxs("div",{className:"mt-4 pt-3 border-t dark:border-gray-700 flex justify-between items-center",children:[o.jsx("span",{className:"text-[10px] font-bold uppercase text-green-600 bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded border border-green-200 dark:border-green-800",children:"Approved"}),f.website&&o.jsx("a",{href:f.website,target:"_blank",rel:"noreferrer",className:"text-gray-400 hover:text-indigo-500",children:o.jsx(NV,{size:14})})]})]},f.id))})]})}function vhe({schoolId:t,logAction:e,graderName:n}){const[r,s]=N.useState([]),[i,a]=N.useState(!0),[l,u]=N.useState(""),[d,f]=N.useState(null),[m,p]=N.useState([]),[v,x]=N.useState(!1),[_,E]=N.useState(!1),[k,b]=N.useState({technical:5,softSkills:5,notes:""});N.useEffect(()=>{t&&(async()=>{a(!0);try{const I=mt(Ce(Y,`schools/${t}/students`),_n("displayName")),j=await Pt(I);s(j.docs.map(O=>({id:O.id,...O.data()})))}catch(I){console.error("Error loading students:",I)}a(!1)})()},[t]),N.useEffect(()=>{if(!d)return;(async()=>{x(!0);try{const I=mt(Ce(Y,`schools/${t}/students/${d.id}/evaluations`),_n("date","desc")),j=await Pt(I);p(j.docs.map(O=>({id:O.id,...O.data()})))}catch(I){console.error("Error loading history:",I)}x(!1)})(),E(!1),b({technical:5,softSkills:5,notes:""})},[d,t]);const S=async()=>{if(d)try{const R={...k,evaluator:n||"Instructor",date:jt()},I=await Gt(Ce(Y,`schools/${t}/students/${d.id}/evaluations`),R);p(j=>[{id:I.id,...R,date:new Date},...j]),await e("Grade Student",`Graded ${d.displayName}: Tech(${k.technical}) Soft(${k.softSkills})`),E(!1),alert("Evaluation submitted successfully.")}catch(R){console.error("Grading failed:",R),alert("Failed to save evaluation.")}},C=r.filter(R=>{var I,j;return((I=R.displayName)==null?void 0:I.toLowerCase().includes(l.toLowerCase()))||((j=R.studentId)==null?void 0:j.toLowerCase().includes(l.toLowerCase()))}),P=R=>R>=8?"text-green-500":R>=5?"text-yellow-500":"text-red-500";return i?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roster..."}):o.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border dark:border-gray-700 rounded-xl overflow-hidden bg-white dark:bg-[#2c2e36] animate-in fade-in shadow-sm",children:[o.jsxs("div",{className:"w-full md:w-1/3 border-r dark:border-gray-700 flex flex-col bg-gray-50 dark:bg-[#23262f]",children:[o.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:o.jsxs("div",{className:"relative",children:[o.jsx(ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),o.jsx("input",{className:"w-full pl-9 p-2 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Search Students...",value:l,onChange:R=>u(R.target.value)})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:C.map(R=>o.jsxs("div",{onClick:()=>f(R),className:`p-3 px-4 cursor-pointer flex justify-between items-center transition border-b dark:border-gray-700/50 last:border-0
                                ${(d==null?void 0:d.id)===R.id?"bg-white dark:bg-[#2c2e36] border-l-4 border-l-indigo-600 shadow-sm":"hover:bg-gray-100 dark:hover:bg-gray-700"}
                            `,children:[o.jsxs("div",{children:[o.jsx("div",{className:`font-bold text-sm ${(d==null?void 0:d.id)===R.id?"text-indigo-700 dark:text-white":"dark:text-gray-300"}`,children:R.displayName}),o.jsxs("div",{className:"text-xs text-gray-500",children:[R.cohort||"General","  ",R.hoursLogged||0," hrs"]})]}),(d==null?void 0:d.id)===R.id&&o.jsx(lo,{size:16,className:"text-indigo-500"})]},R.id))})]}),o.jsx("div",{className:"flex-1 flex flex-col relative",children:d?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-white dark:bg-[#2c2e36]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-700 dark:text-indigo-300 font-bold",children:d.displayName[0]}),o.jsxs("div",{children:[o.jsx("h2",{className:"font-bold dark:text-white",children:d.displayName}),o.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",d.studentId||"N/A"]})]})]}),_?o.jsxs("button",{onClick:()=>E(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-white flex items-center gap-2 text-sm font-bold",children:[o.jsx(bne,{size:16})," View History"]}):o.jsxs("button",{onClick:()=>E(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-indigo-700 flex items-center gap-2",children:[o.jsx(ms,{size:16})," New Evaluation"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-white dark:bg-[#2c2e36]",children:[_&&o.jsxs("div",{className:"max-w-lg mx-auto space-y-6 animate-in slide-in-from-bottom-4",children:[o.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800/50 mb-6",children:[o.jsx("h4",{className:"font-bold text-indigo-800 dark:text-indigo-300 mb-1",children:"New Assessment"}),o.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:["Rating performance for ",new Date().toLocaleDateString(),"."]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between mb-2",children:[o.jsx("label",{className:"font-bold text-sm dark:text-gray-300",children:"Technical Proficiency"}),o.jsxs("span",{className:`font-bold ${P(k.technical)}`,children:[k.technical,"/10"]})]}),o.jsx("input",{type:"range",min:"1",max:"10",step:"1",className:"w-full accent-indigo-600 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:k.technical,onChange:R=>b({...k,technical:parseInt(R.target.value)})}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Knowledge of equipment, software, and signal flow."})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between mb-2",children:[o.jsx("label",{className:"font-bold text-sm dark:text-gray-300",children:"Soft Skills / Professionalism"}),o.jsxs("span",{className:`font-bold ${P(k.softSkills)}`,children:[k.softSkills,"/10"]})]}),o.jsx("input",{type:"range",min:"1",max:"10",step:"1",className:"w-full accent-indigo-600 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:k.softSkills,onChange:R=>b({...k,softSkills:parseInt(R.target.value)})}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Punctuality, attitude, communication, and client handling."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"font-bold text-sm dark:text-gray-300 block mb-2",children:"Instructor Notes"}),o.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Detailed feedback...",value:k.notes,onChange:R=>b({...k,notes:R.target.value})})]}),o.jsxs("button",{onClick:S,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 transition flex items-center justify-center gap-2 shadow-lg",children:[o.jsx(_u,{size:18})," Submit Evaluation"]})]})]}),!_&&o.jsx("div",{className:"space-y-4",children:v?o.jsx("p",{className:"text-center text-gray-500",children:"Loading history..."}):m.length===0?o.jsxs("div",{className:"text-center py-10 border-2 border-dashed dark:border-gray-700 rounded-xl",children:[o.jsx(kh,{size:32,className:"mx-auto text-gray-300 mb-2"}),o.jsx("p",{className:"text-gray-500",children:"No evaluations recorded yet."}),o.jsx("button",{onClick:()=>E(!0),className:"text-indigo-500 font-bold text-sm mt-2 hover:underline",children:"Start first evaluation"})]}):m.map(R=>{var I;return o.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-4 hover:shadow-md transition bg-gray-50 dark:bg-[#23262f]",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:(I=R.date)!=null&&I.toDate?R.date.toDate().toLocaleDateString():"Unknown Date"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(wr,{size:14,className:"text-gray-400"}),o.jsx("span",{className:"text-sm font-medium dark:text-gray-200",children:R.evaluator})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"text-center px-3 py-1 bg-white dark:bg-black/20 rounded border dark:border-gray-600",children:[o.jsx("div",{className:`font-bold ${P(R.technical)}`,children:R.technical}),o.jsx("div",{className:"text-[9px] text-gray-400 uppercase",children:"Tech"})]}),o.jsxs("div",{className:"text-center px-3 py-1 bg-white dark:bg-black/20 rounded border dark:border-gray-600",children:[o.jsx("div",{className:`font-bold ${P(R.softSkills)}`,children:R.softSkills}),o.jsx("div",{className:"text-[9px] text-gray-400 uppercase",children:"Soft"})]})]})]}),R.notes&&o.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 border-t dark:border-gray-700 pt-3 mt-2",children:['"',R.notes,'"']})]},R.id)})})]})]}):o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400",children:[o.jsx(kh,{size:48,className:"mb-4 opacity-20"}),o.jsx("p",{children:"Select a student to view history or submit grades."})]})})]})}function bhe({schoolId:t,logAction:e}){const[n,r]=N.useState(""),[s,i]=N.useState(!1),a=async()=>{var m;if(!n.trim())return alert("Please paste CSV data first.");i(!0);const u=n.trim().split(`
`);let d=0,f=0;try{for(let p of u){const v=p.split(",");if(v.length>=3){const x=v[0].trim(),_=v[1].trim(),E=v[2].trim(),k=((m=v[3])==null?void 0:m.trim())||"General",b=`${_} ${E}`;x&&_?(await Gt(Ce(Y,`schools/${t}/students`),{email:x,displayName:b,firstName:_,lastName:E,cohort:k,studentId:"",status:"Enrolled",hoursLogged:0,createdAt:jt()}),d++):f++}else f++}await e("Batch Import",`Imported ${d} students. (${f} skipped)`),alert(`Import complete! Added ${d} students.`),r("")}catch(p){console.error("Import failed:",p),alert("Batch import encountered an error.")}i(!1)},l=async()=>{prompt("Type 'ROLLOVER' to confirm. This will archive current internship logs for all students.")==="ROLLOVER"&&(alert("Rollover process initiated. (This is a placeholder for the Cloud Function trigger)."),await e("Term Rollover","Initiated term archival"))};return o.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(gb,{size:18,className:"text-indigo-600"})," Batch Import Students"]}),o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg mb-4 border border-blue-100 dark:border-blue-800 text-xs text-blue-800 dark:text-blue-300",children:[o.jsx("strong",{children:"Format:"})," ",o.jsx("code",{children:"email, first_name, last_name, cohort"}),o.jsx("br",{}),"Example: ",o.jsx("code",{children:"student@test.edu, John, Doe, Fall 2024"})]}),o.jsx("textarea",{className:"w-full h-40 p-3 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-mono resize-y focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Paste CSV data here...",value:n,onChange:u=>r(u.target.value),disabled:s}),o.jsx("div",{className:"mt-3 flex justify-end",children:o.jsx("button",{onClick:a,disabled:s||!n,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 transition",children:s?"Processing...":o.jsxs(o.Fragment,{children:[o.jsx(Nl,{size:16})," Import Students"]})})})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(cne,{size:18,className:"text-orange-500"})," Term Management"]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-sm dark:text-gray-200 mb-1",children:"End of Term Rollover"}),o.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Use this tool at the end of a semester or cohort period. It will:"}),o.jsxs("ul",{className:"list-disc list-inside text-xs text-gray-500 mt-2 space-y-1 ml-1",children:[o.jsx("li",{children:"Archive all active internship logs."}),o.jsx("li",{children:'Reset "Current Hours" counters (preserving Total Lifetime Hours).'}),o.jsx("li",{children:'Mark graduating students as "Alumni" (optional).'})]})]}),o.jsx("div",{className:"w-full md:w-auto",children:o.jsxs("button",{onClick:l,className:"w-full md:w-auto bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/40 text-red-600 dark:text-red-400 px-4 py-3 rounded-lg font-bold text-xs flex items-center justify-center gap-2 border border-red-200 dark:border-red-800 transition",children:[o.jsx(kl,{size:16})," Execute Rollover"]})})]})]})]})}function _he({schoolId:t}){const[e,n]=N.useState([]),[r,s]=N.useState(!0),[i,a]=N.useState(50);N.useEffect(()=>{t&&(async()=>{s(!0);try{const d=mt(Ce(Y,`schools/${t}/audit_logs`),_n("timestamp","desc"),fs(i)),f=await Pt(d);n(f.docs.map(m=>({id:m.id,...m.data()})))}catch(d){console.error("Error loading audit logs:",d)}s(!1)})()},[t,i]);const l=u=>u.includes("Delete")||u.includes("Remove")?"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400":u.includes("Create")||u.includes("Add")?"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-400":u.includes("Update")||u.includes("Edit")?"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 bg-gray-100 dark:bg-gray-700 dark:text-gray-300";return r&&e.length===0?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Audit Trail..."}):o.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx(iE,{size:16}),o.jsxs("span",{children:["Showing last ",o.jsx("strong",{children:e.length})," actions"]})]}),o.jsxs("button",{onClick:()=>a2(e,"audit_logs"),className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-[#1f2128] border dark:border-gray-600 rounded-md text-xs font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[o.jsx(Nl,{size:14})," Export Log"]})]}),o.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 shadow-sm",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:o.jsxs("tr",{children:[o.jsx("th",{className:"p-3",children:"Timestamp"}),o.jsx("th",{className:"p-3",children:"Admin / Staff"}),o.jsx("th",{className:"p-3",children:"Action Type"}),o.jsx("th",{className:"p-3",children:"Details"})]})}),o.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"4",className:"p-8 text-center text-gray-500",children:"No audit history found."})}):e.map(u=>{var d;return o.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[o.jsxs("td",{className:"p-3 text-gray-500 whitespace-nowrap flex items-center gap-2",children:[o.jsx(Zr,{size:14,className:"opacity-50"}),(d=u.timestamp)!=null&&d.toDate?u.timestamp.toDate().toLocaleString():"N/A"]}),o.jsx("td",{className:"p-3 font-bold dark:text-white",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(uo,{size:14,className:"text-indigo-500"}),u.adminName||"System"]})}),o.jsx("td",{className:"p-3",children:o.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider ${l(u.action)}`,children:u.action})}),o.jsx("td",{className:"p-3 text-gray-600 dark:text-gray-300 font-mono text-xs",children:u.details})]},u.id)})})]})}),e.length>=i&&o.jsx("div",{className:"text-center pt-2",children:o.jsx("button",{onClick:()=>a(u=>u+50),className:"text-xs font-bold text-indigo-600 hover:underline",children:"Load Older Logs"})})]})}function whe({schoolId:t,initialData:e,logAction:n,refreshMeta:r}){const[s,i]=N.useState(e||{}),{uploadImage:a,uploading:l}=o2();N.useEffect(()=>{e&&i(e)},[e]);const u=async()=>{try{await ft(ke(Y,"schools",t),s),alert("School settings updated successfully."),r&&r(s),await n("Update Settings","Updated school configuration")}catch(m){console.error("Update failed:",m),alert("Failed to update school settings.")}},d=async m=>{const p=m.target.files[0];if(!(!p||!t))try{const v=await a(p,`schools/${t}/images/logo`);v&&(await ft(ke(Y,"schools",t),{logoURL:v}),i(x=>({...x,logoURL:v})),r&&r({...s,logoURL:v}),await n("Update Logo","Uploaded new school logo"))}catch(v){console.error("Logo upload failed",v),alert("Failed to upload logo.")}},f=m=>{i(p=>({...p,[m]:!p[m]}))};return!s.name&&!e?o.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Settings..."}):o.jsxs("div",{className:"space-y-8 animate-in fade-in",children:[o.jsxs("section",{className:"flex flex-col md:flex-row gap-6 items-start",children:[o.jsxs("div",{className:"relative group",children:[o.jsxs("div",{className:"h-32 w-32 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300 dark:border-gray-600",children:[s.logoURL?o.jsx("img",{src:s.logoURL,className:"h-full w-full object-contain",alt:"Logo"}):o.jsx(Sl,{size:40,className:"text-gray-400"}),l&&o.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center text-white text-xs",children:"Uploading..."})]}),o.jsxs("label",{className:"absolute bottom-2 right-2 bg-indigo-600 p-2 rounded-full text-white cursor-pointer shadow-lg hover:bg-indigo-700 transition",children:[o.jsx(mb,{size:14}),o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:d,disabled:l})]})]}),o.jsxs("div",{className:"flex-1 w-full grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"School Name"}),o.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.name||"",onChange:m=>i({...s,name:m.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Primary Color"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"color",className:"h-10 w-10 p-0 border-0 rounded cursor-pointer",value:s.primaryColor||"#4f46e5",onChange:m=>i({...s,primaryColor:m.target.value})}),o.jsx("input",{className:"flex-1 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-mono",value:s.primaryColor||"",onChange:m=>i({...s,primaryColor:m.target.value})})]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Address"}),o.jsxs("div",{className:"relative",children:[o.jsx(cr,{size:16,className:"absolute left-3 top-3 text-gray-400"}),o.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.address||"",onChange:m=>i({...s,address:m.target.value})})]})]})]})]}),o.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t dark:border-gray-700",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Website"}),o.jsxs("div",{className:"relative",children:[o.jsx(_g,{size:16,className:"absolute left-3 top-3 text-gray-400"}),o.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.website||"",onChange:m=>i({...s,website:m.target.value}),placeholder:"https://"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Contact Email"}),o.jsxs("div",{className:"relative",children:[o.jsx(Pp,{size:16,className:"absolute left-3 top-3 text-gray-400"}),o.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.contactEmail||"",onChange:m=>i({...s,contactEmail:m.target.value}),placeholder:"admin@school.edu"})]})]})]}),o.jsxs("section",{children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white border-b dark:border-gray-700 pb-2 mb-4 flex items-center gap-2",children:[o.jsx(kh,{size:18,className:"text-indigo-600"})," Academic Structure"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Cohort Mode"}),o.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.cohortMode||"Semester",onChange:m=>i({...s,cohortMode:m.target.value}),children:[o.jsx("option",{value:"Semester",children:"Semester Based"}),o.jsx("option",{value:"Trimester",children:"Trimester"}),o.jsx("option",{value:"Monthly",children:"Monthly"}),o.jsx("option",{value:"Rolling",children:"Rolling"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Grading Scale"}),o.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.gradingScale||"1-10",onChange:m=>i({...s,gradingScale:m.target.value}),children:[o.jsx("option",{value:"1-10",children:"Numeric (1-10)"}),o.jsx("option",{value:"Pass/Fail",children:"Pass/Fail"}),o.jsx("option",{value:"Letter",children:"Letter Grades"})]})]})]})]}),o.jsxs("section",{children:[o.jsxs("h3",{className:"font-bold text-lg dark:text-white border-b dark:border-gray-700 pb-2 mb-4 flex items-center gap-2",children:[o.jsx(wu,{size:18,className:"text-indigo-600"})," Operational Rules"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-sm dark:text-white",children:"Strict Geofencing"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Require GPS location match for clock-in"})]}),o.jsx("button",{onClick:()=>f("geofencing"),children:s.geofencing?o.jsx(jc,{size:24,className:"text-indigo-600"}):o.jsx(Cc,{size:24,className:"text-gray-400"})})]}),o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-bold text-sm dark:text-white",children:"Supervisor Approval"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Require partner studio sign-off on hours"})]}),o.jsx("button",{onClick:()=>f("requireApproval"),children:s.requireApproval?o.jsx(jc,{size:24,className:"text-indigo-600"}):o.jsx(Cc,{size:24,className:"text-gray-400"})})]})]})]}),o.jsx("div",{className:"pt-4 border-t dark:border-gray-700",children:o.jsxs("button",{onClick:u,className:"w-full sm:w-auto bg-indigo-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-indigo-700 flex items-center justify-center gap-2 shadow-lg",children:[o.jsx(_u,{size:18})," Save Configuration"]})})]})}function Nz({user:t,userData:e,allowedTabs:n,staffTitle:r,currentView:s}){var C;const{schoolId:i}=jg(),a=s?s.replace("edu-",""):n?n[0]:"overview",[l,u]=N.useState(i||null),[d,f]=N.useState(null),[m,p]=N.useState([]),[v,x]=N.useState(!1),[_,E]=N.useState({name:"",address:"",primaryColor:"#4f46e5"}),k=(C=e==null?void 0:e.accountTypes)==null?void 0:C.includes("Admin");N.useEffect(()=>{k&&(async()=>{try{const I=(await Pt(Ce(Y,"schools"))).docs.map(j=>({id:j.id,...j.data()}));p(I),!l&&!i&&I.length>0&&u(I[0].id)}catch(R){console.error("Error fetching schools list:",R)}})()},[k,l]),N.useEffect(()=>{if(!l)return;(async()=>{try{const R=mt(Ce(Y,"schools"),zt("__name__","==",l)),I=await Pt(R);I.empty||f(I.docs[0].data())}catch(R){console.error("Error loading school meta:",R)}})()},[l]);const b=async(P,R)=>{if(l)try{await Gt(Ce(Y,`schools/${l}/audit_logs`),{action:P,details:R,adminId:t.uid,adminName:`${e.firstName} ${e.lastName}`,timestamp:jt()})}catch(I){console.error("Failed to log action:",I)}},S=async()=>{if(_.name)try{const P=await Gt(Ce(Y,"schools"),{..._,createdAt:jt(),requiredHours:100});await Gt(Ce(Y,`schools/${P.id}/roles`),{name:"Admin",color:"#dc2626",permissions:B1.map(R=>R.id)}),p(R=>[...R,{id:P.id,..._}]),u(P.id),x(!1),E({name:"",address:"",primaryColor:"#4f46e5"})}catch(P){console.error("Error creating school:",P),alert("Failed to create school.")}};return o.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 pb-20",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6 relative overflow-hidden",children:[o.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-2 z-10",children:d!=null&&d.logoURL?o.jsx("img",{src:d.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):o.jsx(Sl,{size:40,className:"text-gray-400"})}),o.jsxs("div",{className:"flex-1 text-center md:text-left z-10",children:[o.jsxs("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight flex items-center justify-center md:justify-start gap-3",children:[(d==null?void 0:d.name)||"Select School",k&&!r&&o.jsxs("div",{className:"relative group",children:[o.jsx("select",{className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",value:l||"",onChange:P=>u(P.target.value),children:m.map(P=>o.jsx("option",{value:P.id,children:P.name},P.id))}),o.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 border-none rounded-lg text-sm font-bold p-1 px-2 flex items-center gap-1 pointer-events-none group-hover:bg-gray-200 dark:group-hover:bg-gray-600 transition",children:[o.jsx("span",{children:"Switch"})," ",o.jsx(uo,{size:10})]})]})]}),o.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400 mt-1",children:[r?o.jsxs("span",{className:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:[r," Dashboard"]}):o.jsx("span",{className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Global Admin Mode"}),(d==null?void 0:d.address)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(cr,{size:12})," ",d.address]})]})]})]}),k&&o.jsx("div",{className:"z-10",children:o.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-indigo-700 transition shadow-md",children:[o.jsx(ms,{size:16})," New School"]})}),o.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-600/5 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"})]}),o.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 min-h-[400px] p-4",children:l?o.jsxs(o.Fragment,{children:[a==="overview"&&o.jsx(lhe,{schoolId:l,schoolData:d}),a==="roster"&&o.jsx(che,{schoolId:l,logAction:b}),a==="hours"&&o.jsx(hhe,{schoolId:l}),a==="instructors"&&o.jsx(mhe,{schoolId:l,logAction:b}),a==="roles"&&o.jsx(phe,{schoolId:l,logAction:b}),a==="resources"&&o.jsx(ghe,{schoolId:l,logAction:b}),a==="news"&&o.jsx(yhe,{schoolId:l,logAction:b,user:t,userData:e}),a==="partners"&&o.jsx(xhe,{schoolId:l,logAction:b}),a==="evaluations"&&o.jsx(vhe,{schoolId:l,logAction:b,graderName:e.displayName}),a==="cohorts"&&o.jsx(bhe,{schoolId:l,logAction:b}),a==="audit"&&o.jsx(_he,{schoolId:l}),a==="settings"&&o.jsx(whe,{schoolId:l,initialData:d,logAction:b,refreshMeta:P=>f(R=>({...R,...P}))})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-gray-500",children:[o.jsx(Sl,{size:48,className:"mb-4 opacity-20"}),o.jsx("p",{children:"Please select or create a school to manage."})]})}),v&&o.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 space-y-4 animate-in zoom-in-95",children:[o.jsx("h3",{className:"font-bold text-xl dark:text-white",children:"Create School"}),o.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"School Name",value:_.name,onChange:P=>E({..._,name:P.target.value})}),o.jsx("button",{onClick:S,className:"w-full bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700",children:"Create"}),o.jsx("button",{onClick:()=>x(!1),className:"w-full text-gray-500 text-sm hover:underline",children:"Cancel"})]})})]})}function khe({user:t,userData:e,currentView:n}){const{myPermissions:r,staffProfile:s}=jg(),i={manage_roster:"roster",manage_enrollment:"cohorts",approve_hours:"hours",manage_partners:"partners",grade_students:"evaluations",post_announcements:"news",manage_resources:"resources",manage_staff:"instructors",view_audit:"audit",edit_settings:"settings"},a=r.includes("ALL")?Object.values(i):r.map(l=>i[l]).filter(Boolean);return a.length===0&&!r.includes("ALL")?o.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-gray-500",children:[o.jsx(Vl,{size:48,className:"mb-4 text-gray-300"}),o.jsx("h3",{className:"text-lg font-bold",children:"Access Restricted"}),o.jsx("p",{children:"You are listed as staff but have no assigned permissions."})]}):o.jsx(Nz,{user:t,userData:e,allowedTabs:a,staffTitle:s==null?void 0:s.roleName,currentView:n})}function Nhe({user:t,userData:e}){const{schoolData:n,studentProfile:r,internshipStudio:s,checkIn:i,checkOut:a}=jg(),[l,u]=N.useState(""),[d,f]=N.useState(!1),m=async()=>{f(!0);try{r!=null&&r.isClockedIn?(await a(l),u("")):await i((s==null?void 0:s.name)||"Remote Internship","studio")}catch(v){console.error(v)}f(!1)};if(!r)return o.jsx("div",{className:"p-8 text-center",children:"Loading student profile..."});const p=Math.min(100,(r.hoursLogged||0)/((n==null?void 0:n.requiredHours)||100)*100);return o.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6",children:[o.jsx("div",{className:"h-20 w-20 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-1",children:n!=null&&n.logoURL?o.jsx("img",{src:n.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):o.jsx(Sl,{size:32,className:"text-gray-400"})}),o.jsxs("div",{className:"flex-1 text-center md:text-left",children:[o.jsx("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight mb-1",children:(n==null?void 0:n.name)||"Internship Dashboard"}),o.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:[o.jsx("span",{className:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Active Intern"}),o.jsx("span",{children:""}),o.jsxs("span",{children:["Cohort: ",r.cohort]})]})]}),o.jsxs("div",{className:"text-right hidden md:block",children:[o.jsx("div",{className:"text-3xl font-black dark:text-white text-indigo-600",children:r.hoursLogged||0}),o.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider",children:"Total Hours"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"md:col-span-2 bg-gradient-to-br from-indigo-900 to-slate-900 text-white p-8 rounded-2xl relative overflow-hidden shadow-lg border border-indigo-800/50",children:[o.jsxs("div",{className:"relative z-10",children:[o.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest opacity-60 mb-2",children:"Assigned Studio Location"}),o.jsx("h2",{className:"text-3xl font-extrabold mb-4 tracking-tight",children:(s==null?void 0:s.name)||"Pending Assignment"}),s?o.jsxs("div",{className:"space-y-3 text-sm opacity-90",children:[o.jsxs("p",{className:"flex items-center gap-2",children:[o.jsx(cr,{size:18,className:"text-indigo-400"})," ",s.address||"Address not listed"]}),o.jsxs("p",{className:"flex items-center gap-2",children:[o.jsx(kr,{size:18,className:"text-green-400"})," Status: Active Placement"]})]}):o.jsxs("div",{className:"bg-white/10 p-4 rounded-xl flex items-start gap-3 border border-white/10",children:[o.jsx(da,{className:"text-yellow-400 shrink-0 mt-0.5",size:20}),o.jsx("p",{className:"text-sm leading-relaxed",children:"You haven't been assigned an internship location yet. Please contact your school coordinator to get placed."})]})]}),o.jsx("div",{className:"absolute -right-12 -bottom-12 w-64 h-64 bg-indigo-600/20 rounded-full blur-3xl"})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[o.jsx(Zr,{className:r.isClockedIn?"text-green-500 animate-pulse":"text-gray-400"}),r.isClockedIn?"Currently Working":"Time Clock"]}),r.isClockedIn&&o.jsx("textarea",{className:"w-full p-3 text-sm border rounded-xl mb-4 dark:bg-black/20 dark:border-gray-600 dark:text-white resize-none focus:ring-2 focus:ring-indigo-500 outline-none",rows:"4",placeholder:"Describe your tasks for this session...",value:l,onChange:v=>u(v.target.value)})]}),o.jsx("button",{onClick:m,disabled:d||!s&&!r.isClockedIn,className:`w-full py-3.5 rounded-xl font-bold text-white transition shadow-lg transform active:scale-95 ${d?"bg-gray-400":r.isClockedIn?"bg-red-500 hover:bg-red-600 shadow-red-500/30":"bg-green-600 hover:bg-green-700 shadow-green-600/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none"}`,children:d?"Processing...":r.isClockedIn?"Clock Out":"Clock In"})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[o.jsxs("div",{className:"flex justify-between text-sm font-bold mb-2",children:[o.jsx("span",{className:"dark:text-white",children:"Completion Progress"}),o.jsxs("span",{className:"text-indigo-600",children:[Math.round(p),"%"]})]}),o.jsx("div",{className:"w-full h-4 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-1000 ease-out",style:{width:`${p}%`}})}),o.jsxs("p",{className:"text-xs text-gray-500 mt-2 text-center",children:[r.hoursLogged," / ",(n==null?void 0:n.requiredHours)||100," Hours Required"]})]})]})}function She({user:t,onComplete:e,onSkip:n}){const[r,s]=N.useState(""),[i,a]=N.useState([]),[l,u]=N.useState(null),[d,f]=N.useState(""),[m,p]=N.useState(""),[v,x]=N.useState(!1),_=async k=>{if(k.length<3){a([]);return}const b=mt(Ce(Y,"schools"),zt("name",">=",k),zt("name","<=",k+"")),S=await Pt(b);a(S.docs.map(C=>({id:C.id,...C.data()})))},E=async()=>{if(!l||!d){p("Please select a school and enter your ID.");return}p(""),x(!0);try{await ft(ke(Y,"users",t.uid),{schoolId:l.id,studentId:d,accountTypes:["user","student"]}),e()}catch(k){console.error("Enrollment error:",k),p("Enrollment failed. Please try again.")}finally{x(!1)}};return o.jsxs("div",{className:"space-y-6",children:[o.jsx("h2",{className:"text-xl font-bold dark:text-white",children:"Student Enrollment"}),o.jsx("p",{className:"text-gray-500",children:"Search for your school and enter your student ID to link your account."}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Search for your school...",value:r,onChange:k=>{s(k.target.value),_(k.target.value)},className:"w-full pl-10 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white"}),o.jsx(ur,{className:"absolute left-3 top-3 text-gray-400",size:16})]}),r.length>0&&i.length>0&&o.jsx("div",{className:"border rounded-lg max-h-40 overflow-y-auto dark:border-gray-700 bg-white dark:bg-gray-800",children:i.map(k=>o.jsxs("div",{className:`p-3 cursor-pointer hover:bg-indigo-50 dark:hover:bg-gray-700/50 ${(l==null?void 0:l.id)===k.id?"bg-indigo-100 dark:bg-indigo-900/50":""}`,onClick:()=>{u(k),s(k.name),a([])},children:[o.jsx("div",{className:"font-medium dark:text-white",children:k.name}),o.jsxs("div",{className:"text-xs text-gray-500",children:[k.city,", ",k.state]})]},k.id))}),l&&o.jsxs("div",{className:"space-y-4 pt-4 animate-in fade-in slide-in-from-top-2",children:[o.jsxs("p",{className:"text-sm font-bold dark:text-white",children:["Selected: ",o.jsx("span",{className:"text-indigo-600",children:l.name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Student ID Number"}),o.jsx("input",{type:"text",value:d,onChange:k=>f(k.target.value),className:"w-full p-2 border rounded-lg mt-1 dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g., SESH00123"})]}),m&&o.jsx("p",{className:"text-red-500 text-sm",children:m}),o.jsx("button",{onClick:E,disabled:v||!d,className:"w-full bg-indigo-600 text-white p-2 rounded-lg font-bold hover:bg-indigo-700 transition disabled:opacity-50",children:v?"Verifying...":"Link Student Account"})]}),o.jsx("button",{onClick:n,className:"w-full text-sm text-gray-500 hover:text-indigo-600 mt-2",children:"Skip enrollment for now"})]})}const The={initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10}};function Ehe({children:t,className:e=""}){return o.jsx(tt.div,{initial:"initial",animate:"animate",exit:"exit",variants:The,transition:{duration:.3,ease:"easeOut"},className:e,children:t})}const Che=(t,e={},n={})=>{const r={message:(t==null?void 0:t.message)||"Unknown error",stack:t==null?void 0:t.stack,name:t==null?void 0:t.name,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,...e,context:n};try{const s=JSON.parse(localStorage.getItem("seshnx_errors")||"[]");s.unshift(r),s.splice(10),localStorage.setItem("seshnx_errors",JSON.stringify(s))}catch{}return r};class jhe extends Ve.Component{constructor(n){super(n);$b(this,"handleReset",()=>{if(this.setState({hasError:!1,error:null,errorInfo:null,errorId:null,copied:!1}),this.props.onReset)this.props.onReset();else{const n=window.location.pathname;n!=="/"&&n!=="/dashboard"?window.location.href="/?tab=dashboard":window.location.reload()}});$b(this,"handleCopyError",async()=>{var r,s,i;const n=`
Error ID: ${this.state.errorId}
Message: ${((r=this.state.error)==null?void 0:r.message)||"Unknown error"}
Stack: ${((s=this.state.error)==null?void 0:s.stack)||"No stack trace"}
Component Stack: ${((i=this.state.errorInfo)==null?void 0:i.componentStack)||"No component stack"}
URL: ${window.location.href}
User Agent: ${navigator.userAgent}
Timestamp: ${new Date().toISOString()}
    `.trim();try{await navigator.clipboard.writeText(n),this.setState({copied:!0}),setTimeout(()=>this.setState({copied:!1}),2e3)}catch(a){console.error("Failed to copy error:",a)}});this.state={hasError:!1,error:null,errorInfo:null,meme:"Unexpected signal chain failure.",errorId:null,copied:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorId:`ERR-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}componentDidCatch(n,r){const s={componentStack:r.componentStack,errorBoundary:this.props.name||"Default",props:this.props.context||{}},i=Che(n,r,s);this.setState({errorInfo:{...r,errorId:this.state.errorId||i.timestamp}})}componentDidMount(){const n=["CoreAudio Overload detected.","The plugin crashed the session.","Buffer underrun exception.","Who deleted the master fader?","Sample rate mismatch: Reality is 44.1k, we are 48k.","The drummer kicked the power cable.","Ilok license not found.","Fatal Error: Not enough headroom.","The mix bus is clipping... hard.","Phantom power failure."];this.setState({meme:n[Math.floor(Math.random()*n.length)]})}render(){var n,r;return this.state.hasError?o.jsx("div",{className:"min-h-screen bg-[#1f2128] flex flex-col items-center justify-center p-4 text-center text-white font-sans",children:o.jsxs("div",{className:"bg-[#2c2e36] border border-red-500/30 p-8 rounded-2xl shadow-2xl max-w-lg w-full relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-32 h-32 bg-red-500/20 blur-[50px] rounded-full pointer-events-none"}),o.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[o.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mb-6 text-red-500",children:o.jsx(kl,{size:32,strokeWidth:2})}),o.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Session Crashed"}),o.jsxs("p",{className:"text-xl text-[#3D84ED] font-medium mb-6 italic",children:['"',this.state.meme,'"']}),o.jsxs("div",{className:"bg-[#1f2128] p-4 rounded-lg w-full mb-6 text-left border border-gray-700",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider",children:"Error Details"}),o.jsx("button",{onClick:this.handleCopyError,className:"text-xs text-gray-400 hover:text-white flex items-center gap-1 transition-colors",title:"Copy error details",children:this.state.copied?o.jsxs(o.Fragment,{children:[o.jsx(Cs,{size:12}),"Copied!"]}):o.jsxs(o.Fragment,{children:[o.jsx(oE,{size:12}),"Copy"]})})]}),o.jsxs("div",{className:"space-y-2",children:[this.state.errorId&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-gray-500",children:"Error ID: "}),o.jsx("code",{className:"text-xs text-blue-400 font-mono",children:this.state.errorId})]}),o.jsx("code",{className:"text-sm text-red-400 font-mono break-words block",children:((n=this.state.error)==null?void 0:n.message)||"Unknown error occurred"}),((r=this.state.error)==null?void 0:r.stack)&&o.jsxs("details",{className:"mt-2",children:[o.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-400",children:"Stack Trace"}),o.jsx("pre",{className:"text-xs text-gray-400 font-mono mt-2 overflow-auto max-h-32",children:this.state.error.stack})]})]})]}),o.jsxs("div",{className:"flex gap-4 w-full",children:[o.jsx("button",{onClick:()=>window.history.back(),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-xl font-bold transition-all flex items-center justify-center gap-2",children:"Go Back"}),o.jsxs("button",{onClick:this.handleReset,className:"flex-1 bg-[#3D84ED] hover:bg-blue-600 text-white py-3 px-4 rounded-xl font-bold transition-all shadow-lg shadow-blue-500/20 flex items-center justify-center gap-2",children:[o.jsx(Lp,{size:18}),"Reload App"]})]})]})]})}):this.props.children}}function Ihe(){var ue,ve,ae,H;const[t,e]=N.useState(null),[n,r]=N.useState(null),[s,i]=N.useState({}),[a,l]=N.useState([]),[u,d]=N.useState(!0),[f,m]=N.useState(()=>typeof window<"u"&&new URLSearchParams(window.location.search).get("tab")||"dashboard"),p=Q=>{if(m(Q),new URLSearchParams(window.location.search).get("tab")!==Q){const re=`${window.location.pathname}?tab=${Q}`;window.history.pushState({tab:Q},"",re)}};N.useEffect(()=>{const Q=()=>{const re=new URLSearchParams(window.location.search).get("tab")||"dashboard";m(re)};return window.addEventListener("popstate",Q),()=>window.removeEventListener("popstate",Q)},[]);const[v,x]=N.useState(!1),[_,E]=N.useState(null),[k,b]=N.useState(0),[S,C]=N.useState(()=>typeof window<"u"?localStorage.getItem("theme")==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches:!1);N.useEffect(()=>{S?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[S]);const P=()=>C(!S),R=m4(su),I=o5(su);N.useEffect(()=>{const Q=Dq(R,async W=>{if(d(!0),W){e(W);const re=ke(I,`artifacts/${qe}/users/${W.uid}/profiles/main`),he=Qt(re,le=>{le.exists()?r(le.data()):r(null)}),ye=ke(I,`artifacts/${qe}/users/${W.uid}/wallet/account`),Me=Qt(ye,le=>{le.exists()&&b(le.data().balance||0)}),Fe=Ce(I,`artifacts/${qe}/users/${W.uid}/profiles`),G=Qt(Fe,le=>{const De={};le.forEach(Qe=>{Qe.id!=="main"&&(De[Qe.id]=Qe.data())}),i(De)});return l([{id:1,text:"Welcome to SeshNx!",type:"system",timestamp:new Date}]),d(!1),()=>{he(),Me(),G()}}else e(null),r(null),i({}),d(!1)});return()=>Q()},[]);const j=()=>dS(R),O=(Q,W)=>E({uid:Q,name:W}),V=async Q=>{if(t)try{const W=ke(I,`artifacts/${qe}/users/${t.uid}/profiles/main`);await ft(W,{activeProfileRole:Q})}catch(W){console.error("Role switch failed:",W)}};if(u)return o.jsx("div",{className:"h-screen flex items-center justify-center bg-gray-50 dark:bg-[#1a1d21]",children:o.jsx(Ye,{className:"animate-spin text-brand-blue",size:48})});if(!t)return o.jsx(iP,{darkMode:S,toggleTheme:P});if(t&&!n)return o.jsx(iP,{user:t,isNewUser:!0,darkMode:S,toggleTheme:P});const z=()=>{var Q,W,re;if(f.startsWith("edu-"))return f==="edu-enroll"?o.jsx(She,{user:t,userData:n}):(Q=n==null?void 0:n.accountTypes)!=null&&Q.includes("Admin")?o.jsx(Nz,{user:t,userData:n,currentView:f}):(W=n==null?void 0:n.accountTypes)!=null&&W.includes("Instructor")?o.jsx(khe,{user:t,userData:n,currentView:f}):(re=n==null?void 0:n.accountTypes)!=null&&re.includes("Intern")?o.jsx(Nhe,{user:t,userData:n,currentView:f}):o.jsx(ahe,{user:t,userData:n});switch(f){case"dashboard":case"home":return o.jsx(sP,{user:t,userData:n,subProfiles:s,notifications:a,setActiveTab:p,tokenBalance:k});case"feed":case"social":return o.jsx(Mce,{user:t,userData:n,openPublicProfile:O});case"bookings":case"find-talent":return o.jsx(que,{user:t,userData:n,openPublicProfile:O});case"marketplace":return o.jsx(ode,{user:t,userData:n,tokenBalance:k});case"messages":return o.jsx(jde,{user:t,userData:n,openPublicProfile:O});case"tech":return o.jsx(Zde,{user:t,userData:n});case"studio-ops":case"studio-manager":return o.jsx(Rde,{user:t,userData:n});case"label-manager":return o.jsx(ohe,{user:t,userData:n});case"payments":return o.jsx(ihe,{user:t,userData:n});case"profile":return o.jsx(Ode,{user:t,userData:n,subProfiles:s,handleLogout:j});case"settings":return o.jsx(wz,{user:t,userData:n,handleLogout:j});case"legal":return o.jsx(W6,{});default:return o.jsx(sP,{user:t,userData:n,setActiveTab:p,subProfiles:s,notifications:a})}},F=f.startsWith("edu-")&&(((ue=n==null?void 0:n.accountTypes)==null?void 0:ue.includes("Admin"))||((ve=n==null?void 0:n.accountTypes)==null?void 0:ve.includes("Instructor")));return o.jsx(Ole,{user:t,userData:n,children:o.jsxs("div",{className:"flex h-screen flex-col bg-gray-50 dark:bg-[#1a1d21] overflow-hidden selection:bg-brand-blue selection:text-white",children:[o.jsx(Zae,{position:"bottom-right",toastOptions:{style:{background:"#333",color:"#fff"},success:{style:{background:"green"},iconTheme:{primary:"white",secondary:"green"}},error:{style:{background:"red"}}}}),o.jsx(Mle,{user:t,userData:n,subProfiles:s,onMenuClick:()=>x(!v),setActiveTab:p,activeTab:f,tokenBalance:k,darkMode:S,toggleTheme:P,onRoleSwitch:V,openPublicProfile:O}),o.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[o.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 transform transition-transform duration-300 ease-in-out md:relative md:translate-x-0 ${v?"translate-x-0 shadow-2xl":"-translate-x-full"} bg-white dark:bg-[#23262f] border-r dark:border-gray-800`,children:F?o.jsx(Vle,{activeTab:f,setActiveTab:p,sidebarOpen:v,setSidebarOpen:x,isStaff:(ae=n.accountTypes)==null?void 0:ae.includes("Instructor"),isAdmin:(H=n.accountTypes)==null?void 0:H.includes("Admin")}):o.jsx(Dle,{activeTab:f,setActiveTab:p,sidebarOpen:v,setSidebarOpen:x,userData:n,handleLogout:j})}),o.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 scroll-smooth",id:"main-scroll",children:o.jsx(Zn,{mode:"wait",children:o.jsx(Ehe,{className:"max-w-7xl mx-auto",children:z()},f)})})]}),o.jsx(Zn,{children:_&&o.jsx($de,{userId:_.uid,currentUser:t,currentUserData:n,onClose:()=>E(null),onMessage:(Q,W)=>{E(null),p("messages")}})})]})})}_w.createRoot(document.getElementById("root")).render(o.jsx(Ve.StrictMode,{children:o.jsx(jhe,{name:"Root",children:o.jsx(G9,{client:Ble,children:o.jsx(Ihe,{})})})}));const Ahe=()=>{const t=document.getElementById("loading-fallback");t&&(t.classList.add("fade-out"),setTimeout(()=>{t&&t.parentNode&&t.parentNode.removeChild(t),document.body.style.overflow="auto"},500))};setTimeout(Ahe,800);
