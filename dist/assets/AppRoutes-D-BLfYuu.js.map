{"version":3,"mappings":"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","names":["retryLazyLoad","importFn","retries","delay","lazy","resolve","reject","attempt","attemptNumber","promise","module","error","DebugReport","SettingsTab","ProtectedRoute","children","user","loading","navigate","useNavigate","jsx","Loader2","useEffect","Redirect","to","replace","location","useLocation","AppRoutes","userData","darkMode","toggleTheme","handleLogout","Routes","Route","Suspense","newSettings","supabase","err","newRole"],"ignoreList":[],"sources":["../../src/routes/AppRoutes.jsx"],"sourcesContent":["import React, { lazy, Suspense, useEffect } from 'react';\nimport { Routes, Route, useNavigate, useLocation } from 'react-router-dom';\nimport { supabase } from '../config/supabase';\nimport { Loader2 } from 'lucide-react';\n\n// Retry wrapper for lazy loading to handle network errors and failed imports\nconst retryLazyLoad = (importFn, retries = 3, delay = 100) => {\n  return lazy(() => {\n    return new Promise((resolve, reject) => {\n      const attempt = (attemptNumber) => {\n        // Wrap in try-catch to handle synchronous errors\n        try {\n          const promise = importFn();\n          // If it's already a promise, handle it\n          if (promise && typeof promise.then === 'function') {\n            promise\n              .then((module) => {\n                // Ensure we get the default export\n                resolve(module.default ? module : { default: module });\n              })\n              .catch((error) => {\n                if (attemptNumber < retries) {\n                  console.warn(`Lazy load failed, retrying... (${attemptNumber + 1}/${retries})`, error);\n                  setTimeout(() => attempt(attemptNumber + 1), delay * (attemptNumber + 1));\n                } else {\n                  console.error('Lazy load failed after retries:', error);\n                  reject(error);\n                }\n              });\n          } else {\n            resolve(promise);\n          }\n        } catch (error) {\n          // Handle synchronous errors (like circular dependencies)\n          if (attemptNumber < retries) {\n            console.warn(`Lazy load sync error, retrying... (${attemptNumber + 1}/${retries})`, error);\n            setTimeout(() => attempt(attemptNumber + 1), delay * (attemptNumber + 1));\n          } else {\n            console.error('Lazy load failed after retries (sync error):', error);\n            reject(error);\n          }\n        }\n      };\n      attempt(0);\n    });\n  });\n};\n\n// Lazy load components to avoid circular dependencies with retry mechanism\n// Note: Dashboard is handled by MainLayout, not needed here\nconst DebugReport = retryLazyLoad(() => import('../components/DebugReport'));\nconst ProfileManager = retryLazyLoad(() => import('../components/ProfileManager'));\nconst SettingsTab = retryLazyLoad(() => import('../components/SettingsTab'));\n\n/**\n * Protected Route Wrapper\n * \n * Protects routes and redirects to login if user is not authenticated\n * Uses useNavigate hook instead of Navigate component to avoid initialization issues\n */\nfunction ProtectedRoute({ children, user, loading }) {\n  const navigate = useNavigate();\n  \n  // Show loading while checking auth\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"animate-spin text-brand-blue\" size={32} />\n      </div>\n    );\n  }\n  \n  // Check if user is authenticated - use useEffect to navigate to avoid initialization issues\n  useEffect(() => {\n    if (!user && !loading) {\n      navigate('/login', { replace: true });\n    }\n  }, [user, loading, navigate]);\n  \n  // Don't render children if user is not authenticated\n  if (!user) {\n    return null;\n  }\n  \n  return children;\n}\n\n/**\n * Redirect Component\n * \n * Uses useNavigate hook instead of Navigate component to avoid initialization issues\n */\nfunction Redirect({ to, replace = true }) {\n  const navigate = useNavigate();\n  const location = useLocation();\n  \n  useEffect(() => {\n    if (location.pathname !== to) {\n      navigate(to, { replace });\n    }\n  }, [to, replace, navigate, location.pathname]);\n  \n  return null;\n}\n\n/**\n * AppRoutes - Full routing with all modules\n * MainLayout handles most routes, but Settings and Debug Report use direct routes\n */\nexport default function AppRoutes({ user, userData, loading, darkMode, toggleTheme, handleLogout }) {\n  return (\n    <Routes>\n      {/* MainLayout handles these routes internally via activeTab */}\n      {/* Dashboard and all main modules are handled by MainLayout */}\n      <Route path=\"/\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/feed\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/messages\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/bookings\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/marketplace\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/tech\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/payments\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/profile\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/business-center\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/legal\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-student\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-intern\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-overview\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/edu-admin\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      <Route path=\"/studio-ops\" element={<ProtectedRoute user={user} loading={loading}><div /></ProtectedRoute>} />\n      \n      {/* Debug Report Route - Test login destination */}\n      <Route \n        path=\"/debug-report\" \n        element={\n          <ProtectedRoute user={user} loading={loading}>\n            <Suspense fallback={<div className=\"flex items-center justify-center min-h-screen\"><Loader2 className=\"animate-spin text-brand-blue\" size={32} /></div>}>\n              <DebugReport \n                user={user} \n                userData={userData}\n              />\n            </Suspense>\n          </ProtectedRoute>\n        } \n      />\n      \n      {/* Settings Route - Uses direct route */}\n      <Route \n        path=\"/settings\" \n        element={\n          <ProtectedRoute user={user} loading={loading}>\n            <Suspense fallback={<div className=\"flex items-center justify-center min-h-screen\"><Loader2 className=\"animate-spin text-brand-blue\" size={32} /></div>}>\n              <SettingsTab \n              user={user} \n              userData={userData}\n              onUpdate={async (newSettings) => {\n                // Save settings to database\n                if (user?.id && supabase) {\n                  try {\n                    const { error } = await supabase\n                      .from('profiles')\n                      .update({ \n                        settings: newSettings, \n                        updated_at: new Date().toISOString() \n                      })\n                      .eq('id', user.id);\n                    \n                    if (error) {\n                      console.error('Settings save failed:', error);\n                    }\n                  } catch (err) {\n                    console.error('Settings save error:', err);\n                  }\n                }\n              }}\n              onRoleSwitch={async (newRole) => {\n                // Role switch - update active role in database\n                if (user?.id && supabase) {\n                  try {\n                    await supabase\n                      .from('profiles')\n                      .update({ \n                        active_role: newRole, \n                        updated_at: new Date().toISOString() \n                      })\n                      .eq('id', user.id);\n                    console.log('Role switched to:', newRole);\n                  } catch (err) {\n                    console.error('Role switch failed:', err);\n                  }\n                }\n              }}\n            />\n            </Suspense>\n          </ProtectedRoute>\n        } \n      />\n      \n      {/* Redirect dashboard aliases */}\n      <Route path=\"/dashboard\" element={<Redirect to=\"/\" />} />\n      <Route path=\"/home\" element={<Redirect to=\"/\" />} />\n      <Route path=\"/social\" element={<Redirect to=\"/feed\" />} />\n      <Route path=\"/chat\" element={<Redirect to=\"/messages\" />} />\n      <Route path=\"/billing\" element={<Redirect to=\"/payments\" />} />\n      \n      {/* Fallback - redirect to dashboard */}\n      <Route path=\"*\" element={<Redirect to=\"/\" />} />\n    </Routes>\n  );\n}\n\n"],"file":"assets/AppRoutes-D-BLfYuu.js"}