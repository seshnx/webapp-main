import{r as o}from"./vendor-mIyI6DiM.js";import{D as g,F as h,G as N,H as m,I as k,J as A}from"./index-BCKV8ync.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3134a7ad-ba21-4e33-8c6a-e69af7094b6c",e._sentryDebugIdIdentifier="sentry-dbid-3134a7ad-ba21-4e33-8c6a-e69af7094b6c")})()}catch{}function D(e,t=50){const[c,s]=o.useState([]),[r,f]=o.useState(0),[d,n]=o.useState(!0);o.useEffect(()=>{if(!e){n(!1);return}const a=async()=>{try{const p=(await k(e,{limit:t,deleted:!1})).map(i=>({id:i.id,...i,timestamp:i.created_at,read:i.read||!1}));s(p),f(p.filter(i=>!i.read).length),n(!1)}catch(b){console.error("Notifications fetch error:",b),n(!1)}};a();const l=setInterval(()=>{a()},3e4);return()=>{clearInterval(l)}},[e,t]);const u=o.useCallback(async a=>{if(e)try{await g(a)}catch(l){console.error("Mark as read error:",l)}},[e]),y=o.useCallback(async()=>{if(!(!e||r===0))try{await h(e)}catch(a){console.error("Mark all as read error:",a)}},[e,r]),_=o.useCallback(async a=>{if(e)try{await N(a)}catch(l){console.error("Delete notification error:",l)}},[e]),w=o.useCallback(async()=>{if(e)try{await m(e)}catch(a){console.error("Clear all error:",a)}},[e]);return{notifications:c.filter(a=>!a.deleted),unreadCount:r,loading:d,markAsRead:u,markAllAsRead:y,deleteNotification:_,clearAll:w}}async function R({targetUserId:e,type:t,fromUserId:c,fromUserName:s,fromUserPhoto:r,postId:f=null,postPreview:d=null,commentId:n=null,message:u}){if(!(!e||e===c))try{await A({user_id:e,type:t,from_user_id:c,from_user_name:s,from_user_photo:r||null,post_id:f,post_preview:d,comment_id:n,message:u,metadata:{postId:f,postPreview:d,commentId:n,fromUserName:s,fromUserPhoto:r}})}catch(y){console.error("Create notification error:",y)}}export{R as c,D as u};
