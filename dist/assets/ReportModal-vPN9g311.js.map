{"version":3,"file":"ReportModal-vPN9g311.js","sources":["../../src/assets/Fevicon.png","../../src/components/shared/StarFieldVisualizer.jsx","../../src/utils/moderation.js","../../src/components/ReportModal.jsx"],"sourcesContent":["export default \"__VITE_ASSET__6c4itX74__\"","import React, { useState, useEffect, useRef } from 'react';\nimport { Play, Pause, AlertCircle, Music, Lock, Loader2 } from 'lucide-react';\nimport WaveSurfer from 'wavesurfer.js';\nimport Fevicon from '../../assets/Fevicon.png';\n\nexport default function StarFieldVisualizer({ audioUrl, fileName = \"Audio Track\", previewMode = false }) {\n    const containerRef = useRef(null);\n    const canvasRef = useRef(null);\n    const audioRef = useRef(null);\n    const waveformRef = useRef(null);\n    const wavesurfer = useRef(null);\n    const animationRef = useRef(null);\n    \n    // Unique ID for this player instance to identify itself in global events\n    const playerId = useRef(Math.random().toString(36).substr(2, 9)); \n\n    // Audio Context Refs\n    const contextRef = useRef(null);\n    const analyserRef = useRef(null);\n    const sourceRef = useRef(null);\n\n    // State\n    const [isPlaying, setIsPlaying] = useState(false);\n    const [isReady, setIsReady] = useState(false);\n    const [corsError, setCorsError] = useState(false);\n    const [isInitialized, setIsInitialized] = useState(false);\n\n    // Theme Detection State\n    const [isDarkMode, setIsDarkMode] = useState(document.documentElement.classList.contains('dark'));\n    const themeRef = useRef(isDarkMode);\n\n    const THEME_CONFIG = {\n        dark: {\n            star: \"rgba(255, 255, 255, 0.5)\", \n            star2: \"rgba(255, 255, 255, 0.8)\", \n            special: \"#3D84ED\",\n            wave: \"rgba(255, 255, 255, 0.3)\"\n        },\n        light: {\n            star: \"rgba(0, 0, 0, 0.5)\",       \n            star2: \"rgba(0, 0, 0, 0.8)\",      \n            special: \"#2563EB\",\n            wave: \"rgba(0, 0, 0, 0.2)\"        \n        }\n    };\n\n    const TOTAL_STARS = 400;\n    const STARS_BREAK_POINT = 120;\n    const AVG_BREAK_POINT = 80;\n\n    const state = useRef({\n        stars: [],\n        avg: 0,\n        width: 0,\n        height: 0,\n        cx: 0,\n        cy: 0\n    });\n\n    // --- 1. THEME LISTENER ---\n    useEffect(() => {\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                if (mutation.attributeName === 'class') {\n                    const isDark = document.documentElement.classList.contains('dark');\n                    setIsDarkMode(isDark);\n                    themeRef.current = isDark;\n                    if (wavesurfer.current) {\n                        wavesurfer.current.setOptions({\n                            waveColor: isDark ? THEME_CONFIG.dark.wave : THEME_CONFIG.light.wave\n                        });\n                    }\n                }\n            });\n        });\n        observer.observe(document.documentElement, { attributes: true });\n        return () => observer.disconnect();\n    }, []);\n\n    // --- 2. SETUP WAVESURFER & GLOBAL AUDIO MANAGEMENT ---\n    useEffect(() => {\n        if (!audioRef.current || !waveformRef.current) return;\n\n        const currentTheme = isDarkMode ? THEME_CONFIG.dark : THEME_CONFIG.light;\n\n        wavesurfer.current = WaveSurfer.create({\n            container: waveformRef.current,\n            waveColor: currentTheme.wave,\n            progressColor: '#3D84ED',\n            cursorColor: '#3D84ED',\n            barWidth: 4,\n            barGap: 3,\n            barRadius: 3,\n            height: 100,\n            responsive: true,\n            normalize: true,\n            backend: 'MediaElement',\n            media: audioRef.current,\n            minPxPerSec: 50,\n            fillParent: true,\n            interact: !previewMode,\n            cursorWidth: 2,\n            barAlign: 'bottom',\n        });\n\n        // --- GLOBAL EVENT LISTENER ---\n        // When another player starts, this function runs. If the ID doesn't match ours, we pause.\n        const handleGlobalPlay = (e) => {\n            if (e.detail.id !== playerId.current && wavesurfer.current && wavesurfer.current.isPlaying()) {\n                wavesurfer.current.pause();\n            }\n        };\n        window.addEventListener('seshnx-audio-play', handleGlobalPlay);\n\n        wavesurfer.current.on('ready', () => setIsReady(true));\n        \n        wavesurfer.current.on('play', () => {\n            setIsPlaying(true);\n            // Broadcast to all other players that WE are playing\n            window.dispatchEvent(new CustomEvent('seshnx-audio-play', { detail: { id: playerId.current } }));\n        });\n\n        wavesurfer.current.on('pause', () => setIsPlaying(false));\n        \n        wavesurfer.current.on('finish', () => {\n            setIsPlaying(false);\n            cancelAnimationFrame(animationRef.current);\n        });\n\n        return () => {\n            window.removeEventListener('seshnx-audio-play', handleGlobalPlay);\n            if (wavesurfer.current) wavesurfer.current.destroy();\n            cancelAnimationFrame(animationRef.current);\n        };\n    }, [audioUrl, previewMode]);\n\n    // --- 3. STARFIELD SETUP ---\n    useEffect(() => {\n        const handleResize = () => {\n            if(containerRef.current && canvasRef.current) {\n                const { clientWidth, clientHeight } = containerRef.current;\n                canvasRef.current.width = clientWidth;\n                canvasRef.current.height = clientHeight;\n                state.current.width = clientWidth;\n                state.current.height = clientHeight;\n                state.current.cx = clientWidth / 2;\n                state.current.cy = clientHeight / 2;\n                initStars(); \n            }\n        };\n\n        window.addEventListener('resize', handleResize);\n        handleResize(); \n        \n        return () => {\n            window.removeEventListener('resize', handleResize);\n            if(contextRef.current && contextRef.current.state !== 'closed') {\n                contextRef.current.close();\n            }\n        };\n    }, []);\n\n    const initStars = () => {\n        state.current.stars = [];\n        for(let i=0; i<TOTAL_STARS; i++) {\n            state.current.stars.push({\n                x: Math.random() * state.current.width - state.current.cx,\n                y: Math.random() * state.current.height - state.current.cy,\n                z: Math.random() * state.current.width\n            });\n        }\n    };\n\n    const setupAudioAnalysis = () => {\n        if (isInitialized || corsError || !audioRef.current) return;\n        try {\n            const AudioContext = window.AudioContext || window.webkitAudioContext;\n            contextRef.current = new AudioContext();\n            analyserRef.current = contextRef.current.createAnalyser();\n            analyserRef.current.fftSize = 2048;\n            sourceRef.current = contextRef.current.createMediaElementSource(audioRef.current);\n            sourceRef.current.connect(analyserRef.current);\n            analyserRef.current.connect(contextRef.current.destination);\n            setIsInitialized(true);\n        } catch (e) {\n            console.warn(\"Audio Context Error:\", e);\n        }\n    };\n\n    const togglePlay = async (e) => {\n        e.stopPropagation(); \n        \n        if (!isInitialized) setupAudioAnalysis();\n        if (contextRef.current?.state === 'suspended') await contextRef.current.resume();\n        if (wavesurfer.current) wavesurfer.current.playPause();\n        if (!isPlaying) renderLoop(); \n    };\n\n    const renderLoop = () => {\n        if(!canvasRef.current) return;\n        const ctx = canvasRef.current.getContext('2d');\n        const { width: w, height: h, cx, cy, stars } = state.current;\n        \n        let avg = 0;\n        if (analyserRef.current) {\n            const bufferLength = analyserRef.current.frequencyBinCount;\n            const freqData = new Uint8Array(bufferLength);\n            analyserRef.current.getByteFrequencyData(freqData);\n            let sum = 0;\n            for(let i=0; i<freqData.length; i++) sum += freqData[i];\n            avg = sum / freqData.length;\n        }\n        state.current.avg = avg;\n\n        // Clear canvas\n        ctx.clearRect(0, 0, w, h);\n        \n        const theme = themeRef.current ? THEME_CONFIG.dark : THEME_CONFIG.light;\n        const speed = (avg > AVG_BREAK_POINT) ? avg/10 : avg/30 + 0.5;\n\n        stars.forEach(star => {\n            star.z -= speed; \n            if(star.z <= 0) {\n                star.z = w;\n                star.x = Math.random() * w - cx;\n                star.y = Math.random() * h - cy;\n            }\n\n            const x = (star.x / star.z) * w + cx;\n            const y = (star.y / star.z) * h + cy;\n            const size = (1 - star.z / w) * 2.5;\n            \n            if(x >= 0 && x <= w && y >= 0 && y <= h) {\n                ctx.fillStyle = (avg > STARS_BREAK_POINT) ? theme.special : theme.star;\n                ctx.globalAlpha = (1 - star.z / w); \n                ctx.beginPath();\n                ctx.arc(x, y, size, 0, Math.PI * 2);\n                ctx.fill();\n                ctx.globalAlpha = 1.0; \n            }\n        });\n\n        if (wavesurfer.current && wavesurfer.current.isPlaying()) {\n            animationRef.current = requestAnimationFrame(renderLoop);\n        }\n    };\n\n    return (\n        <div \n            ref={containerRef} \n            className=\"relative w-full h-32 rounded-xl overflow-hidden group bg-transparent transition-colors\"\n        >\n            {/* 1. BACKGROUND: Transparent Starfield */}\n            <canvas ref={canvasRef} className=\"w-full h-full absolute inset-0 z-0 pointer-events-none\" />\n\n            {/* 2. FOREGROUND: Wavesurfer */}\n            <div className=\"absolute inset-0 z-20 flex flex-col justify-end pointer-events-none\">\n                <div ref={waveformRef} className=\"w-full pointer-events-auto opacity-80 hover:opacity-100 transition-opacity\" />\n            </div>\n\n            {/* 3. OVERLAY: Header Info */}\n            <div className=\"absolute top-0 left-0 right-0 p-3 z-30 flex justify-between items-start pointer-events-none\">\n                <div className=\"flex items-center gap-2 text-black dark:text-white/90\">\n                    <Music size={16} className=\"text-brand-blue\" />\n                    <span className=\"text-sm font-medium truncate max-w-[200px] shadow-sm\">{fileName}</span>\n                    {previewMode && <span className=\"text-[10px] bg-yellow-500 text-black px-2 rounded font-bold flex items-center gap-1\"><Lock size={8}/> PREVIEW</span>}\n                </div>\n                {corsError && (\n                    <div className=\"bg-red-500/80 text-white text-[10px] px-2 py-0.5 rounded flex items-center gap-1\">\n                        <AlertCircle size={10}/> Visuals Disabled\n                    </div>\n                )}\n            </div>\n\n            {/* 4. BRANDING: Favicon (Bottom Left) */}\n            <div className=\"absolute bottom-2 left-2 z-30 opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none\">\n                <img src={Fevicon} alt=\"SeshNx\" className=\"w-5 h-5 object-contain\" />\n            </div>\n\n            {/* 5. OVERLAY: Controls Layer */}\n            <div \n                className={`absolute inset-0 z-40 flex items-center justify-center transition-opacity duration-300 pointer-events-none\n                ${isPlaying ? 'opacity-0 group-hover:opacity-100 bg-white/20 dark:bg-black/20' : 'opacity-100 bg-white/10 dark:bg-black/10'}`}\n            >\n                {!isReady ? (\n                    <Loader2 className=\"animate-spin text-brand-blue\" size={32} />\n                ) : (\n                    <button \n                        onClick={togglePlay} \n                        className=\"w-14 h-14 bg-white/80 dark:bg-black/40 rounded-full flex items-center justify-center border border-gray-200 dark:border-white/40 text-brand-blue shadow-lg hover:scale-110 transition-transform pointer-events-auto\"\n                    >\n                        {isPlaying ? <Pause fill=\"currentColor\" className=\"ml-0.5\" size={24}/> : <Play fill=\"currentColor\" className=\"ml-1\" size={24}/>}\n                    </button>\n                )}\n            </div>\n\n            {/* HIDDEN AUDIO ELEMENT */}\n            <audio \n                ref={audioRef} \n                src={audioUrl} \n                crossOrigin=\"anonymous\"\n                onError={() => setCorsError(true)}\n            />\n        </div>\n    );\n}\n","import { supabase } from '../config/supabase';\r\n\r\nexport const REPORT_REASONS = [\r\n    \"Spam or commercial solicitation\",\r\n    \"Harassment or bullying\",\r\n    \"Hate speech\",\r\n    \"Nudity or sexual activity\",\r\n    \"Violence or dangerous organizations\",\r\n    \"Copyright / Intellectual Property Violation\",\r\n    \"Scam or fraud\",\r\n    \"Other\"\r\n];\r\n\r\n/**\r\n * Submits a report to the global moderation queue.\r\n * If the reporter is School Faculty/Admin reporting content from their own school,\r\n * it can optionally trigger an immediate 'Hidden' state locally.\r\n */\r\nexport const submitReport = async ({\r\n    contentId,\r\n    contentType, // 'post', 'comment', 'user', 'message', 'market_item'\r\n    contentSummary, // Short text preview or ID for context\r\n    reporterId,\r\n    reporterName,\r\n    reason,\r\n    description = '',\r\n    schoolId = null, // If reporting within a school context\r\n    isFacultyAction = false // Logic to hide immediately\r\n}) => {\r\n    if (!supabase) {\r\n        return { success: false, error: 'Supabase not initialized' };\r\n    }\r\n\r\n    try {\r\n        // 1. Create the Ticket in the Global Queue\r\n        // Using moderation_reports table (create if doesn't exist via schema)\r\n        const { error: reportError } = await supabase\r\n            .from('moderation_reports')\r\n            .insert({\r\n                type: 'Report',\r\n                status: 'Open', // Admin App filters by 'Open'\r\n                priority: isFacultyAction ? 'High' : 'Normal',\r\n                \r\n                // Target Data\r\n                target_id: contentId,\r\n                target_type: contentType,\r\n                target_summary: contentSummary || 'No preview available',\r\n                \r\n                // Reporter Data\r\n                reporter_id: reporterId,\r\n                reporter_name: reporterName,\r\n                \r\n                // Context\r\n                reason,\r\n                description,\r\n                school_id: schoolId, // Helps Admins filter by school if needed\r\n                \r\n                created_at: new Date().toISOString()\r\n            });\r\n\r\n        if (reportError) {\r\n            // If table doesn't exist, fall back to documents table\r\n            if (reportError.code === '42P01') {\r\n                const { error: docError } = await supabase\r\n                    .from('documents')\r\n                    .insert({\r\n                        collection_path: 'moderation_queue',\r\n                        id: `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n                        data: {\r\n                            type: 'Report',\r\n                            status: 'Open',\r\n                            priority: isFacultyAction ? 'High' : 'Normal',\r\n                            targetId: contentId,\r\n                            targetType: contentType,\r\n                            targetSummary: contentSummary || 'No preview available',\r\n                            reporterId,\r\n                            reporterName,\r\n                            reason,\r\n                            description,\r\n                            schoolId,\r\n                            timestamp: Date.now()\r\n                        },\r\n                        public_read: false\r\n                    });\r\n                \r\n                if (docError) throw docError;\r\n            } else {\r\n                throw reportError;\r\n            }\r\n        }\r\n\r\n        // 2. Immediate Action (Faculty Only)\r\n        // If a teacher flags a post, we hide it immediately on the client side\r\n        // to preserve campus safety while the global admin reviews it.\r\n        if (isFacultyAction && (contentType === 'post' || contentType === 'comment')) {\r\n            const tableName = contentType === 'post' ? 'posts' : 'comments';\r\n            \r\n            // Try to update in proper table, fall back to documents if needed\r\n            const { error: updateError } = await supabase\r\n                .from(tableName)\r\n                .update({\r\n                    visibility: 'Hidden',\r\n                    moderation_status: 'Flagged',\r\n                    flagged_by: reporterId,\r\n                    flagged_at: new Date().toISOString(),\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', contentId);\r\n\r\n            // If table doesn't exist, use documents table\r\n            if (updateError && updateError.code === '42P01') {\r\n                const collectionPath = `artifacts/${import.meta.env.VITE_APP_ID || 'seshnx-70c04'}/public/data/${contentType === 'post' ? 'posts' : 'comments'}`;\r\n                const { error: docUpdateError } = await supabase\r\n                    .from('documents')\r\n                    .update({\r\n                        data: {\r\n                            visibility: 'Hidden',\r\n                            moderationStatus: 'Flagged',\r\n                            flaggedBy: reporterId,\r\n                            flaggedAt: Date.now()\r\n                        },\r\n                        updated_at: new Date().toISOString()\r\n                    })\r\n                    .eq('collection_path', collectionPath)\r\n                    .eq('id', contentId);\r\n                \r\n                if (docUpdateError) throw docUpdateError;\r\n            } else if (updateError) {\r\n                throw updateError;\r\n            }\r\n        }\r\n\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error(\"Reporting failed:\", error);\r\n        return { success: false, error };\r\n    }\r\n};\r\n","import React, { useState } from 'react';\r\nimport { X, Flag, AlertTriangle, Loader2 } from 'lucide-react';\r\nimport { REPORT_REASONS, submitReport } from '../utils/moderation'; // Import constants and submission helper\r\n\r\n/**\r\n * Modal component for users to submit a moderation report against content or another user.\r\n * * @param {Object} props\r\n * @param {Object} props.user - Current authenticated user object ({ uid, displayName })\r\n * @param {Object} props.target - Object defining the target: { id: string, type: string, summary: string }\r\n * @param {function} props.onClose - Function to close the modal\r\n */\r\nexport default function ReportModal({ user, target, onClose }) {\r\n    const [reason, setReason] = useState(REPORT_REASONS[0]);\r\n    const [description, setDescription] = useState('');\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [submitted, setSubmitted] = useState(false);\r\n\r\n    const handleSubmit = async () => {\r\n        if (!reason || !user?.uid) return;\r\n\r\n        setSubmitting(true);\r\n        try {\r\n            const result = await submitReport({\r\n                contentId: target.id,\r\n                contentType: target.type,\r\n                contentSummary: target.summary,\r\n                reporterId: user?.id || user?.uid,\r\n                reporterName: user.displayName || 'Anonymous User',\r\n                reason: reason,\r\n                description: description\r\n                // Note: schoolId and isFacultyAction are omitted for a general user report flow\r\n            });\r\n\r\n            if (result.success) {\r\n                setSubmitted(true);\r\n                setTimeout(onClose, 2000); \r\n            } else {\r\n                alert(\"Failed to submit report. Please try again.\");\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Submission error:\", e);\r\n            alert(\"An unexpected error occurred during submission.\");\r\n        }\r\n        setSubmitting(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4\">\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-lg animate-in fade-in zoom-in-95 duration-200\">\r\n                <div className=\"p-6\">\r\n                    <div className=\"flex justify-between items-start mb-4\">\r\n                        <h3 className=\"font-bold text-xl dark:text-white flex items-center gap-2 text-red-500\">\r\n                            <AlertTriangle size={24} /> Report Violation\r\n                        </h3>\r\n                        <button onClick={onClose} className=\"text-gray-500 hover:text-gray-800 dark:text-gray-400 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition\"><X size={20} /></button>\r\n                    </div>\r\n\r\n                    <div className=\"text-sm text-gray-600 dark:text-gray-300 mb-6\">\r\n                        You are reporting a violation regarding: <strong className=\"font-bold\">{target.summary}</strong> ({target.type})\r\n                    </div>\r\n\r\n                    {submitted ? (\r\n                        <div className=\"text-center py-12\">\r\n                            <Flag size={48} className=\"text-green-500 mx-auto mb-4\"/>\r\n                            <h4 className=\"font-bold text-lg dark:text-white\">Report Submitted!</h4>\r\n                            <p className=\"text-sm text-gray-500\">Thank you for helping keep the community safe. We will review this shortly.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-4\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Reason for Report</label>\r\n                                <select\r\n                                    className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm\"\r\n                                    value={reason}\r\n                                    onChange={e => setReason(e.target.value)}\r\n                                >\r\n                                    {REPORT_REASONS.map(r => (\r\n                                        <option key={r} value={r}>{r}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Additional Details (Optional)</label>\r\n                                <textarea\r\n                                    className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm resize-none\"\r\n                                    rows=\"3\"\r\n                                    placeholder=\"Provide any further context or relevant details.\"\r\n                                    value={description}\r\n                                    onChange={e => setDescription(e.target.value)}\r\n                                />\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={handleSubmit}\r\n                                disabled={submitting}\r\n                                className=\"w-full bg-red-600 text-white py-3 rounded-xl font-bold hover:bg-red-700 transition disabled:opacity-50 flex items-center justify-center gap-2 shadow-md\"\r\n                            >\r\n                                {submitting ? <Loader2 className=\"animate-spin\" size={18}/> : <><Flag size={18}/> Submit Report</>}\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":["Fevicon","StarFieldVisualizer","audioUrl","fileName","previewMode","containerRef","useRef","canvasRef","audioRef","waveformRef","wavesurfer","animationRef","playerId","contextRef","analyserRef","sourceRef","isPlaying","setIsPlaying","useState","isReady","setIsReady","corsError","setCorsError","isInitialized","setIsInitialized","isDarkMode","setIsDarkMode","themeRef","THEME_CONFIG","TOTAL_STARS","STARS_BREAK_POINT","AVG_BREAK_POINT","state","useEffect","observer","mutations","mutation","isDark","currentTheme","WaveSurfer","handleGlobalPlay","e","handleResize","clientWidth","clientHeight","initStars","i","setupAudioAnalysis","AudioContext","togglePlay","_a","renderLoop","ctx","w","h","cx","cy","stars","avg","bufferLength","freqData","sum","theme","speed","star","x","y","size","jsxs","jsx","Music","Lock","AlertCircle","Pause","Play","Loader2","REPORT_REASONS","submitReport","contentId","contentType","contentSummary","reporterId","reporterName","reason","description","schoolId","isFacultyAction","ReportModal","user","target","onClose","setReason","setDescription","submitting","setSubmitting","submitted","setSubmitted","handleSubmit","AlertTriangle","X","Flag","r","Fragment"],"mappings":"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"}