import{r as n,j as e,a0 as j,L as v,bQ as L}from"./vendor-CBQkcJic.js";import{f as N}from"./edu-DZWLcEtQ.js";function E({initialZip:o="",onLocationChange:c,showMap:k=!1,label:h="Location"}){const[u,i]=n.useState(o),[f,l]=n.useState(""),[d,r]=n.useState(!1),[w,m]=n.useState(null);n.useEffect(()=>{o&&o!==u&&(i(o),g(o))},[o]);const g=async s=>{const a=s.replace(/\D/g,"").slice(0,5);if(i(a),a.length===5){r(!0);const t=await N(a);t?(l(t.cityState),m({lat:t.lat,lng:t.lng}),c({zip:a,...t})):(l("Unknown Location"),c({zip:a,valid:!1})),r(!1)}else l("")},y=()=>{if(!navigator.geolocation)return alert("Geolocation not supported");r(!0),navigator.geolocation.getCurrentPosition(async s=>{const{latitude:a,longitude:t}=s.coords;try{const x=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${a}&lon=${t}`)).json()).address.postcode;if(x){const b=x.split("-")[0];i(b),g(b)}else m({lat:a,lng:t}),l("Current Location"),c({lat:a,lng:t,name:"Current Location",valid:!0})}catch(p){console.error(p),alert("Failed to determine location.")}r(!1)},s=>{console.warn(s),alert("Location access denied."),r(!1)})};return e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:h}),e.jsxs("div",{className:"relative flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{className:"w-full pl-9 p-2.5 bg-white dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all text-sm",placeholder:"Zip Code",maxLength:5,value:u,onChange:s=>g(s.target.value)}),e.jsx(j,{className:`absolute left-3 top-3 text-gray-400 ${d?"animate-pulse":""}`,size:16})]}),e.jsx("button",{onClick:y,disabled:d,className:"p-2.5 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 text-brand-blue transition-colors",title:"Use my location",children:d?e.jsx(v,{size:18,className:"animate-spin"}):e.jsx(L,{size:18})})]}),f&&e.jsxs("div",{className:"mt-1.5 text-xs font-medium text-gray-500 dark:text-gray-400 flex items-center gap-1 animate-in fade-in",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),f]})]})}export{E as L};
