import{r as l,j as e,a3 as w,_ as S,S as R,a as U,U as A,T as L}from"./vendor-DTDDt3fP.js";import{C as j,G as C,q as D,j as T,w as q,k as z,I as E,H as M,M as $,A as F}from"./vendor-firebase-C38qHjbM.js";import{g,d as c}from"./chat-BCnoKXi-.js";import"./vendor-convex-DiXsReyd.js";import"./vendor-framer-CzAUfL-F.js";function B({user:a}){const[i,y]=l.useState([]),[n,h]=l.useState(""),[m,p]=l.useState([]),[x,b]=l.useState(!1),[o,u]=l.useState("list");l.useEffect(()=>{if(!(a!=null&&a.uid))return;const s=j(c,g(a.uid).labelRoster(a.uid)),t=C(s,d=>{y(d.docs.map(r=>({id:r.id,...r.data()})))});return()=>t()},[a==null?void 0:a.uid]);const f=async()=>{if(!(n.length<3)){b(!0);try{const s=D(T(c,"public_profile"),q("searchTerms","array-contains",n.toLowerCase())),d=(await z(s)).docs.map(r=>({id:r.ref.parent.parent.id,...r.data()})).filter(r=>r.id!==a.uid&&!i.some(k=>k.artistId===r.id));p(d)}catch(s){console.error("Search failed:",s)}b(!1)}},N=async s=>{try{await E(j(c,g(a.uid).labelRoster(a.uid)),{artistId:s.id,name:`${s.firstName} ${s.lastName}`,email:s.email||"N/A",photoURL:s.photoURL||null,signedAt:M(),status:"Active"}),alert(`Signed ${s.firstName} to roster!`),h(""),p([]),u("list")}catch(t){console.error("Signing failed:",t),alert("Failed to add artist.")}},v=async(s,t)=>{if(confirm(`Release ${t} from your roster?`))try{await $(F(c,g(a.uid).labelRoster(a.uid),s))}catch(d){console.error(d)}};return e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 animate-in fade-in pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[e.jsx(w,{className:"text-purple-600"})," Label Management"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your artist roster and bookings."})]}),e.jsx("button",{onClick:()=>u(o==="list"?"search":"list"),className:"bg-purple-600 text-white px-5 py-2.5 rounded-xl font-bold hover:bg-purple-700 transition flex items-center gap-2",children:o==="list"?e.jsxs(e.Fragment,{children:[e.jsx(S,{size:18})," Sign Artist"]}):"Back to Roster"})]}),o==="search"&&e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm animate-in slide-in-from-top-4",children:[e.jsx("h3",{className:"font-bold dark:text-white mb-4",children:"Find Talent"}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:"absolute left-3 top-3 text-gray-400",size:18}),e.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"Search by name...",value:n,onChange:s=>h(s.target.value),onKeyDown:s=>s.key==="Enter"&&f()})]}),e.jsx("button",{onClick:f,disabled:x,className:"bg-gray-900 dark:bg-white dark:text-black text-white px-6 rounded-xl font-bold",children:x?"...":"Search"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[m.map(s=>{var t;return e.jsxs("div",{className:"p-4 border dark:border-gray-700 rounded-xl flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden",children:s.photoURL?e.jsx("img",{src:s.photoURL,className:"h-full w-full object-cover"}):e.jsx(U,{className:"m-2 text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold dark:text-white text-sm",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-xs text-gray-500",children:((t=s.accountTypes)==null?void 0:t[0])||"User"})]})]}),e.jsx("button",{onClick:()=>N(s),className:"text-xs bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-3 py-1.5 rounded-lg font-bold hover:bg-purple-200",children:"Sign"})]},s.id)}),m.length===0&&n&&!x&&e.jsx("div",{className:"col-span-full text-center text-gray-500 text-sm",children:"No artists found."})]})]}),o==="list"&&e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-[#23262f] border-b dark:border-gray-700 flex justify-between items-center",children:e.jsxs("span",{className:"font-bold text-sm text-gray-500 uppercase tracking-wide",children:["Current Roster (",i.length,")"]})}),i.length===0?e.jsxs("div",{className:"p-12 text-center text-gray-500",children:[e.jsx(A,{size:48,className:"mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"No artists signed yet."})]}):e.jsx("div",{className:"divide-y dark:divide-gray-700",children:i.map(s=>{var t;return e.jsxs("div",{className:"p-5 hover:bg-gray-50 dark:hover:bg-white/5 transition flex items-center justify-between group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center text-indigo-600 font-bold text-lg overflow-hidden",children:s.photoURL?e.jsx("img",{src:s.photoURL,className:"h-full w-full object-cover"}):s.name[0]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold dark:text-white text-lg",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Signed: ",(t=s.signedAt)!=null&&t.toDate?s.signedAt.toDate().toLocaleDateString():"Recent"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 px-2 py-1 rounded text-xs font-bold",children:s.status}),e.jsx("button",{onClick:()=>v(s.id,s.name),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",title:"Release Artist",children:e.jsx(L,{size:18})})]})]},s.id)})})]})]})}export{B as default};
