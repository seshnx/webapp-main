import{r as n,j as e,Q as X,a0 as Z,a6 as J,L as O,s as ee,v as te,ao as re,X as ne,Z as M}from"./vendor-mIyI6DiM.js";import{w as se}from"./vendor-audio-CY3oQc7h.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};r.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new r.Error().stack;o&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[o]="8d9b1ed4-12ae-43a9-999d-3f1227f571df",r._sentryDebugIdIdentifier="sentry-dbid-8d9b1ed4-12ae-43a9-999d-3f1227f571df")})()}catch{}const ae="/assets/Fevicon-TMLO4Pj9.png";function le({audioUrl:r,fileName:o="Audio Track",previewMode:g=!1}){const m=n.useRef(null),h=n.useRef(null),f=n.useRef(null),w=n.useRef(null),s=n.useRef(null),p=n.useRef(null),y=n.useRef(Math.random().toString(36).substr(2,9)),u=n.useRef(null),x=n.useRef(null),i=n.useRef(null),[E,z]=n.useState(!1),[_,F]=n.useState(!1),[S,V]=n.useState(!1),[A,B]=n.useState(!1),[P,W]=n.useState(document.documentElement.classList.contains("dark")),C=n.useRef(P),v={dark:{star:"rgba(255, 255, 255, 0.5)",special:"#3D84ED",wave:"rgba(255, 255, 255, 0.3)"},light:{star:"rgba(0, 0, 0, 0.5)",special:"#2563EB",wave:"rgba(0, 0, 0, 0.2)"}},q=400,G=120,H=80,c=n.useRef({stars:[],avg:0,width:0,height:0,cx:0,cy:0});n.useEffect(()=>{const t=new MutationObserver(a=>{a.forEach(d=>{if(d.attributeName==="class"){const j=document.documentElement.classList.contains("dark");W(j),C.current=j,s.current&&s.current.setOptions({waveColor:j?v.dark.wave:v.light.wave})}})});return t.observe(document.documentElement,{attributes:!0}),()=>t.disconnect()},[]),n.useEffect(()=>{if(!f.current||!w.current)return;const t=P?v.dark:v.light;s.current=se.create({container:w.current,waveColor:t.wave,progressColor:"#3D84ED",cursorColor:"#3D84ED",barWidth:4,barGap:3,barRadius:3,height:100,responsive:!0,normalize:!0,backend:"MediaElement",media:f.current,minPxPerSec:50,fillParent:!0,interact:!g,cursorWidth:2,barAlign:"bottom"});const a=d=>{d.detail.id!==y.current&&s.current&&s.current.isPlaying()&&s.current.pause()};return window.addEventListener("seshnx-audio-play",a),s.current.on("ready",()=>F(!0)),s.current.on("play",()=>{z(!0),window.dispatchEvent(new CustomEvent("seshnx-audio-play",{detail:{id:y.current}}))}),s.current.on("pause",()=>z(!1)),s.current.on("finish",()=>{z(!1),cancelAnimationFrame(p.current)}),()=>{window.removeEventListener("seshnx-audio-play",a),s.current&&s.current.destroy(),cancelAnimationFrame(p.current)}},[r,g]),n.useEffect(()=>{const t=()=>{if(m.current&&h.current){const{clientWidth:a,clientHeight:d}=m.current;h.current.width=a,h.current.height=d,c.current.width=a,c.current.height=d,c.current.cx=a/2,c.current.cy=d/2,K()}};return window.addEventListener("resize",t),t(),()=>{window.removeEventListener("resize",t),u.current&&u.current.state!=="closed"&&u.current.close()}},[]);const K=()=>{c.current.stars=[];for(let t=0;t<q;t++)c.current.stars.push({x:Math.random()*c.current.width-c.current.cx,y:Math.random()*c.current.height-c.current.cy,z:Math.random()*c.current.width})},Y=()=>{if(!(A||S||!f.current))try{const t=window.AudioContext||window.webkitAudioContext;u.current=new t,x.current=u.current.createAnalyser(),x.current.fftSize=2048,i.current=u.current.createMediaElementSource(f.current),i.current.connect(x.current),x.current.connect(u.current.destination),B(!0)}catch(t){console.warn("Audio Context Error:",t)}},$=async t=>{var a;t.stopPropagation(),A||Y(),((a=u.current)==null?void 0:a.state)==="suspended"&&await u.current.resume(),s.current&&s.current.playPause(),E||I()},I=()=>{if(!h.current)return;const t=h.current.getContext("2d"),{width:a,height:d,cx:j,cy:T,stars:Q}=c.current;let N=0;if(x.current){const l=x.current.frequencyBinCount,b=new Uint8Array(l);x.current.getByteFrequencyData(b);let R=0;for(let k=0;k<b.length;k++)R+=b[k];N=R/b.length}c.current.avg=N,t.clearRect(0,0,a,d);const D=C.current?v.dark:v.light,U=N>H?N/10:N/30+.5;Q.forEach(l=>{l.z-=U,l.z<=0&&(l.z=a,l.x=Math.random()*a-j,l.y=Math.random()*d-T);const b=l.x/l.z*a+j,R=l.y/l.z*d+T,k=(1-l.z/a)*2.5;b>=0&&b<=a&&R>=0&&R<=d&&(t.fillStyle=N>G?D.special:D.star,t.globalAlpha=1-l.z/a,t.beginPath(),t.arc(b,R,k,0,Math.PI*2),t.fill(),t.globalAlpha=1)}),s.current&&s.current.isPlaying()&&(p.current=requestAnimationFrame(I))};return e.jsxs("div",{ref:m,className:"relative w-full h-32 rounded-xl overflow-hidden group bg-transparent transition-colors",children:[e.jsx("canvas",{ref:h,className:"w-full h-full absolute inset-0 z-0 pointer-events-none"}),e.jsx("div",{className:"absolute inset-0 z-20 flex flex-col justify-end pointer-events-none",children:e.jsx("div",{ref:w,className:"w-full pointer-events-auto opacity-80 hover:opacity-100 transition-opacity"})}),e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-3 z-30 flex justify-between items-start pointer-events-none",children:[e.jsxs("div",{className:"flex items-center gap-2 text-black dark:text-white/90",children:[e.jsx(X,{size:16,className:"text-brand-blue"}),e.jsx("span",{className:"text-sm font-medium truncate max-w-[200px] shadow-sm",children:o}),g&&e.jsxs("span",{className:"text-[10px] bg-yellow-500 text-black px-2 rounded font-bold flex items-center gap-1",children:[e.jsx(Z,{size:8})," PREVIEW"]})]}),S&&e.jsxs("div",{className:"bg-red-500/80 text-white text-[10px] px-2 py-0.5 rounded flex items-center gap-1",children:[e.jsx(J,{size:10})," Visuals Disabled"]})]}),e.jsx("div",{className:"absolute bottom-2 left-2 z-30 opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none",children:e.jsx("img",{src:ae,alt:"SeshNx",className:"w-5 h-5 object-contain"})}),e.jsx("div",{className:`absolute inset-0 z-40 flex items-center justify-center transition-opacity duration-300 pointer-events-none
                ${E?"opacity-0 group-hover:opacity-100 bg-white/20 dark:bg-black/20":"opacity-100 bg-white/10 dark:bg-black/10"}`,children:_?e.jsx("button",{onClick:$,className:"w-14 h-14 bg-white/80 dark:bg-black/40 rounded-full flex items-center justify-center border border-gray-200 dark:border-white/40 text-brand-blue shadow-lg hover:scale-110 transition-transform pointer-events-auto",children:E?e.jsx(ee,{fill:"currentColor",className:"ml-0.5",size:24}):e.jsx(te,{fill:"currentColor",className:"ml-1",size:24})}):e.jsx(O,{className:"animate-spin text-brand-blue",size:32})}),e.jsx("audio",{ref:f,src:r,crossOrigin:"anonymous",onError:()=>V(!0)})]})}const L=["Spam or commercial solicitation","Harassment or bullying","Hate speech","Nudity or sexual activity","Violence or dangerous organizations","Copyright / Intellectual Property Violation","Scam or fraud","Other"],oe=async({contentId:r,contentType:o,contentSummary:g,reporterId:m,reporterName:h,reason:f,description:w="",schoolId:s=null,isFacultyAction:p=!1})=>{try{return console.warn("Moderation report submission not yet implemented with Neon"),console.table({contentId:r,contentType:o,reporterId:m,reason:f,schoolId:s,isFacultyAction:p}),{success:!0,message:"Report logged (not yet persisted to database)",reportId:`temp-${Date.now()}`}}catch(y){return console.error("Report submission failed:",y),{success:!1,error:y.message}}};function de({user:r,target:o,onClose:g}){const[m,h]=n.useState(L[0]),[f,w]=n.useState(""),[s,p]=n.useState(!1),[y,u]=n.useState(!1),x=async()=>{if(!(!m||!(r!=null&&r.uid))){p(!0);try{(await oe({contentId:o.id,contentType:o.type,contentSummary:o.summary,reporterId:(r==null?void 0:r.id)||(r==null?void 0:r.uid),reporterName:r.displayName||"Anonymous User",reason:m,description:f})).success?(u(!0),setTimeout(g,2e3)):alert("Failed to submit report. Please try again.")}catch(i){console.error("Submission error:",i),alert("An unexpected error occurred during submission.")}p(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:e.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-lg animate-in fade-in zoom-in-95 duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h3",{className:"font-bold text-xl dark:text-white flex items-center gap-2 text-red-500",children:[e.jsx(re,{size:24})," Report Violation"]}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-800 dark:text-gray-400 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:e.jsx(ne,{size:20})})]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 mb-6",children:["You are reporting a violation regarding: ",e.jsx("strong",{className:"font-bold",children:o.summary})," (",o.type,")"]}),y?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{size:48,className:"text-green-500 mx-auto mb-4"}),e.jsx("h4",{className:"font-bold text-lg dark:text-white",children:"Report Submitted!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for helping keep the community safe. We will review this shortly."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Reason for Report"}),e.jsx("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:m,onChange:i=>h(i.target.value),children:L.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Additional Details (Optional)"}),e.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm resize-none",rows:"3",placeholder:"Provide any further context or relevant details.",value:f,onChange:i=>w(i.target.value)})]}),e.jsx("button",{onClick:x,disabled:s,className:"w-full bg-red-600 text-white py-3 rounded-xl font-bold hover:bg-red-700 transition disabled:opacity-50 flex items-center justify-center gap-2 shadow-md",children:s?e.jsx(O,{className:"animate-spin",size:18}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:18})," Submit Report"]})})]})]})})})}export{de as R,le as S};
