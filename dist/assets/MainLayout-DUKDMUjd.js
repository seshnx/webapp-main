const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Sidebar-Dho2NhKk.js","assets/vendor-CzMudb4J.js","assets/chat-C8KEVgfe.js","assets/vendor-framer-BfJ9H82C.js","assets/edu-CvezUxxm.js","assets/config-yUl3KxdD.js","assets/Navbar-C5dfW6zo.js","assets/SeshNx-PNG cCropped white text-CY2zM0R9.js","assets/useNotifications-DaY740PS.js","assets/PublicProfileModal-CHlJTcp7.js","assets/FollowButton-BQSObYYT.js","assets/Dashboard-B2rzvVnN.js","assets/SocialFeed-zBxd8d0l.js","assets/ReportModal-D0wMRHyk.js","assets/vendor-audio-Bu2lAtPy.js","assets/Inputs-DSsQ3TfY.js","assets/ChatInterface-OP0ZKbuz.js","assets/BookingSystem-Cc19TzHZ.js","assets/vendor-calendar-D9z_S79X.js","assets/vendor-calendar-DxzzN9QP.css","assets/Marketplace-BN9loBfe.js","assets/TechServices-f2bsUQhR.js","assets/PaymentsManager-Ce0GT3Pm.js","assets/vendor-stripe-OXK3Micb.js","assets/ProfileManager-Da8qAj6M.js","assets/SettingsTab-DNgkDW3r.js","assets/EquipmentAutocomplete-DG7hYcGi.js","assets/BusinessCenter-Ct4bRpH9.js","assets/LegalDocs-Bpj593YI.js"])))=>i.map(i=>d[i]);
import{S as U,_ as o}from"./edu-CvezUxxm.js";import{bH as H,bI as W,r as t,j as e,L as B}from"./vendor-CzMudb4J.js";import{s as E}from"./chat-C8KEVgfe.js";import{E as O}from"./index-DinykQsv.js";import"./config-yUl3KxdD.js";import"./vendor-framer-BfJ9H82C.js";const i=(n,r=3,k=100)=>t.lazy(()=>new Promise((h,p)=>{const f=l=>{try{const c=n();c&&typeof c.then=="function"?c.then(d=>{h(d.default?d:{default:d})}).catch(d=>{l<r?(console.warn(`Lazy load failed, retrying... (${l+1}/${r})`,d),setTimeout(()=>f(l+1),k*(l+1))):(console.error("Lazy load failed after retries:",d),p(d))}):h(c)}catch(c){l<r?(console.warn(`Lazy load sync error, retrying... (${l+1}/${r})`,c),setTimeout(()=>f(l+1),k*(l+1))):(console.error("Lazy load failed after retries (sync error):",c),p(c))}};f(0)})),G=i(()=>o(()=>import("./Sidebar-Dho2NhKk.js"),__vite__mapDeps([0,1,2,3,4,5]))),J=i(()=>o(()=>import("./Navbar-C5dfW6zo.js"),__vite__mapDeps([6,1,2,3,7,8,5]))),K=i(()=>o(()=>import("./PublicProfileModal-CHlJTcp7.js"),__vite__mapDeps([9,1,2,3,4,5,10]))),V=i(()=>o(()=>import("./Dashboard-B2rzvVnN.js"),__vite__mapDeps([11,4,1,2,3,5,8]))),Q=i(()=>o(()=>import("./SocialFeed-zBxd8d0l.js"),__vite__mapDeps([12,1,2,3,13,14,5,15,10]))),X=i(()=>o(()=>import("./ChatInterface-OP0ZKbuz.js"),__vite__mapDeps([16,1,2,3]))),Y=i(()=>o(()=>import("./BookingSystem-Cc19TzHZ.js"),__vite__mapDeps([17,4,1,2,3,5,18,19]))),Z=i(()=>o(()=>import("./Marketplace-BN9loBfe.js"),__vite__mapDeps([20,1,2,3,5,13,14]))),ee=i(()=>o(()=>import("./TechServices-f2bsUQhR.js"),__vite__mapDeps([21,1,5,2,3,15]))),se=i(()=>o(()=>import("./PaymentsManager-Ce0GT3Pm.js"),__vite__mapDeps([22,1,2,3,5,23]))),ne=i(()=>o(()=>import("./ProfileManager-Da8qAj6M.js"),__vite__mapDeps([24,1,2,3,4,5,25,15,26]))),C=i(()=>o(()=>import("./BusinessCenter-Ct4bRpH9.js"),__vite__mapDeps([27,1,2,3,26,5,4]))),te=i(()=>o(()=>import("./LegalDocs-Bpj593YI.js"),__vite__mapDeps([28,1]))),re=i(()=>o(()=>import("./edu-CvezUxxm.js").then(n=>n.E),__vite__mapDeps([4,1,2,3,5]))),ae=i(()=>o(()=>import("./edu-CvezUxxm.js").then(n=>n.b),__vite__mapDeps([4,1,2,3,5]))),oe=i(()=>o(()=>import("./edu-CvezUxxm.js").then(n=>n.d),__vite__mapDeps([4,1,2,3,5]))),ie=i(()=>o(()=>import("./edu-CvezUxxm.js").then(n=>n.c),__vite__mapDeps([4,1,2,3,5]))),z=()=>e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(B,{className:"animate-spin text-brand-blue",size:24})});function xe({user:n,userData:r,loading:k,darkMode:h,toggleTheme:p,handleLogout:f}){const l=H(),c=W(),d=s=>s==="/"?"dashboard":s==="/feed"||s==="/social"?"feed":s==="/messages"||s==="/chat"?"messages":s==="/bookings"?"bookings":s==="/marketplace"?"marketplace":s==="/tech"?"tech":s==="/payments"||s==="/billing"?"payments":s==="/profile"?"profile":s==="/business-center"?"business-center":s==="/legal"?"legal":s==="/studio-ops"?"studio-ops":s.startsWith("/edu-")?s.substring(1):"dashboard",[x,u]=t.useState(()=>d(c.pathname)),[y,R]=t.useState(!1),[b,M]=t.useState({}),[g,N]=t.useState(0),[L,v]=t.useState(null),[D,T]=t.useState(null),j=t.useRef(!0),S=t.useRef(!1),I=t.useRef(c.pathname),P=t.useRef(!1);t.useEffect(()=>{const s=c.pathname;if(I.current===s){j.current&&(j.current=!1);return}I.current=s;const a=d(s);P.current&&(P.current=!1),u(m=>m!==a?(S.current=!0,a):m),j.current&&(j.current=!1)},[c.pathname]),t.useEffect(()=>{if(j.current)return;if(S.current){S.current=!1;return}const a={dashboard:"/",feed:"/feed",messages:"/messages",bookings:"/bookings",marketplace:"/marketplace",tech:"/tech",payments:"/payments",profile:"/profile","business-center":"/business-center",legal:"/legal","edu-student":"/edu-student","edu-intern":"/edu-intern","edu-overview":"/edu-overview","edu-admin":"/edu-admin","studio-ops":"/studio-ops"}[x];a&&c.pathname!==a&&(P.current=!0,l(a,{replace:!0}))},[x,l,c.pathname]),t.useEffect(()=>{if(!(n!=null&&n.id)||!E)return;(async()=>{try{const{data:a,error:m}=await E.from("sub_profiles").select("*").eq("user_id",n.id);if(m){console.warn("Error loading sub-profiles:",m);return}const w={};a==null||a.forEach(A=>{w[A.role]=A}),M(w)}catch(a){console.error("Failed to load sub-profiles:",a)}})()},[n==null?void 0:n.id]),t.useEffect(()=>{if(!(n!=null&&n.id)||!E)return;(async()=>{try{const{data:a}=await E.from("wallets").select("balance").eq("user_id",n.id).maybeSingle();a&&N(a.balance||0)}catch(a){console.warn("Failed to load token balance:",a)}})()},[n==null?void 0:n.id]);const F=async s=>{},_=t.useCallback((s,a)=>{v({uid:s,name:a})},[]),$=t.useCallback(()=>{T(null)},[]),q=()=>{if(!r||!r.id)return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-blue mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})});const s=()=>e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(B,{className:"animate-spin text-brand-blue",size:32})});switch(x){case"dashboard":return e.jsx(O,{name:"Dashboard",children:e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(O,{name:"Dashboard-Inner",children:e.jsx(V,{user:n,userData:r,setActiveTab:u,bookingCount:0,subProfiles:b,tokenBalance:g})})})});case"feed":case"social":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(Q,{user:n,userData:r,openPublicProfile:_})});case"messages":case"chat":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(X,{user:n,userData:r,openPublicProfile:_,pendingChatTarget:D,clearPendingChatTarget:$})});case"bookings":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(Y,{user:n,userData:r,subProfiles:b,openPublicProfile:_})});case"marketplace":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(Z,{user:n,userData:r,tokenBalance:g})});case"tech":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ee,{user:n,userData:r,openPublicProfile:_})});case"payments":case"billing":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(se,{user:n,userData:r,tokenBalance:g})});case"profile":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ne,{user:n,userData:r,subProfiles:b,handleLogout:f,openPublicProfile:_})});case"business-center":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(C,{user:n,userData:r})});case"legal":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(te,{})});case"edu-student":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(re,{user:n,userData:r})});case"edu-intern":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ae,{user:n,userData:r})});case"edu-overview":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(oe,{user:n,userData:r})});case"edu-admin":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ie,{user:n,userData:r})});case"studio-ops":return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(C,{user:n,userData:r})});default:return e.jsx(t.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(V,{user:n,userData:r,setActiveTab:u,bookingCount:0,subProfiles:b,tokenBalance:g})})}};return e.jsx(U,{user:n,userData:r,children:e.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-[#1a1d21]",children:[e.jsx(t.Suspense,{fallback:e.jsx(z,{}),children:e.jsx(G,{userData:r,activeTab:x,setActiveTab:u,sidebarOpen:y,setSidebarOpen:R,handleLogout:f})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(t.Suspense,{fallback:e.jsx(z,{}),children:e.jsx(J,{user:n,userData:r,subProfiles:b,darkMode:h,toggleTheme:p,activeTab:x,setActiveTab:u,onMenuClick:()=>R(!y),onRoleSwitch:F,openPublicProfile:_})}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:q()})]}),L&&e.jsx(t.Suspense,{fallback:null,children:e.jsx(K,{userId:L.uid,currentUser:n,currentUserData:r,onClose:()=>v(null),onMessage:(s,a)=>{T({uid:s,name:a}),u("messages"),v(null)}})})]})})}export{xe as default};
