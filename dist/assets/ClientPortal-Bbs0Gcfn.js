import{cz as R,r as u,j as e,bP as L,c8 as C,P as _,cd as P,a as S,i as D,ac as v,y as w,D as U,a6 as Y}from"./vendor-mIyI6DiM.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},c=new t.Error().stack;c&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[c]="6c36d97c-be2d-4e48-96b6-5087ffa7a591",t._sentryDebugIdIdentifier="sentry-dbid-6c36d97c-be2d-4e48-96b6-5087ffa7a591")})()}catch{}function V({user:t,userData:c}){const{studioId:d}=R(),[a,l]=u.useState("bookings"),[m,r]=u.useState([]),[o,h]=u.useState([]),[b,i]=u.useState([]),[x,y]=u.useState(null),[T,$]=u.useState(!0);u.useEffect(()=>{t&&d&&Promise.all([k(),B(),z(),E()]).finally(()=>$(!1))},[t,d]);const k=async()=>{try{const n=await(await fetch(`/api/studio-ops/bookings?studioId=${d}&clientId=${t.id}&limit=20`)).json();n.success&&r(n.data||[])}catch(s){console.error("Error fetching bookings:",s)}},B=async()=>{try{const n=await(await fetch(`/api/studio-ops/booking-templates?studioId=${d}`)).json();n.success&&h(n.data.filter(g=>g.is_active))}catch(s){console.error("Error fetching templates:",s)}},z=async()=>{try{const n=await(await fetch(`/api/studio-ops/booking-payments?studioId=${d}`)).json();if(n.success){const g=m.map(f=>f.id),p=(n.data||[]).filter(f=>g.includes(f.booking_id));i(p)}}catch(s){console.error("Error fetching payments:",s)}},E=async()=>{try{const n=await(await fetch(`/api/studio-ops/clients?studioId=${d}&clientId=${t.id}`)).json();n.success&&n.data.length>0&&y(n.data[0])}catch(s){console.error("Error fetching client info:",s)}},I=async s=>{const n=prompt("Enter preferred date (YYYY-MM-DD):");if(!n)return;const g=prompt("Enter preferred start time (HH:MM, e.g., 10:00):");if(g)try{const f=await(await fetch(`/api/studio-ops/booking-templates/${s.id}/use`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studioId:d,clientId:t.id,date:n,startTime:g})})).json();f.success?(alert(`Booking created successfully from "${s.name}" template!`),k(),l("bookings")):alert(`Error: ${f.error||"Failed to create booking"}`)}catch(p){console.error("Error rebooking:",p),alert("Failed to create booking. Please try again.")}},F=async s=>{alert(`Invoice download for booking on ${s.date} - Feature coming soon!`)},N=s=>s?new Date(s).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A",j=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),M=s=>{const n={Confirmed:{color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",icon:w},Completed:{color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",icon:w},Cancelled:{color:"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400",icon:v},Declined:{color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",icon:v},Pending:{color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",icon:D}},g=n[s]||n.Pending,p=g.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${g.color}`,children:[e.jsx(p,{size:12}),s]})};return T?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(L,{className:"animate-spin mx-auto mb-4 text-gray-400",size:32}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading your portal..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-[#2c2e36] border-b dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold dark:text-white",children:"Client Portal"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["Welcome, ",(x==null?void 0:x.name)||(t==null?void 0:t.username)||"Client"]})]}),x&&e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Client Type"}),e.jsx("div",{className:"text-lg font-semibold dark:text-white capitalize",children:x.client_type})]})]})})}),e.jsx("div",{className:"bg-white dark:bg-[#2c2e36] border-b dark:border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsxs("button",{onClick:()=>l("bookings"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${a==="bookings"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:[e.jsx(C,{size:16,className:"inline mr-2"}),"My Bookings"]}),e.jsxs("button",{onClick:()=>l("rebook"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${a==="rebook"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:[e.jsx(_,{size:16,className:"inline mr-2"}),"Book a Session"]}),e.jsxs("button",{onClick:()=>l("invoices"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${a==="invoices"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:[e.jsx(P,{size:16,className:"inline mr-2"}),"Invoices & Payments"]}),e.jsxs("button",{onClick:()=>l("profile"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${a==="profile"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:[e.jsx(S,{size:16,className:"inline mr-2"}),"My Profile"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a==="bookings"&&e.jsx(A,{bookings:m,formatDate:N,getStatusBadge:M,onDownloadInvoice:F}),a==="rebook"&&e.jsx(H,{templates:o,onRebook:I,formatCurrency:j}),a==="invoices"&&e.jsx(O,{payments:b,bookings:m,formatCurrency:j,formatDate:N}),a==="profile"&&e.jsx(q,{clientInfo:x,user:t,formatCurrency:j})]})]})}function A({bookings:t,formatDate:c,getStatusBadge:d,onDownloadInvoice:a}){const[l,m]=u.useState("upcoming"),r=new Date,o=t.filter(i=>{const x=new Date(i.date);return l==="upcoming"?x>=r:l==="past"?x<r:!0}),h=t.filter(i=>new Date(i.date)>=r).length,b=t.filter(i=>new Date(i.date)<r).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold dark:text-white",children:"My Bookings"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>m("upcoming"),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l==="upcoming"?"bg-blue-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:["Upcoming (",h,")"]}),e.jsxs("button",{onClick:()=>m("past"),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l==="past"?"bg-blue-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:["Past (",b,")"]})]})]}),o.length===0?e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-8 text-center",children:[e.jsx(C,{size:48,className:"mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:l==="upcoming"?"No upcoming bookings":l==="past"?"No past bookings":"No bookings found"}),l==="upcoming"&&e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Book a Session"})]}):e.jsx("div",{className:"space-y-3",children:o.map(i=>e.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-5 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:c(i.date)}),d(i.status)]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Time:"})," ",i.start_time," - ",i.end_time]}),i.venue_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Room:"})," ",i.venue_name]}),i.offer_amount&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total:"})," ",formatCurrency(i.offer_amount)]})]})]}),e.jsxs("button",{onClick:()=>a(i),className:"flex items-center gap-2 px-3 py-2 text-blue-600 hover:bg-blue-50 dark:text-blue-400 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx(U,{size:16}),"Invoice"]})]})},i.id))})]})}function H({templates:t,onRebook:c,formatCurrency:d}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold dark:text-white mb-2",children:"Book a Session"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Choose from our pre-configured booking templates for quick and easy scheduling"})]}),t.length===0?e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-8 text-center",children:[e.jsx(Y,{size:48,className:"mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No booking templates available"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(a=>e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-5 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-white mb-2",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:a.description})]}),e.jsxs("div",{className:"space-y-2 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(D,{size:16}),a.duration_hours," hour",a.duration_hours!==1?"s":""]}),e.jsx("div",{className:"flex items-center gap-2 font-semibold text-green-600 dark:text-green-400",children:e.jsxs("span",{className:"text-base",children:["$",a.base_price]})})]}),e.jsxs("button",{onClick:()=>c(a),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(_,{size:16}),"Book Now"]})]},a.id))})]})}function O({payments:t,bookings:c,formatCurrency:d,formatDate:a}){const l=t.reduce((r,o)=>{if(!r[o.booking_id]){const h=c.find(b=>b.id===o.booking_id);r[o.booking_id]={booking:h,payments:[],total:0,paid:0}}return r[o.booking_id].payments.push(o),r[o.booking_id].total+=parseFloat((booking==null?void 0:booking.offer_amount)||0),r[o.booking_id].paid+=o.status==="completed"?parseFloat(o.amount):0,r},{}),m=Object.values(l);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold dark:text-white mb-2",children:"Invoices & Payments"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"View your payment history and booking invoices"})]}),m.length===0?e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-8 text-center",children:[e.jsx(P,{size:48,className:"mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No payment history found"})]}):e.jsx("div",{className:"space-y-4",children:m.map(({booking:r,payments:o,total:h,paid:b})=>{const i=h-b,x=i<=0;return e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:a(r==null?void 0:r.date)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(r==null?void 0:r.venue_name)||"Studio Session"})]}),e.jsx("div",{className:`px-3 py-1 text-sm font-medium rounded-full ${x?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"}`,children:x?"Paid in Full":"Payment Pending"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Total"}),e.jsx("div",{className:"text-lg font-semibold dark:text-white",children:d(h)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Paid"}),e.jsx("div",{className:"text-lg font-semibold text-green-600 dark:text-green-400",children:d(b)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Remaining"}),e.jsx("div",{className:`text-lg font-semibold ${x?"text-gray-600 dark:text-gray-400":"text-yellow-600 dark:text-yellow-400"}`,children:d(Math.max(0,i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Payment History"}),o.map(y=>e.jsxs("div",{className:"flex items-center justify-between text-sm bg-gray-50 dark:bg-gray-800 rounded-lg px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium dark:text-white capitalize",children:y.payment_type}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400 ml-2",children:y.status==="completed"?`paid on ${a(y.paid_at)}`:`due ${a(y.due_date)}`})]}),e.jsx("span",{className:"font-semibold dark:text-white",children:d(y.amount)})]},y.id))]})]},r==null?void 0:r.id)})})]})}function q({clientInfo:t,user:c,formatCurrency:d}){return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold dark:text-white mb-2",children:"My Profile"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your client profile information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-white mb-4",children:"Contact Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Name"}),e.jsx("div",{className:"font-medium dark:text-white",children:t.name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Email"}),e.jsx("div",{className:"font-medium dark:text-white",children:t.email||(c==null?void 0:c.email)||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Phone"}),e.jsx("div",{className:"font-medium dark:text-white",children:t.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Company"}),e.jsx("div",{className:"font-medium dark:text-white",children:t.company||"-"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-white mb-4",children:"Booking Statistics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Bookings"}),e.jsx("span",{className:"font-semibold dark:text-white",children:t.total_bookings||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Spent"}),e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:d(t.total_spent||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Client Type"}),e.jsx("span",{className:"font-semibold dark:text-white capitalize",children:t.client_type})]}),t.first_booking_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"First Booking"}),e.jsx("span",{className:"font-medium dark:text-white",children:new Date(t.first_booking_date).toLocaleDateString()})]}),t.last_booking_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Last Booking"}),e.jsx("span",{className:"font-medium dark:text-white",children:new Date(t.last_booking_date).toLocaleDateString()})]})]})]}),t.notes&&e.jsxs("div",{className:"md:col-span-2 bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-white mb-4",children:"Notes"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.notes})]})]})]}):e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-8 text-center",children:[e.jsx(S,{size:48,className:"mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Client profile not found"})]})}export{V as default};
