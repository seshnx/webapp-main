{"version":3,"file":"ProfileManager-Bth2I2Cl.js","sources":["../../src/hooks/useSoftwareDatabase.js","../../src/hooks/useSoftwareSearch.js","../../src/components/shared/SoftwareAutocomplete.jsx","../../src/components/ProfileManager.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { supabase } from '../config/supabase';\r\n\r\n/**\r\n * Hook to fetch software database from Supabase\r\n * Returns all software items grouped by category for use in autocomplete/search\r\n */\r\nexport const useSoftwareDatabase = () => {\r\n    const [dbData, setDbData] = useState({});\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            if (!supabase) {\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            setLoading(true);\r\n\r\n            try {\r\n                // Fetch all verified software items\r\n                const { data, error } = await supabase\r\n                    .from('software_database')\r\n                    .select('*')\r\n                    .eq('verified', true)\r\n                    .order('category')\r\n                    .order('subcategory')\r\n                    .order('brand')\r\n                    .order('name');\r\n\r\n                if (error) throw error;\r\n\r\n                // Group by category and subcategory\r\n                const grouped = {};\r\n                \r\n                (data || []).forEach(item => {\r\n                    const category = item.category || 'Other';\r\n                    const subcategory = item.subcategory || 'General';\r\n                    \r\n                    if (!grouped[category]) {\r\n                        grouped[category] = {};\r\n                    }\r\n                    \r\n                    if (!grouped[category][subcategory]) {\r\n                        grouped[category][subcategory] = [];\r\n                    }\r\n                    \r\n                    // Format item for compatibility with existing search\r\n                    grouped[category][subcategory].push({\r\n                        id: item.id,\r\n                        name: item.name || item.model,\r\n                        brand: item.brand || 'Unknown',\r\n                        model: item.model,\r\n                        category: category,\r\n                        subCategory: subcategory,\r\n                        description: item.description,\r\n                        specifications: item.specifications,\r\n                        website_url: item.website_url,\r\n                        searchTokens: item.search_tokens || [],\r\n                        original: item\r\n                    });\r\n                });\r\n                \r\n                setDbData(grouped);\r\n            } catch (error) {\r\n                console.error(\"Failed to load software database:\", error);\r\n                setDbData({});\r\n            }\r\n            \r\n            setLoading(false);\r\n        };\r\n\r\n        fetchData();\r\n    }, []);\r\n\r\n    return { \r\n        loading, \r\n        data: dbData\r\n    };\r\n};\r\n\r\n","import { useState, useMemo } from 'react';\r\nimport { useSoftwareDatabase } from './useSoftwareDatabase';\r\n\r\n/**\r\n * Hook for searching software database\r\n * Provides search functionality for software autocomplete/search components\r\n */\r\nexport const useSoftwareSearch = () => {\r\n    const { data: softwareData, loading } = useSoftwareDatabase();\r\n    const [results, setResults] = useState([]);\r\n    \r\n    // Flatten the database into a single searchable list\r\n    const allItems = useMemo(() => {\r\n        if (loading || !softwareData) return [];\r\n        let flattened = [];\r\n        \r\n        try {\r\n            // Iterate through categories\r\n            Object.keys(softwareData).forEach(categoryKey => {\r\n                const categoryData = softwareData[categoryKey];\r\n                if (!categoryData || typeof categoryData !== 'object') return;\r\n\r\n                // Iterate through subcategories\r\n                Object.entries(categoryData).forEach(([subcategoryKey, subcategoryItems]) => {\r\n                    if (!Array.isArray(subcategoryItems)) return;\r\n\r\n                    // Process each item in the subcategory\r\n                    subcategoryItems.forEach(item => {\r\n                        if (!item || typeof item !== 'object') return;\r\n\r\n                        // Extract data\r\n                        const brand = item.brand || 'Unknown';\r\n                        const name = item.name || item.model || 'Unknown Software';\r\n                        const subCategory = item.subCategory || subcategoryKey;\r\n                        \r\n                        // Build search string from name, brand, model, and search tokens\r\n                        const searchTokens = item.searchTokens || [];\r\n                        const searchString = [\r\n                            name,\r\n                            brand,\r\n                            item.model,\r\n                            ...searchTokens\r\n                        ].filter(Boolean).join(' ').toLowerCase();\r\n\r\n                        flattened.push({\r\n                            id: item.id,\r\n                            name: name,\r\n                            brand: brand,\r\n                            model: item.model || name,\r\n                            category: item.category || categoryKey,\r\n                            subCategory: subCategory,\r\n                            website_url: item.website_url,\r\n                            searchString: searchString,\r\n                            original: item.original || item\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n        } catch (err) {\r\n            console.warn(\"Error processing software data:\", err);\r\n        }\r\n\r\n        return flattened;\r\n    }, [softwareData, loading]);\r\n\r\n    const searchSoftware = (searchTerm) => {\r\n        if (!searchTerm || searchTerm.trim().length < 1) {\r\n            setResults([]);\r\n            return;\r\n        }\r\n\r\n        // Split user query into individual terms\r\n        const queryTerms = searchTerm.toLowerCase().trim().split(/\\s+/).filter(term => term.length > 0);\r\n        \r\n        if (queryTerms.length === 0) {\r\n            setResults([]);\r\n            return;\r\n        }\r\n        \r\n        // Filter: Item must match ALL terms\r\n        const filteredResults = allItems.filter(item => {\r\n            // Check if all query terms are found in the search string\r\n            return queryTerms.every(term => item.searchString.includes(term));\r\n        })\r\n        .slice(0, 50); // Limit results for performance\r\n\r\n        setResults(filteredResults);\r\n    };\r\n\r\n    return { searchSoftware, results, loading };\r\n};\r\n\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Search, X, Loader2, Code } from 'lucide-react';\r\nimport { useSoftwareSearch } from '../../hooks/useSoftwareSearch';\r\n\r\nexport default function SoftwareAutocomplete({ \r\n    onSelect, \r\n    placeholder = \"Search for software (e.g. Pro Tools, Kontakt)...\", \r\n    className = \"\",\r\n    value,      // Controlled value prop\r\n    onChange,   // Controlled change handler\r\n    multi = false // Toggle for comma-separated list behavior\r\n}) {\r\n    const { searchSoftware, results, loading } = useSoftwareSearch();\r\n    const [localQuery, setLocalQuery] = useState('');\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const wrapperRef = useRef(null);\r\n\r\n    // Determine value to display (Controlled vs Uncontrolled)\r\n    const displayValue = value !== undefined ? value : localQuery;\r\n\r\n    // Close dropdown when clicking outside\r\n    useEffect(() => {\r\n        function handleClickOutside(event) {\r\n            if (wrapperRef.current && !wrapperRef.current.contains(event.target)) {\r\n                setIsOpen(false);\r\n            }\r\n        }\r\n        document.addEventListener(\"mousedown\", handleClickOutside);\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    }, [wrapperRef]);\r\n\r\n    const handleInputChange = (e) => {\r\n        const val = e.target.value;\r\n        \r\n        // Update State/Parent\r\n        if (onChange) onChange(val);\r\n        else setLocalQuery(val);\r\n\r\n        // Determine Search Term\r\n        // If multi, search only the text after the last comma\r\n        const searchTerm = multi ? val.split(',').pop().trim() : val;\r\n\r\n        if (searchTerm.length >= 2) {\r\n            searchSoftware(searchTerm);\r\n            setIsOpen(true);\r\n        } else {\r\n            setIsOpen(false);\r\n        }\r\n    };\r\n\r\n    const handleSelect = (item) => {\r\n        // Construct a full display name\r\n        const fullName = item.brand !== 'Various' && item.brand !== 'Unknown' \r\n            ? `${item.brand} ${item.name}` \r\n            : item.name;\r\n            \r\n        if (multi) {\r\n            // Split by comma, remove the partial term being typed\r\n            const terms = displayValue.split(',');\r\n            terms.pop(); \r\n            \r\n            // Clean up existing terms and append the new selection\r\n            const cleanTerms = terms.map(t => t.trim()).filter(Boolean);\r\n            const newValue = [...cleanTerms, fullName].join(', ') + ', ';\r\n            \r\n            if (onChange) onChange(newValue);\r\n            else setLocalQuery(newValue);\r\n        } else {\r\n            // Standard single select behavior\r\n            if (onSelect) onSelect({ ...item, fullName });\r\n            if (onChange) onChange(fullName);\r\n            else setLocalQuery(fullName);\r\n        }\r\n        \r\n        setIsOpen(false);\r\n    };\r\n\r\n    return (\r\n        <div ref={wrapperRef} className={`relative ${className}`}>\r\n            <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-3 text-gray-400\" size={16} />\r\n                <input \r\n                    className=\"w-full pl-9 pr-8 p-3 text-sm border rounded-xl bg-white dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none transition-all\"\r\n                    placeholder={placeholder}\r\n                    value={displayValue}\r\n                    onChange={handleInputChange}\r\n                    onFocus={(e) => handleInputChange(e)} // Trigger search on focus if text exists\r\n                />\r\n                {displayValue && (\r\n                    <button \r\n                        type=\"button\"\r\n                        onClick={() => { \r\n                            if(onChange) onChange(''); \r\n                            else setLocalQuery(''); \r\n                            setIsOpen(false); \r\n                        }}\r\n                        className=\"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200\"\r\n                    >\r\n                        <X size={16}/>\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            {isOpen && results.length > 0 && (\r\n                <div className=\"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl max-h-60 overflow-y-auto animate-in fade-in slide-in-from-top-2\">\r\n                    <div className=\"py-1\">\r\n                        {results.map((item) => (\r\n                            <button\r\n                                key={item.id}\r\n                                type=\"button\"\r\n                                onClick={() => handleSelect(item)}\r\n                                className=\"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b dark:border-gray-700/50 last:border-0 group\"\r\n                            >\r\n                                <div className=\"font-bold text-sm dark:text-white group-hover:text-brand-blue transition-colors\">\r\n                                    {item.name}\r\n                                </div>\r\n                                <div className=\"text-xs text-gray-500 flex items-center gap-1.5 mt-0.5\">\r\n                                    <span className=\"font-medium text-gray-600 dark:text-gray-400\">{item.brand}</span>\r\n                                    <span className=\"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600\"></span>\r\n                                    <span className=\"opacity-75\">{item.subCategory?.replace(/_/g, ' ')}</span>\r\n                                </div>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n            \r\n            {isOpen && loading && (\r\n                <div className=\"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl p-4 text-center text-gray-500 flex items-center justify-center gap-2\">\r\n                    <Loader2 className=\"animate-spin\" size={16}/> Searching database...\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { User, Mail, MapPin, Briefcase, Music, Save, Loader2, DollarSign, Settings, Users, ChevronRight, Check, ToggleLeft, ToggleRight, Camera, Eye, ExternalLink, Image as ImageIcon } from 'lucide-react';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport * as z from 'zod';\r\nimport { clsx } from 'clsx';\r\nimport { twMerge } from 'tailwind-merge';\r\nimport { useVercelImageUpload } from '../hooks/useVercelUpload';\r\nimport toast from 'react-hot-toast';\r\nimport SettingsTab from './SettingsTab';\r\nimport { PROFILE_SCHEMAS, GENRE_DATA, INSTRUMENT_DATA } from '../config/constants';\r\nimport { MultiSelect, NestedSelect } from './shared/Inputs';\r\nimport EquipmentAutocomplete from './shared/EquipmentAutocomplete';\r\nimport SoftwareAutocomplete from './shared/SoftwareAutocomplete';\r\nimport { updateProfile, upsertSubProfile, getProfile } from '../config/neonQueries';\r\n\r\n// --- Validation Schemas ---\r\nconst mainProfileSchema = z.object({\r\n    firstName: z.string().min(2, \"First name too short\"),\r\n    lastName: z.string().min(2, \"Last name too short\"),\r\n    displayName: z.string().optional(), \r\n    bio: z.string().max(500, \"Bio exceeds 500 characters\").optional(),\r\n    zip: z.string().regex(/^\\d{5}$/, \"Invalid ZIP code\").optional().or(z.literal('')),\r\n    hourlyRate: z.number().min(0, \"Rate cannot be negative\").optional(),\r\n    website: z.string().url(\"Invalid URL\").optional().or(z.literal('')),\r\n});\r\n\r\nconst getInitials = (first, last, display) => {\r\n    if (display) return display.substring(0, 2).toUpperCase();\r\n    return ((first?.[0] || '') + (last?.[0] || '')).toUpperCase() || 'U';\r\n};\r\n\r\n// Added openPublicProfile to props\r\nexport default function ProfileManager({ user, userData, subProfiles = {}, handleLogout, openPublicProfile }) {\r\n    const [activeSubTab, setActiveSubTab] = useState('details');\r\n    const [selectedRole, setSelectedRole] = useState('Main');\r\n    const [saving, setSaving] = useState(false);\r\n    const { uploadImage, uploading } = useVercelImageUpload();\r\n    const [bannerUploading, setBannerUploading] = useState(false); // New state for banner\r\n\r\n    // Toggle States\r\n    const [useLegalNameOnly, setUseLegalNameOnly] = useState(userData?.useLegalNameOnly || false);\r\n    const [useUserNameOnly, setUseUserNameOnly] = useState(userData?.useUserNameOnly || false);\r\n\r\n    useEffect(() => {\r\n        setUseLegalNameOnly(userData?.useLegalNameOnly || false);\r\n        setUseUserNameOnly(userData?.useUserNameOnly || false);\r\n    }, [userData]);\r\n\r\n    const toggleLegalOnly = () => {\r\n        const newVal = !useLegalNameOnly;\r\n        setUseLegalNameOnly(newVal);\r\n        if (newVal) setUseUserNameOnly(false);\r\n    };\r\n\r\n    const toggleUserOnly = () => {\r\n        const newVal = !useUserNameOnly;\r\n        setUseUserNameOnly(newVal);\r\n        if (newVal) setUseLegalNameOnly(false);\r\n    };\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        formState: { errors, isDirty }\r\n    } = useForm({\r\n        resolver: zodResolver(mainProfileSchema),\r\n        defaultValues: {\r\n            firstName: userData?.firstName || '',\r\n            lastName: userData?.lastName || '',\r\n            displayName: userData?.displayName || '',\r\n            bio: userData?.bio || '',\r\n            zip: userData?.zip || '',\r\n            hourlyRate: userData?.hourlyRate || 0,\r\n            website: userData?.website || '',\r\n        }\r\n    });\r\n\r\n    const onMainSubmit = async (data) => {\r\n        setSaving(true);\r\n        const toastId = toast.loading('Saving main profile...');\r\n        try {\r\n            let effectiveName = `${data.firstName} ${data.lastName}`;\r\n            if (useLegalNameOnly) effectiveName = `${data.firstName} ${data.lastName}`;\r\n            else if (useUserNameOnly && data.displayName) effectiveName = data.displayName;\r\n            else if (data.displayName) effectiveName = `${data.firstName} \"${data.displayName}\" ${data.lastName}`;\r\n\r\n            const searchTerms = [\r\n                data.firstName.toLowerCase(),\r\n                data.lastName.toLowerCase(),\r\n                (data.displayName || '').toLowerCase(),\r\n                effectiveName.toLowerCase()\r\n            ].filter(Boolean);\r\n\r\n            const userId = user?.id || user?.uid;\r\n\r\n            // Update main profile using Neon\r\n            await updateProfile(userId, {\r\n                first_name: data.firstName,\r\n                last_name: data.lastName,\r\n                display_name: data.displayName || null,\r\n                bio: data.bio || null,\r\n                zip: data.zip || null,\r\n                hourly_rate: data.hourlyRate || null,\r\n                website: data.website || null,\r\n                use_legal_name_only: useLegalNameOnly,\r\n                use_user_name_only: useUserNameOnly,\r\n                effective_display_name: effectiveName,\r\n                search_terms: searchTerms,\r\n            });\r\n\r\n            toast.success('Profile Updated & Synced!', { id: toastId });\r\n        } catch (error) {\r\n            console.error(\"Update failed\", error);\r\n            const errorMessage = error?.message || \"Failed to update profile.\";\r\n            toast.error(errorMessage, { id: toastId });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const handlePhotoUpload = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n        const userId = user?.id || user?.uid;\r\n        const toastId = toast.loading('Uploading photo...');\r\n        try {\r\n            const url = await uploadImage(file, 'profile-photos');\r\n\r\n            // Update profile using Neon\r\n            await updateProfile(userId, {\r\n                avatar_url: url,\r\n                photo_url: url, // Update both fields for compatibility\r\n            });\r\n\r\n            toast.success('Photo updated!', { id: toastId });\r\n        } catch (err) {\r\n            console.error(err);\r\n            const errorMessage = err?.message || 'Photo upload failed';\r\n            toast.error(errorMessage, { id: toastId });\r\n        }\r\n    };\r\n\r\n    // --- NEW: Handle Banner Upload ---\r\n    const handleBannerUpload = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n        const userId = user?.id || user?.uid;\r\n        setBannerUploading(true);\r\n        const toastId = toast.loading('Uploading cover banner...');\r\n        try {\r\n            // Upload to Vercel Blob\r\n            const url = await uploadImage(file, 'profile-banners');\r\n\r\n            // Update profile using Neon\r\n            await updateProfile(userId, {\r\n                banner_url: url,\r\n            });\r\n\r\n            toast.success('Cover banner updated!', { id: toastId });\r\n        } catch (err) {\r\n            console.error(err);\r\n            const errorMessage = err?.message || 'Banner upload failed';\r\n            toast.error(errorMessage, { id: toastId });\r\n        } finally {\r\n            setBannerUploading(false);\r\n        }\r\n    };\r\n\r\n    const handleSettingsUpdate = async (newSettings) => {\r\n        const userId = user?.id || user?.uid;\r\n        try {\r\n            // Update settings using Neon\r\n            await updateProfile(userId, {\r\n                settings: newSettings,\r\n            });\r\n\r\n            toast.success(\"Settings saved.\");\r\n        } catch (error) {\r\n            console.error(\"Settings save failed\", error);\r\n            const errorMessage = error?.message || \"Failed to save settings.\";\r\n            toast.error(errorMessage);\r\n        }\r\n    };\r\n\r\n    const inputClass = (error) => twMerge(\r\n        \"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none\",\r\n        error ? \"border-red-500 bg-red-50 dark:bg-red-900/10\" : \"border-gray-200 dark:border-gray-700\"\r\n    );\r\n\r\n    return (\r\n        <div className=\"max-w-5xl mx-auto space-y-6 pb-20\">\r\n            {/* Top Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <h1 className=\"text-3xl font-bold dark:text-white flex items-center gap-2\">\r\n                    <User className=\"text-brand-blue\"/> {activeSubTab === 'details' ? 'Edit Profile' : 'Account Settings'}\r\n                </h1>\r\n                \r\n                <div className=\"flex gap-3 self-end\">\r\n                    {/* NEW: View Public Profile Button */}\r\n                    <button \r\n                        onClick={() => openPublicProfile(user?.id || user?.uid)} \r\n                        className=\"bg-gray-900 dark:bg-white text-white dark:text-black px-4 py-2 rounded-xl font-bold text-sm flex items-center gap-2 hover:opacity-90 transition shadow-lg\"\r\n                    >\r\n                        <Eye size={16}/> View Public Profile\r\n                    </button>\r\n\r\n                    <div className=\"bg-gray-100 dark:bg-gray-800 p-1 rounded-lg flex gap-1\">\r\n                        <button onClick={() => setActiveSubTab('details')} className={`px-4 py-2 text-xs font-bold rounded-md transition-all ${activeSubTab === 'details' ? 'bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm' : 'text-gray-500 hover:text-gray-900 dark:hover:text-gray-300'}`}>Edit Details</button>\r\n                        <button onClick={() => setActiveSubTab('settings')} className={`px-4 py-2 text-xs font-bold rounded-md transition-all flex items-center gap-1 ${activeSubTab === 'settings' ? 'bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm' : 'text-gray-500 hover:text-gray-900 dark:hover:text-gray-300'}`}><Settings size={14}/> Settings</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Content Area */}\r\n            {activeSubTab === 'details' ? (\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8 animate-in fade-in slide-in-from-bottom-2\">\r\n                    {/* Left Sidebar */}\r\n                    <div className=\"lg:col-span-1 space-y-2\">\r\n                        <div className=\"font-bold text-xs text-gray-500 uppercase tracking-wider mb-2 px-1\">Profiles</div>\r\n                        <button onClick={() => setSelectedRole('Main')} className={`w-full flex items-center justify-between p-3 rounded-xl transition-all ${selectedRole === 'Main' ? 'bg-brand-blue text-white shadow-md' : 'bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200'}`}><div className=\"flex items-center gap-2\"><User size={16}/> <span className=\"font-bold text-sm\">Main Profile</span></div>{selectedRole === 'Main' && <ChevronRight size={16}/>}</button>\r\n                        {(userData?.accountTypes || []).map(role => {\r\n                            if (!PROFILE_SCHEMAS[role]) return null;\r\n                            return <button key={role} onClick={() => setSelectedRole(role)} className={`w-full flex items-center justify-between p-3 rounded-xl transition-all ${selectedRole === role ? 'bg-brand-blue text-white shadow-md' : 'bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200'}`}><div className=\"flex items-center gap-2\"><Briefcase size={16}/> <span className=\"font-bold text-sm\">{role}</span></div>{selectedRole === role && <ChevronRight size={16}/>}</button>;\r\n                        })}\r\n                    </div>\r\n\r\n                    {/* Right Column */}\r\n                    <div className=\"lg:col-span-3\">\r\n                        {selectedRole === 'Main' ? (\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\r\n                                <div className=\"md:col-span-1 space-y-6\">\r\n                                    {/* Avatar Upload */}\r\n                                    <div className=\"space-y-2\">\r\n                                        <div className=\"text-xs font-bold text-gray-500 uppercase\">Profile Photo</div>\r\n                                        <div className=\"relative group w-full aspect-square rounded-full overflow-hidden bg-gray-100 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 shadow-md\">\r\n                                            {userData?.photoURL ? <img src={userData.photoURL} alt=\"Profile\" className=\"w-full h-full object-cover\" /> : <div className=\"flex items-center justify-center h-full bg-gradient-to-tr from-brand-blue to-purple-500 text-white font-bold text-4xl\">{getInitials(userData?.firstName, userData?.lastName, userData?.displayName)}</div>}\r\n                                            <label className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity\"><span className=\"text-white font-bold text-sm flex items-center gap-1\"><Camera size={16}/> Change</span><input type=\"file\" className=\"hidden\" accept=\"image/*\" onChange={handlePhotoUpload} disabled={uploading} /></label>\r\n                                            {uploading && <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\"><Loader2 className=\"animate-spin text-white\"/></div>}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* NEW: Banner Upload */}\r\n                                    <div className=\"space-y-2\">\r\n                                        <div className=\"text-xs font-bold text-gray-500 uppercase\">Cover Banner</div>\r\n                                        <div className=\"relative group w-full aspect-[3/1] rounded-xl overflow-hidden bg-gray-100 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 shadow-sm\">\r\n                                            {userData?.bannerURL ? (\r\n                                                <img src={userData.bannerURL} alt=\"Banner\" className=\"w-full h-full object-cover\" />\r\n                                            ) : (\r\n                                                <div className=\"w-full h-full flex items-center justify-center text-gray-400\">\r\n                                                    <ImageIcon size={24}/>\r\n                                                </div>\r\n                                            )}\r\n                                            <label className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity\">\r\n                                                <span className=\"text-white font-bold text-xs flex items-center gap-1\"><Camera size={14}/> Upload Cover</span>\r\n                                                <input type=\"file\" className=\"hidden\" accept=\"image/*\" onChange={handleBannerUpload} disabled={bannerUploading} />\r\n                                            </label>\r\n                                            {bannerUploading && <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\"><Loader2 className=\"animate-spin text-white\"/></div>}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl text-xs text-blue-800 dark:text-blue-200\"><p className=\"font-bold mb-1\">Pro Tip:</p>High-quality profile photos & banners increase booking rates by 40%.</div>\r\n                                </div>\r\n\r\n                                <div className=\"md:col-span-2\">\r\n                                    <form onSubmit={handleSubmit(onMainSubmit)} className=\"space-y-6 bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm\">\r\n                                        <div className=\"grid grid-cols-2 gap-4\">\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">First Name (Legal)</label><input {...register(\"firstName\")} className={inputClass(errors.firstName)} /></div>\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Last Name (Legal)</label><input {...register(\"lastName\")} className={inputClass(errors.lastName)} /></div>\r\n                                        </div>\r\n                                        <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">User Name (Display Name)</label><input {...register(\"displayName\")} className={inputClass(errors.displayName)} placeholder=\"e.g. SeshMaster\" /></div>\r\n                                        \r\n                                        {/* Name Toggle Logic */}\r\n                                        <div className=\"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3\">\r\n                                            <label className=\"text-xs font-bold text-gray-500 uppercase block mb-1\">Display Name Preferences</label>\r\n                                            <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use Legal Name Only</span><button type=\"button\" onClick={toggleLegalOnly} className=\"text-brand-blue\">{useLegalNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                                            <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use User Name Only</span><button type=\"button\" onClick={toggleUserOnly} className=\"text-brand-blue\">{useUserNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                                            <div className=\"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2\">Preview: <strong className=\"text-brand-blue\">{useLegalNameOnly ? `${userData?.firstName || ''} ${userData?.lastName || ''}`.trim() || 'Not Set' : useUserNameOnly ? (userData?.displayName || 'Not Set') : `${userData?.firstName || ''} \"${userData?.displayName || 'User'}\" ${userData?.lastName || ''}`.trim() || 'Not Set'}</strong></div>\r\n                                        </div>\r\n\r\n                                        <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Bio / About</label><textarea {...register(\"bio\")} rows=\"4\" className={inputClass(errors.bio)} placeholder=\"Tell us about your musical journey...\" /></div>\r\n                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1\"><MapPin size={12}/> ZIP Code</label><input {...register(\"zip\")} className={inputClass(errors.zip)} /></div>\r\n                                            <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1\"><DollarSign size={12}/> Hourly Rate ($)</label><input type=\"number\" {...register(\"hourlyRate\", { valueAsNumber: true })} className={inputClass(errors.hourlyRate)} /></div>\r\n                                        </div>\r\n                                        <div><label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Website</label><input {...register(\"website\")} className={inputClass(errors.website)} placeholder=\"https://...\" /></div>\r\n\r\n                                        <div className=\"pt-4 border-t dark:border-gray-700 flex justify-end\">\r\n                                            <button type=\"button\" onClick={handleSubmit(onMainSubmit)} disabled={saving} className={clsx(\"px-8 py-3 rounded-xl font-bold flex items-center gap-2 transition-all shadow-lg\", saving ? \"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed\" : \"bg-brand-blue text-white hover:bg-blue-600 hover:scale-105\")}>{saving ? <Loader2 className=\"animate-spin\" size={20}/> : <><Save size={20}/> Save Changes</>}</button>\r\n                                        </div>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <DynamicSubProfileForm user={user} userData={userData} role={selectedRole} initialData={subProfiles[selectedRole] || {}} schema={PROFILE_SCHEMAS[selectedRole] || []}/>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                <div className=\"animate-in fade-in slide-in-from-right-2\"><SettingsTab user={user} userData={userData} handleLogout={handleLogout} onUpdate={handleSettingsUpdate}/></div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n// ... (DynamicSubProfileForm remains unchanged from previous version) ...\r\nfunction DynamicSubProfileForm({ user, userData, role, initialData, schema }) {\r\n    const [formData, setFormData] = useState(initialData);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [followMainProfile, setFollowMainProfile] = useState(initialData.followMainProfile ?? true);\r\n    const [useLegalNameOnly, setUseLegalNameOnly] = useState(initialData.useLegalNameOnly ?? false);\r\n    const [useUserNameOnly, setUseUserNameOnly] = useState(initialData.useUserNameOnly ?? false);\r\n    const [syncStudioOps, setSyncStudioOps] = useState(initialData.syncStudioOps ?? false);\r\n\r\n    useEffect(() => { \r\n        setFormData(initialData || {}); \r\n        setFollowMainProfile(initialData.followMainProfile ?? true);\r\n        setUseLegalNameOnly(initialData.useLegalNameOnly ?? false);\r\n        setUseUserNameOnly(initialData.useUserNameOnly ?? false);\r\n        setSyncStudioOps(initialData.syncStudioOps ?? false);\r\n    }, [initialData]);\r\n\r\n    const handleChange = (key, value) => setFormData(prev => ({ ...prev, [key]: value }));\r\n    const toggleLegalOnly = () => { setUseLegalNameOnly(!useLegalNameOnly); if(!useLegalNameOnly) setUseUserNameOnly(false); };\r\n    const toggleUserOnly = () => { setUseUserNameOnly(!useUserNameOnly); if(!useUserNameOnly) setUseLegalNameOnly(false); };\r\n\r\n    const handleSave = async (e) => {\r\n        e.preventDefault();\r\n        setIsSaving(true);\r\n        const toastId = toast.loading(`Saving ${role} profile...`);\r\n        try {\r\n            let effectiveName = '';\r\n            if (followMainProfile) effectiveName = userData?.effectiveDisplayName || (userData ? `${userData.firstName || ''} ${userData.lastName || ''}`.trim() : '');\r\n            else {\r\n                if (useLegalNameOnly) effectiveName = userData ? `${userData.firstName || ''} ${userData.lastName || ''}`.trim() : '';\r\n                else if (useUserNameOnly) effectiveName = userData?.displayName || (userData ? `${userData.firstName || ''} ${userData.lastName || ''}`.trim() : '');\r\n                else effectiveName = formData.profileName || `${userData.firstName} ${userData.lastName}`;\r\n            }\r\n\r\n            const userId = user?.id || user?.uid;\r\n\r\n            // Save sub-profile data using Neon\r\n            const dataToSave = { ...formData, followMainProfile, useLegalNameOnly, useUserNameOnly, syncStudioOps, displayName: effectiveName };\r\n\r\n            // Upsert sub-profile\r\n            await upsertSubProfile(userId, role, dataToSave);\r\n\r\n            // Update main profile if this is the active role\r\n            if (userData.activeProfileRole === role) {\r\n                await updateProfile(userId, {\r\n                    display_name: effectiveName,\r\n                    effective_display_name: effectiveName,\r\n                    search_terms: [effectiveName.toLowerCase()],\r\n                });\r\n            }\r\n\r\n            // Update studio name if applicable\r\n            if (role === 'Studio' && syncStudioOps) {\r\n                await updateProfile(userId, {\r\n                    studio_name: effectiveName,\r\n                });\r\n            }\r\n\r\n            toast.success(`${role} Profile Saved!`, { id: toastId });\r\n        } catch (err) {\r\n            console.error(err);\r\n            const errorMessage = err?.message || \"Failed to save.\";\r\n            toast.error(errorMessage, { id: toastId });\r\n        }\r\n        finally { setIsSaving(false); }\r\n    };\r\n\r\n    if (schema.length === 0) return <div className=\"p-10 text-center text-gray-500\">No configuration available for this role.</div>;\r\n    \r\n    const currentSubRole = formData.talentSubRole || '';\r\n    const filteredSchema = schema.filter(f => {\r\n        if (f.key === 'profileName' || f.key === 'useRealName') return false;\r\n        if (f.showFor && Array.isArray(f.showFor)) {\r\n            return f.showFor.includes(currentSubRole);\r\n        }\r\n        return true;\r\n    });\r\n\r\n    return (\r\n        <form onSubmit={handleSave} className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm space-y-6\">\r\n            <h2 className=\"text-xl font-bold dark:text-white border-b dark:border-gray-700 pb-2\">{role} Identity & Details</h2>\r\n            \r\n            <div className=\"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3\">\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase block mb-1\">Identity Settings</label>\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div><div className=\"text-sm font-bold dark:text-white\">Follow Main Profile Name</div><div className=\"text-xs text-gray-500\">Use &quot;{userData.effectiveDisplayName || `${userData.firstName} ${userData.lastName}`}&quot;</div></div>\r\n                    <button type=\"button\" onClick={() => setFollowMainProfile(!followMainProfile)} className=\"text-brand-blue\">{followMainProfile ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button>\r\n                </div>\r\n                {!followMainProfile && (\r\n                    <div className=\"space-y-3 animate-in slide-in-from-top-1 pt-3 border-t dark:border-gray-700\">\r\n                         <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use Legal Name Only</span><button type=\"button\" onClick={toggleLegalOnly} className=\"text-brand-blue\">{useLegalNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                        <div className=\"flex items-center justify-between\"><span className=\"text-sm dark:text-gray-200\">Use Main User Name Only</span><button type=\"button\" onClick={toggleUserOnly} className=\"text-brand-blue\">{useUserNameOnly ? <ToggleRight size={28} /> : <ToggleLeft size={28} className=\"text-gray-400\"/>}</button></div>\r\n                        {!useLegalNameOnly && !useUserNameOnly && (\r\n                            <div className=\"mt-2\">\r\n                                <label className=\"text-xs font-bold text-brand-blue uppercase mb-1 block\">{role} Name</label>\r\n                                <input type=\"text\" className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none font-bold\" placeholder={`e.g. ${role === 'Studio' ? 'Sound City' : 'The Weeknd'}`} value={formData.profileName || ''} onChange={e => handleChange('profileName', e.target.value)} />\r\n                                {role === 'Studio' && (<div className=\"flex items-center gap-2 mt-2\"><input type=\"checkbox\" checked={syncStudioOps} onChange={(e) => setSyncStudioOps(e.target.checked)} className=\"rounded text-brand-blue focus:ring-brand-blue\"/><span className=\"text-xs text-gray-500 dark:text-gray-400\">Force &quot;Studio Ops&quot; to use this name</span></div>)}\r\n                            </div>\r\n                        )}\r\n                         <div className=\"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2\">Preview: <strong className=\"text-brand-blue\">{useLegalNameOnly ? `${userData.firstName} ${userData.lastName}` : useUserNameOnly ? (userData.displayName || 'Not Set') : (formData.profileName || 'Not Set')}</strong></div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {filteredSchema.map((field) => {\r\n                if (field.isToggle) return null; \r\n                return (\r\n                    <div key={field.key}>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">{field.label}</label>\r\n                        {field.type === 'textarea' ? (\r\n                            <textarea className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none\" rows={4} value={formData[field.key] || ''} onChange={e => handleChange(field.key, e.target.value)} />\r\n                        ) : field.type === 'select' ? (\r\n                            <select className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none\" value={formData[field.key] || ''} onChange={e => handleChange(field.key, e.target.value)}>{field.options?.map(opt => <option key={opt} value={opt}>{opt}</option>)}</select>\r\n                        ) : field.type === 'multi_select' ? (\r\n                            <MultiSelect label=\"\" fieldKey={field.key} options={field.data || field.options || []} initialValues={formData[field.key] || []} onChange={handleChange} />\r\n                        ) : field.type === 'nested_select' ? (\r\n                            <NestedSelect label=\"\" fieldKey={field.key} data={field.data} initialValues={formData[field.key] || []} onChange={handleChange} />\r\n                        ) : field.key === 'equipment' ? (\r\n                                <EquipmentAutocomplete \r\n                                    multi={true} \r\n                                    value={formData[field.key] || ''} \r\n                                    onChange={(val) => handleChange(field.key, val)}\r\n                                    placeholder=\"Add gear...\" \r\n                                />\r\n                        ) : field.key === 'daw' ? (\r\n                                <SoftwareAutocomplete \r\n                                    multi={field.type === 'multi_select'} \r\n                                    value={formData[field.key] || ''} \r\n                                    onChange={(val) => handleChange(field.key, val)}\r\n                                    placeholder=\"Search for DAW or software...\" \r\n                                />\r\n                        ) : field.key === 'software' || field.key === 'softwareList' ? (\r\n                                <SoftwareAutocomplete \r\n                                    multi={true} \r\n                                    value={formData[field.key] || ''} \r\n                                    onChange={(val) => handleChange(field.key, val)}\r\n                                    placeholder=\"Add software...\" \r\n                                />\r\n                        ) : (\r\n                            <input type={field.type === 'number' ? 'number' : 'text'} className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none\" value={formData[field.key] || ''} onChange={e => handleChange(field.key, e.target.value)} />\r\n                        )}\r\n                    </div>\r\n                );\r\n            })}\r\n\r\n            <div className=\"pt-4 border-t dark:border-gray-700 flex justify-end\">\r\n                <button type=\"submit\" disabled={isSaving} className=\"px-8 py-3 rounded-xl font-bold bg-brand-blue text-white hover:bg-blue-600 flex items-center gap-2 transition shadow-lg disabled:opacity-50\">{isSaving ? <Loader2 className=\"animate-spin\" size={20}/> : <><Save size={20}/> Save {role} Profile</>}</button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n"],"names":["useSoftwareDatabase","dbData","setDbData","useState","loading","setLoading","useEffect","supabase","data","error","grouped","item","category","subcategory","useSoftwareSearch","softwareData","results","setResults","allItems","useMemo","flattened","categoryKey","categoryData","subcategoryKey","subcategoryItems","brand","name","subCategory","searchTokens","searchString","err","searchTerm","queryTerms","term","filteredResults","SoftwareAutocomplete","onSelect","placeholder","className","value","onChange","multi","searchSoftware","localQuery","setLocalQuery","isOpen","setIsOpen","wrapperRef","useRef","displayValue","handleClickOutside","event","handleInputChange","e","val","handleSelect","fullName","terms","newValue","t","jsxs","jsx","Search","X","Loader2","mainProfileSchema","z.object","z.string","z.literal","z.number","getInitials","first","last","display","ProfileManager","user","userData","subProfiles","handleLogout","openPublicProfile","activeSubTab","setActiveSubTab","selectedRole","setSelectedRole","saving","setSaving","uploadImage","uploading","useVercelImageUpload","bannerUploading","setBannerUploading","useLegalNameOnly","setUseLegalNameOnly","useUserNameOnly","setUseUserNameOnly","toggleLegalOnly","newVal","toggleUserOnly","register","handleSubmit","errors","isDirty","useForm","zodResolver","onMainSubmit","toastId","toast","effectiveName","searchTerms","userId","updateProfile","errorMessage","handlePhotoUpload","file","url","handleBannerUpload","handleSettingsUpdate","newSettings","inputClass","twMerge","User","Eye","Settings","ChevronRight","role","PROFILE_SCHEMAS","Briefcase","Camera","ImageIcon","ToggleRight","ToggleLeft","MapPin","DollarSign","clsx","Fragment","Save","DynamicSubProfileForm","SettingsTab","initialData","schema","formData","setFormData","isSaving","setIsSaving","followMainProfile","setFollowMainProfile","syncStudioOps","setSyncStudioOps","handleChange","key","prev","handleSave","dataToSave","upsertSubProfile","currentSubRole","filteredSchema","f","field","_a","opt","MultiSelect","NestedSelect","EquipmentAutocomplete"],"mappings":"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"}