import{r as I,bm as F,bu as L,j as e,bv as P,t as H,bw as V,c as v,aO as G,P as O,bx as W,T as _,L as B,a9 as J,bn as K,bj as m,bo as k,by as w,bq as i,bp as S}from"./vendor-C40xFgTg.js";import{A as Q,E as U}from"./vendor-firebase-CMJMOSQ_.js";import{d as X,b as Y}from"./chat-CcyNTB2o.js";import{d as Z}from"./edu-esCIx5ew.js";import{E as D}from"./EquipmentAutocomplete--BuYQpMa.js";import"./vendor-convex-CkYEP-FB.js";import"./vendor-framer-0jBYu9jQ.js";import"./useEquipmentDatabase-BFPqdJZn.js";const ee=k({studioName:i().min(3,"Studio name is required"),address:i().min(5,"Address is required"),description:i().max(1e3).optional(),rules:i().optional(),amenities:w(i()).optional(),rooms:w(k({name:i().min(1,"Room name required"),rate:S().min(0),capacity:S().min(1),equipment:i().optional()})).optional()});function ne({user:R,userData:r}){const[c,x]=I.useState(!1),{register:d,control:p,handleSubmit:A,watch:q,setValue:b,formState:{errors:a,isDirty:u}}=F({resolver:K(ee),defaultValues:{studioName:(r==null?void 0:r.studioName)||"",address:(r==null?void 0:r.address)||"",description:(r==null?void 0:r.studioDescription)||"",rules:(r==null?void 0:r.studioRules)||"",amenities:(r==null?void 0:r.amenities)||[],rooms:(r==null?void 0:r.rooms)||[{name:"Main Room",rate:50,capacity:5,equipment:""}]}}),{fields:g,append:T,remove:C}=L({control:p,name:"rooms"}),n=q("amenities"),E=s=>{const t=n||[];t.includes(s)?b("amenities",t.filter(o=>o!==s),{shouldDirty:!0}):b("amenities",[...t,s],{shouldDirty:!0})},M=async s=>{x(!0);const t=m.loading("Saving Studio Settings...");try{const o=Q(X,`artifacts/${Y}/users/${R.uid}/profiles/main`);await U(o,{studioName:s.studioName,address:s.address,studioDescription:s.description,studioRules:s.rules,amenities:s.amenities,rooms:s.rooms,isStudio:!0}),m.success("Studio Settings Saved!",{id:t})}catch(o){console.error("Studio update failed",o),m.error("Failed to save settings.",{id:t})}finally{x(!1)}},l=s=>H("w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none",s?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-200 dark:border-gray-700");return e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[e.jsxs("h1",{className:"text-3xl font-bold dark:text-white flex items-center gap-2",children:[e.jsx(P,{className:"text-brand-blue"})," Studio Manager"]}),e.jsxs("form",{onSubmit:A(M),className:"space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold dark:text-white mb-4",children:"General Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Studio Name"}),e.jsx("input",{...d("studioName"),className:l(a.studioName)}),a.studioName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.studioName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Location Address"}),e.jsx("input",{...d("address"),className:l(a.address),placeholder:"123 Music Row, Nashville TN"}),a.address&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.address.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Description"}),e.jsx("textarea",{...d("description"),rows:"3",className:l(a.description),placeholder:"Describe the vibe and gear..."})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(V,{size:20})," Amenities"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(s=>e.jsx("button",{type:"button",onClick:()=>E(s),className:v("px-3 py-2 rounded-lg text-sm font-medium transition-all border",n!=null&&n.includes(s)?"bg-brand-blue text-white border-brand-blue shadow-md":"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"),children:s},s))})]}),e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold dark:text-white flex items-center gap-2",children:[e.jsx(G,{size:20})," Rooms & Rates"]}),e.jsxs("button",{type:"button",onClick:()=>T({name:"New Room",rate:0,capacity:1,equipment:""}),className:"text-sm bg-green-100 text-green-700 px-3 py-1.5 rounded-lg font-bold hover:bg-green-200 transition flex items-center gap-1",children:[e.jsx(O,{size:16})," Add Room"]})]}),e.jsxs("div",{className:"space-y-4",children:[g.map((s,t)=>{var o,h,y,j,N,f;return e.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-600 relative group",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Room Name"}),e.jsx("input",{...d(`rooms.${t}.name`),className:l((h=(o=a.rooms)==null?void 0:o[t])==null?void 0:h.name)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Hourly Rate ($)"}),e.jsx("input",{type:"number",...d(`rooms.${t}.rate`,{valueAsNumber:!0}),className:l((j=(y=a.rooms)==null?void 0:y[t])==null?void 0:j.rate)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Capacity"}),e.jsx("input",{type:"number",...d(`rooms.${t}.capacity`,{valueAsNumber:!0}),className:l((f=(N=a.rooms)==null?void 0:N[t])==null?void 0:f.capacity)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Equipment (Comma separated)"}),e.jsx(W,{control:p,name:`rooms.${t}.equipment`,render:({field:{onChange:z,value:$}})=>e.jsx(D,{value:$||"",onChange:z,placeholder:"Console, Monitors, Mics...",multi:!0})})]}),e.jsx("button",{type:"button",onClick:()=>C(t),className:"absolute top-2 right-2 p-2 text-gray-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",children:e.jsx(_,{size:18})})]},s.id)}),g.length===0&&e.jsx("p",{className:"text-center text-gray-400 py-4 italic",children:"No rooms listed."})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",disabled:c||!u,className:v("px-8 py-4 rounded-xl font-bold text-lg flex items-center gap-2 transition-all shadow-xl",c||!u?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-blue-600 hover:scale-[1.01]"),children:c?e.jsx(B,{className:"animate-spin",size:24}):e.jsxs(e.Fragment,{children:[e.jsx(J,{size:24})," Save Changes"]})})})]})]})}export{ne as default};
