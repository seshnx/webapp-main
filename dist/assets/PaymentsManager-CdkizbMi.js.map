{"version":3,"file":"PaymentsManager-CdkizbMi.js","sources":["../../src/hooks/useDynamicConfig.js","../../src/utils/paymentUtils.js","../../src/components/PaymentsManager.jsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\r\nimport { supabase } from '../config/supabase';\r\n\r\n// NOTE: This fallback data structure is now defined inside the hook \r\n// and memoized to ensure stable references across renders.\r\n\r\n/**\r\n * Fetches dynamic configuration data (tier rules, token packages) from Firestore.\r\n */\r\nexport const useDynamicConfig = () => {\r\n    const [config, setConfig] = useState({\r\n        tierData: null,\r\n        tokenPackages: null,\r\n    });\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // --- Memoized Stable Fallback Data ---\r\n    const { DEFAULT_TIER_DATA, FALLBACK_TOKEN_PACKAGES } = useMemo(() => {\r\n        const DEFAULT_TIER_DATA_DEF = {\r\n            'FREE': { \r\n                name: 'Free', price: 0, feeMultiplier: 1.20,\r\n                features: [\"1 Broadcast Request / month\", \"Cannot list on SeshFx Market\"],\r\n                limits: { broadcastsPerMonth: 1, sessionsPerWeek: 2, canListMarket: false, monthlyTokens: 0 }\r\n            },\r\n            'BASIC': { \r\n                name: 'Basic', price: 4.99, feeMultiplier: 1.10,\r\n                features: [\"3 Broadcast Requests / month\", \"10 Booked Sessions / week\", \"Can list on SeshFx Market (5 items)\"],\r\n                limits: { broadcastsPerMonth: 3, sessionsPerWeek: 10, canListMarket: true, monthlyTokens: 25 }\r\n            },\r\n            'PRO': { \r\n                name: 'Pro Creative', price: 14.99, feeMultiplier: 1.02,\r\n                features: [\"15 Broadcast Requests / month\", \"Unlimited Booked Sessions\", \"Profile Search Boost\"],\r\n                limits: { broadcastsPerMonth: 15, sessionsPerWeek: 999, canListMarket: true, monthlyTokens: 100 }\r\n            },\r\n            'STUDIO': { \r\n                name: 'Studio Business', price: 29.99, feeMultiplier: 1.00,\r\n                features: [\"Studio Manager Component Access\", \"Unlimited Broadcast Requests\", \"0% Session Fees\"],\r\n                limits: { broadcastsPerMonth: 999, sessionsPerWeek: 999, canListMarket: true, monthlyTokens: 100 }\r\n            }\r\n        };\r\n\r\n        const FALLBACK_TOKEN_PACKAGES_DEF = [\r\n            { id: 'pack_small', tokens: 100, price: 4.99, label: 'Starter Stash' },\r\n            { id: 'pack_medium', tokens: 550, price: 19.99, label: 'Producer Pack', highlight: true },\r\n            { id: 'pack_large', tokens: 1200, price: 39.99, label: 'Studio Vault' }\r\n        ];\r\n\r\n        return { DEFAULT_TIER_DATA: DEFAULT_TIER_DATA_DEF, FALLBACK_TOKEN_PACKAGES: FALLBACK_TOKEN_PACKAGES_DEF };\r\n    }, []);\r\n    // --- End Memoized Stable Fallback Data ---\r\n\r\n\r\n    useEffect(() => {\r\n        if (!supabase) {\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        // Fetch tier config\r\n        const fetchTierConfig = async () => {\r\n            const { data, error } = await supabase\r\n                .from('app_config')\r\n                .select('config_value')\r\n                .eq('config_key', 'tier_config')\r\n                .single();\r\n\r\n            if (error && error.code !== 'PGRST116') {\r\n                console.error('Error fetching tier config:', error);\r\n                setConfig(prev => ({ ...prev, tierData: DEFAULT_TIER_DATA }));\r\n                return;\r\n            }\r\n\r\n            const fetchedData = data?.config_value || {};\r\n            const mergedData = Object.keys(DEFAULT_TIER_DATA).reduce((acc, key) => {\r\n                acc[key] = { ...DEFAULT_TIER_DATA[key], ...(fetchedData[key] || {}) };\r\n                return acc;\r\n            }, {});\r\n            setConfig(prev => ({ ...prev, tierData: mergedData }));\r\n        };\r\n\r\n        // Fetch token packages\r\n        const fetchTokenPackages = async () => {\r\n            const { data, error } = await supabase\r\n                .from('app_config')\r\n                .select('config_value')\r\n                .eq('config_key', 'token_packages')\r\n                .single();\r\n\r\n            if (error && error.code !== 'PGRST116') {\r\n                console.error('Error fetching token packages:', error);\r\n                setConfig(prev => ({ ...prev, tokenPackages: FALLBACK_TOKEN_PACKAGES }));\r\n                return;\r\n            }\r\n\r\n            let fetchedTokens = data?.config_value || FALLBACK_TOKEN_PACKAGES;\r\n            if (!Array.isArray(fetchedTokens) || fetchedTokens.length === 0) {\r\n                fetchedTokens = FALLBACK_TOKEN_PACKAGES;\r\n            }\r\n            setConfig(prev => ({ ...prev, tokenPackages: fetchedTokens }));\r\n        };\r\n\r\n        // Initial fetch\r\n        Promise.all([fetchTierConfig(), fetchTokenPackages()]).finally(() => {\r\n            setLoading(false);\r\n        });\r\n\r\n        // Subscribe to real-time updates\r\n        const tierChannel = supabase\r\n            .channel('app_config_tier')\r\n            .on('postgres_changes', \r\n                { event: '*', schema: 'public', table: 'app_config', filter: 'config_key=eq.tier_config' },\r\n                () => fetchTierConfig()\r\n            )\r\n            .subscribe();\r\n\r\n        const tokensChannel = supabase\r\n            .channel('app_config_tokens')\r\n            .on('postgres_changes',\r\n                { event: '*', schema: 'public', table: 'app_config', filter: 'config_key=eq.token_packages' },\r\n                () => fetchTokenPackages()\r\n            )\r\n            .subscribe();\r\n\r\n        return () => {\r\n            supabase.removeChannel(tierChannel);\r\n            supabase.removeChannel(tokensChannel);\r\n        };\r\n    }, [DEFAULT_TIER_DATA, FALLBACK_TOKEN_PACKAGES]); \r\n\r\n\r\n    // Helper function to get the multiplier for a user's current tier\r\n    const getFeeMultiplier = (currentTierId) => {\r\n        const tier = config.tierData?.[currentTierId] || config.tierData?.['FREE'];\r\n        return tier ? tier.feeMultiplier : DEFAULT_TIER_DATA.FREE.feeMultiplier;\r\n    };\r\n\r\n    return { \r\n        tierData: config.tierData || DEFAULT_TIER_DATA, \r\n        tokenPackages: config.tokenPackages || FALLBACK_TOKEN_PACKAGES,\r\n        loading, \r\n        getFeeMultiplier\r\n    };\r\n};\r\n","import { loadStripe } from '@stripe/stripe-js';\r\nimport { STRIPE_PUBLIC_KEY } from '../config/constants';\r\n\r\nlet stripePromise;\r\n\r\nexport const getStripe = () => {\r\n  if (!STRIPE_PUBLIC_KEY) {\r\n    console.warn('Stripe public key not configured. Please set VITE_STRIPE_PUBLISHABLE_KEY in Vercel environment variables.');\r\n    return null;\r\n  }\r\n  if (!stripePromise) {\r\n    stripePromise = loadStripe(STRIPE_PUBLIC_KEY);\r\n  }\r\n  return stripePromise;\r\n};\r\n\r\n/**\r\n * Gets the base API URL for Vercel serverless functions\r\n * In development, uses localhost. In production, uses Vercel deployment URL.\r\n */\r\nconst getApiUrl = () => {\r\n  if (import.meta.env.DEV) {\r\n    return 'http://localhost:3000/api';\r\n  }\r\n  // In production, Vercel automatically provides the deployment URL\r\n  return '/api';\r\n};\r\n\r\n/**\r\n * Initiates a token purchase flow using Stripe Payment Intents.\r\n * Uses Vercel API route for payment processing.\r\n * @param {Object} pack - The token package object { id, price, tokens }\r\n * @param {string} userId - The current user's ID\r\n * @returns {Promise<string>} Client secret for payment intent\r\n */\r\nexport const handleTokenPurchase = async (pack, userId) => {\r\n  if (!userId) throw new Error(\"User not authenticated.\");\r\n  \r\n  try {\r\n    const response = await fetch(`${getApiUrl()}/stripe/create-payment-intent`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        packId: pack.id,\r\n        userId,\r\n        amount: pack.price,\r\n        currency: 'usd',\r\n      }),\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      const error = await response.json().catch(() => ({ message: 'Payment processing failed' }));\r\n      throw new Error(error.message || 'Payment processing failed');\r\n    }\r\n    \r\n    const data = await response.json();\r\n    \r\n    if (data?.clientSecret) {\r\n      return data.clientSecret;\r\n    }\r\n    \r\n    throw new Error(\"No client secret returned from payment server.\");\r\n  } catch (error) {\r\n    console.error(\"Token purchase error:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Initiates the Stripe Connect onboarding flow for talent.\r\n * @param {string} userId - The current user's ID\r\n * @returns {Promise<string>} Onboarding URL\r\n */\r\nexport const handleConnectOnboarding = async (userId) => {\r\n  if (!userId) throw new Error(\"User not authenticated.\");\r\n  \r\n  try {\r\n    const response = await fetch(`${getApiUrl()}/stripe/connect-onboard`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ userId }),\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      const error = await response.json().catch(() => ({ message: 'Onboarding failed' }));\r\n      throw new Error(error.message || 'Onboarding failed');\r\n    }\r\n    \r\n    const data = await response.json();\r\n    \r\n    if (data?.url) {\r\n      return data.url;\r\n    }\r\n    \r\n    throw new Error(\"No onboarding URL returned from server.\");\r\n  } catch (error) {\r\n    console.error(\"Connect onboarding error:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Triggers a payout of available funds to the connected Stripe account/Bank.\r\n * @param {number} amount - Amount to cash out\r\n * @param {string} userId - The current user's ID\r\n * @returns {Promise<Object>} Payout result\r\n */\r\nexport const handlePayout = async (amount, userId) => {\r\n    if (amount <= 0) throw new Error(\"No funds available to cash out.\");\r\n    if (!userId) throw new Error(\"User not authenticated.\");\r\n    \r\n    try {\r\n        const response = await fetch(`${getApiUrl()}/stripe/initiate-payout`, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({ amount, userId }),\r\n        });\r\n        \r\n        if (!response.ok) {\r\n          const error = await response.json().catch(() => ({ message: 'Payout failed' }));\r\n          throw new Error(error.message || 'Payout failed');\r\n        }\r\n        \r\n        const data = await response.json();\r\n        return data;\r\n    } catch (error) {\r\n        console.error(\"Payout failed:\", error);\r\n        throw error;\r\n    }\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Check, Plus, Zap, TrendingUp, DollarSign, Loader2, Shield, Star, Lock, ArrowRight, AlertCircle } from 'lucide-react';\r\nimport { supabase } from '../config/supabase'; \r\nimport { SUBSCRIPTION_PLAN_KEYS } from '../config/constants';\r\nimport { useDynamicConfig } from '../hooks/useDynamicConfig';\r\nimport { handlePayout } from '../utils/paymentUtils';\r\n\r\nexport default function PaymentsManager({ user, userData }) {\r\n  const [activeTab, setActiveTab] = useState('store'); \r\n  const [walletData, setWalletData] = useState({ balance: 0, escrowBalance: 0, payoutBalance: 0 });\r\n  const [processing, setProcessing] = useState(false);\r\n  \r\n  const { tierData, tokenPackages, loading: loadingConfig } = useDynamicConfig(); \r\n\r\n  const currentTierId = userData?.currentTier || SUBSCRIPTION_PLAN_KEYS.FREE;\r\n  \r\n  // --- UPDATED: Comprehensive Role Check for Earnings Access ---\r\n  const isTalent = userData?.accountTypes?.some(role => \r\n      ['Talent', 'Producer', 'Engineer', 'Studio', 'Composer', 'Technician', 'Label', 'Agent'].includes(role)\r\n  );\r\n\r\n  useEffect(() => {\r\n      if (!user?.id && !user?.uid || !supabase) return;\r\n      const userId = user?.id || user?.uid;\r\n      \r\n      const loadWallet = async () => {\r\n          try {\r\n              const { data, error } = await supabase\r\n                  .from('wallets')\r\n                  .select('*')\r\n                  .eq('user_id', userId)\r\n                  .single();\r\n              \r\n              if (error && error.code !== 'PGRST116') {\r\n                  console.error('Error loading wallet:', error);\r\n                  return;\r\n              }\r\n              \r\n              if (data) {\r\n                  setWalletData({\r\n                      balance: data.balance || 0,\r\n                      escrowBalance: data.escrow_balance || 0,\r\n                      payoutBalance: data.payout_balance || 0 \r\n                  });\r\n              } else {\r\n                  // Wallet doesn't exist yet - set defaults\r\n                  setWalletData({\r\n                      balance: 0,\r\n                      escrowBalance: 0,\r\n                      payoutBalance: 0\r\n                  });\r\n              }\r\n          } catch (err) {\r\n              console.error('Wallet load error:', err);\r\n          }\r\n      };\r\n      \r\n      loadWallet();\r\n      \r\n      // Subscribe to wallet changes\r\n      const channel = supabase\r\n          .channel(`wallet-${userId}`)\r\n          .on('postgres_changes', {\r\n              event: '*',\r\n              schema: 'public',\r\n              table: 'wallets',\r\n              filter: `user_id=eq.${userId}`\r\n          }, () => {\r\n              loadWallet();\r\n          })\r\n          .subscribe();\r\n      \r\n      return () => {\r\n          supabase.removeChannel(channel);\r\n      };\r\n  }, [user?.id, user?.uid]);\r\n\r\n  const handleCheckout = async (priceId, mode = 'payment') => {\r\n      setProcessing(true);\r\n      try {\r\n          // Use Vercel API route for checkout\r\n          const apiUrl = import.meta.env.DEV ? 'http://localhost:3000/api' : '/api';\r\n          const response = await fetch(`${apiUrl}/stripe/create-checkout-session`, {\r\n              method: 'POST',\r\n              headers: {\r\n                  'Content-Type': 'application/json',\r\n              },\r\n              body: JSON.stringify({\r\n                  priceId: priceId,\r\n                  mode: mode,\r\n                  successUrl: window.location.href,\r\n                  cancelUrl: window.location.href,\r\n              }),\r\n          });\r\n          \r\n          if (!response.ok) {\r\n              const error = await response.json().catch(() => ({ message: 'Checkout failed' }));\r\n              throw new Error(error.message || 'Checkout failed');\r\n          }\r\n          \r\n          const data = await response.json();\r\n          \r\n          if (data?.url) {\r\n            window.location.assign(data.url);\r\n          } else {\r\n             throw new Error(\"Failed to create checkout session. Please try again or contact support.\");\r\n          }\r\n      } catch (error) {\r\n          console.error(\"Checkout Error:\", error);\r\n          alert(`Checkout failed: ${error.message || \"Please try again.\"}`);\r\n      } finally {\r\n          setProcessing(false);\r\n      }\r\n  };\r\n\r\n  const buyTokens = (pack) => {\r\n      if (!pack.stripePriceId) return alert(\"Configuration Error: This package is missing a Stripe Price ID.\");\r\n      handleCheckout(pack.stripePriceId, 'payment');\r\n  };\r\n\r\n  const subscribeToPlan = (plan) => {\r\n      if (!plan.stripePriceId) return alert(\"Configuration Error: This plan is missing a Stripe Price ID.\");\r\n      handleCheckout(plan.stripePriceId, 'subscription');\r\n  };\r\n\r\n  const initCashOut = async () => {\r\n      if (!isTalent) return;\r\n      if (walletData.payoutBalance <= 0) return alert(\"No funds available for cash out.\");\r\n      if (!window.confirm(`Cash out $${walletData.payoutBalance.toFixed(2)} to your connected account?`)) return;\r\n\r\n      setProcessing(true);\r\n      try {\r\n          const userId = user?.id || user?.uid;\r\n          await handlePayout(walletData.payoutBalance, userId);\r\n          alert(\"Cash out initiated! Funds should arrive in your bank account shortly.\");\r\n      } catch (error) {\r\n          alert(error.message);\r\n      } finally {\r\n          setProcessing(false);\r\n      }\r\n  };\r\n\r\n  const sortedPlans = Object.values(tierData)\r\n      .sort((a, b) => {\r\n          if (a.id === currentTierId) return -1;\r\n          if (b.id === currentTierId) return 1;\r\n          return a.price - b.price;\r\n      });\r\n\r\n  const formatFee = (multiplier) => {\r\n      const percentage = (multiplier - 1) * 100;\r\n      if (percentage > 0) return `+${percentage.toFixed(0)}% Service Fee`;\r\n      if (percentage === 0) return '0% Service Fee';\r\n      return `-${Math.abs(percentage).toFixed(0)}% Fee (Discount)`;\r\n  };\r\n\r\n  return (\r\n      <div className=\"max-w-6xl mx-auto p-4 pb-24\">\r\n          <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-6\">\r\n              <div>\r\n                  <h2 className=\"text-3xl font-extrabold dark:text-white flex items-center gap-2\">\r\n                      <DollarSign size={32} className=\"text-green-500\" /> My Wallet\r\n                  </h2>\r\n                  <p className=\"text-gray-500 dark:text-gray-400 mt-1\">Manage tokens, subscriptions, and earnings.</p>\r\n              </div>\r\n              \r\n              <div className=\"flex gap-4\">\r\n                  <div className=\"bg-white dark:bg-[#2c2e36] px-5 py-3 rounded-2xl border dark:border-gray-700 shadow-sm flex items-center gap-3\">\r\n                      <div className=\"p-2 bg-yellow-500/10 rounded-full\">\r\n                          <Zap fill=\"currentColor\" className=\"text-yellow-500\" size={20}/>\r\n                      </div>\r\n                      <div>\r\n                          <div className=\"text-[10px] font-bold text-gray-500 uppercase tracking-wide\">Spending Tokens</div>\r\n                          <div className=\"font-mono font-extrabold text-xl dark:text-white leading-none\">{walletData.balance.toLocaleString()} TK</div>\r\n                      </div>\r\n                  </div>\r\n\r\n                  {isTalent && (\r\n                      <div className=\"bg-white dark:bg-[#2c2e36] px-5 py-3 rounded-2xl border dark:border-gray-700 shadow-sm flex items-center gap-3\">\r\n                          <div className=\"p-2 bg-green-500/10 rounded-full\">\r\n                              <DollarSign className=\"text-green-500\" size={20}/>\r\n                          </div>\r\n                          <div>\r\n                              <div className=\"text-[10px] font-bold text-gray-500 uppercase tracking-wide\">Available USD</div>\r\n                              <div className=\"font-mono font-extrabold text-xl dark:text-white leading-none\">${walletData.payoutBalance.toFixed(2)}</div>\r\n                          </div>\r\n                      </div>\r\n                  )}\r\n              </div>\r\n          </div>\r\n\r\n          <div className=\"flex gap-4 border-b dark:border-gray-700 mb-8 overflow-x-auto\">\r\n             <button onClick={() => setActiveTab('store')} className={`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${activeTab === 'store' ? 'border-brand-blue text-brand-blue' : 'border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300'}`}>\r\n                 Token Store\r\n             </button>\r\n             <button onClick={() => setActiveTab('plans')} className={`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${activeTab === 'plans' ? 'border-brand-blue text-brand-blue' : 'border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300'}`}>\r\n                 Membership Plans\r\n             </button>\r\n             {isTalent && (\r\n                 <button onClick={() => setActiveTab('earnings')} className={`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${activeTab === 'earnings' ? 'border-brand-blue text-brand-blue' : 'border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300'}`}>\r\n                     Earnings & Escrow\r\n                 </button>\r\n             )}\r\n          </div>\r\n\r\n          {activeTab === 'store' && (\r\n              <div className=\"space-y-8 animate-in fade-in duration-300\">\r\n                  <div className=\"bg-gradient-to-r from-brand-blue to-purple-600 rounded-2xl p-8 text-white shadow-lg relative overflow-hidden\">\r\n                      <div className=\"relative z-10 max-w-lg\">\r\n                          <h3 className=\"text-2xl font-bold mb-2\">Power Up Your Creativity</h3>\r\n                          <p className=\"opacity-90 mb-6\">Use tokens to buy beats, presets, booking requests, and more on the SeshFx Marketplace.</p>\r\n                      </div>\r\n                      <Zap size={200} className=\"absolute -right-10 -bottom-20 text-white opacity-10 rotate-12 pointer-events-none\" />\r\n                  </div>\r\n                  \r\n                  {loadingConfig ? (\r\n                      <div className=\"text-center py-20\"><Loader2 className=\"animate-spin text-brand-blue mx-auto\" size={32}/></div>\r\n                  ) : (\r\n                      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                          {tokenPackages.map(pack => (\r\n                              <div key={pack.id} className={`relative bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border transition-all duration-200 hover:-translate-y-1 hover:shadow-xl ${pack.highlight ? 'border-yellow-500 ring-2 ring-yellow-500/20' : 'dark:border-gray-700'}`}>\r\n                                  {pack.highlight && (\r\n                                      <div className=\"absolute -top-3 left-1/2 -translate-x-1/2 bg-yellow-500 text-black text-[10px] font-extrabold px-3 py-1 rounded-full tracking-wide shadow-sm\">\r\n                                          BEST VALUE\r\n                                      </div>\r\n                                  )}\r\n                                  <div className=\"text-center mb-6\">\r\n                                      <div className=\"text-gray-500 dark:text-gray-400 text-xs font-bold uppercase tracking-widest mb-2\">{pack.label}</div>\r\n                                      <div className=\"text-5xl font-extrabold dark:text-white flex items-center justify-center gap-1\">\r\n                                          {pack.tokens}\r\n                                          <span className=\"text-lg font-medium text-gray-400\">TK</span>\r\n                                      </div>\r\n                                  </div>\r\n                                  <button onClick={() => buyTokens(pack)} disabled={processing} className={`w-full py-3 rounded-xl font-bold flex justify-center items-center gap-2 transition-all ${pack.highlight ? 'bg-yellow-500 text-black hover:bg-yellow-400' : 'bg-gray-900 dark:bg-white text-white dark:text-black hover:opacity-90'}`}>\r\n                                    {processing ? <Loader2 className=\"animate-spin\" size={18}/> : `Buy for $${pack.price}`}\r\n                                  </button>\r\n                              </div>\r\n                          ))}\r\n                      </div>\r\n                  )}\r\n              </div>\r\n          )}\r\n\r\n          {activeTab === 'plans' && (\r\n              <div className=\"space-y-8 animate-in fade-in duration-300\">\r\n                  <div className=\"text-center max-w-2xl mx-auto mb-8\">\r\n                      <h3 className=\"text-2xl font-bold dark:text-white mb-2\">Upgrade Your Workflow</h3>\r\n                      <p className=\"text-gray-500 dark:text-gray-400\">Unlock lower fees, unlimited bookings, and premium visibility.</p>\r\n                  </div>\r\n\r\n                  {loadingConfig ? (\r\n                      <div className=\"text-center py-10\"><Loader2 className=\"animate-spin text-brand-blue mx-auto\" size={24}/></div>\r\n                  ) : (\r\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6\">\r\n                          {sortedPlans.map(plan => {\r\n                              const isCurrent = plan.id === currentTierId;\r\n                              return (\r\n                                  <div key={plan.id} className={`bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border flex flex-col ${isCurrent ? 'border-brand-blue ring-1 ring-brand-blue' : 'dark:border-gray-700'} shadow-sm`}>\r\n                                      {isCurrent && <div className=\"text-xs font-bold text-brand-blue uppercase tracking-wide mb-2 flex items-center gap-1\"><Star size={12} fill=\"currentColor\"/> Current Plan</div>}\r\n                                      <h3 className=\"text-xl font-bold dark:text-white mb-1\">{plan.name}</h3>\r\n                                      <div className=\"text-3xl font-extrabold mb-6 dark:text-white\">\r\n                                          ${plan.price}<span className=\"text-sm font-normal text-gray-500\">/mo</span>\r\n                                      </div>\r\n                                      <div className=\"space-y-3 mb-8 flex-1\">\r\n                                          <div className=\"flex items-center gap-2 text-sm font-bold text-gray-700 dark:text-gray-200\">\r\n                                              <DollarSign size={16} className={plan.feeMultiplier <= 1.0 ? 'text-green-500' : 'text-gray-400'} />\r\n                                              {formatFee(plan.feeMultiplier)}\r\n                                          </div>\r\n                                          {plan.features.map((feat, i) => (\r\n                                              <div key={i} className=\"flex items-start gap-2 text-xs text-gray-600 dark:text-gray-400\">\r\n                                                  <Check size={14} className=\"text-green-500 shrink-0 mt-0.5\" />\r\n                                                  <span>{feat}</span>\r\n                                              </div>\r\n                                          ))}\r\n                                      </div>\r\n                                      <button onClick={() => subscribeToPlan(plan)} className={`w-full py-2.5 rounded-lg font-bold text-sm transition-colors mt-auto ${isCurrent ? 'bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-default' : 'bg-brand-blue text-white hover:bg-blue-600 shadow-lg shadow-blue-500/20'}`} disabled={isCurrent || processing}>\r\n                                          {isCurrent ? 'Active' : (processing ? <Loader2 className=\"animate-spin mx-auto\"/> : 'Upgrade')}\r\n                                      </button>\r\n                                  </div>\r\n                              );\r\n                          })}\r\n                      </div>\r\n                  )}\r\n              </div>\r\n          )}\r\n\r\n          {activeTab === 'earnings' && isTalent && (\r\n              <div className=\"space-y-6 animate-in fade-in duration-300\">\r\n                  {/* Summary Header */}\r\n                  <div className=\"bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl p-6 text-white shadow-lg\">\r\n                      <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                          <div>\r\n                              <h3 className=\"text-lg font-medium opacity-90\">Total Lifetime Earnings</h3>\r\n                              <div className=\"text-4xl font-extrabold mt-1\">\r\n                                  ${(walletData.payoutBalance + walletData.escrowBalance).toLocaleString(undefined, {minimumFractionDigits: 2})}\r\n                              </div>\r\n                          </div>\r\n                          <div className=\"flex gap-4 text-sm\">\r\n                              <div className=\"bg-white/20 backdrop-blur px-4 py-2 rounded-xl\">\r\n                                  <div className=\"text-white/70 text-xs\">Pending</div>\r\n                                  <div className=\"font-bold\">${walletData.escrowBalance.toFixed(2)}</div>\r\n                              </div>\r\n                              <div className=\"bg-white/20 backdrop-blur px-4 py-2 rounded-xl\">\r\n                                  <div className=\"text-white/70 text-xs\">Available</div>\r\n                                  <div className=\"font-bold\">${walletData.payoutBalance.toFixed(2)}</div>\r\n                              </div>\r\n                          </div>\r\n                      </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                      {/* Escrow/Pending */}\r\n                      <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm relative overflow-hidden\">\r\n                          <div className=\"flex items-center gap-3 mb-4\">\r\n                              <div className=\"p-2 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-lg\"><Lock size={24}/></div>\r\n                              <div><h3 className=\"font-bold dark:text-white\">Pending in Escrow</h3><p className=\"text-xs text-gray-500 dark:text-gray-400\">Held for active gigs/sessions</p></div>\r\n                          </div>\r\n                          <div className=\"text-4xl font-extrabold dark:text-white mb-4\">${walletData.escrowBalance.toLocaleString(undefined, {minimumFractionDigits: 2})}</div>\r\n                          \r\n                          {/* Earnings Breakdown */}\r\n                          <div className=\"border-t dark:border-gray-700 pt-4 mt-4 space-y-2\">\r\n                              <div className=\"text-xs font-bold text-gray-500 uppercase mb-2\">How Escrow Works</div>\r\n                              <div className=\"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\r\n                                  <div className=\"w-2 h-2 bg-yellow-500 rounded-full\"></div>\r\n                                  Client books you → Funds held in escrow\r\n                              </div>\r\n                              <div className=\"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\r\n                                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n                                  Complete the session → Mark as done\r\n                              </div>\r\n                              <div className=\"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\r\n                                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                                  24 hours later → Released to Available\r\n                              </div>\r\n                          </div>\r\n                          \r\n                          <div className=\"text-xs bg-orange-50 dark:bg-orange-900/10 text-orange-700 dark:text-orange-300 p-3 rounded-lg flex items-start gap-2 mt-4\"><AlertCircle size={14} className=\"mt-0.5 shrink-0\"/> Funds are released 24 hours after session completion.</div>\r\n                      </div>\r\n\r\n                      {/* Available for Payout */}\r\n                      <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border border-green-500/30 shadow-lg relative overflow-hidden\">\r\n                          <div className=\"flex items-center gap-3 mb-4\">\r\n                              <div className=\"p-2 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-lg\"><DollarSign size={24}/></div>\r\n                              <div><h3 className=\"font-bold dark:text-white\">Ready to Cash Out</h3><p className=\"text-xs text-gray-500 dark:text-gray-400\">Cleared funds - transfer anytime</p></div>\r\n                          </div>\r\n                          <div className=\"text-4xl font-extrabold text-green-600 dark:text-green-400 mb-2\">${walletData.payoutBalance.toLocaleString(undefined, {minimumFractionDigits: 2})}</div>\r\n                          \r\n                          {/* Fee Info */}\r\n                          <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 mb-4 text-xs\">\r\n                              <div className=\"flex justify-between text-gray-600 dark:text-gray-400 mb-1\">\r\n                                  <span>Platform Fee (1%)</span>\r\n                                  <span className=\"text-red-500\">-${(walletData.payoutBalance * 0.01).toFixed(2)}</span>\r\n                              </div>\r\n                              <div className=\"flex justify-between font-bold text-gray-900 dark:text-white pt-1 border-t dark:border-gray-700\">\r\n                                  <span>You'll Receive</span>\r\n                                  <span className=\"text-green-600\">${(walletData.payoutBalance * 0.99).toFixed(2)}</span>\r\n                              </div>\r\n                          </div>\r\n                          \r\n                          <button onClick={initCashOut} disabled={processing || walletData.payoutBalance <= 0} className=\"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold shadow-lg hover:shadow-green-500/30 transition-all flex justify-center items-center gap-2 disabled:opacity-50 disabled:shadow-none\">\r\n                              {processing ? <Loader2 className=\"animate-spin\" size={20}/> : <>Cash Out Now <ArrowRight size={20}/></>}\r\n                          </button>\r\n                          <div className=\"text-[10px] text-center text-gray-400 mt-3\">Transfers via Stripe Connect to your bank in 2-3 days.</div>\r\n                      </div>\r\n                  </div>\r\n\r\n                  {/* Quick Stats */}\r\n                  <div className=\"bg-white dark:bg-[#2c2e36] p-5 rounded-2xl border dark:border-gray-700\">\r\n                      <h4 className=\"font-bold dark:text-white mb-4 flex items-center gap-2\">\r\n                          <TrendingUp size={18} className=\"text-brand-blue\" /> Earnings Tips\r\n                      </h4>\r\n                      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\r\n                          <div className=\"flex items-start gap-3\">\r\n                              <div className=\"p-2 bg-purple-100 dark:bg-purple-900/30 text-purple-600 rounded-lg\"><Star size={16}/></div>\r\n                              <div>\r\n                                  <div className=\"font-medium dark:text-white\">Complete Your Profile</div>\r\n                                  <div className=\"text-xs text-gray-500\">Add demos & set your rates to get booked faster</div>\r\n                              </div>\r\n                          </div>\r\n                          <div className=\"flex items-start gap-3\">\r\n                              <div className=\"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-lg\"><Zap size={16}/></div>\r\n                              <div>\r\n                                  <div className=\"font-medium dark:text-white\">Check Open Gigs</div>\r\n                                  <div className=\"text-xs text-gray-500\">Browse broadcasts for immediate opportunities</div>\r\n                              </div>\r\n                          </div>\r\n                          <div className=\"flex items-start gap-3\">\r\n                              <div className=\"p-2 bg-green-100 dark:bg-green-900/30 text-green-600 rounded-lg\"><Shield size={16}/></div>\r\n                              <div>\r\n                                  <div className=\"font-medium dark:text-white\">Build Trust</div>\r\n                                  <div className=\"text-xs text-gray-500\">Great reviews = more bookings & better rates</div>\r\n                              </div>\r\n                          </div>\r\n                      </div>\r\n                  </div>\r\n              </div>\r\n          )}\r\n      </div>\r\n  );\r\n}\r\n"],"names":["useDynamicConfig","config","setConfig","useState","loading","setLoading","DEFAULT_TIER_DATA","FALLBACK_TOKEN_PACKAGES","useMemo","useEffect","supabase","fetchTierConfig","data","error","prev","fetchedData","mergedData","acc","key","fetchTokenPackages","fetchedTokens","tierChannel","tokensChannel","getFeeMultiplier","currentTierId","tier","_a","_b","getApiUrl","handlePayout","amount","userId","response","PaymentsManager","user","userData","activeTab","setActiveTab","walletData","setWalletData","processing","setProcessing","tierData","tokenPackages","loadingConfig","SUBSCRIPTION_PLAN_KEYS","isTalent","role","loadWallet","err","channel","handleCheckout","priceId","mode","buyTokens","pack","subscribeToPlan","plan","initCashOut","sortedPlans","b","formatFee","multiplier","percentage","jsxs","DollarSign","jsx","Zap","Loader2","isCurrent","Star","feat","i","Check","Lock","AlertCircle","Fragment","ArrowRight","TrendingUp","Shield"],"mappings":"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"}