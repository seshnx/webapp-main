{"version":3,"file":"useEquipmentDatabase-CUrlwig-.js","sources":["../../src/hooks/useEquipmentDatabase.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { supabase } from '../config/supabase';\r\n\r\n// Main categories matching your Firestore layout\r\nconst COLLECTIONS = [\r\n    { id: 'computer_audio_and_interfaces', label: 'Computer Audio & Interfaces' },\r\n    { id: 'microphones_and_input_transducers', label: 'Microphones' },\r\n    { id: 'mixing_consoles_and_control', label: 'Mixing Consoles' },\r\n    { id: 'monitoring_and_playback', label: 'Monitoring & Playback' },\r\n    { id: 'outboard_signal_processing', label: 'Outboard Gear' }\r\n];\r\n\r\nexport const useEquipmentDatabase = () => {\r\n    const [dbData, setDbData] = useState({});\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            if (!supabase) {\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            setLoading(true);\r\n            const newData = {};\r\n\r\n            try {\r\n                // Fetch all equipment items grouped by category\r\n                const { data, error } = await supabase\r\n                    .from('equipment_items')\r\n                    .select('*')\r\n                    .order('category_id')\r\n                    .order('subcategory_id');\r\n\r\n                if (error) throw error;\r\n\r\n                // Group by category and subcategory to match original structure\r\n                COLLECTIONS.forEach(col => {\r\n                    const categoryItems = (data || []).filter(item => item.category_id === col.id);\r\n                    \r\n                    const colItems = {};\r\n                    categoryItems.forEach(item => {\r\n                        const subcatId = item.subcategory_id || 'default';\r\n                        if (!colItems[subcatId]) {\r\n                            colItems[subcatId] = { Types: [] };\r\n                        }\r\n                        // Store item data in the expected format\r\n                        colItems[subcatId].Types.push({\r\n                            ...item.data,\r\n                            id: item.id,\r\n                            name: item.name,\r\n                            manufacturer: item.manufacturer,\r\n                            model: item.model\r\n                        });\r\n                    });\r\n                    \r\n                    newData[col.id] = colItems;\r\n                });\r\n                \r\n                setDbData(newData);\r\n            } catch (error) {\r\n                console.error(\"Failed to load equipment database:\", error);\r\n            }\r\n            setLoading(false);\r\n        };\r\n\r\n        fetchData();\r\n    }, []);\r\n\r\n    return { \r\n        loading, \r\n        data: dbData,\r\n        categories: COLLECTIONS\r\n    };\r\n};\r\n"],"names":["COLLECTIONS","useEquipmentDatabase","dbData","setDbData","useState","loading","setLoading","useEffect"],"mappings":"yCAIA,MAAMA,EAAc,CAChB,CAAE,GAAI,gCAAiC,MAAO,6BAA6B,EAC3E,CAAE,GAAI,oCAAqC,MAAO,aAAa,EAC/D,CAAE,GAAI,8BAA+B,MAAO,iBAAiB,EAC7D,CAAE,GAAI,0BAA2B,MAAO,uBAAuB,EAC/D,CAAE,GAAI,6BAA8B,MAAO,eAAe,CAC9D,EAEaC,EAAuB,IAAM,CACtC,KAAM,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAAS,CAAA,CAAE,EACjC,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EAE3CG,OAAAA,EAAAA,UAAU,IAAM,EACM,SAAY,CACX,CACXD,EAAW,EAAK,EAChB,MACJ,CA2CJ,IAGJ,EAAG,CAAA,CAAE,EAEE,CACH,QAAAD,EACA,KAAMH,EACN,WAAYF,CACpB,CACA"}