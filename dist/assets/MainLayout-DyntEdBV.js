const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Sidebar-qWjQrgK8.js","assets/vendor-Dl7DtIXW.js","assets/vendor-D33SxI2g.css","assets/chat-BYF7Vx2D.js","assets/vendor-framer-CUELlS5e.js","assets/edu-BMUxkX2v.js","assets/config-DGZTEYpI.js","assets/Navbar-vLx26Qtv.js","assets/SeshNx-PNG cCropped white text-BVqTFh8v.js","assets/useNotifications-B67BOr67.js","assets/index-DMeDGzcs.js","assets/index-BEQQs5mg.css","assets/PublicProfileModal-CnlWyYKd.js","assets/useVercelUpload-OMd9iZ6b.js","assets/FollowButton-CKe_jms9.js","assets/Dashboard-JjSK8xU-.js","assets/SocialFeed-BUjFvEyx.js","assets/ReportModal-e6fXq6Ul.js","assets/vendor-audio-CY3oQc7h.js","assets/Inputs-BLEJ7bwJ.js","assets/ChatInterface-DIQuziHv.js","assets/BookingSystem-lIwJAkWk.js","assets/vendor-calendar-AI-M08pc.js","assets/vendor-calendar-DxzzN9QP.css","assets/Marketplace-CJrDF8JL.js","assets/TechServices-BB8BcauT.js","assets/EquipmentAutocomplete-BcGdmRJg.js","assets/PaymentsManager-CdkizbMi.js","assets/vendor-stripe-DmTewwA8.js","assets/ProfileManager-vi3hL9Qy.js","assets/SettingsTab-CKvu1dVB.js","assets/BusinessCenter-CAyUrT5W.js","assets/LabelDashboard-BuhGcgq6.js","assets/LegalDocs-lqi-7DnU.js","assets/ContractManager-W-l61knN.js"])))=>i.map(i=>d[i]);
import{S as U,_ as o}from"./edu-BMUxkX2v.js";import{r as n,j as e,b_ as q,b$ as H,c0 as Y,c1 as G,b as J,bL as K,bM as Q,L as z}from"./vendor-Dl7DtIXW.js";import{s as y}from"./chat-BYF7Vx2D.js";import{u as X,E as C}from"./index-DMeDGzcs.js";import"./config-DGZTEYpI.js";import"./vendor-framer-CUELlS5e.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new s.Error().stack;a&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[a]="8328e75e-7cdf-499e-acf0-5378de509a08",s._sentryDebugIdIdentifier="sentry-dbid-8328e75e-7cdf-499e-acf0-5378de509a08")})()}catch{}function Z({activeTab:s,setActiveTab:a}){const[p,x]=n.useState(!1);if(n.useEffect(()=>{const c=()=>{x(window.innerWidth<1024)};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]),!p)return null;const h=[{id:"dashboard",icon:q,label:"Home"},{id:"feed",icon:H,label:"Feed"},{id:"bookings",icon:Y,label:"Bookings"},{id:"messages",icon:G,label:"Messages"},{id:"profile",icon:J,label:"Profile"}];return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-[#1f2128] border-t border-gray-200 dark:border-gray-700 z-50 safe-area-bottom shadow-lg","aria-label":"Bottom navigation",style:{paddingBottom:"max(0.5rem, env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"flex justify-around items-center h-16 px-2",children:h.map(c=>{const d=c.icon,i=s===c.id;return e.jsxs("button",{onClick:()=>a(c.id),className:`flex flex-col items-center justify-center gap-1 flex-1 h-full transition-colors ${i?"text-brand-blue dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,"aria-label":c.label,"aria-current":i?"page":void 0,children:[e.jsx(d,{size:22,strokeWidth:i?2.5:2}),e.jsx("span",{className:"text-xs font-medium",children:c.label}),i&&e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-8 h-1 bg-brand-blue dark:bg-blue-400 rounded-b-full"})]},c.id)})})})}const l=(s,a=3,p=100)=>n.lazy(()=>new Promise((x,h)=>{const c=d=>{try{const i=s();i&&typeof i.then=="function"?i.then(f=>{x(f.default?f:{default:f})}).catch(f=>{d<a?(console.warn(`Lazy load failed, retrying... (${d+1}/${a})`,f),setTimeout(()=>c(d+1),p*(d+1))):(console.error("Lazy load failed after retries:",f),h(f))}):x(i)}catch(i){d<a?(console.warn(`Lazy load sync error, retrying... (${d+1}/${a})`,i),setTimeout(()=>c(d+1),p*(d+1))):(console.error("Lazy load failed after retries (sync error):",i),h(i))}};c(0)})),ee=l(()=>o(()=>import("./Sidebar-qWjQrgK8.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),se=l(()=>o(()=>import("./Navbar-vLx26Qtv.js"),__vite__mapDeps([7,1,2,3,4,8,9,10,5,6,11]))),te=l(()=>o(()=>import("./PublicProfileModal-CnlWyYKd.js"),__vite__mapDeps([12,1,2,13,14,10,5,3,4,6,11]))),M=l(()=>o(()=>import("./Dashboard-JjSK8xU-.js"),__vite__mapDeps([15,5,1,2,3,4,6,9,10,11]))),ne=l(()=>o(()=>import("./SocialFeed-BUjFvEyx.js"),__vite__mapDeps([16,1,2,10,5,3,4,6,11,17,18,9,13,19,14]))),ae=l(()=>o(()=>import("./ChatInterface-DIQuziHv.js"),__vite__mapDeps([20,1,2,3,4]))),re=l(()=>o(()=>import("./BookingSystem-lIwJAkWk.js"),__vite__mapDeps([21,5,1,2,3,4,6,22,23]))),ie=l(()=>o(()=>import("./Marketplace-CJrDF8JL.js"),__vite__mapDeps([24,1,2,3,4,6,17,18]))),oe=l(()=>o(()=>import("./TechServices-BB8BcauT.js"),__vite__mapDeps([25,1,2,3,4,6,26,19]))),le=l(()=>o(()=>import("./PaymentsManager-CdkizbMi.js"),__vite__mapDeps([27,1,2,3,4,6,28]))),ce=l(()=>o(()=>import("./ProfileManager-vi3hL9Qy.js"),__vite__mapDeps([29,1,2,13,30,3,4,10,5,6,11,19,26]))),W=l(()=>o(()=>import("./BusinessCenter-CAyUrT5W.js"),__vite__mapDeps([31,1,2,3,4,26,5,6,32,10,11]))),de=l(()=>o(()=>import("./LegalDocs-lqi-7DnU.js"),__vite__mapDeps([33,1,2]))),fe=l(()=>o(()=>import("./edu-BMUxkX2v.js").then(s=>s.E),__vite__mapDeps([5,1,2,3,4,6]))),ue=l(()=>o(()=>import("./edu-BMUxkX2v.js").then(s=>s.b),__vite__mapDeps([5,1,2,3,4,6]))),be=l(()=>o(()=>import("./edu-BMUxkX2v.js").then(s=>s.d),__vite__mapDeps([5,1,2,3,4,6]))),xe=l(()=>o(()=>import("./edu-BMUxkX2v.js").then(s=>s.c),__vite__mapDeps([5,1,2,3,4,6]))),he=l(()=>o(()=>import("./LabelDashboard-BuhGcgq6.js"),__vite__mapDeps([32,1,2,10,5,3,4,6,11]))),_e=l(()=>o(()=>import("./ContractManager-W-l61knN.js"),__vite__mapDeps([34,1,2,10,5,3,4,6,11]))),N=()=>e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(z,{className:"animate-spin text-brand-blue",size:24})});function Ee({user:s,userData:a,loading:p,darkMode:x,toggleTheme:h,handleLogout:c}){const d=K(),i=Q(),f=t=>t==="/"?"dashboard":t.startsWith("/feed")||t==="/social"?"feed":t.startsWith("/messages")||t.startsWith("/chat")?"messages":t.startsWith("/bookings")?"bookings":t.startsWith("/marketplace")?"marketplace":t.startsWith("/tech")?"tech":t.startsWith("/payments")||t==="/billing"?"payments":t.startsWith("/profile")?"profile":t.startsWith("/business-center")?"business-center":t==="/legal"?"legal":t.startsWith("/studio-ops")?"studio-ops":t.startsWith("/labels")?"labels":t.startsWith("/edu-")?t.substring(1).split("/")[0]:"dashboard",[_,b]=n.useState(()=>f(i.pathname)),[L,R]=n.useState(!1),[g,E]=n.useState({}),[v,k]=n.useState(0),[T,S]=n.useState(null),[D,I]=n.useState(null),j=n.useRef(!0),P=n.useRef(!1),A=n.useRef(i.pathname),w=n.useRef(!1);n.useEffect(()=>{const t=i.pathname;if(A.current===t){j.current&&(j.current=!1);return}A.current=t;const r=f(t);w.current&&(w.current=!1),b(u=>u!==r?(P.current=!0,r):u),j.current&&(j.current=!1)},[i.pathname]),n.useEffect(()=>{if(j.current)return;if(P.current){P.current=!1;return}const r={dashboard:"/",feed:"/feed",messages:"/messages",bookings:"/bookings",marketplace:"/marketplace",tech:"/tech",payments:"/payments",profile:"/profile","business-center":"/business-center",legal:"/legal","edu-student":"/edu-student","edu-intern":"/edu-intern","edu-overview":"/edu-overview","edu-admin":"/edu-admin","studio-ops":"/studio-ops"}[_];r&&!i.pathname.startsWith(r)&&(w.current=!0,d(r,{replace:!0}))},[_,d,i.pathname]),n.useEffect(()=>{if(!(s!=null&&s.id)||!y)return;(async()=>{try{const{data:r,error:u}=await y.from("sub_profiles").select("*").eq("user_id",s.id);if(u){console.warn("Sub-profiles table not available (migration in progress):",u.message),E({});return}const O={};r==null||r.forEach(V=>{O[V.account_type]=V}),E(O)}catch(r){console.warn("Failed to load sub-profiles (non-critical):",(r==null?void 0:r.message)||r),E({})}})()},[s==null?void 0:s.id]),n.useEffect(()=>{if(!(s!=null&&s.id)||!y)return;(async()=>{try{const{data:r,error:u}=await y.from("wallets").select("balance").eq("user_id",s.id).maybeSingle();if(u){console.warn("Wallets table not available (migration in progress):",u.message),k(0);return}r&&k(r.balance||0)}catch(r){console.warn("Failed to load token balance (non-critical):",(r==null?void 0:r.message)||r),k(0)}})()},[s==null?void 0:s.id]);const B=async t=>{if(s!=null&&s.id)try{await X(s.id,{active_role:t}),setUserData(r=>({...r,activeProfileRole:t})),console.log(`âœ… Role switched to: ${t}`)}catch(r){console.error("Role switch failed:",r)}},m=n.useCallback((t,r)=>{S({uid:t,name:r})},[]),F=n.useCallback(()=>{I(null)},[]),$=()=>{if(!a||!a.id)return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-blue mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})});const t=()=>e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(z,{className:"animate-spin text-brand-blue",size:32})});switch(_){case"dashboard":return e.jsx(C,{name:"Dashboard",children:e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(C,{name:"Dashboard-Inner",children:e.jsx(M,{user:s,userData:a,setActiveTab:b,bookingCount:0,subProfiles:g,tokenBalance:v})})})});case"feed":case"social":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(ne,{user:s,userData:a,openPublicProfile:m})});case"messages":case"chat":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(ae,{user:s,userData:a,openPublicProfile:m,pendingChatTarget:D,clearPendingChatTarget:F})});case"bookings":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(re,{user:s,userData:a,subProfiles:g,openPublicProfile:m})});case"marketplace":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(ie,{user:s,userData:a,tokenBalance:v})});case"tech":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(oe,{user:s,userData:a,openPublicProfile:m})});case"payments":case"billing":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(le,{user:s,userData:a,tokenBalance:v})});case"profile":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(ce,{user:s,userData:a,subProfiles:g,handleLogout:c,openPublicProfile:m})});case"business-center":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(W,{user:s,userData:a})});case"labels":return i.pathname.split("/")[2]==="contracts"?e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(_e,{user:s,userData:a})}):e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(he,{user:s,userData:a})});case"legal":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(de,{})});case"edu-student":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(fe,{user:s,userData:a})});case"edu-intern":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(ue,{user:s,userData:a})});case"edu-overview":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(be,{user:s,userData:a})});case"edu-admin":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(xe,{user:s,userData:a})});case"studio-ops":return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(W,{user:s,userData:a})});default:return e.jsx(n.Suspense,{fallback:e.jsx(t,{}),children:e.jsx(M,{user:s,userData:a,setActiveTab:b,bookingCount:0,subProfiles:g,tokenBalance:v})})}};return e.jsx(U,{user:s,userData:a,children:e.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-[#1a1d21]",children:[e.jsx(n.Suspense,{fallback:e.jsx(N,{}),children:e.jsx(ee,{userData:a,activeTab:_,setActiveTab:b,sidebarOpen:L,setSidebarOpen:R,handleLogout:c})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(n.Suspense,{fallback:e.jsx(N,{}),children:e.jsx(se,{user:s,userData:a,subProfiles:g,darkMode:x,toggleTheme:h,activeTab:_,setActiveTab:b,onMenuClick:()=>R(!L),onRoleSwitch:B,openPublicProfile:m})}),e.jsx("main",{className:"flex-1 overflow-y-auto pb-16 lg:pb-0 px-fluid pt-4",children:$()})]}),e.jsx(Z,{activeTab:_,setActiveTab:b}),T&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(te,{userId:T.uid,currentUser:s,currentUserData:a,onClose:()=>S(null),onMessage:(t,r)=>{I({uid:t,name:r}),b("messages"),S(null)}})})]})})}export{Ee as default};
