const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Sidebar--cIMo5Pd.js","assets/vendor-mIyI6DiM.js","assets/vendor-D33SxI2g.css","assets/edu-V9buPGJB.js","assets/config-VNvva2Pv.js","assets/chat-P1NCmzAv.js","assets/vendor-framer-_HoVf1_M.js","assets/Navbar-SGpozbGd.js","assets/SeshNx-PNG cCropped white text-BVqTFh8v.js","assets/useNotifications-42Kdrv6W.js","assets/index-BCKV8ync.js","assets/index-C4-99t-f.css","assets/PublicProfileModal-B3BjRIfd.js","assets/useVercelUpload-DnObj6TS.js","assets/FollowButton-CXf-Lq9F.js","assets/Dashboard-DoUH5laJ.js","assets/SocialFeed-DWSmGFvp.js","assets/ReportModal-MivBJc5d.js","assets/vendor-audio-CY3oQc7h.js","assets/Inputs-DvD9MlMc.js","assets/ChatInterface-4luX_nLl.js","assets/BookingSystem-BZFxukgS.js","assets/vendor-calendar-Bm9ELT3v.js","assets/vendor-calendar-DxzzN9QP.css","assets/Marketplace-DSUI_4dR.js","assets/useMarketplace-VvJPAWav.js","assets/TechServices-CDYiIIsw.js","assets/EquipmentAutocomplete-BdotCIX_.js","assets/PaymentsManager-TJO5wJo8.js","assets/vendor-stripe-DmTewwA8.js","assets/ProfileManager-FhMJvPVi.js","assets/SettingsTab-Ct0D1X5H.js","assets/BusinessCenter-jxPRociV.js","assets/LabelDashboard-BmMBcdOH.js","assets/LegalDocs-gIowHZ_w.js","assets/ContractManager-C5Ko8iVZ.js"])))=>i.map(i=>d[i]);
import{S as q,_ as l}from"./edu-V9buPGJB.js";import{r as i,j as e,c6 as Y,c7 as G,c8 as J,c9 as K,a as Q,bM as X,bN as Z,L as F}from"./vendor-mIyI6DiM.js";import{g as D,b as ee,u as ne,E as W}from"./index-BCKV8ync.js";import"./config-VNvva2Pv.js";import"./chat-P1NCmzAv.js";import"./vendor-framer-_HoVf1_M.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new n.Error().stack;t&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[t]="d8ce57b8-2334-4eab-abd2-3617ef97037e",n._sentryDebugIdIdentifier="sentry-dbid-d8ce57b8-2334-4eab-abd2-3617ef97037e")})()}catch{}function se({activeTab:n,setActiveTab:t}){const[p,h]=i.useState(!1);if(i.useEffect(()=>{const c=()=>{h(window.innerWidth<1024)};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]),!p)return null;const _=[{id:"dashboard",icon:Y,label:"Home"},{id:"feed",icon:G,label:"Feed"},{id:"bookings",icon:J,label:"Bookings"},{id:"messages",icon:K,label:"Messages"},{id:"profile",icon:Q,label:"Profile"}];return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-[#1f2128] border-t border-gray-200 dark:border-gray-700 z-50 safe-area-bottom shadow-lg","aria-label":"Bottom navigation",style:{paddingBottom:"max(0.5rem, env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"flex justify-around items-center h-16 px-2",children:_.map(c=>{const d=c.icon,a=n===c.id;return e.jsxs("button",{onClick:()=>t(c.id),className:`flex flex-col items-center justify-center gap-1 flex-1 h-full transition-colors ${a?"text-brand-blue dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,"aria-label":c.label,"aria-current":a?"page":void 0,children:[e.jsx(d,{size:22,strokeWidth:a?2.5:2}),e.jsx("span",{className:"text-xs font-medium",children:c.label}),a&&e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-8 h-1 bg-brand-blue dark:bg-blue-400 rounded-b-full"})]},c.id)})})})}const r=(n,t=3,p=100)=>i.lazy(()=>new Promise((h,_)=>{const c=d=>{try{const a=n();a&&typeof a.then=="function"?a.then(f=>{h(f.default?f:{default:f})}).catch(f=>{d<t?(console.warn(`Lazy load failed, retrying... (${d+1}/${t})`,f),setTimeout(()=>c(d+1),p*(d+1))):(console.error("Lazy load failed after retries:",f),_(f))}):h(a)}catch(a){d<t?(console.warn(`Lazy load sync error, retrying... (${d+1}/${t})`,a),setTimeout(()=>c(d+1),p*(d+1))):(console.error("Lazy load failed after retries (sync error):",a),_(a))}};c(0)})),te=r(()=>l(()=>import("./Sidebar--cIMo5Pd.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),ie=r(()=>l(()=>import("./Navbar-SGpozbGd.js"),__vite__mapDeps([7,1,2,8,5,6,9,10,3,4,11]))),oe=r(()=>l(()=>import("./PublicProfileModal-B3BjRIfd.js"),__vite__mapDeps([12,1,2,13,5,6,14,10,3,4,11]))),N=r(()=>l(()=>import("./Dashboard-DoUH5laJ.js"),__vite__mapDeps([15,3,1,2,4,5,6,9,10,11]))),ae=r(()=>l(()=>import("./SocialFeed-DWSmGFvp.js"),__vite__mapDeps([16,1,2,10,3,4,5,6,11,17,18,9,13,19,14]))),le=r(()=>l(()=>import("./ChatInterface-4luX_nLl.js"),__vite__mapDeps([20,1,2,5,6]))),re=r(()=>l(()=>import("./BookingSystem-BZFxukgS.js"),__vite__mapDeps([21,3,1,2,4,5,6,22,23,10,11]))),ce=r(()=>l(()=>import("./Marketplace-DSUI_4dR.js"),__vite__mapDeps([24,1,2,5,6,25,10,3,4,11,17,18]))),de=r(()=>l(()=>import("./TechServices-CDYiIIsw.js"),__vite__mapDeps([26,1,2,4,5,6,27,10,3,11,19]))),fe=r(()=>l(()=>import("./PaymentsManager-TJO5wJo8.js"),__vite__mapDeps([28,1,2,4,29]))),be=r(()=>l(()=>import("./ProfileManager-FhMJvPVi.js"),__vite__mapDeps([30,1,2,13,5,6,31,10,3,4,11,19,27]))),B=r(()=>l(()=>import("./BusinessCenter-jxPRociV.js"),__vite__mapDeps([32,1,2,5,6,27,10,3,4,11,33,25]))),ue=r(()=>l(()=>import("./LegalDocs-gIowHZ_w.js"),__vite__mapDeps([34,1,2]))),xe=r(()=>l(()=>import("./edu-V9buPGJB.js").then(n=>n.E),__vite__mapDeps([3,1,2,4,5,6]))),he=r(()=>l(()=>import("./edu-V9buPGJB.js").then(n=>n.b),__vite__mapDeps([3,1,2,4,5,6]))),_e=r(()=>l(()=>import("./edu-V9buPGJB.js").then(n=>n.d),__vite__mapDeps([3,1,2,4,5,6]))),me=r(()=>l(()=>import("./edu-V9buPGJB.js").then(n=>n.c),__vite__mapDeps([3,1,2,4,5,6]))),ge=r(()=>l(()=>import("./LabelDashboard-BmMBcdOH.js"),__vite__mapDeps([33,1,2,10,3,4,5,6,11]))),pe=r(()=>l(()=>import("./ContractManager-C5Ko8iVZ.js"),__vite__mapDeps([35,1,2,10,3,4,5,6,11]))),z=()=>e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(F,{className:"animate-spin text-brand-blue",size:24})});function Pe({user:n,userData:t,loading:p,darkMode:h,toggleTheme:_,handleLogout:c}){var V,C;const d=X(),a=Z(),f=s=>s==="/dashboard"||s==="/"?"dashboard":s.startsWith("/feed")||s==="/social"?"feed":s.startsWith("/messages")||s.startsWith("/chat")?"messages":s.startsWith("/bookings")?"bookings":s.startsWith("/marketplace")?"marketplace":s.startsWith("/tech")?"tech":s.startsWith("/payments")||s==="/billing"?"payments":s.startsWith("/profile")?"profile":s.startsWith("/business-center")?"business-center":s==="/legal"?"legal":s.startsWith("/studio-ops")?"studio-ops":s.startsWith("/labels")?"labels":s.startsWith("/edu-")?s.substring(1).split("/")[0]:"dashboard",[m,b]=i.useState(()=>f(a.pathname)),[P,w]=i.useState(!1),[u,L]=i.useState({}),[v,R]=i.useState(0),[I,E]=i.useState(null),[$,T]=i.useState(null),j=i.useRef(!0),y=i.useRef(!1),A=i.useRef(a.pathname),k=i.useRef(!1);i.useEffect(()=>{const s=a.pathname;if(A.current===s){j.current&&(j.current=!1);return}A.current=s;const o=f(s);k.current&&(k.current=!1),b(x=>x!==o?(y.current=!0,o):x),j.current&&(j.current=!1)},[a.pathname]),i.useEffect(()=>{if(j.current)return;if(y.current){y.current=!1;return}const o={dashboard:"/dashboard",feed:"/feed",messages:"/messages",bookings:"/bookings",marketplace:"/marketplace",tech:"/tech",payments:"/payments",profile:"/profile","business-center":"/business-center",legal:"/legal","edu-student":"/edu-student","edu-intern":"/edu-intern","edu-overview":"/edu-overview","edu-admin":"/edu-admin","studio-ops":"/studio-ops",labels:"/labels"}[m];o&&!a.pathname.startsWith(o)&&(k.current=!0,d(o,{replace:!0}))},[m,d,a.pathname]);const S=i.useCallback(async()=>{if(!(!(t!=null&&t.id)&&!(n!=null&&n.id)))try{const s=(t==null?void 0:t.id)||(n==null?void 0:n.id),o=await D(s),x={};o==null||o.forEach(M=>{x[M.account_type]=M}),L(x)}catch(s){console.warn("Failed to load sub-profiles (non-critical):",(s==null?void 0:s.message)||s),L({})}},[t==null?void 0:t.id,n==null?void 0:n.id]);i.useEffect(()=>{S()},[S]),i.useEffect(()=>{if(!(t!=null&&t.id)&&!(n!=null&&n.id))return;(async()=>{try{const o=(t==null?void 0:t.id)||(n==null?void 0:n.id),x=await ee(o);R(x)}catch(o){console.warn("Failed to load token balance (non-critical):",(o==null?void 0:o.message)||o),R(0)}})()},[t==null?void 0:t.id,n==null?void 0:n.id]);const O=async s=>{if(n!=null&&n.id)try{await ne(n.id,{active_role:s}),setUserData(o=>({...o,activeProfileRole:s})),console.log(`âœ… Role switched to: ${s}`)}catch(o){console.error("Role switch failed:",o)}},g=i.useCallback((s,o)=>{E({uid:s,name:o})},[]),U=i.useCallback(()=>{T(null)},[]),H=()=>{if(!t||!t.id)return e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-blue mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})});const s=()=>e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(F,{className:"animate-spin text-brand-blue",size:32})});switch(m){case"dashboard":return e.jsx(W,{name:"Dashboard",children:e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(W,{name:"Dashboard-Inner",children:e.jsx(N,{user:n,userData:t,setActiveTab:b,bookingCount:0,subProfiles:u,tokenBalance:v})})})});case"feed":case"social":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ae,{user:n,userData:t,subProfiles:u,openPublicProfile:g})});case"messages":case"chat":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(le,{user:n,userData:t,subProfiles:u,openPublicProfile:g,pendingChatTarget:$,clearPendingChatTarget:U})});case"bookings":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(re,{user:n,userData:t,subProfiles:u,openPublicProfile:g})});case"marketplace":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ce,{user:n,userData:t,tokenBalance:v})});case"tech":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(de,{user:n,userData:t,openPublicProfile:g})});case"payments":case"billing":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(fe,{user:n,userData:t,tokenBalance:v})});case"profile":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(be,{user:n,userData:t,subProfiles:u,handleLogout:c,openPublicProfile:g,onSubProfileUpdate:S,onRoleSwitch:O})});case"business-center":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(B,{user:n,userData:t})});case"labels":return a.pathname.split("/")[2]==="contracts"?e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(pe,{user:n,userData:t})}):e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ge,{user:n,userData:t})});case"legal":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(ue,{})});case"edu-student":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(xe,{user:n,userData:t})});case"edu-intern":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(he,{user:n,userData:t})});case"edu-overview":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(_e,{user:n,userData:t})});case"edu-admin":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(me,{user:n,userData:t})});case"studio-ops":return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(B,{user:n,userData:t})});default:return e.jsx(i.Suspense,{fallback:e.jsx(s,{}),children:e.jsx(N,{user:n,userData:t,setActiveTab:b,bookingCount:0,subProfiles:u,tokenBalance:v})})}};return e.jsx(q,{user:n,userData:t,children:e.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-[#1a1d21]",children:[e.jsx(i.Suspense,{fallback:e.jsx(z,{}),children:e.jsx(te,{userData:t,activeTab:m,setActiveTab:b,sidebarOpen:P,setSidebarOpen:w,handleLogout:c})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(i.Suspense,{fallback:e.jsx(z,{}),children:e.jsx(ie,{user:n,userData:t,subProfiles:u,darkMode:h,toggleTheme:_,activeTab:m,setActiveTab:b,onMenuClick:()=>w(!P),onRoleSwitch:O,openPublicProfile:g,showBreadcrumbs:((C=(V=t==null?void 0:t.settings)==null?void 0:V.ui)==null?void 0:C.showBreadcrumbs)===!0})}),e.jsx("main",{className:"flex-1 overflow-y-auto pb-16 lg:pb-0 px-fluid pt-4",children:H()})]}),e.jsx(se,{activeTab:m,setActiveTab:b}),I&&e.jsx(i.Suspense,{fallback:null,children:e.jsx(oe,{userId:I.uid,currentUser:n,currentUserData:t,onClose:()=>E(null),onMessage:(s,o)=>{T({uid:s,name:o}),b("messages"),E(null)}})})]})})}export{Pe as default};
