import{r as b,j as r,S as E,X as N,L as S}from"./vendor-mIyI6DiM.js";import{ah as D}from"./index-BCKV8ync.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};a.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new a.Error().stack;o&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[o]="fa4b0d4b-22a1-4a70-a50e-7ff31163d8f9",a._sentryDebugIdIdentifier="sentry-dbid-fa4b0d4b-22a1-4a70-a50e-7ff31163d8f9")})()}catch{}const q=()=>{const[a,o]=b.useState({}),[h,u]=b.useState(!0);return b.useEffect(()=>{(async()=>{u(!0);try{const y=await D(),l={};for(const[s,f]of Object.entries(y)){l[s]={};for(const[i,d]of Object.entries(f))l[s][i]=d.map(e=>({id:e.id,name:e.name,brand:e.brand||"Unknown",model:e.model,category:s,subCategory:i,description:e.description,specifications:e.specifications,searchTokens:[],original:e}))}o(l)}catch(y){console.error("Failed to load equipment database:",y),o({})}u(!1)})()},[]),{loading:h,data:a}},L=()=>{const{data:a,loading:o}=q(),[h,u]=b.useState([]),c=b.useMemo(()=>{if(o||!a)return[];let l=[];try{Object.keys(a).forEach(s=>{const f=a[s];!f||typeof f!="object"||Object.entries(f).forEach(([i,d])=>{Array.isArray(d)&&d.forEach(e=>{if(!e||typeof e!="object")return;const g=e.brand||"Unknown",p=e.name||e.model||"Unknown Item",m=e.subCategory||i,w=e.searchTokens||[],j=[p,g,e.model,...w].filter(Boolean).join(" ").toLowerCase();l.push({id:e.id,name:p,brand:g,model:e.model||p,category:e.category||s,subCategory:m,searchString:j,original:e.original||e})})})})}catch(s){console.warn("Error processing equipment data:",s)}return l},[a,o]);return{searchEquipment:l=>{if(!l||l.trim().length<1){u([]);return}const s=l.toLowerCase().trim().split(/\s+/).filter(i=>i.length>0);if(s.length===0){u([]);return}const f=c.filter(i=>s.every(d=>i.searchString.includes(d))).slice(0,50);u(f)},results:h,loading:o}};function R({onSelect:a,placeholder:o="Search for gear (e.g. U87, SSL)...",className:h="",value:u,onChange:c,multi:y=!1}){const{searchEquipment:l,results:s,loading:f}=L(),[i,d]=b.useState(""),[e,g]=b.useState(!1),p=b.useRef(null),m=u!==void 0?u:i;b.useEffect(()=>{function t(n){p.current&&!p.current.contains(n.target)&&g(!1)}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[p]);const w=t=>{const n=t.target.value;c?c(n):d(n);const x=y?n.split(",").pop().trim():n;x.length>=2?(l(x),g(!0)):g(!1)},j=t=>{const n=t.brand!=="Various"&&t.brand!=="Unknown"?`${t.brand} ${t.name}`:t.name;if(y){const x=m.split(",");x.pop();const k=[...x.map(v=>v.trim()).filter(Boolean),n].join(", ")+", ";c?c(k):d(k)}else a&&a({...t,fullName:n}),c?c(n):d(n);g(!1)};return r.jsxs("div",{ref:p,className:`relative ${h}`,children:[r.jsxs("div",{className:"relative",children:[r.jsx(E,{className:"absolute left-3 top-3 text-gray-400",size:16}),r.jsx("input",{className:"w-full pl-9 pr-8 p-3 text-sm border rounded-xl bg-white dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none transition-all",placeholder:o,value:m,onChange:w,onFocus:t=>w(t)}),m&&r.jsx("button",{type:"button",onClick:()=>{c?c(""):d(""),g(!1)},className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:r.jsx(N,{size:16})})]}),e&&s.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl max-h-60 overflow-y-auto animate-in fade-in slide-in-from-top-2",children:r.jsx("div",{className:"py-1",children:s.map(t=>{var n;return r.jsxs("button",{type:"button",onClick:()=>j(t),className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b dark:border-gray-700/50 last:border-0 group",children:[r.jsx("div",{className:"font-bold text-sm dark:text-white group-hover:text-brand-blue transition-colors",children:t.name}),r.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1.5 mt-0.5",children:[r.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:t.brand}),r.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600"}),r.jsx("span",{className:"opacity-75",children:(n=t.subCategory)==null?void 0:n.replace(/_/g," ")})]})]},t.id)})})}),e&&f&&r.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl p-4 text-center text-gray-500 flex items-center justify-center gap-2",children:[r.jsx(S,{className:"animate-spin",size:16})," Searching database..."]})]})}export{R as E};
