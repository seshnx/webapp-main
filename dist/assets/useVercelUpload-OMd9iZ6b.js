import{r as y}from"./vendor-Dl7DtIXW.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new e.Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="016fa9d4-8826-4558-a73b-35e1ead0fe77",e._sentryDebugIdIdentifier="sentry-dbid-016fa9d4-8826-4558-a73b-35e1ead0fe77")})()}catch{}const h={PROFILE_PHOTOS:"profile-photos",POST_MEDIA:"post-media"};async function S(e,r=h.POST_MEDIA,s={}){throw new Error("Vercel Blob is not configured. Set BLOB_READ_WRITE_TOKEN environment variable.")}function T(e){var r;return((r=e.type)==null?void 0:r.startsWith("image/"))||!1}function _(e,r=5){const s=r*1024*1024;return e.size<=s}const I=()=>{const[e,r]=y.useState(!1),[s,n]=y.useState(null),[m,a]=y.useState(0),c=async(o,f="general",i={})=>{if(!o)return null;const l=i.maxSizeMB||10;if(!_(o,l)){const t=`File size exceeds ${l}MB limit`;return n(t),console.error(t),null}if(i.allowedTypes&&!i.allowedTypes.includes(o.type)){const t=`File type not allowed. Allowed types: ${i.allowedTypes.join(", ")}`;return n(t),console.error(t),null}r(!0),n(null),a(0);try{let t="file";o.type.startsWith("video/")?t="video":o.type.startsWith("audio/")?t="audio":o.type.startsWith("image/")&&(t="image");const g=Date.now(),d=o.name.replace(/[^a-zA-Z0-9._-]/g,"_"),p=Math.random().toString(36).substring(2,8),b=`${g}_${p}_${d}`;a(20);const u=await S(o,f,{customFileName:b,addRandomSuffix:!1,...i});a(100);const E={url:u.url,previewUrl:u.url,storageRef:u.pathname,type:t,name:o.name,size:o.size,mimeType:o.type,contentType:u.contentType,uploadedAt:u.uploadedAt,downloadUrl:u.downloadUrl};return r(!1),a(0),E}catch(t){return console.error("Upload failed:",t),n(t.message||"An unknown error occurred during upload."),r(!1),a(0),null}};return{uploadMedia:c,uploadMultiple:async(o,f="general",i={})=>{if(!o||o.length===0)return[];r(!0),n(null),a(0);try{const l=Array.from(o),t=[],g=l.length;for(let d=0;d<l.length;d++){a(Math.round((d+1)/g*100));const p=await c(l[d],f,i);p&&t.push(p)}return a(100),r(!1),t}catch(l){return console.error("Batch upload failed:",l),n(l.message||"Batch upload failed"),r(!1),a(0),[]}},uploading:e,error:s,progress:m,isUploading:e,hasError:!!s,clearError:()=>n(null)}},O=(e={})=>{const{uploadMedia:r,uploading:s,error:n}=I();return{uploadImage:async(a,c=h.PROFILE_PHOTOS)=>{if(!a)return null;if(!T(a))return console.error("File is not an image"),null;const w={maxSizeMB:5,allowedTypes:["image/jpeg","image/png","image/gif","image/webp"],...e};return await r(a,c,w)},uploading:s,error:n,isUploading:s,hasError:!!n}};export{I as a,O as u};
