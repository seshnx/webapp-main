import{r as n,j as e,X as N,b_ as w,a5 as k,L as B,c7 as C,a0 as y,a as S,h as z,T as M,g as L}from"./vendor-M-mhr7Zm.js";import{f as R}from"./edu-YZBmRE0G.js";import"./chat-CfZHA2ny.js";import"./vendor-framer-1_AFqeeG.js";import"./config-yUl3KxdD.js";function F({user:a,userData:l,broadcast:r,onClose:o}){const[g,d]=n.useState(Math.floor((r.offer_amount||r.offerAmount)/(r.duration||1))),[i,c]=n.useState(""),[x,u]=n.useState(!1),b=g*(r.duration||1),h=r.offer_amount||r.offerAmount,m=b>h,j=async()=>{if(!g||!i)return alert("Please enter a rate and a message.");if(m)return alert("Your bid exceeds the client's budget.");{alert("Database unavailable.");return}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md animate-in zoom-in-95",children:[e.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Place Your Bid"}),e.jsx("button",{onClick:o,children:e.jsx(N,{size:20,className:"text-gray-500 hover:text-white"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800",children:[e.jsx("div",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 uppercase mb-1",children:"Client's Budget"}),e.jsxs("div",{className:"text-2xl font-extrabold dark:text-white",children:["$",h," ",e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["Total (",r.duration," hrs)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Your Hourly Rate ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{size:16,className:"absolute left-3 top-3.5 text-gray-400"}),e.jsx("input",{type:"number",className:`w-full pl-8 p-3 border rounded-xl font-bold text-lg outline-none dark:bg-[#1f2128] dark:text-white ${m?"border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-brand-blue"}`,value:g,onChange:t=>d(t.target.value)})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Total Bid:"}),e.jsxs("span",{className:`font-bold ${m?"text-red-500":"text-green-600"}`,children:["$",b]})]}),m&&e.jsxs("div",{className:"text-xs text-red-500 mt-1 flex items-center gap-1",children:[e.jsx(k,{size:12})," Bid exceeds budget. Consider lowering your rate."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Message to Client"}),e.jsx("textarea",{className:"w-full p-3 border rounded-xl text-sm dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none resize-none",rows:"3",placeholder:"Introduce yourself and your gear...",value:i,onChange:t=>c(t.target.value)})]}),e.jsx("button",{onClick:j,disabled:x||m,className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:shadow-none",children:x?e.jsx(B,{className:"animate-spin"}):"Submit Proposal"})]})]})})}function v(a,l,r,o){var g=6371,d=p(r-a),i=p(o-l),c=Math.sin(d/2)*Math.sin(d/2)+Math.cos(p(a))*Math.cos(p(r))*Math.sin(i/2)*Math.sin(i/2),x=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return g*x*.621371}function p(a){return a*(Math.PI/180)}function q({user:a,userData:l,onBid:r}){const[o,g]=n.useState([]),[d,i]=n.useState([]),[c,x]=n.useState(null),[u,b]=n.useState(null),[h,m]=n.useState(50);n.useEffect(()=>{(async()=>{if(l!=null&&l.zip){const s=await R(l.zip);s&&b({lat:s.lat,lng:s.lng})}else navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>b({lat:s.coords.latitude,lng:s.coords.longitude}))})()},[l]),n.useEffect(()=>{},[]),n.useEffect(()=>{if(!u){i(o);return}const t=o.filter(s=>!s.location||!s.location.lat||!s.location.lng?!0:v(u.lat,u.lng,s.location.lat,s.location.lng)<=h).map(s=>{const f=s.location?v(u.lat,u.lng,s.location.lat,s.location.lng):null;return{...s,distance:f}}).sort((s,f)=>(s.distance||9999)-(f.distance||9999));i(t)},[o,u,h]);const j=async t=>{window.confirm("Cancel this broadcast? This will remove it from the board.")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[e.jsx(C,{className:"text-yellow-500",size:20})," Open Sessions"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Live opportunities near you."})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[e.jsx(y,{size:14,className:"ml-2 text-gray-500"}),e.jsxs("select",{className:"bg-transparent text-sm font-bold text-gray-700 dark:text-gray-300 p-1 outline-none cursor-pointer",value:h,onChange:t=>m(Number(t.target.value)),children:[e.jsx("option",{value:10,children:"Within 10 mi"}),e.jsx("option",{value:25,children:"Within 25 mi"}),e.jsx("option",{value:50,children:"Within 50 mi"}),e.jsx("option",{value:100,children:"Within 100 mi"}),e.jsx("option",{value:5e3,children:"Anywhere"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.length===0?e.jsx("div",{className:"col-span-full text-center py-12 bg-white dark:bg-[#2c2e36] rounded-xl border border-dashed dark:border-gray-700 text-gray-500",children:"No open sessions found."}):d.map(t=>e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm hover:shadow-md transition-all group relative overflow-hidden",children:[e.jsxs("div",{className:"absolute top-0 right-0 bg-brand-blue text-white text-[10px] font-bold px-3 py-1 rounded-bl-lg",children:["BUDGET: $",t.offerAmount||"N/A"]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 flex justify-between",children:[e.jsx("span",{children:t.serviceType}),typeof t.distance=="number"&&e.jsxs("span",{className:"text-brand-blue flex items-center gap-1",children:[e.jsx(y,{size:10})," ",t.distance.toFixed(1)," mi"]})]}),e.jsx("h4",{className:"text-lg font-bold dark:text-white truncate pr-16",children:t.targetName||"Session Request"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-300 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{size:14})," ",t.senderName]}),t.date&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{size:14})," ",t.date==="Flexible"?"Flexible":new Date(t.date).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:t.requirements&&t.requirements.slice(0,3).map((s,f)=>e.jsx("span",{className:"text-[10px] bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-600 dark:text-gray-300 border dark:border-gray-600",children:s.value},f))}),e.jsx("div",{className:"flex gap-2",children:t.sender_id===((a==null?void 0:a.id)||(a==null?void 0:a.uid))?e.jsxs("button",{onClick:()=>j(t.id),className:"w-full bg-red-100 text-red-600 py-2.5 rounded-lg font-bold text-sm hover:bg-red-200 transition flex items-center justify-center gap-2",children:[e.jsx(M,{size:16})," Cancel"]}):e.jsxs("button",{onClick:()=>x(t),className:"w-full bg-gray-900 dark:bg-white dark:text-black text-white py-2.5 rounded-lg font-bold text-sm hover:opacity-90 transition flex justify-center items-center gap-2",children:["View & Bid ",e.jsx(L,{size:16})]})})]},t.id))}),c&&e.jsx(F,{user:a,userData:l,broadcast:c,onClose:()=>x(null)})]})}export{q as default};
