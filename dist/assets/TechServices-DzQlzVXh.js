import{r as c,j as e,a as F,aL as X,aX as A,X as G,V as O,L as $,S as Z,J as ee,b9 as ae,aQ as se,bw as te,n as re,bx as le,by as de,v as ie,a9 as oe,ae as ne}from"./vendor-DTDDt3fP.js";import{q as D,L as V,K,C as q,G as J,I as U,H as I,w as P,j as ce,k as xe,A as T,E as C,F as _,T as be,V as M,B as ge}from"./vendor-firebase-C38qHjbM.js";import{b as L,d as v,u as Y,g as w}from"./chat-BCnoKXi-.js";import{e as z,T as Q,E as H}from"./edu-Bzk_yg6o.js";import{M as ue}from"./Inputs-CuyMtJZQ.js";import"./vendor-convex-DiXsReyd.js";import"./vendor-framer-CzAUfL-F.js";function me({user:l}){const[r,x]=c.useState([]),[t,n]=c.useState("All");return c.useEffect(()=>{const d=D(q(v,`artifacts/${L}/public/data/service_requests`),K("timestamp","desc"),V(50)),s=J(d,u=>x(u.docs.map(i=>({id:i.id,...i.data()}))));return()=>s()},[]),e.jsxs("div",{className:"animate-in fade-in",children:[e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 scrollbar-hide mb-2",children:[e.jsx("button",{onClick:()=>n("All"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap border transition ${t==="All"?"bg-orange-500 text-white border-orange-600":"bg-white dark:bg-dark-card border-gray-200 dark:border-gray-700 dark:text-gray-300"}`,children:"All Jobs"}),z.map(d=>e.jsx("button",{onClick:()=>n(d.label),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap border transition ${t===d.label?"bg-orange-500 text-white border-orange-600":"bg-white dark:bg-dark-card border-gray-200 dark:border-gray-700 dark:text-gray-300"}`,children:d.label},d.id))]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.filter(d=>t==="All"||d.category===t).map(d=>e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 hover:border-orange-400 transition shadow-sm group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/20 px-2 py-0.5 rounded",children:d.category}),d.budget&&e.jsxs("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:["$",d.budget]})]}),e.jsx("h3",{className:"font-bold text-lg dark:text-white mb-1",children:d.topic}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-2 mb-4",children:d.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 border-t dark:border-gray-700 pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{size:12})," ",d.userName]}),d.userId!==l.uid&&e.jsxs("button",{className:"bg-gray-900 dark:bg-white dark:text-black text-white px-3 py-1.5 rounded font-bold hover:opacity-80 flex items-center gap-1",children:[e.jsx(X,{size:12})," Message"]})]})]},d.id)),r.length===0&&e.jsx("div",{className:"col-span-full text-center py-12 text-gray-400",children:"No active requests."})]})]})}function pe({user:l,userData:r,target:x,onClose:t}){const[n,d]=c.useState(!1),[s,u]=c.useState({serviceCategory:"Repair",equipmentName:"",issueDescription:"",logistics:"Drop-off",preferredDate:"",budgetCap:""}),[i,o]=c.useState([]),{uploadMedia:f,uploading:b}=Y(),y=async a=>{const h=a.target.files[0];if(!h)return;const p=await f(h,`tech_requests/${l.uid}`);p&&o(j=>[...j,p])},k=async()=>{if(!s.equipmentName||!s.issueDescription)return alert("Please describe the equipment and the issue.");d(!0);try{await U(q(v,`artifacts/${L}/public/data/bookings`),{senderId:l.uid,senderName:`${r.firstName} ${r.lastName}`,targetId:x.id,targetName:x.firstName?`${x.firstName} ${x.lastName}`:x.name,type:"TechRequest",serviceType:s.serviceCategory,equipment:s.equipmentName,description:s.issueDescription,logistics:s.logistics,budgetCap:s.budgetCap,status:"Pending",date:s.preferredDate||"Flexible",message:`[${s.serviceCategory}] ${s.equipmentName}: ${s.issueDescription}`,attachments:i,timestamp:I()}),alert("Service request sent!"),t()}catch{alert("Failed to send.")}d(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4 animate-in fade-in zoom-in-95",children:e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg dark:text-white flex items-center gap-2",children:[e.jsx(A,{size:18,className:"text-orange-500"})," Service Request"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Hiring ",e.jsxs("span",{className:"font-bold text-orange-600 dark:text-orange-400",children:[x.firstName," ",x.lastName]})]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:e.jsx(G,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Type"}),e.jsx("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:s.serviceCategory,onChange:a=>u({...s,serviceCategory:a.target.value}),children:z.map(a=>e.jsx("option",{value:a.label,children:a.label},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Logistics"}),e.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:s.logistics,onChange:a=>u({...s,logistics:a.target.value}),children:[e.jsx("option",{value:"Drop-off",children:"I will drop it off"}),e.jsx("option",{value:"On-site",children:"Tech comes to me"}),e.jsx("option",{value:"Ship",children:"I will ship it"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Equipment"}),e.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"e.g. Fender Twin Reverb",value:s.equipmentName,onChange:a=>u({...s,equipmentName:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Issue Description"}),e.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px] text-sm",placeholder:"Describe symptoms...",value:s.issueDescription,onChange:a=>u({...s,issueDescription:a.target.value})})]}),e.jsxs("div",{className:"pt-4 border-t dark:border-gray-700",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-brand-blue hover:text-blue-600 font-bold mb-3",children:[e.jsx(O,{size:16})," Add Video/Photo ",e.jsx("input",{type:"file",className:"hidden",accept:"image/*,video/*",onChange:y,disabled:b})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:i.map((a,h)=>e.jsx("div",{className:"h-12 w-12 bg-black rounded border dark:border-gray-600 overflow-hidden",children:e.jsx("img",{src:a.url,className:"h-full w-full object-cover"})},h))})]})]}),e.jsx("div",{className:"p-5 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:e.jsx("button",{onClick:k,disabled:n||b,className:"w-full bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition shadow-lg",children:n?e.jsx($,{className:"animate-spin mx-auto"}):"Submit Request"})})]})})}function he({user:l,userData:r,openPublicProfile:x}){const[t,n]=c.useState([]),[d,s]=c.useState(!1),[u,i]=c.useState(""),[o,f]=c.useState(""),[b,y]=c.useState(null),k=async()=>{s(!0);try{const a=[P("accountTypes","array-contains","Technician"),V(20)];u&&a.push(P("searchTerms","array-contains",u.toLowerCase()));const h=D(ce(v,"public_profile"),...a);let j=(await xe(h)).docs.map(g=>({id:g.ref.parent.parent.id,...g.data()})).filter(g=>g.id!==l.uid);o&&(j=j.filter(g=>g.subRoles&&g.subRoles.includes(o))),n(j)}catch(a){console.error(a)}s(!1)};return c.useEffect(()=>{k()},[o]),e.jsxs("div",{className:"animate-in fade-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Z,{className:"absolute left-4 top-3.5 text-gray-400",size:18}),e.jsx("input",{className:"w-full pl-12 p-3 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-orange-500 dark:text-white",placeholder:"Search technicians...",value:u,onChange:a=>i(a.target.value),onKeyDown:a=>a.key==="Enter"&&k()})]}),e.jsx("div",{className:"md:w-1/3",children:e.jsxs("select",{className:"w-full p-3 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-orange-500 dark:text-white cursor-pointer",value:o,onChange:a=>f(a.target.value),children:[e.jsx("option",{value:"",children:"All Specialties"}),Q.map(a=>e.jsx("option",{value:a,children:a},a))]})})]}),d?e.jsx("div",{className:"text-center py-12",children:e.jsx($,{className:"animate-spin mx-auto text-orange-500"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(a=>{var h,p,j;return e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden shadow-sm hover:shadow-lg transition group",children:[e.jsx("div",{className:"h-24 bg-gradient-to-r from-slate-700 to-slate-600 relative",children:e.jsx("div",{className:"absolute -bottom-8 left-6",children:e.jsx("div",{className:"h-16 w-16 rounded-full border-4 border-white dark:border-[#2c2e36] bg-gray-200 overflow-hidden",children:a.photoURL?e.jsx("img",{src:a.photoURL,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:e.jsx(F,{})})})})}),e.jsxs("div",{className:"pt-10 px-6 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold dark:text-white text-lg",children:[a.firstName," ",a.lastName]}),e.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400 font-bold mb-2 flex items-center gap-1",children:[e.jsx(ee,{size:12})," ",((h=a.subRoles)==null?void 0:h[0])||"Technician"]})]}),a.rate>0&&e.jsxs("div",{className:"text-sm font-bold dark:text-gray-300 border border-gray-200 dark:border-gray-600 px-2 py-1 rounded-lg",children:["$",a.rate,"/hr"]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:(p=a.subRoles)==null?void 0:p.slice(0,3).map(g=>e.jsx("span",{className:"text-[10px] bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-200 px-2 py-0.5 rounded border border-orange-200 dark:border-orange-800",children:g},g))}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-4 h-6 overflow-hidden",children:(((j=a.skills)==null?void 0:j.split(","))||[]).slice(0,3).map((g,N)=>e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 pr-2 border-r border-gray-300 dark:border-gray-600 last:border-0",children:g.trim()},N))}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsx("button",{onClick:()=>x(a.id),className:"flex-1 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg text-xs font-bold transition",children:"Profile"}),e.jsxs("button",{onClick:()=>y(a),className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg text-xs font-bold transition shadow-sm flex items-center justify-center gap-1",children:[e.jsx(A,{size:14})," Request"]})]})]})]},a.id)})}),b&&e.jsx(pe,{user:l,userData:r,target:b,onClose:()=>y(null)})]})}function fe({user:l,userData:r,onSuccess:x,onCancel:t}){const[n,d]=c.useState(z[0].label),[s,u]=c.useState(""),[i,o]=c.useState("Normal"),[f,b]=c.useState(""),[y,k]=c.useState(""),[a,h]=c.useState(!1),[p,j]=c.useState(null),{uploadMedia:g,uploading:N}=Y(),R=async m=>{const E=m.target.files[0];if(!E)return;const B=await g(E,`service_requests/${l.uid}`);B&&j(B)},S=async()=>{if(!s||!y)return alert("Please complete the request.");h(!0);try{await U(q(v,`artifacts/${L}/public/data/service_requests`),{topic:`${n} for ${s}`,category:n,equipment:s,urgency:i,budget:f?parseInt(f):null,description:y,userId:l.uid,userName:`${r.firstName} ${r.lastName}`,status:"Open",timestamp:I(),attachment:p||null}),alert("Tech Request Broadcasted!"),x()}catch(m){console.error(m),alert("Failed.")}h(!1)};return e.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-8 rounded-2xl border border-orange-200 dark:border-gray-700 shadow-xl animate-in zoom-in-95",children:[e.jsxs("h2",{className:"text-2xl font-extrabold dark:text-white mb-6 flex items-center gap-2 text-orange-600",children:[e.jsx(ae,{})," Broadcast Tech Need"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-6 bg-orange-50 dark:bg-gray-800 rounded-xl border border-orange-100 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-lg font-medium text-gray-700 dark:text-gray-200",children:[e.jsx("span",{children:"I need"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:n,onChange:m=>d(m.target.value),className:"appearance-none bg-white dark:bg-gray-700 border border-orange-300 dark:border-orange-700 rounded-lg py-1 pl-3 pr-8 font-bold text-orange-700 dark:text-white focus:outline-none",children:z.map(m=>e.jsx("option",{value:m.label,children:m.label},m.id))}),e.jsx(se,{size:14,className:"absolute right-2 top-1/2 -translate-y-1/2 text-orange-500 dark:text-white pointer-events-none"})]}),e.jsx("span",{children:"for my"}),e.jsx("input",{className:"bg-transparent border-b-2 border-orange-300 dark:border-orange-700 text-center w-40 font-bold focus:outline-none focus:border-orange-500 dark:text-white",placeholder:"Equipment Name",value:s,onChange:m=>u(m.target.value)})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Urgency"}),e.jsxs("select",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:i,onChange:m=>o(m.target.value),children:[e.jsx("option",{children:"Normal"}),e.jsx("option",{children:"High (Session Blocked)"}),e.jsx("option",{children:"Emergency (24h)"}),e.jsx("option",{children:"Flexible"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Est. Budget ($)"}),e.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Optional",value:f,onChange:m=>b(m.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Details"}),e.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Describe the issue, specific model, symptoms...",value:y,onChange:m=>k(m.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Visual Reference"}),!p&&!N&&e.jsxs("label",{className:"flex items-center justify-center gap-2 w-full p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition text-gray-500",children:[e.jsx(O,{size:20}),e.jsx("span",{className:"text-sm font-bold",children:"Upload Video or Image"}),e.jsx("input",{type:"file",className:"hidden",accept:"video/*,image/*",onChange:R})]}),p&&e.jsxs("div",{className:"relative w-full rounded-xl overflow-hidden border dark:border-gray-700 bg-black",children:[p.type==="video"?e.jsx("video",{src:p.url,controls:!0,className:"w-full h-48 object-contain"}):e.jsx("img",{src:p.url,className:"w-full h-48 object-contain"}),e.jsx("button",{onClick:()=>j(null),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:e.jsx(G,{size:14})})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:t,className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition",children:"Cancel"}),e.jsx("button",{onClick:S,disabled:a||N,className:"flex-1 bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition flex items-center justify-center gap-2 disabled:opacity-50",children:a?e.jsx($,{className:"animate-spin"}):"Broadcast Now"})]})]})]})}function ye({user:l,isTech:r}){const[x,t]=c.useState("feed"),[n,d]=c.useState([]),[s,u]=c.useState(!0);c.useEffect(()=>{const o=D(q(v,w(l.uid).equipmentSubmissions),P("status","==","pending"),K("timestamp","desc"),V(20)),f=J(o,b=>{d(b.docs.map(y=>({id:y.id,...y.data()}))),u(!1)});return()=>f()},[l.uid]);const i=async(o,f,b)=>{var y,k,a,h,p,j;if(!r)return alert("Only verified Technicians can vote on gear accuracy.");try{const g=T(v,w(l.uid).equipmentSubmissions,o),N=`votes.${f}`;await C(g,{[N]:_(l.uid)});const R=3,S=3,m=(((k=(y=b.votes)==null?void 0:y.yes)==null?void 0:k.length)||0)+(f==="yes"?1:0),E=(((h=(a=b.votes)==null?void 0:a.fake)==null?void 0:h.length)||0)+(f==="fake"?1:0),B=(((j=(p=b.votes)==null?void 0:p.duplicate)==null?void 0:j.length)||0)+(f==="duplicate"?1:0);if(m>=R){const W=T(v,`artifacts/${L}/public/data/equipment_database/${b.category}/items`,b.model.replace(/\s+/g,"_"));await be(W,{name:b.model,brand:b.brand,category:b.category,subCategory:b.subCategory,specs:b.specs,verifiedBy:_(l.uid),addedBy:b.submittedBy,addedAt:I()}),await C(g,{status:"approved"}),await C(T(v,w(b.submittedBy).userWallet),{balance:M(50)}),await C(T(v,w(l.uid).userWallet),{balance:M(5)}),alert("Consensus reached! Item approved and rewards distributed.")}else(E>=S||B>=S)&&await C(g,{status:"rejected"})}catch(g){console.error("Voting failed:",g)}};return e.jsxs("div",{className:"animate-in fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[e.jsx(te,{className:"text-orange-500"})," Gear Knowledge Base"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Crowdsourced equipment specs verified by pros."})]}),e.jsxs("div",{className:"flex gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>t("feed"),className:`px-4 py-2 rounded-md text-xs font-bold transition ${x==="feed"?"bg-white dark:bg-gray-600 shadow text-orange-600 dark:text-orange-400":"text-gray-500"}`,children:"The Bench (Queue)"}),e.jsx("button",{onClick:()=>t("submit"),className:`px-4 py-2 rounded-md text-xs font-bold transition ${x==="submit"?"bg-white dark:bg-gray-600 shadow text-orange-600 dark:text-orange-400":"text-gray-500"}`,children:"Submit New Gear"})]})]}),x==="feed"&&e.jsx("div",{className:"grid grid-cols-1 gap-4",children:s?e.jsx("div",{className:"p-10 text-center",children:e.jsx($,{className:"animate-spin mx-auto"})}):n.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed dark:border-gray-700 rounded-xl",children:[e.jsx(re,{size:48,className:"mx-auto text-green-500 mb-2 opacity-50"}),e.jsx("p",{className:"text-gray-500",children:"The bench is clear. No pending submissions."})]}):n.map(o=>{var f,b,y,k,a,h,p,j,g,N,R,S,m;return e.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-gray-500",children:o.brand}),e.jsx("span",{className:"text-[10px] font-bold uppercase bg-blue-50 dark:bg-blue-900/20 text-blue-600 px-2 py-0.5 rounded",children:(f=o.category)==null?void 0:f.replace(/_/g," ")})]}),e.jsx("h4",{className:"text-lg font-extrabold dark:text-white mb-2",children:o.model}),e.jsx("div",{className:"bg-gray-50 dark:bg-black/20 p-3 rounded-lg text-sm text-gray-600 dark:text-gray-300 mb-2 border dark:border-gray-700",children:o.specs}),e.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(F,{size:12})," Submitted by ",o.submitterName||"Unknown"," â€¢ 50 TK Reward Pending"]})]}),e.jsxs("div",{className:"w-full md:w-48 flex flex-col justify-center gap-2 border-l dark:border-gray-700 pl-0 md:pl-6",children:[e.jsxs("button",{onClick:()=>i(o.id,"yes",o),disabled:(y=(b=o.votes)==null?void 0:b.yes)==null?void 0:y.includes(l.uid),className:"w-full py-2 bg-green-100 dark:bg-green-900/20 hover:bg-green-200 text-green-700 dark:text-green-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[e.jsx(le,{size:14})," Yes (",((a=(k=o.votes)==null?void 0:k.yes)==null?void 0:a.length)||0,")"]}),e.jsxs("button",{onClick:()=>i(o.id,"fake",o),disabled:(p=(h=o.votes)==null?void 0:h.fake)==null?void 0:p.includes(l.uid),className:"w-full py-2 bg-red-100 dark:bg-red-900/20 hover:bg-red-200 text-red-700 dark:text-red-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[e.jsx(de,{size:14})," Fake (",((g=(j=o.votes)==null?void 0:j.fake)==null?void 0:g.length)||0,")"]}),e.jsxs("button",{onClick:()=>i(o.id,"duplicate",o),disabled:(R=(N=o.votes)==null?void 0:N.duplicate)==null?void 0:R.includes(l.uid),className:"w-full py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 text-gray-600 dark:text-gray-300 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[e.jsx(ie,{size:14})," Dup (",((m=(S=o.votes)==null?void 0:S.duplicate)==null?void 0:m.length)||0,")"]})]})]},o.id)})}),x==="submit"&&e.jsx(je,{user:l,userData,onSuccess:()=>t("feed")})]})}function je({user:l,userData:r,onSuccess:x}){const[t,n]=c.useState({brand:"",model:"",category:H[0].id,subCategory:"",specs:""}),[d,s]=c.useState(!1),u=async()=>{if(!t.brand||!t.model||!t.specs)return alert("All fields required.");s(!0);try{await U(q(v,w(l.uid).equipmentSubmissions),{...t,submittedBy:l.uid,submitterName:`${r.firstName} ${r.lastName}`,status:"pending",timestamp:I(),votes:{yes:[],fake:[],duplicate:[]}}),alert("Submission Received! You'll earn 50 TK once verified."),x()}catch(i){console.error(i),alert("Submission failed.")}s(!1)};return e.jsxs("div",{className:"max-w-xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border border-orange-200 dark:border-gray-700 shadow-lg",children:[e.jsx("h4",{className:"font-bold text-lg dark:text-white mb-4",children:"Submit New Equipment"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Category"}),e.jsx("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:t.category,onChange:i=>n({...t,category:i.target.value}),children:H.map(i=>e.jsx("option",{value:i.id,children:i.label},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Sub-Category"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. Compressor",value:t.subCategory,onChange:i=>n({...t,subCategory:i.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Brand"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. Neve",value:t.brand,onChange:i=>n({...t,brand:i.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Model"}),e.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. 1073LB",value:t.model,onChange:i=>n({...t,model:i.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Specs / Description"}),e.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm h-24",placeholder:"Brief technical specs...",value:t.specs,onChange:i=>n({...t,specs:i.target.value})})]}),e.jsx("button",{onClick:u,disabled:d,className:"w-full bg-orange-600 text-white py-2.5 rounded-lg font-bold hover:bg-orange-700 flex items-center justify-center gap-2",children:d?e.jsx($,{className:"animate-spin"}):"Submit for Verification"})]})]})}function ve({user:l}){const[r,x]=c.useState({skills:"",rate:"",serviceRadius:"",subRoles:[]}),[t,n]=c.useState(!0);c.useEffect(()=>{ge(T(v,w(l.uid).userSubProfile("Technician"))).then(s=>{s.exists()&&x(s.data()),n(!1)})},[l.uid]);const d=async()=>{try{await C(T(v,w(l.uid).userSubProfile("Technician")),r);const s=[...r.skills?r.skills.toLowerCase().split(",").map(u=>u.trim()):[],...r.subRoles?r.subRoles.map(u=>u.toLowerCase()):[]];await C(T(v,w(l.uid).userPublicProfile),{rate:parseInt(r.rate)||0,subRoles:r.subRoles||[],searchTerms:s}),alert("Tech Profile Updated Successfully")}catch{alert("Update failed")}};return t?e.jsx("div",{className:"p-10 text-center",children:e.jsx($,{className:"animate-spin mx-auto"})}):e.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm animate-in fade-in",children:[e.jsx("h3",{className:"font-bold text-lg dark:text-white mb-6 border-b dark:border-gray-700 pb-2",children:"Your Technician Settings"}),e.jsxs("div",{className:"space-y-5",children:[e.jsx(ue,{label:"Primary Specialties",fieldKey:"subRoles",options:Q,initialValues:r.subRoles,onChange:(s,u)=>x(i=>({...i,[s]:u}))}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Detailed Skills (Comma Separated)"}),e.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:r.skills||"",onChange:s=>x({...r,skills:s.target.value}),placeholder:"e.g. SSL 4000 Maintenance, Tube Bias..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Hourly Rate ($)"}),e.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:r.rate||"",onChange:s=>x({...r,rate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Radius (Miles)"}),e.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:r.serviceRadius||"",onChange:s=>x({...r,serviceRadius:s.target.value})})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:d,className:"w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 flex items-center justify-center gap-2",children:[e.jsx(oe,{size:18})," Save Changes"]})})]})]})}function $e({user:l,userData:r,openPublicProfile:x}){var s;const[t,n]=c.useState("board"),d=(s=r==null?void 0:r.accountTypes)==null?void 0:s.includes("Technician");return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 pb-20",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-900 to-slate-900 p-8 rounded-2xl text-white shadow-xl relative overflow-hidden flex flex-col md:flex-row justify-between items-end",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-400 font-bold uppercase tracking-widest text-xs mb-2",children:[e.jsx(A,{size:14})," SeshNx Technical"]}),e.jsx("h1",{className:"text-3xl font-extrabold mb-2",children:"Studio Tech Services"}),e.jsx("p",{className:"text-slate-300 max-w-lg",children:"Hire professionals for equipment repair, studio wiring, and acoustic calibration."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 relative z-10 mt-4 md:mt-0",children:[e.jsx("button",{onClick:()=>n("board"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${t==="board"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Job Board"}),e.jsx("button",{onClick:()=>n("directory"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${t==="directory"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Find a Tech"}),e.jsx("button",{onClick:()=>n("broadcast"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${t==="broadcast"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Post Request"}),e.jsx("button",{onClick:()=>n("database"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${t==="database"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Gear DB"}),d&&e.jsx("button",{onClick:()=>n("profile"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${t==="profile"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Tech Portal"})]}),e.jsx(ne,{size:200,className:"absolute -right-10 -top-10 text-white opacity-5 rotate-12 pointer-events-none"})]}),e.jsxs("div",{className:"min-h-[400px]",children:[t==="board"&&e.jsx(me,{user:l}),t==="directory"&&e.jsx(he,{user:l,userData:r,openPublicProfile:x}),t==="broadcast"&&e.jsx(fe,{user:l,userData:r,onSuccess:()=>n("board"),onCancel:()=>n("board")}),t==="database"&&e.jsx(ye,{user:l,isTech:d}),t==="profile"&&d&&e.jsx(ve,{user:l})]})]})}export{$e as default};
