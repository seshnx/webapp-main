{"version":3,"file":"BusinessCenter-BxNatvAi.js","sources":["../../src/components/studio/StudioOverview.jsx","../../src/components/studio/FloorplanEditor.jsx","../../src/components/studio/StudioRooms.jsx","../../src/components/studio/StudioGallery.jsx","../../src/components/studio/StudioAvailability.jsx","../../src/components/studio/StudioPolicies.jsx","../../src/components/studio/StudioBookings.jsx","../../src/components/studio/StudioEquipment.jsx","../../src/components/studio/StudioSettings.jsx","../../src/components/StudioManager.jsx","../../src/components/LabelManager.jsx","../../src/components/distribution/ReleaseBuilder.jsx","../../src/components/marketplace/DistributionManager.jsx","../../src/components/BusinessCenter.jsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { \r\n    Home, MapPin, DollarSign, Users, Calendar, \r\n    AlertCircle, CheckCircle, Star, ChevronLeft, ChevronRight\r\n} from 'lucide-react';\r\n\r\n/**\r\n * StudioOverview - Dashboard view for studio stats and quick actions\r\n */\r\nexport default function StudioOverview({ userData, stats, onNavigate }) {\r\n    const [currentDate, setCurrentDate] = useState(new Date());\r\n    const studioName = userData?.studioName || userData?.profileName || 'My Studio';\r\n    const rooms = userData?.rooms || [];\r\n    const amenities = userData?.amenities || [];\r\n    \r\n    // Calculate stats\r\n    const totalCapacity = rooms.reduce((sum, r) => sum + (r.capacity || 0), 0);\r\n    const avgRate = rooms.length > 0 \r\n        ? Math.round(rooms.reduce((sum, r) => sum + (r.rate || 0), 0) / rooms.length) \r\n        : 0;\r\n\r\n    const quickStats = [\r\n        { \r\n            label: 'Active Rooms', \r\n            value: rooms.length, \r\n            icon: <Home size={20} />, \r\n            color: 'blue',\r\n            onClick: () => onNavigate('rooms')\r\n        },\r\n        { \r\n            label: 'Total Capacity', \r\n            value: `${totalCapacity} ppl`, \r\n            icon: <Users size={20} />, \r\n            color: 'green' \r\n        },\r\n        { \r\n            label: 'Avg. Rate', \r\n            value: `$${avgRate}/hr`, \r\n            icon: <DollarSign size={20} />, \r\n            color: 'purple' \r\n        },\r\n        { \r\n            label: 'Amenities', \r\n            value: amenities.length, \r\n            icon: <Star size={20} />, \r\n            color: 'amber' \r\n        },\r\n    ];\r\n\r\n    const pendingBookings = stats?.pendingBookings || 0;\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in\">\r\n            {/* Studio Header */}\r\n            <div className=\"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-8 text-white relative overflow-hidden\">\r\n                <div className=\"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10\"></div>\r\n                <div className=\"relative z-10\">\r\n                    <div className=\"flex items-center gap-3 mb-2\">\r\n                        <div className=\"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm\">\r\n                            <Home size={24} />\r\n                        </div>\r\n                        <div>\r\n                            <h1 className=\"text-2xl font-bold\">{studioName}</h1>\r\n                            <p className=\"text-blue-100 text-sm flex items-center gap-1\">\r\n                                <MapPin size={14} />\r\n                                {userData?.city && userData?.state \r\n                                    ? `${userData.city}, ${userData.state}` \r\n                                    : 'Location not set'}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                    {userData?.studioDescription && (\r\n                        <p className=\"text-blue-100 text-sm mt-4 max-w-2xl line-clamp-2\">\r\n                            {userData.studioDescription}\r\n                        </p>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Quick Stats */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                {quickStats.map((stat, i) => (\r\n                    <button\r\n                        key={i}\r\n                        onClick={stat.onClick}\r\n                        className={`bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm text-left transition-all ${stat.onClick ? 'hover:shadow-md hover:border-brand-blue cursor-pointer' : ''}`}\r\n                    >\r\n                        <div className={`w-10 h-10 rounded-lg bg-${stat.color}-100 dark:bg-${stat.color}-900/20 flex items-center justify-center text-${stat.color}-600 dark:text-${stat.color}-400 mb-3`}>\r\n                            {stat.icon}\r\n                        </div>\r\n                        <div className=\"text-2xl font-bold dark:text-white\">{stat.value}</div>\r\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400 uppercase font-medium tracking-wide\">\r\n                            {stat.label}\r\n                        </div>\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Alerts & Actions */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                {/* Pending Actions */}\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                    <div className=\"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]\">\r\n                        <h3 className=\"font-bold dark:text-white flex items-center gap-2\">\r\n                            <AlertCircle size={18} className=\"text-amber-500\" />\r\n                            Pending Actions\r\n                        </h3>\r\n                    </div>\r\n                    <div className=\"p-4 space-y-3\">\r\n                        {pendingBookings > 0 ? (\r\n                            <button \r\n                                onClick={() => onNavigate('bookings')}\r\n                                className=\"w-full flex items-center justify-between p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800 hover:bg-amber-100 dark:hover:bg-amber-900/30 transition\"\r\n                            >\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <Calendar className=\"text-amber-600\" size={18} />\r\n                                    <span className=\"text-sm font-medium dark:text-amber-300\">\r\n                                        {pendingBookings} Pending Booking{pendingBookings > 1 ? 's' : ''}\r\n                                    </span>\r\n                                </div>\r\n                                <span className=\"text-xs text-amber-600 font-bold\">Review →</span>\r\n                            </button>\r\n                        ) : (\r\n                            <div className=\"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\r\n                                <CheckCircle className=\"text-green-600\" size={18} />\r\n                                <span className=\"text-sm text-green-700 dark:text-green-300\">All caught up!</span>\r\n                            </div>\r\n                        )}\r\n\r\n                        {!userData?.studioDescription && (\r\n                            <button \r\n                                onClick={() => onNavigate('settings')}\r\n                                className=\"w-full flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition\"\r\n                            >\r\n                                <span className=\"text-sm font-medium text-blue-700 dark:text-blue-300\">Add studio description</span>\r\n                                <span className=\"text-xs text-blue-600 font-bold\">Setup →</span>\r\n                            </button>\r\n                        )}\r\n\r\n                        {rooms.length === 0 && (\r\n                            <button \r\n                                onClick={() => onNavigate('rooms')}\r\n                                className=\"w-full flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800 hover:bg-purple-100 dark:hover:bg-purple-900/30 transition\"\r\n                            >\r\n                                <span className=\"text-sm font-medium text-purple-700 dark:text-purple-300\">Add your first room</span>\r\n                                <span className=\"text-xs text-purple-600 font-bold\">Add →</span>\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Room Summary */}\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                    <div className=\"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] flex justify-between items-center\">\r\n                        <h3 className=\"font-bold dark:text-white flex items-center gap-2\">\r\n                            <Home size={18} className=\"text-brand-blue\" />\r\n                            Rooms\r\n                        </h3>\r\n                        <button \r\n                            onClick={() => onNavigate('rooms')}\r\n                            className=\"text-xs text-brand-blue font-bold hover:underline\"\r\n                        >\r\n                            Manage →\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"p-4\">\r\n                        {rooms.length === 0 ? (\r\n                            <div className=\"text-center py-6 text-gray-500\">\r\n                                <Home size={32} className=\"mx-auto mb-2 opacity-30\" />\r\n                                <p className=\"text-sm\">No rooms configured yet</p>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-2\">\r\n                                {rooms.slice(0, 4).map((room, i) => (\r\n                                    <div \r\n                                        key={i}\r\n                                        className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-[#1f2128] rounded-lg\"\r\n                                    >\r\n                                        <div>\r\n                                            <div className=\"font-medium dark:text-white text-sm\">{room.name}</div>\r\n                                            <div className=\"text-xs text-gray-500\">\r\n                                                {room.capacity} people • {room.equipment ? room.equipment.split(',').length : 0} gear items\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"text-right\">\r\n                                            <div className=\"font-bold text-green-600 dark:text-green-400\">${room.rate}/hr</div>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                                {rooms.length > 4 && (\r\n                                    <p className=\"text-xs text-center text-gray-400 pt-2\">\r\n                                        +{rooms.length - 4} more rooms\r\n                                    </p>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Amenities Preview */}\r\n            {amenities.length > 0 && (\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-5\">\r\n                    <h3 className=\"font-bold dark:text-white mb-3 flex items-center gap-2\">\r\n                        <Star size={18} className=\"text-amber-500\" />\r\n                        Studio Amenities\r\n                    </h3>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                        {amenities.map((amenity, i) => (\r\n                            <span \r\n                                key={i}\r\n                                className=\"px-3 py-1.5 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-lg text-sm font-medium\"\r\n                            >\r\n                                {amenity}\r\n                            </span>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Calendar Preview */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                <div className=\"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] flex justify-between items-center\">\r\n                    <h3 className=\"font-bold dark:text-white flex items-center gap-2\">\r\n                        <Calendar size={18} className=\"text-brand-blue\" />\r\n                        Booking Calendar\r\n                    </h3>\r\n                    <button \r\n                        onClick={() => onNavigate('bookings')}\r\n                        className=\"text-xs text-brand-blue font-bold hover:underline\"\r\n                    >\r\n                        View All →\r\n                    </button>\r\n                </div>\r\n                <div className=\"p-4\">\r\n                    {/* Month Navigation */}\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                        <button \r\n                            onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1))}\r\n                            className=\"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition\"\r\n                        >\r\n                            <ChevronLeft size={18} className=\"text-gray-500\" />\r\n                        </button>\r\n                        <span className=\"font-bold dark:text-white\">\r\n                            {currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\r\n                        </span>\r\n                        <button \r\n                            onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1))}\r\n                            className=\"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition\"\r\n                        >\r\n                            <ChevronRight size={18} className=\"text-gray-500\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Calendar Grid */}\r\n                    <MiniCalendar \r\n                        currentDate={currentDate} \r\n                        bookings={stats?.recentBookings || []} \r\n                        onNavigate={onNavigate}\r\n                    />\r\n\r\n                    {/* Upcoming Bookings */}\r\n                    {stats?.recentBookings?.length > 0 && (\r\n                        <div className=\"mt-4 pt-4 border-t dark:border-gray-700\">\r\n                            <div className=\"text-xs font-bold text-gray-500 uppercase mb-2\">Upcoming Sessions</div>\r\n                            <div className=\"space-y-2\">\r\n                                {stats.recentBookings.slice(0, 3).map((booking, i) => (\r\n                                    <div \r\n                                        key={i}\r\n                                        className=\"flex items-center justify-between p-2 bg-gray-50 dark:bg-[#1f2128] rounded-lg text-sm\"\r\n                                    >\r\n                                        <div>\r\n                                            <span className=\"font-medium dark:text-white\">{booking.clientName || 'Client'}</span>\r\n                                            <span className=\"text-gray-500 ml-2\">\r\n                                                {new Date(booking.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\r\n                                            </span>\r\n                                        </div>\r\n                                        <span className={`text-xs px-2 py-0.5 rounded-full ${\r\n                                            booking.status === 'confirmed' \r\n                                                ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400' \r\n                                                : 'bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400'\r\n                                        }`}>\r\n                                            {booking.status || 'pending'}\r\n                                        </span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n// Mini Calendar Component\r\nfunction MiniCalendar({ currentDate, bookings, onNavigate }) {\r\n    const year = currentDate.getFullYear();\r\n    const month = currentDate.getMonth();\r\n    const today = new Date();\r\n    \r\n    // Get first day of month and number of days\r\n    const firstDay = new Date(year, month, 1).getDay();\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate();\r\n    \r\n    // Create calendar days array\r\n    const days = [];\r\n    for (let i = 0; i < firstDay; i++) {\r\n        days.push(null);\r\n    }\r\n    for (let i = 1; i <= daysInMonth; i++) {\r\n        days.push(i);\r\n    }\r\n    \r\n    // Check if a day has bookings\r\n    const getDayBookings = (day) => {\r\n        if (!day) return [];\r\n        const dayDate = new Date(year, month, day);\r\n        return bookings.filter(b => {\r\n            const bookingDate = new Date(b.date);\r\n            return bookingDate.getDate() === day && \r\n                   bookingDate.getMonth() === month && \r\n                   bookingDate.getFullYear() === year;\r\n        });\r\n    };\r\n    \r\n    const isToday = (day) => {\r\n        return day === today.getDate() && \r\n               month === today.getMonth() && \r\n               year === today.getFullYear();\r\n    };\r\n    \r\n    const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\r\n    \r\n    return (\r\n        <div>\r\n            {/* Day Headers */}\r\n            <div className=\"grid grid-cols-7 gap-1 mb-2\">\r\n                {dayNames.map(day => (\r\n                    <div key={day} className=\"text-center text-xs font-bold text-gray-400 py-1\">\r\n                        {day}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n            \r\n            {/* Calendar Days */}\r\n            <div className=\"grid grid-cols-7 gap-1\">\r\n                {days.map((day, i) => {\r\n                    const dayBookings = getDayBookings(day);\r\n                    const hasBookings = dayBookings.length > 0;\r\n                    const hasConfirmed = dayBookings.some(b => b.status === 'confirmed');\r\n                    const hasPending = dayBookings.some(b => b.status === 'pending');\r\n                    \r\n                    return (\r\n                        <button\r\n                            key={i}\r\n                            onClick={() => day && hasBookings && onNavigate('bookings')}\r\n                            disabled={!day}\r\n                            className={`aspect-square flex flex-col items-center justify-center rounded-lg text-sm relative transition ${\r\n                                !day ? '' :\r\n                                isToday(day) ? 'bg-brand-blue text-white font-bold' :\r\n                                hasBookings ? 'bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 cursor-pointer' :\r\n                                'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\r\n                            }`}\r\n                        >\r\n                            {day}\r\n                            {hasBookings && !isToday(day) && (\r\n                                <div className=\"flex gap-0.5 mt-0.5\">\r\n                                    {hasConfirmed && <span className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></span>}\r\n                                    {hasPending && <span className=\"w-1.5 h-1.5 bg-amber-500 rounded-full\"></span>}\r\n                                </div>\r\n                            )}\r\n                        </button>\r\n                    );\r\n                })}\r\n            </div>\r\n            \r\n            {/* Legend */}\r\n            <div className=\"flex items-center gap-4 mt-3 text-xs text-gray-500\">\r\n                <div className=\"flex items-center gap-1\">\r\n                    <span className=\"w-2 h-2 bg-green-500 rounded-full\"></span>\r\n                    Confirmed\r\n                </div>\r\n                <div className=\"flex items-center gap-1\">\r\n                    <span className=\"w-2 h-2 bg-amber-500 rounded-full\"></span>\r\n                    Pending\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import React, { useState, useRef, useCallback, useEffect } from 'react';\r\nimport { Edit, Move, Trash2, Plus, CornerUpLeft, CornerDownRight, Zap, BoxSelect, GripHorizontal, Copy, Clipboard, Scissors } from 'lucide-react';\r\n\r\nconst SNAP_GRID = 10; // Snap movement to 10px grid\r\n\r\n// --- GEOMETRY HELPERS ---\r\n\r\n// Calculate distance from point (px,py) to line segment (x1,y1)-(x2,y2)\r\nconst getDistanceToLineSegment = (px, py, x1, y1, x2, y2) => {\r\n    const A = px - x1;\r\n    const B = py - y1;\r\n    const C = x2 - x1;\r\n    const D = y2 - y1;\r\n  \r\n    const dot = A * C + B * D;\r\n    const len_sq = C * C + D * D;\r\n    let param = -1;\r\n    \r\n    if (len_sq !== 0) param = dot / len_sq;\r\n  \r\n    let xx, yy;\r\n  \r\n    if (param < 0) {\r\n      xx = x1;\r\n      yy = y1;\r\n    } else if (param > 1) {\r\n      xx = x2;\r\n      yy = y2;\r\n    } else {\r\n      xx = x1 + param * C;\r\n      yy = y1 + param * D;\r\n    }\r\n  \r\n    const dx = px - xx;\r\n    const dy = py - yy;\r\n    return Math.sqrt(dx * dx + dy * dy);\r\n};\r\n\r\n/**\r\n * FloorplanEditor component for editing studio room layout via interactive SVG.\r\n */\r\nexport default function FloorplanEditor({ rooms, walls: propWalls, structures: propStructures, onRoomClick, onLayoutChange, onWallsChange, onStructuresChange }) {\r\n    const svgRef = useRef(null);\r\n    \r\n    // --- INTERACTION STATE ---\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [isResizing, setIsResizing] = useState(false); // 'br' for bottom-right, etc.\r\n    const [cursorOffset, setCursorOffset] = useState({ x: 0, y: 0 });\r\n\r\n    // Selection State\r\n    const [activeRoomId, setActiveRoomId] = useState(null);\r\n    const [activeStructureId, setActiveStructureId] = useState(null);\r\n    const [activeWallId, setActiveWallId] = useState(null); // Added for wall selection\r\n    const [draggingWallHandle, setDraggingWallHandle] = useState(null); // { id: wallId, point: 'start'|'end' }\r\n    \r\n    // --- DATA STATE (Synced with Props) ---\r\n    // We use local state for immediate UI feedback during drag, but sync with props on idle\r\n    const [walls, setWalls] = useState(propWalls || []); \r\n    const [structures, setStructures] = useState(propStructures || []); \r\n    const [clipboard, setClipboard] = useState(null); \r\n    \r\n    // --- TOOLS STATE ---\r\n    const [activeTool, setActiveTool] = useState('select'); // 'select', 'wall', 'structure'\r\n    const [wallStartPoint, setWallStartPoint] = useState(null);\r\n\r\n    const width = 800; // Fixed canvas width\r\n    const height = 600; // Fixed canvas height\r\n\r\n    // Sync props to state when they change externally (e.g. initial load)\r\n    useEffect(() => { setWalls(propWalls || []); }, [propWalls]);\r\n    useEffect(() => { setStructures(propStructures || []); }, [propStructures]);\r\n\r\n    // Utility function to get position relative to the SVG container\r\n    const getCoords = (e) => {\r\n        const rect = svgRef.current.getBoundingClientRect();\r\n        let clientX = e.clientX;\r\n        let clientY = e.clientY;\r\n\r\n        // Handle touch events\r\n        if (e.touches && e.touches.length > 0) {\r\n            clientX = e.touches[0].clientX;\r\n            clientY = e.touches[0].clientY;\r\n        }\r\n\r\n        const x = clientX - rect.left;\r\n        const y = clientY - rect.top;\r\n        \r\n        // Snap to grid\r\n        return {\r\n            x: Math.round(x / SNAP_GRID) * SNAP_GRID,\r\n            y: Math.round(y / SNAP_GRID) * SNAP_GRID\r\n        };\r\n    };\r\n\r\n    // --- PERSISTENCE HELPERS ---\r\n    const commitWalls = (newWalls) => {\r\n        setWalls(newWalls);\r\n        onWallsChange(newWalls);\r\n    };\r\n\r\n    const commitStructures = (newStructures) => {\r\n        setStructures(newStructures);\r\n        onStructuresChange(newStructures);\r\n    };\r\n\r\n    // --- CLIPBOARD & EDITING ACTIONS ---\r\n\r\n    const handleDelete = useCallback(() => {\r\n        if (activeStructureId) {\r\n            const newStructs = structures.filter(s => s.id !== activeStructureId);\r\n            commitStructures(newStructs);\r\n            setActiveStructureId(null);\r\n        } else if (activeWallId) {\r\n            const newWalls = walls.filter(w => w.id !== activeWallId);\r\n            commitWalls(newWalls);\r\n            setActiveWallId(null);\r\n        }\r\n    }, [activeStructureId, activeWallId, structures, walls]);\r\n\r\n    const handleCopy = useCallback(() => {\r\n        if (activeStructureId) {\r\n            const item = structures.find(s => s.id === activeStructureId);\r\n            if (item) setClipboard({ type: 'structure', data: item });\r\n        } else if (activeWallId) {\r\n            const item = walls.find(w => w.id === activeWallId);\r\n            if (item) setClipboard({ type: 'wall', data: item });\r\n        }\r\n    }, [activeStructureId, activeWallId, structures, walls]);\r\n\r\n    const handlePaste = useCallback(() => {\r\n        if (!clipboard) return;\r\n\r\n        const offset = 20; // Visual offset for pasted item\r\n\r\n        if (clipboard.type === 'structure') {\r\n            const newStruct = {\r\n                ...clipboard.data,\r\n                id: `struct_${Date.now()}`,\r\n                layout: {\r\n                    ...clipboard.data.layout,\r\n                    x: clipboard.data.layout.x + offset,\r\n                    y: clipboard.data.layout.y + offset\r\n                }\r\n            };\r\n            commitStructures([...structures, newStruct]);\r\n            setActiveStructureId(newStruct.id);\r\n        } else if (clipboard.type === 'wall') {\r\n            const newWall = {\r\n                ...clipboard.data,\r\n                id: `wall_${Date.now()}`,\r\n                x1: clipboard.data.x1 + offset,\r\n                y1: clipboard.data.y1 + offset,\r\n                x2: clipboard.data.x2 + offset,\r\n                y2: clipboard.data.y2 + offset\r\n            };\r\n            commitWalls([...walls, newWall]);\r\n            setActiveWallId(newWall.id);\r\n        }\r\n    }, [clipboard, structures, walls]);\r\n\r\n    const handleCut = useCallback(() => {\r\n        handleCopy();\r\n        handleDelete();\r\n    }, [handleCopy, handleDelete]);\r\n\r\n    // Keyboard Shortcuts Listener\r\n    useEffect(() => {\r\n        const handleKeyDown = (e) => {\r\n            // Delete\r\n            if (e.key === 'Delete' || e.key === 'Backspace') {\r\n                handleDelete();\r\n            }\r\n            // Copy (Ctrl+C / Cmd+C)\r\n            if ((e.ctrlKey || e.metaKey) && e.key === 'c') {\r\n                e.preventDefault(); // Prevent browser copy\r\n                handleCopy();\r\n            }\r\n            // Paste (Ctrl+V / Cmd+V)\r\n            if ((e.ctrlKey || e.metaKey) && e.key === 'v') {\r\n                e.preventDefault();\r\n                handlePaste();\r\n            }\r\n            // Cut (Ctrl+X / Cmd+X)\r\n            if ((e.ctrlKey || e.metaKey) && e.key === 'x') {\r\n                e.preventDefault();\r\n                handleCut();\r\n            }\r\n        };\r\n\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [handleDelete, handleCopy, handlePaste, handleCut]);\r\n\r\n\r\n    // --- ROOM HANDLERS ---\r\n    \r\n    const startDragRoom = useCallback((e, room) => {\r\n        if (activeTool !== 'select') return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        \r\n        const { x, y } = getCoords(e);\r\n        \r\n        setActiveRoomId(room.id);\r\n        setActiveStructureId(null);\r\n        setActiveWallId(null);\r\n        setIsDragging(true);\r\n        setIsResizing(false);\r\n        setCursorOffset({\r\n            x: x - room.layout.x,\r\n            y: y - room.layout.y,\r\n        });\r\n    }, [activeTool]);\r\n\r\n    const startResizeRoom = useCallback((e, room, direction) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        \r\n        setActiveRoomId(room.id);\r\n        setActiveStructureId(null);\r\n        setActiveWallId(null);\r\n        setIsDragging(false);\r\n        setIsResizing(direction);\r\n    }, []);\r\n\r\n    // --- STRUCTURE HANDLERS (Visual Only Rooms) ---\r\n\r\n    const addStructure = () => {\r\n        const newStruct = {\r\n            id: `struct_${Date.now()}`,\r\n            label: 'Lobby / Area',\r\n            layout: { x: 100, y: 100, width: 150, height: 100, color: '#94a3b8' } // Slate 400\r\n        };\r\n        commitStructures([...structures, newStruct]);\r\n        setActiveTool('select'); // Reset tool\r\n    };\r\n\r\n    const startDragStructure = useCallback((e, struct) => {\r\n        if (activeTool !== 'select') return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        \r\n        const { x, y } = getCoords(e);\r\n        \r\n        setActiveStructureId(struct.id);\r\n        setActiveRoomId(null); // Deselect rooms\r\n        setActiveWallId(null);\r\n        setIsDragging(true);\r\n        setIsResizing(false);\r\n        setCursorOffset({\r\n            x: x - struct.layout.x,\r\n            y: y - struct.layout.y,\r\n        });\r\n    }, [activeTool]);\r\n\r\n    const startResizeStructure = useCallback((e, struct, direction) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        \r\n        setActiveStructureId(struct.id);\r\n        setActiveRoomId(null);\r\n        setActiveWallId(null);\r\n        setIsDragging(false);\r\n        setIsResizing(direction);\r\n    }, []);\r\n\r\n    // --- WALL HANDLERS ---\r\n\r\n    const startDragWallHandle = useCallback((e, wallId, point) => {\r\n        if (activeTool !== 'select') return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setDraggingWallHandle({ id: wallId, point });\r\n        setActiveRoomId(null);\r\n        setActiveStructureId(null);\r\n        setActiveWallId(wallId);\r\n    }, [activeTool]);\r\n\r\n    const selectWall = (e, wallId) => {\r\n        if (activeTool !== 'select') return;\r\n        e.stopPropagation();\r\n        setActiveWallId(wallId);\r\n        setActiveRoomId(null);\r\n        setActiveStructureId(null);\r\n    };\r\n\r\n    // --- GLOBAL MOVE HANDLER ---\r\n\r\n    const handleMouseMove = useCallback((e) => {\r\n        if (!svgRef.current) return;\r\n        const { x, y } = getCoords(e); // Snapped coords\r\n        \r\n        // 1. WALL DRAWING PREVIEW\r\n        if (activeTool === 'wall' && wallStartPoint) {\r\n            const previewWall = { \r\n                id: 'preview', \r\n                x1: wallStartPoint.x, y1: wallStartPoint.y, \r\n                x2: x, y2: y \r\n            };\r\n            // Just local state for preview, don't commit\r\n            setWalls(prev => [...prev.filter(w => w.id !== 'preview'), previewWall]);\r\n            return;\r\n        }\r\n\r\n        // 2. WALL EDITING (Moving Endpoints)\r\n        if (draggingWallHandle) {\r\n            // Update local state while dragging for smoothness\r\n            setWalls(prev => prev.map(w => {\r\n                if (w.id !== draggingWallHandle.id) return w;\r\n                return draggingWallHandle.point === 'start' \r\n                    ? { ...w, x1: x, y1: y } \r\n                    : { ...w, x2: x, y2: y };\r\n            }));\r\n            return;\r\n        }\r\n\r\n        // 3. DRAGGING (Room or Structure)\r\n        if (isDragging) {\r\n            const newPos = { x: x - cursorOffset.x, y: y - cursorOffset.y };\r\n            \r\n            if (activeRoomId) {\r\n                const room = rooms.find(r => r.id === activeRoomId);\r\n                if (room) onLayoutChange(activeRoomId, { ...room.layout, ...newPos });\r\n            } else if (activeStructureId) {\r\n                // Update local state for smooth drag\r\n                setStructures(prev => prev.map(s => s.id === activeStructureId ? { ...s, layout: { ...s.layout, ...newPos } } : s));\r\n            }\r\n        }\r\n        \r\n        // 4. RESIZING (Room or Structure)\r\n        if (isResizing === 'br') {\r\n            if (activeRoomId) {\r\n                const room = rooms.find(r => r.id === activeRoomId);\r\n                if (room) {\r\n                    const newDims = {\r\n                        width: Math.max(SNAP_GRID, x - room.layout.x),\r\n                        height: Math.max(SNAP_GRID, y - room.layout.y)\r\n                    };\r\n                    onLayoutChange(activeRoomId, { ...room.layout, ...newDims });\r\n                }\r\n            } else if (activeStructureId) {\r\n                setStructures(prev => prev.map(s => {\r\n                    if (s.id !== activeStructureId) return s;\r\n                    return {\r\n                        ...s,\r\n                        layout: {\r\n                            ...s.layout,\r\n                            width: Math.max(SNAP_GRID, x - s.layout.x),\r\n                            height: Math.max(SNAP_GRID, y - s.layout.y)\r\n                        }\r\n                    };\r\n                }));\r\n            }\r\n        }\r\n        \r\n    }, [activeRoomId, activeStructureId, isDragging, isResizing, draggingWallHandle, cursorOffset, rooms, onLayoutChange, activeTool, wallStartPoint]);\r\n\r\n    const stopInteraction = useCallback(() => {\r\n        // Commit changes on mouse up\r\n        if (isDragging || isResizing) {\r\n            if (activeStructureId) {\r\n                // We need to commit the current state of structures back to parent\r\n                // Since handleMouseMove updated local state, 'structures' is current\r\n                onStructuresChange(structures); \r\n            }\r\n        }\r\n        if (draggingWallHandle) {\r\n            // Commit wall changes\r\n            onWallsChange(walls);\r\n        }\r\n\r\n        setIsDragging(false);\r\n        setIsResizing(false);\r\n        setDraggingWallHandle(null);\r\n        // Note: We don't clear selection here to keep the UI \"active\"\r\n    }, [isDragging, isResizing, draggingWallHandle, activeStructureId, structures, walls, onStructuresChange, onWallsChange]);\r\n    \r\n    // --- WALL DRAWING CLICK ---\r\n    const handleCanvasClick = useCallback((e) => {\r\n        if (activeTool !== 'wall') {\r\n            // Deselect if clicking empty space\r\n            if(!isDragging && !isResizing) {\r\n                setActiveRoomId(null);\r\n                setActiveStructureId(null);\r\n                setActiveWallId(null);\r\n            }\r\n            return;\r\n        }\r\n\r\n        e.stopPropagation();\r\n        const { x, y } = getCoords(e);\r\n\r\n        if (!wallStartPoint) {\r\n            setWallStartPoint({ x, y });\r\n        } else {\r\n            const newWall = {\r\n                id: `wall_${Date.now()}`,\r\n                x1: wallStartPoint.x, y1: wallStartPoint.y,\r\n                x2: x, y2: y,\r\n                stroke: '#52525B', strokeWidth: 5\r\n            };\r\n            \r\n            // Clean preview and add new wall, then COMMIT\r\n            const updatedWalls = [...walls.filter(w => w.id !== 'preview'), newWall];\r\n            commitWalls(updatedWalls);\r\n            \r\n            setWallStartPoint(null);\r\n            // Don't reset tool, allow chaining walls\r\n        }\r\n    }, [activeTool, wallStartPoint, isDragging, isResizing, walls]);\r\n\r\n    // --- TOOLBAR HANDLERS ---\r\n    const setTool = (tool) => {\r\n        setActiveTool(tool);\r\n        setWallStartPoint(null);\r\n        if (tool === 'structure') addStructure();\r\n        else setWalls(prev => prev.filter(w => w.id !== 'preview')); // Clean preview\r\n    };\r\n    \r\n    // Attach global listeners\r\n    useEffect(() => {\r\n        document.addEventListener('mousemove', handleMouseMove);\r\n        document.addEventListener('mouseup', stopInteraction);\r\n        document.addEventListener('touchmove', handleMouseMove);\r\n        document.addEventListener('touchend', stopInteraction);\r\n        \r\n        return () => {\r\n            document.removeEventListener('mousemove', handleMouseMove);\r\n            document.removeEventListener('mouseup', stopInteraction);\r\n            document.removeEventListener('touchmove', handleMouseMove);\r\n            document.removeEventListener('touchend', stopInteraction);\r\n        };\r\n    }, [handleMouseMove, stopInteraction]);\r\n\r\n    // --- RENDER SUB-COMPONENTS ---\r\n    \r\n    const WallSegment = ({ wall }) => {\r\n        const isPreview = wall.id === 'preview';\r\n        const isSelected = activeWallId === wall.id;\r\n        return (\r\n            <g onClick={(e) => selectWall(e, wall.id)} cursor=\"pointer\">\r\n                {/* Invisible hit area for easier selection */}\r\n                <line\r\n                    x1={wall.x1} y1={wall.y1} x2={wall.x2} y2={wall.y2}\r\n                    stroke=\"transparent\"\r\n                    strokeWidth=\"15\"\r\n                />\r\n                <line\r\n                    x1={wall.x1} y1={wall.y1} x2={wall.x2} y2={wall.y2}\r\n                    stroke={isPreview ? '#ef4444' : (isSelected ? '#3D84ED' : wall.stroke)}\r\n                    strokeWidth={wall.strokeWidth}\r\n                    strokeLinecap=\"round\"\r\n                    opacity={isPreview ? 0.7 : 1}\r\n                />\r\n                {!isPreview && (\r\n                    <>\r\n                        {/* Start Handle */}\r\n                        <circle \r\n                            cx={wall.x1} cy={wall.y1} r={6} \r\n                            fill=\"white\" stroke=\"#52525B\" strokeWidth=\"2\" \r\n                            className=\"cursor-move hover:fill-brand-blue\"\r\n                            onMouseDown={(e) => startDragWallHandle(e, wall.id, 'start')}\r\n                        />\r\n                        {/* End Handle */}\r\n                        <circle \r\n                            cx={wall.x2} cy={wall.y2} r={6} \r\n                            fill=\"white\" stroke=\"#52525B\" strokeWidth=\"2\" \r\n                            className=\"cursor-move hover:fill-brand-blue\"\r\n                            onMouseDown={(e) => startDragWallHandle(e, wall.id, 'end')}\r\n                        />\r\n                    </>\r\n                )}\r\n            </g>\r\n        );\r\n    };\r\n\r\n    // Generic Shape Renderer (Used for Rooms and Structures)\r\n    const LayoutShape = ({ data, isStructure = false, onClick }) => {\r\n        const { layout, name, rate, label } = data;\r\n        const isActive = isStructure ? activeStructureId === data.id : activeRoomId === data.id;\r\n        \r\n        // Determine rounding based on wall locking\r\n        const checkCornerLocked = (cx, cy) => {\r\n            const THRESHOLD = 12; \r\n            return walls.some(w => getDistanceToLineSegment(cx, cy, w.x1, w.y1, w.x2, w.y2) < THRESHOLD);\r\n        };\r\n\r\n        const tlSharp = checkCornerLocked(layout.x, layout.y);\r\n        const trSharp = checkCornerLocked(layout.x + layout.width, layout.y);\r\n        const brSharp = checkCornerLocked(layout.x + layout.width, layout.y + layout.height);\r\n        const blSharp = checkCornerLocked(layout.x, layout.y + layout.height);\r\n\r\n        const r = 8; \r\n        const pathD = [\r\n            `M ${layout.x + (tlSharp?0:r)} ${layout.y}`,\r\n            `L ${layout.x + layout.width - (trSharp?0:r)} ${layout.y}`,\r\n            `Q ${layout.x + layout.width} ${layout.y} ${layout.x + layout.width} ${layout.y + (trSharp?0:r)}`,\r\n            `L ${layout.x + layout.width} ${layout.y + layout.height - (brSharp?0:r)}`,\r\n            `Q ${layout.x + layout.width} ${layout.y + layout.height} ${layout.x + layout.width - (brSharp?0:r)} ${layout.y + layout.height}`,\r\n            `L ${layout.x + (blSharp?0:r)} ${layout.y + layout.height}`,\r\n            `Q ${layout.x} ${layout.y + layout.height} ${layout.x} ${layout.y + layout.height - (blSharp?0:r)}`,\r\n            `L ${layout.x} ${layout.y + (tlSharp?0:r)}`,\r\n            `Q ${layout.x} ${layout.y} ${layout.x + (tlSharp?0:r)} ${layout.y}`,\r\n            `Z`\r\n        ].join(' ');\r\n\r\n        return (\r\n            <g \r\n                onClick={(e) => { e.stopPropagation(); onClick(data); }} \r\n                cursor=\"pointer\" \r\n                style={{ filter: isActive ? `drop-shadow(0 0 5px ${layout.color})` : 'none' }}\r\n                pointerEvents={activeTool !== 'select' ? 'none' : 'auto'}\r\n            >\r\n                <path \r\n                    d={pathD}\r\n                    fill={layout.color} \r\n                    opacity={isStructure ? \"0.5\" : \"0.8\"} \r\n                    stroke={layout.color}\r\n                    strokeWidth=\"4\"\r\n                    strokeDasharray={isStructure ? \"5,5\" : \"0\"}\r\n                    onMouseDown={(e) => isStructure ? startDragStructure(e, data) : startDragRoom(e, data)}\r\n                    onTouchStart={(e) => isStructure ? startDragStructure(e, data) : startDragRoom(e, data)}\r\n                    style={{ cursor: isResizing ? 'default' : 'grab' }}\r\n                />\r\n                \r\n                <text \r\n                    x={layout.x + layout.width / 2}\r\n                    y={layout.y + layout.height / 2}\r\n                    fill=\"white\"\r\n                    textAnchor=\"middle\"\r\n                    dominantBaseline=\"middle\"\r\n                    style={{ pointerEvents: 'none', userSelect: 'none' }}\r\n                >\r\n                    <tspan x={layout.x + layout.width / 2} dy=\"-0.5em\" fontWeight=\"bold\" fontSize=\"14\">\r\n                        {isStructure ? (label || 'Area') : name}\r\n                    </tspan>\r\n                    {!isStructure && rate && (\r\n                        <tspan x={layout.x + layout.width / 2} dy=\"1.2em\" fontSize=\"12\">\r\n                            ${rate}/hr\r\n                        </tspan>\r\n                    )}\r\n                </text>\r\n                \r\n                {/* Resize Handle */}\r\n                {isActive && (\r\n                    <rect\r\n                        x={layout.x + layout.width - 10} y={layout.y + layout.height - 10} \r\n                        width=\"20\" height=\"20\" fill=\"white\" stroke=\"black\" strokeWidth=\"2\" rx=\"4\" cursor=\"nwse-resize\"\r\n                        onMouseDown={(e) => isStructure ? startResizeStructure(e, data, 'br') : startResizeRoom(e, data, 'br')}\r\n                        onTouchStart={(e) => isStructure ? startResizeStructure(e, data, 'br') : startResizeRoom(e, data, 'br')}\r\n                    />\r\n                )}\r\n            </g>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-[650px]\">\r\n            {/* Control Bar */}\r\n            <div className='p-3 border-b dark:border-gray-700 flex justify-between items-center bg-white dark:bg-[#2c2e36] rounded-t-xl'>\r\n                <div className='flex gap-4 text-sm text-gray-500 font-medium'>\r\n                    <button onClick={handleCopy} disabled={!activeStructureId && !activeWallId} className='hover:text-brand-blue disabled:opacity-50 flex items-center gap-1'><Copy size={14}/> Copy</button>\r\n                    <button onClick={handlePaste} disabled={!clipboard} className='hover:text-brand-blue disabled:opacity-50 flex items-center gap-1'><Clipboard size={14}/> Paste</button>\r\n                    <button onClick={handleCut} disabled={!activeStructureId && !activeWallId} className='hover:text-brand-blue disabled:opacity-50 flex items-center gap-1'><Scissors size={14}/> Cut</button>\r\n                    <button onClick={handleDelete} disabled={!activeStructureId && !activeWallId} className='hover:text-red-500 disabled:opacity-50 flex items-center gap-1'><Trash2 size={14}/> Delete</button>\r\n                </div>\r\n                \r\n                <div className=\"flex gap-2\">\r\n                    <button \r\n                        className={`px-3 py-1.5 rounded-lg text-sm font-bold flex items-center gap-2 transition ${activeTool === 'structure' ? 'bg-purple-500 text-white' : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200'}`}\r\n                        onClick={() => setTool('structure')}\r\n                    >\r\n                        <BoxSelect size={16}/> Add Lobby / Area\r\n                    </button>\r\n                    \r\n                    <button \r\n                        className={`px-3 py-1.5 rounded-lg text-sm font-bold flex items-center gap-2 transition ${activeTool === 'wall' ? 'bg-red-500 text-white shadow-lg' : 'bg-brand-blue text-white hover:bg-blue-600'}`}\r\n                        onClick={() => setTool(activeTool === 'wall' ? 'select' : 'wall')}\r\n                    >\r\n                        <Zap size={16}/> {activeTool === 'wall' ? (wallStartPoint ? 'Finish Wall' : 'Drawing Mode') : 'Add Wall'}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            \r\n            {/* SVG Canvas */}\r\n            <div \r\n                className=\"flex-1 overflow-auto bg-gray-50 dark:bg-[#1f2128] rounded-b-xl border-x border-b dark:border-gray-700 relative\"\r\n                style={{ cursor: activeTool === 'wall' ? 'crosshair' : 'default' }}\r\n                tabIndex={0} // Make div focusable for keyboard events\r\n                onKeyDown={(e) => {\r\n                    // Re-implement here if window listener isn't preferred, \r\n                    // but window listener in useEffect is usually better for hotkeys\r\n                }}\r\n            >\r\n                <svg \r\n                    ref={svgRef}\r\n                    width={width} height={height} \r\n                    className=\"w-full h-full shadow-inner focus:outline-none\"\r\n                    viewBox={`0 0 ${width} ${height}`}\r\n                    // Events\r\n                    onMouseMove={handleMouseMove}\r\n                    onMouseUp={stopInteraction}\r\n                    onTouchMove={handleMouseMove}\r\n                    onTouchEnd={stopInteraction}\r\n                    onClick={handleCanvasClick}\r\n                >\r\n                    {/* Grid */}\r\n                    <pattern id=\"smallGrid\" width={SNAP_GRID} height={SNAP_GRID} patternUnits=\"userSpaceOnUse\">\r\n                        <path d={`M ${SNAP_GRID} 0 L 0 0 0 ${SNAP_GRID}`} fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"0.5\"/>\r\n                    </pattern>\r\n                    <rect width=\"100%\" height=\"100%\" fill=\"url(#smallGrid)\" />\r\n                    \r\n                    {/* Layer 1: Structures (Lobbies) */}\r\n                    {structures.map((struct) => (\r\n                        <LayoutShape key={struct.id} data={struct} isStructure={true} onClick={() => setActiveStructureId(struct.id)} />\r\n                    ))}\r\n\r\n                    {/* Layer 2: Functional Rooms */}\r\n                    {rooms.map((room) => (\r\n                        <LayoutShape key={room.id} data={room} onClick={(r) => onRoomClick(rooms.findIndex(rm => rm.id === r.id))} />\r\n                    ))}\r\n                    \r\n                    {/* Layer 3: Walls */}\r\n                    {walls.map((wall) => (\r\n                        <WallSegment key={wall.id} wall={wall} />\r\n                    ))}\r\n\r\n                    <text x=\"10\" y=\"20\" fontSize=\"10\" fill=\"#9CA3AF\">Grid: {SNAP_GRID}px | {walls.length} Walls</text>\r\n                </svg>\r\n                \r\n                {/* Context Info Overlay */}\r\n                {activeStructureId && (\r\n                    <div className=\"absolute bottom-4 right-4 bg-white dark:bg-dark-card p-2 rounded shadow border dark:border-gray-600 text-xs flex gap-2\">\r\n                        <input \r\n                            className=\"bg-transparent border-b border-gray-300 focus:border-blue-500 outline-none dark:text-white\"\r\n                            value={structures.find(s => s.id === activeStructureId)?.label}\r\n                            onChange={(e) => {\r\n                                const newLabel = e.target.value;\r\n                                setStructures(prev => {\r\n                                    const updated = prev.map(s => s.id === activeStructureId ? { ...s, label: newLabel } : s);\r\n                                    return updated;\r\n                                });\r\n                            }}\r\n                            onBlur={() => commitStructures(structures)} // Commit on blur\r\n                        />\r\n                        <button onClick={handleDelete} className=\"text-red-500 hover:bg-red-50 rounded p-1\"><Trash2 size={14}/></button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useState } from 'react';\r\nimport { \r\n    Plus, Edit2, Trash2, Users, DollarSign, Mic, \r\n    LayoutGrid, Save, Loader2, ChevronDown, ChevronUp,\r\n    Copy, Map, List\r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport toast from 'react-hot-toast';\r\nimport EquipmentAutocomplete from '../shared/EquipmentAutocomplete';\r\nimport FloorplanEditor from './FloorplanEditor';\r\n\r\n/**\r\n * StudioRooms - Complete room management interface\r\n */\r\nexport default function StudioRooms({ user, userData, onUpdate }) {\r\n    const [rooms, setRooms] = useState(userData?.rooms || []);\r\n    const [walls, setWalls] = useState(userData?.floorplanWalls || []);\r\n    const [structures, setStructures] = useState(userData?.floorplanStructures || []);\r\n    const [editingRoom, setEditingRoom] = useState(null);\r\n    const [isAdding, setIsAdding] = useState(false);\r\n    const [saving, setSaving] = useState(false);\r\n    const [expandedRoom, setExpandedRoom] = useState(null);\r\n    const [viewMode, setViewMode] = useState('list'); // 'list' or 'floorplan'\r\n\r\n    const emptyRoom = {\r\n        name: '',\r\n        description: '',\r\n        rate: 50,\r\n        capacity: 4,\r\n        equipment: '',\r\n        amenities: [],\r\n        minBookingHours: 1,\r\n        active: true,\r\n        color: '#3B82F6'\r\n    };\r\n\r\n    const handleSave = async (updatedRooms, updatedWalls = walls, updatedStructures = structures) => {\r\n        if (!supabase) return;\r\n        setSaving(true);\r\n        const toastId = toast.loading('Saving rooms...');\r\n        const userId = user?.id || user?.uid;\r\n        \r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ \r\n                    rooms: updatedRooms,\r\n                    floorplan_walls: updatedWalls,\r\n                    floorplan_structures: updatedStructures,\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', userId);\r\n            \r\n            setRooms(updatedRooms);\r\n            setWalls(updatedWalls);\r\n            setStructures(updatedStructures);\r\n            toast.success('Rooms saved!', { id: toastId });\r\n            if (onUpdate) onUpdate({ rooms: updatedRooms, floorplanWalls: updatedWalls, floorplanStructures: updatedStructures });\r\n        } catch (error) {\r\n            console.error('Save failed:', error);\r\n            toast.error('Failed to save', { id: toastId });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    // Floorplan handlers\r\n    const handleLayoutChange = (roomId, newLayout) => {\r\n        const updatedRooms = rooms.map(r => \r\n            r.id === roomId ? { ...r, layout: newLayout } : r\r\n        );\r\n        setRooms(updatedRooms);\r\n    };\r\n\r\n    const handleWallsChange = async (newWalls) => {\r\n        if (!supabase) return;\r\n        setWalls(newWalls);\r\n        const userId = user?.id || user?.uid;\r\n        // Auto-save walls\r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ floorplan_walls: newWalls, updated_at: new Date().toISOString() })\r\n                .eq('id', userId);\r\n        } catch (error) {\r\n            console.error('Error saving walls:', error);\r\n        }\r\n    };\r\n\r\n    const handleStructuresChange = async (newStructures) => {\r\n        if (!supabase) return;\r\n        setStructures(newStructures);\r\n        const userId = user?.id || user?.uid;\r\n        // Auto-save structures\r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ floorplan_structures: newStructures, updated_at: new Date().toISOString() })\r\n                .eq('id', userId);\r\n        } catch (error) {\r\n            console.error('Error saving structures:', error);\r\n        }\r\n    };\r\n\r\n    const handleRoomClick = (roomIndex) => {\r\n        if (roomIndex >= 0 && roomIndex < rooms.length) {\r\n            handleEditRoom(roomIndex);\r\n        }\r\n    };\r\n\r\n    const handleAddRoom = () => {\r\n        setEditingRoom({ ...emptyRoom, name: `Room ${rooms.length + 1}` });\r\n        setIsAdding(true);\r\n    };\r\n\r\n    const handleEditRoom = (index) => {\r\n        setEditingRoom({ ...rooms[index] });\r\n        setIsAdding(false);\r\n        setExpandedRoom(index);\r\n    };\r\n\r\n    const handleSaveRoom = async () => {\r\n        if (!editingRoom.name.trim()) {\r\n            toast.error('Room name is required');\r\n            return;\r\n        }\r\n\r\n        let updatedRooms;\r\n        if (isAdding) {\r\n            updatedRooms = [...rooms, editingRoom];\r\n        } else {\r\n            updatedRooms = rooms.map((r, i) => i === expandedRoom ? editingRoom : r);\r\n        }\r\n\r\n        await handleSave(updatedRooms);\r\n        setEditingRoom(null);\r\n        setIsAdding(false);\r\n        setExpandedRoom(null);\r\n    };\r\n\r\n    const handleDeleteRoom = async (index) => {\r\n        if (!confirm(`Delete \"${rooms[index].name}\"? This cannot be undone.`)) return;\r\n        \r\n        const updatedRooms = rooms.filter((_, i) => i !== index);\r\n        await handleSave(updatedRooms);\r\n    };\r\n\r\n    const handleDuplicateRoom = async (index) => {\r\n        const roomToCopy = { ...rooms[index], name: `${rooms[index].name} (Copy)` };\r\n        const updatedRooms = [...rooms, roomToCopy];\r\n        await handleSave(updatedRooms);\r\n    };\r\n\r\n    const handleCancelEdit = () => {\r\n        setEditingRoom(null);\r\n        setIsAdding(false);\r\n        setExpandedRoom(null);\r\n    };\r\n\r\n    const ROOM_AMENITIES = [\r\n        'Isolation Booth', 'Live Room', 'Control Room', 'Lounge Area',\r\n        'Private Bathroom', 'Natural Light', 'Blackout Curtains', \r\n        'Video Feed', 'Climate Control', 'Sound Lock'\r\n    ];\r\n\r\n    // Prepare rooms with layout for floorplan\r\n    const roomsWithLayout = rooms.map((room, index) => ({\r\n        ...room,\r\n        id: room.id || `room_${index}`,\r\n        layout: room.layout || {\r\n            x: 50 + (index % 3) * 200,\r\n            y: 50 + Math.floor(index / 3) * 150,\r\n            width: 180,\r\n            height: 120,\r\n            color: room.color || '#3B82F6'\r\n        }\r\n    }));\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <LayoutGrid className=\"text-brand-blue\" size={24} />\r\n                        Room Management\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Configure your studio rooms, rates, and equipment\r\n                    </p>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                    {/* View Toggle */}\r\n                    <div className=\"flex bg-gray-100 dark:bg-gray-800 rounded-lg p-1\">\r\n                        <button\r\n                            onClick={() => setViewMode('list')}\r\n                            className={`px-3 py-1.5 rounded-md text-sm font-medium transition flex items-center gap-1.5 ${\r\n                                viewMode === 'list' \r\n                                    ? 'bg-white dark:bg-gray-700 shadow text-brand-blue' \r\n                                    : 'text-gray-600 dark:text-gray-400'\r\n                            }`}\r\n                        >\r\n                            <List size={16} /> List\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setViewMode('floorplan')}\r\n                            className={`px-3 py-1.5 rounded-md text-sm font-medium transition flex items-center gap-1.5 ${\r\n                                viewMode === 'floorplan' \r\n                                    ? 'bg-white dark:bg-gray-700 shadow text-brand-blue' \r\n                                    : 'text-gray-600 dark:text-gray-400'\r\n                            }`}\r\n                        >\r\n                            <Map size={16} /> Floorplan\r\n                        </button>\r\n                    </div>\r\n                    <button\r\n                        onClick={handleAddRoom}\r\n                        disabled={isAdding || editingRoom}\r\n                        className=\"bg-brand-blue text-white px-4 py-2.5 rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 disabled:opacity-50\"\r\n                    >\r\n                        <Plus size={18} /> Add Room\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Add New Room Form */}\r\n            {isAdding && editingRoom && (\r\n                <RoomEditor\r\n                    room={editingRoom}\r\n                    setRoom={setEditingRoom}\r\n                    onSave={handleSaveRoom}\r\n                    onCancel={handleCancelEdit}\r\n                    saving={saving}\r\n                    isNew={true}\r\n                    roomAmenities={ROOM_AMENITIES}\r\n                />\r\n            )}\r\n\r\n            {/* Floorplan View */}\r\n            {viewMode === 'floorplan' && !isAdding && (\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                    <FloorplanEditor\r\n                        rooms={roomsWithLayout}\r\n                        walls={walls}\r\n                        structures={structures}\r\n                        onRoomClick={handleRoomClick}\r\n                        onLayoutChange={handleLayoutChange}\r\n                        onWallsChange={handleWallsChange}\r\n                        onStructuresChange={handleStructuresChange}\r\n                    />\r\n                    <div className=\"p-3 bg-gray-50 dark:bg-[#23262f] border-t dark:border-gray-700 text-xs text-gray-500\">\r\n                        <strong>Tips:</strong> Click a room to edit • Drag to reposition • Use corner handles to resize • Add walls to define boundaries\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Room List */}\r\n            {viewMode === 'list' && (\r\n            <div className=\"space-y-4\">\r\n                {rooms.length === 0 && !isAdding ? (\r\n                    <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border-2 border-dashed dark:border-gray-700 p-12 text-center\">\r\n                        <LayoutGrid size={48} className=\"mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\r\n                        <h3 className=\"text-lg font-bold dark:text-white mb-2\">No Rooms Yet</h3>\r\n                        <p className=\"text-gray-500 dark:text-gray-400 mb-4 max-w-sm mx-auto\">\r\n                            Add your first room to start accepting bookings\r\n                        </p>\r\n                        <button\r\n                            onClick={handleAddRoom}\r\n                            className=\"bg-brand-blue text-white px-6 py-2.5 rounded-xl font-bold hover:bg-blue-600 transition\"\r\n                        >\r\n                            Add Your First Room\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    rooms.map((room, index) => (\r\n                        <div key={index} className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden shadow-sm\">\r\n                            {/* Room Header */}\r\n                            <div \r\n                                className=\"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-[#23262f] transition\"\r\n                                onClick={() => setExpandedRoom(expandedRoom === index ? null : index)}\r\n                            >\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div \r\n                                        className=\"w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold text-lg\"\r\n                                        style={{ backgroundColor: room.color || '#3B82F6' }}\r\n                                    >\r\n                                        {room.name.charAt(0)}\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <h3 className=\"font-bold dark:text-white\">{room.name}</h3>\r\n                                            {room.active === false && (\r\n                                                <span className=\"text-xs bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 px-2 py-0.5 rounded\">\r\n                                                    Inactive\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                                            <span className=\"flex items-center gap-1\">\r\n                                                <DollarSign size={14} />\r\n                                                ${room.rate}/hr\r\n                                            </span>\r\n                                            <span className=\"flex items-center gap-1\">\r\n                                                <Users size={14} />\r\n                                                {room.capacity} people\r\n                                            </span>\r\n                                            {room.equipment && (\r\n                                                <span className=\"flex items-center gap-1\">\r\n                                                    <Mic size={14} />\r\n                                                    {room.equipment.split(',').length} items\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <button\r\n                                        onClick={(e) => { e.stopPropagation(); handleDuplicateRoom(index); }}\r\n                                        className=\"p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition\"\r\n                                        title=\"Duplicate\"\r\n                                    >\r\n                                        <Copy size={16} />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={(e) => { e.stopPropagation(); handleEditRoom(index); }}\r\n                                        className=\"p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition\"\r\n                                        title=\"Edit\"\r\n                                    >\r\n                                        <Edit2 size={16} />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={(e) => { e.stopPropagation(); handleDeleteRoom(index); }}\r\n                                        className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition\"\r\n                                        title=\"Delete\"\r\n                                    >\r\n                                        <Trash2 size={16} />\r\n                                    </button>\r\n                                    {expandedRoom === index ? <ChevronUp size={20} /> : <ChevronDown size={20} />}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Expanded Edit Form */}\r\n                            {expandedRoom === index && editingRoom && (\r\n                                <div className=\"border-t dark:border-gray-700\">\r\n                                    <RoomEditor\r\n                                        room={editingRoom}\r\n                                        setRoom={setEditingRoom}\r\n                                        onSave={handleSaveRoom}\r\n                                        onCancel={handleCancelEdit}\r\n                                        saving={saving}\r\n                                        isNew={false}\r\n                                        roomAmenities={ROOM_AMENITIES}\r\n                                    />\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Collapsed Preview */}\r\n                            {expandedRoom === index && !editingRoom && (\r\n                                <div className=\"p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#1f2128]\">\r\n                                    {room.description && (\r\n                                        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-3\">{room.description}</p>\r\n                                    )}\r\n                                    {room.equipment && (\r\n                                        <div className=\"flex flex-wrap gap-2\">\r\n                                            {room.equipment.split(',').map((item, i) => (\r\n                                                <span key={i} className=\"text-xs bg-white dark:bg-gray-800 border dark:border-gray-700 px-2 py-1 rounded\">\r\n                                                    {item.trim()}\r\n                                                </span>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/**\r\n * RoomEditor - Form for editing room details\r\n */\r\nfunction RoomEditor({ room, setRoom, onSave, onCancel, saving, isNew, roomAmenities }) {\r\n    const handleAmenityToggle = (amenity) => {\r\n        const current = room.amenities || [];\r\n        if (current.includes(amenity)) {\r\n            setRoom({ ...room, amenities: current.filter(a => a !== amenity) });\r\n        } else {\r\n            setRoom({ ...room, amenities: [...current, amenity] });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 bg-gray-50 dark:bg-[#1f2128] space-y-5\">\r\n            {isNew && (\r\n                <h3 className=\"font-bold dark:text-white text-lg mb-4\">Add New Room</h3>\r\n            )}\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div>\r\n                    <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Room Name *</label>\r\n                    <input\r\n                        className=\"w-full p-3 border rounded-xl dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none\"\r\n                        value={room.name}\r\n                        onChange={e => setRoom({ ...room, name: e.target.value })}\r\n                        placeholder=\"e.g. Studio A\"\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Room Color</label>\r\n                    <div className=\"flex gap-2\">\r\n                        <input\r\n                            type=\"color\"\r\n                            className=\"w-12 h-12 rounded-lg border dark:border-gray-600 cursor-pointer\"\r\n                            value={room.color || '#3B82F6'}\r\n                            onChange={e => setRoom({ ...room, color: e.target.value })}\r\n                        />\r\n                        <input\r\n                            className=\"flex-1 p-3 border rounded-xl dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white\"\r\n                            value={room.color || '#3B82F6'}\r\n                            onChange={e => setRoom({ ...room, color: e.target.value })}\r\n                            placeholder=\"#3B82F6\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Description</label>\r\n                <textarea\r\n                    className=\"w-full p-3 border rounded-xl dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none\"\r\n                    rows={2}\r\n                    value={room.description || ''}\r\n                    onChange={e => setRoom({ ...room, description: e.target.value })}\r\n                    placeholder=\"Describe this room, its vibe, and what makes it special...\"\r\n                />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                <div>\r\n                    <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Hourly Rate ($)</label>\r\n                    <input\r\n                        type=\"number\"\r\n                        className=\"w-full p-3 border rounded-xl dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none\"\r\n                        value={room.rate}\r\n                        onChange={e => setRoom({ ...room, rate: parseInt(e.target.value) || 0 })}\r\n                        min={0}\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Capacity</label>\r\n                    <input\r\n                        type=\"number\"\r\n                        className=\"w-full p-3 border rounded-xl dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none\"\r\n                        value={room.capacity}\r\n                        onChange={e => setRoom({ ...room, capacity: parseInt(e.target.value) || 1 })}\r\n                        min={1}\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Min Hours</label>\r\n                    <input\r\n                        type=\"number\"\r\n                        className=\"w-full p-3 border rounded-xl dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none\"\r\n                        value={room.minBookingHours || 1}\r\n                        onChange={e => setRoom({ ...room, minBookingHours: parseInt(e.target.value) || 1 })}\r\n                        min={1}\r\n                    />\r\n                </div>\r\n                <div className=\"flex items-end\">\r\n                    <label className=\"flex items-center gap-2 p-3 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl cursor-pointer w-full\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            className=\"w-4 h-4 text-brand-blue\"\r\n                            checked={room.active !== false}\r\n                            onChange={e => setRoom({ ...room, active: e.target.checked })}\r\n                        />\r\n                        <span className=\"text-sm font-medium dark:text-white\">Active</span>\r\n                    </label>\r\n                </div>\r\n            </div>\r\n\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Equipment</label>\r\n                <EquipmentAutocomplete\r\n                    value={room.equipment || ''}\r\n                    onChange={val => setRoom({ ...room, equipment: val })}\r\n                    placeholder=\"Search and add equipment...\"\r\n                    multi={true}\r\n                />\r\n            </div>\r\n\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-2 block\">Room Features</label>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                    {roomAmenities.map(amenity => (\r\n                        <button\r\n                            key={amenity}\r\n                            type=\"button\"\r\n                            onClick={() => handleAmenityToggle(amenity)}\r\n                            className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-all border ${\r\n                                (room.amenities || []).includes(amenity)\r\n                                    ? 'bg-brand-blue text-white border-brand-blue'\r\n                                    : 'bg-white dark:bg-[#2c2e36] text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:border-brand-blue'\r\n                            }`}\r\n                        >\r\n                            {amenity}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end gap-3 pt-4 border-t dark:border-gray-700\">\r\n                <button\r\n                    onClick={onCancel}\r\n                    className=\"px-5 py-2.5 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl font-medium transition\"\r\n                >\r\n                    Cancel\r\n                </button>\r\n                <button\r\n                    onClick={onSave}\r\n                    disabled={saving}\r\n                    className=\"px-6 py-2.5 bg-brand-blue text-white rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 disabled:opacity-50\"\r\n                >\r\n                    {saving ? <Loader2 className=\"animate-spin\" size={18} /> : <Save size={18} />}\r\n                    {isNew ? 'Add Room' : 'Save Changes'}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useState, useCallback } from 'react';\r\nimport { \r\n    Image, Upload, Trash2, Star, \r\n    Loader2, X, Plus, Eye, Move\r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport { useMediaUpload } from '../../hooks/useMediaUpload';\r\nimport toast from 'react-hot-toast';\r\n\r\n/**\r\n * StudioGallery - Photo gallery management for studio\r\n */\r\nexport default function StudioGallery({ user, userData, onUpdate }) {\r\n    const [photos, setPhotos] = useState(userData?.studioPhotos || []);\r\n    const [uploadProgress, setUploadProgress] = useState(0);\r\n    const [selectedPhoto, setSelectedPhoto] = useState(null);\r\n    const [draggingIndex, setDraggingIndex] = useState(null);\r\n    const { uploadMedia, uploading } = useMediaUpload();\r\n    const userId = user?.id || user?.uid;\r\n\r\n    const savePhotos = useCallback(async (updatedPhotos) => {\r\n        if (!supabase) return false;\r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ \r\n                    studio_photos: updatedPhotos,\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', userId);\r\n            \r\n            setPhotos(updatedPhotos);\r\n            if (onUpdate) onUpdate({ studioPhotos: updatedPhotos });\r\n            return true;\r\n        } catch (error) {\r\n            console.error('Save failed:', error);\r\n            toast.error('Failed to save photos');\r\n            return false;\r\n        }\r\n    }, [userId, onUpdate]);\r\n\r\n    const handleUpload = useCallback(async (files) => {\r\n        if (!files || files.length === 0) return;\r\n        \r\n        const maxPhotos = 12;\r\n        if (photos.length >= maxPhotos) {\r\n            toast.error(`Maximum ${maxPhotos} photos allowed`);\r\n            return;\r\n        }\r\n\r\n        const toastId = toast.loading('Uploading photos...');\r\n        \r\n        const newPhotos = [];\r\n        \r\n        for (const file of Array.from(files).slice(0, maxPhotos - photos.length)) {\r\n            // Validate file\r\n            if (!file.type.startsWith('image/')) {\r\n                toast.error(`${file.name} is not an image`);\r\n                continue;\r\n            }\r\n            if (file.size > 5 * 1024 * 1024) {\r\n                toast.error(`${file.name} is too large (max 5MB)`);\r\n                continue;\r\n            }\r\n\r\n            try {\r\n                const timestamp = Date.now();\r\n                const result = await uploadMedia(file, `studio/gallery/${userId}`);\r\n                \r\n                if (result?.url) {\r\n                    newPhotos.push({\r\n                        id: timestamp.toString(),\r\n                        url: result.url,\r\n                        path: result.storageRef || `studio/gallery/${userId}/${timestamp}_${file.name}`,\r\n                        filename: file.name,\r\n                        caption: '',\r\n                        isCover: photos.length === 0 && newPhotos.length === 0, // First photo is cover\r\n                        uploadedAt: new Date().toISOString()\r\n                    });\r\n                }\r\n            } catch (error) {\r\n                console.error('Upload error:', error);\r\n                toast.error(`Failed to upload ${file.name}`);\r\n            }\r\n        }\r\n\r\n        if (newPhotos.length > 0) {\r\n            const success = await savePhotos([...photos, ...newPhotos]);\r\n            if (success) {\r\n                toast.success(`${newPhotos.length} photo(s) uploaded!`, { id: toastId });\r\n            }\r\n        } else {\r\n            toast.dismiss(toastId);\r\n        }\r\n        \r\n        setUploadProgress(0);\r\n    }, [photos, userId, savePhotos, uploadMedia]);\r\n\r\n    const handleDelete = async (photoIndex) => {\r\n        const photo = photos[photoIndex];\r\n        if (!confirm('Delete this photo?')) return;\r\n        \r\n        const toastId = toast.loading('Deleting...');\r\n        \r\n        try {\r\n            // Note: File deletion from MinIO storage should be handled by backend API\r\n            // For now, we just remove it from the database\r\n            \r\n            // Update photos array\r\n            let updatedPhotos = photos.filter((_, i) => i !== photoIndex);\r\n            \r\n            // If we deleted the cover photo, make the first remaining photo the cover\r\n            if (photo.isCover && updatedPhotos.length > 0) {\r\n                updatedPhotos = updatedPhotos.map((p, i) => ({ ...p, isCover: i === 0 }));\r\n            }\r\n            \r\n            await savePhotos(updatedPhotos);\r\n            toast.success('Photo deleted', { id: toastId });\r\n        } catch (error) {\r\n            console.error('Delete error:', error);\r\n            toast.error('Failed to delete photo', { id: toastId });\r\n        }\r\n    };\r\n\r\n    const handleSetCover = async (photoIndex) => {\r\n        const updatedPhotos = photos.map((p, i) => ({ ...p, isCover: i === photoIndex }));\r\n        await savePhotos(updatedPhotos);\r\n        toast.success('Cover photo updated');\r\n    };\r\n\r\n    // Caption editing can be added as a future enhancement\r\n    // const handleUpdateCaption = async (photoIndex, caption) => { ... }\r\n\r\n    const handleDragStart = (index) => {\r\n        setDraggingIndex(index);\r\n    };\r\n\r\n    const handleDragOver = (e, index) => {\r\n        e.preventDefault();\r\n        if (draggingIndex === null || draggingIndex === index) return;\r\n        \r\n        const reorderedPhotos = [...photos];\r\n        const [draggedPhoto] = reorderedPhotos.splice(draggingIndex, 1);\r\n        reorderedPhotos.splice(index, 0, draggedPhoto);\r\n        \r\n        setPhotos(reorderedPhotos);\r\n        setDraggingIndex(index);\r\n    };\r\n\r\n    const handleDragEnd = async () => {\r\n        if (draggingIndex !== null) {\r\n            await savePhotos(photos);\r\n            setDraggingIndex(null);\r\n        }\r\n    };\r\n\r\n    const handleFileDrop = (e) => {\r\n        e.preventDefault();\r\n        const files = e.dataTransfer?.files;\r\n        if (files) handleUpload(files);\r\n    };\r\n\r\n    const coverPhoto = photos.find(p => p.isCover) || photos[0];\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <Image className=\"text-brand-blue\" size={24} />\r\n                        Photo Gallery\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Showcase your studio with up to 12 photos\r\n                    </p>\r\n                </div>\r\n                <span className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                    {photos.length}/12 photos\r\n                </span>\r\n            </div>\r\n\r\n            {/* Cover Photo Preview */}\r\n            {coverPhoto && (\r\n                <div className=\"relative rounded-xl overflow-hidden aspect-video bg-gray-100 dark:bg-gray-800 group\">\r\n                    <img\r\n                        src={coverPhoto.url}\r\n                        alt=\"Cover\"\r\n                        className=\"w-full h-full object-cover\"\r\n                    />\r\n                    <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                        <div className=\"absolute bottom-4 left-4 text-white\">\r\n                            <div className=\"flex items-center gap-2 text-sm font-medium\">\r\n                                <Star size={16} className=\"fill-yellow-400 text-yellow-400\" />\r\n                                Cover Photo\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Upload Area */}\r\n            <div\r\n                className={`border-2 border-dashed rounded-xl p-8 text-center transition-all ${\r\n                    uploading \r\n                        ? 'border-brand-blue bg-blue-50 dark:bg-blue-900/20' \r\n                        : 'border-gray-200 dark:border-gray-700 hover:border-brand-blue hover:bg-blue-50/50 dark:hover:bg-blue-900/10'\r\n                }`}\r\n                onDrop={handleFileDrop}\r\n                onDragOver={(e) => e.preventDefault()}\r\n            >\r\n                {uploading ? (\r\n                    <div className=\"space-y-3\">\r\n                        <Loader2 className=\"mx-auto animate-spin text-brand-blue\" size={40} />\r\n                        <div className=\"w-full max-w-xs mx-auto bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\r\n                            <div \r\n                                className=\"bg-brand-blue h-2 rounded-full transition-all duration-300\"\r\n                                style={{ width: `${uploadProgress}%` }}\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-sm text-gray-500\">Uploading... {Math.round(uploadProgress)}%</p>\r\n                    </div>\r\n                ) : (\r\n                    <>\r\n                        <Upload className=\"mx-auto text-gray-400 mb-3\" size={40} />\r\n                        <p className=\"text-gray-600 dark:text-gray-400 mb-2\">\r\n                            Drag & drop images here, or\r\n                        </p>\r\n                        <label className=\"cursor-pointer\">\r\n                            <span className=\"text-brand-blue font-bold hover:underline\">browse files</span>\r\n                            <input\r\n                                type=\"file\"\r\n                                accept=\"image/*\"\r\n                                multiple\r\n                                className=\"hidden\"\r\n                                onChange={(e) => handleUpload(e.target.files)}\r\n                                disabled={uploading}\r\n                            />\r\n                        </label>\r\n                        <p className=\"text-xs text-gray-400 mt-2\">\r\n                            JPG, PNG or WebP. Max 5MB per file.\r\n                        </p>\r\n                    </>\r\n                )}\r\n            </div>\r\n\r\n            {/* Photo Grid */}\r\n            {photos.length > 0 && (\r\n                <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n                    {photos.map((photo, index) => (\r\n                        <div\r\n                            key={photo.id}\r\n                            draggable\r\n                            onDragStart={() => handleDragStart(index)}\r\n                            onDragOver={(e) => handleDragOver(e, index)}\r\n                            onDragEnd={handleDragEnd}\r\n                            className={`relative aspect-square rounded-xl overflow-hidden group bg-gray-100 dark:bg-gray-800 cursor-move ${\r\n                                draggingIndex === index ? 'opacity-50 ring-2 ring-brand-blue' : ''\r\n                            }`}\r\n                        >\r\n                            <img\r\n                                src={photo.url}\r\n                                alt={photo.caption || `Studio photo ${index + 1}`}\r\n                                className=\"w-full h-full object-cover\"\r\n                            />\r\n                            \r\n                            {/* Cover badge */}\r\n                            {photo.isCover && (\r\n                                <div className=\"absolute top-2 left-2 bg-yellow-500 text-white text-xs font-bold px-2 py-1 rounded-lg flex items-center gap-1\">\r\n                                    <Star size={12} className=\"fill-white\" /> Cover\r\n                                </div>\r\n                            )}\r\n                            \r\n                            {/* Hover overlay */}\r\n                            <div className=\"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\r\n                                <button\r\n                                    onClick={() => setSelectedPhoto(photo)}\r\n                                    className=\"p-2 bg-white/20 hover:bg-white/30 rounded-lg text-white transition\"\r\n                                    title=\"View\"\r\n                                >\r\n                                    <Eye size={18} />\r\n                                </button>\r\n                                {!photo.isCover && (\r\n                                    <button\r\n                                        onClick={() => handleSetCover(index)}\r\n                                        className=\"p-2 bg-white/20 hover:bg-white/30 rounded-lg text-white transition\"\r\n                                        title=\"Set as cover\"\r\n                                    >\r\n                                        <Star size={18} />\r\n                                    </button>\r\n                                )}\r\n                                <button\r\n                                    onClick={() => handleDelete(index)}\r\n                                    className=\"p-2 bg-red-500/80 hover:bg-red-500 rounded-lg text-white transition\"\r\n                                    title=\"Delete\"\r\n                                >\r\n                                    <Trash2 size={18} />\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Drag handle */}\r\n                            <div className=\"absolute top-2 right-2 p-1 bg-black/40 rounded text-white opacity-0 group-hover:opacity-100 transition\">\r\n                                <Move size={14} />\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n\r\n                    {/* Add more button */}\r\n                    {photos.length < 12 && (\r\n                        <label className=\"aspect-square rounded-xl border-2 border-dashed border-gray-200 dark:border-gray-700 hover:border-brand-blue transition cursor-pointer flex flex-col items-center justify-center text-gray-400 hover:text-brand-blue\">\r\n                            <Plus size={32} />\r\n                            <span className=\"text-xs mt-1\">Add Photo</span>\r\n                            <input\r\n                                type=\"file\"\r\n                                accept=\"image/*\"\r\n                                multiple\r\n                                className=\"hidden\"\r\n                                onChange={(e) => handleUpload(e.target.files)}\r\n                                disabled={uploading}\r\n                            />\r\n                        </label>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Empty state */}\r\n            {photos.length === 0 && !uploading && (\r\n                <div className=\"text-center py-8 text-gray-400\">\r\n                    <Image size={48} className=\"mx-auto mb-3 opacity-30\" />\r\n                    <p>No photos uploaded yet</p>\r\n                    <p className=\"text-sm\">Add photos to attract more clients</p>\r\n                </div>\r\n            )}\r\n\r\n            {/* Photo Lightbox */}\r\n            {selectedPhoto && (\r\n                <div \r\n                    className=\"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4\"\r\n                    onClick={() => setSelectedPhoto(null)}\r\n                >\r\n                    <button \r\n                        className=\"absolute top-4 right-4 text-white hover:text-gray-300 transition\"\r\n                        onClick={() => setSelectedPhoto(null)}\r\n                    >\r\n                        <X size={32} />\r\n                    </button>\r\n                    <img\r\n                        src={selectedPhoto.url}\r\n                        alt={selectedPhoto.caption || 'Studio photo'}\r\n                        className=\"max-w-full max-h-[90vh] object-contain rounded-lg\"\r\n                        onClick={(e) => e.stopPropagation()}\r\n                    />\r\n                    {selectedPhoto.caption && (\r\n                        <div className=\"absolute bottom-8 left-1/2 -translate-x-1/2 bg-black/70 text-white px-6 py-3 rounded-xl\">\r\n                            {selectedPhoto.caption}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","import { useState } from 'react';\r\nimport { \r\n    Clock, Calendar, Save, Loader2, Plus, Trash2, \r\n    Moon, Sun, AlertCircle, X, Copy\r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst DAYS_OF_WEEK = [\r\n    { id: 'sunday', label: 'Sunday', short: 'Sun' },\r\n    { id: 'monday', label: 'Monday', short: 'Mon' },\r\n    { id: 'tuesday', label: 'Tuesday', short: 'Tue' },\r\n    { id: 'wednesday', label: 'Wednesday', short: 'Wed' },\r\n    { id: 'thursday', label: 'Thursday', short: 'Thu' },\r\n    { id: 'friday', label: 'Friday', short: 'Fri' },\r\n    { id: 'saturday', label: 'Saturday', short: 'Sat' },\r\n];\r\n\r\nconst DEFAULT_HOURS = {\r\n    sunday: { closed: true, open: '10:00', close: '18:00' },\r\n    monday: { closed: false, open: '09:00', close: '22:00' },\r\n    tuesday: { closed: false, open: '09:00', close: '22:00' },\r\n    wednesday: { closed: false, open: '09:00', close: '22:00' },\r\n    thursday: { closed: false, open: '09:00', close: '22:00' },\r\n    friday: { closed: false, open: '09:00', close: '23:00' },\r\n    saturday: { closed: false, open: '10:00', close: '23:00' },\r\n};\r\n\r\n/**\r\n * StudioAvailability - Operating hours and blackout dates management\r\n */\r\nexport default function StudioAvailability({ user, userData, onUpdate }) {\r\n    const [hours, setHours] = useState(userData?.operatingHours || DEFAULT_HOURS);\r\n    const [blackoutDates, setBlackoutDates] = useState(userData?.blackoutDates || []);\r\n    const [saving, setSaving] = useState(false);\r\n    const [newBlackout, setNewBlackout] = useState({ start: '', end: '', reason: '' });\r\n    const [showAddBlackout, setShowAddBlackout] = useState(false);\r\n\r\n    const handleSave = async () => {\r\n        if (!supabase) return;\r\n        setSaving(true);\r\n        const toastId = toast.loading('Saving availability...');\r\n        const userId = user?.id || user?.uid;\r\n        \r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ \r\n                    operating_hours: hours,\r\n                    blackout_dates: blackoutDates,\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', userId);\r\n            \r\n            toast.success('Availability saved!', { id: toastId });\r\n            if (onUpdate) onUpdate({ operatingHours: hours, blackoutDates });\r\n        } catch (error) {\r\n            console.error('Save failed:', error);\r\n            toast.error('Failed to save', { id: toastId });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const updateDayHours = (dayId, field, value) => {\r\n        setHours(prev => ({\r\n            ...prev,\r\n            [dayId]: { ...prev[dayId], [field]: value }\r\n        }));\r\n    };\r\n\r\n    const toggleDayClosed = (dayId) => {\r\n        setHours(prev => ({\r\n            ...prev,\r\n            [dayId]: { ...prev[dayId], closed: !prev[dayId]?.closed }\r\n        }));\r\n    };\r\n\r\n    const copyToAllWeekdays = (dayId) => {\r\n        const sourceHours = hours[dayId];\r\n        const weekdays = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];\r\n        \r\n        setHours(prev => {\r\n            const newHours = { ...prev };\r\n            weekdays.forEach(day => {\r\n                newHours[day] = { ...sourceHours };\r\n            });\r\n            return newHours;\r\n        });\r\n        toast.success('Copied to all weekdays');\r\n    };\r\n\r\n    const addBlackoutDate = () => {\r\n        if (!newBlackout.start) {\r\n            toast.error('Start date is required');\r\n            return;\r\n        }\r\n        \r\n        const blackout = {\r\n            id: Date.now().toString(),\r\n            start: newBlackout.start,\r\n            end: newBlackout.end || newBlackout.start,\r\n            reason: newBlackout.reason || 'Blocked'\r\n        };\r\n        \r\n        setBlackoutDates([...blackoutDates, blackout]);\r\n        setNewBlackout({ start: '', end: '', reason: '' });\r\n        setShowAddBlackout(false);\r\n    };\r\n\r\n    const removeBlackoutDate = (id) => {\r\n        setBlackoutDates(blackoutDates.filter(b => b.id !== id));\r\n    };\r\n\r\n    const formatTime = (time) => {\r\n        if (!time) return '';\r\n        const [h, m] = time.split(':');\r\n        const hour = parseInt(h);\r\n        const ampm = hour >= 12 ? 'PM' : 'AM';\r\n        const displayHour = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;\r\n        return `${displayHour}:${m} ${ampm}`;\r\n    };\r\n\r\n    // Calculate total weekly hours\r\n    const totalWeeklyHours = DAYS_OF_WEEK.reduce((total, day) => {\r\n        const dayHours = hours[day.id];\r\n        if (dayHours?.closed) return total;\r\n        \r\n        const [openH, openM] = (dayHours?.open || '09:00').split(':').map(Number);\r\n        const [closeH, closeM] = (dayHours?.close || '17:00').split(':').map(Number);\r\n        const openMinutes = openH * 60 + openM;\r\n        const closeMinutes = closeH * 60 + closeM;\r\n        \r\n        return total + Math.max(0, (closeMinutes - openMinutes) / 60);\r\n    }, 0);\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <Clock className=\"text-brand-blue\" size={24} />\r\n                        Availability & Hours\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Set your operating hours and manage blackout dates\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={handleSave}\r\n                    disabled={saving}\r\n                    className=\"bg-brand-blue text-white px-6 py-2.5 rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 disabled:opacity-50\"\r\n                >\r\n                    {saving ? <Loader2 className=\"animate-spin\" size={18} /> : <Save size={18} />}\r\n                    Save Changes\r\n                </button>\r\n            </div>\r\n\r\n            {/* Weekly Summary */}\r\n            <div className=\"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl p-6 text-white\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                        <h3 className=\"text-lg font-bold mb-1\">Weekly Availability</h3>\r\n                        <p className=\"text-indigo-100\">\r\n                            {DAYS_OF_WEEK.filter(d => !hours[d.id]?.closed).length} days open • {Math.round(totalWeeklyHours)} hours/week\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                        <div className=\"text-4xl font-bold\">{Math.round(totalWeeklyHours)}</div>\r\n                        <div className=\"text-sm text-indigo-100\">hours</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Operating Hours */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                <div className=\"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]\">\r\n                    <h3 className=\"font-bold dark:text-white flex items-center gap-2\">\r\n                        <Sun size={18} className=\"text-amber-500\" />\r\n                        Operating Hours\r\n                    </h3>\r\n                </div>\r\n                <div className=\"divide-y dark:divide-gray-700\">\r\n                    {DAYS_OF_WEEK.map(day => {\r\n                        const dayHours = hours[day.id] || { closed: false, open: '09:00', close: '17:00' };\r\n                        \r\n                        return (\r\n                            <div \r\n                                key={day.id}\r\n                                className={`p-4 flex items-center gap-4 ${dayHours.closed ? 'bg-gray-50 dark:bg-[#1f2128]' : ''}`}\r\n                            >\r\n                                <div className=\"w-28\">\r\n                                    <span className={`font-medium ${dayHours.closed ? 'text-gray-400' : 'dark:text-white'}`}>\r\n                                        {day.label}\r\n                                    </span>\r\n                                </div>\r\n                                \r\n                                <button\r\n                                    onClick={() => toggleDayClosed(day.id)}\r\n                                    className={`px-3 py-1.5 rounded-lg text-sm font-medium transition ${\r\n                                        dayHours.closed \r\n                                            ? 'bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400' \r\n                                            : 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400'\r\n                                    }`}\r\n                                >\r\n                                    {dayHours.closed ? 'Closed' : 'Open'}\r\n                                </button>\r\n\r\n                                {!dayHours.closed && (\r\n                                    <>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <input\r\n                                                type=\"time\"\r\n                                                value={dayHours.open || '09:00'}\r\n                                                onChange={(e) => updateDayHours(day.id, 'open', e.target.value)}\r\n                                                className=\"p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm\"\r\n                                            />\r\n                                            <span className=\"text-gray-400\">to</span>\r\n                                            <input\r\n                                                type=\"time\"\r\n                                                value={dayHours.close || '17:00'}\r\n                                                onChange={(e) => updateDayHours(day.id, 'close', e.target.value)}\r\n                                                className=\"p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm\"\r\n                                            />\r\n                                        </div>\r\n                                        \r\n                                        <span className=\"text-sm text-gray-400 hidden md:inline\">\r\n                                            {formatTime(dayHours.open)} – {formatTime(dayHours.close)}\r\n                                        </span>\r\n                                        \r\n                                        <button\r\n                                            onClick={() => copyToAllWeekdays(day.id)}\r\n                                            className=\"ml-auto p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition\"\r\n                                            title=\"Copy to all weekdays\"\r\n                                        >\r\n                                            <Copy size={16} />\r\n                                        </button>\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Blackout Dates */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                <div className=\"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] flex justify-between items-center\">\r\n                    <h3 className=\"font-bold dark:text-white flex items-center gap-2\">\r\n                        <Moon size={18} className=\"text-indigo-500\" />\r\n                        Blackout Dates\r\n                    </h3>\r\n                    <button\r\n                        onClick={() => setShowAddBlackout(!showAddBlackout)}\r\n                        className=\"text-sm bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-400 px-3 py-1.5 rounded-lg font-bold hover:bg-indigo-200 dark:hover:bg-indigo-900/50 transition flex items-center gap-1\"\r\n                    >\r\n                        <Plus size={16} /> Add Blackout\r\n                    </button>\r\n                </div>\r\n                \r\n                {/* Add Blackout Form */}\r\n                {showAddBlackout && (\r\n                    <div className=\"p-4 bg-indigo-50 dark:bg-indigo-900/20 border-b dark:border-gray-700\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Start Date *</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    value={newBlackout.start}\r\n                                    onChange={(e) => setNewBlackout({ ...newBlackout, start: e.target.value })}\r\n                                    className=\"w-full p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">End Date</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    value={newBlackout.end}\r\n                                    onChange={(e) => setNewBlackout({ ...newBlackout, end: e.target.value })}\r\n                                    className=\"w-full p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    min={newBlackout.start}\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Reason</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={newBlackout.reason}\r\n                                    onChange={(e) => setNewBlackout({ ...newBlackout, reason: e.target.value })}\r\n                                    placeholder=\"e.g. Holiday, Maintenance\"\r\n                                    className=\"w-full p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"flex items-end gap-2\">\r\n                                <button\r\n                                    onClick={addBlackoutDate}\r\n                                    className=\"flex-1 p-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition\"\r\n                                >\r\n                                    Add\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setShowAddBlackout(false)}\r\n                                    className=\"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg\"\r\n                                >\r\n                                    <X size={20} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Blackout List */}\r\n                <div className=\"p-4\">\r\n                    {blackoutDates.length === 0 ? (\r\n                        <div className=\"text-center py-8 text-gray-400\">\r\n                            <Moon size={32} className=\"mx-auto mb-2 opacity-30\" />\r\n                            <p className=\"text-sm\">No blackout dates scheduled</p>\r\n                            <p className=\"text-xs\">Add dates when your studio is unavailable</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-2\">\r\n                            {blackoutDates.sort((a, b) => new Date(a.start) - new Date(b.start)).map(blackout => (\r\n                                <div \r\n                                    key={blackout.id}\r\n                                    className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-[#1f2128] rounded-lg\"\r\n                                >\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <div className=\"w-10 h-10 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg flex items-center justify-center\">\r\n                                            <Calendar className=\"text-indigo-600 dark:text-indigo-400\" size={18} />\r\n                                        </div>\r\n                                        <div>\r\n                                            <div className=\"font-medium dark:text-white text-sm\">\r\n                                                {new Date(blackout.start).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}\r\n                                                {blackout.end !== blackout.start && (\r\n                                                    <> – {new Date(blackout.end).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</>\r\n                                                )}\r\n                                            </div>\r\n                                            <div className=\"text-xs text-gray-500\">{blackout.reason}</div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={() => removeBlackoutDate(blackout.id)}\r\n                                        className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition\"\r\n                                    >\r\n                                        <Trash2 size={16} />\r\n                                    </button>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Tips */}\r\n            <div className=\"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4\">\r\n                <div className=\"flex gap-3\">\r\n                    <AlertCircle className=\"text-amber-600 flex-shrink-0\" size={20} />\r\n                    <div className=\"text-sm\">\r\n                        <p className=\"font-bold text-amber-800 dark:text-amber-300 mb-1\">Availability Tips</p>\r\n                        <ul className=\"text-amber-700 dark:text-amber-400 space-y-1\">\r\n                            <li>• Operating hours determine when clients can book sessions</li>\r\n                            <li>• Use blackout dates for holidays, maintenance, or personal time</li>\r\n                            <li>• Individual room availability can be set in the Rooms section</li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useState } from 'react';\r\nimport { \r\n    FileText, Save, Loader2, DollarSign, Clock, AlertTriangle,\r\n    Shield, ChevronDown, ChevronUp\r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport toast from 'react-hot-toast';\r\n\r\n/**\r\n * StudioPolicies - Booking rules, pricing policies, and house rules\r\n */\r\nexport default function StudioPolicies({ user, userData, onUpdate }) {\r\n    const [policies, setPolicies] = useState({\r\n        // Booking Rules\r\n        minBookingHours: userData?.policies?.minBookingHours ?? 2,\r\n        maxBookingHours: userData?.policies?.maxBookingHours ?? 12,\r\n        advanceBookingDays: userData?.policies?.advanceBookingDays ?? 14,\r\n        minAdvanceHours: userData?.policies?.minAdvanceHours ?? 24,\r\n        autoApprove: userData?.policies?.autoApprove ?? false,\r\n        \r\n        // Cancellation Policy\r\n        cancellationPolicy: userData?.policies?.cancellationPolicy ?? 'moderate',\r\n        cancellationNoticeHours: userData?.policies?.cancellationNoticeHours ?? 48,\r\n        refundPercentage: userData?.policies?.refundPercentage ?? 50,\r\n        \r\n        // Pricing\r\n        depositRequired: userData?.policies?.depositRequired ?? true,\r\n        depositPercentage: userData?.policies?.depositPercentage ?? 25,\r\n        peakHourMultiplier: userData?.policies?.peakHourMultiplier ?? 1.0,\r\n        peakHoursStart: userData?.policies?.peakHoursStart ?? '',\r\n        peakHoursEnd: userData?.policies?.peakHoursEnd ?? '',\r\n        weekendMultiplier: userData?.policies?.weekendMultiplier ?? 1.0,\r\n        \r\n        // House Rules\r\n        houseRules: userData?.policies?.houseRules ?? '',\r\n        whatToExpect: userData?.policies?.whatToExpect ?? '',\r\n        whatToBring: userData?.policies?.whatToBring ?? '',\r\n        parkingInstructions: userData?.policies?.parkingInstructions ?? '',\r\n        \r\n        // Safety & Legal\r\n        requiresWaiver: userData?.policies?.requiresWaiver ?? false,\r\n        waiverText: userData?.policies?.waiverText ?? '',\r\n        ageRequirement: userData?.policies?.ageRequirement ?? 18,\r\n    });\r\n\r\n    const [saving, setSaving] = useState(false);\r\n    const [expandedSection, setExpandedSection] = useState('booking');\r\n\r\n    const handleSave = async () => {\r\n        if (!supabase) return;\r\n        setSaving(true);\r\n        const toastId = toast.loading('Saving policies...');\r\n        const userId = user?.id || user?.uid;\r\n        \r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ \r\n                    policies: policies,\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', userId);\r\n            \r\n            toast.success('Policies saved!', { id: toastId });\r\n            if (onUpdate) onUpdate({ policies });\r\n        } catch (error) {\r\n            console.error('Save failed:', error);\r\n            toast.error('Failed to save', { id: toastId });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const updatePolicy = (key, value) => {\r\n        setPolicies(prev => ({ ...prev, [key]: value }));\r\n    };\r\n\r\n    const CANCELLATION_POLICIES = [\r\n        { id: 'flexible', label: 'Flexible', description: 'Full refund up to 24 hours before session', color: 'green' },\r\n        { id: 'moderate', label: 'Moderate', description: '50% refund up to 48 hours before session', color: 'amber' },\r\n        { id: 'strict', label: 'Strict', description: 'No refunds within 7 days of session', color: 'red' },\r\n        { id: 'custom', label: 'Custom', description: 'Set your own cancellation terms', color: 'blue' },\r\n    ];\r\n\r\n    const Section = ({ id, title, icon: Icon, children }) => {\r\n        const isExpanded = expandedSection === id;\r\n        return (\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                <button\r\n                    onClick={() => setExpandedSection(isExpanded ? null : id)}\r\n                    className=\"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-[#23262f] transition\"\r\n                >\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 bg-brand-blue/10 rounded-lg flex items-center justify-center\">\r\n                            <Icon className=\"text-brand-blue\" size={20} />\r\n                        </div>\r\n                        <h3 className=\"font-bold dark:text-white\">{title}</h3>\r\n                    </div>\r\n                    {isExpanded ? <ChevronUp size={20} /> : <ChevronDown size={20} />}\r\n                </button>\r\n                {isExpanded && (\r\n                    <div className=\"p-4 pt-0 border-t dark:border-gray-700\">\r\n                        {children}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <FileText className=\"text-brand-blue\" size={24} />\r\n                        Policies & Rules\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Set booking rules, cancellation policies, and house rules\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={handleSave}\r\n                    disabled={saving}\r\n                    className=\"bg-brand-blue text-white px-6 py-2.5 rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 disabled:opacity-50\"\r\n                >\r\n                    {saving ? <Loader2 className=\"animate-spin\" size={18} /> : <Save size={18} />}\r\n                    Save Changes\r\n                </button>\r\n            </div>\r\n\r\n            {/* Booking Rules */}\r\n            <Section id=\"booking\" title=\"Booking Rules\" icon={Clock}>\r\n                <div className=\"space-y-6 pt-4\">\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Min Hours</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={policies.minBookingHours}\r\n                                onChange={(e) => updatePolicy('minBookingHours', parseInt(e.target.value) || 1)}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                min={1}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Max Hours</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={policies.maxBookingHours}\r\n                                onChange={(e) => updatePolicy('maxBookingHours', parseInt(e.target.value) || 12)}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                min={1}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Book Ahead (Days)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={policies.advanceBookingDays}\r\n                                onChange={(e) => updatePolicy('advanceBookingDays', parseInt(e.target.value) || 7)}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                min={1}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Min Notice (Hrs)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={policies.minAdvanceHours}\r\n                                onChange={(e) => updatePolicy('minAdvanceHours', parseInt(e.target.value) || 0)}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                min={0}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"bg-gray-50 dark:bg-[#1f2128] p-4 rounded-xl flex items-center justify-between\">\r\n                        <div>\r\n                            <div className=\"font-medium dark:text-white\">Auto-Approve Bookings</div>\r\n                            <div className=\"text-sm text-gray-500\">Automatically confirm bookings without manual approval</div>\r\n                        </div>\r\n                        <label className=\"relative inline-flex items-center cursor-pointer\">\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                checked={policies.autoApprove}\r\n                                onChange={(e) => updatePolicy('autoApprove', e.target.checked)}\r\n                                className=\"sr-only peer\"\r\n                            />\r\n                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-brand-blue\"></div>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n            </Section>\r\n\r\n            {/* Cancellation Policy */}\r\n            <Section id=\"cancellation\" title=\"Cancellation Policy\" icon={AlertTriangle}>\r\n                <div className=\"space-y-4 pt-4\">\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n                        {CANCELLATION_POLICIES.map(policy => (\r\n                            <button\r\n                                key={policy.id}\r\n                                onClick={() => updatePolicy('cancellationPolicy', policy.id)}\r\n                                className={`p-4 rounded-xl border-2 text-left transition ${\r\n                                    policies.cancellationPolicy === policy.id\r\n                                        ? `border-${policy.color}-500 bg-${policy.color}-50 dark:bg-${policy.color}-900/20`\r\n                                        : 'border-gray-200 dark:border-gray-700 hover:border-gray-300'\r\n                                }`}\r\n                            >\r\n                                <div className={`font-bold mb-1 ${policies.cancellationPolicy === policy.id ? `text-${policy.color}-700 dark:text-${policy.color}-400` : 'dark:text-white'}`}>\r\n                                    {policy.label}\r\n                                </div>\r\n                                <div className=\"text-xs text-gray-500\">{policy.description}</div>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {policies.cancellationPolicy === 'custom' && (\r\n                        <div className=\"grid grid-cols-2 gap-4 mt-4\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Notice Required (Hours)</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={policies.cancellationNoticeHours}\r\n                                    onChange={(e) => updatePolicy('cancellationNoticeHours', parseInt(e.target.value) || 24)}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    min={0}\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Refund Percentage</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={policies.refundPercentage}\r\n                                    onChange={(e) => updatePolicy('refundPercentage', parseInt(e.target.value) || 0)}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    min={0}\r\n                                    max={100}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </Section>\r\n\r\n            {/* Pricing */}\r\n            <Section id=\"pricing\" title=\"Pricing & Deposits\" icon={DollarSign}>\r\n                <div className=\"space-y-6 pt-4\">\r\n                    {/* Deposit */}\r\n                    <div className=\"bg-gray-50 dark:bg-[#1f2128] p-4 rounded-xl\">\r\n                        <div className=\"flex items-center justify-between mb-4\">\r\n                            <div>\r\n                                <div className=\"font-medium dark:text-white\">Require Deposit</div>\r\n                                <div className=\"text-sm text-gray-500\">Collect partial payment when booking</div>\r\n                            </div>\r\n                            <label className=\"relative inline-flex items-center cursor-pointer\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={policies.depositRequired}\r\n                                    onChange={(e) => updatePolicy('depositRequired', e.target.checked)}\r\n                                    className=\"sr-only peer\"\r\n                                />\r\n                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-brand-blue\"></div>\r\n                            </label>\r\n                        </div>\r\n                        {policies.depositRequired && (\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Deposit Percentage</label>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <input\r\n                                        type=\"range\"\r\n                                        value={policies.depositPercentage}\r\n                                        onChange={(e) => updatePolicy('depositPercentage', parseInt(e.target.value))}\r\n                                        className=\"flex-1\"\r\n                                        min={10}\r\n                                        max={100}\r\n                                        step={5}\r\n                                    />\r\n                                    <span className=\"font-bold text-brand-blue w-14 text-right\">{policies.depositPercentage}%</span>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Peak Pricing */}\r\n                    <div>\r\n                        <div className=\"font-medium dark:text-white mb-3\">Peak Hour Pricing</div>\r\n                        <div className=\"grid grid-cols-3 gap-4\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Peak Start</label>\r\n                                <input\r\n                                    type=\"time\"\r\n                                    value={policies.peakHoursStart}\r\n                                    onChange={(e) => updatePolicy('peakHoursStart', e.target.value)}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Peak End</label>\r\n                                <input\r\n                                    type=\"time\"\r\n                                    value={policies.peakHoursEnd}\r\n                                    onChange={(e) => updatePolicy('peakHoursEnd', e.target.value)}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Rate Multiplier</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={policies.peakHourMultiplier}\r\n                                    onChange={(e) => updatePolicy('peakHourMultiplier', parseFloat(e.target.value) || 1)}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    min={1}\r\n                                    max={3}\r\n                                    step={0.1}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Weekend Pricing */}\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Weekend Rate Multiplier</label>\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <input\r\n                                type=\"range\"\r\n                                value={policies.weekendMultiplier}\r\n                                onChange={(e) => updatePolicy('weekendMultiplier', parseFloat(e.target.value))}\r\n                                className=\"flex-1\"\r\n                                min={1}\r\n                                max={2}\r\n                                step={0.1}\r\n                            />\r\n                            <span className=\"font-bold dark:text-white w-16 text-right\">{policies.weekendMultiplier}x</span>\r\n                        </div>\r\n                        {policies.weekendMultiplier > 1 && (\r\n                            <p className=\"text-xs text-gray-500 mt-1\">\r\n                                Saturday & Sunday bookings will be {Math.round((policies.weekendMultiplier - 1) * 100)}% more\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </Section>\r\n\r\n            {/* House Rules */}\r\n            <Section id=\"rules\" title=\"House Rules & Info\" icon={FileText}>\r\n                <div className=\"space-y-4 pt-4\">\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Studio Rules</label>\r\n                        <textarea\r\n                            value={policies.houseRules}\r\n                            onChange={(e) => updatePolicy('houseRules', e.target.value)}\r\n                            className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                            rows={4}\r\n                            placeholder=\"• No smoking inside the studio&#10;• Please arrive 10 minutes early&#10;• Clean up after your session\"\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">What to Expect</label>\r\n                        <textarea\r\n                            value={policies.whatToExpect}\r\n                            onChange={(e) => updatePolicy('whatToExpect', e.target.value)}\r\n                            className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                            rows={3}\r\n                            placeholder=\"Describe what clients can expect when they arrive...\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">What to Bring</label>\r\n                            <textarea\r\n                                value={policies.whatToBring}\r\n                                onChange={(e) => updatePolicy('whatToBring', e.target.value)}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                rows={3}\r\n                                placeholder=\"• Instrument cables&#10;• Lyrics/charts&#10;• Reference tracks\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Parking Instructions</label>\r\n                            <textarea\r\n                                value={policies.parkingInstructions}\r\n                                onChange={(e) => updatePolicy('parkingInstructions', e.target.value)}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                rows={3}\r\n                                placeholder=\"Describe parking situation and directions...\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </Section>\r\n\r\n            {/* Legal */}\r\n            <Section id=\"legal\" title=\"Legal & Safety\" icon={Shield}>\r\n                <div className=\"space-y-4 pt-4\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Minimum Age Requirement</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={policies.ageRequirement}\r\n                                onChange={(e) => updatePolicy('ageRequirement', parseInt(e.target.value) || 0)}\r\n                                className=\"w-32 p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                min={0}\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-sm text-gray-500 mt-6\">\r\n                            {policies.ageRequirement > 0 \r\n                                ? `Clients must be ${policies.ageRequirement}+ to book`\r\n                                : 'No age restriction'}\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"bg-gray-50 dark:bg-[#1f2128] p-4 rounded-xl\">\r\n                        <div className=\"flex items-center justify-between mb-4\">\r\n                            <div>\r\n                                <div className=\"font-medium dark:text-white\">Require Liability Waiver</div>\r\n                                <div className=\"text-sm text-gray-500\">Clients must sign a waiver before booking</div>\r\n                            </div>\r\n                            <label className=\"relative inline-flex items-center cursor-pointer\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={policies.requiresWaiver}\r\n                                    onChange={(e) => updatePolicy('requiresWaiver', e.target.checked)}\r\n                                    className=\"sr-only peer\"\r\n                                />\r\n                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-brand-blue\"></div>\r\n                            </label>\r\n                        </div>\r\n                        {policies.requiresWaiver && (\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Waiver Text</label>\r\n                                <textarea\r\n                                    value={policies.waiverText}\r\n                                    onChange={(e) => updatePolicy('waiverText', e.target.value)}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white font-mono text-sm\"\r\n                                    rows={6}\r\n                                    placeholder=\"Enter your liability waiver text...\"\r\n                                />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </Section>\r\n        </div>\r\n    );\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { \r\n    Calendar, User, Check, X, MessageSquare, \r\n    Search, RefreshCw, ChevronLeft, ChevronRight,\r\n    CheckCircle, XCircle, Clock3, Eye, Ban, Trash2\r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst STATUS_CONFIG = {\r\n    pending: { \r\n        label: 'Pending', \r\n        color: 'amber', \r\n        icon: Clock3,\r\n        bgClass: 'bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400'\r\n    },\r\n    confirmed: { \r\n        label: 'Confirmed', \r\n        color: 'green', \r\n        icon: CheckCircle,\r\n        bgClass: 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400'\r\n    },\r\n    cancelled: { \r\n        label: 'Cancelled', \r\n        color: 'red', \r\n        icon: XCircle,\r\n        bgClass: 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400'\r\n    },\r\n    completed: { \r\n        label: 'Completed', \r\n        color: 'blue', \r\n        icon: Check,\r\n        bgClass: 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400'\r\n    },\r\n};\r\n\r\n/**\r\n * StudioBookings - Manage incoming bookings for the studio\r\n */\r\nexport default function StudioBookings({ user, onNavigateToChat }) {\r\n    const [bookings, setBookings] = useState([]);\r\n    const [blockedDates, setBlockedDates] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [filter, setFilter] = useState('all');\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [selectedBooking, setSelectedBooking] = useState(null);\r\n    const [updating, setUpdating] = useState(null);\r\n    const [viewMode, setViewMode] = useState('list'); // 'list' or 'calendar'\r\n    const [currentMonth, setCurrentMonth] = useState(new Date());\r\n    const [showBlockModal, setShowBlockModal] = useState(false);\r\n    const [selectedDate, setSelectedDate] = useState(null);\r\n    const [blockReason, setBlockReason] = useState('');\r\n    const [blockTimeSlot, setBlockTimeSlot] = useState('full'); // 'full', 'morning', 'afternoon', 'evening', 'custom'\r\n    const [customStartTime, setCustomStartTime] = useState('09:00');\r\n    const [customEndTime, setCustomEndTime] = useState('17:00');\r\n\r\n    // Fetch bookings from Supabase\r\n    useEffect(() => {\r\n        if (!user?.id && !user?.uid || !supabase) return;\r\n        const userId = user?.id || user?.uid;\r\n\r\n        const channel = supabase\r\n            .channel('studio-bookings')\r\n            .on('postgres_changes', {\r\n                event: '*',\r\n                schema: 'public',\r\n                table: 'bookings',\r\n                filter: `studio_owner_id=eq.${userId}`\r\n            }, () => {\r\n                loadBookings();\r\n            })\r\n            .subscribe();\r\n\r\n        loadBookings();\r\n\r\n        return () => {\r\n            supabase.removeChannel(channel);\r\n        };\r\n    }, [user?.id, user?.uid]);\r\n\r\n    const loadBookings = async () => {\r\n        if (!supabase) return;\r\n        const userId = user?.id || user?.uid;\r\n        setLoading(true);\r\n        try {\r\n            const { data: bookingsData, error } = await supabase\r\n                .from('bookings')\r\n                .select('*')\r\n                .eq('studio_owner_id', userId)\r\n                .order('created_at', { ascending: false });\r\n            \r\n            if (error) throw error;\r\n            \r\n            const bookingsList = (bookingsData || []).map(b => ({\r\n                id: b.id,\r\n                ...b,\r\n                studioOwnerId: b.studio_owner_id,\r\n                clientId: b.client_id,\r\n                clientName: b.client_name,\r\n                date: b.date ? new Date(b.date) : new Date(),\r\n                createdAt: b.created_at ? new Date(b.created_at) : new Date()\r\n            }));\r\n            setBookings(bookingsList);\r\n        } catch (error) {\r\n            console.error('Error fetching bookings:', error);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    // Fetch blocked dates\r\n    useEffect(() => {\r\n        if (!user?.id && !user?.uid || !supabase) return;\r\n        const userId = user?.id || user?.uid;\r\n\r\n        const channel = supabase\r\n            .channel('blocked-dates')\r\n            .on('postgres_changes', {\r\n                event: '*',\r\n                schema: 'public',\r\n                table: 'blocked_dates',\r\n                filter: `studio_owner_id=eq.${userId}`\r\n            }, () => {\r\n                loadBlockedDates();\r\n            })\r\n            .subscribe();\r\n\r\n        loadBlockedDates();\r\n\r\n        return () => {\r\n            supabase.removeChannel(channel);\r\n        };\r\n    }, [user?.id, user?.uid]);\r\n\r\n    const loadBlockedDates = async () => {\r\n        if (!supabase) return;\r\n        const userId = user?.id || user?.uid;\r\n        try {\r\n            const { data: blockedData, error } = await supabase\r\n                .from('blocked_dates')\r\n                .select('*')\r\n                .eq('studio_owner_id', userId);\r\n            \r\n            if (error) throw error;\r\n            \r\n            const blockedList = (blockedData || []).map(b => ({\r\n                id: b.id,\r\n                ...b,\r\n                studioOwnerId: b.studio_owner_id,\r\n                date: b.date ? new Date(b.date) : new Date()\r\n            }));\r\n            // Sort client-side\r\n            blockedList.sort((a, b) => new Date(a.date) - new Date(b.date));\r\n            setBlockedDates(blockedList);\r\n        } catch (error) {\r\n            console.error('Error fetching blocked dates:', error);\r\n            setBlockedDates([]);\r\n        }\r\n    };\r\n\r\n    const handleUpdateStatus = async (bookingId, newStatus) => {\r\n        if (!supabase) return;\r\n        setUpdating(bookingId);\r\n        const toastId = toast.loading(`Updating booking...`);\r\n        \r\n        try {\r\n            const now = new Date().toISOString();\r\n            const updateData = {\r\n                status: newStatus,\r\n                updated_at: now,\r\n                [`${newStatus}_at`]: now\r\n            };\r\n            \r\n            const { error } = await supabase\r\n                .from('bookings')\r\n                .update(updateData)\r\n                .eq('id', bookingId);\r\n            \r\n            if (error) throw error;\r\n            \r\n            toast.success(`Booking ${newStatus}!`, { id: toastId });\r\n        } catch (error) {\r\n            console.error('Update failed:', error);\r\n            toast.error('Failed to update booking', { id: toastId });\r\n        } finally {\r\n            setUpdating(null);\r\n        }\r\n    };\r\n\r\n    // Handle blocking a date (off-platform booking)\r\n    const handleBlockDate = async () => {\r\n        if (!selectedDate || (!user?.id && !user?.uid) || !supabase) return;\r\n        const userId = user?.id || user?.uid;\r\n        \r\n        const toastId = toast.loading('Blocking time slot...');\r\n        \r\n        try {\r\n            const { error } = await supabase\r\n                .from('blocked_dates')\r\n                .insert({\r\n                    studio_owner_id: userId,\r\n                    date: selectedDate.toISOString(),\r\n                    reason: blockReason || 'Off-platform booking',\r\n                    time_slot: blockTimeSlot,\r\n                    start_time: blockTimeSlot === 'custom' ? customStartTime : null,\r\n                    end_time: blockTimeSlot === 'custom' ? customEndTime : null,\r\n                    created_at: new Date().toISOString()\r\n                });\r\n            \r\n            if (error) throw error;\r\n            \r\n            toast.success('Time slot blocked!', { id: toastId });\r\n            setShowBlockModal(false);\r\n            setBlockReason('');\r\n            setBlockTimeSlot('full');\r\n            setSelectedDate(null);\r\n        } catch (error) {\r\n            console.error('Error blocking date:', error);\r\n            toast.error('Failed to block time slot', { id: toastId });\r\n        }\r\n    };\r\n\r\n    // Handle unblocking a date\r\n    const handleUnblockDate = async (blockedId) => {\r\n        if (!supabase) return;\r\n        const toastId = toast.loading('Removing block...');\r\n        \r\n        try {\r\n            await supabase\r\n                .from('blocked_dates')\r\n                .delete()\r\n                .eq('id', blockedId);\r\n            \r\n            toast.success('Block removed!', { id: toastId });\r\n        } catch (error) {\r\n            console.error('Error unblocking date:', error);\r\n            toast.error('Failed to remove block', { id: toastId });\r\n        }\r\n    };\r\n\r\n    // Open block modal for a specific date\r\n    const openBlockModal = (date) => {\r\n        setSelectedDate(date);\r\n        setShowBlockModal(true);\r\n    };\r\n\r\n    // Filter and search bookings\r\n    const filteredBookings = bookings.filter(booking => {\r\n        const matchesFilter = filter === 'all' || booking.status === filter;\r\n        const matchesSearch = !searchTerm || \r\n            booking.clientName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            booking.roomName?.toLowerCase().includes(searchTerm.toLowerCase());\r\n        return matchesFilter && matchesSearch;\r\n    });\r\n\r\n    // Group bookings by date\r\n    const groupedBookings = filteredBookings.reduce((groups, booking) => {\r\n        const dateKey = booking.date.toDateString();\r\n        if (!groups[dateKey]) groups[dateKey] = [];\r\n        groups[dateKey].push(booking);\r\n        return groups;\r\n    }, {});\r\n\r\n    // Stats\r\n    const pendingCount = bookings.filter(b => b.status === 'pending').length;\r\n    const todayBookings = bookings.filter(b => {\r\n        const today = new Date().toDateString();\r\n        return b.date.toDateString() === today && b.status === 'confirmed';\r\n    }).length;\r\n    const upcomingRevenue = bookings\r\n        .filter(b => b.status === 'confirmed' && b.date >= new Date())\r\n        .reduce((sum, b) => sum + (b.totalPrice || 0), 0);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <RefreshCw className=\"animate-spin text-brand-blue\" size={32} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <Calendar className=\"text-brand-blue\" size={24} />\r\n                        Booking Management\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                        {bookings.length} total bookings • {blockedDates.length} blocked slots\r\n                    </p>\r\n                </div>\r\n                \r\n                {/* View Mode Toggle */}\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"bg-gray-100 dark:bg-gray-800 p-1 rounded-lg flex\">\r\n                        <button\r\n                            onClick={() => setViewMode('list')}\r\n                            className={`px-3 py-1.5 text-sm font-medium rounded-md transition ${\r\n                                viewMode === 'list' \r\n                                    ? 'bg-white dark:bg-gray-700 text-brand-blue shadow-sm' \r\n                                    : 'text-gray-500'\r\n                            }`}\r\n                        >\r\n                            List\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setViewMode('calendar')}\r\n                            className={`px-3 py-1.5 text-sm font-medium rounded-md transition ${\r\n                                viewMode === 'calendar' \r\n                                    ? 'bg-white dark:bg-gray-700 text-brand-blue shadow-sm' \r\n                                    : 'text-gray-500'\r\n                            }`}\r\n                        >\r\n                            Calendar\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Stats Cards */}\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n                <div className=\"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-xl border border-amber-200 dark:border-amber-800\">\r\n                    <div className=\"text-2xl font-bold text-amber-600 dark:text-amber-400\">{pendingCount}</div>\r\n                    <div className=\"text-sm text-amber-700 dark:text-amber-300\">Pending Approval</div>\r\n                </div>\r\n                <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-xl border border-green-200 dark:border-green-800\">\r\n                    <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{todayBookings}</div>\r\n                    <div className=\"text-sm text-green-700 dark:text-green-300\">Today&apos;s Sessions</div>\r\n                </div>\r\n                <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-200 dark:border-blue-800\">\r\n                    <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">${upcomingRevenue.toLocaleString()}</div>\r\n                    <div className=\"text-sm text-blue-700 dark:text-blue-300\">Upcoming Revenue</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"flex flex-col md:flex-row gap-4 bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700\">\r\n                <div className=\"relative flex-1\">\r\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={18} />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                        placeholder=\"Search by client or room...\"\r\n                        className=\"w-full pl-10 pr-4 py-2.5 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                    />\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    {['all', 'pending', 'confirmed', 'completed', 'cancelled'].map(status => (\r\n                        <button\r\n                            key={status}\r\n                            onClick={() => setFilter(status)}\r\n                            className={`px-4 py-2 rounded-lg font-medium text-sm transition ${\r\n                                filter === status\r\n                                    ? 'bg-brand-blue text-white'\r\n                                    : 'bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n                            }`}\r\n                        >\r\n                            {status.charAt(0).toUpperCase() + status.slice(1)}\r\n                            {status === 'pending' && pendingCount > 0 && (\r\n                                <span className=\"ml-1.5 bg-amber-500 text-white text-xs px-1.5 py-0.5 rounded-full\">\r\n                                    {pendingCount}\r\n                                </span>\r\n                            )}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Calendar View */}\r\n            {viewMode === 'calendar' && (\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                    {/* Calendar Header */}\r\n                    <div className=\"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] flex justify-between items-center\">\r\n                        <button \r\n                            onClick={() => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1, 1))}\r\n                            className=\"p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition\"\r\n                        >\r\n                            <ChevronLeft size={20} className=\"text-gray-600 dark:text-gray-300\" />\r\n                        </button>\r\n                        <h3 className=\"font-bold dark:text-white text-lg\">\r\n                            {currentMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\r\n                        </h3>\r\n                        <button \r\n                            onClick={() => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 1))}\r\n                            className=\"p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition\"\r\n                        >\r\n                            <ChevronRight size={20} className=\"text-gray-600 dark:text-gray-300\" />\r\n                        </button>\r\n                    </div>\r\n                    \r\n                    {/* Calendar Grid */}\r\n                    <div className=\"p-4\">\r\n                        {/* Day Headers */}\r\n                        <div className=\"grid grid-cols-7 gap-2 mb-2\">\r\n                            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\r\n                                <div key={day} className=\"text-center text-sm font-bold text-gray-500 py-2\">\r\n                                    {day}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                        \r\n                        {/* Calendar Days */}\r\n                        <div className=\"grid grid-cols-7 gap-2\">\r\n                            {(() => {\r\n                                const year = currentMonth.getFullYear();\r\n                                const month = currentMonth.getMonth();\r\n                                const firstDay = new Date(year, month, 1).getDay();\r\n                                const daysInMonth = new Date(year, month + 1, 0).getDate();\r\n                                const today = new Date();\r\n                                \r\n                                const days = [];\r\n                                for (let i = 0; i < firstDay; i++) {\r\n                                    days.push(<div key={`empty-${i}`} className=\"aspect-square\"></div>);\r\n                                }\r\n                                \r\n                                for (let day = 1; day <= daysInMonth; day++) {\r\n                                    const date = new Date(year, month, day);\r\n                                    const isPast = date < new Date(today.getFullYear(), today.getMonth(), today.getDate());\r\n                                    const isToday = date.toDateString() === today.toDateString();\r\n                                    \r\n                                    // Get bookings for this day\r\n                                    const dayBookings = bookings.filter(b => {\r\n                                        const bookingDate = new Date(b.date);\r\n                                        return bookingDate.toDateString() === date.toDateString();\r\n                                    });\r\n                                    \r\n                                    // Get blocks for this day\r\n                                    const dayBlocks = blockedDates.filter(b => {\r\n                                        const blockDate = new Date(b.date);\r\n                                        return blockDate.toDateString() === date.toDateString();\r\n                                    });\r\n                                    \r\n                                    const hasConfirmed = dayBookings.some(b => b.status === 'confirmed');\r\n                                    const hasPending = dayBookings.some(b => b.status === 'pending');\r\n                                    const isBlocked = dayBlocks.length > 0;\r\n                                    \r\n                                    days.push(\r\n                                        <button\r\n                                            key={day}\r\n                                            onClick={() => !isPast && openBlockModal(date)}\r\n                                            disabled={isPast}\r\n                                            className={`aspect-square p-1 rounded-xl flex flex-col items-center justify-center relative transition ${\r\n                                                isPast ? 'opacity-40 cursor-not-allowed' :\r\n                                                isBlocked ? 'bg-red-100 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 hover:bg-red-200 dark:hover:bg-red-900/40' :\r\n                                                isToday ? 'bg-brand-blue text-white' :\r\n                                                hasConfirmed || hasPending ? 'bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30' :\r\n                                                'hover:bg-gray-100 dark:hover:bg-gray-700'\r\n                                            }`}\r\n                                        >\r\n                                            <span className={`text-sm font-medium ${\r\n                                                isToday ? 'text-white' : \r\n                                                isBlocked ? 'text-red-700 dark:text-red-400' :\r\n                                                'dark:text-white'\r\n                                            }`}>\r\n                                                {day}\r\n                                            </span>\r\n                                            \r\n                                            {/* Indicators */}\r\n                                            <div className=\"flex gap-0.5 mt-0.5\">\r\n                                                {hasConfirmed && <span className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></span>}\r\n                                                {hasPending && <span className=\"w-1.5 h-1.5 bg-amber-500 rounded-full\"></span>}\r\n                                                {isBlocked && <Ban size={10} className=\"text-red-600 dark:text-red-400\" />}\r\n                                            </div>\r\n                                            \r\n                                            {/* Booking count badge */}\r\n                                            {dayBookings.length > 0 && !isToday && (\r\n                                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-brand-blue text-white text-[10px] rounded-full flex items-center justify-center font-bold\">\r\n                                                    {dayBookings.length}\r\n                                                </span>\r\n                                            )}\r\n                                        </button>\r\n                                    );\r\n                                }\r\n                                \r\n                                return days;\r\n                            })()}\r\n                        </div>\r\n                        \r\n                        {/* Legend */}\r\n                        <div className=\"flex flex-wrap items-center gap-4 mt-4 pt-4 border-t dark:border-gray-700 text-xs text-gray-500\">\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <span className=\"w-2 h-2 bg-green-500 rounded-full\"></span>\r\n                                Confirmed\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <span className=\"w-2 h-2 bg-amber-500 rounded-full\"></span>\r\n                                Pending\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1\">\r\n                                <Ban size={12} className=\"text-red-500\" />\r\n                                Blocked\r\n                            </div>\r\n                            <div className=\"ml-auto text-gray-400\">\r\n                                Click a date to block off-platform bookings\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    {/* Blocked Dates List */}\r\n                    {blockedDates.length > 0 && (\r\n                        <div className=\"p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]\">\r\n                            <h4 className=\"font-bold text-sm dark:text-white mb-3 flex items-center gap-2\">\r\n                                <Ban size={14} className=\"text-red-500\" />\r\n                                Blocked Time Slots\r\n                            </h4>\r\n                            <div className=\"space-y-2 max-h-48 overflow-y-auto\">\r\n                                {blockedDates.map(block => (\r\n                                    <div \r\n                                        key={block.id}\r\n                                        className=\"flex items-center justify-between p-3 bg-white dark:bg-[#2c2e36] rounded-lg border dark:border-gray-700\"\r\n                                    >\r\n                                        <div>\r\n                                            <div className=\"font-medium dark:text-white text-sm\">\r\n                                                {new Date(block.date).toLocaleDateString('en-US', { \r\n                                                    weekday: 'short', \r\n                                                    month: 'short', \r\n                                                    day: 'numeric' \r\n                                                })}\r\n                                                {block.timeSlot !== 'full' && (\r\n                                                    <span className=\"ml-2 text-xs text-gray-500\">\r\n                                                        ({block.timeSlot === 'custom' \r\n                                                            ? `${block.startTime} - ${block.endTime}` \r\n                                                            : block.timeSlot})\r\n                                                    </span>\r\n                                                )}\r\n                                            </div>\r\n                                            <div className=\"text-xs text-gray-500\">{block.reason}</div>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => handleUnblockDate(block.id)}\r\n                                            className=\"p-1.5 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition\"\r\n                                            title=\"Remove block\"\r\n                                        >\r\n                                            <Trash2 size={16} />\r\n                                        </button>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Bookings List */}\r\n            {viewMode === 'list' && (\r\n                <>\r\n                {filteredBookings.length === 0 ? (\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-12 text-center\">\r\n                    <Calendar size={48} className=\"mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\r\n                    <h3 className=\"text-lg font-bold dark:text-white mb-2\">No Bookings Found</h3>\r\n                    <p className=\"text-gray-500 dark:text-gray-400\">\r\n                        {filter !== 'all' ? `No ${filter} bookings` : 'Bookings will appear here when clients book your studio'}\r\n                    </p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"space-y-6\">\r\n                    {Object.entries(groupedBookings).map(([dateKey, dateBookings]) => (\r\n                        <div key={dateKey}>\r\n                            <h3 className=\"text-sm font-bold text-gray-500 uppercase mb-3 flex items-center gap-2\">\r\n                                <Calendar size={14} />\r\n                                {new Date(dateKey).toLocaleDateString('en-US', { \r\n                                    weekday: 'long', \r\n                                    month: 'long', \r\n                                    day: 'numeric' \r\n                                })}\r\n                                <span className=\"text-gray-400\">({dateBookings.length})</span>\r\n                            </h3>\r\n                            <div className=\"space-y-3\">\r\n                                {dateBookings.map(booking => {\r\n                                    const statusConfig = STATUS_CONFIG[booking.status] || STATUS_CONFIG.pending;\r\n                                    \r\n                                    return (\r\n                                        <div \r\n                                            key={booking.id}\r\n                                            className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\"\r\n                                        >\r\n                                            <div className=\"p-4 flex items-center gap-4\">\r\n                                                {/* Time */}\r\n                                                <div className=\"text-center min-w-[70px]\">\r\n                                                    <div className=\"text-lg font-bold dark:text-white\">\r\n                                                        {booking.startTime}\r\n                                                    </div>\r\n                                                    <div className=\"text-xs text-gray-500\">\r\n                                                        {booking.duration}h\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                {/* Details */}\r\n                                                <div className=\"flex-1 min-w-0\">\r\n                                                    <div className=\"flex items-center gap-2\">\r\n                                                        <span className=\"font-bold dark:text-white truncate\">\r\n                                                            {booking.clientName || 'Unknown Client'}\r\n                                                        </span>\r\n                                                        <span className={`text-xs px-2 py-0.5 rounded-full ${statusConfig.bgClass}`}>\r\n                                                            {statusConfig.label}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <div className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                                                        {booking.roomName || 'Main Room'} • ${booking.totalPrice || 0}\r\n                                                    </div>\r\n                                                    {booking.notes && (\r\n                                                        <div className=\"text-xs text-gray-400 mt-1 truncate\">\r\n                                                            Note: {booking.notes}\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n\r\n                                                {/* Actions */}\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    {booking.status === 'pending' && (\r\n                                                        <>\r\n                                                            <button\r\n                                                                onClick={() => handleUpdateStatus(booking.id, 'confirmed')}\r\n                                                                disabled={updating === booking.id}\r\n                                                                className=\"p-2 bg-green-100 dark:bg-green-900/30 text-green-600 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition\"\r\n                                                                title=\"Approve\"\r\n                                                            >\r\n                                                                <Check size={18} />\r\n                                                            </button>\r\n                                                            <button\r\n                                                                onClick={() => handleUpdateStatus(booking.id, 'cancelled')}\r\n                                                                disabled={updating === booking.id}\r\n                                                                className=\"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition\"\r\n                                                                title=\"Decline\"\r\n                                                            >\r\n                                                                <X size={18} />\r\n                                                            </button>\r\n                                                        </>\r\n                                                    )}\r\n                                                    {booking.status === 'confirmed' && (\r\n                                                        <button\r\n                                                            onClick={() => handleUpdateStatus(booking.id, 'completed')}\r\n                                                            disabled={updating === booking.id}\r\n                                                            className=\"px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition text-sm font-medium\"\r\n                                                        >\r\n                                                            Mark Complete\r\n                                                        </button>\r\n                                                    )}\r\n                                                    {booking.clientId && onNavigateToChat && (\r\n                                                        <button\r\n                                                            onClick={() => onNavigateToChat(booking.clientId)}\r\n                                                            className=\"p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition\"\r\n                                                            title=\"Message Client\"\r\n                                                        >\r\n                                                            <MessageSquare size={18} />\r\n                                                        </button>\r\n                                                    )}\r\n                                                    <button\r\n                                                        onClick={() => setSelectedBooking(booking)}\r\n                                                        className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition\"\r\n                                                        title=\"View Details\"\r\n                                                    >\r\n                                                        <Eye size={18} />\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n                </>\r\n            )}\r\n\r\n            {/* Block Date Modal */}\r\n            {showBlockModal && (\r\n                <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\r\n                    <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl max-w-md w-full\">\r\n                        <div className=\"p-4 border-b dark:border-gray-700 flex justify-between items-center\">\r\n                            <h3 className=\"font-bold dark:text-white flex items-center gap-2\">\r\n                                <Ban size={18} className=\"text-red-500\" />\r\n                                Block Time Slot\r\n                            </h3>\r\n                            <button onClick={() => {\r\n                                setShowBlockModal(false);\r\n                                setSelectedDate(null);\r\n                                setBlockReason('');\r\n                            }}>\r\n                                <X size={20} className=\"text-gray-500\" />\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"p-4 space-y-4\">\r\n                            {/* Selected Date */}\r\n                            <div className=\"bg-gray-50 dark:bg-[#1f2128] p-3 rounded-lg text-center\">\r\n                                <div className=\"text-sm text-gray-500 uppercase font-bold mb-1\">Selected Date</div>\r\n                                <div className=\"text-lg font-bold dark:text-white\">\r\n                                    {selectedDate?.toLocaleDateString('en-US', { \r\n                                        weekday: 'long', \r\n                                        month: 'long', \r\n                                        day: 'numeric',\r\n                                        year: 'numeric'\r\n                                    })}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Time Slot Selection */}\r\n                            <div>\r\n                                <label className=\"text-sm font-bold dark:text-white mb-2 block\">Time Slot</label>\r\n                                <div className=\"grid grid-cols-2 gap-2\">\r\n                                    {[\r\n                                        { id: 'full', label: 'Full Day' },\r\n                                        { id: 'morning', label: 'Morning (6AM-12PM)' },\r\n                                        { id: 'afternoon', label: 'Afternoon (12PM-6PM)' },\r\n                                        { id: 'evening', label: 'Evening (6PM-12AM)' },\r\n                                    ].map(slot => (\r\n                                        <button\r\n                                            key={slot.id}\r\n                                            onClick={() => setBlockTimeSlot(slot.id)}\r\n                                            className={`p-2 text-sm rounded-lg border transition ${\r\n                                                blockTimeSlot === slot.id\r\n                                                    ? 'bg-red-100 dark:bg-red-900/30 border-red-300 dark:border-red-700 text-red-700 dark:text-red-400'\r\n                                                    : 'border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-gray-300'\r\n                                            }`}\r\n                                        >\r\n                                            {slot.label}\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => setBlockTimeSlot('custom')}\r\n                                    className={`w-full mt-2 p-2 text-sm rounded-lg border transition ${\r\n                                        blockTimeSlot === 'custom'\r\n                                            ? 'bg-red-100 dark:bg-red-900/30 border-red-300 dark:border-red-700 text-red-700 dark:text-red-400'\r\n                                            : 'border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-gray-300'\r\n                                    }`}\r\n                                >\r\n                                    Custom Time Range\r\n                                </button>\r\n\r\n                                {blockTimeSlot === 'custom' && (\r\n                                    <div className=\"flex gap-2 mt-2\">\r\n                                        <div className=\"flex-1\">\r\n                                            <label className=\"text-xs text-gray-500 mb-1 block\">Start</label>\r\n                                            <input\r\n                                                type=\"time\"\r\n                                                value={customStartTime}\r\n                                                onChange={(e) => setCustomStartTime(e.target.value)}\r\n                                                className=\"w-full p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm\"\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"flex-1\">\r\n                                            <label className=\"text-xs text-gray-500 mb-1 block\">End</label>\r\n                                            <input\r\n                                                type=\"time\"\r\n                                                value={customEndTime}\r\n                                                onChange={(e) => setCustomEndTime(e.target.value)}\r\n                                                className=\"w-full p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Reason */}\r\n                            <div>\r\n                                <label className=\"text-sm font-bold dark:text-white mb-2 block\">Reason (optional)</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={blockReason}\r\n                                    onChange={(e) => setBlockReason(e.target.value)}\r\n                                    placeholder=\"e.g., Private session, Maintenance, Personal...\"\r\n                                    className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Actions */}\r\n                            <div className=\"flex gap-3 pt-2\">\r\n                                <button\r\n                                    onClick={() => {\r\n                                        setShowBlockModal(false);\r\n                                        setSelectedDate(null);\r\n                                        setBlockReason('');\r\n                                    }}\r\n                                    className=\"flex-1 py-2.5 border dark:border-gray-600 rounded-lg font-bold dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleBlockDate}\r\n                                    className=\"flex-1 py-2.5 bg-red-600 text-white rounded-lg font-bold hover:bg-red-700 transition flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <Ban size={16} />\r\n                                    Block Time\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Booking Detail Modal */}\r\n            {selectedBooking && (\r\n                <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\r\n                    <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto\">\r\n                        <div className=\"p-4 border-b dark:border-gray-700 flex justify-between items-center\">\r\n                            <h3 className=\"font-bold dark:text-white\">Booking Details</h3>\r\n                            <button onClick={() => setSelectedBooking(null)}>\r\n                                <X size={20} className=\"text-gray-500\" />\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"p-4 space-y-4\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <div className=\"w-12 h-12 bg-brand-blue/10 rounded-full flex items-center justify-center\">\r\n                                    <User className=\"text-brand-blue\" size={24} />\r\n                                </div>\r\n                                <div>\r\n                                    <div className=\"font-bold dark:text-white\">{selectedBooking.clientName}</div>\r\n                                    <div className=\"text-sm text-gray-500\">{selectedBooking.clientEmail}</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div className=\"bg-gray-50 dark:bg-[#1f2128] p-3 rounded-lg\">\r\n                                    <div className=\"text-xs text-gray-500 uppercase font-bold mb-1\">Date</div>\r\n                                    <div className=\"dark:text-white\">\r\n                                        {selectedBooking.date.toLocaleDateString('en-US', { \r\n                                            weekday: 'short', \r\n                                            month: 'short', \r\n                                            day: 'numeric' \r\n                                        })}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-gray-50 dark:bg-[#1f2128] p-3 rounded-lg\">\r\n                                    <div className=\"text-xs text-gray-500 uppercase font-bold mb-1\">Time</div>\r\n                                    <div className=\"dark:text-white\">\r\n                                        {selectedBooking.startTime} ({selectedBooking.duration}h)\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-gray-50 dark:bg-[#1f2128] p-3 rounded-lg\">\r\n                                    <div className=\"text-xs text-gray-500 uppercase font-bold mb-1\">Room</div>\r\n                                    <div className=\"dark:text-white\">{selectedBooking.roomName}</div>\r\n                                </div>\r\n                                <div className=\"bg-gray-50 dark:bg-[#1f2128] p-3 rounded-lg\">\r\n                                    <div className=\"text-xs text-gray-500 uppercase font-bold mb-1\">Total</div>\r\n                                    <div className=\"dark:text-white font-bold text-green-600\">${selectedBooking.totalPrice}</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {selectedBooking.notes && (\r\n                                <div className=\"bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg\">\r\n                                    <div className=\"text-xs text-amber-600 uppercase font-bold mb-1\">Client Notes</div>\r\n                                    <div className=\"text-amber-800 dark:text-amber-300 text-sm\">{selectedBooking.notes}</div>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"text-xs text-gray-400\">\r\n                                Booked {selectedBooking.createdAt.toLocaleDateString()}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","import { useState } from 'react';\r\nimport { \r\n    Mic, Speaker, Monitor, Server, Plus, Search, \r\n    Trash2, Edit2, Save, Loader2, X, \r\n    Package\r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport toast from 'react-hot-toast';\r\nimport EquipmentAutocomplete from '../shared/EquipmentAutocomplete';\r\nimport { EQUIP_CATEGORIES } from '../../config/constants';\r\n\r\n/**\r\n * StudioEquipment - Full equipment inventory management\r\n */\r\nexport default function StudioEquipment({ user, userData, onUpdate }) {\r\n    const [equipment, setEquipment] = useState(userData?.studioEquipment || []);\r\n    const [saving, setSaving] = useState(false);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [categoryFilter, setCategoryFilter] = useState('all');\r\n    const [showAddModal, setShowAddModal] = useState(false);\r\n    const [editingItem, setEditingItem] = useState(null);\r\n\r\n    const handleSave = async (updatedEquipment) => {\r\n        if (!supabase) return;\r\n        setSaving(true);\r\n        const toastId = toast.loading('Saving equipment...');\r\n        const userId = user?.id || user?.uid;\r\n        \r\n        try {\r\n            await supabase\r\n                .from('profiles')\r\n                .update({ \r\n                    studio_equipment: updatedEquipment,\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', userId);\r\n            \r\n            setEquipment(updatedEquipment);\r\n            toast.success('Equipment saved!', { id: toastId });\r\n            if (onUpdate) onUpdate({ studioEquipment: updatedEquipment });\r\n        } catch (error) {\r\n            console.error('Save failed:', error);\r\n            toast.error('Failed to save', { id: toastId });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleAddItem = async (newItem) => {\r\n        const itemWithId = {\r\n            ...newItem,\r\n            id: Date.now().toString(),\r\n            addedAt: new Date().toISOString()\r\n        };\r\n        await handleSave([...equipment, itemWithId]);\r\n        setShowAddModal(false);\r\n    };\r\n\r\n    const handleUpdateItem = async (updatedItem) => {\r\n        const updatedEquipment = equipment.map(item => \r\n            item.id === updatedItem.id ? updatedItem : item\r\n        );\r\n        await handleSave(updatedEquipment);\r\n        setEditingItem(null);\r\n    };\r\n\r\n    const handleDeleteItem = async (itemId) => {\r\n        if (!confirm('Remove this item from inventory?')) return;\r\n        const updatedEquipment = equipment.filter(item => item.id !== itemId);\r\n        await handleSave(updatedEquipment);\r\n    };\r\n\r\n    // Filter equipment\r\n    const filteredEquipment = equipment.filter(item => {\r\n        const matchesSearch = !searchTerm || \r\n            item.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            item.brand?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            item.model?.toLowerCase().includes(searchTerm.toLowerCase());\r\n        const matchesCategory = categoryFilter === 'all' || item.category === categoryFilter;\r\n        return matchesSearch && matchesCategory;\r\n    });\r\n\r\n    // Group by category\r\n    const groupedEquipment = filteredEquipment.reduce((groups, item) => {\r\n        const cat = item.category || 'Other';\r\n        if (!groups[cat]) groups[cat] = [];\r\n        groups[cat].push(item);\r\n        return groups;\r\n    }, {});\r\n\r\n    // Get unique categories\r\n    const categories = [...new Set(equipment.map(item => item.category).filter(Boolean))];\r\n\r\n    // Stats\r\n    const totalItems = equipment.length;\r\n    const totalValue = equipment.reduce((sum, item) => sum + (parseFloat(item.value) || 0), 0);\r\n\r\n    const getCategoryIcon = (category) => {\r\n        const iconMap = {\r\n            'microphones_and_input_transducers': Mic,\r\n            'monitoring_and_playback': Speaker,\r\n            'mixing_consoles_and_control': Monitor,\r\n            'outboard_signal_processing': Server,\r\n            'computer_audio_and_interfaces': Server,\r\n        };\r\n        return iconMap[category] || Package;\r\n    };\r\n\r\n    const getCategoryLabel = (categoryId) => {\r\n        const cat = EQUIP_CATEGORIES.find(c => c.id === categoryId);\r\n        return cat?.label || categoryId;\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <Package className=\"text-brand-blue\" size={24} />\r\n                        Equipment Inventory\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Manage your studio gear and equipment\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setShowAddModal(true)}\r\n                    className=\"bg-brand-blue text-white px-4 py-2.5 rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2\"\r\n                >\r\n                    <Plus size={18} /> Add Equipment\r\n                </button>\r\n            </div>\r\n\r\n            {/* Stats */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                <div className=\"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700\">\r\n                    <div className=\"text-2xl font-bold dark:text-white\">{totalItems}</div>\r\n                    <div className=\"text-sm text-gray-500\">Total Items</div>\r\n                </div>\r\n                <div className=\"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700\">\r\n                    <div className=\"text-2xl font-bold text-green-600\">${totalValue.toLocaleString()}</div>\r\n                    <div className=\"text-sm text-gray-500\">Est. Value</div>\r\n                </div>\r\n                <div className=\"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700\">\r\n                    <div className=\"text-2xl font-bold dark:text-white\">{categories.length}</div>\r\n                    <div className=\"text-sm text-gray-500\">Categories</div>\r\n                </div>\r\n                <div className=\"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700\">\r\n                    <div className=\"text-2xl font-bold text-brand-blue\">\r\n                        {equipment.filter(e => e.featured).length}\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-500\">Featured Items</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"flex flex-col md:flex-row gap-4 bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700\">\r\n                <div className=\"relative flex-1\">\r\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={18} />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                        placeholder=\"Search equipment...\"\r\n                        className=\"w-full pl-10 pr-4 py-2.5 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                    />\r\n                </div>\r\n                <select\r\n                    value={categoryFilter}\r\n                    onChange={(e) => setCategoryFilter(e.target.value)}\r\n                    className=\"px-4 py-2.5 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                >\r\n                    <option value=\"all\">All Categories</option>\r\n                    {EQUIP_CATEGORIES.map(cat => (\r\n                        <option key={cat.id} value={cat.id}>{cat.label}</option>\r\n                    ))}\r\n                </select>\r\n            </div>\r\n\r\n            {/* Equipment List */}\r\n            {filteredEquipment.length === 0 ? (\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border-2 border-dashed dark:border-gray-700 p-12 text-center\">\r\n                    <Package size={48} className=\"mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\r\n                    <h3 className=\"text-lg font-bold dark:text-white mb-2\">No Equipment Found</h3>\r\n                    <p className=\"text-gray-500 dark:text-gray-400 mb-4\">\r\n                        {searchTerm || categoryFilter !== 'all' \r\n                            ? 'Try adjusting your filters'\r\n                            : 'Add your studio equipment to showcase your gear'}\r\n                    </p>\r\n                    <button\r\n                        onClick={() => setShowAddModal(true)}\r\n                        className=\"bg-brand-blue text-white px-6 py-2.5 rounded-xl font-bold hover:bg-blue-600 transition\"\r\n                    >\r\n                        Add Your First Item\r\n                    </button>\r\n                </div>\r\n            ) : (\r\n                <div className=\"space-y-6\">\r\n                    {Object.entries(groupedEquipment).map(([category, items]) => {\r\n                        const CategoryIcon = getCategoryIcon(category);\r\n                        return (\r\n                            <div key={category} className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden\">\r\n                                <div className=\"p-4 bg-gray-50 dark:bg-[#23262f] border-b dark:border-gray-700 flex items-center gap-3\">\r\n                                    <CategoryIcon className=\"text-brand-blue\" size={20} />\r\n                                    <h3 className=\"font-bold dark:text-white\">{getCategoryLabel(category)}</h3>\r\n                                    <span className=\"text-sm text-gray-500\">({items.length})</span>\r\n                                </div>\r\n                                <div className=\"divide-y dark:divide-gray-700\">\r\n                                    {items.map(item => (\r\n                                        <div \r\n                                            key={item.id}\r\n                                            className=\"p-4 flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-[#23262f] transition\"\r\n                                        >\r\n                                            {/* Item Info */}\r\n                                            <div className=\"flex-1 min-w-0\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <span className=\"font-bold dark:text-white\">\r\n                                                        {item.brand && <span className=\"text-gray-500 font-medium\">{item.brand}</span>} {item.name || item.model}\r\n                                                    </span>\r\n                                                    {item.featured && (\r\n                                                        <span className=\"text-xs bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 px-2 py-0.5 rounded\">\r\n                                                            Featured\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                                <div className=\"text-sm text-gray-500 dark:text-gray-400 mt-0.5\">\r\n                                                    {item.model && item.name !== item.model && <span>{item.model}</span>}\r\n                                                    {item.serial && <span className=\"ml-2\">S/N: {item.serial}</span>}\r\n                                                </div>\r\n                                                {item.notes && (\r\n                                                    <div className=\"text-xs text-gray-400 mt-1\">{item.notes}</div>\r\n                                                )}\r\n                                            </div>\r\n\r\n                                            {/* Value */}\r\n                                            {item.value && (\r\n                                                <div className=\"text-right\">\r\n                                                    <div className=\"text-sm font-bold text-green-600 dark:text-green-400\">\r\n                                                        ${parseFloat(item.value).toLocaleString()}\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {/* Actions */}\r\n                                            <div className=\"flex items-center gap-1\">\r\n                                                <button\r\n                                                    onClick={() => setEditingItem(item)}\r\n                                                    className=\"p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition\"\r\n                                                >\r\n                                                    <Edit2 size={16} />\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => handleDeleteItem(item.id)}\r\n                                                    className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition\"\r\n                                                >\r\n                                                    <Trash2 size={16} />\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            )}\r\n\r\n            {/* Add/Edit Modal */}\r\n            {(showAddModal || editingItem) && (\r\n                <EquipmentModal\r\n                    item={editingItem}\r\n                    onSave={editingItem ? handleUpdateItem : handleAddItem}\r\n                    onClose={() => { setShowAddModal(false); setEditingItem(null); }}\r\n                    saving={saving}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/**\r\n * Equipment Add/Edit Modal\r\n */\r\nfunction EquipmentModal({ item, onSave, onClose, saving }) {\r\n    const [formData, setFormData] = useState(item || {\r\n        name: '',\r\n        brand: '',\r\n        model: '',\r\n        category: '',\r\n        serial: '',\r\n        value: '',\r\n        notes: '',\r\n        featured: false\r\n    });\r\n\r\n    const handleSubmit = () => {\r\n        if (!formData.name && !formData.model) {\r\n            toast.error('Name or model is required');\r\n            return;\r\n        }\r\n        onSave(formData);\r\n    };\r\n\r\n    const handleAutocompleteSelect = (selected) => {\r\n        setFormData(prev => ({\r\n            ...prev,\r\n            name: selected.name || prev.name,\r\n            brand: selected.brand || prev.brand,\r\n            model: selected.model || prev.model,\r\n            category: selected.category || prev.category\r\n        }));\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto animate-in zoom-in-95\">\r\n                <div className=\"p-4 border-b dark:border-gray-700 flex justify-between items-center\">\r\n                    <h3 className=\"font-bold dark:text-white\">\r\n                        {item ? 'Edit Equipment' : 'Add Equipment'}\r\n                    </h3>\r\n                    <button onClick={onClose}>\r\n                        <X size={20} className=\"text-gray-500\" />\r\n                    </button>\r\n                </div>\r\n                <div className=\"p-4 space-y-4\">\r\n                    {/* Quick Add */}\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Quick Search</label>\r\n                        <EquipmentAutocomplete\r\n                            onSelect={handleAutocompleteSelect}\r\n                            placeholder=\"Search for equipment...\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"border-t dark:border-gray-700 pt-4 space-y-4\">\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Brand</label>\r\n                                <input\r\n                                    value={formData.brand}\r\n                                    onChange={(e) => setFormData({ ...formData, brand: e.target.value })}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    placeholder=\"e.g. Neumann\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Model *</label>\r\n                                <input\r\n                                    value={formData.model || formData.name}\r\n                                    onChange={(e) => setFormData({ ...formData, model: e.target.value, name: e.target.value })}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    placeholder=\"e.g. U87\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Category</label>\r\n                            <select\r\n                                value={formData.category}\r\n                                onChange={(e) => setFormData({ ...formData, category: e.target.value })}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                            >\r\n                                <option value=\"\">Select category...</option>\r\n                                {EQUIP_CATEGORIES.map(cat => (\r\n                                    <option key={cat.id} value={cat.id}>{cat.label}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Serial Number</label>\r\n                                <input\r\n                                    value={formData.serial}\r\n                                    onChange={(e) => setFormData({ ...formData, serial: e.target.value })}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    placeholder=\"Optional\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Value ($)</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={formData.value}\r\n                                    onChange={(e) => setFormData({ ...formData, value: e.target.value })}\r\n                                    className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                    placeholder=\"Estimated value\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Notes</label>\r\n                            <textarea\r\n                                value={formData.notes}\r\n                                onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\r\n                                className=\"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\"\r\n                                rows={2}\r\n                                placeholder=\"Additional details...\"\r\n                            />\r\n                        </div>\r\n\r\n                        <label className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-[#1f2128] rounded-xl cursor-pointer\">\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                checked={formData.featured}\r\n                                onChange={(e) => setFormData({ ...formData, featured: e.target.checked })}\r\n                                className=\"w-4 h-4 text-brand-blue rounded\"\r\n                            />\r\n                            <div>\r\n                                <div className=\"font-medium dark:text-white text-sm\">Featured Equipment</div>\r\n                                <div className=\"text-xs text-gray-500\">Highlight this item on your studio profile</div>\r\n                            </div>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div className=\"p-4 border-t dark:border-gray-700 flex justify-end gap-3\">\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"px-5 py-2.5 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl font-medium\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        onClick={handleSubmit}\r\n                        disabled={saving}\r\n                        className=\"px-6 py-2.5 bg-brand-blue text-white rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 disabled:opacity-50\"\r\n                    >\r\n                        {saving ? <Loader2 className=\"animate-spin\" size={18} /> : <Save size={18} />}\r\n                        {item ? 'Update' : 'Add Item'}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useState } from 'react';\r\nimport { \r\n    Settings, Save, Loader2, Home, MapPin, Mail,\r\n    Wifi, Shield, EyeOff\r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport * as z from 'zod';\r\nimport toast from 'react-hot-toast';\r\nimport AddressAutocomplete from '../shared/AddressAutocomplete';\r\nimport { AMENITIES_DATA } from '../../config/constants';\r\n\r\nconst settingsSchema = z.object({\r\n    studioName: z.string().min(3, \"Studio name is required\"),\r\n    address: z.string().min(5, \"Address is required\"),\r\n    city: z.string().optional(),\r\n    state: z.string().optional(),\r\n    zip: z.string().optional(),\r\n    lat: z.number().optional(),\r\n    lng: z.number().optional(),\r\n    studioDescription: z.string().max(1000).optional(),\r\n    email: z.string().email().optional().or(z.literal('')),\r\n    phoneCell: z.string().optional(),\r\n    phoneLand: z.string().optional(),\r\n    website: z.string().url().optional().or(z.literal('')),\r\n    hours: z.string().optional(),\r\n    amenities: z.array(z.string()).optional(),\r\n    hideAddress: z.boolean().optional(),\r\n});\r\n\r\n/**\r\n * StudioSettings - Basic studio information and contact settings\r\n */\r\nexport default function StudioSettings({ user, userData, onUpdate }) {\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    const {\r\n        register,\r\n        control,\r\n        handleSubmit,\r\n        watch,\r\n        setValue,\r\n        formState: { errors, isDirty }\r\n    } = useForm({\r\n        resolver: zodResolver(settingsSchema),\r\n        defaultValues: {\r\n            studioName: userData?.studioName || userData?.profileName || '',\r\n            address: userData?.address || '',\r\n            city: userData?.city || '',\r\n            state: userData?.state || '',\r\n            zip: userData?.zip || '',\r\n            lat: userData?.lat,\r\n            lng: userData?.lng,\r\n            studioDescription: userData?.studioDescription || '',\r\n            email: userData?.email || '',\r\n            phoneCell: userData?.phoneCell || '',\r\n            phoneLand: userData?.phoneLand || '',\r\n            website: userData?.website || '',\r\n            hours: userData?.hours || '',\r\n            amenities: userData?.amenities || [],\r\n            hideAddress: userData?.hideAddress || false,\r\n        }\r\n    });\r\n\r\n    const watchedAmenities = watch(\"amenities\");\r\n    const watchHideAddress = watch(\"hideAddress\");\r\n\r\n    const toggleAmenity = (amenity) => {\r\n        const current = watchedAmenities || [];\r\n        if (current.includes(amenity)) {\r\n            setValue('amenities', current.filter(a => a !== amenity), { shouldDirty: true });\r\n        } else {\r\n            setValue('amenities', [...current, amenity], { shouldDirty: true });\r\n        }\r\n    };\r\n\r\n    const onSubmit = async (data) => {\r\n        if (!supabase) return;\r\n        setSaving(true);\r\n        const toastId = toast.loading('Saving settings...');\r\n\r\n        try {\r\n            const userId = user?.id || user?.uid;\r\n            await supabase\r\n                .from('profiles')\r\n                .update({\r\n                    studio_name: data.studioName,\r\n                    profile_name: data.studioName,\r\n                    address: data.address,\r\n                    city: data.city,\r\n                    state: data.state,\r\n                    zip: data.zip,\r\n                    lat: data.lat,\r\n                    lng: data.lng,\r\n                    studio_description: data.studioDescription,\r\n                    email: data.email,\r\n                    phone_cell: data.phoneCell,\r\n                    phone_land: data.phoneLand,\r\n                    website: data.website,\r\n                    hours: data.hours,\r\n                    amenities: data.amenities,\r\n                    hide_address: data.hideAddress,\r\n                    is_studio: true,\r\n                    updated_at: new Date().toISOString()\r\n                })\r\n                .eq('id', userId);\r\n            \r\n            if (error) throw error;\r\n            \r\n            toast.success(\"Settings saved!\", { id: toastId });\r\n            if (onUpdate) onUpdate(data);\r\n        } catch (error) {\r\n            console.error(\"Save failed\", error);\r\n            toast.error(\"Failed to save settings.\", { id: toastId });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const inputClass = (error) => `w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none ${error ? 'border-red-500 bg-red-50 dark:bg-red-900/10' : 'border-gray-200'}`;\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <Settings className=\"text-brand-blue\" size={24} />\r\n                        Studio Settings\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Basic information and contact details\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    type=\"submit\"\r\n                    disabled={saving || !isDirty}\r\n                    className={`px-6 py-2.5 rounded-xl font-bold flex items-center gap-2 transition ${\r\n                        saving || !isDirty\r\n                            ? 'bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed'\r\n                            : 'bg-brand-blue text-white hover:bg-blue-600'\r\n                    }`}\r\n                >\r\n                    {saving ? <Loader2 className=\"animate-spin\" size={18} /> : <Save size={18} />}\r\n                    Save Changes\r\n                </button>\r\n            </div>\r\n\r\n            {/* Basic Info */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700\">\r\n                <h3 className=\"font-bold dark:text-white mb-4 flex items-center gap-2\">\r\n                    <Home size={18} className=\"text-brand-blue\" />\r\n                    General Information\r\n                </h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div className=\"md:col-span-2\">\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Studio Name *</label>\r\n                        <input {...register(\"studioName\")} className={inputClass(errors.studioName)} placeholder=\"Your Studio Name\" />\r\n                        {errors.studioName && <p className=\"text-red-500 text-xs mt-1\">{errors.studioName.message}</p>}\r\n                    </div>\r\n                    <div className=\"md:col-span-2\">\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Description</label>\r\n                        <textarea \r\n                            {...register(\"studioDescription\")} \r\n                            rows={3} \r\n                            className={inputClass(errors.studioDescription)} \r\n                            placeholder=\"Describe your studio, the vibe, and what makes it special...\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Location */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700\">\r\n                <h3 className=\"font-bold dark:text-white mb-4 flex items-center gap-2\">\r\n                    <MapPin size={18} className=\"text-brand-blue\" />\r\n                    Location\r\n                </h3>\r\n                \r\n                {/* Privacy Toggle */}\r\n                <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-200 dark:border-blue-800 mb-4\">\r\n                    <label className=\"flex items-start gap-3 cursor-pointer\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            {...register(\"hideAddress\")}\r\n                            className=\"w-5 h-5 mt-0.5 text-brand-blue rounded\"\r\n                        />\r\n                        <div>\r\n                            <div className=\"font-bold text-gray-700 dark:text-gray-200 flex items-center gap-2\">\r\n                                <Shield size={16} className=\"text-brand-blue\" />\r\n                                Private Home Studio Mode\r\n                            </div>\r\n                            <p className=\"text-xs text-gray-500 mt-1\">\r\n                                Your exact address will be hidden from the public map. It will only be revealed after you approve a booking request.\r\n                            </p>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                    <Controller\r\n                        control={control}\r\n                        name=\"address\"\r\n                        render={({ field: { onChange, value } }) => (\r\n                            <AddressAutocomplete\r\n                                label=\"Street Address\"\r\n                                value={value || ''}\r\n                                onChange={onChange}\r\n                                onSelect={(addressData) => {\r\n                                    if (addressData.lat) setValue('lat', addressData.lat);\r\n                                    if (addressData.lng) setValue('lng', addressData.lng);\r\n                                    if (addressData.city) setValue('city', addressData.city, { shouldDirty: true });\r\n                                    if (addressData.state) setValue('state', addressData.state, { shouldDirty: true });\r\n                                    if (addressData.zip) setValue('zip', addressData.zip, { shouldDirty: true });\r\n                                }}\r\n                                placeholder=\"Start typing your address...\"\r\n                                error={errors.address?.message}\r\n                                required\r\n                            />\r\n                        )}\r\n                    />\r\n                    <div className=\"grid grid-cols-3 gap-4\">\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">City</label>\r\n                            <input {...register(\"city\")} className={inputClass()} placeholder=\"City\" />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">State</label>\r\n                            <input {...register(\"state\")} className={inputClass()} placeholder=\"State\" />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">ZIP</label>\r\n                            <input {...register(\"zip\")} className={inputClass()} placeholder=\"ZIP Code\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {watchHideAddress && (\r\n                    <div className=\"mt-4 flex items-center gap-2 text-sm text-amber-600 dark:text-amber-400\">\r\n                        <EyeOff size={16} />\r\n                        <span>Address will be hidden until booking approval</span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Contact */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700\">\r\n                <h3 className=\"font-bold dark:text-white mb-4 flex items-center gap-2\">\r\n                    <Mail size={18} className=\"text-brand-blue\" />\r\n                    Contact Information\r\n                </h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Email</label>\r\n                        <input {...register(\"email\")} type=\"email\" className={inputClass(errors.email)} placeholder=\"studio@email.com\" />\r\n                        {errors.email && <p className=\"text-red-500 text-xs mt-1\">{errors.email.message}</p>}\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Website</label>\r\n                        <input {...register(\"website\")} className={inputClass(errors.website)} placeholder=\"https://yourstudio.com\" />\r\n                        {errors.website && <p className=\"text-red-500 text-xs mt-1\">{errors.website.message}</p>}\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Cell Phone</label>\r\n                        <input {...register(\"phoneCell\")} className={inputClass()} placeholder=\"(555) 123-4567\" />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Landline</label>\r\n                        <input {...register(\"phoneLand\")} className={inputClass()} placeholder=\"(555) 123-4567\" />\r\n                    </div>\r\n                    <div className=\"md:col-span-2\">\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Hours of Operation</label>\r\n                        <input {...register(\"hours\")} className={inputClass()} placeholder=\"e.g. Mon-Fri 9AM-10PM, Sat-Sun 10AM-8PM\" />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Amenities */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700\">\r\n                <h3 className=\"font-bold dark:text-white mb-4 flex items-center gap-2\">\r\n                    <Wifi size={18} className=\"text-brand-blue\" />\r\n                    Amenities\r\n                </h3>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                    {AMENITIES_DATA.map(amenity => (\r\n                        <button\r\n                            key={amenity}\r\n                            type=\"button\"\r\n                            onClick={() => toggleAmenity(amenity)}\r\n                            className={`px-3 py-2 rounded-lg text-sm font-medium transition-all border ${\r\n                                watchedAmenities?.includes(amenity)\r\n                                    ? \"bg-brand-blue text-white border-brand-blue shadow-md\"\r\n                                    : \"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n                            }`}\r\n                        >\r\n                            {amenity}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Save Button (Bottom) */}\r\n            <div className=\"flex justify-end\">\r\n                <button\r\n                    type=\"submit\"\r\n                    disabled={saving || !isDirty}\r\n                    className={`px-8 py-3 rounded-xl font-bold text-lg flex items-center gap-2 transition shadow-lg ${\r\n                        saving || !isDirty\r\n                            ? 'bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed'\r\n                            : 'bg-brand-blue text-white hover:bg-blue-600 hover:scale-[1.01]'\r\n                    }`}\r\n                >\r\n                    {saving ? <Loader2 className=\"animate-spin\" size={20} /> : <Save size={20} />}\r\n                    Save Settings\r\n                </button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { \r\n    Home, LayoutGrid, Image, Clock, FileText, Calendar, \r\n    Package, Settings, ChevronRight, Briefcase\r\n} from 'lucide-react';\r\nimport { supabase } from '../config/supabase';\r\n\r\n// Import sub-components\r\nimport StudioOverview from './studio/StudioOverview';\r\nimport StudioRooms from './studio/StudioRooms';\r\nimport StudioGallery from './studio/StudioGallery';\r\nimport StudioAvailability from './studio/StudioAvailability';\r\nimport StudioPolicies from './studio/StudioPolicies';\r\nimport StudioBookings from './studio/StudioBookings';\r\nimport StudioEquipment from './studio/StudioEquipment';\r\nimport StudioSettings from './studio/StudioSettings';\r\n\r\nconst TABS = [\r\n    { id: 'overview', label: 'Overview', icon: Home, description: 'Dashboard & quick stats' },\r\n    { id: 'rooms', label: 'Rooms', icon: LayoutGrid, description: 'Manage studio rooms' },\r\n    { id: 'equipment', label: 'Equipment', icon: Package, description: 'Equipment inventory' },\r\n    { id: 'gallery', label: 'Gallery', icon: Image, description: 'Photo gallery' },\r\n    { id: 'availability', label: 'Hours', icon: Clock, description: 'Operating hours' },\r\n    { id: 'policies', label: 'Policies', icon: FileText, description: 'Rules & pricing' },\r\n    { id: 'bookings', label: 'Bookings', icon: Calendar, description: 'Manage bookings' },\r\n    { id: 'settings', label: 'Settings', icon: Settings, description: 'Studio info' },\r\n];\r\n\r\n/**\r\n * StudioManager - Complete studio management interface with tabbed navigation\r\n */\r\nexport default function StudioManager({ user, userData }) {\r\n    const [activeTab, setActiveTab] = useState('overview');\r\n    const [stats, setStats] = useState({\r\n        pendingBookings: 0,\r\n        recentBookings: [],\r\n        totalRevenue: 0\r\n    });\r\n    const [localUserData, setLocalUserData] = useState(userData);\r\n\r\n    // Fetch booking stats\r\n    useEffect(() => {\r\n        const fetchStats = async () => {\r\n            if (!user?.id && !user?.uid || !supabase) return;\r\n            const userId = user.id || user.uid;\r\n            \r\n            try {\r\n                // Fetch bookings where user is the target (studio owner receiving bookings)\r\n                const { data: bookings, error } = await supabase\r\n                    .from('bookings')\r\n                    .select('*')\r\n                    .eq('target_id', userId)\r\n                    .order('date', { ascending: true });\r\n\r\n                if (error) throw error;\r\n\r\n                const pending = bookings.filter(b => b.status === 'Pending').length;\r\n                const recent = bookings\r\n                    .filter(b => {\r\n                        const bookingDate = new Date(b.date);\r\n                        return bookingDate >= new Date();\r\n                    })\r\n                    .sort((a, b) => new Date(a.date) - new Date(b.date))\r\n                    .slice(0, 5);\r\n                const revenue = bookings\r\n                    .filter(b => b.status === 'Completed')\r\n                    .reduce((sum, b) => sum + (b.offer_amount || 0), 0);\r\n\r\n                setStats({\r\n                    pendingBookings: pending,\r\n                    recentBookings: recent,\r\n                    totalRevenue: revenue\r\n                });\r\n            } catch (error) {\r\n                console.error('Error fetching stats:', error);\r\n            }\r\n        };\r\n\r\n        fetchStats();\r\n    }, [user?.id, user?.uid]);\r\n\r\n    // Handle updates from child components\r\n    const handleUpdate = (updates) => {\r\n        setLocalUserData(prev => ({ ...prev, ...updates }));\r\n    };\r\n\r\n    // Handle navigation from overview\r\n    const handleNavigate = (tabId) => {\r\n        setActiveTab(tabId);\r\n    };\r\n\r\n    const renderContent = () => {\r\n        const commonProps = {\r\n            user,\r\n            userData: localUserData,\r\n            onUpdate: handleUpdate\r\n        };\r\n\r\n        switch (activeTab) {\r\n            case 'overview':\r\n                return <StudioOverview {...commonProps} stats={stats} onNavigate={handleNavigate} />;\r\n            case 'rooms':\r\n                return <StudioRooms {...commonProps} />;\r\n            case 'equipment':\r\n                return <StudioEquipment {...commonProps} />;\r\n            case 'gallery':\r\n                return <StudioGallery {...commonProps} />;\r\n            case 'availability':\r\n                return <StudioAvailability {...commonProps} />;\r\n            case 'policies':\r\n                return <StudioPolicies {...commonProps} />;\r\n            case 'bookings':\r\n                return <StudioBookings {...commonProps} />;\r\n            case 'settings':\r\n                return <StudioSettings {...commonProps} />;\r\n            default:\r\n                return <StudioOverview {...commonProps} stats={stats} onNavigate={handleNavigate} />;\r\n        }\r\n    };\r\n\r\n    const activeTabInfo = TABS.find(t => t.id === activeTab);\r\n\r\n    return (\r\n        <div className=\"max-w-7xl mx-auto pb-20\">\r\n            {/* Header */}\r\n            <div className=\"mb-6\">\r\n                <div className=\"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 mb-2\">\r\n                    <Briefcase size={14} />\r\n                    <span>Business Center</span>\r\n                    <ChevronRight size={14} />\r\n                    <span className=\"text-gray-700 dark:text-gray-200\">Studio Manager</span>\r\n                </div>\r\n                <h1 className=\"text-3xl font-bold dark:text-white flex items-center gap-3\">\r\n                    <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-white\">\r\n                        <Home size={24} />\r\n                    </div>\r\n                    {localUserData?.studioName || localUserData?.profileName || 'Studio Manager'}\r\n                </h1>\r\n            </div>\r\n\r\n            {/* Tab Navigation */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 mb-6 overflow-hidden\">\r\n                <div className=\"flex overflow-x-auto scrollbar-hide\">\r\n                    {TABS.map((tab) => {\r\n                        const Icon = tab.icon;\r\n                        const isActive = activeTab === tab.id;\r\n                        const hasBadge = tab.id === 'bookings' && stats.pendingBookings > 0;\r\n                        \r\n                        return (\r\n                            <button\r\n                                key={tab.id}\r\n                                onClick={() => setActiveTab(tab.id)}\r\n                                className={`flex items-center gap-2 px-5 py-4 text-sm font-medium whitespace-nowrap transition-all border-b-2 relative ${\r\n                                    isActive\r\n                                        ? 'border-brand-blue text-brand-blue bg-blue-50 dark:bg-blue-900/20'\r\n                                        : 'border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800'\r\n                                }`}\r\n                            >\r\n                                <Icon size={18} />\r\n                                {tab.label}\r\n                                {hasBadge && (\r\n                                    <span className=\"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold\">\r\n                                        {stats.pendingBookings}\r\n                                    </span>\r\n                                )}\r\n                            </button>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Tab Description (Mobile) */}\r\n            <div className=\"md:hidden mb-4 px-1\">\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                    {activeTabInfo?.description}\r\n                </p>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"min-h-[50vh]\">\r\n                {renderContent()}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../config/supabase';\r\nimport { Users, Search, UserPlus, Trash2, Shield, User } from 'lucide-react';\r\n\r\nexport default function LabelManager({ user }) {\r\n    const [roster, setRoster] = useState([]);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [searchResults, setSearchResults] = useState([]);\r\n    const [searching, setSearching] = useState(false);\r\n    const [view, setView] = useState('list'); // 'list' or 'search'\r\n\r\n    // 1. Fetch Roster\r\n    useEffect(() => {\r\n        if (!user?.id && !user?.uid || !supabase) return;\r\n        const userId = user.id || user.uid;\r\n        \r\n        // Initial fetch\r\n        supabase\r\n            .from('label_roster')\r\n            .select('*')\r\n            .eq('label_id', userId)\r\n            .then(({ data, error }) => {\r\n                if (error) {\r\n                    console.error('Error fetching roster:', error);\r\n                    return;\r\n                }\r\n                setRoster((data || []).map(item => ({\r\n                    id: item.id,\r\n                    artistId: item.artist_id,\r\n                    name: item.name,\r\n                    email: item.email,\r\n                    photoURL: item.photo_url,\r\n                    status: item.status,\r\n                    signedAt: item.signed_at\r\n                })));\r\n            });\r\n\r\n        // Subscribe to realtime changes\r\n        const channel = supabase\r\n            .channel(`label-roster-${userId}`)\r\n            .on(\r\n                'postgres_changes',\r\n                {\r\n                    event: '*',\r\n                    schema: 'public',\r\n                    table: 'label_roster',\r\n                    filter: `label_id=eq.${userId}`\r\n                },\r\n                async () => {\r\n                    const { data } = await supabase\r\n                        .from('label_roster')\r\n                        .select('*')\r\n                        .eq('label_id', userId);\r\n                    \r\n                    if (data) {\r\n                        setRoster(data.map(item => ({\r\n                            id: item.id,\r\n                            artistId: item.artist_id,\r\n                            name: item.name,\r\n                            email: item.email,\r\n                            photoURL: item.photo_url,\r\n                            status: item.status,\r\n                            signedAt: item.signed_at\r\n                        })));\r\n                    }\r\n                }\r\n            )\r\n            .subscribe();\r\n\r\n        return () => {\r\n            supabase.removeChannel(channel);\r\n        };\r\n    }, [user?.id, user?.uid]);\r\n\r\n    // 2. Search for Artists to Sign\r\n    const handleSearch = async () => {\r\n        if (searchQuery.length < 3 || !supabase) return;\r\n        setSearching(true);\r\n        try {\r\n            const userId = user?.id || user?.uid;\r\n            const searchLower = searchQuery.toLowerCase();\r\n            \r\n            // Search public profiles using native Supabase\r\n            const { data, error } = await supabase\r\n                .from('public_profiles')\r\n                .select('*')\r\n                .contains('search_terms', [searchLower])\r\n                .limit(20);\r\n\r\n            if (error) throw error;\r\n\r\n            // Filter out self and already signed artists\r\n            const results = (data || [])\r\n                .filter(u => u.id !== userId && !roster.some(r => r.artistId === u.id))\r\n                .map(profile => ({\r\n                    id: profile.id,\r\n                    firstName: profile.first_name,\r\n                    lastName: profile.last_name,\r\n                    email: profile.email,\r\n                    photoURL: profile.avatar_url,\r\n                    displayName: profile.display_name\r\n                }));\r\n            \r\n            setSearchResults(results);\r\n        } catch (e) {\r\n            console.error(\"Search failed:\", e);\r\n        }\r\n        setSearching(false);\r\n    };\r\n\r\n    // 3. \"Sign\" Artist (Add to Roster)\r\n    const signArtist = async (artist) => {\r\n        if (!supabase) {\r\n            alert(\"Database unavailable.\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const userId = user?.id || user?.uid;\r\n            \r\n            const { error } = await supabase\r\n                .from('label_roster')\r\n                .insert({\r\n                    label_id: userId,\r\n                    artist_id: artist.id,\r\n                    name: `${artist.firstName || ''} ${artist.lastName || ''}`.trim(),\r\n                    email: artist.email || 'N/A',\r\n                    photo_url: artist.photoURL || null,\r\n                    status: 'Active'\r\n                });\r\n\r\n            if (error) throw error;\r\n\r\n            alert(`Signed ${artist.firstName || artist.displayName} to roster!`);\r\n            setSearchQuery('');\r\n            setSearchResults([]);\r\n            setView('list');\r\n        } catch (e) {\r\n            console.error(\"Signing failed:\", e);\r\n            alert(\"Failed to add artist: \" + (e.message || \"Unknown error\"));\r\n        }\r\n    };\r\n\r\n    // 4. Remove Artist\r\n    const releaseArtist = async (rosterId, name) => {\r\n        if (!confirm(`Release ${name} from your roster?`) || !supabase) return;\r\n        try {\r\n            const { error } = await supabase\r\n                .from('label_roster')\r\n                .delete()\r\n                .eq('id', rosterId);\r\n\r\n            if (error) throw error;\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Failed to release artist: \" + (e.message || \"Unknown error\"));\r\n        }\r\n    };\r\n\r\n    // --- RENDER ---\r\n    return (\r\n        <div className=\"max-w-5xl mx-auto space-y-6 animate-in fade-in pb-20\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <Shield className=\"text-purple-600\" /> Label Management\r\n                    </h2>\r\n                    <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Manage your artist roster and bookings.\r\n                    </p>\r\n                </div>\r\n                <button \r\n                    onClick={() => setView(view === 'list' ? 'search' : 'list')}\r\n                    className=\"bg-purple-600 text-white px-5 py-2.5 rounded-xl font-bold hover:bg-purple-700 transition flex items-center gap-2\"\r\n                >\r\n                    {view === 'list' ? <><UserPlus size={18}/> Sign Artist</> : 'Back to Roster'}\r\n                </button>\r\n            </div>\r\n\r\n            {/* View: Search */}\r\n            {view === 'search' && (\r\n                <div className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm animate-in slide-in-from-top-4\">\r\n                    <h3 className=\"font-bold dark:text-white mb-4\">Find Talent</h3>\r\n                    <div className=\"flex gap-2 mb-6\">\r\n                        <div className=\"relative flex-1\">\r\n                            <Search className=\"absolute left-3 top-3 text-gray-400\" size={18}/>\r\n                            <input \r\n                                className=\"w-full pl-10 p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-purple-500 outline-none\"\r\n                                placeholder=\"Search by name...\"\r\n                                value={searchQuery}\r\n                                onChange={e => setSearchQuery(e.target.value)}\r\n                                onKeyDown={e => e.key === 'Enter' && handleSearch()}\r\n                            />\r\n                        </div>\r\n                        <button onClick={handleSearch} disabled={searching} className=\"bg-gray-900 dark:bg-white dark:text-black text-white px-6 rounded-xl font-bold\">\r\n                            {searching ? '...' : 'Search'}\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                        {searchResults.map(artist => (\r\n                            <div key={artist.id} className=\"p-4 border dark:border-gray-700 rounded-xl flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800 transition\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden\">\r\n                                        {artist.photoURL ? <img src={artist.photoURL} className=\"h-full w-full object-cover\"/> : <User className=\"m-2 text-gray-400\"/>}\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"font-bold dark:text-white text-sm\">{artist.firstName} {artist.lastName}</div>\r\n                                        <div className=\"text-xs text-gray-500\">{artist.accountTypes?.[0] || 'User'}</div>\r\n                                    </div>\r\n                                </div>\r\n                                <button onClick={() => signArtist(artist)} className=\"text-xs bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-3 py-1.5 rounded-lg font-bold hover:bg-purple-200\">\r\n                                    Sign\r\n                                </button>\r\n                            </div>\r\n                        ))}\r\n                        {searchResults.length === 0 && searchQuery && !searching && <div className=\"col-span-full text-center text-gray-500 text-sm\">No artists found.</div>}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* View: Roster List */}\r\n            {view === 'list' && (\r\n                <div className=\"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 overflow-hidden\">\r\n                    <div className=\"p-4 bg-gray-50 dark:bg-[#23262f] border-b dark:border-gray-700 flex justify-between items-center\">\r\n                        <span className=\"font-bold text-sm text-gray-500 uppercase tracking-wide\">Current Roster ({roster.length})</span>\r\n                    </div>\r\n                    {roster.length === 0 ? (\r\n                        <div className=\"p-12 text-center text-gray-500\">\r\n                            <Users size={48} className=\"mx-auto mb-3 opacity-20\"/>\r\n                            <p>No artists signed yet.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"divide-y dark:divide-gray-700\">\r\n                            {roster.map(item => (\r\n                                <div key={item.id} className=\"p-5 hover:bg-gray-50 dark:hover:bg-white/5 transition flex items-center justify-between group\">\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <div className=\"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center text-indigo-600 font-bold text-lg overflow-hidden\">\r\n                                            {item.photoURL ? <img src={item.photoURL} className=\"h-full w-full object-cover\"/> : item.name[0]}\r\n                                        </div>\r\n                                        <div>\r\n                                            <h4 className=\"font-bold dark:text-white text-lg\">{item.name}</h4>\r\n                                            <p className=\"text-xs text-gray-500\">Signed: {item.signedAt?.toDate ? item.signedAt.toDate().toLocaleDateString() : 'Recent'}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <span className=\"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 px-2 py-1 rounded text-xs font-bold\">\r\n                                            {item.status}\r\n                                        </span>\r\n                                        <button \r\n                                            onClick={() => releaseArtist(item.id, item.name)}\r\n                                            className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition\"\r\n                                            title=\"Release Artist\"\r\n                                        >\r\n                                            <Trash2 size={18}/>\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { \r\n    ChevronRight, ChevronLeft, Upload, Music, Image as ImageIcon, \r\n    CheckCircle, AlertCircle, Loader2, Info, X, Calendar \r\n} from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport { useMediaUpload } from '../../hooks/useMediaUpload';\r\nimport { DDEX_GENRES, DISTRIBUTION_STORES, RELEASE_TYPES } from '../../config/constants';\r\n\r\n// --- SUB-COMPONENTS FOR STEPS ---\r\n\r\nconst Step1Metadata = ({ data, setData }) => (\r\n    <div className=\"space-y-4 animate-in slide-in-from-right-4\">\r\n        <h3 className=\"text-lg font-bold dark:text-white mb-4\">Release Essentials</h3>\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Release Title</label>\r\n                <input className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\" value={data.title} onChange={e => setData({...data, title: e.target.value})} placeholder=\"e.g. Dark Side of the Moon\"/>\r\n            </div>\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Primary Artist</label>\r\n                <input className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\" value={data.primaryArtist} onChange={e => setData({...data, primaryArtist: e.target.value})} placeholder=\"e.g. Pink Floyd\"/>\r\n            </div>\r\n        </div>\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Release Type</label>\r\n                <select className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\" value={data.type} onChange={e => setData({...data, type: e.target.value})}>\r\n                    {RELEASE_TYPES.map(t => <option key={t.id} value={t.id}>{t.label}</option>)}\r\n                </select>\r\n            </div>\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Primary Genre</label>\r\n                <select className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\" value={data.genre} onChange={e => setData({...data, genre: e.target.value})}>\r\n                    <option value=\"\">Select Genre...</option>\r\n                    {DDEX_GENRES.map(g => <option key={g} value={g}>{g}</option>)}\r\n                </select>\r\n            </div>\r\n        </div>\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Release Date</label>\r\n                <input type=\"date\" className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\" value={data.releaseDate} onChange={e => setData({...data, releaseDate: e.target.value})} />\r\n                <p className=\"text-[10px] text-gray-400 mt-1\">Standard: 2 weeks out. Express: 48hrs.</p>\r\n            </div>\r\n            <div>\r\n                <label className=\"text-xs font-bold text-gray-500 uppercase mb-1 block\">Label Name</label>\r\n                <input className=\"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white\" value={data.labelName} onChange={e => setData({...data, labelName: e.target.value})} placeholder=\"Optional (Default: Independent)\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n);\r\n\r\nconst Step2Artwork = ({ data, setData, user }) => {\r\n    const { uploadMedia: uploadImage, uploading } = useMediaUpload(); \r\n    const [preview, setPreview] = useState(data.artworkUrl || null);\r\n    const [validationMsg, setValidationMsg] = useState('');\r\n\r\n    const handleFile = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n\r\n        // Client-side Validation (3000px check)\r\n        const img = new Image();\r\n        img.src = URL.createObjectURL(file);\r\n        img.onload = async () => {\r\n            if (img.width < 3000 || img.height < 3000) {\r\n                setValidationMsg(\"Error: Image must be at least 3000 x 3000 pixels.\");\r\n                return;\r\n            }\r\n            if (img.width !== img.height) {\r\n                setValidationMsg(\"Warning: Image should be a perfect square (1:1 ratio).\");\r\n            } else {\r\n                setValidationMsg(\"\");\r\n            }\r\n\r\n            // Proceed to upload\r\n            const res = await uploadImage(file, `distribution/${user.uid}/artwork`);\r\n            if (res?.url) {\r\n                setPreview(res.url);\r\n                setData({ ...data, artworkUrl: res.url });\r\n            }\r\n        };\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center space-y-6 animate-in slide-in-from-right-4\">\r\n            <div className=\"text-center space-y-2\">\r\n                <h3 className=\"text-lg font-bold dark:text-white\">Upload Cover Art</h3>\r\n                <p className=\"text-sm text-gray-500\">3000 x 3000 px • JPG or PNG • No Blurry Text</p>\r\n            </div>\r\n\r\n            <div className=\"relative group w-64 h-64 bg-gray-100 dark:bg-[#1f2128] rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 flex items-center justify-center overflow-hidden\">\r\n                {preview ? (\r\n                    <img src={preview} className=\"w-full h-full object-cover\" />\r\n                ) : (\r\n                    <div className=\"text-gray-400 flex flex-col items-center\">\r\n                        <ImageIcon size={48} className=\"mb-2\"/>\r\n                        <span className=\"text-xs font-bold\">Click to Upload</span>\r\n                    </div>\r\n                )}\r\n                \r\n                <label className=\"absolute inset-0 cursor-pointer bg-black/0 hover:bg-black/20 transition flex items-center justify-center\">\r\n                    <input type=\"file\" className=\"hidden\" accept=\"image/png, image/jpeg\" onChange={handleFile} disabled={uploading}/>\r\n                    {uploading && <Loader2 className=\"animate-spin text-white\" size={32}/>}\r\n                </label>\r\n            </div>\r\n\r\n            {validationMsg && (\r\n                <div className=\"text-red-500 text-sm font-bold flex items-center gap-2 bg-red-50 dark:bg-red-900/20 px-4 py-2 rounded-lg\">\r\n                    <AlertCircle size={16}/> {validationMsg}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst Step3Tracks = ({ data, setData, user }) => {\r\n    const { uploadMedia, uploading } = useMediaUpload();\r\n    \r\n    const addTrack = async (file) => {\r\n        if (!file.name.toLowerCase().endsWith('.wav')) {\r\n            alert(\"Only .WAV files are accepted for distribution.\");\r\n            return;\r\n        }\r\n\r\n        const newTrack = {\r\n            id: Date.now(),\r\n            title: file.name.replace('.wav', ''),\r\n            fileUrl: '', // Will be filled after upload\r\n            status: 'uploading',\r\n            isExplicit: false,\r\n            isInstrumental: false\r\n        };\r\n\r\n        // Optimistic UI\r\n        const updatedTracks = [...(data.tracks || []), newTrack];\r\n        setData({ ...data, tracks: updatedTracks });\r\n\r\n        // Start Upload\r\n        try {\r\n            // Upload to a private \"Vault\" path\r\n            const res = await uploadMedia(file, `distribution/${user.uid}/audio_vault`);\r\n            if (res?.url) {\r\n                const finalTracks = updatedTracks.map(t => \r\n                    t.id === newTrack.id ? { ...t, fileUrl: res.url, status: 'ready', duration: 0 } : t\r\n                );\r\n                setData({ ...data, tracks: finalTracks });\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Track upload failed\", e);\r\n            alert(\"Upload failed.\");\r\n        }\r\n    };\r\n\r\n    const removeTrack = (id) => {\r\n        setData({ ...data, tracks: data.tracks.filter(t => t.id !== id) });\r\n    };\r\n\r\n    const updateTrackMeta = (id, field, val) => {\r\n        setData({\r\n            ...data,\r\n            tracks: data.tracks.map(t => t.id === id ? { ...t, [field]: val } : t)\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in slide-in-from-right-4\">\r\n            <div className=\"flex justify-between items-end\">\r\n                <div>\r\n                    <h3 className=\"text-lg font-bold dark:text-white\">Upload Audio</h3>\r\n                    <p className=\"text-sm text-gray-500\">Stereo WAV files only (16-bit / 44.1kHz minimum)</p>\r\n                </div>\r\n                <label className=\"bg-brand-blue hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-xs cursor-pointer flex items-center gap-2 transition\">\r\n                    <Upload size={14}/> Add Track\r\n                    <input type=\"file\" className=\"hidden\" accept=\".wav\" onChange={e => addTrack(e.target.files[0])} disabled={uploading}/>\r\n                </label>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n                {data.tracks?.length === 0 && (\r\n                    <div className=\"text-center py-12 border-2 border-dashed dark:border-gray-700 rounded-xl text-gray-400\">\r\n                        No tracks added yet.\r\n                    </div>\r\n                )}\r\n                \r\n                {data.tracks?.map((track, idx) => (\r\n                    <div key={track.id} className=\"bg-white dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-700 flex flex-col gap-3\">\r\n                        <div className=\"flex justify-between items-center\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"bg-gray-100 dark:bg-gray-800 p-2 rounded text-gray-500 font-mono text-xs\">\r\n                                    #{idx + 1}\r\n                                </div>\r\n                                <div className=\"font-bold dark:text-white text-sm\">\r\n                                    {track.status === 'uploading' ? <span className=\"flex items-center gap-2 text-brand-blue\"><Loader2 className=\"animate-spin\" size={14}/> Uploading...</span> : track.title}\r\n                                </div>\r\n                            </div>\r\n                            <button onClick={() => removeTrack(track.id)} className=\"text-gray-400 hover:text-red-500\"><X size={16}/></button>\r\n                        </div>\r\n                        \r\n                        {track.status === 'ready' && (\r\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n                                <input \r\n                                    className=\"col-span-2 p-2 text-xs border rounded bg-transparent dark:border-gray-600 dark:text-white\" \r\n                                    placeholder=\"Track Title\" \r\n                                    value={track.title} \r\n                                    onChange={e => updateTrackMeta(track.id, 'title', e.target.value)}\r\n                                />\r\n                                <label className=\"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300 p-2 bg-gray-50 dark:bg-gray-800 rounded cursor-pointer\">\r\n                                    <input type=\"checkbox\" checked={track.isExplicit} onChange={e => updateTrackMeta(track.id, 'isExplicit', e.target.checked)}/> Explicit\r\n                                </label>\r\n                                <label className=\"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300 p-2 bg-gray-50 dark:bg-gray-800 rounded cursor-pointer\">\r\n                                    <input type=\"checkbox\" checked={track.isInstrumental} onChange={e => updateTrackMeta(track.id, 'isInstrumental', e.target.checked)}/> Instrumental\r\n                                </label>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst Step4Stores = ({ data, setData }) => {\r\n    const toggleStore = (storeId) => {\r\n        const current = data.stores || [];\r\n        const updated = current.includes(storeId) \r\n            ? current.filter(s => s !== storeId) \r\n            : [...current, storeId];\r\n        setData({ ...data, stores: updated });\r\n    };\r\n\r\n    const toggleAll = () => {\r\n        if (data.stores?.length === DISTRIBUTION_STORES.length) setData({ ...data, stores: [] });\r\n        else setData({ ...data, stores: DISTRIBUTION_STORES.map(s => s.id) });\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in slide-in-from-right-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n                <h3 className=\"text-lg font-bold dark:text-white\">Select Stores</h3>\r\n                <button onClick={toggleAll} className=\"text-xs font-bold text-brand-blue hover:underline\">\r\n                    {data.stores?.length === DISTRIBUTION_STORES.length ? 'Deselect All' : 'Select All'}\r\n                </button>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\r\n                {DISTRIBUTION_STORES.map(store => {\r\n                    const isSelected = data.stores?.includes(store.id);\r\n                    return (\r\n                        <div \r\n                            key={store.id} \r\n                            onClick={() => toggleStore(store.id)}\r\n                            className={`p-3 rounded-xl border flex items-center gap-3 cursor-pointer transition-all ${isSelected ? 'bg-blue-50 border-brand-blue dark:bg-blue-900/20' : 'bg-white dark:bg-[#1f2128] dark:border-gray-700 hover:border-gray-300'}`}\r\n                        >\r\n                            <div className={`w-5 h-5 rounded-full border flex items-center justify-center ${isSelected ? 'bg-brand-blue border-brand-blue' : 'border-gray-400'}`}>\r\n                                {isSelected && <CheckCircle size={12} className=\"text-white\"/>}\r\n                            </div>\r\n                            <span className={`text-sm font-bold ${isSelected ? 'text-brand-blue dark:text-white' : 'text-gray-600 dark:text-gray-400'}`}>{store.name}</span>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n            \r\n            <div className=\"bg-yellow-50 dark:bg-yellow-900/10 p-4 rounded-xl border border-yellow-200 dark:border-yellow-800 text-sm text-yellow-800 dark:text-yellow-200 flex items-start gap-3\">\r\n                <Info size={18} className=\"mt-0.5 shrink-0\"/>\r\n                <p>Deliveries usually take 2-5 days for Spotify/Apple, and up to 2 weeks for other stores. Please plan your release date accordingly.</p>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// --- MAIN WIZARD COMPONENT ---\r\n\r\nexport default function ReleaseBuilder({ user, userData, initialData, onCancel, onSuccess }) {\r\n    const [step, setStep] = useState(1);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    \r\n    // Initial State Template\r\n    const [formData, setFormData] = useState(initialData || {\r\n        title: '',\r\n        primaryArtist: userData ? `${userData.firstName || ''} ${userData.lastName || ''}`.trim() || 'Artist' : 'Artist', // Default to user\r\n        type: 'single',\r\n        genre: '',\r\n        releaseDate: '',\r\n        labelName: '',\r\n        artworkUrl: '',\r\n        tracks: [],\r\n        stores: DISTRIBUTION_STORES.map(s => s.id), // Default all selected\r\n        status: 'Draft'\r\n    });\r\n\r\n    const isStepValid = () => {\r\n        if (step === 1) return formData.title && formData.primaryArtist && formData.genre && formData.releaseDate;\r\n        if (step === 2) return !!formData.artworkUrl;\r\n        if (step === 3) return formData.tracks.length > 0 && formData.tracks.every(t => t.status === 'ready');\r\n        if (step === 4) return formData.stores.length > 0;\r\n        return true;\r\n    };\r\n\r\n    const handleFinalSubmit = async () => {\r\n        if (!supabase) return;\r\n        setSubmitting(true);\r\n        const userId = user?.id || user?.uid;\r\n        try {\r\n            const payload = {\r\n                uploader_id: userId,\r\n                title: formData.title,\r\n                primary_artist: formData.primaryArtist,\r\n                type: formData.type,\r\n                genre: formData.genre,\r\n                release_date: formData.releaseDate,\r\n                label_name: formData.labelName || null,\r\n                artwork_url: formData.artworkUrl || null,\r\n                tracks: formData.tracks || [],\r\n                updated_at: new Date().toISOString(),\r\n                status: 'Processing' // Move to processing queue\r\n            };\r\n\r\n            if (initialData?.id) {\r\n                // Update existing\r\n                await supabase\r\n                    .from('distribution_releases')\r\n                    .update(payload)\r\n                    .eq('id', initialData.id)\r\n                    .eq('uploader_id', userId);\r\n            } else {\r\n                // Create new\r\n                await supabase\r\n                    .from('distribution_releases')\r\n                    .insert({\r\n                        ...payload,\r\n                        created_at: new Date().toISOString()\r\n                    });\r\n            }\r\n            \r\n            alert(\"Release submitted successfully! It is now in the review queue.\");\r\n            onSuccess();\r\n        } catch (e) {\r\n            console.error(\"Submission error:\", e);\r\n            alert(\"Failed to submit release.\");\r\n        }\r\n        setSubmitting(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"max-w-4xl mx-auto bg-white dark:bg-[#2c2e36] rounded-2xl shadow-xl overflow-hidden border dark:border-gray-700 min-h-[600px] flex flex-col\">\r\n            {/* Header */}\r\n            <div className=\"bg-gray-50 dark:bg-[#23262f] p-6 border-b dark:border-gray-700 flex justify-between items-center\">\r\n                <div>\r\n                    <h2 className=\"text-xl font-extrabold dark:text-white\">New Release</h2>\r\n                    <p className=\"text-xs text-gray-500 uppercase font-bold tracking-wider mt-1\">Step {step} of 4</p>\r\n                </div>\r\n                <button onClick={onCancel} className=\"text-gray-400 hover:text-gray-600 dark:hover:text-white\"><X/></button>\r\n            </div>\r\n\r\n            {/* Progress Bar */}\r\n            <div className=\"h-1 bg-gray-200 dark:bg-gray-700 w-full\">\r\n                <div className=\"h-full bg-brand-blue transition-all duration-300\" style={{ width: `${(step / 4) * 100}%` }}></div>\r\n            </div>\r\n\r\n            {/* Body */}\r\n            <div className=\"flex-1 p-8 overflow-y-auto\">\r\n                {step === 1 && <Step1Metadata data={formData} setData={setFormData} />}\r\n                {step === 2 && <Step2Artwork data={formData} setData={setFormData} user={user} />}\r\n                {step === 3 && <Step3Tracks data={formData} setData={setFormData} user={user} />}\r\n                {step === 4 && <Step4Stores data={formData} setData={setFormData} />}\r\n            </div>\r\n\r\n            {/* Footer Controls */}\r\n            <div className=\"p-6 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] flex justify-between items-center\">\r\n                {step > 1 ? (\r\n                    <button onClick={() => setStep(step - 1)} className=\"flex items-center gap-2 text-gray-500 font-bold hover:text-gray-800 dark:hover:text-white transition\">\r\n                        <ChevronLeft size={18}/> Back\r\n                    </button>\r\n                ) : <div></div>}\r\n\r\n                {step < 4 ? (\r\n                    <button \r\n                        onClick={() => setStep(step + 1)} \r\n                        disabled={!isStepValid()}\r\n                        className=\"bg-brand-blue text-white px-6 py-2.5 rounded-xl font-bold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-blue-600 transition\"\r\n                    >\r\n                        Next Step <ChevronRight size={18}/>\r\n                    </button>\r\n                ) : (\r\n                    <button \r\n                        onClick={handleFinalSubmit} \r\n                        disabled={submitting || !isStepValid()}\r\n                        className=\"bg-green-600 text-white px-8 py-2.5 rounded-xl font-bold flex items-center gap-2 disabled:opacity-50 hover:bg-green-700 transition shadow-lg\"\r\n                    >\r\n                        {submitting ? <Loader2 className=\"animate-spin\"/> : \"Submit Release\"}\r\n                    </button>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Plus, Disc, Globe, AlertCircle, CheckCircle, Clock, Edit2, Trash2, X, Music } from 'lucide-react';\r\nimport { supabase } from '../../config/supabase';\r\nimport ReleaseBuilder from '../distribution/ReleaseBuilder';\r\n\r\nexport default function DistributionManager({ user, userData }) {\r\n    const [view, setView] = useState('list'); // 'list' or 'create'\r\n    const [releases, setReleases] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [editingRelease, setEditingRelease] = useState(null);\r\n\r\n    // Fetch User's Releases\r\n    useEffect(() => {\r\n        if (!user?.id && !user?.uid || !supabase) return;\r\n        const userId = user?.id || user?.uid;\r\n        \r\n        // Query releases where the current user is the primary artist/uploader\r\n        const channel = supabase\r\n            .channel('distribution-releases')\r\n            .on('postgres_changes', {\r\n                event: '*',\r\n                schema: 'public',\r\n                table: 'distribution_releases',\r\n                filter: `uploader_id=eq.${userId}`\r\n            }, (payload) => {\r\n                loadReleases();\r\n            })\r\n            .subscribe();\r\n\r\n        loadReleases();\r\n\r\n        return () => {\r\n            supabase.removeChannel(channel);\r\n        };\r\n    }, [user?.id, user?.uid]);\r\n\r\n    const loadReleases = async () => {\r\n        if (!supabase) return;\r\n        const userId = user?.id || user?.uid;\r\n        setLoading(true);\r\n        try {\r\n            const { data: releasesData, error } = await supabase\r\n                .from('distribution_releases')\r\n                .select('*')\r\n                .eq('uploader_id', userId)\r\n                .order('updated_at', { ascending: false });\r\n            \r\n            if (error) throw error;\r\n            \r\n            setReleases((releasesData || []).map(r => ({\r\n                id: r.id,\r\n                ...r,\r\n                uploaderId: r.uploader_id,\r\n                updatedAt: r.updated_at,\r\n                createdAt: r.created_at\r\n            })));\r\n        } catch (error) {\r\n            console.error('Error loading releases:', error);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleDelete = async (releaseId, title) => {\r\n        if (!confirm(`Are you sure you want to delete \"${title}\"? This cannot be undone if already distributed.`) || !supabase) return;\r\n        try {\r\n            await supabase\r\n                .from('distribution_releases')\r\n                .delete()\r\n                .eq('id', releaseId);\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Failed to delete release.\");\r\n        }\r\n    };\r\n\r\n    const handleEdit = (release) => {\r\n        if (release.status !== 'Draft' && release.status !== 'Action Needed') {\r\n            return alert(\"Cannot edit a release that is currently processing or live. Contact support for takedowns.\");\r\n        }\r\n        setEditingRelease(release);\r\n        setView('create');\r\n    };\r\n\r\n    // --- RENDER ---\r\n\r\n    if (view === 'create') {\r\n        return (\r\n            <ReleaseBuilder \r\n                user={user} \r\n                userData={userData} \r\n                initialData={editingRelease}\r\n                onCancel={() => { setView('list'); setEditingRelease(null); }} \r\n                onSuccess={() => { setView('list'); setEditingRelease(null); }}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"max-w-6xl mx-auto space-y-6 animate-in fade-in\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-end gap-4 bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold dark:text-white flex items-center gap-2\">\r\n                        <Globe className=\"text-brand-blue\" /> Distribution Portal\r\n                    </h2>\r\n                    <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\r\n                        Manage your catalog across Spotify, Apple Music, and 150+ stores.\r\n                    </p>\r\n                </div>\r\n                <button \r\n                    onClick={() => setView('create')} \r\n                    className=\"bg-brand-blue text-white px-6 py-3 rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 shadow-lg hover:shadow-blue-500/20\"\r\n                >\r\n                    <Plus size={20} /> New Release\r\n                </button>\r\n            </div>\r\n\r\n            {/* Release List */}\r\n            <div className=\"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 overflow-hidden min-h-[400px]\">\r\n                {loading ? (\r\n                    <div className=\"p-12 text-center text-gray-500\">Loading catalog...</div>\r\n                ) : releases.length === 0 ? (\r\n                    <div className=\"flex flex-col items-center justify-center py-20 text-center\">\r\n                        <div className=\"bg-gray-100 dark:bg-gray-800 p-6 rounded-full mb-4\">\r\n                            <Disc size={48} className=\"text-gray-400\" />\r\n                        </div>\r\n                        <h3 className=\"text-lg font-bold dark:text-white\">No Releases Yet</h3>\r\n                        <p className=\"text-gray-500 max-w-sm mt-2 mb-6\">Start your journey by uploading your first single, EP, or album to the world.</p>\r\n                        <button onClick={() => setView('create')} className=\"text-brand-blue font-bold hover:underline\">\r\n                            Create First Release\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"divide-y dark:divide-gray-700\">\r\n                        {releases.map(release => (\r\n                            <div key={release.id} className=\"p-5 hover:bg-gray-50 dark:hover:bg-white/5 transition flex flex-col md:flex-row md:items-center justify-between gap-4 group\">\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    {/* Artwork Thumbnail */}\r\n                                    <div className=\"h-16 w-16 bg-gray-200 dark:bg-black rounded-lg shadow-sm overflow-hidden shrink-0 border dark:border-gray-700\">\r\n                                        {release.artworkUrl ? (\r\n                                            <img src={release.artworkUrl} alt=\"Art\" className=\"h-full w-full object-cover\" />\r\n                                        ) : (\r\n                                            <div className=\"h-full w-full flex items-center justify-center text-gray-400\"><Music size={20}/></div>\r\n                                        )}\r\n                                    </div>\r\n                                    \r\n                                    {/* Meta */}\r\n                                    <div>\r\n                                        <div className=\"flex items-center gap-2 mb-1\">\r\n                                            <span className={`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide border ${\r\n                                                release.status === 'Live' ? 'bg-green-100 text-green-700 border-green-200' :\r\n                                                release.status === 'Processing' ? 'bg-blue-100 text-blue-700 border-blue-200' :\r\n                                                release.status === 'Action Needed' ? 'bg-red-100 text-red-700 border-red-200' :\r\n                                                'bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600'\r\n                                            }`}>\r\n                                                {release.status}\r\n                                            </span>\r\n                                            <span className=\"text-xs text-gray-400 uppercase font-bold\">{release.type}</span>\r\n                                        </div>\r\n                                        <h4 className=\"font-bold text-lg dark:text-white leading-tight\">{release.title || 'Untitled Release'}</h4>\r\n                                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                            {release.primaryArtist} • {release.tracks?.length || 0} Tracks\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Actions */}\r\n                                <div className=\"flex items-center gap-4 pl-4 md:pl-0 border-l md:border-l-0 dark:border-gray-700\">\r\n                                    <div className=\"text-right hidden md:block mr-4\">\r\n                                        <div className=\"text-xs text-gray-400 uppercase font-bold\">Release Date</div>\r\n                                        <div className=\"text-sm font-medium dark:text-gray-200\">\r\n                                            {release.releaseDate ? new Date(release.releaseDate).toLocaleDateString() : 'TBD'}\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    <button \r\n                                        onClick={() => handleEdit(release)}\r\n                                        className=\"p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition\"\r\n                                        title=\"Edit / View Details\"\r\n                                    >\r\n                                        <Edit2 size={18}/>\r\n                                    </button>\r\n                                    \r\n                                    {(release.status === 'Draft' || release.status === 'Action Needed') && (\r\n                                        <button \r\n                                            onClick={() => handleDelete(release.id, release.title)}\r\n                                            className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition\"\r\n                                            title=\"Delete Release\"\r\n                                        >\r\n                                            <Trash2 size={18}/>\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { \r\n    Briefcase, Home, Globe, Users, ChevronRight, \r\n    Building2, Music2, BarChart3, Settings2\r\n} from 'lucide-react';\r\n\r\n// Import business components\r\nimport StudioManager from './StudioManager';\r\nimport LabelManager from './LabelManager';\r\nimport DistributionManager from './marketplace/DistributionManager';\r\n\r\n/**\r\n * BusinessCenter - Consolidated hub for all business-related features\r\n * \r\n * Tabs:\r\n * 1. Studio Operations - Manage studio settings, rooms, amenities\r\n * 2. Distribution - Music distribution to streaming platforms\r\n * 3. Label/Roster - Manage artist roster (for labels/agents)\r\n */\r\nexport default function BusinessCenter({ user, userData }) {\r\n    const [activeTab, setActiveTab] = useState('overview');\r\n\r\n    // Determine which features the user has access to\r\n    const isStudio = userData?.accountTypes?.includes('Studio');\r\n    const isLabel = userData?.accountTypes?.some(t => ['Label', 'Agent'].includes(t));\r\n    const isArtist = userData?.accountTypes?.some(t => ['Talent', 'Producer', 'Engineer'].includes(t));\r\n    \r\n    // Everyone with business features gets distribution access\r\n    const hasDistribution = isStudio || isLabel || isArtist;\r\n\r\n    // Build available tabs based on user roles\r\n    const tabs = [\r\n        { \r\n            id: 'overview', \r\n            label: 'Overview', \r\n            icon: <Briefcase size={18} />,\r\n            available: true\r\n        },\r\n        { \r\n            id: 'studio', \r\n            label: 'Studio Ops', \r\n            icon: <Home size={18} />,\r\n            available: isStudio,\r\n            description: 'Manage rooms, rates & amenities'\r\n        },\r\n        { \r\n            id: 'distribution', \r\n            label: 'Distribution', \r\n            icon: <Globe size={18} />,\r\n            available: hasDistribution,\r\n            description: 'Release music to streaming platforms'\r\n        },\r\n        { \r\n            id: 'roster', \r\n            label: 'Artist Roster', \r\n            icon: <Users size={18} />,\r\n            available: isLabel,\r\n            description: 'Manage your signed artists'\r\n        },\r\n    ].filter(tab => tab.available);\r\n\r\n    // Stats for overview\r\n    const stats = [\r\n        { label: 'Account Type', value: userData?.accountTypes?.join(', ') || 'User', icon: <Building2 size={16} /> },\r\n        { label: 'Studio Rooms', value: userData?.rooms?.length || 0, icon: <Home size={16} />, show: isStudio },\r\n        { label: 'Releases', value: '—', icon: <Music2 size={16} />, show: hasDistribution },\r\n        { label: 'Roster Artists', value: '—', icon: <Users size={16} />, show: isLabel },\r\n    ].filter(s => s.show !== false);\r\n\r\n    // Quick actions based on roles\r\n    const quickActions = [\r\n        { \r\n            id: 'studio', \r\n            title: 'Studio Settings', \r\n            description: 'Configure your studio rooms, rates, and amenities',\r\n            icon: <Home className=\"text-blue-500\" />,\r\n            color: 'blue',\r\n            show: isStudio\r\n        },\r\n        { \r\n            id: 'distribution', \r\n            title: 'New Release', \r\n            description: 'Distribute your music to 150+ streaming platforms',\r\n            icon: <Globe className=\"text-green-500\" />,\r\n            color: 'green',\r\n            show: hasDistribution\r\n        },\r\n        { \r\n            id: 'roster', \r\n            title: 'Manage Roster', \r\n            description: 'Sign artists and manage your label roster',\r\n            icon: <Users className=\"text-purple-500\" />,\r\n            color: 'purple',\r\n            show: isLabel\r\n        },\r\n    ].filter(a => a.show);\r\n\r\n    // Render content based on active tab\r\n    const renderContent = () => {\r\n        switch (activeTab) {\r\n            case 'studio':\r\n                return <StudioManager user={user} userData={userData} />;\r\n            case 'distribution':\r\n                return <DistributionManager user={user} userData={userData} />;\r\n            case 'roster':\r\n                return <LabelManager user={user} userData={userData} />;\r\n            case 'overview':\r\n            default:\r\n                return (\r\n                    <div className=\"space-y-6 animate-in fade-in\">\r\n                        {/* Welcome Header */}\r\n                        <div className=\"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-8 text-white relative overflow-hidden\">\r\n                            <div className=\"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10\"></div>\r\n                            <div className=\"relative z-10\">\r\n                                <h1 className=\"text-3xl font-bold mb-2\">Business Center</h1>\r\n                                <p className=\"text-indigo-100 max-w-xl\">\r\n                                    Manage your studio operations, distribute music, and grow your roster — all in one place.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Stats Grid */}\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                            {stats.map((stat, i) => (\r\n                                <div key={i} className=\"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm\">\r\n                                    <div className=\"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2\">\r\n                                        {stat.icon}\r\n                                        <span className=\"text-xs font-bold uppercase tracking-wide\">{stat.label}</span>\r\n                                    </div>\r\n                                    <div className=\"text-2xl font-bold dark:text-white\">{stat.value}</div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n\r\n                        {/* Quick Actions */}\r\n                        {quickActions.length > 0 && (\r\n                            <div>\r\n                                <h2 className=\"text-lg font-bold dark:text-white mb-4 flex items-center gap-2\">\r\n                                    <Settings2 size={20} className=\"text-gray-400\" />\r\n                                    Quick Actions\r\n                                </h2>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                                    {quickActions.map(action => (\r\n                                        <button\r\n                                            key={action.id}\r\n                                            onClick={() => setActiveTab(action.id)}\r\n                                            className=\"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm hover:shadow-md transition-all text-left group hover:border-brand-blue dark:hover:border-brand-blue\"\r\n                                        >\r\n                                            <div className={`w-12 h-12 rounded-xl bg-${action.color}-50 dark:bg-${action.color}-900/20 flex items-center justify-center mb-4`}>\r\n                                                {action.icon}\r\n                                            </div>\r\n                                            <h3 className=\"font-bold dark:text-white mb-1 flex items-center gap-2\">\r\n                                                {action.title}\r\n                                                <ChevronRight size={16} className=\"text-gray-400 group-hover:text-brand-blue group-hover:translate-x-1 transition-all\" />\r\n                                            </h3>\r\n                                            <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                                {action.description}\r\n                                            </p>\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* No Business Features Message */}\r\n                        {quickActions.length === 0 && (\r\n                            <div className=\"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-12 text-center\">\r\n                                <div className=\"w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                                    <Briefcase size={32} className=\"text-gray-400\" />\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold dark:text-white mb-2\">No Business Features Enabled</h3>\r\n                                <p className=\"text-gray-500 dark:text-gray-400 max-w-md mx-auto mb-6\">\r\n                                    Upgrade your account to access studio management, music distribution, and label features.\r\n                                </p>\r\n                                <p className=\"text-sm text-gray-400\">\r\n                                    Update your profile to add \"Studio\", \"Talent\", \"Label\", or \"Agent\" account types.\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Features Coming Soon */}\r\n                        <div className=\"bg-gray-50 dark:bg-[#1f2128] rounded-xl p-6 border dark:border-gray-700\">\r\n                            <h3 className=\"font-bold dark:text-white mb-3 flex items-center gap-2\">\r\n                                <BarChart3 size={18} className=\"text-brand-blue\" />\r\n                                Coming Soon\r\n                            </h3>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                                <div className=\"flex items-center gap-2 text-gray-600 dark:text-gray-400\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-brand-blue\"></div>\r\n                                    Advanced Analytics Dashboard\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-gray-600 dark:text-gray-400\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-brand-blue\"></div>\r\n                                    Royalty Management & Splits\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-gray-600 dark:text-gray-400\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-brand-blue\"></div>\r\n                                    Contract Templates\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-gray-600 dark:text-gray-400\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-brand-blue\"></div>\r\n                                    Multi-Artist Collaboration Tools\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"max-w-7xl mx-auto pb-20\">\r\n            {/* Tab Navigation */}\r\n            <div className=\"mb-6 bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 p-1.5 flex flex-wrap gap-1 shadow-sm sticky top-0 z-10\">\r\n                {tabs.map(tab => (\r\n                    <button\r\n                        key={tab.id}\r\n                        onClick={() => setActiveTab(tab.id)}\r\n                        className={`\r\n                            flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all\r\n                            ${activeTab === tab.id \r\n                                ? 'bg-brand-blue text-white shadow-md' \r\n                                : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'\r\n                            }\r\n                        `}\r\n                    >\r\n                        {tab.icon}\r\n                        <span className=\"hidden sm:inline\">{tab.label}</span>\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Content Area */}\r\n            {renderContent()}\r\n        </div>\r\n    );\r\n}\r\n"],"names":["StudioOverview","userData","stats","onNavigate","currentDate","setCurrentDate","useState","studioName","rooms","amenities","totalCapacity","sum","r","avgRate","quickStats","jsx","Home","Users","DollarSign","Star","pendingBookings","jsxs","MapPin","stat","i","AlertCircle","Calendar","CheckCircle","room","amenity","ChevronLeft","ChevronRight","MiniCalendar","_a","booking","bookings","year","month","today","firstDay","daysInMonth","days","getDayBookings","day","b","bookingDate","isToday","dayNames","dayBookings","hasBookings","hasConfirmed","hasPending","SNAP_GRID","getDistanceToLineSegment","px","py","x1","y1","x2","y2","A","B","C","D","dot","len_sq","param","xx","yy","dx","dy","FloorplanEditor","propWalls","propStructures","onRoomClick","onLayoutChange","onWallsChange","onStructuresChange","svgRef","useRef","isDragging","setIsDragging","isResizing","setIsResizing","cursorOffset","setCursorOffset","activeRoomId","setActiveRoomId","activeStructureId","setActiveStructureId","activeWallId","setActiveWallId","draggingWallHandle","setDraggingWallHandle","walls","setWalls","structures","setStructures","clipboard","setClipboard","activeTool","setActiveTool","wallStartPoint","setWallStartPoint","width","height","useEffect","getCoords","e","rect","clientX","clientY","x","y","commitWalls","newWalls","commitStructures","newStructures","handleDelete","useCallback","newStructs","s","w","handleCopy","item","handlePaste","offset","newStruct","newWall","handleCut","handleKeyDown","startDragRoom","startResizeRoom","direction","addStructure","startDragStructure","struct","startResizeStructure","startDragWallHandle","wallId","point","selectWall","handleMouseMove","previewWall","prev","newPos","newDims","stopInteraction","handleCanvasClick","updatedWalls","setTool","tool","WallSegment","wall","isPreview","isSelected","Fragment","LayoutShape","data","isStructure","onClick","layout","name","rate","label","isActive","checkCornerLocked","cx","cy","tlSharp","trSharp","brSharp","blSharp","pathD","Copy","Clipboard","Scissors","Trash2","BoxSelect","Zap","rm","newLabel","StudioRooms","user","onUpdate","setRooms","editingRoom","setEditingRoom","isAdding","setIsAdding","saving","setSaving","expandedRoom","setExpandedRoom","viewMode","setViewMode","emptyRoom","handleSave","updatedRooms","updatedStructures","handleLayoutChange","roomId","newLayout","handleWallsChange","handleStructuresChange","handleRoomClick","roomIndex","handleEditRoom","handleAddRoom","index","handleSaveRoom","toast","handleDeleteRoom","_","handleDuplicateRoom","roomToCopy","handleCancelEdit","ROOM_AMENITIES","roomsWithLayout","LayoutGrid","List","Map","Plus","RoomEditor","Mic","Edit2","ChevronUp","ChevronDown","setRoom","onSave","onCancel","isNew","roomAmenities","handleAmenityToggle","current","a","EquipmentAutocomplete","val","Loader2","Save","StudioGallery","photos","setPhotos","uploadProgress","setUploadProgress","selectedPhoto","setSelectedPhoto","draggingIndex","setDraggingIndex","uploadMedia","uploading","useMediaUpload","userId","savePhotos","updatedPhotos","handleUpload","files","maxPhotos","toastId","newPhotos","file","timestamp","result","error","photoIndex","photo","p","handleSetCover","handleDragStart","handleDragOver","reorderedPhotos","draggedPhoto","handleDragEnd","handleFileDrop","coverPhoto","Image","Upload","Eye","Move","X","DAYS_OF_WEEK","DEFAULT_HOURS","StudioAvailability","hours","setHours","blackoutDates","setBlackoutDates","newBlackout","setNewBlackout","showAddBlackout","setShowAddBlackout","updateDayHours","dayId","field","value","toggleDayClosed","copyToAllWeekdays","sourceHours","weekdays","newHours","addBlackoutDate","blackout","removeBlackoutDate","id","formatTime","time","h","m","hour","ampm","totalWeeklyHours","total","dayHours","openH","openM","closeH","closeM","openMinutes","closeMinutes","Clock","d","Sun","Moon","StudioPolicies","policies","setPolicies","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","_q","_r","_s","_t","_u","expandedSection","setExpandedSection","updatePolicy","key","CANCELLATION_POLICIES","Section","title","Icon","children","isExpanded","FileText","AlertTriangle","policy","Shield","STATUS_CONFIG","Clock3","XCircle","Check","StudioBookings","onNavigateToChat","setBookings","blockedDates","setBlockedDates","loading","setLoading","filter","setFilter","searchTerm","setSearchTerm","selectedBooking","setSelectedBooking","updating","setUpdating","currentMonth","setCurrentMonth","showBlockModal","setShowBlockModal","selectedDate","setSelectedDate","blockReason","setBlockReason","blockTimeSlot","setBlockTimeSlot","customStartTime","setCustomStartTime","customEndTime","setCustomEndTime","supabase","handleUpdateStatus","bookingId","newStatus","handleBlockDate","handleUnblockDate","blockedId","openBlockModal","date","filteredBookings","matchesFilter","matchesSearch","groupedBookings","groups","dateKey","pendingCount","todayBookings","upcomingRevenue","RefreshCw","Search","status","isPast","dayBlocks","isBlocked","Ban","block","dateBookings","statusConfig","MessageSquare","slot","User","StudioEquipment","equipment","setEquipment","categoryFilter","setCategoryFilter","showAddModal","setShowAddModal","editingItem","setEditingItem","updatedEquipment","handleAddItem","newItem","itemWithId","handleUpdateItem","updatedItem","handleDeleteItem","itemId","filteredEquipment","matchesCategory","groupedEquipment","cat","categories","totalItems","totalValue","getCategoryIcon","category","Speaker","Monitor","Server","Package","getCategoryLabel","categoryId","EQUIP_CATEGORIES","c","items","CategoryIcon","EquipmentModal","onClose","formData","setFormData","handleSubmit","handleAutocompleteSelect","selected","settingsSchema","z.object","z.string","z.number","z.literal","z.array","z.boolean","StudioSettings","register","control","watch","setValue","errors","isDirty","useForm","zodResolver","watchedAmenities","watchHideAddress","toggleAmenity","onSubmit","inputClass","Settings","Controller","onChange","AddressAutocomplete","addressData","EyeOff","Mail","Wifi","AMENITIES_DATA","TABS","StudioManager","activeTab","setActiveTab","setStats","localUserData","setLocalUserData","handleUpdate","updates","handleNavigate","tabId","renderContent","commonProps","activeTabInfo","t","Briefcase","tab","hasBadge","LabelManager","roster","setRoster","searchQuery","setSearchQuery","searchResults","setSearchResults","searching","setSearching","view","setView","handleSearch","signArtist","artist","releaseArtist","rosterId","UserPlus","Step1Metadata","setData","RELEASE_TYPES","DDEX_GENRES","g","Step2Artwork","uploadImage","preview","setPreview","validationMsg","setValidationMsg","handleFile","img","res","ImageIcon","Step3Tracks","addTrack","newTrack","updatedTracks","finalTracks","removeTrack","updateTrackMeta","track","idx","Step4Stores","toggleStore","storeId","updated","toggleAll","DISTRIBUTION_STORES","store","Info","ReleaseBuilder","initialData","onSuccess","step","setStep","submitting","setSubmitting","isStepValid","handleFinalSubmit","DistributionManager","releases","setReleases","editingRelease","setEditingRelease","releaseId","handleEdit","release","Globe","Disc","Music","BusinessCenter","isStudio","isLabel","isArtist","hasDistribution","tabs","Building2","Music2","quickActions","Settings2","action","BarChart3"],"mappings":"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"}