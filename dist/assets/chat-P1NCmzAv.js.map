{"version":3,"file":"chat-P1NCmzAv.js","sources":["../../src/i18n/translations.js","../../src/contexts/LanguageContext.jsx","../../src/config/convex.js","../../src/config/vercel-blob.js","../../src/components/shared/UserAvatar.jsx","../../convex/_generated/api.js","../../src/hooks/usePresence.js","../../src/components/chat/PresenceIndicator.jsx","../../src/components/chat/ConversationItem.jsx","../../src/components/shared/ProfileSelectionModal.jsx","../../src/components/chat/ChatSidebar.jsx","../../src/hooks/useMediaUpload.js","../../src/components/chat/media/EmojiPicker.jsx","../../src/components/chat/media/GifPicker.jsx","../../src/components/chat/media/VideoRecorder.jsx","../../src/hooks/useTypingIndicator.js","../../src/components/chat/ChatInput.jsx","../../src/components/ui/button.jsx","../../src/components/SeshNxEmbedModal.jsx","../../src/components/chat/message/MessageStatus.jsx","../../src/components/chat/media/AudioWaveform.jsx","../../src/components/chat/message/MessageBubble.jsx","../../src/components/chat/message/ForwardMessageModal.jsx","../../src/hooks/useReadReceipts.js","../../src/utils/linkPreview.js","../../src/components/chat/ChatWindow.jsx","../../src/components/shared/StatCard.jsx","../../src/components/chat/media/MediaGallery.jsx","../../src/components/chat/ChatDetailsPane.jsx"],"sourcesContent":["// Translation files for multi-language support\r\n\r\nexport const translations = {\r\n  en: {\r\n    // General\r\n    general: 'General',\r\n    security: 'Security & Privacy',\r\n    notifications: 'Notifications',\r\n    messaging: 'Messaging',\r\n    social: 'Social & Feed',\r\n    bookings: 'Bookings',\r\n    marketplace: 'Marketplace',\r\n    content: 'Content & Media',\r\n    accessibility: 'Accessibility',\r\n    performance: 'Performance',\r\n    \r\n    // Roles & Workflow\r\n    rolesWorkflow: 'Roles & Workflow',\r\n    activeAccountTypes: 'Active Account Types',\r\n    preferredProfile: 'Preferred Profile',\r\n    activeWorkflowContext: 'Active Workflow Context',\r\n    seeAllUnfiltered: 'See All (Unfiltered View)',\r\n    seeAllDescription: 'Show all content types regardless of active workflow',\r\n    saveWorkflowSettings: 'Save Workflow Settings',\r\n    \r\n    // Appearance\r\n    appearance: 'Appearance',\r\n    light: 'Light',\r\n    dark: 'Dark',\r\n    system: 'System',\r\n    \r\n    // Language & Localization\r\n    languageLocalization: 'Language & Localization',\r\n    language: 'Language',\r\n    dateFormat: 'Date Format',\r\n    timeFormat: 'Time Format',\r\n    timezone: 'Timezone',\r\n    currency: 'Currency',\r\n    numberFormat: 'Number Format',\r\n    autoDetect: 'Auto-detect',\r\n    easternTime: 'Eastern Time',\r\n    centralTime: 'Central Time',\r\n    mountainTime: 'Mountain Time',\r\n    pacificTime: 'Pacific Time',\r\n    \r\n    // Security\r\n    accountSecurity: 'Account Security',\r\n    emailAddress: 'Email Address',\r\n    password: 'Password',\r\n    changeEmail: 'Change Email',\r\n    changePassword: 'Change Password',\r\n    twoFactorAuth: 'Two-Factor Authentication (2FA)',\r\n    twoFactorDescription: 'Add an extra layer of security to your account',\r\n    lastChanged: 'Last changed',\r\n    unknown: 'Unknown',\r\n    \r\n    // Privacy\r\n    privacyVisibility: 'Privacy & Visibility',\r\n    publicProfileVisibility: 'Public Profile Visibility',\r\n    showLocationOnMap: 'Show Location on Map',\r\n    hideProfileCompletely: 'Hide Profile Completely',\r\n    showEmailAddress: 'Show Email Address',\r\n    showPhoneNumber: 'Show Phone Number',\r\n    showOnlineStatus: 'Show Online Status',\r\n    showLastSeen: 'Show Last Seen',\r\n    allowSearchEngines: 'Allow Search Engine Indexing',\r\n    allowTagging: 'Allow Tagging',\r\n    reviewTagsBeforeAppear: 'Review Tags Before They Appear',\r\n    showFollowingList: 'Show Following List',\r\n    showFollowersList: 'Show Followers List',\r\n    \r\n    // Content & Safety\r\n    contentSafety: 'Content & Safety',\r\n    blockedUsers: 'Blocked Users',\r\n    mutedThreads: 'Muted Threads',\r\n    noActive: 'No active',\r\n    \r\n    // Data Export\r\n    yourData: 'Your Data',\r\n    downloadDataDescription: 'Download a copy of your personal data (GDPR/CCPA).',\r\n    downloadData: 'Download Data',\r\n    \r\n    // Danger Zone\r\n    dangerZone: 'Danger Zone',\r\n    deleteAccountWarning: 'Deleting your account is permanent. This action will remove your profile, posts, and messages.',\r\n    deleteAccount: 'Delete Account',\r\n    confirmDeletion: 'Confirm Deletion',\r\n    typeDeleteToConfirm: 'Type DELETE below to confirm. This cannot be undone.',\r\n    confirmDelete: 'Confirm Delete',\r\n    cancel: 'Cancel',\r\n    \r\n    // Notifications\r\n    generalNotifications: 'General Notifications',\r\n    emailNotifications: 'Email Notifications',\r\n    pushNotifications: 'Push Notifications',\r\n    marketingUpdates: 'Marketing & Updates',\r\n    soundNotifications: 'Sound Notifications',\r\n    badgeCount: 'Badge Count',\r\n    badgeCountDescription: 'Show unread count on app icon',\r\n    bookingNotifications: 'Booking Notifications',\r\n    newBookingRequests: 'New Booking Requests',\r\n    bookingConfirmations: 'Booking Confirmations',\r\n    bookingReminders: 'Booking Reminders',\r\n    bookingCancellations: 'Booking Cancellations',\r\n    socialNotifications: 'Social Notifications',\r\n    likes: 'Likes',\r\n    comments: 'Comments',\r\n    follows: 'Follows',\r\n    mentions: 'Mentions',\r\n    reposts: 'Reposts',\r\n    marketplaceNotifications: 'Marketplace Notifications',\r\n    newOffers: 'New Offers',\r\n    sales: 'Sales',\r\n    messages: 'Messages',\r\n    systemNotifications: 'System Notifications',\r\n    maintenanceAlerts: 'Maintenance Alerts',\r\n    updates: 'Updates',\r\n    securityAlerts: 'Security Alerts',\r\n    quietHours: 'Quiet Hours',\r\n    enableQuietHours: 'Enable Quiet Hours',\r\n    quietHoursDescription: 'Disable notifications during specific times',\r\n    startTime: 'Start Time',\r\n    endTime: 'End Time',\r\n    \r\n    // Messaging\r\n    readReceipts: 'Read Receipts',\r\n    readReceiptsDescription: 'Show when messages are read',\r\n    typingIndicators: 'Typing Indicators',\r\n    typingIndicatorsDescription: 'Show when someone is typing',\r\n    messageRequests: 'Message Requests',\r\n    messageRequestsDescription: 'Require approval for messages from non-contacts',\r\n    whoCanMessageYou: 'Who Can Message You',\r\n    everyone: 'Everyone',\r\n    followersOnly: 'Followers Only',\r\n    noOne: 'No One',\r\n    autoArchiveOld: 'Auto-archive Old Conversations',\r\n    autoArchiveDescription: 'Automatically archive conversations older than 30 days',\r\n    soundNotificationsMessages: 'Sound Notifications for Messages',\r\n    messagePreview: 'Message Preview in Notifications',\r\n    messagePreviewDescription: 'Show message content in notifications',\r\n    blockedContacts: 'Blocked Contacts',\r\n    \r\n    // Social & Feed\r\n    feedAlgorithm: 'Feed Algorithm',\r\n    chronological: 'Chronological',\r\n    recommended: 'Recommended',\r\n    followingOnly: 'Following Only',\r\n    autoPlayVideos: 'Auto-play Videos in Feed',\r\n    showSensitiveContentWarning: 'Show Sensitive Content Warning',\r\n    showActivityStatus: 'Show Activity Status',\r\n    showActivityStatusDescription: 'Let others see when you\\'re active',\r\n    showSuggestedAccounts: 'Show Suggested Accounts',\r\n    contentFiltering: 'Content Filtering',\r\n    sensitivityFilter: 'Sensitivity Filter',\r\n    off: 'Off',\r\n    low: 'Low',\r\n    medium: 'Medium',\r\n    high: 'High',\r\n    autoHideReported: 'Auto-hide Reported Content',\r\n    showAgeRestricted: 'Show Age-Restricted Content',\r\n    mutedUsers: 'Muted Users',\r\n    \r\n    // Bookings\r\n    autoAcceptBookings: 'Auto-accept Bookings',\r\n    autoAcceptDescription: 'Automatically accept bookings that meet your criteria',\r\n    defaultBufferTime: 'Default Buffer Time',\r\n    bufferTimeDescription: 'Time between sessions',\r\n    minutes: 'minutes',\r\n    showAvailabilityPublicly: 'Show Availability Calendar Publicly',\r\n    requireDeposit: 'Require Deposit for Bookings',\r\n    autoDeclineExpired: 'Auto-decline Expired Booking Requests',\r\n    defaultSessionDuration: 'Default Session Duration',\r\n    \r\n    // Marketplace\r\n    autoListItem: 'Auto-list Items',\r\n    autoListDescription: 'Automatically list items for sale',\r\n    requireApproval: 'Require Approval',\r\n    requireApprovalDescription: 'Review items before they go live',\r\n    defaultShippingMethod: 'Default Shipping Method',\r\n    defaultPaymentTerms: 'Default Payment Terms',\r\n    immediate: 'Immediate',\r\n    net15: 'Net 15',\r\n    net30: 'Net 30',\r\n    autoAcceptOffersAbove: 'Auto-accept Offers Above Threshold',\r\n    autoAcceptThreshold: 'Auto-accept Threshold',\r\n    showSoldItems: 'Show Sold Items in Listings',\r\n    \r\n    // Content & Media\r\n    imageQuality: 'Image Quality',\r\n    videoQuality: 'Video Quality',\r\n    high: 'High',\r\n    medium: 'Medium',\r\n    low: 'Low (Faster Loading)',\r\n    autoSaveUploaded: 'Auto-save Uploaded Media',\r\n    autoSaveDescription: 'Automatically save uploaded images and videos',\r\n    compressImages: 'Compress Images Before Upload',\r\n    compressDescription: 'Reduce file size for faster uploads',\r\n    maxUploadSize: 'Maximum Upload Size',\r\n    mb: 'MB',\r\n    \r\n    // Accessibility\r\n    fontSize: 'Font Size',\r\n    small: 'Small',\r\n    large: 'Large',\r\n    extraLarge: 'Extra Large',\r\n    reducedMotion: 'Reduced Motion',\r\n    reducedMotionDescription: 'Disable animations for better accessibility',\r\n    highContrast: 'High Contrast Mode',\r\n    highContrastDescription: 'Increase contrast for better visibility',\r\n    screenReaderAnnouncements: 'Screen Reader Announcements',\r\n    screenReaderDescription: 'Enable announcements for screen readers',\r\n    keyboardHints: 'Keyboard Navigation Hints',\r\n    keyboardHintsDescription: 'Show hints for keyboard navigation',\r\n    \r\n    // Performance\r\n    dataUsage: 'Data Usage',\r\n    wifiOnly: 'WiFi Only (for media)',\r\n    auto: 'Auto',\r\n    never: 'Never (save data)',\r\n    offlineMode: 'Offline Mode',\r\n    offlineModeDescription: 'Enable offline functionality',\r\n    backgroundSync: 'Background Sync',\r\n    backgroundSyncDescription: 'Sync data in the background',\r\n    autoClearOldNotifications: 'Auto-clear Old Notifications',\r\n    clearAfter: 'Clear After',\r\n    days: 'days',\r\n    cacheManagement: 'Cache Management',\r\n    clearCache: 'Clear Cache',\r\n    clearCacheDescription: 'Clear cached data to free up storage space',\r\n    \r\n    // Common\r\n    saveAll: 'Save All',\r\n    saving: 'Saving...',\r\n    saved: 'Settings saved successfully!',\r\n    saveFailed: 'Failed to save settings.',\r\n    settingsUpdated: 'Settings updated!',\r\n    \r\n    // Navigation\r\n    dashboard: 'Dashboard',\r\n    socialNx: 'SocialNx',\r\n    messages: 'Messages',\r\n    bookings: 'Bookings',\r\n    marketplace: 'Marketplace',\r\n    techServices: 'Tech Services',\r\n    businessCenter: 'Business Center',\r\n    profile: 'Profile',\r\n    billing: 'Billing',\r\n    settings: 'Settings',\r\n    logout: 'Logout',\r\n    search: 'Search',\r\n    searchPlaceholder: 'Search...',\r\n    notifications: 'Notifications',\r\n    noNotifications: 'No notifications',\r\n    markAllRead: 'Mark all as read',\r\n    clearAll: 'Clear all',\r\n    switchRole: 'Switch Role',\r\n    viewProfile: 'View Profile',\r\n    \r\n    // Dashboard\r\n    goodMorning: 'Good morning',\r\n    goodAfternoon: 'Good afternoon',\r\n    goodEvening: 'Good evening',\r\n    goodNight: 'Good night',\r\n    welcomeBack: 'Welcome back',\r\n    quickActions: 'Quick Actions',\r\n    recentActivity: 'Recent Activity',\r\n    upcomingBookings: 'Upcoming Bookings',\r\n    noUpcomingBookings: 'No upcoming bookings',\r\n    viewAll: 'View All',\r\n    seeMore: 'See More',\r\n    newBooking: 'New Booking',\r\n    viewCalendar: 'View Calendar',\r\n    recentMessages: 'Recent Messages',\r\n    noRecentMessages: 'No recent messages',\r\n    startConversation: 'Start Conversation',\r\n    trendingNow: 'Trending Now',\r\n    viewMarketplace: 'View Marketplace',\r\n    stats: 'Stats',\r\n    followers: 'Followers',\r\n    following: 'Following',\r\n    posts: 'Posts',\r\n    \r\n    // Social Feed\r\n    forYou: 'For You',\r\n    following: 'Following',\r\n    discover: 'Discover',\r\n    createPost: 'Create Post',\r\n    whatOnMind: \"What's on your mind?\",\r\n    post: 'Post',\r\n    like: 'Like',\r\n    comment: 'Comment',\r\n    share: 'Share',\r\n    save: 'Save',\r\n    repost: 'Repost',\r\n    follow: 'Follow',\r\n    unfollow: 'Unfollow',\r\n    noPosts: 'No posts yet',\r\n    beFirst: 'Be the first to share something!',\r\n    noPostsFollowing: 'No recent posts from people you follow',\r\n    browseForYou: 'Browse For You feed →',\r\n    suggestedForYou: 'Suggested for you',\r\n    startFollowing: 'Start following creators',\r\n    followDescription: 'Follow artists, engineers, and studios to see their posts in your Following feed.',\r\n    \r\n    // Messages\r\n    selectConversation: 'Select a conversation to start chatting',\r\n    typeMessage: 'Type a message...',\r\n    send: 'Send',\r\n    online: 'Online',\r\n    offline: 'Offline',\r\n    typing: 'typing...',\r\n    newMessage: 'New Message',\r\n    noConversations: 'No conversations yet',\r\n    \r\n    // Bookings\r\n    myBookings: 'My Bookings',\r\n    calendar: 'Calendar',\r\n    findTalent: 'Find Talent',\r\n    broadcasts: 'Broadcasts',\r\n    createBroadcast: 'Create Broadcast',\r\n    newSession: 'New Session',\r\n    manageSessions: 'Manage your sessions and bookings',\r\n    upcoming: 'Upcoming',\r\n    past: 'Past',\r\n    pending: 'Pending',\r\n    confirmed: 'Confirmed',\r\n    cancelled: 'Cancelled',\r\n    noBookings: 'No bookings found',\r\n    \r\n    // Common Actions\r\n    loading: 'Loading...',\r\n    error: 'Error',\r\n    success: 'Success',\r\n    cancel: 'Cancel',\r\n    confirm: 'Confirm',\r\n    delete: 'Delete',\r\n    edit: 'Edit',\r\n    save: 'Save',\r\n    close: 'Close',\r\n    back: 'Back',\r\n    next: 'Next',\r\n    previous: 'Previous',\r\n    done: 'Done',\r\n    apply: 'Apply',\r\n    reset: 'Reset',\r\n    filter: 'Filter',\r\n    sort: 'Sort',\r\n    refresh: 'Refresh',\r\n    \r\n    // Dashboard Additional\r\n    activityFeed: 'Activity Feed',\r\n    allCaughtUp: 'All caught up!',\r\n    noNewNotifications: 'No new notifications',\r\n    viewAllActivity: 'View All Activity',\r\n    studioStatus: 'Studio Status',\r\n    manage: 'Manage',\r\n    noRoomsConfigured: 'No rooms configured yet',\r\n    addFirstRoom: '+ Add Your First Room',\r\n    new: 'New',\r\n    \r\n    // Marketplace\r\n    gearExchange: 'Gear Exchange',\r\n    seshFxStore: 'SeshFX Store',\r\n    \r\n    // Chat Additional\r\n    searchConversations: 'Search conversations...',\r\n    newGroup: 'New Group',\r\n    groupChat: 'Group Chat',\r\n    directMessage: 'Direct Message',\r\n    addMembers: 'Add Members',\r\n    groupName: 'Group Name',\r\n    createGroup: 'Create Group',\r\n    noMessages: 'No messages yet',\r\n    messageDeleted: 'Message deleted',\r\n    replyingTo: 'Replying to',\r\n    editingMessage: 'Editing message',\r\n    forwardingMessage: 'Forwarding message',\r\n    unknownUser: 'Unknown User',\r\n    dropFiles: 'Drop files here',\r\n    updateMessage: 'Update message',\r\n    noMembersSelected: 'No members selected',\r\n    noUsersFound: 'No users found',\r\n    you: 'You',\r\n    enterGroupName: 'Enter group name',\r\n    \r\n    // Common Status\r\n    active: 'Active',\r\n    inactive: 'Inactive',\r\n    pending: 'Pending',\r\n    completed: 'Completed',\r\n    cancelled: 'Cancelled',\r\n    declined: 'Declined',\r\n    confirmed: 'Confirmed',\r\n  },\r\n  \r\n  es: {\r\n    // General\r\n    general: 'General',\r\n    security: 'Seguridad y Privacidad',\r\n    notifications: 'Notificaciones',\r\n    messaging: 'Mensajería',\r\n    social: 'Social y Feed',\r\n    bookings: 'Reservas',\r\n    marketplace: 'Mercado',\r\n    content: 'Contenido y Medios',\r\n    accessibility: 'Accesibilidad',\r\n    performance: 'Rendimiento',\r\n    \r\n    // Roles & Workflow\r\n    rolesWorkflow: 'Roles y Flujo de Trabajo',\r\n    activeAccountTypes: 'Tipos de Cuenta Activos',\r\n    preferredProfile: 'Perfil Preferido',\r\n    activeWorkflowContext: 'Contexto de Flujo de Trabajo Activo',\r\n    seeAllUnfiltered: 'Ver Todo (Vista Sin Filtros)',\r\n    seeAllDescription: 'Mostrar todos los tipos de contenido independientemente del flujo de trabajo activo',\r\n    saveWorkflowSettings: 'Guardar Configuración de Flujo de Trabajo',\r\n    \r\n    // Appearance\r\n    appearance: 'Apariencia',\r\n    light: 'Claro',\r\n    dark: 'Oscuro',\r\n    system: 'Sistema',\r\n    \r\n    // Language & Localization\r\n    languageLocalization: 'Idioma y Localización',\r\n    language: 'Idioma',\r\n    dateFormat: 'Formato de Fecha',\r\n    timeFormat: 'Formato de Hora',\r\n    timezone: 'Zona Horaria',\r\n    currency: 'Moneda',\r\n    numberFormat: 'Formato de Número',\r\n    autoDetect: 'Detección Automática',\r\n    easternTime: 'Hora del Este',\r\n    centralTime: 'Hora Central',\r\n    mountainTime: 'Hora de la Montaña',\r\n    pacificTime: 'Hora del Pacífico',\r\n    \r\n    // Security\r\n    accountSecurity: 'Seguridad de la Cuenta',\r\n    emailAddress: 'Dirección de Correo',\r\n    password: 'Contraseña',\r\n    changeEmail: 'Cambiar Correo',\r\n    changePassword: 'Cambiar Contraseña',\r\n    twoFactorAuth: 'Autenticación de Dos Factores (2FA)',\r\n    twoFactorDescription: 'Agrega una capa adicional de seguridad a tu cuenta',\r\n    lastChanged: 'Último cambio',\r\n    unknown: 'Desconocido',\r\n    \r\n    // Privacy\r\n    privacyVisibility: 'Privacidad y Visibilidad',\r\n    publicProfileVisibility: 'Visibilidad del Perfil Público',\r\n    showLocationOnMap: 'Mostrar Ubicación en el Mapa',\r\n    hideProfileCompletely: 'Ocultar Perfil Completamente',\r\n    showEmailAddress: 'Mostrar Dirección de Correo',\r\n    showPhoneNumber: 'Mostrar Número de Teléfono',\r\n    showOnlineStatus: 'Mostrar Estado en Línea',\r\n    showLastSeen: 'Mostrar Última Vez',\r\n    allowSearchEngines: 'Permitir Indexación por Motores de Búsqueda',\r\n    allowTagging: 'Permitir Etiquetado',\r\n    reviewTagsBeforeAppear: 'Revisar Etiquetas Antes de Aparecer',\r\n    showFollowingList: 'Mostrar Lista de Seguidos',\r\n    showFollowersList: 'Mostrar Lista de Seguidores',\r\n    \r\n    // Content & Safety\r\n    contentSafety: 'Contenido y Seguridad',\r\n    blockedUsers: 'Usuarios Bloqueados',\r\n    mutedThreads: 'Hilos Silenciados',\r\n    noActive: 'Sin activos',\r\n    \r\n    // Data Export\r\n    yourData: 'Tus Datos',\r\n    downloadDataDescription: 'Descarga una copia de tus datos personales (GDPR/CCPA).',\r\n    downloadData: 'Descargar Datos',\r\n    \r\n    // Danger Zone\r\n    dangerZone: 'Zona de Peligro',\r\n    deleteAccountWarning: 'Eliminar tu cuenta es permanente. Esta acción eliminará tu perfil, publicaciones y mensajes.',\r\n    deleteAccount: 'Eliminar Cuenta',\r\n    confirmDeletion: 'Confirmar Eliminación',\r\n    typeDeleteToConfirm: 'Escribe ELIMINAR a continuación para confirmar. Esto no se puede deshacer.',\r\n    confirmDelete: 'Confirmar Eliminación',\r\n    cancel: 'Cancelar',\r\n    \r\n    // Notifications\r\n    generalNotifications: 'Notificaciones Generales',\r\n    emailNotifications: 'Notificaciones por Correo',\r\n    pushNotifications: 'Notificaciones Push',\r\n    marketingUpdates: 'Marketing y Actualizaciones',\r\n    soundNotifications: 'Notificaciones de Sonido',\r\n    badgeCount: 'Contador de Insignias',\r\n    badgeCountDescription: 'Mostrar conteo de no leídos en el icono de la app',\r\n    bookingNotifications: 'Notificaciones de Reservas',\r\n    newBookingRequests: 'Nuevas Solicitudes de Reserva',\r\n    bookingConfirmations: 'Confirmaciones de Reserva',\r\n    bookingReminders: 'Recordatorios de Reserva',\r\n    bookingCancellations: 'Cancelaciones de Reserva',\r\n    socialNotifications: 'Notificaciones Sociales',\r\n    likes: 'Me Gusta',\r\n    comments: 'Comentarios',\r\n    follows: 'Seguimientos',\r\n    mentions: 'Menciones',\r\n    reposts: 'Republicaciones',\r\n    marketplaceNotifications: 'Notificaciones del Mercado',\r\n    newOffers: 'Nuevas Ofertas',\r\n    sales: 'Ventas',\r\n    messages: 'Mensajes',\r\n    systemNotifications: 'Notificaciones del Sistema',\r\n    maintenanceAlerts: 'Alertas de Mantenimiento',\r\n    updates: 'Actualizaciones',\r\n    securityAlerts: 'Alertas de Seguridad',\r\n    quietHours: 'Horas Silenciosas',\r\n    enableQuietHours: 'Habilitar Horas Silenciosas',\r\n    quietHoursDescription: 'Desactivar notificaciones durante horas específicas',\r\n    startTime: 'Hora de Inicio',\r\n    endTime: 'Hora de Fin',\r\n    \r\n    // Messaging\r\n    readReceipts: 'Confirmaciones de Lectura',\r\n    readReceiptsDescription: 'Mostrar cuando los mensajes son leídos',\r\n    typingIndicators: 'Indicadores de Escritura',\r\n    typingIndicatorsDescription: 'Mostrar cuando alguien está escribiendo',\r\n    messageRequests: 'Solicitudes de Mensaje',\r\n    messageRequestsDescription: 'Requerir aprobación para mensajes de no contactos',\r\n    whoCanMessageYou: 'Quién Puede Enviarte Mensajes',\r\n    everyone: 'Todos',\r\n    followersOnly: 'Solo Seguidores',\r\n    noOne: 'Nadie',\r\n    autoArchiveOld: 'Archivar Automáticamente Conversaciones Antiguas',\r\n    autoArchiveDescription: 'Archivar automáticamente conversaciones mayores de 30 días',\r\n    soundNotificationsMessages: 'Notificaciones de Sonido para Mensajes',\r\n    messagePreview: 'Vista Previa de Mensaje en Notificaciones',\r\n    messagePreviewDescription: 'Mostrar contenido del mensaje en notificaciones',\r\n    blockedContacts: 'Contactos Bloqueados',\r\n    \r\n    // Chat Additional\r\n    searchConversations: 'Buscar conversaciones...',\r\n    newGroup: 'Nuevo Grupo',\r\n    groupChat: 'Chat Grupal',\r\n    directMessage: 'Mensaje Directo',\r\n    addMembers: 'Agregar Miembros',\r\n    groupName: 'Nombre del Grupo',\r\n    createGroup: 'Crear Grupo',\r\n    noMessages: 'Aún no hay mensajes',\r\n    messageDeleted: 'Mensaje eliminado',\r\n    replyingTo: 'Respondiendo a',\r\n    editingMessage: 'Editando mensaje',\r\n    forwardingMessage: 'Reenviando mensaje',\r\n    unknownUser: 'Usuario Desconocido',\r\n    dropFiles: 'Suelta archivos aquí',\r\n    updateMessage: 'Actualizar mensaje',\r\n    noMembersSelected: 'No hay miembros seleccionados',\r\n    noUsersFound: 'No se encontraron usuarios',\r\n    you: 'Tú',\r\n    enterGroupName: 'Ingresa el nombre del grupo',\r\n    \r\n    // Social & Feed\r\n    feedAlgorithm: 'Algoritmo del Feed',\r\n    chronological: 'Cronológico',\r\n    recommended: 'Recomendado',\r\n    followingOnly: 'Solo Seguidos',\r\n    autoPlayVideos: 'Reproducción Automática de Videos en el Feed',\r\n    showSensitiveContentWarning: 'Mostrar Advertencia de Contenido Sensible',\r\n    showActivityStatus: 'Mostrar Estado de Actividad',\r\n    showActivityStatusDescription: 'Permitir que otros vean cuando estás activo',\r\n    showSuggestedAccounts: 'Mostrar Cuentas Sugeridas',\r\n    contentFiltering: 'Filtrado de Contenido',\r\n    sensitivityFilter: 'Filtro de Sensibilidad',\r\n    off: 'Desactivado',\r\n    low: 'Bajo',\r\n    medium: 'Medio',\r\n    high: 'Alto',\r\n    autoHideReported: 'Ocultar Automáticamente Contenido Reportado',\r\n    showAgeRestricted: 'Mostrar Contenido con Restricción de Edad',\r\n    mutedUsers: 'Usuarios Silenciados',\r\n    \r\n    // Bookings\r\n    autoAcceptBookings: 'Aceptar Automáticamente Reservas',\r\n    autoAcceptDescription: 'Aceptar automáticamente reservas que cumplan tus criterios',\r\n    defaultBufferTime: 'Tiempo de Búfer Predeterminado',\r\n    bufferTimeDescription: 'Tiempo entre sesiones',\r\n    minutes: 'minutos',\r\n    showAvailabilityPublicly: 'Mostrar Calendario de Disponibilidad Públicamente',\r\n    requireDeposit: 'Requerir Depósito para Reservas',\r\n    autoDeclineExpired: 'Rechazar Automáticamente Solicitudes de Reserva Expiradas',\r\n    defaultSessionDuration: 'Duración de Sesión Predeterminada',\r\n    \r\n    // Marketplace\r\n    autoListItem: 'Listar Automáticamente Artículos',\r\n    autoListDescription: 'Listar automáticamente artículos para la venta',\r\n    requireApproval: 'Requerir Aprobación',\r\n    requireApprovalDescription: 'Revisar artículos antes de que se publiquen',\r\n    defaultShippingMethod: 'Método de Envío Predeterminado',\r\n    defaultPaymentTerms: 'Términos de Pago Predeterminados',\r\n    immediate: 'Inmediato',\r\n    net15: 'Neto 15',\r\n    net30: 'Neto 30',\r\n    autoAcceptOffersAbove: 'Aceptar Automáticamente Ofertas por Encima del Umbral',\r\n    autoAcceptThreshold: 'Umbral de Aceptación Automática',\r\n    showSoldItems: 'Mostrar Artículos Vendidos en Listados',\r\n    \r\n    // Content & Media\r\n    imageQuality: 'Calidad de Imagen',\r\n    videoQuality: 'Calidad de Video',\r\n    high: 'Alta',\r\n    medium: 'Media',\r\n    low: 'Baja (Carga Más Rápida)',\r\n    autoSaveUploaded: 'Guardar Automáticamente Medios Subidos',\r\n    autoSaveDescription: 'Guardar automáticamente imágenes y videos subidos',\r\n    compressImages: 'Comprimir Imágenes Antes de Subir',\r\n    compressDescription: 'Reducir el tamaño del archivo para subidas más rápidas',\r\n    maxUploadSize: 'Tamaño Máximo de Subida',\r\n    mb: 'MB',\r\n    \r\n    // Accessibility\r\n    fontSize: 'Tamaño de Fuente',\r\n    small: 'Pequeño',\r\n    large: 'Grande',\r\n    extraLarge: 'Extra Grande',\r\n    reducedMotion: 'Movimiento Reducido',\r\n    reducedMotionDescription: 'Desactivar animaciones para mejor accesibilidad',\r\n    highContrast: 'Modo de Alto Contraste',\r\n    highContrastDescription: 'Aumentar el contraste para mejor visibilidad',\r\n    screenReaderAnnouncements: 'Anuncios de Lector de Pantalla',\r\n    screenReaderDescription: 'Habilitar anuncios para lectores de pantalla',\r\n    keyboardHints: 'Pistas de Navegación por Teclado',\r\n    keyboardHintsDescription: 'Mostrar pistas para navegación por teclado',\r\n    \r\n    // Performance\r\n    dataUsage: 'Uso de Datos',\r\n    wifiOnly: 'Solo WiFi (para medios)',\r\n    auto: 'Automático',\r\n    never: 'Nunca (ahorrar datos)',\r\n    offlineMode: 'Modo Sin Conexión',\r\n    offlineModeDescription: 'Habilitar funcionalidad sin conexión',\r\n    backgroundSync: 'Sincronización en Segundo Plano',\r\n    backgroundSyncDescription: 'Sincronizar datos en segundo plano',\r\n    autoClearOldNotifications: 'Limpiar Automáticamente Notificaciones Antiguas',\r\n    clearAfter: 'Limpiar Después de',\r\n    days: 'días',\r\n    cacheManagement: 'Gestión de Caché',\r\n    clearCache: 'Limpiar Caché',\r\n    clearCacheDescription: 'Limpiar datos en caché para liberar espacio de almacenamiento',\r\n    \r\n    // Common\r\n    saveAll: 'Guardar Todo',\r\n    saving: 'Guardando...',\r\n    saved: '¡Configuración guardada exitosamente!',\r\n    saveFailed: 'Error al guardar la configuración.',\r\n    settingsUpdated: '¡Configuración actualizada!',\r\n    \r\n    // Navigation\r\n    dashboard: 'Panel',\r\n    socialNx: 'SocialNx',\r\n    messages: 'Mensajes',\r\n    bookings: 'Reservas',\r\n    marketplace: 'Mercado',\r\n    techServices: 'Servicios Técnicos',\r\n    businessCenter: 'Centro de Negocios',\r\n    profile: 'Perfil',\r\n    billing: 'Facturación',\r\n    settings: 'Configuración',\r\n    logout: 'Cerrar Sesión',\r\n    search: 'Buscar',\r\n    searchPlaceholder: 'Buscar...',\r\n    notifications: 'Notificaciones',\r\n    noNotifications: 'No hay notificaciones',\r\n    markAllRead: 'Marcar todas como leídas',\r\n    clearAll: 'Limpiar todo',\r\n    switchRole: 'Cambiar Rol',\r\n    viewProfile: 'Ver Perfil',\r\n    \r\n    // Dashboard\r\n    goodMorning: 'Buenos días',\r\n    goodAfternoon: 'Buenas tardes',\r\n    goodEvening: 'Buenas noches',\r\n    goodNight: 'Buenas noches',\r\n    welcomeBack: 'Bienvenido de nuevo',\r\n    quickActions: 'Acciones Rápidas',\r\n    recentActivity: 'Actividad Reciente',\r\n    upcomingBookings: 'Reservas Próximas',\r\n    noUpcomingBookings: 'No hay reservas próximas',\r\n    viewAll: 'Ver Todo',\r\n    seeMore: 'Ver Más',\r\n    newBooking: 'Nueva Reserva',\r\n    viewCalendar: 'Ver Calendario',\r\n    recentMessages: 'Mensajes Recientes',\r\n    noRecentMessages: 'No hay mensajes recientes',\r\n    startConversation: 'Iniciar Conversación',\r\n    trendingNow: 'Tendencias',\r\n    viewMarketplace: 'Ver Mercado',\r\n    stats: 'Estadísticas',\r\n    followers: 'Seguidores',\r\n    following: 'Siguiendo',\r\n    posts: 'Publicaciones',\r\n    \r\n    // Social Feed\r\n    forYou: 'Para Ti',\r\n    following: 'Siguiendo',\r\n    discover: 'Descubrir',\r\n    createPost: 'Crear Publicación',\r\n    whatOnMind: '¿En qué estás pensando?',\r\n    post: 'Publicar',\r\n    like: 'Me Gusta',\r\n    comment: 'Comentar',\r\n    share: 'Compartir',\r\n    save: 'Guardar',\r\n    repost: 'Republicar',\r\n    follow: 'Seguir',\r\n    unfollow: 'Dejar de Seguir',\r\n    noPosts: 'Aún no hay publicaciones',\r\n    beFirst: '¡Sé el primero en compartir algo!',\r\n    noPostsFollowing: 'No hay publicaciones recientes de personas que sigues',\r\n    browseForYou: 'Explorar feed Para Ti →',\r\n    suggestedForYou: 'Sugerido para ti',\r\n    startFollowing: 'Comienza a seguir creadores',\r\n    followDescription: 'Sigue artistas, ingenieros y estudios para ver sus publicaciones en tu feed de Siguiendo.',\r\n    \r\n    // Messages\r\n    selectConversation: 'Selecciona una conversación para comenzar a chatear',\r\n    typeMessage: 'Escribe un mensaje...',\r\n    send: 'Enviar',\r\n    online: 'En Línea',\r\n    offline: 'Desconectado',\r\n    typing: 'escribiendo...',\r\n    newMessage: 'Nuevo Mensaje',\r\n    noConversations: 'Aún no hay conversaciones',\r\n    \r\n    // Bookings\r\n    myBookings: 'Mis Reservas',\r\n    calendar: 'Calendario',\r\n    findTalent: 'Buscar Talento',\r\n    broadcasts: 'Transmisiones',\r\n    createBroadcast: 'Crear Transmisión',\r\n    newSession: 'Nueva Sesión',\r\n    manageSessions: 'Gestiona tus sesiones y reservas',\r\n    upcoming: 'Próximas',\r\n    past: 'Pasadas',\r\n    pending: 'Pendientes',\r\n    confirmed: 'Confirmadas',\r\n    cancelled: 'Canceladas',\r\n    noBookings: 'No se encontraron reservas',\r\n    \r\n    // Common Actions\r\n    loading: 'Cargando...',\r\n    error: 'Error',\r\n    success: 'Éxito',\r\n    cancel: 'Cancelar',\r\n    confirm: 'Confirmar',\r\n    delete: 'Eliminar',\r\n    edit: 'Editar',\r\n    save: 'Guardar',\r\n    close: 'Cerrar',\r\n    back: 'Atrás',\r\n    next: 'Siguiente',\r\n    previous: 'Anterior',\r\n    done: 'Hecho',\r\n    apply: 'Aplicar',\r\n    reset: 'Restablecer',\r\n    filter: 'Filtrar',\r\n    sort: 'Ordenar',\r\n    refresh: 'Actualizar',\r\n  },\r\n  \r\n  fr: {\r\n    // General\r\n    general: 'Général',\r\n    security: 'Sécurité et Confidentialité',\r\n    notifications: 'Notifications',\r\n    messaging: 'Messagerie',\r\n    social: 'Social et Fil d\\'Actualité',\r\n    bookings: 'Réservations',\r\n    marketplace: 'Marché',\r\n    content: 'Contenu et Médias',\r\n    accessibility: 'Accessibilité',\r\n    performance: 'Performances',\r\n    \r\n    // Roles & Workflow\r\n    rolesWorkflow: 'Rôles et Flux de Travail',\r\n    activeAccountTypes: 'Types de Compte Actifs',\r\n    preferredProfile: 'Profil Préféré',\r\n    activeWorkflowContext: 'Contexte de Flux de Travail Actif',\r\n    seeAllUnfiltered: 'Voir Tout (Vue Non Filtrée)',\r\n    seeAllDescription: 'Afficher tous les types de contenu indépendamment du flux de travail actif',\r\n    saveWorkflowSettings: 'Enregistrer les Paramètres de Flux de Travail',\r\n    \r\n    // Appearance\r\n    appearance: 'Apparence',\r\n    light: 'Clair',\r\n    dark: 'Sombre',\r\n    system: 'Système',\r\n    \r\n    // Language & Localization\r\n    languageLocalization: 'Langue et Localisation',\r\n    language: 'Langue',\r\n    dateFormat: 'Format de Date',\r\n    timeFormat: 'Format d\\'Heure',\r\n    timezone: 'Fuseau Horaire',\r\n    currency: 'Devise',\r\n    numberFormat: 'Format de Nombre',\r\n    autoDetect: 'Détection Automatique',\r\n    easternTime: 'Heure de l\\'Est',\r\n    centralTime: 'Heure du Centre',\r\n    mountainTime: 'Heure des Rocheuses',\r\n    pacificTime: 'Heure du Pacifique',\r\n    \r\n    // Security\r\n    accountSecurity: 'Sécurité du Compte',\r\n    emailAddress: 'Adresse E-mail',\r\n    password: 'Mot de Passe',\r\n    changeEmail: 'Changer l\\'E-mail',\r\n    changePassword: 'Changer le Mot de Passe',\r\n    twoFactorAuth: 'Authentification à Deux Facteurs (2FA)',\r\n    twoFactorDescription: 'Ajoutez une couche supplémentaire de sécurité à votre compte',\r\n    lastChanged: 'Dernière modification',\r\n    unknown: 'Inconnu',\r\n    \r\n    // Privacy\r\n    privacyVisibility: 'Confidentialité et Visibilité',\r\n    publicProfileVisibility: 'Visibilité du Profil Public',\r\n    showLocationOnMap: 'Afficher l\\'Emplacement sur la Carte',\r\n    hideProfileCompletely: 'Masquer Complètement le Profil',\r\n    showEmailAddress: 'Afficher l\\'Adresse E-mail',\r\n    showPhoneNumber: 'Afficher le Numéro de Téléphone',\r\n    showOnlineStatus: 'Afficher le Statut en Ligne',\r\n    showLastSeen: 'Afficher la Dernière Connexion',\r\n    allowSearchEngines: 'Autoriser l\\'Indexation par les Moteurs de Recherche',\r\n    allowTagging: 'Autoriser le Marquage',\r\n    reviewTagsBeforeAppear: 'Réviser les Tags Avant qu\\'Ils Apparaissent',\r\n    showFollowingList: 'Afficher la Liste des Abonnements',\r\n    showFollowersList: 'Afficher la Liste des Abonnés',\r\n    \r\n    // Content & Safety\r\n    contentSafety: 'Contenu et Sécurité',\r\n    blockedUsers: 'Utilisateurs Bloqués',\r\n    mutedThreads: 'Fils de Discussion Silencieux',\r\n    noActive: 'Aucun actif',\r\n    \r\n    // Data Export\r\n    yourData: 'Vos Données',\r\n    downloadDataDescription: 'Téléchargez une copie de vos données personnelles (RGPD/CCPA).',\r\n    downloadData: 'Télécharger les Données',\r\n    \r\n    // Danger Zone\r\n    dangerZone: 'Zone de Danger',\r\n    deleteAccountWarning: 'Supprimer votre compte est permanent. Cette action supprimera votre profil, vos publications et vos messages.',\r\n    deleteAccount: 'Supprimer le Compte',\r\n    confirmDeletion: 'Confirmer la Suppression',\r\n    typeDeleteToConfirm: 'Tapez SUPPRIMER ci-dessous pour confirmer. Cela ne peut pas être annulé.',\r\n    confirmDelete: 'Confirmer la Suppression',\r\n    cancel: 'Annuler',\r\n    \r\n    // Notifications\r\n    generalNotifications: 'Notifications Générales',\r\n    emailNotifications: 'Notifications par E-mail',\r\n    pushNotifications: 'Notifications Push',\r\n    marketingUpdates: 'Marketing et Mises à Jour',\r\n    soundNotifications: 'Notifications Sonores',\r\n    badgeCount: 'Compteur de Badges',\r\n    badgeCountDescription: 'Afficher le nombre de non lus sur l\\'icône de l\\'application',\r\n    bookingNotifications: 'Notifications de Réservations',\r\n    newBookingRequests: 'Nouvelles Demandes de Réservation',\r\n    bookingConfirmations: 'Confirmations de Réservation',\r\n    bookingReminders: 'Rappels de Réservation',\r\n    bookingCancellations: 'Annulations de Réservation',\r\n    socialNotifications: 'Notifications Sociales',\r\n    likes: 'J\\'aime',\r\n    comments: 'Commentaires',\r\n    follows: 'Abonnements',\r\n    mentions: 'Mentions',\r\n    reposts: 'Repartages',\r\n    marketplaceNotifications: 'Notifications du Marché',\r\n    newOffers: 'Nouvelles Offres',\r\n    sales: 'Ventes',\r\n    messages: 'Messages',\r\n    systemNotifications: 'Notifications Système',\r\n    maintenanceAlerts: 'Alertes de Maintenance',\r\n    updates: 'Mises à Jour',\r\n    securityAlerts: 'Alertes de Sécurité',\r\n    quietHours: 'Heures Silencieuses',\r\n    enableQuietHours: 'Activer les Heures Silencieuses',\r\n    quietHoursDescription: 'Désactiver les notifications pendant des heures spécifiques',\r\n    startTime: 'Heure de Début',\r\n    endTime: 'Heure de Fin',\r\n    \r\n    // Messaging\r\n    readReceipts: 'Accusés de Réception',\r\n    readReceiptsDescription: 'Afficher quand les messages sont lus',\r\n    typingIndicators: 'Indicateurs de Frappe',\r\n    typingIndicatorsDescription: 'Afficher quand quelqu\\'un est en train d\\'écrire',\r\n    messageRequests: 'Demandes de Message',\r\n    messageRequestsDescription: 'Exiger une approbation pour les messages de non contacts',\r\n    whoCanMessageYou: 'Qui Peut Vous Envoyer des Messages',\r\n    everyone: 'Tout le Monde',\r\n    followersOnly: 'Abonnés Uniquement',\r\n    noOne: 'Personne',\r\n    autoArchiveOld: 'Archiver Automatiquement les Anciennes Conversations',\r\n    autoArchiveDescription: 'Archiver automatiquement les conversations de plus de 30 jours',\r\n    soundNotificationsMessages: 'Notifications Sonores pour les Messages',\r\n    messagePreview: 'Aperçu du Message dans les Notifications',\r\n    messagePreviewDescription: 'Afficher le contenu du message dans les notifications',\r\n    blockedContacts: 'Contacts Bloqués',\r\n    \r\n    // Chat Additional\r\n    searchConversations: 'Rechercher des conversations...',\r\n    newGroup: 'Nouveau Groupe',\r\n    groupChat: 'Chat de Groupe',\r\n    directMessage: 'Message Direct',\r\n    addMembers: 'Ajouter des Membres',\r\n    groupName: 'Nom du Groupe',\r\n    createGroup: 'Créer un Groupe',\r\n    noMessages: 'Aucun message pour le moment',\r\n    messageDeleted: 'Message supprimé',\r\n    replyingTo: 'Répondre à',\r\n    editingMessage: 'Modification du message',\r\n    forwardingMessage: 'Transfert du message',\r\n    unknownUser: 'Utilisateur Inconnu',\r\n    dropFiles: 'Déposer les fichiers ici',\r\n    updateMessage: 'Mettre à jour le message',\r\n    noMembersSelected: 'Aucun membre sélectionné',\r\n    noUsersFound: 'Aucun utilisateur trouvé',\r\n    you: 'Vous',\r\n    enterGroupName: 'Entrer le nom du groupe',\r\n    \r\n    // Social & Feed\r\n    feedAlgorithm: 'Algorithme du Fil d\\'Actualité',\r\n    chronological: 'Chronologique',\r\n    recommended: 'Recommandé',\r\n    followingOnly: 'Abonnements Uniquement',\r\n    autoPlayVideos: 'Lecture Automatique des Vidéos dans le Fil',\r\n    showSensitiveContentWarning: 'Afficher l\\'Avertissement de Contenu Sensible',\r\n    showActivityStatus: 'Afficher le Statut d\\'Activité',\r\n    showActivityStatusDescription: 'Permettre aux autres de voir quand vous êtes actif',\r\n    showSuggestedAccounts: 'Afficher les Comptes Suggérés',\r\n    contentFiltering: 'Filtrage de Contenu',\r\n    sensitivityFilter: 'Filtre de Sensibilité',\r\n    off: 'Désactivé',\r\n    low: 'Faible',\r\n    medium: 'Moyen',\r\n    high: 'Élevé',\r\n    autoHideReported: 'Masquer Automatiquement le Contenu Signalé',\r\n    showAgeRestricted: 'Afficher le Contenu avec Restriction d\\'Âge',\r\n    mutedUsers: 'Utilisateurs Silencieux',\r\n    \r\n    // Bookings\r\n    autoAcceptBookings: 'Accepter Automatiquement les Réservations',\r\n    autoAcceptDescription: 'Accepter automatiquement les réservations qui répondent à vos critères',\r\n    defaultBufferTime: 'Temps de Tampon par Défaut',\r\n    bufferTimeDescription: 'Temps entre les sessions',\r\n    minutes: 'minutes',\r\n    showAvailabilityPublicly: 'Afficher le Calendrier de Disponibilité Publiquement',\r\n    requireDeposit: 'Exiger un Dépôt pour les Réservations',\r\n    autoDeclineExpired: 'Refuser Automatiquement les Demandes de Réservation Expirées',\r\n    defaultSessionDuration: 'Durée de Session par Défaut',\r\n    \r\n    // Marketplace\r\n    autoListItem: 'Lister Automatiquement les Articles',\r\n    autoListDescription: 'Lister automatiquement les articles à vendre',\r\n    requireApproval: 'Exiger une Approbation',\r\n    requireApprovalDescription: 'Réviser les articles avant qu\\'ils ne soient publiés',\r\n    defaultShippingMethod: 'Méthode d\\'Expédition par Défaut',\r\n    defaultPaymentTerms: 'Conditions de Paiement par Défaut',\r\n    immediate: 'Immédiat',\r\n    net15: 'Net 15',\r\n    net30: 'Net 30',\r\n    autoAcceptOffersAbove: 'Accepter Automatiquement les Offres au-Dessus du Seuil',\r\n    autoAcceptThreshold: 'Seuil d\\'Acceptation Automatique',\r\n    showSoldItems: 'Afficher les Articles Vendus dans les Listings',\r\n    \r\n    // Content & Media\r\n    imageQuality: 'Qualité d\\'Image',\r\n    videoQuality: 'Qualité Vidéo',\r\n    high: 'Élevée',\r\n    medium: 'Moyenne',\r\n    low: 'Faible (Chargement Plus Rapide)',\r\n    autoSaveUploaded: 'Enregistrer Automatiquement les Médias Téléchargés',\r\n    autoSaveDescription: 'Enregistrer automatiquement les images et vidéos téléchargées',\r\n    compressImages: 'Compresser les Images Avant le Téléchargement',\r\n    compressDescription: 'Réduire la taille du fichier pour des téléchargements plus rapides',\r\n    maxUploadSize: 'Taille Maximale de Téléchargement',\r\n    mb: 'Mo',\r\n    \r\n    // Accessibility\r\n    fontSize: 'Taille de Police',\r\n    small: 'Petite',\r\n    large: 'Grande',\r\n    extraLarge: 'Très Grande',\r\n    reducedMotion: 'Mouvement Réduit',\r\n    reducedMotionDescription: 'Désactiver les animations pour une meilleure accessibilité',\r\n    highContrast: 'Mode Contraste Élevé',\r\n    highContrastDescription: 'Augmenter le contraste pour une meilleure visibilité',\r\n    screenReaderAnnouncements: 'Annonces de Lecteur d\\'Écran',\r\n    screenReaderDescription: 'Activer les annonces pour les lecteurs d\\'écran',\r\n    keyboardHints: 'Indices de Navigation au Clavier',\r\n    keyboardHintsDescription: 'Afficher les indices pour la navigation au clavier',\r\n    \r\n    // Performance\r\n    dataUsage: 'Utilisation des Données',\r\n    wifiOnly: 'WiFi Uniquement (pour les médias)',\r\n    auto: 'Automatique',\r\n    never: 'Jamais (économiser les données)',\r\n    offlineMode: 'Mode Hors Ligne',\r\n    offlineModeDescription: 'Activer la fonctionnalité hors ligne',\r\n    backgroundSync: 'Synchronisation en Arrière-Plan',\r\n    backgroundSyncDescription: 'Synchroniser les données en arrière-plan',\r\n    autoClearOldNotifications: 'Effacer Automatiquement les Anciennes Notifications',\r\n    clearAfter: 'Effacer Après',\r\n    days: 'jours',\r\n    cacheManagement: 'Gestion du Cache',\r\n    clearCache: 'Effacer le Cache',\r\n    clearCacheDescription: 'Effacer les données en cache pour libérer de l\\'espace de stockage',\r\n    \r\n    // Common\r\n    saveAll: 'Tout Enregistrer',\r\n    saving: 'Enregistrement...',\r\n    saved: 'Paramètres enregistrés avec succès !',\r\n    saveFailed: 'Échec de l\\'enregistrement des paramètres.',\r\n    settingsUpdated: 'Paramètres mis à jour !',\r\n    \r\n    // Navigation\r\n    dashboard: 'Tableau de Bord',\r\n    socialNx: 'SocialNx',\r\n    messages: 'Messages',\r\n    bookings: 'Réservations',\r\n    marketplace: 'Marché',\r\n    techServices: 'Services Techniques',\r\n    businessCenter: 'Centre d\\'Affaires',\r\n    profile: 'Profil',\r\n    billing: 'Facturation',\r\n    settings: 'Paramètres',\r\n    logout: 'Déconnexion',\r\n    search: 'Rechercher',\r\n    searchPlaceholder: 'Rechercher...',\r\n    notifications: 'Notifications',\r\n    noNotifications: 'Aucune notification',\r\n    markAllRead: 'Tout marquer comme lu',\r\n    clearAll: 'Tout effacer',\r\n    switchRole: 'Changer de Rôle',\r\n    viewProfile: 'Voir le Profil',\r\n    \r\n    // Dashboard\r\n    goodMorning: 'Bonjour',\r\n    goodAfternoon: 'Bon après-midi',\r\n    goodEvening: 'Bonsoir',\r\n    goodNight: 'Bonne nuit',\r\n    welcomeBack: 'Bon retour',\r\n    quickActions: 'Actions Rapides',\r\n    recentActivity: 'Activité Récente',\r\n    upcomingBookings: 'Réservations à Venir',\r\n    noUpcomingBookings: 'Aucune réservation à venir',\r\n    viewAll: 'Voir Tout',\r\n    seeMore: 'Voir Plus',\r\n    newBooking: 'Nouvelle Réservation',\r\n    viewCalendar: 'Voir le Calendrier',\r\n    recentMessages: 'Messages Récents',\r\n    noRecentMessages: 'Aucun message récent',\r\n    startConversation: 'Démarrer une Conversation',\r\n    trendingNow: 'Tendances',\r\n    viewMarketplace: 'Voir le Marché',\r\n    stats: 'Statistiques',\r\n    followers: 'Abonnés',\r\n    following: 'Abonnements',\r\n    posts: 'Publications',\r\n    \r\n    // Social Feed\r\n    forYou: 'Pour Vous',\r\n    following: 'Abonnements',\r\n    discover: 'Découvrir',\r\n    createPost: 'Créer une Publication',\r\n    whatOnMind: 'À quoi pensez-vous ?',\r\n    post: 'Publier',\r\n    like: 'J\\'aime',\r\n    comment: 'Commenter',\r\n    share: 'Partager',\r\n    save: 'Enregistrer',\r\n    repost: 'Repartager',\r\n    follow: 'Suivre',\r\n    unfollow: 'Ne Plus Suivre',\r\n    noPosts: 'Aucune publication pour le moment',\r\n    beFirst: 'Soyez le premier à partager quelque chose !',\r\n    noPostsFollowing: 'Aucune publication récente des personnes que vous suivez',\r\n    browseForYou: 'Parcourir le fil Pour Vous →',\r\n    suggestedForYou: 'Suggéré pour vous',\r\n    startFollowing: 'Commencer à suivre des créateurs',\r\n    followDescription: 'Suivez des artistes, des ingénieurs et des studios pour voir leurs publications dans votre fil d\\'Abonnements.',\r\n    \r\n    // Messages\r\n    selectConversation: 'Sélectionnez une conversation pour commencer à discuter',\r\n    typeMessage: 'Tapez un message...',\r\n    send: 'Envoyer',\r\n    online: 'En Ligne',\r\n    offline: 'Hors Ligne',\r\n    typing: 'en train d\\'écrire...',\r\n    newMessage: 'Nouveau Message',\r\n    noConversations: 'Aucune conversation pour le moment',\r\n    \r\n    // Bookings\r\n    myBookings: 'Mes Réservations',\r\n    calendar: 'Calendrier',\r\n    findTalent: 'Trouver un Talent',\r\n    broadcasts: 'Diffusions',\r\n    createBroadcast: 'Créer une Diffusion',\r\n    newSession: 'Nouvelle Session',\r\n    manageSessions: 'Gérez vos sessions et réservations',\r\n    upcoming: 'À Venir',\r\n    past: 'Passées',\r\n    pending: 'En Attente',\r\n    confirmed: 'Confirmées',\r\n    cancelled: 'Annulées',\r\n    noBookings: 'Aucune réservation trouvée',\r\n    \r\n    // Common Actions\r\n    loading: 'Chargement...',\r\n    error: 'Erreur',\r\n    success: 'Succès',\r\n    cancel: 'Annuler',\r\n    confirm: 'Confirmer',\r\n    delete: 'Supprimer',\r\n    edit: 'Modifier',\r\n    save: 'Enregistrer',\r\n    close: 'Fermer',\r\n    back: 'Retour',\r\n    next: 'Suivant',\r\n    previous: 'Précédent',\r\n    done: 'Terminé',\r\n    apply: 'Appliquer',\r\n    reset: 'Réinitialiser',\r\n    filter: 'Filtrer',\r\n    sort: 'Trier',\r\n    refresh: 'Actualiser',\r\n    \r\n    // Dashboard Additional\r\n    activityFeed: 'Flux d\\'Activité',\r\n    allCaughtUp: 'Tout est à jour !',\r\n    noNewNotifications: 'Aucune nouvelle notification',\r\n    viewAllActivity: 'Voir Toute l\\'Activité',\r\n    studioStatus: 'Statut du Studio',\r\n    manage: 'Gérer',\r\n    noRoomsConfigured: 'Aucune salle configurée pour le moment',\r\n    addFirstRoom: '+ Ajouter Votre Première Salle',\r\n    new: 'Nouveau',\r\n    \r\n    // Marketplace\r\n    gearExchange: 'Échange d\\'Équipement',\r\n    seshFxStore: 'Boutique SeshFX',\r\n    \r\n    // Chat Additional\r\n    searchConversations: 'Rechercher des conversations...',\r\n    newGroup: 'Nouveau Groupe',\r\n    groupChat: 'Chat de Groupe',\r\n    directMessage: 'Message Direct',\r\n    addMembers: 'Ajouter des Membres',\r\n    groupName: 'Nom du Groupe',\r\n    createGroup: 'Créer un Groupe',\r\n    noMessages: 'Aucun message pour le moment',\r\n    messageDeleted: 'Message supprimé',\r\n    replyingTo: 'Répondre à',\r\n    editingMessage: 'Modification du message',\r\n    forwardingMessage: 'Transfert du message',\r\n    unknownUser: 'Utilisateur Inconnu',\r\n    dropFiles: 'Déposer les fichiers ici',\r\n    updateMessage: 'Mettre à jour le message',\r\n    noMembersSelected: 'Aucun membre sélectionné',\r\n    noUsersFound: 'Aucun utilisateur trouvé',\r\n    you: 'Vous',\r\n    enterGroupName: 'Entrer le nom du groupe',\r\n    \r\n    // Common Status\r\n    active: 'Actif',\r\n    inactive: 'Inactif',\r\n    pending: 'En Attente',\r\n    completed: 'Terminé',\r\n    cancelled: 'Annulé',\r\n    declined: 'Refusé',\r\n    confirmed: 'Confirmé',\r\n  },\r\n  \r\n  de: {\r\n    // General\r\n    general: 'Allgemein',\r\n    security: 'Sicherheit & Datenschutz',\r\n    notifications: 'Benachrichtigungen',\r\n    messaging: 'Nachrichten',\r\n    social: 'Social & Feed',\r\n    bookings: 'Buchungen',\r\n    marketplace: 'Marktplatz',\r\n    content: 'Inhalt & Medien',\r\n    accessibility: 'Barrierefreiheit',\r\n    performance: 'Leistung',\r\n    \r\n    // Roles & Workflow\r\n    rolesWorkflow: 'Rollen & Arbeitsablauf',\r\n    activeAccountTypes: 'Aktive Kontotypen',\r\n    preferredProfile: 'Bevorzugtes Profil',\r\n    activeWorkflowContext: 'Aktiver Arbeitsablauf-Kontext',\r\n    seeAllUnfiltered: 'Alles Anzeigen (Ungefilterte Ansicht)',\r\n    seeAllDescription: 'Alle Inhaltstypen unabhängig vom aktiven Arbeitsablauf anzeigen',\r\n    saveWorkflowSettings: 'Arbeitsablauf-Einstellungen Speichern',\r\n    \r\n    // Appearance\r\n    appearance: 'Erscheinungsbild',\r\n    light: 'Hell',\r\n    dark: 'Dunkel',\r\n    system: 'System',\r\n    \r\n    // Language & Localization\r\n    languageLocalization: 'Sprache & Lokalisierung',\r\n    language: 'Sprache',\r\n    dateFormat: 'Datumsformat',\r\n    timeFormat: 'Zeitformat',\r\n    timezone: 'Zeitzone',\r\n    currency: 'Währung',\r\n    numberFormat: 'Zahlenformat',\r\n    autoDetect: 'Automatisch Erkennen',\r\n    easternTime: 'Östliche Zeit',\r\n    centralTime: 'Zentrale Zeit',\r\n    mountainTime: 'Bergzeit',\r\n    pacificTime: 'Pazifische Zeit',\r\n    \r\n    // Security\r\n    accountSecurity: 'Kontosicherheit',\r\n    emailAddress: 'E-Mail-Adresse',\r\n    password: 'Passwort',\r\n    changeEmail: 'E-Mail Ändern',\r\n    changePassword: 'Passwort Ändern',\r\n    twoFactorAuth: 'Zwei-Faktor-Authentifizierung (2FA)',\r\n    twoFactorDescription: 'Fügen Sie eine zusätzliche Sicherheitsebene zu Ihrem Konto hinzu',\r\n    lastChanged: 'Zuletzt geändert',\r\n    unknown: 'Unbekannt',\r\n    \r\n    // Privacy\r\n    privacyVisibility: 'Datenschutz & Sichtbarkeit',\r\n    publicProfileVisibility: 'Öffentliche Profilsichtbarkeit',\r\n    showLocationOnMap: 'Standort auf Karte Anzeigen',\r\n    hideProfileCompletely: 'Profil Vollständig Ausblenden',\r\n    showEmailAddress: 'E-Mail-Adresse Anzeigen',\r\n    showPhoneNumber: 'Telefonnummer Anzeigen',\r\n    showOnlineStatus: 'Online-Status Anzeigen',\r\n    showLastSeen: 'Zuletzt Gesehen Anzeigen',\r\n    allowSearchEngines: 'Suchmaschinen-Indexierung Erlauben',\r\n    allowTagging: 'Tagging Erlauben',\r\n    reviewTagsBeforeAppear: 'Tags Vor dem Erscheinen Überprüfen',\r\n    showFollowingList: 'Folge-Liste Anzeigen',\r\n    showFollowersList: 'Follower-Liste Anzeigen',\r\n    \r\n    // Content & Safety\r\n    contentSafety: 'Inhalt & Sicherheit',\r\n    blockedUsers: 'Blockierte Benutzer',\r\n    mutedThreads: 'Stummgeschaltete Threads',\r\n    noActive: 'Keine aktiven',\r\n    \r\n    // Data Export\r\n    yourData: 'Ihre Daten',\r\n    downloadDataDescription: 'Laden Sie eine Kopie Ihrer persönlichen Daten herunter (DSGVO/CCPA).',\r\n    downloadData: 'Daten Herunterladen',\r\n    \r\n    // Danger Zone\r\n    dangerZone: 'Gefahrenzone',\r\n    deleteAccountWarning: 'Das Löschen Ihres Kontos ist dauerhaft. Diese Aktion löscht Ihr Profil, Ihre Beiträge und Nachrichten.',\r\n    deleteAccount: 'Konto Löschen',\r\n    confirmDeletion: 'Löschung Bestätigen',\r\n    typeDeleteToConfirm: 'Geben Sie LÖSCHEN unten ein, um zu bestätigen. Dies kann nicht rückgängig gemacht werden.',\r\n    confirmDelete: 'Löschung Bestätigen',\r\n    cancel: 'Abbrechen',\r\n    \r\n    // Notifications\r\n    generalNotifications: 'Allgemeine Benachrichtigungen',\r\n    emailNotifications: 'E-Mail-Benachrichtigungen',\r\n    pushNotifications: 'Push-Benachrichtigungen',\r\n    marketingUpdates: 'Marketing & Updates',\r\n    soundNotifications: 'Tonbenachrichtigungen',\r\n    badgeCount: 'Badge-Zähler',\r\n    badgeCountDescription: 'Ungelesene Anzahl auf App-Symbol anzeigen',\r\n    bookingNotifications: 'Buchungsbenachrichtigungen',\r\n    newBookingRequests: 'Neue Buchungsanfragen',\r\n    bookingConfirmations: 'Buchungsbestätigungen',\r\n    bookingReminders: 'Buchungserinnerungen',\r\n    bookingCancellations: 'Buchungsstornierungen',\r\n    socialNotifications: 'Soziale Benachrichtigungen',\r\n    likes: 'Gefällt mir',\r\n    comments: 'Kommentare',\r\n    follows: 'Folgen',\r\n    mentions: 'Erwähnungen',\r\n    reposts: 'Weiterleitungen',\r\n    marketplaceNotifications: 'Marktplatz-Benachrichtigungen',\r\n    newOffers: 'Neue Angebote',\r\n    sales: 'Verkäufe',\r\n    messages: 'Nachrichten',\r\n    systemNotifications: 'Systembenachrichtigungen',\r\n    maintenanceAlerts: 'Wartungsbenachrichtigungen',\r\n    updates: 'Updates',\r\n    securityAlerts: 'Sicherheitswarnungen',\r\n    quietHours: 'Ruhezeiten',\r\n    enableQuietHours: 'Ruhezeiten Aktivieren',\r\n    quietHoursDescription: 'Benachrichtigungen während bestimmter Zeiten deaktivieren',\r\n    startTime: 'Startzeit',\r\n    endTime: 'Endzeit',\r\n    \r\n    // Messaging\r\n    readReceipts: 'Lesebestätigungen',\r\n    readReceiptsDescription: 'Anzeigen, wenn Nachrichten gelesen wurden',\r\n    typingIndicators: 'Tippindikatoren',\r\n    typingIndicatorsDescription: 'Anzeigen, wenn jemand tippt',\r\n    messageRequests: 'Nachrichtenanfragen',\r\n    messageRequestsDescription: 'Genehmigung für Nachrichten von Nicht-Kontakten erforderlich',\r\n    whoCanMessageYou: 'Wer Kann Ihnen Nachrichten Senden',\r\n    everyone: 'Jeder',\r\n    followersOnly: 'Nur Follower',\r\n    noOne: 'Niemand',\r\n    autoArchiveOld: 'Alte Unterhaltungen Automatisch Archivieren',\r\n    autoArchiveDescription: 'Unterhaltungen älter als 30 Tage automatisch archivieren',\r\n    soundNotificationsMessages: 'Tonbenachrichtigungen für Nachrichten',\r\n    messagePreview: 'Nachrichtenvorschau in Benachrichtigungen',\r\n    messagePreviewDescription: 'Nachrichteninhalt in Benachrichtigungen anzeigen',\r\n    blockedContacts: 'Blockierte Kontakte',\r\n    \r\n    // Chat Additional\r\n    searchConversations: 'Unterhaltungen suchen...',\r\n    newGroup: 'Neue Gruppe',\r\n    groupChat: 'Gruppenchat',\r\n    directMessage: 'Direktnachricht',\r\n    addMembers: 'Mitglieder Hinzufügen',\r\n    groupName: 'Gruppenname',\r\n    createGroup: 'Gruppe Erstellen',\r\n    noMessages: 'Noch keine Nachrichten',\r\n    messageDeleted: 'Nachricht gelöscht',\r\n    replyingTo: 'Antworten an',\r\n    editingMessage: 'Nachricht bearbeiten',\r\n    forwardingMessage: 'Nachricht weiterleiten',\r\n    unknownUser: 'Unbekannter Benutzer',\r\n    dropFiles: 'Dateien hier ablegen',\r\n    updateMessage: 'Nachricht aktualisieren',\r\n    noMembersSelected: 'Keine Mitglieder ausgewählt',\r\n    noUsersFound: 'Keine Benutzer gefunden',\r\n    you: 'Du',\r\n    enterGroupName: 'Gruppenname eingeben',\r\n    \r\n    // Social & Feed\r\n    feedAlgorithm: 'Feed-Algorithmus',\r\n    chronological: 'Chronologisch',\r\n    recommended: 'Empfohlen',\r\n    followingOnly: 'Nur Gefolgte',\r\n    autoPlayVideos: 'Videos im Feed Automatisch Abspielen',\r\n    showSensitiveContentWarning: 'Warnung für Sensiblen Inhalt Anzeigen',\r\n    showActivityStatus: 'Aktivitätsstatus Anzeigen',\r\n    showActivityStatusDescription: 'Anderen erlauben zu sehen, wann Sie aktiv sind',\r\n    showSuggestedAccounts: 'Vorgeschlagene Konten Anzeigen',\r\n    contentFiltering: 'Inhaltsfilterung',\r\n    sensitivityFilter: 'Empfindlichkeitsfilter',\r\n    off: 'Aus',\r\n    low: 'Niedrig',\r\n    medium: 'Mittel',\r\n    high: 'Hoch',\r\n    autoHideReported: 'Gemeldeten Inhalt Automatisch Ausblenden',\r\n    showAgeRestricted: 'Altersbeschränkten Inhalt Anzeigen',\r\n    mutedUsers: 'Stummgeschaltete Benutzer',\r\n    \r\n    // Bookings\r\n    autoAcceptBookings: 'Buchungen Automatisch Akzeptieren',\r\n    autoAcceptDescription: 'Buchungen automatisch akzeptieren, die Ihren Kriterien entsprechen',\r\n    defaultBufferTime: 'Standard-Pufferzeit',\r\n    bufferTimeDescription: 'Zeit zwischen Sitzungen',\r\n    minutes: 'Minuten',\r\n    showAvailabilityPublicly: 'Verfügbarkeitskalender Öffentlich Anzeigen',\r\n    requireDeposit: 'Anzahlung für Buchungen Erfordern',\r\n    autoDeclineExpired: 'Abgelaufene Buchungsanfragen Automatisch Ablehnen',\r\n    defaultSessionDuration: 'Standard-Sitzungsdauer',\r\n    \r\n    // Marketplace\r\n    autoListItem: 'Artikel Automatisch Auflisten',\r\n    autoListDescription: 'Artikel automatisch zum Verkauf auflisten',\r\n    requireApproval: 'Genehmigung Erfordern',\r\n    requireApprovalDescription: 'Artikel überprüfen, bevor sie veröffentlicht werden',\r\n    defaultShippingMethod: 'Standard-Versandmethode',\r\n    defaultPaymentTerms: 'Standard-Zahlungsbedingungen',\r\n    immediate: 'Sofort',\r\n    net15: 'Netto 15',\r\n    net30: 'Netto 30',\r\n    autoAcceptOffersAbove: 'Angebote Über dem Schwellenwert Automatisch Akzeptieren',\r\n    autoAcceptThreshold: 'Automatischer Akzeptanz-Schwellenwert',\r\n    showSoldItems: 'Verkaufte Artikel in Auflistungen Anzeigen',\r\n    \r\n    // Content & Media\r\n    imageQuality: 'Bildqualität',\r\n    videoQuality: 'Videoqualität',\r\n    high: 'Hoch',\r\n    medium: 'Mittel',\r\n    low: 'Niedrig (Schnelleres Laden)',\r\n    autoSaveUploaded: 'Hochgeladene Medien Automatisch Speichern',\r\n    autoSaveDescription: 'Hochgeladene Bilder und Videos automatisch speichern',\r\n    compressImages: 'Bilder Vor dem Hochladen Komprimieren',\r\n    compressDescription: 'Dateigröße für schnellere Uploads reduzieren',\r\n    maxUploadSize: 'Maximale Upload-Größe',\r\n    mb: 'MB',\r\n    \r\n    // Accessibility\r\n    fontSize: 'Schriftgröße',\r\n    small: 'Klein',\r\n    large: 'Groß',\r\n    extraLarge: 'Extra Groß',\r\n    reducedMotion: 'Reduzierte Bewegung',\r\n    reducedMotionDescription: 'Animationen für bessere Barrierefreiheit deaktivieren',\r\n    highContrast: 'Hoher Kontrast Modus',\r\n    highContrastDescription: 'Kontrast für bessere Sichtbarkeit erhöhen',\r\n    screenReaderAnnouncements: 'Bildschirmleser-Ankündigungen',\r\n    screenReaderDescription: 'Ankündigungen für Bildschirmleser aktivieren',\r\n    keyboardHints: 'Tastaturnavigations-Hinweise',\r\n    keyboardHintsDescription: 'Hinweise für Tastaturnavigation anzeigen',\r\n    \r\n    // Performance\r\n    dataUsage: 'Datenverbrauch',\r\n    wifiOnly: 'Nur WiFi (für Medien)',\r\n    auto: 'Automatisch',\r\n    never: 'Niemals (Daten sparen)',\r\n    offlineMode: 'Offline-Modus',\r\n    offlineModeDescription: 'Offline-Funktionalität aktivieren',\r\n    backgroundSync: 'Hintergrund-Synchronisation',\r\n    backgroundSyncDescription: 'Daten im Hintergrund synchronisieren',\r\n    autoClearOldNotifications: 'Alte Benachrichtigungen Automatisch Löschen',\r\n    clearAfter: 'Löschen Nach',\r\n    days: 'Tagen',\r\n    cacheManagement: 'Cache-Verwaltung',\r\n    clearCache: 'Cache Löschen',\r\n    clearCacheDescription: 'Gecachte Daten löschen, um Speicherplatz freizugeben',\r\n    \r\n    // Common\r\n    saveAll: 'Alles Speichern',\r\n    saving: 'Speichern...',\r\n    saved: 'Einstellungen erfolgreich gespeichert!',\r\n    saveFailed: 'Fehler beim Speichern der Einstellungen.',\r\n    settingsUpdated: 'Einstellungen aktualisiert!',\r\n    \r\n    // Navigation\r\n    dashboard: 'Dashboard',\r\n    socialNx: 'SocialNx',\r\n    messages: 'Nachrichten',\r\n    bookings: 'Buchungen',\r\n    marketplace: 'Marktplatz',\r\n    techServices: 'Technische Dienste',\r\n    businessCenter: 'Business Center',\r\n    profile: 'Profil',\r\n    billing: 'Abrechnung',\r\n    settings: 'Einstellungen',\r\n    logout: 'Abmelden',\r\n    search: 'Suchen',\r\n    searchPlaceholder: 'Suchen...',\r\n    notifications: 'Benachrichtigungen',\r\n    noNotifications: 'Keine Benachrichtigungen',\r\n    markAllRead: 'Alle als gelesen markieren',\r\n    clearAll: 'Alle löschen',\r\n    switchRole: 'Rolle Wechseln',\r\n    viewProfile: 'Profil Anzeigen',\r\n    \r\n    // Dashboard\r\n    goodMorning: 'Guten Morgen',\r\n    goodAfternoon: 'Guten Tag',\r\n    goodEvening: 'Guten Abend',\r\n    goodNight: 'Gute Nacht',\r\n    welcomeBack: 'Willkommen zurück',\r\n    quickActions: 'Schnellaktionen',\r\n    recentActivity: 'Letzte Aktivität',\r\n    upcomingBookings: 'Anstehende Buchungen',\r\n    noUpcomingBookings: 'Keine anstehenden Buchungen',\r\n    viewAll: 'Alle Anzeigen',\r\n    seeMore: 'Mehr Anzeigen',\r\n    newBooking: 'Neue Buchung',\r\n    viewCalendar: 'Kalender Anzeigen',\r\n    recentMessages: 'Letzte Nachrichten',\r\n    noRecentMessages: 'Keine letzten Nachrichten',\r\n    startConversation: 'Unterhaltung Starten',\r\n    trendingNow: 'Trending',\r\n    viewMarketplace: 'Marktplatz Anzeigen',\r\n    stats: 'Statistiken',\r\n    followers: 'Follower',\r\n    following: 'Folgen',\r\n    posts: 'Beiträge',\r\n    \r\n    // Social Feed\r\n    forYou: 'Für Dich',\r\n    following: 'Folgen',\r\n    discover: 'Entdecken',\r\n    createPost: 'Beitrag Erstellen',\r\n    whatOnMind: 'Woran denkst du?',\r\n    post: 'Beitrag',\r\n    like: 'Gefällt mir',\r\n    comment: 'Kommentieren',\r\n    share: 'Teilen',\r\n    save: 'Speichern',\r\n    repost: 'Weiterleiten',\r\n    follow: 'Folgen',\r\n    unfollow: 'Nicht Mehr Folgen',\r\n    noPosts: 'Noch keine Beiträge',\r\n    beFirst: 'Sei der Erste, der etwas teilt!',\r\n    noPostsFollowing: 'Keine letzten Beiträge von Personen, denen du folgst',\r\n    browseForYou: 'Für Dich Feed durchsuchen →',\r\n    suggestedForYou: 'Vorgeschlagen für dich',\r\n    startFollowing: 'Beginne, Kreativen zu folgen',\r\n    followDescription: 'Folge Künstlern, Ingenieuren und Studios, um ihre Beiträge in deinem Folgen-Feed zu sehen.',\r\n    \r\n    // Messages\r\n    selectConversation: 'Wähle eine Unterhaltung aus, um zu chatten',\r\n    typeMessage: 'Nachricht eingeben...',\r\n    send: 'Senden',\r\n    online: 'Online',\r\n    offline: 'Offline',\r\n    typing: 'tippt...',\r\n    newMessage: 'Neue Nachricht',\r\n    noConversations: 'Noch keine Unterhaltungen',\r\n    \r\n    // Chat Additional\r\n    searchConversations: 'Unterhaltungen suchen...',\r\n    newGroup: 'Neue Gruppe',\r\n    groupChat: 'Gruppenchat',\r\n    directMessage: 'Direktnachricht',\r\n    addMembers: 'Mitglieder Hinzufügen',\r\n    groupName: 'Gruppenname',\r\n    createGroup: 'Gruppe Erstellen',\r\n    noMessages: 'Noch keine Nachrichten',\r\n    messageDeleted: 'Nachricht gelöscht',\r\n    replyingTo: 'Antworten an',\r\n    editingMessage: 'Nachricht bearbeiten',\r\n    forwardingMessage: 'Nachricht weiterleiten',\r\n    unknownUser: 'Unbekannter Benutzer',\r\n    dropFiles: 'Dateien hier ablegen',\r\n    updateMessage: 'Nachricht aktualisieren',\r\n    noMembersSelected: 'Keine Mitglieder ausgewählt',\r\n    noUsersFound: 'Keine Benutzer gefunden',\r\n    you: 'Du',\r\n    enterGroupName: 'Gruppenname eingeben',\r\n    \r\n    // Bookings\r\n    myBookings: 'Meine Buchungen',\r\n    calendar: 'Kalender',\r\n    findTalent: 'Talent Finden',\r\n    broadcasts: 'Übertragungen',\r\n    createBroadcast: 'Übertragung Erstellen',\r\n    newSession: 'Neue Sitzung',\r\n    manageSessions: 'Verwalte deine Sitzungen und Buchungen',\r\n    upcoming: 'Anstehend',\r\n    past: 'Vergangen',\r\n    pending: 'Ausstehend',\r\n    confirmed: 'Bestätigt',\r\n    cancelled: 'Abgesagt',\r\n    noBookings: 'Keine Buchungen gefunden',\r\n    \r\n    // Common Actions\r\n    loading: 'Laden...',\r\n    error: 'Fehler',\r\n    success: 'Erfolg',\r\n    cancel: 'Abbrechen',\r\n    confirm: 'Bestätigen',\r\n    delete: 'Löschen',\r\n    edit: 'Bearbeiten',\r\n    save: 'Speichern',\r\n    close: 'Schließen',\r\n    back: 'Zurück',\r\n    next: 'Weiter',\r\n    previous: 'Zurück',\r\n    done: 'Fertig',\r\n    apply: 'Anwenden',\r\n    reset: 'Zurücksetzen',\r\n    filter: 'Filtern',\r\n    sort: 'Sortieren',\r\n    refresh: 'Aktualisieren',\r\n  },\r\n};\r\n\r\n// Get translation function\r\nexport function getTranslation(key, language = 'en') {\r\n  const lang = translations[language] || translations.en;\r\n  return lang[key] || translations.en[key] || key;\r\n}\r\n\r\n// Get all translations for a language\r\nexport function getTranslations(language = 'en') {\r\n  return translations[language] || translations.en;\r\n}\r\n\r\n","import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { getTranslation, getTranslations } from '../i18n/translations';\r\n\r\nconst LanguageContext = createContext();\r\n\r\nexport function LanguageProvider({ children, userData }) {\r\n  // Get language from settings or localStorage, default to 'en'\r\n  const [language, setLanguage] = useState(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const stored = localStorage.getItem('language');\r\n      if (stored) return stored;\r\n      return userData?.settings?.language || 'en';\r\n    }\r\n    return 'en';\r\n  });\r\n\r\n  // Update language when userData settings change\r\n  useEffect(() => {\r\n    if (userData?.settings?.language) {\r\n      setLanguage(userData.settings.language);\r\n      localStorage.setItem('language', userData.settings.language);\r\n      document.documentElement.lang = userData.settings.language;\r\n    }\r\n  }, [userData?.settings?.language]);\r\n\r\n  // Apply language to document\r\n  useEffect(() => {\r\n    document.documentElement.lang = language;\r\n    localStorage.setItem('language', language);\r\n  }, [language]);\r\n\r\n  const t = (key) => getTranslation(key, language);\r\n  const translations = getTranslations(language);\r\n\r\n  return (\r\n    <LanguageContext.Provider value={{ language, setLanguage, t, translations }}>\r\n      {children}\r\n    </LanguageContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useLanguage() {\r\n  const context = useContext(LanguageContext);\r\n  if (!context) {\r\n    // Fallback if not in provider\r\n    return {\r\n      language: 'en',\r\n      setLanguage: () => {},\r\n      t: (key) => key,\r\n      translations: getTranslations('en'),\r\n    };\r\n  }\r\n  return context;\r\n}\r\n\r\n","import { ConvexReactClient } from \"convex/react\";\r\n\r\n/**\r\n * Convex Configuration\r\n * \r\n * Supports both VITE_CONVEX_URL and CONVEX_DEPLOY_KEY environment variables.\r\n * CONVEX_DEPLOY_KEY is used by Vercel's Convex integration.\r\n * \r\n * If no URL is provided, a placeholder client is created to satisfy ConvexProvider requirements.\r\n * Hooks will work but won't connect until a real URL is provided.\r\n */\r\nconst convexUrl = import.meta.env.CONVEX_DEPLOY_KEY || import.meta.env.VITE_CONVEX_URL;\r\n\r\n// Always create a client - use placeholder URL if not configured\r\n// This ensures ConvexProvider always has a client, even if Convex isn't configured\r\n// The placeholder URL won't connect, but satisfies the URL format requirement\r\nconst clientUrl = convexUrl && typeof convexUrl === 'string' && convexUrl.trim() !== ''\r\n  ? convexUrl.trim()\r\n  : 'https://placeholder.convex.cloud';\r\n\r\nexport const convex = new ConvexReactClient(clientUrl);\r\n\r\n/**\r\n * Check if Convex is properly configured with a real URL\r\n * @returns {boolean} True if Convex URL is configured (not placeholder)\r\n */\r\nexport const isConvexAvailable = () => {\r\n  return Boolean(\r\n    convexUrl && \r\n    typeof convexUrl === 'string' && \r\n    convexUrl.trim() !== '' &&\r\n    clientUrl !== 'https://placeholder.convex.cloud'\r\n  );\r\n};\r\n\r\n","/**\r\n * Vercel Blob Storage Configuration\r\n *\r\n * This module configures Vercel Blob for file storage, replacing AWS S3.\r\n * Vercel Blob is a simple, fast object storage service optimized for Vercel deployments.\r\n *\r\n * Environment Variables Required:\r\n * - BLOB_READ_WRITE_TOKEN: Vercel Blob token (automatically set in Vercel deployments)\r\n *\r\n * Vercel Dashboard: https://vercel.com/dashboard\r\n * Documentation: https://vercel.com/docs/storage/vercel-blob\r\n *\r\n * @example\r\n * import { uploadFile, deleteFile, getFileUrl } from '@/config/vercel-blob';\r\n *\r\n * // Upload a file\r\n * const blob = await uploadFile(file, 'profile-photos');\r\n *\r\n * // Delete a file\r\n * await deleteFile(blob.url);\r\n *\r\n * // Get public URL\r\n * const url = getFileUrl(blob);\r\n */\r\n\r\nimport { put, del, list, head } from '@vercel/blob';\r\n\r\n// =====================================================\r\n// BLOB STORAGE CONFIGURATION\r\n// =====================================================\r\n\r\n/**\r\n * Vercel Blob Token\r\n *\r\n * In Vercel deployments, this is automatically set.\r\n * For local development, you need to set VITE_BLOB_READ_WRITE_TOKEN in .env.local\r\n */\r\nconst blobToken = import.meta.env.VITE_BLOB_READ_WRITE_TOKEN;\r\n\r\nif (!blobToken && import.meta.env.DEV) {\r\n  console.warn(\r\n    '⚠️ Vercel Blob: VITE_BLOB_READ_WRITE_TOKEN is not set. ' +\r\n    'File uploads will not work in development. ' +\r\n    'Install Vercel CLI and run: vercel link'\r\n  );\r\n}\r\n\r\n/**\r\n * Check if Vercel Blob is properly configured\r\n *\r\n * @returns {boolean} True if Blob token is present\r\n */\r\nexport function isBlobConfigured() {\r\n  return !!blobToken;\r\n}\r\n\r\n// =====================================================\r\n// STORAGE FOLDERS (Virtual Paths)\r\n// =====================================================\r\n\r\n/**\r\n * Storage folders for organizing files\r\n * These are used as prefixes in blob URLs\r\n */\r\nexport const STORAGE_FOLDERS = {\r\n  PROFILE_PHOTOS: 'profile-photos',\r\n  POST_MEDIA: 'post-media',\r\n  DOCUMENTS: 'documents',\r\n  STUDIO_IMAGES: 'studio-images',\r\n  GEAR_IMAGES: 'gear-images',\r\n  ATTACHMENTS: 'attachments',\r\n};\r\n\r\n/**\r\n * Get the storage folder for a specific media type\r\n *\r\n * @param {string} mediaType - Type of media (post, profile, document, etc.)\r\n * @returns {string} Storage folder path\r\n *\r\n * @example\r\n * getFolderForMediaType('profile'); // 'profile-photos'\r\n * getFolderForMediaType('post'); // 'post-media'\r\n */\r\nexport function getFolderForMediaType(mediaType) {\r\n  const folderMap = {\r\n    profile: STORAGE_FOLDERS.PROFILE_PHOTOS,\r\n    avatar: STORAGE_FOLDERS.PROFILE_PHOTOS,\r\n    post: STORAGE_FOLDERS.POST_MEDIA,\r\n    post_media: STORAGE_FOLDERS.POST_MEDIA,\r\n    document: STORAGE_FOLDERS.DOCUMENTS,\r\n    doc: STORAGE_FOLDERS.DOCUMENTS,\r\n    studio: STORAGE_FOLDERS.STUDIO_IMAGES,\r\n    gear: STORAGE_FOLDERS.GEAR_IMAGES,\r\n    attachment: STORAGE_FOLDERS.ATTACHMENTS,\r\n  };\r\n\r\n  return folderMap[mediaType] || STORAGE_FOLDERS.POST_MEDIA;\r\n}\r\n\r\n// =====================================================\r\n// FILE UPLOAD OPERATIONS\r\n// =====================================================\r\n\r\n/**\r\n * Upload a file to Vercel Blob\r\n *\r\n * @param {File|Blob} file - File to upload\r\n * @param {string} folder - Storage folder (e.g., 'profile-photos')\r\n * @param {Object} options - Upload options\r\n * @returns {Promise<Object>} Blob object with URL, metadata\r\n *\r\n * @example\r\n * // Upload a profile photo\r\n * const blob = await uploadFile(file, 'profile-photos');\r\n * console.log(blob.url); // https://blob.../profile-photos/user123.jpg\r\n *\r\n * // Upload with custom filename\r\n * const blob = await uploadFile(file, 'post-media', {\r\n *   addRandomSuffix: false,\r\n *   customFileName: 'my-custom-name'\r\n * });\r\n */\r\nexport async function uploadFile(file, folder = STORAGE_FOLDERS.POST_MEDIA, options = {}) {\r\n  if (!blobToken) {\r\n    throw new Error('Vercel Blob is not configured. Set VITE_BLOB_READ_WRITE_TOKEN environment variable.');\r\n  }\r\n\r\n  try {\r\n    // Generate unique filename (we handle random suffix ourselves to avoid CORS issues)\r\n    const timestamp = Date.now();\r\n    const randomString = Math.random().toString(36).substring(2, 8);\r\n    const extension = file.name?.split('.').pop() || 'jpg';\r\n    const filename = options.customFileName || `${folder}-${timestamp}-${randomString}.${extension}`;\r\n\r\n    // Full path with folder\r\n    const key = `${folder}/${filename}`;\r\n\r\n    // Upload to Vercel Blob with safe options only\r\n    // Note: addRandomSuffix option causes CORS errors in browser, so we handle it ourselves\r\n    const blob = await put(key, file, {\r\n      access: 'public',\r\n      token: blobToken,\r\n      contentType: file.type || 'application/octet-stream',\r\n    });\r\n\r\n    return {\r\n      url: blob.url,\r\n      downloadUrl: blob.downloadUrl,\r\n      pathname: blob.pathname,\r\n      size: blob.size,\r\n      uploadedAt: blob.uploadedAt,\r\n      contentType: blob.contentType,\r\n    };\r\n  } catch (error) {\r\n    console.error('Vercel Blob upload error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Upload multiple files\r\n *\r\n * @param {File[]} files - Array of files to upload\r\n * @param {string} folder - Storage folder\r\n * @param {Object} options - Upload options\r\n * @returns {Promise<Object[]>} Array of blob objects\r\n *\r\n * @example\r\n * const blobs = await uploadMultipleFiles(files, 'post-media');\r\n * console.log(blobs.map(b => b.url));\r\n */\r\nexport async function uploadMultipleFiles(files, folder = STORAGE_FOLDERS.POST_MEDIA, options = {}) {\r\n  const uploadPromises = files.map(file => uploadFile(file, folder, options));\r\n  return Promise.all(uploadPromises);\r\n}\r\n\r\n/**\r\n * Delete a file from Vercel Blob\r\n *\r\n * @param {string} url - Blob URL to delete\r\n * @returns {Promise<void>}\r\n *\r\n * @example\r\n * await deleteFile('https://blob.../profile-photos/user123.jpg');\r\n */\r\nexport async function deleteFile(url) {\r\n  if (!blobToken) {\r\n    throw new Error('Vercel Blob is not configured.');\r\n  }\r\n\r\n  try {\r\n    await del(url, { token: blobToken });\r\n  } catch (error) {\r\n    console.error('Vercel Blob delete error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Delete multiple files\r\n *\r\n * @param {string[]} urls - Array of blob URLs to delete\r\n * @returns {Promise<void>}\r\n *\r\n * @example\r\n * await deleteMultipleFiles([\r\n *   'https://blob.../file1.jpg',\r\n *   'https://blob.../file2.jpg'\r\n * ]);\r\n */\r\nexport async function deleteMultipleFiles(urls) {\r\n  if (!blobToken) {\r\n    throw new Error('Vercel Blob is not configured.');\r\n  }\r\n\r\n  try {\r\n    await del(urls, { token: blobToken });\r\n  } catch (error) {\r\n    console.error('Vercel Blob delete multiple error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// =====================================================\r\n// FILE RETRIEVAL OPERATIONS\r\n// =====================================================\r\n\r\n/**\r\n * Get file metadata without downloading\r\n *\r\n * @param {string} url - Blob URL\r\n * @returns {Promise<Object>} File metadata\r\n *\r\n * @example\r\n * const metadata = await getFileMetadata('https://blob.../file.jpg');\r\n * console.log(metadata.size, metadata.contentType);\r\n */\r\nexport async function getFileMetadata(url) {\r\n  if (!blobToken) {\r\n    throw new Error('Vercel Blob is not configured.');\r\n  }\r\n\r\n  try {\r\n    const metadata = await head(url, { token: blobToken });\r\n    return metadata;\r\n  } catch (error) {\r\n    console.error('Vercel Blob metadata error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * List all files in a folder\r\n *\r\n * @param {string} folder - Folder to list (e.g., 'profile-photos')\r\n * @returns {Promise<Object[]>} Array of blob objects\r\n *\r\n * @example\r\n * const files = await listFiles('profile-photos');\r\n * console.log(files.map(f => f.url));\r\n */\r\nexport async function listFiles(folder = '') {\r\n  if (!blobToken) {\r\n    throw new Error('Vercel Blob is not configured.');\r\n  }\r\n\r\n  try {\r\n    const result = await list({ prefix: folder, token: blobToken });\r\n    return result.blobs;\r\n  } catch (error) {\r\n    console.error('Vercel Blob list error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Get public URL for a blob\r\n *\r\n * @param {Object|string} blob - Blob object or URL string\r\n * @returns {string} Public URL\r\n *\r\n * @example\r\n * const url = getFileUrl(blob);\r\n * // or\r\n * const url = getFileUrl('https://blob.../file.jpg');\r\n */\r\nexport function getFileUrl(blob) {\r\n  if (typeof blob === 'string') {\r\n    return blob;\r\n  }\r\n  return blob?.url || null;\r\n}\r\n\r\n// =====================================================\r\n// UTILITY FUNCTIONS\r\n// =====================================================\r\n\r\n/**\r\n * Check if a file is an image\r\n *\r\n * @param {File} file - File to check\r\n * @returns {boolean} True if file is an image\r\n *\r\n * @example\r\n * if (isImageFile(file)) {\r\n *   // Handle image upload\r\n * }\r\n */\r\nexport function isImageFile(file) {\r\n  return file.type?.startsWith('image/') || false;\r\n}\r\n\r\n/**\r\n * Check if a file is a video\r\n *\r\n * @param {File} file - File to check\r\n * @returns {boolean} True if file is a video\r\n *\r\n * @example\r\n * if (isVideoFile(file)) {\r\n *   // Handle video upload\r\n * }\r\n */\r\nexport function isVideoFile(file) {\r\n  return file.type?.startsWith('video/') || false;\r\n}\r\n\r\n/**\r\n * Validate file size\r\n *\r\n * @param {File} file - File to validate\r\n * @param {number} maxSizeMB - Maximum size in megabytes\r\n * @returns {boolean} True if file is within size limit\r\n *\r\n * @example\r\n * if (!validateFileSize(file, 5)) {\r\n *   alert('File is too large. Maximum size is 5MB.');\r\n * }\r\n */\r\nexport function validateFileSize(file, maxSizeMB = 5) {\r\n  const maxSizeBytes = maxSizeMB * 1024 * 1024;\r\n  return file.size <= maxSizeBytes;\r\n}\r\n\r\n/**\r\n * Format file size for display\r\n *\r\n * @param {number} bytes - File size in bytes\r\n * @returns {string} Formatted size (e.g., \"2.5 MB\")\r\n *\r\n * @example\r\n * console.log(formatFileSize(2621440)); // \"2.5 MB\"\r\n */\r\nexport function formatFileSize(bytes) {\r\n  if (bytes === 0) return '0 Bytes';\r\n\r\n  const k = 1024;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\r\n}\r\n\r\n// =====================================================\r\n// REACT HOOK EXAMPLE (for reference)\r\n// =====================================================\r\n\r\n/**\r\n * Example React hook for file uploads\r\n *\r\n * This is a reference implementation. Use it in your components:\r\n *\r\n * @example\r\n * function ProfilePhotoUpload() {\r\n *   const [uploading, setUploading] = useState(false);\r\n *   const [photoUrl, setPhotoUrl] = useState(null);\r\n *\r\n *   const handleFileChange = async (e) => {\r\n *     const file = e.target.files[0];\r\n *     if (!file) return;\r\n *\r\n *     if (!isImageFile(file)) {\r\n *       toast.error('Please upload an image file');\r\n *       return;\r\n *     }\r\n *\r\n *     if (!validateFileSize(file, 5)) {\r\n *       toast.error('File size must be less than 5MB');\r\n *       return;\r\n *     }\r\n *\r\n *     setUploading(true);\r\n *     try {\r\n *       const blob = await uploadFile(file, STORAGE_FOLDERS.PROFILE_PHOTOS);\r\n *       setPhotoUrl(blob.url);\r\n *       toast.success('Photo uploaded successfully');\r\n *     } catch (error) {\r\n *       toast.error('Failed to upload photo');\r\n *       console.error(error);\r\n *     } finally {\r\n *       setUploading(false);\r\n *     }\r\n *   };\r\n *\r\n *   return (\r\n *     <input\r\n *       type=\"file\"\r\n *       onChange={handleFileChange}\r\n *       disabled={uploading}\r\n *       accept=\"image/*\"\r\n *     />\r\n *   );\r\n * }\r\n */\r\n\r\n/**\r\n * Development Notice\r\n *\r\n * For local development with Vercel Blob:\r\n * 1. Install Vercel CLI: npm i -g vercel\r\n * 2. Link your project: vercel link\r\n * 3. Pull environment variables: vercel env pull .env.local\r\n *\r\n * This will set BLOB_READ_WRITE_TOKEN in your local environment.\r\n *\r\n * For production deployment on Vercel, the token is automatically configured.\r\n */\r\n","import React, { useState } from 'react';\r\nimport { User, Users } from 'lucide-react';\r\nimport { clsx } from 'clsx';\r\nimport { twMerge } from 'tailwind-merge';\r\n\r\n// Helper to generate initials\r\nconst getInitials = (name) => {\r\n    if (!name) return '';\r\n    const parts = name.trim().split(' ').filter(Boolean);\r\n    if (parts.length >= 2) return (parts[0][0] + parts[1][0]).toUpperCase();\r\n    if (parts.length === 1 && parts[0].length >= 2) return parts[0].substring(0, 2).toUpperCase();\r\n    return parts[0]?.[0]?.toUpperCase() || '';\r\n};\r\n\r\n// Generate a consistent color based on the name\r\nconst getAvatarColor = (name) => {\r\n    if (!name) return 'from-brand-blue to-purple-600';\r\n    const colors = [\r\n        'from-brand-blue to-purple-600',\r\n        'from-emerald-500 to-teal-600',\r\n        'from-orange-500 to-red-600',\r\n        'from-pink-500 to-rose-600',\r\n        'from-indigo-500 to-blue-600',\r\n        'from-amber-500 to-orange-600',\r\n        'from-cyan-500 to-blue-600',\r\n        'from-violet-500 to-purple-600',\r\n    ];\r\n    const hash = name.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\r\n    return colors[hash % colors.length];\r\n};\r\n\r\nexport default function UserAvatar({ \r\n    src, \r\n    name, \r\n    size = 'md', // sizes: xs, sm, md, lg, xl, 2xl, 3xl\r\n    className, \r\n    onClick,\r\n    status, // 'online', 'offline' (optional)\r\n    isGroup = false,\r\n    square = false \r\n}) {\r\n    const [imgError, setImgError] = useState(false);\r\n    \r\n    const sizeClasses = {\r\n        xs: \"h-6 w-6 text-[10px]\",\r\n        sm: \"h-8 w-8 text-xs\",\r\n        md: \"h-10 w-10 text-sm\",\r\n        lg: \"h-12 w-12 text-base\",\r\n        xl: \"h-14 w-14 text-lg\",\r\n        '2xl': \"h-24 w-24 text-2xl\",\r\n        '3xl': \"h-32 w-32 text-4xl\"\r\n    };\r\n\r\n    const containerClass = twMerge(\r\n        clsx(\r\n            \"relative overflow-hidden flex items-center justify-center shrink-0 bg-gray-200 dark:bg-gray-700 border border-transparent transition-all select-none\",\r\n            square ? \"rounded-xl\" : \"rounded-full\",\r\n            sizeClasses[size],\r\n            onClick && \"cursor-pointer hover:opacity-90\",\r\n            className\r\n        )\r\n    );\r\n\r\n    const showFallback = !src || imgError;\r\n    const initials = getInitials(name);\r\n    const avatarColor = getAvatarColor(name);\r\n\r\n    return (\r\n        <div \r\n            className={containerClass} \r\n            onClick={onClick}\r\n            role={onClick ? \"button\" : undefined}\r\n            tabIndex={onClick ? 0 : undefined}\r\n            aria-label={name ? `${name}'s avatar` : 'User avatar'}\r\n        >\r\n            {!showFallback ? (\r\n                <img \r\n                    src={src} \r\n                    alt={name || \"Avatar\"} \r\n                    className=\"h-full w-full object-cover\" \r\n                    onError={() => setImgError(true)}\r\n                    loading=\"lazy\"\r\n                />\r\n            ) : (\r\n                <div className={`h-full w-full flex items-center justify-center bg-gradient-to-br ${avatarColor} text-white font-bold`}>\r\n                    {isGroup ? (\r\n                        <Users className=\"w-1/2 h-1/2\" aria-hidden=\"true\" />\r\n                    ) : initials ? (\r\n                        <span aria-hidden=\"true\">{initials}</span>\r\n                    ) : (\r\n                        <User className=\"w-1/2 h-1/2\" aria-hidden=\"true\" />\r\n                    )}\r\n                </div>\r\n            )}\r\n            \r\n            {/* Online Status Indicator */}\r\n            {status && (\r\n                <span \r\n                    className={clsx(\r\n                        \"absolute bottom-0 right-0 rounded-full border-2 border-white dark:border-gray-900\",\r\n                        status === 'online' ? \"bg-green-500\" : \"bg-gray-400\",\r\n                        size === 'xs' || size === 'sm' ? \"h-2 w-2\" : \"h-3.5 w-3.5\"\r\n                    )}\r\n                    aria-label={status === 'online' ? 'Online' : 'Offline'}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","/* eslint-disable */\r\n/**\r\n * Generated `api` utility.\r\n *\r\n * THIS CODE IS AUTOMATICALLY GENERATED.\r\n *\r\n * To regenerate, run `npx convex dev`.\r\n * @module\r\n */\r\n\r\nimport { anyApi, componentsGeneric } from \"convex/server\";\r\n\r\n/**\r\n * A utility for referencing Convex functions in your app's API.\r\n *\r\n * Usage:\r\n * ```js\r\n * const myFunctionReference = api.myModule.myFunction;\r\n * ```\r\n */\r\nexport const api = anyApi;\r\nexport const internal = anyApi;\r\nexport const components = componentsGeneric();\r\n","import { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { useQuery, useMutation } from \"convex/react\";\r\nimport { api } from \"../../convex/_generated/api\";\r\nimport { isConvexAvailable } from '../config/convex';\r\n\r\n/**\r\n * Hook for managing user online/offline presence\r\n * Automatically sets user as online when component mounts, offline when disconnects\r\n * * @param {string} userId - Current user's UID\r\n */\r\nexport function usePresence(userId) { //\r\n    const isOnlineRef = useRef(false);\r\n    // Hook must be called unconditionally (React rules)\r\n    const updatePresenceMutation = useMutation(api.presence.updatePresence);\r\n\r\n    useEffect(() => {\r\n        if (!userId || !isConvexAvailable()) return;\r\n\r\n        // Set user as online\r\n        updatePresenceMutation({\r\n            userId,\r\n            online: true,\r\n            lastSeen: Date.now(),\r\n        }).then(() => {\r\n            isOnlineRef.current = true;\r\n        }).catch((error) => {\r\n            console.error('Presence online error:', error);\r\n        });\r\n\r\n        // Set up interval to update lastSeen periodically\r\n        const interval = setInterval(() => {\r\n            if (isOnlineRef.current) {\r\n                updatePresenceMutation({\r\n                    userId,\r\n                    online: true,\r\n                    lastSeen: Date.now(),\r\n                }).catch(console.error);\r\n            }\r\n        }, 30000); // Update every 30 seconds\r\n\r\n        // Cleanup: Set offline when component unmounts\r\n        return () => {\r\n            clearInterval(interval);\r\n            if (isOnlineRef.current) {\r\n                updatePresenceMutation({\r\n                    userId,\r\n                    online: false,\r\n                    lastSeen: Date.now(),\r\n                }).catch(console.error);\r\n                isOnlineRef.current = false;\r\n            }\r\n        };\r\n    }, [userId]); // Remove updatePresenceMutation from deps - it's stable from useMutation\r\n}\r\n\r\n/**\r\n * Hook to subscribe to another user's presence status\r\n * * @param {string} userId - User ID to monitor\r\n * @returns {object} { online, lastSeen, loading }\r\n */\r\nexport function useUserPresence(userId) { //\r\n    // This removes the potential source of the \"Cannot access 'W' before initialization\" error.\r\n    const convexAvailable = isConvexAvailable(); //\r\n\r\n    const presenceQuery = useMemo(() => {\r\n        return userId && convexAvailable ? { userId } : \"skip\";\r\n    }, [userId, convexAvailable]);\r\n    \r\n    const presenceData = useQuery(\r\n        api.presence.getPresence,\r\n        presenceQuery\r\n    );\r\n\r\n    if (!presenceData) {\r\n        return { online: false, lastSeen: null, loading: !isConvexAvailable() };\r\n    }\r\n\r\n    return {\r\n        online: presenceData.online === true,\r\n        lastSeen: presenceData.lastSeen,\r\n        loading: false,\r\n    };\r\n}\r\n\r\n/**\r\n * Format last seen timestamp to human-readable string\r\n */\r\nexport function formatLastSeen(timestamp) {\r\n    if (!timestamp) return 'Never';\r\n    \r\n    const lastSeenMs = typeof timestamp === 'number' ? timestamp : timestamp;\r\n    const now = Date.now();\r\n    const diffMs = now - lastSeenMs;\r\n    const diffMins = Math.floor(diffMs / 60000);\r\n    const diffHours = Math.floor(diffMins / 60);\r\n    const diffDays = Math.floor(diffHours / 24);\r\n\r\n    if (diffMins < 1) return 'Just now';\r\n    if (diffMins < 60) return `${diffMins}m ago`;\r\n    if (diffHours < 24) return `${diffHours}h ago`;\r\n    if (diffDays < 7) return `${diffDays}d ago`;\r\n    \r\n    return new Date(lastSeenMs).toLocaleDateString();\r\n}\r\n","import React from 'react';\r\nimport { Circle } from 'lucide-react';\r\nimport { formatLastSeen } from '../../hooks/usePresence';\r\n\r\n/**\r\n * Component to show user online status\r\n */\r\nexport default function PresenceIndicator({ \r\n    online, \r\n    lastSeen, \r\n    showText = false,\r\n    size = 'sm' // 'xs' | 'sm' | 'md'\r\n}) {\r\n    const sizeClasses = {\r\n        xs: 'w-1.5 h-1.5',\r\n        sm: 'w-2 h-2',\r\n        md: 'w-2.5 h-2.5'\r\n    };\r\n\r\n    const textSizes = {\r\n        xs: 'text-[10px]',\r\n        sm: 'text-xs',\r\n        md: 'text-sm'\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-1.5\">\r\n            <div className=\"relative\">\r\n                <Circle \r\n                    className={`${sizeClasses[size]} ${\r\n                        online \r\n                            ? 'fill-green-500 text-green-500' \r\n                            : 'fill-gray-400 text-gray-400'\r\n                    }`}\r\n                />\r\n                {online && (\r\n                    <div className=\"absolute inset-0 animate-ping\">\r\n                        <Circle className={`${sizeClasses[size]} fill-green-500 opacity-75`} />\r\n                    </div>\r\n                )}\r\n            </div>\r\n            {showText && (\r\n                <span className={`${textSizes[size]} ${\r\n                    online ? 'text-green-500' : 'text-gray-400'\r\n                } font-medium`}>\r\n                    {online ? 'Online' : formatLastSeen(lastSeen)}\r\n                </span>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/**\r\n * Compact status badge for chat headers\r\n */\r\nexport function StatusBadge({ online, lastSeen, showLastSeen = false }) {\r\n    return (\r\n        <div className=\"flex items-center gap-1.5\">\r\n            <div className={`w-1.5 h-1.5 rounded-full ${online ? 'bg-green-500' : 'bg-gray-400'}`} />\r\n            <span className=\"text-xs text-gray-500\">\r\n                {online \r\n                    ? 'Online' \r\n                    : showLastSeen \r\n                        ? `Last seen ${formatLastSeen(lastSeen)}` \r\n                        : 'Offline'\r\n                }\r\n            </span>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React from 'react';\r\nimport { Trash2 } from 'lucide-react';\r\nimport UserAvatar from '../shared/UserAvatar';\r\nimport PresenceIndicator from './PresenceIndicator';\r\nimport { useUserPresence } from '../../hooks/usePresence';\r\n\r\n/**\r\n * Individual conversation item in sidebar with presence indicator\r\n */\r\nexport default function ConversationItem({ \r\n    conversation, \r\n    activeChat, \r\n    currentUserId, \r\n    onSelect, \r\n    onDelete \r\n}) {\r\n    // Get other user's UID for direct chats\r\n    const otherUserId = conversation.type === 'direct' \r\n        ? (conversation.uid || (conversation.id.includes('_') \r\n            ? conversation.id.split('_').find(id => id !== currentUserId) \r\n            : null))\r\n        : null;\r\n\r\n    // Get presence for direct chats\r\n    const { online, lastSeen } = useUserPresence(otherUserId || '');\r\n\r\n    return (\r\n        <div \r\n            onClick={() => onSelect(conversation)} \r\n            className={`group relative flex gap-3 p-4 cursor-pointer transition border-b dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-white/5 ${\r\n                activeChat?.id === conversation.id \r\n                    ? 'bg-blue-50 dark:bg-blue-900/10 border-l-4 border-l-brand-blue' \r\n                    : ''\r\n            }`}\r\n        >\r\n            <div className=\"relative shrink-0\">\r\n                <UserAvatar \r\n                    src={conversation.photo} \r\n                    name={conversation.n} \r\n                    size=\"lg\" \r\n                    isGroup={conversation.type === 'group'} \r\n                />\r\n                {/* Online indicator for direct chats */}\r\n                {conversation.type === 'direct' && otherUserId && (\r\n                    <div className=\"absolute -bottom-0.5 -right-0.5\">\r\n                        <PresenceIndicator \r\n                            online={online} \r\n                            lastSeen={lastSeen}\r\n                            size=\"xs\"\r\n                        />\r\n                    </div>\r\n                )}\r\n                {/* Unread count badge */}\r\n                {conversation.uc > 0 && (\r\n                    <div className=\"absolute -top-1 -right-1 h-5 w-5 bg-brand-blue text-white text-[10px] font-bold flex items-center justify-center rounded-full border-2 border-white dark:border-[#2c2e36]\">\r\n                        {conversation.uc > 99 ? '99+' : conversation.uc}\r\n                    </div>\r\n                )}\r\n            </div>\r\n            <div className=\"flex-1 min-w-0\">\r\n                <div className=\"flex justify-between items-baseline mb-1\">\r\n                    <h4 className={`text-sm truncate ${\r\n                        conversation.uc > 0 \r\n                            ? 'font-extrabold text-gray-900 dark:text-white' \r\n                            : 'font-bold text-gray-700 dark:text-gray-300'\r\n                    }`}>\r\n                        {conversation.n}\r\n                    </h4>\r\n                    <span className=\"text-[10px] text-gray-400 shrink-0 ml-2\">\r\n                        {conversation.lmt ? new Date(conversation.lmt).toLocaleDateString() : ''}\r\n                    </span>\r\n                </div>\r\n                <p className={`text-xs truncate ${\r\n                    conversation.uc > 0 \r\n                        ? 'text-gray-800 dark:text-gray-200 font-medium' \r\n                        : 'text-gray-500'\r\n                }`}>\r\n                    {conversation.ls === currentUserId ? 'You: ' : ''}{conversation.lm}\r\n                </p>\r\n            </div>\r\n            <button \r\n                onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    onDelete?.(conversation.id);\r\n                }} \r\n                className=\"absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-white dark:bg-gray-800 shadow-md rounded-full text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all z-10\"\r\n            >\r\n                <Trash2 size={16} />\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { X, Check, User as UserIcon, ChevronDown } from 'lucide-react';\r\nimport UserAvatar from './UserAvatar';\r\n\r\n/**\r\n * ProfileSelectionModal\r\n * A reusable modal for confirming which profile to use for posts, chats, etc.\r\n *\r\n * @param {boolean} show - Whether to show the modal\r\n * @param {function} onConfirm - Callback with selected role: (role) => void\r\n * @param {function} onCancel - Callback when user cancels: () => void\r\n * @param {object} userData - User data with account types and active role\r\n * @param {object} subProfiles - User's sub-profiles keyed by account type\r\n * @param {string} title - Modal title (default: \"Select Profile\")\r\n * @param {string} message - Additional message to show (optional)\r\n * @param {array} excludeRoles - Roles to exclude from selection (optional, e.g., ['Fan', 'User'])\r\n */\r\nexport default function ProfileSelectionModal({\r\n    show,\r\n    onConfirm,\r\n    onCancel,\r\n    userData,\r\n    subProfiles = {},\r\n    title = \"Select Profile\",\r\n    message = \"Which profile would you like to use?\",\r\n    excludeRoles = ['Fan', 'User'],\r\n}) {\r\n    const [step, setStep] = useState('confirm'); // 'confirm' or 'select'\r\n    const [selectedRole, setSelectedRole] = useState(null);\r\n\r\n    if (!show) return null;\r\n\r\n    const activeRole = userData?.activeProfileRole || userData?.accountTypes?.[0] || 'Fan';\r\n    const activeProfile = subProfiles?.[activeRole] || {};\r\n    const availableRoles = (userData?.accountTypes || [])\r\n        .filter(role => !excludeRoles.includes(role))\r\n        .filter(role => subProfiles?.[role]); // Only show roles that have sub-profiles\r\n\r\n    const getDisplayRole = (role) => {\r\n        if (!role || role === 'User' || role === 'Fan') return role || 'User';\r\n        if (role === 'Talent') {\r\n            const talentSub = subProfiles?.['Talent'];\r\n            const subRole = talentSub?.profile_data?.talentSubRole || talentSub?.talentSubRole;\r\n            if (subRole && subRole !== '') return subRole;\r\n        }\r\n        return role;\r\n    };\r\n\r\n    const getDisplayName = (role) => {\r\n        const profile = subProfiles?.[role];\r\n        return profile?.display_name || profile?.profile_data?.displayName || userData?.effectiveDisplayName || `${userData?.firstName || ''} ${userData?.lastName || ''}`.trim() || 'User';\r\n    };\r\n\r\n    const handleUseActive = () => {\r\n        onConfirm(activeRole);\r\n        resetModal();\r\n    };\r\n\r\n    const handleSelectDifferent = () => {\r\n        setStep('select');\r\n        setSelectedRole(activeRole);\r\n    };\r\n\r\n    const handleRoleSelect = (role) => {\r\n        setSelectedRole(role);\r\n    };\r\n\r\n    const handleConfirmSelection = () => {\r\n        if (selectedRole) {\r\n            onConfirm(selectedRole);\r\n            resetModal();\r\n        }\r\n    };\r\n\r\n    const resetModal = () => {\r\n        setStep('confirm');\r\n        setSelectedRole(null);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        resetModal();\r\n        onCancel();\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4\">\r\n            <div className=\"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl shadow-2xl animate-in zoom-in-95 border dark:border-gray-700\">\r\n                {/* Header */}\r\n                <div className=\"flex justify-between items-center p-4 border-b dark:border-gray-700\">\r\n                    <h3 className=\"text-lg font-bold dark:text-white flex items-center gap-2\">\r\n                        <UserIcon size={20} className=\"text-brand-blue\"/>\r\n                        {title}\r\n                    </h3>\r\n                    <button onClick={handleClose} className=\"text-gray-400 hover:text-gray-600 dark:hover:text-white\">\r\n                        <X size={20}/>\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"p-4\">\r\n                    {message && (\r\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">{message}</p>\r\n                    )}\r\n\r\n                    {step === 'confirm' && (\r\n                        <div className=\"space-y-4\">\r\n                            {/* Active Profile Display */}\r\n                            <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                                <div className=\"flex items-center gap-2 mb-3\">\r\n                                    <UserIcon size={16} className=\"text-brand-blue\"/>\r\n                                    <span className=\"text-sm font-bold text-brand-blue\">Current Active Profile</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <UserAvatar\r\n                                        src={activeProfile?.photo_url || userData?.photoURL}\r\n                                        name={getDisplayName(activeRole)}\r\n                                        size=\"lg\"\r\n                                    />\r\n                                    <div className=\"flex-1\">\r\n                                        <div className=\"font-bold dark:text-white\">{getDisplayName(activeRole)}</div>\r\n                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">{getDisplayRole(activeRole)}</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Action Buttons */}\r\n                            <div className=\"space-y-2\">\r\n                                <button\r\n                                    onClick={handleUseActive}\r\n                                    className=\"w-full bg-brand-blue text-white py-3 rounded-lg font-bold hover:bg-blue-600 flex items-center justify-center gap-2 shadow-lg\"\r\n                                >\r\n                                    <Check size={18}/> Yes, Use Active Profile\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleSelectDifferent}\r\n                                    className=\"w-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-3 rounded-lg font-bold hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <UserIcon size={18}/> No, Select Different Profile\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {step === 'select' && (\r\n                        <div className=\"space-y-3\">\r\n                            <p className=\"text-sm text-gray-500 dark:text-gray-400\">Choose a profile for this {title.toLowerCase()}:</p>\r\n\r\n                            {availableRoles.map(role => {\r\n                                const isSelected = selectedRole === role;\r\n                                const profile = subProfiles?.[role] || {};\r\n\r\n                                return (\r\n                                    <button\r\n                                        key={role}\r\n                                        onClick={() => handleRoleSelect(role)}\r\n                                        className={`w-full flex items-center gap-3 p-3 rounded-lg border-2 transition-all ${\r\n                                            isSelected\r\n                                                ? 'border-brand-blue bg-blue-50 dark:bg-blue-900/20'\r\n                                                : 'border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600'\r\n                                        }`}\r\n                                    >\r\n                                        <UserAvatar\r\n                                            src={profile?.photo_url}\r\n                                            name={getDisplayName(role)}\r\n                                            size=\"md\"\r\n                                        />\r\n                                        <div className=\"flex-1 text-left\">\r\n                                            <div className=\"font-bold dark:text-white\">{getDisplayName(role)}</div>\r\n                                            <div className=\"text-sm text-gray-500 dark:text-gray-400\">{getDisplayRole(role)}</div>\r\n                                        </div>\r\n                                        {isSelected && (\r\n                                            <div className=\"bg-brand-blue text-white p-1 rounded-full\">\r\n                                                <Check size={16} />\r\n                                            </div>\r\n                                        )}\r\n                                    </button>\r\n                                );\r\n                            })}\r\n\r\n                            <div className=\"flex gap-2 pt-2\">\r\n                                <button\r\n                                    onClick={handleConfirmSelection}\r\n                                    disabled={!selectedRole}\r\n                                    className=\"flex-1 bg-brand-blue text-white py-3 rounded-lg font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg\"\r\n                                >\r\n                                    <Check size={18}/> Confirm Selection\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setStep('confirm')}\r\n                                    className=\"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-3 rounded-lg font-bold hover:opacity-80\"\r\n                                >\r\n                                    Back\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Users, Plus, X, Search, Trash2, ArrowLeft, ChevronRight, Loader2 } from 'lucide-react';\r\nimport { useMutation } from \"convex/react\";\r\nimport { api } from \"../../../convex/_generated/api\";\r\nimport { isConvexAvailable } from '../../config/convex';\r\nimport ConversationItem from './ConversationItem';\r\nimport UserAvatar from '../shared/UserAvatar';\r\nimport ProfileSelectionModal from '../shared/ProfileSelectionModal';\r\nimport { useLanguage } from '../../contexts/LanguageContext';\r\n\r\nexport default function ChatSidebar({ user, userData, subProfiles = {}, conversations = [], activeChat, onSelectChat }) {\r\n    const { t } = useLanguage();\r\n    // ... (State logic unchanged) ...\r\n    const [showSearch, setShowSearch] = useState(false);\r\n    const [showGroupModal, setShowGroupModal] = useState(false);\r\n    const [showProfileModal, setShowProfileModal] = useState(false);\r\n    const [pendingChatTarget, setPendingChatTarget] = useState(null);\r\n    const [selectedChatProfile, setSelectedChatProfile] = useState(null);\r\n    const [searchMode, setSearchMode] = useState('direct');\r\n    const [isCreating, setIsCreating] = useState(false);\r\n\r\n    const [groupName, setGroupName] = useState('');\r\n    const [groupMembers, setGroupMembers] = useState([]);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [searchResults, setSearchResults] = useState([]);\r\n\r\n    // Convex mutations\r\n    const createGroupChatMutation = useMutation(api.conversations.createGroupChat);\r\n    const deleteConversationMutation = useMutation(api.conversations.deleteConversation);\r\n\r\n    // ... (Search & Group Functions unchanged) ...\r\n    const handleUserSearch = async (term) => {\r\n        setSearchQuery(term);\r\n        const searchTerm = term.trim();\r\n        if(searchTerm.length > 1 && supabase) {\r\n            const userId = user?.id || user?.uid;\r\n            try {\r\n                // Search by first name or last name\r\n                const { data: profiles, error } = await supabase\r\n                    .from('profiles')\r\n                    .select('id, first_name, last_name, avatar_url, active_role')\r\n                    .or(`first_name.ilike.%${searchTerm}%,last_name.ilike.%${searchTerm}%`)\r\n                    .neq('id', userId)\r\n                    .limit(20);\r\n                \r\n                if (error) throw error;\r\n                \r\n                const results = (profiles || []).map(profile => ({\r\n                    id: profile.id,\r\n                    firstName: profile.first_name,\r\n                    lastName: profile.last_name,\r\n                    photoURL: profile.avatar_url,\r\n                    role: profile.active_role\r\n                }));\r\n                \r\n                setSearchResults(results);\r\n            } catch (e) {\r\n                console.error(\"Search error:\", e);\r\n                setSearchResults([]);\r\n            }\r\n        } else {\r\n            setSearchResults([]);\r\n        }\r\n    };\r\n\r\n    const handleSelectSearchResult = (result) => {\r\n        const userId = user?.id || user?.uid;\r\n        if (searchMode === 'direct') {\r\n            // Show profile selection modal before creating chat\r\n            setPendingChatTarget(result);\r\n            setShowProfileModal(true);\r\n        } else if (searchMode === 'add_member') {\r\n            if (!groupMembers.find(m => m.id === result.id)) {\r\n                setGroupMembers(prev => [...prev, result]);\r\n            }\r\n            closeSearch();\r\n        }\r\n    };\r\n\r\n    const handleProfileConfirmed = (role) => {\r\n        setSelectedChatProfile(role);\r\n        if (pendingChatTarget) {\r\n            const userId = user?.id || user?.uid;\r\n            const chatId = [userId, pendingChatTarget.id].sort().join('_');\r\n            onSelectChat({\r\n                id: chatId,\r\n                uid: pendingChatTarget.id,\r\n                name: `${pendingChatTarget.firstName} ${pendingChatTarget.lastName}`,\r\n                type: 'direct',\r\n                profileRole: role // Store the selected profile role\r\n            });\r\n            setPendingChatTarget(null);\r\n        }\r\n        closeSearch();\r\n    };\r\n\r\n    const closeSearch = () => {\r\n        setShowSearch(false);\r\n        setSearchQuery('');\r\n        setSearchResults([]);\r\n    };\r\n\r\n    const openGroupModal = () => {\r\n        setGroupName('');\r\n        setGroupMembers([]);\r\n        setShowGroupModal(true);\r\n    };\r\n\r\n    const handleAddMemberClick = () => {\r\n        setSearchMode('add_member');\r\n        setShowSearch(true);\r\n    };\r\n\r\n    const handleCreateGroup = async () => {\r\n        if (!groupName || groupMembers.length === 0) return alert(\"Name and members required.\");\r\n        if (!isConvexAvailable()) {\r\n            alert(\"Chat functionality is not available. Convex is not configured.\");\r\n            return;\r\n        }\r\n        setIsCreating(true);\r\n\r\n        try {\r\n            const userId = user?.id || user?.uid;\r\n            const memberIds = groupMembers.map(m => m.id);\r\n            const { chatId: newGroupId } = await createGroupChatMutation({\r\n                creatorId: userId,\r\n                chatName: groupName,\r\n                memberIds,\r\n            });\r\n\r\n            setShowGroupModal(false);\r\n            onSelectChat({ id: newGroupId, name: groupName, type: 'group' });\r\n\r\n        } catch (e) {\r\n            console.error(\"Group creation failed\", e);\r\n            alert(\"Group creation failed: \" + e.message);\r\n        } finally {\r\n            setIsCreating(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteChat = async (e, chatId) => {\r\n        e.stopPropagation();\r\n        if (!window.confirm(\"Delete this conversation?\")) return;\r\n        if (!isConvexAvailable()) {\r\n            alert(\"Chat functionality is not available. Convex is not configured.\");\r\n            return;\r\n        }\r\n        try {\r\n            const userId = user?.id || user?.uid;\r\n            await deleteConversationMutation({ userId, chatId });\r\n            if (activeChat?.id === chatId) onSelectChat(null);\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full relative overflow-hidden bg-white dark:bg-[#1f2128]\">\r\n            <div className=\"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] shrink-0\">\r\n                <h2 className=\"font-extrabold text-lg dark:text-white tracking-tight\">{t('messages')}</h2>\r\n                <div className=\"flex gap-2\">\r\n                    <button onClick={openGroupModal} className=\"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition\" title={t('newGroup')}><Users size={18}/></button>\r\n                    <button onClick={() => { setSearchMode('direct'); setShowSearch(true); }} className=\"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition\" title={t('newMessage')}><Plus size={18}/></button>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"flex-1 overflow-y-auto\">\r\n                {conversations.map(c => (\r\n                    <ConversationItem\r\n                        key={c.id}\r\n                        conversation={c}\r\n                        activeChat={activeChat}\r\n                        currentUserId={user?.id || user?.uid}\r\n                        onSelect={onSelectChat}\r\n                        onDelete={(chatId) => {\r\n                            if (window.confirm(\"Delete this conversation?\")) {\r\n                                handleDeleteChat({ stopPropagation: () => {} }, chatId);\r\n                            }\r\n                        }}\r\n                    />\r\n                ))}\r\n            </div>\r\n\r\n            {/* ... (Modals remain the same, just showing structure) ... */}\r\n            {showGroupModal && (\r\n                <div className=\"absolute inset-0 bg-white dark:bg-[#1f2128] z-20 flex flex-col animate-in slide-in-from-right-10 duration-200\">\r\n                    <div className=\"p-4 border-b dark:border-gray-700 flex items-center gap-3 bg-gray-50 dark:bg-[#23262f]\">\r\n                        <button onClick={() => setShowGroupModal(false)} className=\"hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded-full\"><ArrowLeft size={20}/></button>\r\n                        <h3 className=\"font-bold dark:text-white\">{t('newGroup')}</h3>\r\n                    </div>\r\n                    \r\n                    <div className=\"p-4 flex-1 overflow-y-auto\">\r\n                        <div className=\"mb-6\">\r\n                            <label className=\"text-xs font-bold text-gray-500 uppercase mb-2 block\">1. {t('groupName')}</label>\r\n                            <input \r\n                                className=\"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none\" \r\n                                placeholder={t('groupName') + '...'} \r\n                                value={groupName} \r\n                                onChange={e=>setGroupName(e.target.value)} \r\n                                autoFocus\r\n                            />\r\n                        </div>\r\n\r\n                        <div>\r\n                            <div className=\"flex justify-between items-center mb-2\">\r\n                                <label className=\"text-xs font-bold text-gray-500 uppercase\">2. {t('addMembers')} ({groupMembers.length})</label>\r\n                                <button onClick={handleAddMemberClick} className=\"text-xs font-bold text-brand-blue flex items-center gap-1 hover:underline\"><Plus size={14}/> {t('addMembers')}</button>\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                {groupMembers.length === 0 ? (\r\n                                    <div className=\"text-center py-8 border-2 border-dashed dark:border-gray-700 rounded-xl text-gray-400 text-sm\">{t('noMembersSelected')}</div>\r\n                                ) : (\r\n                                    groupMembers.map(m => (\r\n                                        <div key={m.id} className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-white/5 rounded-lg border dark:border-gray-700\">\r\n                                            <div className=\"flex items-center gap-3\">\r\n                                                {/* FIX: UserAvatar for Member List */}\r\n                                                <UserAvatar src={m.photoURL} name={m.firstName} size=\"sm\" />\r\n                                                <span className=\"text-sm font-bold dark:text-white\">{m.firstName} {m.lastName}</span>\r\n                                            </div>\r\n                                            <button onClick={() => setGroupMembers(prev => prev.filter(p => p.id !== m.id))} className=\"text-gray-400 hover:text-red-500\"><X size={16}/></button>\r\n                                        </div>\r\n                                    ))\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"p-4 border-t dark:border-gray-700\">\r\n                        <button onClick={handleCreateGroup} disabled={!groupName || groupMembers.length === 0 || isCreating} className=\"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition shadow-lg flex justify-center items-center gap-2\">\r\n                            {isCreating ? <Loader2 className=\"animate-spin\" size={20}/> : <>{t('createGroup')} <ChevronRight size={18}/></>}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {showSearch && (\r\n                <div className=\"absolute inset-0 bg-white dark:bg-[#1f2128] z-30 flex flex-col animate-in fade-in duration-200\">\r\n                    <div className=\"p-3 border-b dark:border-gray-700 flex items-center gap-2 bg-white dark:bg-[#1f2128]\">\r\n                        <Search size={18} className=\"text-gray-400 ml-2\"/>\r\n                        <input autoFocus className=\"flex-1 p-2 bg-transparent outline-none dark:text-white placeholder-gray-400\" placeholder={t('search') + '...'} value={searchQuery} onChange={(e) => handleUserSearch(e.target.value)}/>\r\n                        <button onClick={closeSearch} className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full\"><X size={20} className=\"text-gray-500\"/></button>\r\n                    </div>\r\n                    <div className=\"flex-1 overflow-y-auto p-2\">\r\n                        {searchResults.length === 0 && searchQuery.length > 1 && <div className=\"text-center py-10 text-gray-400 text-sm\">{t('noUsersFound')}.</div>}\r\n                        {searchResults.map(res => {\r\n                            const isSelected = searchMode === 'add_member' && groupMembers.find(m => m.id === res.id);\r\n                            return (\r\n                                <div key={res.id} onClick={() => handleSelectSearchResult(res)} className={`flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl cursor-pointer transition mb-1 ${isSelected ? 'opacity-50 pointer-events-none' : ''}`}>\r\n                                    {/* FIX: UserAvatar for Search Results */}\r\n                                    <UserAvatar src={res.photoURL} name={res.firstName} size=\"md\" />\r\n                                    <div className=\"flex-1\">\r\n                                        <div className=\"text-sm font-bold dark:text-white\">{res.firstName} {res.lastName}</div>\r\n                                        <div className=\"text-xs text-gray-500\">{res.role || 'User'}</div>\r\n                                    </div>\r\n                                    {searchMode === 'add_member' && <Plus size={18} className=\"text-brand-blue\"/>}\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Profile Selection Modal */}\r\n            <ProfileSelectionModal\r\n                show={showProfileModal}\r\n                onConfirm={handleProfileConfirmed}\r\n                onCancel={() => {\r\n                    setShowProfileModal(false);\r\n                    setPendingChatTarget(null);\r\n                }}\r\n                userData={userData}\r\n                subProfiles={subProfiles}\r\n                title=\"Select Chat Profile\"\r\n                message={`You're starting a chat with ${pendingChatTarget?.firstName || 'this user'}. Which profile would you like to use?`}\r\n                excludeRoles={['Fan', 'User']}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","// src/hooks/useMediaUpload.js\r\n\r\nimport { useState } from 'react';\r\nimport { uploadFile, STORAGE_FOLDERS } from '../config/vercel-blob';\r\n\r\nexport const useMediaUpload = () => {\r\n  const [uploading, setUploading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  /**\r\n   * Uploads media file to Vercel Blob Storage.\r\n   * @param {File} file - The file to upload.\r\n   * @param {string} folder - The folder within storage (e.g., 'posts', 'profile-photos', 'chat').\r\n   * @returns {Promise<object|null>} Object containing media URL/reference and type.\r\n   */\r\n  const uploadMedia = async (file, folder = 'post-media') => {\r\n    if (!file) return null;\r\n\r\n    setUploading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Map folder names to Vercel Blob storage folders\r\n      let storageFolder = folder.replace('_', '-');\r\n      if (!storageFolder.startsWith('profile-') && !storageFolder.startsWith('post-')) {\r\n        // Default to post-media if not a recognized folder\r\n        storageFolder = STORAGE_FOLDERS.POST_MEDIA;\r\n      }\r\n\r\n      // Upload to Vercel Blob\r\n      const blob = await uploadFile(file, storageFolder);\r\n\r\n      // Determine media type\r\n      let mediaType = 'file';\r\n      if (file.type.startsWith('video/')) {\r\n        mediaType = 'video';\r\n      } else if (file.type.startsWith('audio/')) {\r\n        mediaType = 'audio';\r\n      } else if (file.type.startsWith('image/')) {\r\n        mediaType = 'image';\r\n      }\r\n\r\n      setUploading(false);\r\n\r\n      // Return object compatible with existing code that uses this hook\r\n      return {\r\n        url: blob.url,\r\n        previewUrl: blob.url, // For Vercel Blob, same as main URL\r\n        storageRef: blob.pathname, // Path in storage\r\n        type: mediaType,\r\n        name: file.name,\r\n        size: file.size,\r\n        mimeType: file.type,\r\n      };\r\n    } catch (err) {\r\n      console.error(\"Upload failed:\", err);\r\n      setError(err.message || 'An unknown error occurred during upload.');\r\n      setUploading(false);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  return { uploadMedia, uploading, error };\r\n};\r\n","import React, { useState, useMemo, useEffect } from 'react';\r\nimport { Search, X, Clock } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\n// Emoji categories with popular emojis\r\nconst EMOJI_CATEGORIES = {\r\n    'Recent': ['👍', '❤️', '😂', '😮', '😢', '🔥', '🎉', '👏'],\r\n    'Smileys': ['😀', '😃', '😄', '😁', '😆', '😅', '🤣', '😂', '🙂', '🙃', '😉', '😊', '😇', '🥰', '😍', '🤩', '😘', '😗', '😚', '😙', '😋', '😛', '😜', '🤪', '😝', '🤑', '🤗', '🤭', '🤫', '🤔', '🤐', '🤨', '😐', '😑', '😶', '😏', '😒', '🙄', '😬', '🤥', '😌', '😔', '😪', '🤤', '😴', '😷', '🤒', '🤕', '🤢', '🤮'],\r\n    'Gestures': ['👋', '🤚', '🖐️', '✋', '🖖', '👌', '🤌', '🤏', '✌️', '🤞', '🤟', '🤘', '🤙', '👈', '👉', '👆', '🖕', '👇', '☝️', '👍', '👎', '✊', '👊', '🤛', '🤜', '👏', '🙌', '👐', '🤲', '🤝', '🙏'],\r\n    'Hearts': ['❤️', '🧡', '💛', '💚', '💙', '💜', '🖤', '🤍', '🤎', '💔', '❤️‍🔥', '❤️‍🩹', '💕', '💞', '💓', '💗', '💖', '💘', '💝', '💟'],\r\n    'Objects': ['💎', '🔔', '🔕', '🎵', '🎶', '🎤', '🎧', '📻', '🎷', '🎺', '🎸', '🎹', '🎮', '🕹️', '🎯', '🎲', '🎳', '🎴', '🃏', '🀄', '🎰', '📱', '📞', '☎️', '📟', '📠', '💻', '🖥️', '🖨️', '⌨️', '🖱️', '🖲️', '🕹️', '🗜️', '💾', '💿', '📀'],\r\n    'Flags': ['🏳️', '🏴', '🏁', '🚩', '🏳️‍🌈', '🏳️‍⚧️', '🇺🇸', '🇬🇧', '🇨🇦', '🇦🇺', '🇫🇷', '🇩🇪', '🇮🇹', '🇪🇸', '🇯🇵', '🇰🇷', '🇨🇳', '🇮🇳', '🇧🇷', '🇲🇽'],\r\n    'Music': ['🎵', '🎶', '🎤', '🎧', '📻', '🎷', '🎺', '🎸', '🎹', '🥁', '🪘', '🎻', '🎪', '🎭', '🎨', '🎬', '🎤', '🎧', '🎼', '🎹'],\r\n    'Reactions': ['👍', '👎', '❤️', '🔥', '😂', '😮', '😢', '👏', '🙌', '🤝', '🤗', '🤔', '🤦', '🤷', '🙏', '👀', '💪', '🤘', '✌️', '🤞']\r\n};\r\n\r\n// Get all emojis for search\r\nconst ALL_EMOJIS = Object.values(EMOJI_CATEGORIES).flat();\r\n\r\n/**\r\n * Full-featured emoji picker with categories, search, and recent emojis\r\n */\r\nexport default function EmojiPicker({ \r\n    onSelect, \r\n    onClose,\r\n    position = 'bottom' // 'top' | 'bottom'\r\n}) {\r\n    const [activeCategory, setActiveCategory] = useState('Recent');\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [recentEmojis, setRecentEmojis] = useState(() => {\r\n        // Load from localStorage\r\n        const stored = localStorage.getItem('recentEmojis');\r\n        return stored ? JSON.parse(stored) : EMOJI_CATEGORIES['Recent'];\r\n    });\r\n\r\n    // Filter emojis by search\r\n    const filteredEmojis = useMemo(() => {\r\n        if (!searchQuery.trim()) {\r\n            return activeCategory === 'Recent' \r\n                ? recentEmojis \r\n                : EMOJI_CATEGORIES[activeCategory] || [];\r\n        }\r\n        \r\n        // Simple search - in production you'd want emoji keywords\r\n        return ALL_EMOJIS.filter(emoji => \r\n            emoji.includes(searchQuery) || searchQuery.includes(emoji)\r\n        );\r\n    }, [searchQuery, activeCategory, recentEmojis]);\r\n\r\n    const handleEmojiSelect = (emoji) => {\r\n        // Add to recent (max 8)\r\n        const updatedRecent = [emoji, ...recentEmojis.filter(e => e !== emoji)].slice(0, 8);\r\n        setRecentEmojis(updatedRecent);\r\n        localStorage.setItem('recentEmojis', JSON.stringify(updatedRecent));\r\n        \r\n        onSelect(emoji);\r\n        if (onClose) onClose();\r\n    };\r\n\r\n    const categories = Object.keys(EMOJI_CATEGORIES);\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0, scale: 0.95, y: position === 'bottom' ? -10 : 10 }}\r\n            animate={{ opacity: 1, scale: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.95 }}\r\n            className={`\r\n                absolute ${position === 'bottom' ? 'bottom-full mb-2' : 'top-full mt-2'} \r\n                left-0\r\n                w-[340px] bg-white dark:bg-gray-800 \r\n                rounded-2xl shadow-2xl border dark:border-gray-700\r\n                z-50 overflow-hidden\r\n            `}\r\n        >\r\n            {/* Header with search */}\r\n            <div className=\"p-3 border-b dark:border-gray-700\">\r\n                <div className=\"relative mb-3\">\r\n                    <Search size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Search emojis...\"\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                        className=\"w-full pl-9 pr-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white\"\r\n                    />\r\n                    {searchQuery && (\r\n                        <button\r\n                            onClick={() => setSearchQuery('')}\r\n                            className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\r\n                        >\r\n                            <X size={16} />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Category tabs */}\r\n                <div className=\"flex gap-1 overflow-x-auto scrollbar-hide\">\r\n                    {categories.map(category => (\r\n                        <button\r\n                            key={category}\r\n                            onClick={() => setActiveCategory(category)}\r\n                            className={`\r\n                                px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition\r\n                                ${activeCategory === category\r\n                                    ? 'bg-brand-blue text-white'\r\n                                    : 'bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n                                }\r\n                            `}\r\n                        >\r\n                            {category === 'Recent' ? (\r\n                                <Clock size={12} className=\"inline mr-1\" />\r\n                            ) : null}\r\n                            {category}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Emoji grid */}\r\n            <div className=\"h-[280px] overflow-y-auto custom-scrollbar p-3\">\r\n                {filteredEmojis.length === 0 ? (\r\n                    <div className=\"flex flex-col items-center justify-center h-full text-gray-400\">\r\n                        <p className=\"text-sm\">No emojis found</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-8 gap-1\">\r\n                        {filteredEmojis.map((emoji, index) => (\r\n                            <motion.button\r\n                                key={`${emoji}-${index}`}\r\n                                whileHover={{ scale: 1.2 }}\r\n                                whileTap={{ scale: 0.9 }}\r\n                                onClick={() => handleEmojiSelect(emoji)}\r\n                                className=\"w-10 h-10 flex items-center justify-center text-xl rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition\"\r\n                            >\r\n                                {emoji}\r\n                            </motion.button>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </motion.div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Search, X, Loader2, TrendingUp } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\n// Giphy API key - should be in environment variables\r\nconst GIPHY_API_KEY = import.meta.env.VITE_GIPHY_API_KEY || 'demo_key';\r\nconst GIPHY_BASE_URL = 'https://api.giphy.com/v1/gifs';\r\n\r\n/**\r\n * GIF picker component with Giphy integration\r\n */\r\nexport default function GifPicker({ \r\n    onSelect, \r\n    onClose,\r\n    position = 'bottom'\r\n}) {\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [gifs, setGifs] = useState([]);\r\n    const [trendingGifs, setTrendingGifs] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [activeTab, setActiveTab] = useState('trending'); // 'trending' | 'search'\r\n    const searchTimeoutRef = useRef(null);\r\n\r\n    // Load trending GIFs on mount\r\n    useEffect(() => {\r\n        loadTrending();\r\n    }, []);\r\n\r\n    // Search with debounce\r\n    useEffect(() => {\r\n        if (searchQuery.trim()) {\r\n            setActiveTab('search');\r\n            if (searchTimeoutRef.current) {\r\n                clearTimeout(searchTimeoutRef.current);\r\n            }\r\n            searchTimeoutRef.current = setTimeout(() => {\r\n                searchGifs(searchQuery);\r\n            }, 500);\r\n        } else {\r\n            setActiveTab('trending');\r\n            setGifs([]);\r\n        }\r\n        return () => {\r\n            if (searchTimeoutRef.current) {\r\n                clearTimeout(searchTimeoutRef.current);\r\n            }\r\n        };\r\n    }, [searchQuery]);\r\n\r\n    const loadTrending = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const response = await fetch(\r\n                `${GIPHY_BASE_URL}/trending?api_key=${GIPHY_API_KEY}&limit=24&rating=g`\r\n            );\r\n            const data = await response.json();\r\n            if (data.data) {\r\n                setTrendingGifs(data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Giphy trending error:', error);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const searchGifs = async (query) => {\r\n        if (!query.trim()) return;\r\n        \r\n        setLoading(true);\r\n        try {\r\n            const response = await fetch(\r\n                `${GIPHY_BASE_URL}/search?api_key=${GIPHY_API_KEY}&q=${encodeURIComponent(query)}&limit=24&rating=g`\r\n            );\r\n            const data = await response.json();\r\n            if (data.data) {\r\n                setGifs(data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Giphy search error:', error);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleGifSelect = (gif) => {\r\n        onSelect?.({\r\n            url: gif.images.fixed_height.url || gif.images.original.url,\r\n            previewUrl: gif.images.preview_gif.url || gif.images.fixed_height_small.url,\r\n            width: gif.images.fixed_height.width,\r\n            height: gif.images.fixed_height.height,\r\n            title: gif.title || 'GIF'\r\n        });\r\n        if (onClose) onClose();\r\n    };\r\n\r\n    const displayGifs = activeTab === 'trending' ? trendingGifs : gifs;\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0, scale: 0.95, y: position === 'bottom' ? -10 : 10 }}\r\n            animate={{ opacity: 1, scale: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.95 }}\r\n            className={`\r\n                absolute ${position === 'bottom' ? 'bottom-full mb-2' : 'top-full mt-2'} \r\n                left-0\r\n                w-[380px] bg-white dark:bg-gray-800 \r\n                rounded-2xl shadow-2xl border dark:border-gray-700\r\n                z-50 overflow-hidden\r\n            `}\r\n        >\r\n            {/* Header */}\r\n            <div className=\"p-3 border-b dark:border-gray-700\">\r\n                <div className=\"relative\">\r\n                    <Search size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Search GIFs...\"\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                        className=\"w-full pl-9 pr-10 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white\"\r\n                    />\r\n                    {searchQuery && (\r\n                        <button\r\n                            onClick={() => setSearchQuery('')}\r\n                            className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\r\n                        >\r\n                            <X size={16} />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* GIF Grid */}\r\n            <div className=\"h-[320px] overflow-y-auto custom-scrollbar p-3\">\r\n                {loading ? (\r\n                    <div className=\"flex flex-col items-center justify-center h-full\">\r\n                        <Loader2 className=\"animate-spin text-brand-blue mb-2\" size={24} />\r\n                        <p className=\"text-sm text-gray-500\">Loading GIFs...</p>\r\n                    </div>\r\n                ) : displayGifs.length === 0 ? (\r\n                    <div className=\"flex flex-col items-center justify-center h-full text-gray-400\">\r\n                        <TrendingUp size={32} className=\"mb-2 opacity-50\" />\r\n                        <p className=\"text-sm\">\r\n                            {activeTab === 'search' \r\n                                ? 'No GIFs found. Try a different search.'\r\n                                : 'Loading trending GIFs...'\r\n                            }\r\n                        </p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-2 gap-2\">\r\n                        {displayGifs.map((gif) => (\r\n                            <motion.div\r\n                                key={gif.id}\r\n                                whileHover={{ scale: 1.02 }}\r\n                                whileTap={{ scale: 0.98 }}\r\n                                onClick={() => handleGifSelect(gif)}\r\n                                className=\"relative aspect-square rounded-lg overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-700 group\"\r\n                            >\r\n                                <img\r\n                                    src={gif.images.fixed_height_small.url || gif.images.preview_gif.url}\r\n                                    alt={gif.title}\r\n                                    className=\"w-full h-full object-cover\"\r\n                                    loading=\"lazy\"\r\n                                />\r\n                                <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition\" />\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Footer */}\r\n            <div className=\"p-2 border-t dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-center\">\r\n                <p className=\"text-[10px] text-gray-400\">\r\n                    Powered by <span className=\"font-bold\">GIPHY</span>\r\n                </p>\r\n            </div>\r\n        </motion.div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { Video, StopCircle, X, Check, Loader2, Camera, CameraOff } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\n/**\r\n * Video message recorder component\r\n * Records short video clips for messages\r\n */\r\nexport default function VideoRecorder({ \r\n    onRecorded, \r\n    onClose,\r\n    maxDuration = 60 // seconds\r\n}) {\r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const [recordedBlob, setRecordedBlob] = useState(null);\r\n    const [recordingTime, setRecordingTime] = useState(0);\r\n    const [hasPermission, setHasPermission] = useState(null);\r\n    const [error, setError] = useState(null);\r\n    \r\n    const videoRef = useRef(null);\r\n    const streamRef = useRef(null);\r\n    const mediaRecorderRef = useRef(null);\r\n    const chunksRef = useRef([]);\r\n    const timerRef = useRef(null);\r\n\r\n    // Request camera/mic access\r\n    useEffect(() => {\r\n        requestPermissions();\r\n        return () => {\r\n            cleanup();\r\n        };\r\n    }, []);\r\n\r\n    const requestPermissions = async () => {\r\n        try {\r\n            const stream = await navigator.mediaDevices.getUserMedia({ \r\n                video: { facingMode: 'user' },\r\n                audio: true \r\n            });\r\n            streamRef.current = stream;\r\n            \r\n            if (videoRef.current) {\r\n                videoRef.current.srcObject = stream;\r\n            }\r\n            setHasPermission(true);\r\n            setError(null);\r\n        } catch (err) {\r\n            console.error('Permission error:', err);\r\n            setHasPermission(false);\r\n            setError('Camera/microphone access denied');\r\n        }\r\n    };\r\n\r\n    const cleanup = () => {\r\n        if (streamRef.current) {\r\n            streamRef.current.getTracks().forEach(track => track.stop());\r\n            streamRef.current = null;\r\n        }\r\n        if (timerRef.current) {\r\n            clearInterval(timerRef.current);\r\n        }\r\n    };\r\n\r\n    const startRecording = async () => {\r\n        if (!streamRef.current) {\r\n            await requestPermissions();\r\n            return;\r\n        }\r\n\r\n        try {\r\n            chunksRef.current = [];\r\n            const options = {\r\n                mimeType: 'video/webm;codecs=vp9,opus',\r\n                videoBitsPerSecond: 2500000\r\n            };\r\n\r\n            mediaRecorderRef.current = new MediaRecorder(streamRef.current, options);\r\n            \r\n            mediaRecorderRef.current.ondataavailable = (e) => {\r\n                if (e.data.size > 0) {\r\n                    chunksRef.current.push(e.data);\r\n                }\r\n            };\r\n\r\n            mediaRecorderRef.current.onstop = () => {\r\n                const blob = new Blob(chunksRef.current, { type: 'video/webm' });\r\n                setRecordedBlob(blob);\r\n                setIsRecording(false);\r\n                setRecordingTime(0);\r\n                if (timerRef.current) {\r\n                    clearInterval(timerRef.current);\r\n                }\r\n            };\r\n\r\n            mediaRecorderRef.current.start();\r\n            setIsRecording(true);\r\n            setRecordingTime(0);\r\n\r\n            // Timer\r\n            timerRef.current = setInterval(() => {\r\n                setRecordingTime(prev => {\r\n                    const newTime = prev + 1;\r\n                    if (newTime >= maxDuration) {\r\n                        stopRecording();\r\n                    }\r\n                    return newTime;\r\n                });\r\n            }, 1000);\r\n\r\n        } catch (err) {\r\n            console.error('Recording error:', err);\r\n            setError('Failed to start recording');\r\n        }\r\n    };\r\n\r\n    const stopRecording = () => {\r\n        if (mediaRecorderRef.current && isRecording) {\r\n            mediaRecorderRef.current.stop();\r\n        }\r\n    };\r\n\r\n    const handleDiscard = () => {\r\n        setRecordedBlob(null);\r\n        setRecordingTime(0);\r\n        setIsRecording(false);\r\n    };\r\n\r\n    const handleSend = () => {\r\n        if (recordedBlob) {\r\n            const file = new File([recordedBlob], `video_${Date.now()}.webm`, { type: 'video/webm' });\r\n            onRecorded?.(file);\r\n            cleanup();\r\n            onClose?.();\r\n        }\r\n    };\r\n\r\n    const formatTime = (seconds) => {\r\n        const mins = Math.floor(seconds / 60);\r\n        const secs = seconds % 60;\r\n        return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    if (!hasPermission && hasPermission !== null) {\r\n        return (\r\n            <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4\">\r\n                <motion.div\r\n                    initial={{ opacity: 0, scale: 0.95 }}\r\n                    animate={{ opacity: 1, scale: 1 }}\r\n                    className=\"bg-white dark:bg-[#2c2e36] rounded-2xl p-6 max-w-sm\"\r\n                >\r\n                    <div className=\"text-center\">\r\n                        <CameraOff size={48} className=\"text-red-500 mx-auto mb-4\" />\r\n                        <h3 className=\"text-lg font-bold dark:text-white mb-2\">Camera Access Required</h3>\r\n                        <p className=\"text-sm text-gray-500 mb-4\">\r\n                            Please allow camera and microphone access to record video messages.\r\n                        </p>\r\n                        <div className=\"flex gap-2\">\r\n                            <button\r\n                                onClick={onClose}\r\n                                className=\"flex-1 px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200 transition\"\r\n                            >\r\n                                Cancel\r\n                            </button>\r\n                            <button\r\n                                onClick={requestPermissions}\r\n                                className=\"flex-1 px-4 py-2 bg-brand-blue text-white rounded-lg text-sm font-semibold hover:bg-blue-600 transition\"\r\n                            >\r\n                                Allow Access\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-[80]\">\r\n            <motion.div\r\n                initial={{ opacity: 0, scale: 0.95 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                className=\"relative w-full max-w-2xl aspect-video bg-black rounded-2xl overflow-hidden\"\r\n            >\r\n                {/* Video preview */}\r\n                <video\r\n                    ref={videoRef}\r\n                    autoPlay\r\n                    muted\r\n                    playsInline\r\n                    className=\"w-full h-full object-cover\"\r\n                />\r\n\r\n                {/* Recording overlay */}\r\n                {isRecording && (\r\n                    <div className=\"absolute top-4 left-1/2 -translate-x-1/2 flex items-center gap-2 bg-red-500 text-white px-4 py-2 rounded-full\">\r\n                        <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\" />\r\n                        <span className=\"text-sm font-bold\">{formatTime(recordingTime)}</span>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Controls */}\r\n                <div className=\"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent\">\r\n                    <div className=\"flex items-center justify-center gap-4\">\r\n                        {!recordedBlob ? (\r\n                            <>\r\n                                {!isRecording ? (\r\n                                    <>\r\n                                        <button\r\n                                            onClick={onClose}\r\n                                            className=\"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition\"\r\n                                        >\r\n                                            <X size={24} />\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={startRecording}\r\n                                            className=\"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg\"\r\n                                        >\r\n                                            <Video size={28} />\r\n                                        </button>\r\n                                        <div className=\"w-12\" /> {/* Spacer */}\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <button\r\n                                            onClick={handleDiscard}\r\n                                            className=\"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition\"\r\n                                        >\r\n                                            <X size={24} />\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={stopRecording}\r\n                                            className=\"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg animate-pulse\"\r\n                                        >\r\n                                            <StopCircle size={28} />\r\n                                        </button>\r\n                                        <div className=\"w-12\" /> {/* Spacer */}\r\n                                    </>\r\n                                )}\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <button\r\n                                    onClick={handleDiscard}\r\n                                    className=\"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition\"\r\n                                >\r\n                                    <X size={24} />\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleSend}\r\n                                    className=\"p-4 bg-green-500 hover:bg-green-600 rounded-full text-white transition shadow-lg\"\r\n                                >\r\n                                    <Check size={28} />\r\n                                </button>\r\n                                <div className=\"w-12\" /> {/* Spacer */}\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Error message */}\r\n                {error && (\r\n                    <div className=\"absolute top-4 left-4 bg-red-500 text-white px-4 py-2 rounded-lg text-sm\">\r\n                        {error}\r\n                    </div>\r\n                )}\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import { useState, useEffect, useRef, useCallback, useMemo } from 'react';\r\nimport { useQuery, useMutation } from \"convex/react\";\r\nimport { api } from \"../../convex/_generated/api\";\r\nimport { isConvexAvailable } from '../config/convex';\r\n\r\n/**\r\n * Hook for managing typing indicators in a chat\r\n * @param {string} chatId - Current chat ID\r\n * @param {string} userId - Current user's UID\r\n * @param {string} userName - Current user's display name\r\n * @returns {object} { typingUsers, setTyping, clearTyping }\r\n */\r\nexport function useTypingIndicator(chatId, userId, userName) {\r\n    const typingTimeoutRef = useRef(null);\r\n    const isTypingRef = useRef(false);\r\n    \r\n    // Check Convex availability\r\n    const convexAvailable = isConvexAvailable();\r\n    \r\n    // Query typing indicators for the current chat\r\n    const typingQuery = useMemo(() => {\r\n        return chatId && convexAvailable ? { chatId } : \"skip\";\r\n    }, [chatId, convexAvailable]);\r\n    \r\n    const typingData = useQuery(\r\n        api.presence.getTypingIndicators,\r\n        typingQuery\r\n    );\r\n    \r\n    // Mutation to update typing status\r\n    const updateTypingMutation = useMutation(api.presence.updateTypingIndicator);\r\n    const clearTypingMutation = useMutation(api.presence.clearTypingIndicator);\r\n    \r\n    // Filter out current user from typing indicators\r\n    const typingUsers = useMemo(() => {\r\n        if (!typingData) return [];\r\n        return typingData\r\n            .filter(indicator => indicator.userId !== userId && indicator.isTyping)\r\n            .map(indicator => ({\r\n                id: indicator.userId,\r\n                name: indicator.userName,\r\n            }));\r\n    }, [typingData, userId]);\r\n    \r\n    // Set typing status with auto-clear after delay\r\n    const setTyping = useCallback(() => {\r\n        if (!chatId || !userId || !convexAvailable) return;\r\n        \r\n        // Only update if not already marked as typing\r\n        if (!isTypingRef.current) {\r\n            isTypingRef.current = true;\r\n            updateTypingMutation({\r\n                chatId,\r\n                userId,\r\n                userName: userName || 'User',\r\n                isTyping: true,\r\n            }).catch(console.error);\r\n        }\r\n        \r\n        // Clear previous timeout\r\n        if (typingTimeoutRef.current) {\r\n            clearTimeout(typingTimeoutRef.current);\r\n        }\r\n        \r\n        // Auto-clear typing after 3 seconds of inactivity\r\n        typingTimeoutRef.current = setTimeout(() => {\r\n            if (isTypingRef.current) {\r\n                isTypingRef.current = false;\r\n                clearTypingMutation({\r\n                    chatId,\r\n                    userId,\r\n                }).catch(console.error);\r\n            }\r\n        }, 3000);\r\n    }, [chatId, userId, userName, convexAvailable, updateTypingMutation, clearTypingMutation]);\r\n    \r\n    // Immediately clear typing status\r\n    const clearTyping = useCallback(() => {\r\n        if (!chatId || !userId || !convexAvailable) return;\r\n        \r\n        if (typingTimeoutRef.current) {\r\n            clearTimeout(typingTimeoutRef.current);\r\n        }\r\n        \r\n        if (isTypingRef.current) {\r\n            isTypingRef.current = false;\r\n            clearTypingMutation({\r\n                chatId,\r\n                userId,\r\n            }).catch(console.error);\r\n        }\r\n    }, [chatId, userId, convexAvailable, clearTypingMutation]);\r\n    \r\n    // Cleanup on unmount or chat change\r\n    useEffect(() => {\r\n        return () => {\r\n            if (typingTimeoutRef.current) {\r\n                clearTimeout(typingTimeoutRef.current);\r\n            }\r\n            // Clear typing when leaving chat\r\n            if (chatId && userId && isTypingRef.current && convexAvailable) {\r\n                clearTypingMutation({\r\n                    chatId,\r\n                    userId,\r\n                }).catch(console.error);\r\n            }\r\n        };\r\n    }, [chatId, userId, convexAvailable, clearTypingMutation]);\r\n    \r\n    return {\r\n        typingUsers,\r\n        setTyping,\r\n        clearTyping,\r\n    };\r\n}\r\n\r\n/**\r\n * Format typing users into display string\r\n * @param {Array} typingUsers - Array of typing user objects\r\n * @returns {string} Formatted string\r\n */\r\nexport function formatTypingUsers(typingUsers) {\r\n    if (!typingUsers || typingUsers.length === 0) return '';\r\n    \r\n    if (typingUsers.length === 1) {\r\n        return `${typingUsers[0].name} is typing...`;\r\n    }\r\n    \r\n    if (typingUsers.length === 2) {\r\n        return `${typingUsers[0].name} and ${typingUsers[1].name} are typing...`;\r\n    }\r\n    \r\n    return `${typingUsers[0].name} and ${typingUsers.length - 1} others are typing...`;\r\n}\r\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { \r\n    Paperclip, \r\n    Send, \r\n    X, \r\n    Loader2, \r\n    FileAudio, \r\n    CheckCircle, \r\n    Mic, \r\n    StopCircle,\r\n    CornerUpLeft,\r\n    Pencil,\r\n    Smile,\r\n    Image as ImageIcon,\r\n    Video,\r\n    FileText,\r\n    ImagePlus,\r\n    Trash2,\r\n    Play,\r\n    Pause,\r\n    Square\r\n} from 'lucide-react';\r\nimport { useMediaUpload } from '../../hooks/useMediaUpload';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport EmojiPicker from './media/EmojiPicker';\r\nimport GifPicker from './media/GifPicker';\r\nimport VideoRecorder from './media/VideoRecorder';\r\nimport { formatTypingUsers } from '../../hooks/useTypingIndicator';\r\nimport { useLanguage } from '../../contexts/LanguageContext';\r\n\r\nexport default function ChatInput({ \r\n    activeChatId, \r\n    uid, \r\n    onSend, \r\n    replyingTo, \r\n    editingMessage, \r\n    onCancelReply,\r\n    onCancelEdit, \r\n    typingUsers = [],\r\n    onTyping,\r\n    onStopTyping\r\n}) {\r\n    const { t } = useLanguage();\r\n    const [input, setInput] = useState('');\r\n    const [attachment, setAttachment] = useState(null);\r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const [recordingDuration, setRecordingDuration] = useState(0);\r\n    const [dragActive, setDragActive] = useState(false);\r\n    const [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n    const [showGifPicker, setShowGifPicker] = useState(false);\r\n    const [showVideoRecorder, setShowVideoRecorder] = useState(false);\r\n    const [isPlayingPreview, setIsPlayingPreview] = useState(false);\r\n    \r\n    const fileInputRef = useRef(null);\r\n    const textareaRef = useRef(null);\r\n    const mediaRecorder = useRef(null);\r\n    const audioChunks = useRef([]);\r\n    const emojiPickerRef = useRef(null);\r\n    const gifPickerRef = useRef(null);\r\n    const recordingIntervalRef = useRef(null);\r\n    const audioPreviewRef = useRef(null);\r\n    const { uploadMedia, uploading } = useMediaUpload();\r\n\r\n    // Set input when editing\r\n    useEffect(() => { \r\n        if (editingMessage) {\r\n            setInput(editingMessage.b || '');\r\n            textareaRef.current?.focus();\r\n        }\r\n    }, [editingMessage]);\r\n\r\n    // Focus on reply\r\n    useEffect(() => {\r\n        if (replyingTo) {\r\n            textareaRef.current?.focus();\r\n        }\r\n    }, [replyingTo]);\r\n\r\n    // Close pickers on outside click\r\n    useEffect(() => {\r\n        const handleClickOutside = (e) => {\r\n            if (emojiPickerRef.current && !emojiPickerRef.current.contains(e.target)) {\r\n                setShowEmojiPicker(false);\r\n            }\r\n            if (gifPickerRef.current && !gifPickerRef.current.contains(e.target)) {\r\n                setShowGifPicker(false);\r\n            }\r\n        };\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, []);\r\n\r\n    // Handle GIF selection\r\n    const handleGifSelect = async (gifData) => {\r\n        try {\r\n            // Convert GIF URL to file-like object for upload\r\n            const response = await fetch(gifData.url);\r\n            const blob = await response.blob();\r\n            const file = new File([blob], `gif_${Date.now()}.gif`, { type: 'image/gif' });\r\n            \r\n            const res = await uploadMedia(file, `chat_media/${activeChatId}`);\r\n            if (res) {\r\n                const gifMediaData = { \r\n                    url: res.url, \r\n                    type: 'image', \r\n                    name: gifData.title || 'GIF',\r\n                    gif: true // Flag to indicate it's a GIF\r\n                };\r\n                onSend('', gifMediaData);\r\n            }\r\n        } catch (error) {\r\n            console.error('GIF upload error:', error);\r\n            alert('Failed to send GIF');\r\n        }\r\n        setShowGifPicker(false);\r\n    };\r\n\r\n    // Handle video recording\r\n    const handleVideoRecorded = async (videoFile) => {\r\n        try {\r\n            const res = await uploadMedia(videoFile, `chat_media/${activeChatId}`);\r\n            if (res) {\r\n                const videoMediaData = { \r\n                    url: res.url, \r\n                    type: 'video', \r\n                    name: videoFile.name \r\n                };\r\n                onSend('', videoMediaData);\r\n            }\r\n        } catch (error) {\r\n            console.error('Video upload error:', error);\r\n            alert('Failed to send video');\r\n        }\r\n        setShowVideoRecorder(false);\r\n    };\r\n\r\n    // --- TEXT & TYPING ---\r\n    const handleTyping = (e) => {\r\n        setInput(e.target.value);\r\n        \r\n        // Update typing indicator via Convex\r\n        if (onTyping && e.target.value.trim()) {\r\n            onTyping();\r\n        }\r\n    };\r\n\r\n    // Insert emoji at cursor position\r\n    const insertEmoji = (emoji) => {\r\n        const textarea = textareaRef.current;\r\n        if (textarea) {\r\n            const start = textarea.selectionStart;\r\n            const end = textarea.selectionEnd;\r\n            const newValue = input.substring(0, start) + emoji + input.substring(end);\r\n            setInput(newValue);\r\n            \r\n            // Set cursor position after emoji\r\n            setTimeout(() => {\r\n                textarea.selectionStart = textarea.selectionEnd = start + emoji.length;\r\n                textarea.focus();\r\n            }, 0);\r\n        } else {\r\n            setInput(prev => prev + emoji);\r\n        }\r\n    };\r\n\r\n    // --- AUDIO RECORDING ---\r\n    const startRecording = async () => {\r\n        try {\r\n            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n            mediaRecorder.current = new MediaRecorder(stream);\r\n            audioChunks.current = [];\r\n            setRecordingDuration(0);\r\n            \r\n            mediaRecorder.current.ondataavailable = (e) => audioChunks.current.push(e.data);\r\n            mediaRecorder.current.onstop = () => {\r\n                const audioBlob = new Blob(audioChunks.current, { type: 'audio/webm' });\r\n                const audioFile = new File([audioBlob], `voice_note_${Date.now()}.webm`, { type: 'audio/webm' });\r\n                setAttachment({ \r\n                    file: audioFile, \r\n                    type: 'audio', \r\n                    previewUrl: URL.createObjectURL(audioBlob),\r\n                    duration: recordingDuration\r\n                });\r\n                stream.getTracks().forEach(track => track.stop());\r\n                if (recordingIntervalRef.current) {\r\n                    clearInterval(recordingIntervalRef.current);\r\n                }\r\n            };\r\n            \r\n            mediaRecorder.current.start();\r\n            setIsRecording(true);\r\n            \r\n            // Start duration timer\r\n            recordingIntervalRef.current = setInterval(() => {\r\n                setRecordingDuration(prev => prev + 1);\r\n            }, 1000);\r\n        } catch (e) { \r\n            alert(\"Microphone access denied. Please allow microphone permissions.\"); \r\n        }\r\n    };\r\n\r\n    const stopRecording = () => {\r\n        if (mediaRecorder.current && isRecording) {\r\n            mediaRecorder.current.stop();\r\n            setIsRecording(false);\r\n            if (recordingIntervalRef.current) {\r\n                clearInterval(recordingIntervalRef.current);\r\n            }\r\n        }\r\n    };\r\n\r\n    const cancelRecording = () => {\r\n        if (mediaRecorder.current && isRecording) {\r\n            mediaRecorder.current.stop();\r\n            // Clear the chunks so nothing is saved\r\n            audioChunks.current = [];\r\n            setIsRecording(false);\r\n            setRecordingDuration(0);\r\n            if (recordingIntervalRef.current) {\r\n                clearInterval(recordingIntervalRef.current);\r\n            }\r\n            // Stop the stream\r\n            mediaRecorder.current.stream?.getTracks().forEach(track => track.stop());\r\n        }\r\n    };\r\n\r\n    // Format duration as MM:SS\r\n    const formatDuration = (seconds) => {\r\n        const mins = Math.floor(seconds / 60);\r\n        const secs = seconds % 60;\r\n        return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    // Toggle audio preview playback\r\n    const toggleAudioPreview = () => {\r\n        if (!audioPreviewRef.current || !attachment?.previewUrl) return;\r\n        \r\n        if (isPlayingPreview) {\r\n            audioPreviewRef.current.pause();\r\n            setIsPlayingPreview(false);\r\n        } else {\r\n            audioPreviewRef.current.play();\r\n            setIsPlayingPreview(true);\r\n        }\r\n    };\r\n\r\n    // Cleanup recording on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            if (recordingIntervalRef.current) {\r\n                clearInterval(recordingIntervalRef.current);\r\n            }\r\n            if (mediaRecorder.current && isRecording) {\r\n                mediaRecorder.current.stop();\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    // --- DRAG & DROP ---\r\n    const handleDrag = (e) => { \r\n        e.preventDefault(); \r\n        e.stopPropagation(); \r\n        if (e.type === 'dragenter' || e.type === 'dragover') {\r\n            setDragActive(true);\r\n        } else {\r\n            setDragActive(false);\r\n        }\r\n    };\r\n    \r\n    const handleDrop = (e) => {\r\n        e.preventDefault(); \r\n        e.stopPropagation(); \r\n        setDragActive(false);\r\n        if (e.dataTransfer.files && e.dataTransfer.files[0]) {\r\n            handleFileSelect(e.dataTransfer.files[0]);\r\n        }\r\n    };\r\n\r\n    const handleFileSelect = (file) => {\r\n        const type = file.type.startsWith('image/') ? 'image' : \r\n                     file.type.startsWith('video/') ? 'video' :\r\n                     file.type.startsWith('audio/') ? 'audio' : 'file';\r\n        setAttachment({ \r\n            file, \r\n            type, \r\n            previewUrl: URL.createObjectURL(file) \r\n        });\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        if ((!input.trim() && !attachment) || uploading) return;\r\n\r\n        let mediaData = null;\r\n        if (attachment) {\r\n            const res = await uploadMedia(attachment.file, `chat_media/${activeChatId}`);\r\n            if (res) {\r\n                mediaData = { \r\n                    url: res.url, \r\n                    type: res.type, \r\n                    name: res.name,\r\n                    duration: attachment.duration // Include duration for voice notes\r\n                };\r\n            }\r\n        }\r\n\r\n        onSend(input, mediaData);\r\n        setInput('');\r\n        setAttachment(null);\r\n        setIsPlayingPreview(false);\r\n        \r\n        // Clear typing indicator via Convex\r\n        if (onStopTyping) {\r\n            onStopTyping();\r\n        }\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        if (editingMessage) {\r\n            setInput('');\r\n            onCancelEdit?.();\r\n        } else {\r\n            onCancelReply?.();\r\n        }\r\n    };\r\n\r\n    // Get reply/edit preview text\r\n    const getContextPreview = () => {\r\n        if (editingMessage) {\r\n            return editingMessage.b?.substring(0, 50) || 'Message';\r\n        }\r\n        if (replyingTo) {\r\n            return replyingTo.b?.substring(0, 50) || 'Media';\r\n        }\r\n        return '';\r\n    };\r\n\r\n    return (\r\n        <div \r\n            className={`p-3 bg-white dark:bg-[#2c2e36] border-t dark:border-gray-700 shrink-0 transition-colors ${\r\n                dragActive ? 'bg-blue-50 dark:bg-blue-900/20 border-blue-400' : ''\r\n            }`}\r\n            onDragEnter={handleDrag} \r\n            onDragLeave={handleDrag} \r\n            onDragOver={handleDrag} \r\n            onDrop={handleDrop}\r\n        >\r\n            {/* Typing Indicator */}\r\n            <AnimatePresence>\r\n                {typingUsers.length > 0 && (\r\n                    <motion.div \r\n                        initial={{ opacity: 0, y: 10 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        exit={{ opacity: 0, y: 10 }}\r\n                        className=\"mb-2 px-2 flex items-center gap-2\"\r\n                    >\r\n                        <div className=\"flex gap-1\">\r\n                            <span className=\"w-1.5 h-1.5 bg-brand-blue rounded-full animate-bounce\"></span>\r\n                            <span className=\"w-1.5 h-1.5 bg-brand-blue rounded-full animate-bounce\" style={{ animationDelay: '0.1s' }}></span>\r\n                            <span className=\"w-1.5 h-1.5 bg-brand-blue rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></span>\r\n                        </div>\r\n                        <span className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                            {formatTypingUsers(typingUsers)}\r\n                        </span>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Voice Recording UI */}\r\n            <AnimatePresence>\r\n                {isRecording && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, height: 0 }}\r\n                        animate={{ opacity: 1, height: 'auto' }}\r\n                        exit={{ opacity: 0, height: 0 }}\r\n                        className=\"mb-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-xl border border-red-200 dark:border-red-800\"\r\n                    >\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\"></div>\r\n                                <span className=\"font-medium text-red-700 dark:text-red-400\">\r\n                                    Recording...\r\n                                </span>\r\n                                <span className=\"font-mono text-red-600 dark:text-red-300 text-sm\">\r\n                                    {formatDuration(recordingDuration)}\r\n                                </span>\r\n                            </div>\r\n                            \r\n                            {/* Recording Waveform Visualization */}\r\n                            <div className=\"flex items-center gap-0.5 mx-4\">\r\n                                {[...Array(20)].map((_, i) => (\r\n                                    <motion.div\r\n                                        key={i}\r\n                                        className=\"w-1 bg-red-400 rounded-full\"\r\n                                        animate={{\r\n                                            height: [8, Math.random() * 20 + 8, 8],\r\n                                        }}\r\n                                        transition={{\r\n                                            duration: 0.5,\r\n                                            repeat: Infinity,\r\n                                            delay: i * 0.05,\r\n                                        }}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                            \r\n                            <div className=\"flex items-center gap-2\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={cancelRecording}\r\n                                    className=\"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/40 rounded-full transition\"\r\n                                    title=\"Cancel recording\"\r\n                                >\r\n                                    <Trash2 size={18} />\r\n                                </button>\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={stopRecording}\r\n                                    className=\"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition\"\r\n                                    title=\"Stop recording\"\r\n                                >\r\n                                    <Square size={16} fill=\"white\" />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Reply/Edit Context Header */}\r\n            <AnimatePresence>\r\n                {(replyingTo || editingMessage) && (\r\n                    <motion.div \r\n                        initial={{ opacity: 0, y: 10 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        exit={{ opacity: 0, y: -10 }}\r\n                        className=\"flex justify-between items-center bg-gray-100 dark:bg-gray-800 p-2.5 px-4 rounded-xl border-l-4 border-brand-blue mb-2\"\r\n                    >\r\n                        <div className=\"flex items-center gap-3 flex-1 min-w-0\">\r\n                            {editingMessage ? (\r\n                                <Pencil size={16} className=\"text-brand-blue shrink-0\" />\r\n                            ) : (\r\n                                <CornerUpLeft size={16} className=\"text-brand-blue shrink-0\" />\r\n                            )}\r\n                            <div className=\"min-w-0\">\r\n                                <span className=\"text-xs font-bold text-brand-blue block\">\r\n                                    {editingMessage ? 'Editing Message' : `Replying to ${replyingTo?.n || 'User'}`}\r\n                                </span>\r\n                                <span className=\"text-xs text-gray-500 dark:text-gray-400 truncate block\">\r\n                                    {getContextPreview()}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                        <button \r\n                            onClick={handleCancel}\r\n                            className=\"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition\"\r\n                        >\r\n                            <X size={16} className=\"text-gray-400 hover:text-red-500\"/>\r\n                        </button>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Attachment Preview */}\r\n            <AnimatePresence>\r\n                {attachment && (\r\n                    <motion.div \r\n                        initial={{ opacity: 0, scale: 0.95 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        exit={{ opacity: 0, scale: 0.95 }}\r\n                        className=\"flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800 rounded-xl mb-2 border dark:border-gray-700\"\r\n                    >\r\n                        {attachment.type === 'image' ? (\r\n                            <img src={attachment.previewUrl} className=\"h-14 w-14 object-cover rounded-lg\"/>\r\n                        ) : attachment.type === 'video' ? (\r\n                            <video src={attachment.previewUrl} className=\"h-14 w-14 object-cover rounded-lg\"/>\r\n                        ) : attachment.type === 'audio' ? (\r\n                            <div className=\"flex items-center gap-3 flex-1\">\r\n                                {/* Audio preview with playback */}\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={toggleAudioPreview}\r\n                                    className=\"h-12 w-12 bg-purple-500 text-white flex items-center justify-center rounded-full hover:bg-purple-600 transition shrink-0\"\r\n                                >\r\n                                    {isPlayingPreview ? <Pause size={20} /> : <Play size={20} className=\"ml-0.5\" />}\r\n                                </button>\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <Mic size={14} className=\"text-purple-500\" />\r\n                                        <span className=\"text-sm font-bold dark:text-white\">Voice Message</span>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2 mt-1\">\r\n                                        {/* Simple waveform visualization */}\r\n                                        <div className=\"flex items-center gap-0.5 flex-1\">\r\n                                            {[...Array(30)].map((_, i) => (\r\n                                                <div\r\n                                                    key={i}\r\n                                                    className=\"w-1 bg-purple-300 dark:bg-purple-700 rounded-full\"\r\n                                                    style={{ height: `${Math.random() * 12 + 4}px` }}\r\n                                                />\r\n                                            ))}\r\n                                        </div>\r\n                                        <span className=\"text-xs text-gray-500 font-mono\">\r\n                                            {attachment.duration ? formatDuration(attachment.duration) : '0:00'}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <audio \r\n                                    ref={audioPreviewRef}\r\n                                    src={attachment.previewUrl}\r\n                                    onEnded={() => setIsPlayingPreview(false)}\r\n                                    className=\"hidden\"\r\n                                />\r\n                            </div>\r\n                        ) : (\r\n                            <>\r\n                                <div className=\"h-14 w-14 bg-gray-200 dark:bg-gray-700 text-gray-500 flex items-center justify-center rounded-lg\">\r\n                                    <FileText size={24}/>\r\n                                </div>\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <div className=\"text-sm font-bold dark:text-white truncate\">{attachment.file.name}</div>\r\n                                    <div className=\"text-xs text-gray-500\">{(attachment.file.size / 1024).toFixed(1)} KB</div>\r\n                                </div>\r\n                            </>\r\n                        )}\r\n                        <button \r\n                            onClick={() => {\r\n                                setAttachment(null);\r\n                                setIsPlayingPreview(false);\r\n                            }}\r\n                            className=\"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition shrink-0\"\r\n                        >\r\n                            <X size={18} className=\"text-gray-400 hover:text-red-500\"/>\r\n                        </button>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Main Input Row */}\r\n            <form onSubmit={handleSubmit} className=\"flex items-end gap-2\">\r\n                {/* Attachment button with dropdown */}\r\n                <div className=\"relative\">\r\n                    <input \r\n                        type=\"file\" \r\n                        ref={fileInputRef} \r\n                        className=\"hidden\" \r\n                        accept=\"image/*,audio/*,video/*,.pdf,.doc,.docx,.txt,.zip\" \r\n                        onChange={(e) => handleFileSelect(e.target.files[0])} \r\n                    />\r\n                    \r\n                    <button \r\n                        type=\"button\" \r\n                        onClick={() => fileInputRef.current?.click()} \r\n                        className=\"p-2.5 text-gray-500 hover:text-brand-blue hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition shrink-0\"\r\n                        title=\"Attach file\"\r\n                    >\r\n                        <Paperclip size={20}/>\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Media options */}\r\n                <div className=\"flex items-center gap-1 border-r dark:border-gray-700 pr-2\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                            setShowVideoRecorder(true);\r\n                            setShowEmojiPicker(false);\r\n                            setShowGifPicker(false);\r\n                        }}\r\n                        className=\"p-2 text-gray-500 hover:text-red-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition\"\r\n                        title=\"Record video\"\r\n                    >\r\n                        <Video size={18} />\r\n                    </button>\r\n                    \r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                            setShowGifPicker(!showGifPicker);\r\n                            setShowEmojiPicker(false);\r\n                        }}\r\n                        className=\"p-2 text-gray-500 hover:text-purple-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition relative\"\r\n                        title=\"GIF\"\r\n                        ref={gifPickerRef}\r\n                    >\r\n                        <ImagePlus size={18} />\r\n                        {showGifPicker && (\r\n                            <GifPicker\r\n                                onSelect={handleGifSelect}\r\n                                onClose={() => setShowGifPicker(false)}\r\n                                position=\"bottom\"\r\n                            />\r\n                        )}\r\n                    </button>\r\n                </div>\r\n                \r\n                {/* Input field with emoji button */}\r\n                <div className=\"flex-1 bg-gray-100 dark:bg-[#1f2128] rounded-2xl border dark:border-gray-700 focus-within:ring-2 focus-within:ring-brand-blue transition-all flex items-end relative\">\r\n                    <textarea \r\n                        ref={textareaRef}\r\n                        className=\"w-full bg-transparent p-3 max-h-32 min-h-[44px] text-sm resize-none outline-none dark:text-white custom-scrollbar pr-20\" \r\n                        placeholder={\r\n                            editingMessage ? t('editingMessage') + '...' : \r\n                            dragActive ? t('dropFiles') + '...' : \r\n                            t('typeMessage')\r\n                        } \r\n                        value={input} \r\n                        onChange={handleTyping} \r\n                        onKeyDown={e => { \r\n                            if(e.key === 'Enter' && !e.shiftKey) { \r\n                                e.preventDefault(); \r\n                                handleSubmit(e); \r\n                            }\r\n                        }}\r\n                        rows={1}\r\n                    />\r\n                    \r\n                    {/* Right-side buttons inside input */}\r\n                    <div className=\"absolute right-2 bottom-1.5 flex items-center gap-1\">\r\n                        {/* Full Emoji picker */}\r\n                        <div className=\"relative\" ref={emojiPickerRef}>\r\n                            <button \r\n                                type=\"button\" \r\n                                onClick={() => {\r\n                                    setShowEmojiPicker(!showEmojiPicker);\r\n                                    setShowGifPicker(false);\r\n                                }}\r\n                                className={`p-1.5 rounded-full transition ${\r\n                                    showEmojiPicker \r\n                                        ? 'bg-brand-blue/20 text-brand-blue' \r\n                                        : 'text-gray-400 hover:text-gray-600 dark:hover:text-gray-300'\r\n                                }`}\r\n                                title=\"Emoji\"\r\n                            >\r\n                                <Smile size={18}/>\r\n                            </button>\r\n                            \r\n                            <AnimatePresence>\r\n                                {showEmojiPicker && (\r\n                                    <EmojiPicker\r\n                                        onSelect={insertEmoji}\r\n                                        onClose={() => setShowEmojiPicker(false)}\r\n                                        position=\"bottom\"\r\n                                    />\r\n                                )}\r\n                            </AnimatePresence>\r\n                        </div>\r\n\r\n                        {/* Voice record button */}\r\n                        <button \r\n                            type=\"button\" \r\n                            onClick={isRecording ? stopRecording : startRecording} \r\n                            className={`p-1.5 rounded-full transition ${\r\n                                isRecording \r\n                                    ? 'bg-red-500 text-white animate-pulse' \r\n                                    : 'text-gray-400 hover:text-gray-600 dark:hover:text-gray-300'\r\n                            }`}\r\n                        >\r\n                            {isRecording ? <StopCircle size={18}/> : <Mic size={18}/>}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Send button */}\r\n                <button \r\n                    type=\"submit\" \r\n                    disabled={(!input.trim() && !attachment) || uploading} \r\n                    className={`p-2.5 text-white rounded-full shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all shrink-0 ${\r\n                        editingMessage \r\n                            ? 'bg-green-600 hover:bg-green-700' \r\n                            : 'bg-brand-blue hover:bg-blue-600'\r\n                    }`}\r\n                >\r\n                    {uploading ? (\r\n                        <Loader2 size={20} className=\"animate-spin\"/>\r\n                    ) : editingMessage ? (\r\n                        <CheckCircle size={20}/>\r\n                    ) : (\r\n                        <Send size={20}/>\r\n                    )}\r\n                </button>\r\n            </form>\r\n\r\n            {/* Video Recorder Modal */}\r\n            {showVideoRecorder && (\r\n                <VideoRecorder\r\n                    onRecorded={handleVideoRecorded}\r\n                    onClose={() => setShowVideoRecorder(false)}\r\n                    maxDuration={60}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport { clsx } from 'clsx';\r\nimport { twMerge } from 'tailwind-merge';\r\n\r\n// Utility for merging tailwind classes\r\nfunction cn(...inputs) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n\r\nconst Button = React.forwardRef(({ className, variant = \"default\", size = \"default\", ...props }, ref) => {\r\n  const variants = {\r\n    default: \"bg-blue-600 text-white hover:bg-blue-700 shadow-sm\",\r\n    destructive: \"bg-red-500 text-white hover:bg-red-600 shadow-sm\",\r\n    outline: \"border border-gray-200 bg-transparent hover:bg-gray-100 text-gray-900\",\r\n    secondary: \"bg-gray-100 text-gray-900 hover:bg-gray-200\",\r\n    ghost: \"hover:bg-gray-100 hover:text-gray-900 text-gray-600\",\r\n    link: \"text-blue-600 underline-offset-4 hover:underline\",\r\n  };\r\n\r\n  const sizes = {\r\n    default: \"h-9 px-4 py-2\",\r\n    sm: \"h-8 rounded-md px-3 text-xs\",\r\n    lg: \"h-10 rounded-md px-8\",\r\n    icon: \"h-9 w-9\",\r\n  };\r\n\r\n  return (\r\n    <button\r\n      ref={ref}\r\n      className={cn(\r\n        \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50\",\r\n        variants[variant],\r\n        sizes[size],\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n});\r\n\r\nButton.displayName = \"Button\";\r\n\r\nexport { Button };\r\n","import React from 'react';\r\nimport { X, ExternalLink } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\n\r\n/**\r\n * A modal to embed and display content (like a profile or session detail) \r\n * shared via a SeshNx platform link, without leaving the chat interface.\r\n * * @param {object} props\r\n * @param {string} props.url - The SeshNx URL to be embedded.\r\n * @param {boolean} props.isOpen - Controls the modal visibility.\r\n * @param {function} props.onClose - Function to close the modal.\r\n * @param {object} props.previewData - Pre-fetched metadata about the link (e.g., title).\r\n */\r\nexport default function SeshNxEmbedModal({ url, isOpen, onClose, previewData }) {\r\n    if (!isOpen || !url) return null;\r\n\r\n    // Determine the type of content for better display titles\r\n    const contentPath = new URL(url).pathname;\r\n    let contentType = 'Content';\r\n    if (contentPath.startsWith('/profile/')) {\r\n        contentType = 'User Profile';\r\n    } else if (contentPath.startsWith('/session/')) {\r\n        contentType = 'Session Details';\r\n    } else if (contentPath.startsWith('/studio/')) {\r\n        contentType = 'Studio Listing';\r\n    }\r\n\r\n    // Determine the actual title to display\r\n    const title = previewData?.title || `${contentType} Preview`;\r\n\r\n    return (\r\n        <div \r\n            className=\"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black bg-opacity-70 backdrop-blur-sm\"\r\n            onClick={onClose} // Close on backdrop click\r\n        >\r\n            <div \r\n                className=\"bg-gray-900 rounded-xl shadow-2xl w-full max-w-2xl h-3/4 max-h-[800px] flex flex-col transform transition-all duration-300 scale-100 opacity-100\"\r\n                onClick={(e) => e.stopPropagation()} // Prevent closing when clicking inside modal\r\n            >\r\n                {/* Modal Header */}\r\n                <div className=\"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800 rounded-t-xl sticky top-0\">\r\n                    <h3 className=\"text-xl font-bold text-white truncate max-w-[80%]\">{title}</h3>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                        {/* Open in new tab button */}\r\n                        <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                            <Button variant=\"ghost\" size=\"icon\" className=\"text-blue-400 hover:text-blue-300\">\r\n                                <ExternalLink className=\"w-5 h-5\" />\r\n                            </Button>\r\n                        </a>\r\n                        {/* Close button */}\r\n                        <Button onClick={onClose} variant=\"ghost\" size=\"icon\" className=\"text-white hover:bg-gray-700\">\r\n                            <X className=\"w-5 h-5\" />\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Modal Content - Placeholder for actual embedded view */}\r\n                <div className=\"flex-1 p-4 overflow-y-auto custom-scrollbar text-gray-400 flex flex-col items-center justify-center text-center\">\r\n                    <p className=\"mb-4 text-lg font-medium text-white\">Embedded Content Simulation</p>\r\n                    <p className=\"mb-2\">This is where the actual SeshNx content (e.g., profile card, session details) would be rendered, based on the URL:</p>\r\n                    <a href={url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-400 hover:underline break-all p-2 bg-gray-700 rounded-lg text-sm\">\r\n                        {url}\r\n                    </a>\r\n                    <p className=\"mt-4 text-sm\">In a real implementation, you would use a dedicated component (e.g., `ProfileCard id=\"...\"`) here instead of an iframe to display the content securely and natively.</p>\r\n                </div>\r\n                \r\n                {/* Modal Footer */}\r\n                <div className=\"p-3 border-t border-gray-700 bg-gray-800 rounded-b-xl flex justify-end\">\r\n                    <Button onClick={onClose} variant=\"secondary\">Done</Button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport { Check, CheckCheck, Clock } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\n\r\n/**\r\n * Message delivery/read status indicators\r\n * \r\n * States:\r\n * - Sending: Clock icon (not yet sent)\r\n * - Sent: Single checkmark (delivered to server)\r\n * - Delivered: Double checkmark (delivered to recipient)\r\n * - Read: Double checkmark (blue) (read by recipient)\r\n */\r\nexport default function MessageStatus({ \r\n    status = 'sent', // 'sending' | 'sent' | 'delivered' | 'read'\r\n    size = 12,\r\n    className = ''\r\n}) {\r\n    const statusConfig = {\r\n        sending: {\r\n            icon: Clock,\r\n            color: 'text-gray-400',\r\n            animate: true\r\n        },\r\n        sent: {\r\n            icon: Check,\r\n            color: 'text-gray-400',\r\n            animate: false\r\n        },\r\n        delivered: {\r\n            icon: CheckCheck,\r\n            color: 'text-gray-400',\r\n            animate: false\r\n        },\r\n        read: {\r\n            icon: CheckCheck,\r\n            color: 'text-brand-blue',\r\n            animate: false\r\n        }\r\n    };\r\n\r\n    const config = statusConfig[status] || statusConfig.sent;\r\n    const Icon = config.icon;\r\n\r\n    return (\r\n        <motion.div\r\n            animate={config.animate ? { rotate: [0, 360] } : {}}\r\n            transition={config.animate ? { duration: 2, repeat: Infinity, ease: \"linear\" } : {}}\r\n            className={`inline-flex items-center ${config.color} ${className}`}\r\n        >\r\n            <Icon size={size} className={status === 'read' ? 'fill-current' : ''} />\r\n        </motion.div>\r\n    );\r\n}\r\n\r\n/**\r\n * Compact status for message bubbles\r\n */\r\nexport function MessageStatusCompact({ status, messageTime, isOwn }) {\r\n    if (!isOwn) return null;\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-1\">\r\n            <MessageStatus status={status} size={10} />\r\n            <span className=\"text-[10px] text-gray-400\">\r\n                {messageTime}\r\n            </span>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React, { useRef, useEffect, useState } from 'react';\r\nimport { Play, Pause } from 'lucide-react';\r\n\r\n/**\r\n * Audio waveform visualizer component\r\n * Displays waveform for voice messages\r\n */\r\nexport default function AudioWaveform({ \r\n    audioUrl, \r\n    color = 'brand-blue',\r\n    height = 40 \r\n}) {\r\n    const canvasRef = useRef(null);\r\n    const audioRef = useRef(null);\r\n    const animationRef = useRef(null);\r\n    const audioContextRef = useRef(null);\r\n    const analyserRef = useRef(null);\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!audioUrl || !canvasRef.current) return;\r\n\r\n        const canvas = canvasRef.current;\r\n        const ctx = canvas.getContext('2d');\r\n        const audio = new Audio(audioUrl);\r\n\r\n        audioRef.current = audio;\r\n\r\n        // Set canvas size\r\n        canvas.width = canvas.offsetWidth;\r\n        canvas.height = height;\r\n\r\n        // Create audio context for visualization\r\n        const audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\n        const analyser = audioContext.createAnalyser();\r\n        const source = audioContext.createMediaElementSource(audio);\r\n\r\n        analyser.fftSize = 256;\r\n        source.connect(analyser);\r\n        analyser.connect(audioContext.destination);\r\n\r\n        audioContextRef.current = audioContext;\r\n        analyserRef.current = analyser;\r\n\r\n        // Visualize\r\n        const bufferLength = analyser.frequencyBinCount;\r\n        const dataArray = new Uint8Array(bufferLength);\r\n\r\n        const draw = () => {\r\n            if (audio.paused) {\r\n                // Draw static waveform when paused\r\n                drawStaticWaveform(ctx, canvas.width, canvas.height);\r\n                return;\r\n            }\r\n\r\n            animationRef.current = requestAnimationFrame(draw);\r\n            analyser.getByteFrequencyData(dataArray);\r\n\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n            \r\n            const barWidth = canvas.width / bufferLength * 2;\r\n            let x = 0;\r\n\r\n            for (let i = 0; i < bufferLength; i++) {\r\n                const barHeight = (dataArray[i] / 255) * canvas.height;\r\n\r\n                const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n                gradient.addColorStop(0, '#3b82f6'); // brand-blue\r\n                gradient.addColorStop(1, '#8b5cf6'); // purple\r\n\r\n                ctx.fillStyle = gradient;\r\n                ctx.fillRect(x, canvas.height - barHeight, barWidth - 1, barHeight);\r\n                x += barWidth;\r\n            }\r\n        };\r\n\r\n        audio.addEventListener('play', () => {\r\n            setIsPlaying(true);\r\n            draw();\r\n        });\r\n\r\n        audio.addEventListener('pause', () => {\r\n            setIsPlaying(false);\r\n            if (animationRef.current) {\r\n                cancelAnimationFrame(animationRef.current);\r\n            }\r\n            drawStaticWaveform(ctx, canvas.width, canvas.height);\r\n        });\r\n\r\n        audio.addEventListener('ended', () => {\r\n            setIsPlaying(false);\r\n            if (animationRef.current) {\r\n                cancelAnimationFrame(animationRef.current);\r\n            }\r\n            drawStaticWaveform(ctx, canvas.width, canvas.height);\r\n        });\r\n\r\n        // Initial static waveform\r\n        drawStaticWaveform(ctx, canvas.width, canvas.height);\r\n\r\n        return () => {\r\n            if (animationRef.current) {\r\n                cancelAnimationFrame(animationRef.current);\r\n            }\r\n            audio.pause();\r\n            audioContextRef.current?.close();\r\n        };\r\n    }, [audioUrl, height, isPlaying]);\r\n\r\n    const drawStaticWaveform = (ctx, width, height) => {\r\n        ctx.clearRect(0, 0, width, height);\r\n        ctx.fillStyle = '#3b82f6';\r\n        \r\n        const barCount = 50;\r\n        const barWidth = width / barCount;\r\n        const gap = 2;\r\n\r\n        for (let i = 0; i < barCount; i++) {\r\n            const barHeight = Math.random() * height * 0.3 + height * 0.1;\r\n            const x = i * barWidth;\r\n            ctx.fillRect(x, height - barHeight, barWidth - gap, barHeight);\r\n        }\r\n    };\r\n\r\n    const togglePlay = () => {\r\n        if (!audioRef.current) return;\r\n\r\n        if (isPlaying) {\r\n            audioRef.current.pause();\r\n        } else {\r\n            audioRef.current.play();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex items-center gap-3\">\r\n            <button\r\n                onClick={togglePlay}\r\n                className=\"w-10 h-10 flex items-center justify-center bg-brand-blue text-white rounded-full hover:bg-blue-600 transition shrink-0\"\r\n            >\r\n                {isPlaying ? <Pause size={16} /> : <Play size={16} className=\"ml-0.5\" />}\r\n            </button>\r\n            <div className=\"flex-1\">\r\n                <canvas\r\n                    ref={canvasRef}\r\n                    className=\"w-full rounded\"\r\n                    style={{ height: `${height}px` }}\r\n                />\r\n                <audio ref={audioRef} src={audioUrl} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { \r\n    CornerUpLeft, \r\n    Pencil, \r\n    Trash2, \r\n    Forward, \r\n    Copy, \r\n    MoreHorizontal,\r\n    FileText,\r\n    Globe,\r\n    Link as LinkIcon,\r\n    X,\r\n    Download\r\n} from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport MessageReactions from './MessageReactions';\r\nimport MessageStatus from './MessageStatus';\r\nimport AudioWaveform from '../media/AudioWaveform';\r\nimport UserAvatar from '../../shared/UserAvatar';\r\n\r\n// Reaction emoji set (6 reactions)\r\nexport const CHAT_REACTIONS = ['👍', '❤️', '😂', '😮', '😢', '🔥'];\r\n\r\n/**\r\n * Enhanced message bubble component with reactions, reply, edit, delete\r\n */\r\nexport default function MessageBubble({\r\n    message,\r\n    isCurrentUser,\r\n    previousMessage,\r\n    currentUserId,\r\n    chatId,\r\n    linkPreviewData,\r\n    messageStatus = 'sent', // 'sending' | 'sent' | 'delivered' | 'read'\r\n    onReaction,\r\n    onReply,\r\n    onEdit,\r\n    onDelete,\r\n    onForward,\r\n    onSeshNxLinkClick,\r\n    onUserClick\r\n}) {\r\n    const [showMenu, setShowMenu] = useState(false);\r\n    const [showReactionPicker, setShowReactionPicker] = useState(false);\r\n    const [copied, setCopied] = useState(false);\r\n    const menuRef = useRef(null);\r\n    const bubbleRef = useRef(null);\r\n\r\n    // Calculate grouping logic\r\n    const isFirstInGroup = !previousMessage || previousMessage.s !== message.s;\r\n    const isSameDay = previousMessage && \r\n        new Date(message.t).toDateString() === new Date(previousMessage.t).toDateString();\r\n    const currentMs = message.t || Date.now();\r\n    const prevMs = previousMessage?.t || 0;\r\n    const isFarApart = previousMessage && (currentMs - prevMs > 300000); // 5 min gap\r\n\r\n    const shouldShowDate = !isSameDay || !previousMessage;\r\n    const shouldShowTime = isFirstInGroup || isFarApart;\r\n    const shouldShowAvatar = !isCurrentUser && isFirstInGroup;\r\n\r\n    const msgDate = new Date(message.t || Date.now());\r\n\r\n    // Close menu on outside click\r\n    useEffect(() => {\r\n        const handleClickOutside = (e) => {\r\n            if (menuRef.current && !menuRef.current.contains(e.target)) {\r\n                setShowMenu(false);\r\n                setShowReactionPicker(false);\r\n            }\r\n        };\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, []);\r\n\r\n    // Copy message text\r\n    const handleCopy = () => {\r\n        navigator.clipboard.writeText(message.b || '');\r\n        setCopied(true);\r\n        setTimeout(() => setCopied(false), 2000);\r\n        setShowMenu(false);\r\n    };\r\n\r\n    // Handle reaction click\r\n    const handleReaction = (emoji) => {\r\n        onReaction?.(message.id, emoji);\r\n        setShowReactionPicker(false);\r\n        setShowMenu(false);\r\n    };\r\n\r\n    // Get reaction counts\r\n    const reactionCounts = message.reactions \r\n        ? Object.entries(message.reactions).reduce((acc, [emoji, users]) => {\r\n            const count = typeof users === 'object' ? Object.keys(users).length : 0;\r\n            if (count > 0) acc[emoji] = count;\r\n            return acc;\r\n        }, {})\r\n        : {};\r\n    \r\n    const hasReactions = Object.keys(reactionCounts).length > 0;\r\n    const myReaction = message.reactions \r\n        ? Object.entries(message.reactions).find(([emoji, users]) => \r\n            typeof users === 'object' && users[currentUserId]\r\n          )?.[0]\r\n        : null;\r\n\r\n    // Message styling\r\n    const bubbleClass = isCurrentUser\r\n        ? 'bg-brand-blue text-white rounded-br-sm'\r\n        : 'bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white rounded-bl-sm';\r\n\r\n    // Deleted message\r\n    if (message.deleted || message.deletedForAll) {\r\n        return (\r\n            <div className={`flex ${isCurrentUser ? 'justify-end' : 'justify-start'} ${isFirstInGroup ? 'mt-3' : 'mt-0.5'}`}>\r\n                <div className=\"px-4 py-2 rounded-2xl bg-gray-100 dark:bg-gray-800 text-gray-400 italic text-sm\">\r\n                    🚫 This message was deleted\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Check if deleted for current user only\r\n    if (message.deletedFor && message.deletedFor[currentUserId]) {\r\n        return null;\r\n    }\r\n\r\n    // Render link preview\r\n    const renderLinkPreview = () => {\r\n        if (!linkPreviewData) return null;\r\n        const isSeshNxLink = linkPreviewData.url?.includes('app.seshnx.com');\r\n\r\n        return (\r\n            <div className=\"mt-2 block border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden bg-white dark:bg-gray-800 max-w-[280px]\">\r\n                {isSeshNxLink ? (\r\n                    <button \r\n                        onClick={() => onSeshNxLinkClick?.(linkPreviewData)} \r\n                        className=\"w-full text-left\"\r\n                    >\r\n                        {linkPreviewData.image && (\r\n                            <div \r\n                                className=\"h-28 w-full bg-cover bg-center\" \r\n                                style={{ backgroundImage: `url(${linkPreviewData.image})` }}\r\n                            />\r\n                        )}\r\n                        <div className=\"p-2\">\r\n                            <p className=\"font-semibold text-xs text-brand-blue truncate flex items-center\">\r\n                                <LinkIcon className=\"w-3 h-3 mr-1\"/>\r\n                                {linkPreviewData.title || 'SeshNx Link'}\r\n                            </p>\r\n                            {linkPreviewData.description && (\r\n                                <p className=\"text-[10px] text-gray-500 mt-0.5 line-clamp-2\">\r\n                                    {linkPreviewData.description}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n                    </button>\r\n                ) : (\r\n                    <a href={linkPreviewData.url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        {linkPreviewData.image && (\r\n                            <div \r\n                                className=\"h-28 w-full bg-cover bg-center\" \r\n                                style={{ backgroundImage: `url(${linkPreviewData.image})` }}\r\n                            />\r\n                        )}\r\n                        <div className=\"p-2\">\r\n                            <p className=\"font-semibold text-xs text-brand-blue truncate\">\r\n                                {linkPreviewData.title || linkPreviewData.url}\r\n                            </p>\r\n                            {linkPreviewData.description && (\r\n                                <p className=\"text-[10px] text-gray-500 mt-0.5 line-clamp-2\">\r\n                                    {linkPreviewData.description}\r\n                                </p>\r\n                            )}\r\n                            <p className=\"text-[10px] text-gray-400 mt-1 flex items-center\">\r\n                                <Globe className=\"w-2.5 h-2.5 mr-1\"/>\r\n                                {new URL(linkPreviewData.url).hostname}\r\n                            </p>\r\n                        </div>\r\n                    </a>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Date separator */}\r\n            {shouldShowDate && (\r\n                <div className=\"text-center my-4\">\r\n                    <span className=\"text-[10px] text-gray-400 dark:text-gray-500 font-bold uppercase tracking-wider bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full\">\r\n                        {msgDate.toLocaleDateString('en-US', { \r\n                            year: 'numeric', \r\n                            month: 'long', \r\n                            day: 'numeric' \r\n                        })}\r\n                    </span>\r\n                </div>\r\n            )}\r\n\r\n            {/* Message row */}\r\n            <div \r\n                className={`group flex items-end gap-2 ${isCurrentUser ? 'flex-row-reverse' : 'flex-row'} ${isFirstInGroup ? 'mt-3' : 'mt-0.5'}`}\r\n                ref={bubbleRef}\r\n            >\r\n                {/* Avatar (for others' messages) */}\r\n                {!isCurrentUser && (\r\n                    <div className=\"w-8 shrink-0\">\r\n                        {shouldShowAvatar && (\r\n                            <UserAvatar \r\n                                src={message.photo}\r\n                                name={message.n}\r\n                                size=\"xs\"\r\n                                className=\"cursor-pointer\"\r\n                                onClick={() => onUserClick?.(message.s)}\r\n                            />\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Message content */}\r\n                <div className={`relative max-w-[75%] ${isCurrentUser ? 'items-end' : 'items-start'}`}>\r\n                    {/* Sender name (for group chats, first in group) */}\r\n                    {!isCurrentUser && isFirstInGroup && message.n && (\r\n                        <p className=\"text-[10px] font-bold text-gray-500 dark:text-gray-400 mb-1 ml-1\">\r\n                            {message.n}\r\n                        </p>\r\n                    )}\r\n\r\n                    {/* Reply preview */}\r\n                    {message.replyTo && (\r\n                        <div className={`mb-1 px-3 py-1.5 rounded-lg text-xs border-l-2 border-brand-blue ${\r\n                            isCurrentUser \r\n                                ? 'bg-blue-400/30 text-blue-100' \r\n                                : 'bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300'\r\n                        }`}>\r\n                            <p className=\"font-bold text-[10px] mb-0.5\">{message.replyTo.sender}</p>\r\n                            <p className=\"truncate opacity-80\">{message.replyTo.text}</p>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Main bubble */}\r\n                    <div \r\n                        className={`relative px-3 py-2 rounded-2xl shadow-sm ${bubbleClass} cursor-pointer transition-all hover:shadow-md`}\r\n                        onClick={() => setShowMenu(!showMenu)}\r\n                    >\r\n                        {/* Media content */}\r\n                        {message.media && (\r\n                            <div className=\"mb-2\">\r\n                                {message.media.type === 'image' && (\r\n                                    <div className=\"relative rounded-lg overflow-hidden\">\r\n                                        {message.media.gif && (\r\n                                            <span className=\"absolute top-2 left-2 bg-black/60 text-white text-xs px-2 py-0.5 rounded-full font-bold\">\r\n                                                GIF\r\n                                            </span>\r\n                                        )}\r\n                                        <img \r\n                                            src={message.media.url} \r\n                                            alt=\"Shared\" \r\n                                            className=\"max-w-full h-auto rounded-lg max-h-60 object-cover\"\r\n                                        />\r\n                                    </div>\r\n                                )}\r\n                                {message.media.type === 'video' && (\r\n                                    <video \r\n                                        controls \r\n                                        src={message.media.url} \r\n                                        className=\"max-w-full h-auto rounded-lg max-h-60\"\r\n                                    />\r\n                                )}\r\n                                {message.media.type === 'audio' && (\r\n                                    <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 max-w-[280px]\">\r\n                                        <AudioWaveform \r\n                                            audioUrl={message.media.url}\r\n                                            height={50}\r\n                                        />\r\n                                    </div>\r\n                                )}\r\n                                {message.media.type === 'file' && (\r\n                                    <a \r\n                                        href={message.media.url} \r\n                                        target=\"_blank\" \r\n                                        rel=\"noopener noreferrer\"\r\n                                        download={message.media.name}\r\n                                        className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition group\"\r\n                                    >\r\n                                        <div className=\"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center shrink-0\">\r\n                                            <FileText size={20} className=\"text-blue-600 dark:text-blue-400\" />\r\n                                        </div>\r\n                                        <div className=\"flex-1 min-w-0\">\r\n                                            <p className=\"text-sm font-semibold dark:text-white truncate\">\r\n                                                {message.media.name || 'File'}\r\n                                            </p>\r\n                                            <p className=\"text-xs text-gray-500\">\r\n                                                Click to download\r\n                                            </p>\r\n                                        </div>\r\n                                        <Download size={18} className=\"text-gray-400 group-hover:text-brand-blue transition shrink-0\" />\r\n                                    </a>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Text content */}\r\n                        {message.b && (\r\n                            <p className=\"text-sm break-words whitespace-pre-wrap leading-relaxed\">\r\n                                {message.b}\r\n                            </p>\r\n                        )}\r\n\r\n                        {/* Link preview */}\r\n                        {message.b && renderLinkPreview()}\r\n\r\n                        {/* Edited indicator */}\r\n                        {message.edited && (\r\n                            <span className={`text-[9px] ${isCurrentUser ? 'text-blue-200' : 'text-gray-400'} ml-1`}>\r\n                                (edited)\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Reactions display */}\r\n                    {hasReactions && (\r\n                        <div className={`flex flex-wrap gap-1 mt-1 ${isCurrentUser ? 'justify-end' : 'justify-start'}`}>\r\n                            {Object.entries(reactionCounts).map(([emoji, count]) => (\r\n                                <motion.button\r\n                                    key={emoji}\r\n                                    initial={{ scale: 0 }}\r\n                                    animate={{ scale: 1 }}\r\n                                    onClick={() => handleReaction(emoji)}\r\n                                    className={`flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-xs border transition-all ${\r\n                                        myReaction === emoji\r\n                                            ? 'bg-brand-blue/20 border-brand-blue text-brand-blue'\r\n                                            : 'bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:border-gray-300'\r\n                                    }`}\r\n                                >\r\n                                    <span>{emoji}</span>\r\n                                    <span className=\"text-[10px] font-bold\">{count}</span>\r\n                                </motion.button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Time & status */}\r\n                    {shouldShowTime && (\r\n                        <div className={`flex items-center gap-1 mt-1 ${isCurrentUser ? 'justify-end' : 'justify-start'}`}>\r\n                            <span className=\"text-[10px] text-gray-400\">\r\n                                {msgDate.toLocaleTimeString('en-US', { \r\n                                    hour: 'numeric', \r\n                                    minute: '2-digit' \r\n                                })}\r\n                            </span>\r\n                            {isCurrentUser && (\r\n                                <MessageStatus \r\n                                    status={messageStatus} \r\n                                    size={10} \r\n                                    className=\"ml-0.5\"\r\n                                />\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Context menu */}\r\n                    <AnimatePresence>\r\n                        {showMenu && (\r\n                            <motion.div\r\n                                ref={menuRef}\r\n                                initial={{ opacity: 0, scale: 0.9, y: -10 }}\r\n                                animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                                exit={{ opacity: 0, scale: 0.9, y: -10 }}\r\n                                className={`absolute z-50 ${\r\n                                    isCurrentUser ? 'right-0' : 'left-0'\r\n                                } bottom-full mb-2 bg-white dark:bg-gray-800 rounded-xl shadow-xl border dark:border-gray-700 overflow-hidden min-w-[180px]`}\r\n                            >\r\n                                {/* Quick reactions */}\r\n                                <div className=\"flex justify-center gap-1 p-2 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-900\">\r\n                                    {CHAT_REACTIONS.map(emoji => (\r\n                                        <motion.button\r\n                                            key={emoji}\r\n                                            whileHover={{ scale: 1.2 }}\r\n                                            whileTap={{ scale: 0.9 }}\r\n                                            onClick={() => handleReaction(emoji)}\r\n                                            className={`text-lg p-1 rounded-full transition ${\r\n                                                myReaction === emoji \r\n                                                    ? 'bg-brand-blue/20' \r\n                                                    : 'hover:bg-gray-200 dark:hover:bg-gray-700'\r\n                                            }`}\r\n                                        >\r\n                                            {emoji}\r\n                                        </motion.button>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                {/* Action buttons */}\r\n                                <div className=\"p-1\">\r\n                                    <button \r\n                                        onClick={() => { onReply?.(message); setShowMenu(false); }}\r\n                                        className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition\"\r\n                                    >\r\n                                        <CornerUpLeft size={16} className=\"text-gray-400\" />\r\n                                        <span className=\"dark:text-gray-200\">Reply</span>\r\n                                    </button>\r\n\r\n                                    <button \r\n                                        onClick={handleCopy}\r\n                                        className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition\"\r\n                                    >\r\n                                        <Copy size={16} className=\"text-gray-400\" />\r\n                                        <span className=\"dark:text-gray-200\">\r\n                                            {copied ? 'Copied!' : 'Copy'}\r\n                                        </span>\r\n                                    </button>\r\n\r\n                                    <button \r\n                                        onClick={() => { onForward?.(message); setShowMenu(false); }}\r\n                                        className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition\"\r\n                                    >\r\n                                        <Forward size={16} className=\"text-gray-400\" />\r\n                                        <span className=\"dark:text-gray-200\">Forward</span>\r\n                                    </button>\r\n\r\n                                    {isCurrentUser && (\r\n                                        <>\r\n                                            <button \r\n                                                onClick={() => { onEdit?.(message); setShowMenu(false); }}\r\n                                                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition\"\r\n                                            >\r\n                                                <Pencil size={16} className=\"text-gray-400\" />\r\n                                                <span className=\"dark:text-gray-200\">Edit</span>\r\n                                            </button>\r\n\r\n                                            <button \r\n                                                onClick={() => { onDelete?.(message, 'everyone'); setShowMenu(false); }}\r\n                                                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition text-red-500\"\r\n                                            >\r\n                                                <Trash2 size={16} />\r\n                                                <span>Delete for Everyone</span>\r\n                                            </button>\r\n                                        </>\r\n                                    )}\r\n\r\n                                    <button \r\n                                        onClick={() => { onDelete?.(message, 'me'); setShowMenu(false); }}\r\n                                        className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition text-gray-500\"\r\n                                    >\r\n                                        <Trash2 size={16} />\r\n                                        <span>Delete for Me</span>\r\n                                    </button>\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n                    </AnimatePresence>\r\n                </div>\r\n\r\n                {/* Spacer for current user's messages */}\r\n                {isCurrentUser && <div className=\"w-8 shrink-0\" />}\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { X, Search, Forward, Loader2, Check } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport UserAvatar from '../../shared/UserAvatar';\r\n\r\n/**\r\n * Modal for forwarding a message to other conversations\r\n */\r\nexport default function ForwardMessageModal({\r\n    message,\r\n    conversations,\r\n    currentUserId,\r\n    onForward,\r\n    onClose\r\n}) {\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [selectedChats, setSelectedChats] = useState([]);\r\n    const [forwarding, setForwarding] = useState(false);\r\n\r\n    // Filter conversations by search\r\n    const filteredConversations = searchQuery.trim()\r\n        ? conversations.filter(c => \r\n            c.n?.toLowerCase().includes(searchQuery.toLowerCase())\r\n          )\r\n        : conversations;\r\n\r\n    const toggleSelect = (chatId) => {\r\n        setSelectedChats(prev => \r\n            prev.includes(chatId)\r\n                ? prev.filter(id => id !== chatId)\r\n                : [...prev, chatId]\r\n        );\r\n    };\r\n\r\n    const handleForward = async () => {\r\n        if (selectedChats.length === 0) return;\r\n        \r\n        setForwarding(true);\r\n        try {\r\n            await onForward(message, selectedChats);\r\n            onClose();\r\n        } catch (error) {\r\n            console.error('Forward error:', error);\r\n            alert('Failed to forward message');\r\n        }\r\n        setForwarding(false);\r\n    };\r\n\r\n    // Message preview\r\n    const getMessagePreview = () => {\r\n        if (message.media) {\r\n            if (message.media.type === 'image') return '📷 Image';\r\n            if (message.media.type === 'video') return '🎥 Video';\r\n            if (message.media.type === 'audio') return '🎵 Audio';\r\n            return '📎 File';\r\n        }\r\n        return message.b?.substring(0, 100) || 'Message';\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[80] p-4\">\r\n            <motion.div\r\n                initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n                animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                exit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n                className=\"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col overflow-hidden\"\r\n            >\r\n                {/* Header */}\r\n                <div className=\"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <Forward className=\"text-brand-blue\" size={20} />\r\n                        <h3 className=\"font-bold text-lg dark:text-white\">Forward Message</h3>\r\n                    </div>\r\n                    <button \r\n                        onClick={onClose}\r\n                        className=\"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition\"\r\n                    >\r\n                        <X size={20} />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Message preview */}\r\n                <div className=\"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 shrink-0\">\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Forwarding:</p>\r\n                    <div className=\"bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600\">\r\n                        <p className=\"text-sm dark:text-gray-200 line-clamp-2\">\r\n                            {getMessagePreview()}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Search */}\r\n                <div className=\"px-4 py-3 border-b dark:border-gray-700 shrink-0\">\r\n                    <div className=\"relative\">\r\n                        <Search size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search conversations...\"\r\n                            value={searchQuery}\r\n                            onChange={(e) => setSearchQuery(e.target.value)}\r\n                            className=\"w-full pl-9 pr-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white transition\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Conversation list */}\r\n                <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\r\n                    {filteredConversations.length === 0 ? (\r\n                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500\">\r\n                            <p className=\"text-sm\">No conversations found</p>\r\n                        </div>\r\n                    ) : (\r\n                        filteredConversations.map(convo => {\r\n                            const isSelected = selectedChats.includes(convo.id);\r\n                            return (\r\n                                <motion.div\r\n                                    key={convo.id}\r\n                                    whileTap={{ scale: 0.98 }}\r\n                                    onClick={() => toggleSelect(convo.id)}\r\n                                    className={`\r\n                                        flex items-center gap-3 p-4 cursor-pointer transition\r\n                                        border-b dark:border-gray-700/50\r\n                                        ${isSelected \r\n                                            ? 'bg-brand-blue/10 dark:bg-brand-blue/20' \r\n                                            : 'hover:bg-gray-50 dark:hover:bg-gray-800'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <div className=\"relative\">\r\n                                        <UserAvatar\r\n                                            src={convo.photo}\r\n                                            name={convo.n}\r\n                                            size=\"md\"\r\n                                            isGroup={convo.type === 'group'}\r\n                                        />\r\n                                        {isSelected && (\r\n                                            <motion.div\r\n                                                initial={{ scale: 0 }}\r\n                                                animate={{ scale: 1 }}\r\n                                                className=\"absolute -bottom-1 -right-1 w-5 h-5 bg-brand-blue rounded-full flex items-center justify-center\"\r\n                                            >\r\n                                                <Check size={12} className=\"text-white\" />\r\n                                            </motion.div>\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <h4 className=\"font-semibold text-sm dark:text-white truncate\">\r\n                                            {convo.n}\r\n                                        </h4>\r\n                                        <p className=\"text-xs text-gray-500 truncate\">\r\n                                            {convo.type === 'group' ? 'Group' : 'Direct message'}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className={`\r\n                                        w-5 h-5 rounded-full border-2 transition\r\n                                        ${isSelected \r\n                                            ? 'border-brand-blue bg-brand-blue' \r\n                                            : 'border-gray-300 dark:border-gray-600'\r\n                                        }\r\n                                    `}>\r\n                                        {isSelected && <Check size={12} className=\"text-white m-auto\" />}\r\n                                    </div>\r\n                                </motion.div>\r\n                            );\r\n                        })\r\n                    )}\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] shrink-0\">\r\n                    <div className=\"flex items-center justify-between mb-3\">\r\n                        <span className=\"text-sm text-gray-500\">\r\n                            {selectedChats.length} conversation{selectedChats.length !== 1 ? 's' : ''} selected\r\n                        </span>\r\n                        {selectedChats.length > 0 && (\r\n                            <button \r\n                                onClick={() => setSelectedChats([])}\r\n                                className=\"text-xs text-brand-blue hover:underline\"\r\n                            >\r\n                                Clear all\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                    <button\r\n                        onClick={handleForward}\r\n                        disabled={selectedChats.length === 0 || forwarding}\r\n                        className=\"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-2\"\r\n                    >\r\n                        {forwarding ? (\r\n                            <>\r\n                                <Loader2 className=\"animate-spin\" size={18} />\r\n                                Forwarding...\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <Forward size={18} />\r\n                                Forward\r\n                            </>\r\n                        )}\r\n                    </button>\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import { useMemo, useCallback } from 'react';\r\nimport { useQuery, useMutation } from \"convex/react\";\r\nimport { api } from \"../../convex/_generated/api\";\r\nimport { isConvexAvailable } from '../config/convex';\r\n\r\n/**\r\n * Hook for managing read receipts in a chat\r\n * Tracks which messages have been read by users\r\n * \r\n * @param {string} chatId - Chat ID\r\n * @param {string} currentUserId - Current user's UID\r\n */\r\nexport function useReadReceipts(chatId, currentUserId) {\r\n    // Check Convex availability directly to avoid hook initialization issues\r\n    const convexAvailable = isConvexAvailable();\r\n    const readReceiptsQuery = useMemo(() => {\r\n        return chatId && currentUserId && convexAvailable ? { chatId } : \"skip\";\r\n    }, [chatId, currentUserId, convexAvailable]);\r\n    \r\n    // Fetch read receipts from Convex\r\n    // Hook must always be called, but we skip if Convex not available\r\n    const readReceiptsData = useQuery(\r\n        api.readReceipts.getReadReceipts,\r\n        readReceiptsQuery\r\n    );\r\n\r\n    // Hooks must be called unconditionally (React rules)\r\n    const markAsReadMutation = useMutation(api.readReceipts.markAsRead);\r\n    const markMultipleAsReadMutation = useMutation(api.readReceipts.markMultipleAsRead);\r\n\r\n    // Transform Convex data to match existing format\r\n    const readReceipts = useMemo(() => {\r\n        if (!readReceiptsData) return {};\r\n        \r\n        const receipts = {};\r\n        readReceiptsData.forEach(receipt => {\r\n            if (!receipts[receipt.userId]) {\r\n                receipts[receipt.userId] = {\r\n                    lastReadMessageId: receipt.messageId,\r\n                    readAt: receipt.readAt,\r\n                };\r\n            } else {\r\n                // Keep the latest read message\r\n                if (receipt.readAt > receipts[receipt.userId].readAt) {\r\n                    receipts[receipt.userId] = {\r\n                        lastReadMessageId: receipt.messageId,\r\n                        readAt: receipt.readAt,\r\n                    };\r\n                }\r\n            }\r\n        });\r\n        return receipts;\r\n    }, [readReceiptsData]);\r\n\r\n    // Get current user's last read\r\n    const myLastRead = readReceipts[currentUserId]?.lastReadMessageId || null;\r\n\r\n    /**\r\n     * Mark a message (or all messages up to a message) as read\r\n     */\r\n    const markAsRead = useCallback(async (messageIds) => {\r\n        if (!chatId || !currentUserId || !messageIds || !isConvexAvailable() || !markAsReadMutation || !markMultipleAsReadMutation) return;\r\n\r\n        try {\r\n            const messageIdArray = Array.isArray(messageIds) ? messageIds : [messageIds];\r\n            \r\n            if (messageIdArray.length === 1) {\r\n                await markAsReadMutation({\r\n                    chatId,\r\n                    messageId: messageIdArray[0],\r\n                    userId: currentUserId,\r\n                });\r\n            } else {\r\n                await markMultipleAsReadMutation({\r\n                    chatId,\r\n                    messageIds: messageIdArray,\r\n                    userId: currentUserId,\r\n                });\r\n            }\r\n        } catch (error) {\r\n            console.error('Mark as read error:', error);\r\n        }\r\n    }, [chatId, currentUserId, markAsReadMutation, markMultipleAsReadMutation]);\r\n\r\n    /**\r\n     * Check if a specific message has been read by a user\r\n     */\r\n    const isMessageRead = useCallback((messageId, userId, messages = null) => {\r\n        if (!messageId || !userId) return false;\r\n        \r\n        const userReceipt = readReceipts[userId];\r\n        if (!userReceipt || !userReceipt.lastReadMessageId) return false;\r\n\r\n        const lastReadMessageId = userReceipt.lastReadMessageId;\r\n        \r\n        // If exact match, definitely read\r\n        if (lastReadMessageId === messageId) {\r\n            return true;\r\n        }\r\n\r\n        // If we have messages array, compare timestamps\r\n        if (messages && Array.isArray(messages)) {\r\n            const message = messages.find(m => m.id === messageId);\r\n            const lastReadMessage = messages.find(m => m.id === lastReadMessageId);\r\n            \r\n            if (message && lastReadMessage && message.t && lastReadMessage.t) {\r\n                return message.t <= lastReadMessage.t;\r\n            }\r\n        }\r\n\r\n        // For Convex, we can compare IDs directly\r\n        // Convex IDs are sortable and maintain order\r\n        return lastReadMessageId >= messageId;\r\n    }, [readReceipts]);\r\n\r\n    /**\r\n     * Get the latest read message ID for a user\r\n     */\r\n    const getLastReadMessage = useCallback((userId) => {\r\n        return readReceipts[userId]?.lastReadMessageId || null;\r\n    }, [readReceipts]);\r\n\r\n    /**\r\n     * Check if current user has read a message\r\n     */\r\n    const hasCurrentUserRead = useCallback((messageId) => {\r\n        return myLastRead === messageId || (myLastRead && myLastRead >= messageId);\r\n    }, [myLastRead]);\r\n\r\n    return {\r\n        readReceipts,\r\n        myLastRead,\r\n        markAsRead,\r\n        isMessageRead,\r\n        getLastReadMessage,\r\n        hasCurrentUserRead\r\n    };\r\n}\r\n","// Link preview utility - uses client-side inference and public APIs\r\n\r\n// Cache for link previews to avoid repeated API calls\r\nconst previewCache = new Map();\r\nconst CACHE_DURATION = 5 * 60 * 1000; // 5 minutes\r\n\r\n/**\r\n * Fetch link preview data using client-side inference.\r\n * Uses smart parsing and public APIs to generate link previews.\r\n */\r\nexport default async function getLinkPreview(url) {\r\n    // Simple regex to extract the first full URL\r\n    const urlMatch = url.match(/(https?:\\/\\/[^\\s]+)/);\r\n    if (!urlMatch) {\r\n        return null;\r\n    }\r\n\r\n    const matchedUrl = urlMatch[0];\r\n\r\n    // Check cache first\r\n    const cached = previewCache.get(matchedUrl);\r\n    if (cached && Date.now() - cached.timestamp < CACHE_DURATION) {\r\n        return cached.data;\r\n    }\r\n\r\n    // Use client-side inference and public APIs\r\n    const data = await getClientSideLinkPreview(matchedUrl);\r\n    previewCache.set(matchedUrl, { data, timestamp: Date.now() });\r\n    return data;\r\n}\r\n\r\n/**\r\n * Client-side link preview with smart inference for known platforms.\r\n * Uses Open Graph meta tags when possible, falls back to platform-specific inference.\r\n */\r\nasync function getClientSideLinkPreview(url) {\r\n    // Try to fetch Open Graph data first (if CORS allows)\r\n    try {\r\n        // Use a CORS proxy or direct fetch if same-origin\r\n        const response = await fetch(url, { \r\n            method: 'HEAD',\r\n            mode: 'no-cors' // This won't give us headers, but we can try\r\n        });\r\n        \r\n        // For same-origin or CORS-enabled sites, try to get actual meta tags\r\n        // This is a best-effort approach\r\n    } catch (e) {\r\n        // CORS blocked - continue with inference\r\n    }\r\n    const data = {\r\n        url: url,\r\n        title: null,\r\n        description: null,\r\n        image: null,\r\n        siteName: null\r\n    };\r\n\r\n    try {\r\n        const urlObj = new URL(url);\r\n        const hostname = urlObj.hostname.toLowerCase();\r\n\r\n        // YouTube\r\n        if (hostname.includes('youtube.com') || hostname.includes('youtu.be')) {\r\n            let videoId = null;\r\n            if (hostname.includes('youtu.be')) {\r\n                videoId = urlObj.pathname.slice(1);\r\n            } else {\r\n                videoId = urlObj.searchParams.get('v');\r\n            }\r\n            \r\n            data.siteName = 'YouTube';\r\n            data.title = 'YouTube Video';\r\n            data.description = 'Watch this video on YouTube';\r\n            if (videoId) {\r\n                data.image = `https://img.youtube.com/vi/${videoId}/mqdefault.jpg`;\r\n            }\r\n        }\r\n        // Spotify\r\n        else if (hostname.includes('spotify.com')) {\r\n            data.siteName = 'Spotify';\r\n            data.title = 'Spotify Content';\r\n            data.description = 'Listen on Spotify';\r\n            data.image = 'https://storage.googleapis.com/pr-newsroom-wp/1/2018/11/Spotify_Logo_RGB_Green.png';\r\n        }\r\n        // SoundCloud\r\n        else if (hostname.includes('soundcloud.com')) {\r\n            data.siteName = 'SoundCloud';\r\n            data.title = 'SoundCloud Track';\r\n            data.description = 'Listen on SoundCloud';\r\n            data.image = 'https://soundcloud.com/press/assets/press-kit/soundcloud-logo.png';\r\n        }\r\n        // GitHub\r\n        else if (hostname.includes('github.com')) {\r\n            const pathParts = urlObj.pathname.split('/').filter(p => p);\r\n            data.siteName = 'GitHub';\r\n            data.title = pathParts.length >= 2 ? `${pathParts[0]}/${pathParts[1]}` : 'GitHub Repository';\r\n            data.description = 'View on GitHub';\r\n            if (pathParts.length >= 2) {\r\n                data.image = `https://opengraph.githubassets.com/1/${pathParts[0]}/${pathParts[1]}`;\r\n            }\r\n        }\r\n        // Twitter/X\r\n        else if (hostname.includes('twitter.com') || hostname.includes('x.com')) {\r\n            data.siteName = 'X (Twitter)';\r\n            data.title = 'Tweet';\r\n            data.description = 'View on X';\r\n        }\r\n        // Instagram\r\n        else if (hostname.includes('instagram.com')) {\r\n            data.siteName = 'Instagram';\r\n            data.title = 'Instagram Post';\r\n            data.description = 'View on Instagram';\r\n        }\r\n        // SeshNx internal links\r\n        else if (hostname.includes('app.seshnx.com') || hostname.includes('seshnx.com')) {\r\n            data.siteName = 'SeshNx';\r\n            data.title = 'SeshNx Link';\r\n            data.description = 'View on SeshNx platform';\r\n            data.image = 'https://app.seshnx.com/pwa-512x512.png';\r\n        }\r\n        // LinkedIn\r\n        else if (hostname.includes('linkedin.com')) {\r\n            data.siteName = 'LinkedIn';\r\n            data.title = 'LinkedIn Post';\r\n            data.description = 'View on LinkedIn';\r\n        }\r\n        // Apple Music\r\n        else if (hostname.includes('music.apple.com')) {\r\n            data.siteName = 'Apple Music';\r\n            data.title = 'Apple Music';\r\n            data.description = 'Listen on Apple Music';\r\n        }\r\n        // TikTok\r\n        else if (hostname.includes('tiktok.com')) {\r\n            data.siteName = 'TikTok';\r\n            data.title = 'TikTok Video';\r\n            data.description = 'Watch on TikTok';\r\n        }\r\n        // Vimeo\r\n        else if (hostname.includes('vimeo.com')) {\r\n            data.siteName = 'Vimeo';\r\n            data.title = 'Vimeo Video';\r\n            data.description = 'Watch on Vimeo';\r\n        }\r\n        // Bandcamp\r\n        else if (hostname.includes('bandcamp.com')) {\r\n            const subdomain = hostname.split('.')[0];\r\n            data.siteName = 'Bandcamp';\r\n            data.title = subdomain !== 'bandcamp' ? `${subdomain} on Bandcamp` : 'Bandcamp';\r\n            data.description = 'Listen on Bandcamp';\r\n        }\r\n        // Generic fallback\r\n        else {\r\n            data.siteName = hostname.replace('www.', '');\r\n            data.title = hostname.replace('www.', '');\r\n            data.description = `Visit ${hostname}`;\r\n        }\r\n\r\n        return data;\r\n    } catch (e) {\r\n        console.warn('Link preview parsing error:', e);\r\n        return {\r\n            url: url,\r\n            title: url,\r\n            description: null,\r\n            image: null\r\n        };\r\n    }\r\n}\r\n","import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\r\nimport { ArrowLeft, Info, MessageSquare, Users } from 'lucide-react';\r\nimport { useQuery, useMutation } from \"convex/react\";\r\nimport { api } from \"../../../convex/_generated/api\";\r\nimport { isConvexAvailable } from '../../config/convex';\r\nimport ChatInput from './ChatInput';\r\nimport SeshNxEmbedModal from '../SeshNxEmbedModal';\r\nimport MessageBubble from './message/MessageBubble';\r\nimport ForwardMessageModal from './message/ForwardMessageModal';\r\nimport PresenceIndicator, { StatusBadge } from './PresenceIndicator';\r\nimport { useUserPresence } from '../../hooks/usePresence';\r\nimport { useReadReceipts } from '../../hooks/useReadReceipts';\r\nimport { useTypingIndicator, formatTypingUsers } from '../../hooks/useTypingIndicator';\r\nimport getLinkPreview from '../../utils/linkPreview';\r\nimport UserAvatar from '../shared/UserAvatar';\r\nimport { useLanguage } from '../../contexts/LanguageContext';\r\n\r\nexport default function ChatWindow({ user, userData, activeChat, conversations, onBack, toggleDetails, openPublicProfile }) {\r\n    const { t } = useLanguage();\r\n    const [linkPreviewData, setLinkPreviewData] = useState({});\r\n    const [embedModal, setEmbedModal] = useState({ isOpen: false, url: '', previewData: null });\r\n    const [replyingTo, setReplyingTo] = useState(null);\r\n    const [editingMessage, setEditingMessage] = useState(null);\r\n    const [forwardingMessage, setForwardingMessage] = useState(null);\r\n    const messagesEndRef = useRef(null);\r\n\r\n    const chatId = activeChat?.id;\r\n    const chatName = activeChat?.name || activeChat?.n || t('unknownUser');\r\n\r\n    // Normalize user ID for backward compatibility\r\n    const userId = user?.id || user?.uid;\r\n\r\n    // Get other user's UID for direct chats (for presence and read receipts)\r\n    const otherUserId = useMemo(() => {\r\n        if (activeChat?.type === 'group') return null;\r\n        if (activeChat?.uid) return activeChat.uid;\r\n        if (chatId && chatId.includes('_')) {\r\n            const parts = chatId.split('_');\r\n            return parts.find(id => id !== userId);\r\n        }\r\n        return null;\r\n    }, [activeChat, chatId, userId]);\r\n\r\n    // Presence tracking\r\n    const { online, lastSeen, loading: presenceLoading } = useUserPresence(otherUserId);\r\n\r\n    // Read receipts tracking\r\n    const {\r\n        markAsRead,\r\n        hasCurrentUserRead,\r\n        isMessageRead,\r\n        myLastRead\r\n    } = useReadReceipts(chatId, userId);\r\n\r\n    // Typing indicator tracking\r\n    const { typingUsers, setTyping, clearTyping } = useTypingIndicator(\r\n        chatId,\r\n        userId,\r\n        userData?.firstName || 'User'\r\n    );\r\n\r\n    // FIX: Determine Convex availability directly. \r\n    // Removing useMemo prevents the \"Cannot access before initialization\" error.\r\n    const convexAvailable = isConvexAvailable();\r\n\r\n    const messagesQuery = useMemo(() => {\r\n        return chatId && convexAvailable ? { chatId, limit: 100 } : \"skip\";\r\n    }, [chatId, convexAvailable]);\r\n\r\n    // Query for group chat members\r\n    const chatMembersQuery = useMemo(() => {\r\n        return chatId && convexAvailable && activeChat?.type === 'group' ? { chatId } : \"skip\";\r\n    }, [chatId, convexAvailable, activeChat?.type]);\r\n\r\n    const chatMembersData = useQuery(\r\n        api.conversations.getChatMembers,\r\n        chatMembersQuery\r\n    );\r\n\r\n    // Extract member user IDs from chat members data\r\n    const groupMemberIds = useMemo(() => {\r\n        if (!chatMembersData) return [];\r\n        return chatMembersData.map(m => m.userId);\r\n    }, [chatMembersData]);\r\n\r\n    // Fetch messages from Convex (automatically reactive)\r\n    // Hook must always be called, but we skip if Convex not available\r\n    const messagesData = useQuery(\r\n        api.messages.getMessages,\r\n        messagesQuery\r\n    );\r\n\r\n    // Transform Convex messages to match existing format\r\n    const messages = useMemo(() => {\r\n        if (!messagesData) return [];\r\n\r\n        return messagesData.map(msg => ({\r\n            id: msg._id,\r\n            b: msg.content || '',\r\n            s: msg.senderId,\r\n            n: msg.senderName,\r\n            photo: msg.senderPhoto || '',\r\n            t: msg.timestamp,\r\n            edited: msg.edited || false,\r\n            editedAt: msg.editedAt,\r\n            deleted: msg.deleted || false,\r\n            deletedForAll: msg.deletedForAll || false,\r\n            media: msg.media,\r\n            replyTo: msg.replyTo,\r\n            reactions: msg.reactions || {},\r\n        }));\r\n    }, [messagesData]);\r\n\r\n    // Mutations - hooks must be called unconditionally (React rules)\r\n    const sendMessageMutation = useMutation(api.messages.sendMessage);\r\n    const editMessageMutation = useMutation(api.messages.editMessage);\r\n    const deleteMessageMutation = useMutation(api.messages.deleteMessage);\r\n    const addReactionMutation = useMutation(api.messages.addReaction);\r\n    const removeReactionMutation = useMutation(api.messages.removeReaction);\r\n    const updateConversationMutation = useMutation(api.conversations.updateConversation);\r\n    const updateUnreadCountMutation = useMutation(api.conversations.updateUnreadCount);\r\n\r\n    // Auto-scroll to bottom and mark messages as read\r\n    useEffect(() => {\r\n        if (messagesEndRef.current && messages.length > 0) {\r\n            messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n        }\r\n    }, [messages]);\r\n\r\n    // Mark messages as read when viewing\r\n    // Use a ref to track the last message count to prevent infinite loops\r\n    const lastMarkedCountRef = useRef(0);\r\n\r\n    useEffect(() => {\r\n        if (chatId && userId && messages.length > 0) {\r\n            // Only mark as read if the message count actually changed\r\n            // This prevents infinite loops from markAsRead triggering re-renders\r\n            const currentMessageIds = messages.map(m => m.id);\r\n            const currentCount = currentMessageIds.length;\r\n\r\n            if (currentCount !== lastMarkedCountRef.current) {\r\n                lastMarkedCountRef.current = currentCount;\r\n                markAsRead(currentMessageIds);\r\n            }\r\n        }\r\n    }, [chatId, userId, messages.length, markAsRead]);\r\n\r\n    // Fetch link previews for messages\r\n    useEffect(() => {\r\n        messages.forEach(msg => {\r\n            if (msg.b) {\r\n                const urlMatch = msg.b.match(/(https?:\\/\\/[^\\s]+)/);\r\n                if (urlMatch) {\r\n                    const url = urlMatch[0];\r\n                    if (!linkPreviewData[msg.id]) {\r\n                        getLinkPreview(url)\r\n                            .then(data => setLinkPreviewData(prev => ({ ...prev, [msg.id]: data })))\r\n                            .catch(e => console.error(e));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }, [messages]);\r\n\r\n    // --- REACTION HANDLER ---\r\n    const handleReaction = async (messageId, emoji) => {\r\n        if (!chatId || !userId || !isConvexAvailable()) return;\r\n\r\n        try {\r\n            // Check if user already has this reaction\r\n            const message = messages.find(m => m.id === messageId);\r\n            if (!message) return;\r\n\r\n            const hasReaction = message.reactions?.[emoji]?.includes(userId);\r\n\r\n            if (hasReaction) {\r\n                await removeReactionMutation({ messageId, userId: userId, emoji });\r\n            } else {\r\n                await addReactionMutation({ messageId, userId: userId, emoji });\r\n            }\r\n        } catch (error) {\r\n            console.error('Reaction error:', error);\r\n        }\r\n    };\r\n\r\n    // --- FORWARD HANDLER ---\r\n    const handleForward = async (message, targetChatIds) => {\r\n        if (!isConvexAvailable() || !sendMessageMutation || !updateConversationMutation) {\r\n            alert(\"Chat functionality is not available. Convex is not configured.\");\r\n            return;\r\n        }\r\n\r\n        const forwardText = message.b || '';\r\n        const forwardMedia = message.media || null;\r\n\r\n        for (const targetChatId of targetChatIds) {\r\n            try {\r\n                // GUARD: Ensure no nulls are passed to optional fields\r\n                await sendMessageMutation({\r\n                    chatId: targetChatId,\r\n                    senderId: userId,\r\n                    senderName: userData.firstName || 'User',\r\n                    senderPhoto: userData.photoURL || undefined, // Strict undefined\r\n                    content: `竊ｪ Forwarded: ${forwardText}`,\r\n                    media: forwardMedia || undefined, // Strict undefined\r\n                });\r\n\r\n                // Update conversation\r\n                const targetConvo = conversations?.find(c => c.id === targetChatId);\r\n                const summary = forwardText || (forwardMedia ? `Forwarded ${forwardMedia.type}` : 'Forwarded message');\r\n\r\n                await updateConversationMutation({\r\n                    userId: userId,\r\n                    chatId: targetChatId,\r\n                    lastMessage: `↪ ${summary}`,\r\n                    lastMessageTime: Date.now(),\r\n                    lastSenderId: userId,\r\n                    chatName: targetConvo?.name || targetConvo?.n,\r\n                    chatPhoto: targetConvo?.photo || '',\r\n                    chatType: targetConvo?.type || 'direct',\r\n                    otherUserId: targetConvo?.uid,\r\n                });\r\n            } catch (error) {\r\n                console.error('Forward error for chat:', targetChatId, error);\r\n            }\r\n        }\r\n    };\r\n\r\n    // --- SEND LOGIC ---\r\n    const sendMessage = async (text, mediaData) => {\r\n        if (!chatId || (!text?.trim() && !mediaData) || !isConvexAvailable() || !sendMessageMutation || !editMessageMutation || !updateConversationMutation || !updateUnreadCountMutation) return;\r\n\r\n        let msgText = text ? text.trim() : '';\r\n        if (msgText.length === 0 && mediaData) {\r\n            msgText = mediaData.type === 'image' ? '📷 Image' :\r\n                mediaData.type === 'video' ? '🎥 Video' :\r\n                    mediaData.type === 'audio' ? '🎵 Audio' : '📎 File';\r\n        }\r\n\r\n        // Handle edit mode\r\n        if (editingMessage) {\r\n            try {\r\n                await editMessageMutation({\r\n                    messageId: editingMessage.id,\r\n                    content: msgText,\r\n                    senderId: userId,\r\n                });\r\n                setEditingMessage(null);\r\n                return;\r\n            } catch (error) {\r\n                console.error('Edit error:', error);\r\n                return;\r\n            }\r\n        }\r\n\r\n        try {\r\n            // Send message\r\n            // GUARD: Ensure strictly undefined for null/empty optional fields\r\n            await sendMessageMutation({\r\n                chatId,\r\n                senderId: userId,\r\n                senderName: userData.firstName || 'User',\r\n                senderPhoto: userData.photoURL || undefined, // undefined if null\r\n                content: msgText || undefined,               // undefined if empty\r\n                media: mediaData || undefined,               // undefined if null\r\n                replyTo: replyingTo ? {\r\n                    messageId: replyingTo.id,\r\n                    text: replyingTo.b?.substring(0, 100) || 'Media',\r\n                    sender: replyingTo.n || 'User',\r\n                } : undefined,\r\n            });\r\n\r\n            // Update conversation for all recipients\r\n            const summary = msgText || (mediaData ? `Sent ${mediaData.type}` : 'Message');\r\n            let recipientIds = [];\r\n            let otherUid = activeChat.uid;\r\n\r\n            if (!otherUid && activeChat.type !== 'group' && chatId && chatId.includes('_')) {\r\n                const parts = chatId.split('_');\r\n                otherUid = parts.find(id => id !== userId);\r\n            }\r\n\r\n            if (activeChat.type === 'group') {\r\n                // For group chats, use the queried members from chatMembers table\r\n                // Include current user if not already in the list\r\n                recipientIds = groupMemberIds.length > 0\r\n                    ? [...new Set([userId, ...groupMemberIds])]\r\n                    : [userId];\r\n            } else if (otherUid) {\r\n                recipientIds = [userId, otherUid];\r\n            } else {\r\n                recipientIds = [userId];\r\n            }\r\n\r\n            // Update conversations for all recipients\r\n            for (const recipientUid of recipientIds) {\r\n                await updateConversationMutation({\r\n                    userId: recipientUid,\r\n                    chatId,\r\n                    lastMessage: summary,\r\n                    lastMessageTime: Date.now(),\r\n                    lastSenderId: userId,\r\n                    chatName: activeChat.type === 'group' ? chatName : (activeChat.name || activeChat.n),\r\n                    chatPhoto: activeChat.photo || '',\r\n                    chatType: activeChat.type || 'direct',\r\n                    otherUserId: activeChat.type === 'direct' ? (recipientUid === userId ? otherUid : userId) : undefined,\r\n                });\r\n\r\n                // Update unread count (increment for others, reset for sender)\r\n                if (recipientUid === userId) {\r\n                    await updateUnreadCountMutation({\r\n                        userId: recipientUid,\r\n                        chatId,\r\n                        setTo: 0,\r\n                    });\r\n                } else {\r\n                    await updateUnreadCountMutation({\r\n                        userId: recipientUid,\r\n                        chatId,\r\n                        increment: 1,\r\n                    });\r\n                }\r\n            }\r\n\r\n            setReplyingTo(null);\r\n        } catch (error) {\r\n            console.error('Send message error:', error);\r\n        }\r\n    };\r\n\r\n    // --- DELETE HANDLER ---\r\n    const handleDelete = async (messageId, forEveryone = false) => {\r\n        if (!chatId || !userId || !isConvexAvailable() || !deleteMessageMutation) return;\r\n\r\n        try {\r\n            await deleteMessageMutation({\r\n                messageId,\r\n                senderId: userId,\r\n                forEveryone,\r\n            });\r\n        } catch (error) {\r\n            console.error('Delete error:', error);\r\n        }\r\n    };\r\n\r\n    // --- HEADER ---\r\n    const ChatHeader = useMemo(() => (\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-800 bg-white dark:bg-[#1f2128]\">\r\n            <div className=\"flex items-center gap-3 flex-1 min-w-0\">\r\n                <button\r\n                    onClick={onBack}\r\n                    className=\"md:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors\"\r\n                >\r\n                    <ArrowLeft className=\"w-5 h-5\" />\r\n                </button>\r\n\r\n                <div\r\n                    className=\"flex items-center gap-3 flex-1 min-w-0 cursor-pointer\"\r\n                    onClick={() => openPublicProfile?.(otherUserId ? { uid: otherUserId } : null)}\r\n                >\r\n                    <UserAvatar\r\n                        src={activeChat?.photo || activeChat?.n?.photo || ''}\r\n                        name={chatName}\r\n                        size=\"md\"\r\n                    />\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <h3 className=\"font-semibold text-gray-900 dark:text-white truncate\">\r\n                                {chatName}\r\n                            </h3>\r\n                            {activeChat?.type !== 'group' && (\r\n                                <PresenceIndicator\r\n                                    online={online}\r\n                                    lastSeen={lastSeen}\r\n                                    loading={presenceLoading}\r\n                                />\r\n                            )}\r\n                        </div>\r\n                        {activeChat?.type !== 'group' && (\r\n                            <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                                {online ? 'Online' : lastSeen ? `Last seen ${formatLastSeen(lastSeen)}` : 'Offline'}\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <button\r\n                onClick={toggleDetails}\r\n                className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors\"\r\n            >\r\n                <Info className=\"w-5 h-5 text-gray-600 dark:text-gray-400\" />\r\n            </button>\r\n        </div>\r\n    ), [activeChat, chatName, online, lastSeen, presenceLoading, otherUserId, onBack, toggleDetails, openPublicProfile]);\r\n\r\n    // Format last seen helper\r\n    const formatLastSeen = (timestamp) => {\r\n        if (!timestamp) return 'Never';\r\n        const lastSeenMs = typeof timestamp === 'number' ? timestamp : timestamp;\r\n        const now = Date.now();\r\n        const diffMs = now - lastSeenMs;\r\n        const diffMins = Math.floor(diffMs / 60000);\r\n        const diffHours = Math.floor(diffMins / 60);\r\n        const diffDays = Math.floor(diffHours / 24);\r\n\r\n        if (diffMins < 1) return 'Just now';\r\n        if (diffMins < 60) return `${diffMins}m ago`;\r\n        if (diffHours < 24) return `${diffHours}h ago`;\r\n        if (diffDays < 7) return `${diffDays}d ago`;\r\n        return new Date(lastSeenMs).toLocaleDateString();\r\n    };\r\n\r\n    // Early return for no active chat (after all hooks are called to maintain hook count)\r\n    if (!activeChat || !chatId) {\r\n        return (\r\n            <div className=\"flex flex-col h-full bg-white dark:bg-[#1f2128] items-center justify-center text-gray-400\">\r\n                <div className=\"w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4\">\r\n                    <Users size={64} className=\"text-gray-200 dark:text-gray-700 mb-2\" />\r\n                </div>\r\n                <p>Select a conversation to start chatting</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-white dark:bg-[#1f2128]\">\r\n            {ChatHeader}\r\n\r\n            {/* Messages Area */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-4 scrollbar-hide\">\r\n                {messages.length === 0 ? (\r\n                    <div className=\"flex items-center justify-center h-full text-gray-400\">\r\n                        <p>{t('noMessages')}. {t('startConversation')}!</p>\r\n                    </div>\r\n                ) : (\r\n                    messages.map((message, index) => {\r\n                        const previousMessage = index > 0 ? messages[index - 1] : null;\r\n                        const isCurrentUser = message.s === userId;\r\n                        const isRead = isMessageRead(message.id);\r\n                        const hasRead = hasCurrentUserRead(message.id);\r\n\r\n                        return (\r\n                            <MessageBubble\r\n                                key={message.id}\r\n                                message={message}\r\n                                isCurrentUser={isCurrentUser}\r\n                                previousMessage={previousMessage}\r\n                                currentUserId={userId}\r\n                                chatId={chatId}\r\n                                linkPreviewData={linkPreviewData[message.id]}\r\n                                messageStatus={isRead ? 'read' : hasRead ? 'delivered' : 'sent'}\r\n                                onReaction={(emoji) => handleReaction(message.id, emoji)}\r\n                                onReply={() => setReplyingTo(message)}\r\n                                onEdit={() => setEditingMessage(message)}\r\n                                onDelete={(forEveryone) => handleDelete(message.id, forEveryone)}\r\n                                onForward={() => setForwardingMessage(message)}\r\n                                onSeshNxLinkClick={(url) => setEmbedModal({ isOpen: true, url, previewData: null })}\r\n                                onUserClick={() => openPublicProfile?.({ uid: message.s })}\r\n                            />\r\n                        );\r\n                    })\r\n                )}\r\n                <div ref={messagesEndRef} />\r\n            </div>\r\n\r\n            {/* Chat Input */}\r\n            <ChatInput\r\n                activeChatId={chatId}\r\n                uid={userId}\r\n                onSend={sendMessage}\r\n                replyingTo={replyingTo}\r\n                editingMessage={editingMessage}\r\n                onCancelReply={() => setReplyingTo(null)}\r\n                onCancelEdit={() => setEditingMessage(null)}\r\n                typingUsers={typingUsers}\r\n                onTyping={setTyping}\r\n                onStopTyping={clearTyping}\r\n            />\r\n\r\n            {/* Forward Modal */}\r\n            {forwardingMessage && (\r\n                <ForwardMessageModal\r\n                    message={forwardingMessage}\r\n                    conversations={conversations}\r\n                    onClose={() => setForwardingMessage(null)}\r\n                    onForward={handleForward}\r\n                />\r\n            )}\r\n\r\n            {/* Embed Modal */}\r\n            {embedModal.isOpen && (\r\n                <SeshNxEmbedModal\r\n                    url={embedModal.url}\r\n                    previewData={embedModal.previewData}\r\n                    onClose={() => setEmbedModal({ isOpen: false, url: '', previewData: null })}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function StatCard({ title, value, icon, sub, bg = \"bg-white dark:bg-[#2c2e36]\", text = \"text-gray-900 dark:text-white\" }) {\r\n  return (\r\n    <div className={`${bg} p-5 rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm flex flex-col justify-between h-28`}>\r\n      <div className=\"flex justify-between items-start\">\r\n        <div>\r\n          <div className={`text-sm font-medium ${text === 'text-white' ? 'text-blue-100' : 'text-gray-500'}`}>{title}</div>\r\n          <div className={`text-2xl font-extrabold ${text}`}>{value}</div>\r\n        </div>\r\n        <div className=\"opacity-80\">{icon}</div>\r\n      </div>\r\n      {sub && <div className=\"text-xs mt-auto opacity-75\">{sub}</div>}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { X, Image as ImageIcon, Video, FileText, Music, ChevronLeft, ChevronRight, Download } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useQuery } from \"convex/react\";\r\nimport { api } from \"../../../../convex/_generated/api\";\r\nimport { isConvexAvailable } from '../../../config/convex';\r\n\r\n/**\r\n * Media gallery component to view all shared media in a chat\r\n */\r\nexport default function MediaGallery({ \r\n    chatId, \r\n    onClose,\r\n    onMediaSelect \r\n}) {\r\n    const [media, setMedia] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedMedia, setSelectedMedia] = useState(null);\r\n    const [filter, setFilter] = useState('all'); // 'all' | 'images' | 'videos' | 'audio' | 'files'\r\n\r\n    const convexAvailable = isConvexAvailable();\r\n    const mediaQuery = (chatId && convexAvailable) ? { chatId, limit: 500 } : \"skip\";\r\n    const mediaMessages = useQuery(api.messages.getMediaMessages, mediaQuery);\r\n\r\n    useEffect(() => {\r\n        if (!chatId || !convexAvailable) {\r\n            setMedia([]);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n        if (!mediaMessages) return;\r\n\r\n        const mediaItems = (mediaMessages || [])\r\n            .filter(msg => msg.media && !msg.deleted && !msg.deletedForAll)\r\n            .map(msg => ({\r\n                id: msg._id,\r\n                ...(msg.media || {}),\r\n                messageId: msg._id,\r\n                timestamp: msg.timestamp,\r\n                sender: msg.senderName\r\n            }))\r\n            .sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\r\n\r\n        setMedia(mediaItems);\r\n        setLoading(false);\r\n    }, [chatId, convexAvailable, mediaMessages]);\r\n\r\n    const filteredMedia = filter === 'all' \r\n        ? media \r\n        : media.filter(item => {\r\n            if (filter === 'images') return item.type === 'image';\r\n            if (filter === 'videos') return item.type === 'video';\r\n            if (filter === 'audio') return item.type === 'audio';\r\n            if (filter === 'files') return item.type === 'file';\r\n            return true;\r\n        });\r\n\r\n    const handleMediaClick = (item) => {\r\n        setSelectedMedia(item);\r\n        if (onMediaSelect) {\r\n            onMediaSelect(item);\r\n        }\r\n    };\r\n\r\n    const handleDownload = (item) => {\r\n        const link = document.createElement('a');\r\n        link.href = item.url;\r\n        link.download = item.name || 'download';\r\n        link.target = '_blank';\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4\">\r\n            <motion.div\r\n                initial={{ opacity: 0, scale: 0.95 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                exit={{ opacity: 0, scale: 0.95 }}\r\n                className=\"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden\"\r\n            >\r\n                {/* Header */}\r\n                <div className=\"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0\">\r\n                    <h3 className=\"font-bold text-lg dark:text-white\">Media Gallery</h3>\r\n                    <button \r\n                        onClick={onClose}\r\n                        className=\"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition\"\r\n                    >\r\n                        <X size={20} />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Filters */}\r\n                <div className=\"p-3 border-b dark:border-gray-700 flex gap-2 overflow-x-auto scrollbar-hide shrink-0\">\r\n                    {[\r\n                        { key: 'all', label: 'All', icon: null },\r\n                        { key: 'images', label: 'Images', icon: ImageIcon },\r\n                        { key: 'videos', label: 'Videos', icon: Video },\r\n                        { key: 'audio', label: 'Audio', icon: Music },\r\n                        { key: 'files', label: 'Files', icon: FileText }\r\n                    ].map(f => (\r\n                        <button\r\n                            key={f.key}\r\n                            onClick={() => setFilter(f.key)}\r\n                            className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition ${\r\n                                filter === f.key\r\n                                    ? 'bg-brand-blue text-white'\r\n                                    : 'bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200'\r\n                            }`}\r\n                        >\r\n                            {f.icon && <f.icon size={16} />}\r\n                            {f.label}\r\n                            <span className=\"text-xs opacity-70\">\r\n                                ({filteredMedia.filter(m => f.key === 'all' || m.type === f.key).length})\r\n                            </span>\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Media Grid */}\r\n                <div className=\"flex-1 overflow-y-auto custom-scrollbar p-4\">\r\n                    {loading ? (\r\n                        <div className=\"flex flex-col items-center justify-center h-full\">\r\n                            <div className=\"w-8 h-8 border-2 border-brand-blue border-t-transparent rounded-full animate-spin mb-2\" />\r\n                            <p className=\"text-sm text-gray-500\">Loading media...</p>\r\n                        </div>\r\n                    ) : filteredMedia.length === 0 ? (\r\n                        <div className=\"flex flex-col items-center justify-center h-full text-gray-400\">\r\n                            <ImageIcon size={48} className=\"mb-4 opacity-30\" />\r\n                            <p className=\"text-sm\">No media found</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3\">\r\n                            {filteredMedia.map((item) => (\r\n                                <motion.div\r\n                                    key={item.id}\r\n                                    initial={{ opacity: 0, scale: 0.9 }}\r\n                                    animate={{ opacity: 1, scale: 1 }}\r\n                                    whileHover={{ scale: 1.05 }}\r\n                                    whileTap={{ scale: 0.95 }}\r\n                                    onClick={() => handleMediaClick(item)}\r\n                                    className=\"relative aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 cursor-pointer group\"\r\n                                >\r\n                                    {item.type === 'image' ? (\r\n                                        <img \r\n                                            src={item.url} \r\n                                            alt=\"Media\" \r\n                                            className=\"w-full h-full object-cover\"\r\n                                        />\r\n                                    ) : item.type === 'video' ? (\r\n                                        <video \r\n                                            src={item.url} \r\n                                            className=\"w-full h-full object-cover\"\r\n                                        />\r\n                                    ) : item.type === 'audio' ? (\r\n                                        <div className=\"w-full h-full flex items-center justify-center bg-purple-100 dark:bg-purple-900/30\">\r\n                                            <Music size={32} className=\"text-purple-600 dark:text-purple-400\" />\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"w-full h-full flex items-center justify-center bg-blue-100 dark:bg-blue-900/30\">\r\n                                            <FileText size={32} className=\"text-blue-600 dark:text-blue-400\" />\r\n                                        </div>\r\n                                    )}\r\n                                    <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition flex items-center justify-center\">\r\n                                        <Download \r\n                                            size={20} \r\n                                            className=\"text-white opacity-0 group-hover:opacity-100 transition\"\r\n                                        />\r\n                                    </div>\r\n                                </motion.div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </motion.div>\r\n\r\n            {/* Media Viewer Modal */}\r\n            <AnimatePresence>\r\n                {selectedMedia && (\r\n                    <MediaViewer\r\n                        media={selectedMedia}\r\n                        onClose={() => setSelectedMedia(null)}\r\n                        onDownload={handleDownload}\r\n                    />\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n}\r\n\r\n/**\r\n * Full-screen media viewer\r\n */\r\nfunction MediaViewer({ media, onClose, onDownload }) {\r\n    const [allMedia, setAllMedia] = useState([]);\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n\r\n    useEffect(() => {\r\n        // Get all media items from gallery context (simplified - in real app, pass from parent)\r\n        // For now, just show the selected media\r\n        setAllMedia([media]);\r\n        setCurrentIndex(0);\r\n    }, [media]);\r\n\r\n    const nextMedia = () => {\r\n        if (currentIndex < allMedia.length - 1) {\r\n            setCurrentIndex(currentIndex + 1);\r\n        }\r\n    };\r\n\r\n    const prevMedia = () => {\r\n        if (currentIndex > 0) {\r\n            setCurrentIndex(currentIndex - 1);\r\n        }\r\n    };\r\n\r\n    const current = allMedia[currentIndex] || media;\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"fixed inset-0 bg-black/95 z-[90] flex items-center justify-center\"\r\n            onClick={onClose}\r\n        >\r\n            <div className=\"relative max-w-7xl max-h-[90vh] w-full h-full flex items-center justify-center p-4\" onClick={e => e.stopPropagation()}>\r\n                <button\r\n                    onClick={onClose}\r\n                    className=\"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 transition z-10\"\r\n                >\r\n                    <X size={24} />\r\n                </button>\r\n\r\n                {current.type === 'image' && (\r\n                    <img \r\n                        src={current.url} \r\n                        alt=\"Media\" \r\n                        className=\"max-w-full max-h-full object-contain rounded-lg\"\r\n                    />\r\n                )}\r\n\r\n                {current.type === 'video' && (\r\n                    <video \r\n                        src={current.url} \r\n                        controls \r\n                        className=\"max-w-full max-h-full rounded-lg\"\r\n                        autoPlay\r\n                    />\r\n                )}\r\n\r\n                {current.type === 'audio' && (\r\n                    <div className=\"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md\">\r\n                        <div className=\"w-32 h-32 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center mx-auto mb-6\">\r\n                            <Music size={48} className=\"text-purple-600 dark:text-purple-400\" />\r\n                        </div>\r\n                        <audio src={current.url} controls className=\"w-full\" autoPlay />\r\n                        <p className=\"text-center mt-4 text-sm text-gray-500\">{current.name}</p>\r\n                    </div>\r\n                )}\r\n\r\n                {current.type === 'file' && (\r\n                    <div className=\"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md text-center\">\r\n                        <FileText size={64} className=\"text-blue-600 dark:text-blue-400 mx-auto mb-4\" />\r\n                        <h4 className=\"text-lg font-bold dark:text-white mb-2\">{current.name}</h4>\r\n                        <a \r\n                            href={current.url} \r\n                            target=\"_blank\" \r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"inline-block mt-4 px-6 py-2 bg-brand-blue text-white rounded-lg hover:bg-blue-600 transition\"\r\n                        >\r\n                            Open File\r\n                        </a>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Navigation arrows */}\r\n                {allMedia.length > 1 && (\r\n                    <>\r\n                        <button\r\n                            onClick={prevMedia}\r\n                            disabled={currentIndex === 0}\r\n                            className=\"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition\"\r\n                        >\r\n                            <ChevronLeft size={24} />\r\n                        </button>\r\n                        <button\r\n                            onClick={nextMedia}\r\n                            disabled={currentIndex === allMedia.length - 1}\r\n                            className=\"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition\"\r\n                        >\r\n                            <ChevronRight size={24} />\r\n                        </button>\r\n                    </>\r\n                )}\r\n\r\n                {/* Download button */}\r\n                <button\r\n                    onClick={() => onDownload(current)}\r\n                    className=\"absolute bottom-4 left-1/2 -translate-x-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 transition\"\r\n                >\r\n                    <Download size={20} />\r\n                </button>\r\n            </div>\r\n        </motion.div>\r\n    );\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { X, User, Bell, Flag, Lock, Users, Briefcase, FileText, Clock, Video, Image as ImageIcon, Loader2, Images } from 'lucide-react';\r\nimport StatCard from '../shared/StatCard';\r\nimport MediaGallery from './media/MediaGallery';\r\nexport default function ChatDetailsPane({ activeChat, onClose, currentUser }) {\r\n    const [media, setMedia] = useState([]);\r\n    const [stats, setStats] = useState({ sessions: 0, rating: 0, responseTime: 'N/A' });\r\n    const [loading, setLoading] = useState(true);\r\n    const [blocking, setBlocking] = useState(false);\r\n    const [showMediaGallery, setShowMediaGallery] = useState(false);\r\n\r\n    const isGroup = activeChat.type === 'group';\r\n    const targetUid = activeChat.uid;\r\n    // FIX: Normalize name (activeChat might use 'n' or 'name')\r\n    const chatName = activeChat.name || activeChat.n || 'Unknown';\r\n\r\n    useEffect(() => {\r\n        const loadData = async () => {\r\n            setLoading(true);\r\n            try {\r\n                // 1. FETCH SHARED MEDIA from RTDB? \r\n                // Note: The previous version looked in Firestore 'chats/{id}/messages'. \r\n                // Since we moved to RTDB for messages, we should conceptually query RTDB here or ignore for now.\r\n                // For simplicity, we will skip fetching media from RTDB in this iteration to avoid complex queries,\r\n                // or we can just leave the list empty until a dedicated media index is built.\r\n                setMedia([]); \r\n\r\n                // 2. FETCH USER STATS (Only for Direct Chats)\r\n                if (!isGroup && targetUid && supabase) {\r\n                    const currentUserId = currentUser?.id || currentUser?.uid;\r\n                    \r\n                    // Fetch profile\r\n                    const { data: profileData } = await supabase\r\n                        .from('profiles')\r\n                        .select('rating, response_time')\r\n                        .eq('id', targetUid)\r\n                        .single();\r\n\r\n                    // Count completed bookings\r\n                    const { count } = await supabase\r\n                        .from('bookings')\r\n                        .select('*', { count: 'exact', head: true })\r\n                        .eq('sender_id', currentUserId)\r\n                        .eq('target_id', targetUid)\r\n                        .eq('status', 'Completed');\r\n\r\n                    setStats({\r\n                        sessions: count || 0,\r\n                        rating: profileData?.rating || 'New',\r\n                        responseTime: profileData?.response_time || '~1hr' \r\n                    });\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Failed to load details:\", e);\r\n            }\r\n            setLoading(false);\r\n        };\r\n\r\n        if (activeChat?.id) {\r\n            loadData();\r\n        }\r\n    }, [activeChat.id, targetUid, isGroup, currentUser?.id || currentUser?.uid]);\r\n\r\n    const handleBlockUser = async () => {\r\n        if (isGroup || !targetUid || !currentUser || !supabase) return;\r\n        if (!confirm(`Are you sure you want to block ${chatName}?`)) return;\r\n\r\n        setBlocking(true);\r\n        try {\r\n            const userId = currentUser?.id || currentUser?.uid;\r\n            \r\n            // Get current settings\r\n            const { data: profile } = await supabase\r\n                .from('profiles')\r\n                .select('settings')\r\n                .eq('id', userId)\r\n                .single();\r\n            \r\n            const currentSettings = profile?.settings || {};\r\n            const blockedUsers = currentSettings.social?.blockedUsers || [];\r\n            \r\n            if (!blockedUsers.includes(targetUid)) {\r\n                await supabase\r\n                    .from('profiles')\r\n                    .update({\r\n                        settings: {\r\n                            ...currentSettings,\r\n                            social: {\r\n                                ...currentSettings.social,\r\n                                blockedUsers: [...blockedUsers, targetUid]\r\n                            }\r\n                        }\r\n                    })\r\n                    .eq('id', userId);\r\n            }\r\n            \r\n            alert(\"User blocked.\");\r\n            onClose(); \r\n        } catch (e) {\r\n            console.error(\"Block failed:\", e);\r\n            alert(\"Failed to block user.\");\r\n        }\r\n        setBlocking(false);\r\n    };\r\n\r\n    const handleReportUser = () => {\r\n        alert(\"Please use the report option on their profile page for full moderation tools.\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"absolute right-0 top-0 h-full w-full md:w-80 bg-gray-800 shadow-xl z-20 flex flex-col transition-transform duration-300 ease-in-out border-l border-gray-700\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-900\">\r\n                <h3 className=\"text-lg font-semibold text-white\">Details</h3>\r\n                <button \r\n                    onClick={onClose} \r\n                    className=\"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-full transition duration-150\"\r\n                    aria-label=\"Close details\"\r\n                >\r\n                    <X className=\"w-5 h-5\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Profile Section */}\r\n            <div className=\"p-6 flex flex-col items-center border-b border-gray-700 bg-gray-800\">\r\n                <div className=\"relative w-24 h-24 rounded-full overflow-hidden mb-4 bg-gray-700 flex items-center justify-center shadow-lg border-4 border-gray-600\">\r\n                    <img \r\n                        src={activeChat.photo} \r\n                        className=\"w-full h-full object-cover\" \r\n                        onError={(e) => e.target.src = ''}\r\n                        alt={chatName}\r\n                    />\r\n                    {!activeChat.photo && (isGroup ? <Users className=\"w-10 h-10 text-gray-500\"/> : <User className=\"w-10 h-10 text-gray-500\" />)}\r\n                </div>\r\n                <h4 className=\"text-xl font-bold text-white text-center leading-tight\">{chatName}</h4>\r\n                <p className=\"text-xs text-gray-400 mt-2 flex items-center px-3 py-1 bg-gray-700 rounded-full\">\r\n                    {isGroup ? <Users className=\"w-3 h-3 mr-1\"/> : <Briefcase className=\"w-3 h-3 mr-1\" />}\r\n                    {isGroup ? 'Group Chat' : (activeChat.role || 'Creative')}\r\n                </p>\r\n            </div>\r\n\r\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\r\n                {/* Stats (Hidden for Groups) */}\r\n                {!isGroup && (\r\n                    <div className=\"p-4 border-b border-gray-700\">\r\n                        <h5 className=\"text-xs font-bold text-gray-500 uppercase mb-3 tracking-wider\">Performance</h5>\r\n                        {loading ? (\r\n                            <div className=\"flex justify-center py-4\"><Loader2 className=\"animate-spin text-brand-blue\"/></div>\r\n                        ) : (\r\n                            <div className=\"grid grid-cols-3 gap-2\">\r\n                                <StatCard title=\"Sessions\" value={stats.sessions} icon={Briefcase} color=\"text-blue-400\" />\r\n                                <StatCard title=\"Rating\" value={stats.rating} icon={Flag} color=\"text-yellow-400\" />\r\n                                <StatCard title=\"Reply Time\" value={stats.responseTime} icon={Clock} color=\"text-green-400\" />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Shared Media Section */}\r\n                <div className=\"p-4 border-b border-gray-700\">\r\n                    <div className=\"flex items-center justify-between mb-3\">\r\n                        <h5 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider\">Shared Media</h5>\r\n                        <button\r\n                            onClick={() => setShowMediaGallery(true)}\r\n                            className=\"text-xs text-brand-blue hover:underline font-medium\"\r\n                        >\r\n                            View All\r\n                        </button>\r\n                    </div>\r\n                    {media.length > 0 ? (\r\n                        <div className=\"grid grid-cols-3 gap-2\">\r\n                            {media.slice(0, 6).map((item, i) => (\r\n                                <div\r\n                                    key={i}\r\n                                    className=\"aspect-square rounded-lg overflow-hidden bg-gray-700 cursor-pointer hover:opacity-80 transition\"\r\n                                >\r\n                                    {item.type === 'image' && (\r\n                                        <img src={item.url} className=\"w-full h-full object-cover\" alt=\"Media\" />\r\n                                    )}\r\n                                    {item.type === 'video' && (\r\n                                        <div className=\"w-full h-full flex items-center justify-center\">\r\n                                            <Video size={20} className=\"text-gray-400\" />\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    ) : (\r\n                        <p className=\"text-xs text-gray-500 text-center py-4\">No shared media yet</p>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"p-4 space-y-2\">\r\n                    <button className=\"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition\">\r\n                        <Bell className=\"w-4 h-4 text-yellow-500\" />\r\n                        <span>Mute Notifications</span>\r\n                    </button>\r\n\r\n                    <button\r\n                        onClick={() => setShowMediaGallery(true)}\r\n                        className=\"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition\"\r\n                    >\r\n                        <Images className=\"w-4 h-4 text-purple-500\" />\r\n                        <span>Media Gallery</span>\r\n                    </button>\r\n                    \r\n                    {!isGroup && (\r\n                        <>\r\n                            <button \r\n                                onClick={handleBlockUser}\r\n                                disabled={blocking}\r\n                                className=\"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition disabled:opacity-50\"\r\n                            >\r\n                                {blocking ? <Loader2 className=\"w-4 h-4 animate-spin\"/> : <Lock className=\"w-4 h-4\" />}\r\n                                <span>Block User</span>\r\n                            </button>\r\n                            \r\n                            <button \r\n                                onClick={handleReportUser}\r\n                                className=\"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition\"\r\n                            >\r\n                                <Flag className=\"w-4 h-4\" />\r\n                                <span>Report User</span>\r\n                            </button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Media Gallery Modal */}\r\n            {showMediaGallery && (\r\n                <MediaGallery\r\n                    chatId={activeChat.id}\r\n                    onClose={() => setShowMediaGallery(false)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":["translations","getTranslation","key","language","getTranslations","LanguageContext","createContext","LanguageProvider","children","userData","setLanguage","useState","stored","_a","useEffect","t","jsx","useLanguage","context","useContext","convexUrl","clientUrl","convex","ConvexReactClient","isConvexAvailable","blobToken","STORAGE_FOLDERS","uploadFile","file","folder","options","timestamp","randomString","extension","filename","blob","put","error","isImageFile","validateFileSize","maxSizeMB","maxSizeBytes","getInitials","name","parts","_b","getAvatarColor","colors","hash","acc","char","UserAvatar","src","size","className","onClick","status","isGroup","square","imgError","setImgError","containerClass","twMerge","clsx","showFallback","initials","avatarColor","jsxs","Users","User","api","anyApi","componentsGeneric","usePresence","userId","isOnlineRef","useRef","updatePresenceMutation","useMutation","interval","useUserPresence","convexAvailable","presenceQuery","useMemo","presenceData","useQuery","formatLastSeen","lastSeenMs","diffMs","diffMins","diffHours","diffDays","PresenceIndicator","online","lastSeen","showText","sizeClasses","textSizes","Circle","ConversationItem","conversation","activeChat","currentUserId","onSelect","onDelete","otherUserId","id","e","Trash2","ProfileSelectionModal","show","onConfirm","onCancel","subProfiles","title","message","excludeRoles","step","setStep","selectedRole","setSelectedRole","activeRole","activeProfile","availableRoles","role","getDisplayRole","talentSub","subRole","getDisplayName","profile","handleUseActive","resetModal","handleSelectDifferent","handleRoleSelect","handleConfirmSelection","handleClose","UserIcon","X","Check","isSelected","ChatSidebar","user","conversations","onSelectChat","showSearch","setShowSearch","showGroupModal","setShowGroupModal","showProfileModal","setShowProfileModal","pendingChatTarget","setPendingChatTarget","selectedChatProfile","setSelectedChatProfile","searchMode","setSearchMode","isCreating","setIsCreating","groupName","setGroupName","groupMembers","setGroupMembers","searchQuery","setSearchQuery","searchResults","setSearchResults","createGroupChatMutation","deleteConversationMutation","handleUserSearch","term","searchTerm","profiles","results","handleSelectSearchResult","result","m","prev","closeSearch","handleProfileConfirmed","chatId","openGroupModal","handleAddMemberClick","handleCreateGroup","memberIds","newGroupId","handleDeleteChat","err","Plus","c","ArrowLeft","p","Loader2","Fragment","ChevronRight","Search","res","useMediaUpload","uploading","setUploading","setError","storageFolder","mediaType","EMOJI_CATEGORIES","ALL_EMOJIS","EmojiPicker","onClose","position","activeCategory","setActiveCategory","recentEmojis","setRecentEmojis","filteredEmojis","emoji","handleEmojiSelect","updatedRecent","categories","motion","category","Clock","index","GIPHY_API_KEY","GIPHY_BASE_URL","GifPicker","gifs","setGifs","trendingGifs","setTrendingGifs","loading","setLoading","activeTab","setActiveTab","searchTimeoutRef","loadTrending","searchGifs","data","query","handleGifSelect","gif","displayGifs","TrendingUp","VideoRecorder","onRecorded","maxDuration","isRecording","setIsRecording","recordedBlob","setRecordedBlob","recordingTime","setRecordingTime","hasPermission","setHasPermission","videoRef","streamRef","mediaRecorderRef","chunksRef","timerRef","requestPermissions","cleanup","stream","track","startRecording","newTime","stopRecording","handleDiscard","handleSend","formatTime","seconds","mins","secs","CameraOff","StopCircle","Video","useTypingIndicator","userName","typingTimeoutRef","isTypingRef","typingQuery","typingData","updateTypingMutation","clearTypingMutation","typingUsers","indicator","setTyping","useCallback","clearTyping","formatTypingUsers","ChatInput","activeChatId","uid","onSend","replyingTo","editingMessage","onCancelReply","onCancelEdit","onTyping","onStopTyping","input","setInput","attachment","setAttachment","recordingDuration","setRecordingDuration","dragActive","setDragActive","showEmojiPicker","setShowEmojiPicker","showGifPicker","setShowGifPicker","showVideoRecorder","setShowVideoRecorder","isPlayingPreview","setIsPlayingPreview","fileInputRef","textareaRef","mediaRecorder","audioChunks","emojiPickerRef","gifPickerRef","recordingIntervalRef","audioPreviewRef","uploadMedia","handleClickOutside","gifData","gifMediaData","handleVideoRecorded","videoFile","videoMediaData","handleTyping","insertEmoji","textarea","start","end","newValue","audioBlob","audioFile","cancelRecording","formatDuration","toggleAudioPreview","handleDrag","handleDrop","handleFileSelect","type","handleSubmit","mediaData","handleCancel","getContextPreview","AnimatePresence","_","i","Square","Pencil","CornerUpLeft","Pause","Play","Mic","FileText","Paperclip","ImagePlus","Smile","CheckCircle","Send","cn","inputs","Button","React","variant","props","ref","variants","sizes","SeshNxEmbedModal","url","isOpen","previewData","contentPath","contentType","ExternalLink","MessageStatus","statusConfig","CheckCheck","config","Icon","AudioWaveform","audioUrl","color","height","canvasRef","audioRef","animationRef","audioContextRef","analyserRef","isPlaying","setIsPlaying","canvas","ctx","audio","audioContext","analyser","source","bufferLength","dataArray","draw","drawStaticWaveform","barWidth","x","barHeight","gradient","width","barCount","gap","togglePlay","CHAT_REACTIONS","MessageBubble","isCurrentUser","previousMessage","linkPreviewData","messageStatus","onReaction","onReply","onEdit","onForward","onSeshNxLinkClick","onUserClick","showMenu","setShowMenu","showReactionPicker","setShowReactionPicker","copied","setCopied","menuRef","bubbleRef","isFirstInGroup","isSameDay","currentMs","prevMs","isFarApart","shouldShowDate","shouldShowTime","shouldShowAvatar","msgDate","handleCopy","handleReaction","reactionCounts","users","count","hasReactions","myReaction","bubbleClass","renderLinkPreview","isSeshNxLink","LinkIcon","Globe","Download","Copy","Forward","ForwardMessageModal","selectedChats","setSelectedChats","forwarding","setForwarding","filteredConversations","toggleSelect","handleForward","getMessagePreview","convo","useReadReceipts","readReceiptsQuery","readReceiptsData","markAsReadMutation","markMultipleAsReadMutation","readReceipts","receipts","receipt","myLastRead","markAsRead","messageIds","messageIdArray","isMessageRead","messageId","messages","userReceipt","lastReadMessageId","lastReadMessage","getLastReadMessage","hasCurrentUserRead","previewCache","CACHE_DURATION","getLinkPreview","urlMatch","matchedUrl","cached","getClientSideLinkPreview","response","urlObj","hostname","videoId","pathParts","subdomain","ChatWindow","onBack","toggleDetails","openPublicProfile","setLinkPreviewData","embedModal","setEmbedModal","setReplyingTo","setEditingMessage","forwardingMessage","setForwardingMessage","messagesEndRef","chatName","presenceLoading","messagesQuery","chatMembersQuery","chatMembersData","groupMemberIds","messagesData","msg","sendMessageMutation","editMessageMutation","deleteMessageMutation","addReactionMutation","removeReactionMutation","updateConversationMutation","updateUnreadCountMutation","lastMarkedCountRef","currentMessageIds","currentCount","targetChatIds","forwardText","forwardMedia","targetChatId","targetConvo","summary","sendMessage","text","msgText","recipientIds","otherUid","recipientUid","handleDelete","forEveryone","ChatHeader","Info","isRead","hasRead","StatCard","value","icon","sub","bg","MediaGallery","onMediaSelect","media","setMedia","selectedMedia","setSelectedMedia","filter","setFilter","mediaQuery","mediaMessages","mediaItems","a","b","filteredMedia","item","handleMediaClick","handleDownload","link","ImageIcon","Music","f","MediaViewer","onDownload","allMedia","setAllMedia","currentIndex","setCurrentIndex","nextMedia","prevMedia","current","ChevronLeft","ChatDetailsPane","currentUser","stats","setStats","blocking","setBlocking","showMediaGallery","setShowMediaGallery","targetUid","loadData","profileData","handleBlockUser","currentSettings","blockedUsers","handleReportUser","Briefcase","Flag","Bell","Images","Lock"],"mappings":"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"}