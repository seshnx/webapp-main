{"version":3,"file":"Sidebar-Bp09v1Y4.js","sources":["../../src/components/Sidebar.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { User, MessageSquare, Calendar, MessageCircle, Settings, Sliders, LogOut, ShoppingBag, CreditCard, X, ShieldCheck, Wrench, Briefcase, GraduationCap, Home, Briefcase as BriefcaseIcon, Zap } from 'lucide-react';\r\nimport { supabase } from '../config/supabase';\r\nimport { useSchool } from '../contexts/SchoolContext';\r\n\r\nexport default function Sidebar({ userData, activeTab, setActiveTab, sidebarOpen, setSidebarOpen, handleLogout }) {\r\n  // Always call hook (React rules), but handle case where context might not be ready\r\n  const schoolContext = useSchool();\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  \r\n  // Safely extract values with fallbacks\r\n  const isStudent = schoolContext?.isStudent ?? (userData?.accountTypes?.includes('Student') || false);\r\n  const isStaff = schoolContext?.isStaff ?? (userData?.accountTypes?.includes('EDUStaff') || userData?.accountTypes?.includes('EDUAdmin') || false);\r\n\r\n  // Track mobile viewport\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      setIsMobile(window.innerWidth < 1024);\r\n    };\r\n    \r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    return () => window.removeEventListener('resize', checkMobile);\r\n  }, []);\r\n\r\n  // --- EDU Panel Logic ---\r\n  // Now checks for Students OR Staff (EDUStaff/EDUAdmins)\r\n  const isIntern = userData?.accountTypes?.includes('Intern');\r\n  \r\n  // Determine EDU route and label\r\n  let eduRoute = null;\r\n  let eduLabel = 'EDU Panel';\r\n  if (isStudent || isIntern || isStaff || userData?.accountTypes?.includes('student')) {\r\n    if (isIntern) {\r\n      eduRoute = 'edu-intern';\r\n      eduLabel = 'Internship';\r\n    } else if (isStudent) {\r\n      eduRoute = 'edu-student';\r\n      eduLabel = 'Student';\r\n    } else {\r\n      eduRoute = 'edu-overview';\r\n      eduLabel = 'School Admin';\r\n    }\r\n  }\r\n\r\n  // Check if user has business features (Studio, Label, Agent, Talent, Producer, etc.)\r\n  const hasBusinessFeatures = userData?.accountTypes?.some(t => \r\n    ['Studio', 'Label', 'Agent', 'Talent', 'Producer', 'Engineer'].includes(t)\r\n  );\r\n\r\n  // Organized navigation groups\r\n  const navGroups = [\r\n    {\r\n      label: 'Primary',\r\n      icon: Home,\r\n      items: [\r\n        { id: 'dashboard', icon: Home, label: 'Dashboard' },\r\n        { id: 'feed', icon: MessageSquare, label: 'SocialNx' },\r\n        { id: 'messages', icon: MessageCircle, label: 'Messages' },\r\n      ]\r\n    },\r\n    {\r\n      label: 'Work',\r\n      icon: BriefcaseIcon,\r\n      items: [\r\n        { id: 'bookings', icon: Calendar, label: 'Bookings' },\r\n        { id: 'marketplace', icon: ShoppingBag, label: 'Marketplace' },\r\n        { id: 'tech', icon: Wrench, label: 'Tech Services' },\r\n      ]\r\n    },\r\n    {\r\n      label: 'Business',\r\n      icon: Briefcase,\r\n      items: [\r\n        ...(hasBusinessFeatures ? [{ id: 'business-center', icon: Briefcase, label: 'Business Center' }] : []),\r\n        { id: 'profile', icon: Settings, label: 'Profile' },\r\n        { id: 'payments', icon: CreditCard, label: 'Billing' },\r\n      ]\r\n    },\r\n    ...(eduRoute ? [{\r\n      label: 'Education',\r\n      icon: GraduationCap,\r\n      items: [\r\n        { id: eduRoute, icon: GraduationCap, label: eduLabel, highlight: true }\r\n      ]\r\n    }] : [])\r\n  ];\r\n\r\n  const onLogout = handleLogout || (async () => {\r\n    try {\r\n      if (supabase) {\r\n        const { error } = await supabase.auth.signOut();\r\n        if (error) console.error(\"Logout error:\", error);\r\n      }\r\n      // Navigate to home after logout\r\n      window.location.href = '/';\r\n    } catch (err) {\r\n      console.error(\"Logout failed:\", err);\r\n      window.location.href = '/';\r\n    }\r\n  });\r\n\r\n  const handleNavigation = (id) => {\r\n    setActiveTab(id);\r\n    // Always close sidebar after navigation (especially on mobile)\r\n    // Check if we're on mobile screen size\r\n    const isMobile = window.innerWidth < 1024;\r\n    if (setSidebarOpen && (isMobile || sidebarOpen)) {\r\n      setSidebarOpen(false);\r\n    }\r\n  };\r\n\r\n  const SidebarContent = ({ isMobile }) => (\r\n    <>\r\n      <div className=\"flex-1 py-4 overflow-y-auto scrollbar-hide\">\r\n        {isMobile && (\r\n            <div className=\"px-4 mb-6 flex items-center justify-between\">\r\n                <div className=\"text-xs font-bold text-gray-400 uppercase\">Menu</div>\r\n                <button \r\n                    onClick={() => setSidebarOpen(false)} \r\n                    className=\"p-2 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors\"\r\n                    aria-label=\"Close menu\"\r\n                >\r\n                    <X size={20} aria-hidden=\"true\" />\r\n                </button>\r\n            </div>\r\n        )}\r\n        \r\n        <nav className=\"space-y-6 px-2\">\r\n            {navGroups.map((group, groupIndex) => {\r\n              const GroupIcon = group.icon;\r\n              return (\r\n                <div key={group.label} className=\"space-y-1\">\r\n                  {/* Group Header */}\r\n                  <div className=\"flex items-center gap-2 px-3 py-1.5 mb-1\">\r\n                    <GroupIcon size={14} className=\"text-gray-400 dark:text-gray-500\" />\r\n                    <span className=\"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider\">\r\n                      {group.label}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  {/* Group Items */}\r\n                  <div className=\"space-y-1\">\r\n                    {group.items.map(link => {\r\n                      const ItemIcon = link.icon;\r\n                      return (\r\n                        <button\r\n                          key={link.id}\r\n                          onClick={() => handleNavigation(link.id)}\r\n                          className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition\r\n                          ${activeTab === link.id \r\n                              ? 'bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400' \r\n                              : 'text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800'}\r\n                          ${link.highlight ? 'text-amber-600 dark:text-amber-500' : ''}\r\n                          `}\r\n                        >\r\n                          <ItemIcon size={18} className={link.highlight ? 'text-amber-600 dark:text-amber-500' : ''} />\r\n                          {link.label}\r\n                        </button>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n        </nav>\r\n\r\n        <div className=\"mt-auto px-2 pt-4 space-y-1 border-t border-gray-200 dark:border-gray-700\">\r\n            <div className=\"flex items-center gap-2 px-3 py-1.5 mb-1\">\r\n              <ShieldCheck size={14} className=\"text-gray-400 dark:text-gray-500\" />\r\n              <span className=\"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider\">\r\n                Resources\r\n              </span>\r\n            </div>\r\n            <button onClick={() => handleNavigation('legal')} className={`flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium w-full transition ${activeTab === 'legal' ? 'bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800'}`}>\r\n                <ShieldCheck size={18} />\r\n                Legal Center\r\n            </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"p-4 border-t border-gray-200 dark:border-gray-700 shrink-0 bg-white dark:bg-[#1f2128]\">\r\n        <button onClick={onLogout} className=\"flex items-center gap-2 text-red-500 text-sm font-medium hover:opacity-80 px-2 w-full py-2 rounded hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors\">\r\n          <LogOut size={16} /> Sign Out\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {/* Desktop Sidebar */}\r\n      <aside className=\"hidden lg:flex w-64 bg-white dark:bg-[#1f2128] border-r border-gray-200 dark:border-gray-700 flex-col h-full shrink-0 relative z-30\">\r\n         <SidebarContent isMobile={false} />\r\n      </aside>\r\n\r\n      {/* Mobile Backdrop */}\r\n      {sidebarOpen && isMobile && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] transition-all duration-300 ease-out opacity-100 pointer-events-auto\" \r\n          onClick={() => setSidebarOpen(false)}\r\n          aria-hidden=\"true\"\r\n        />\r\n      )}\r\n\r\n      {/* Mobile Sidebar */}\r\n      <aside \r\n        className={`fixed inset-y-0 left-0 z-[10000] w-72 bg-white dark:bg-[#1f2128] shadow-2xl transform transition-all duration-300 ease-out flex flex-col h-full lg:hidden ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'}`}\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        aria-label=\"Navigation menu\"\r\n      >\r\n         <SidebarContent isMobile={true} />\r\n      </aside>\r\n    </>\r\n  );\r\n}\r\n"],"names":["Sidebar","userData","activeTab","setActiveTab","sidebarOpen","setSidebarOpen","handleLogout","schoolContext","useSchool","isMobile","setIsMobile","useState","isStudent","_a","isStaff","_b","_c","useEffect","checkMobile","isIntern","_d","eduRoute","eduLabel","_e","hasBusinessFeatures","_f","t","navGroups","Home","MessageSquare","MessageCircle","BriefcaseIcon","Calendar","ShoppingBag","Wrench","Briefcase","Settings","CreditCard","GraduationCap","onLogout","err","handleNavigation","id","SidebarContent","jsxs","Fragment","jsx","X","group","groupIndex","GroupIcon","link","ItemIcon","ShieldCheck","LogOut"],"mappings":"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"}