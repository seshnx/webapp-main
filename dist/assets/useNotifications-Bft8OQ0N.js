import{r as o}from"./vendor-Dl7DtIXW.js";import{x as g,y as h,z as N,A as m,B as k,C as A}from"./index-ScyYHoNo.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"local"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ab125097-d4be-4aba-8680-97a0c019d441",e._sentryDebugIdIdentifier="sentry-dbid-ab125097-d4be-4aba-8680-97a0c019d441")})()}catch{}function R(e,t=50){const[c,s]=o.useState([]),[r,f]=o.useState(0),[d,n]=o.useState(!0);o.useEffect(()=>{if(!e){n(!1);return}const a=async()=>{try{const p=(await k(e,{limit:t,deleted:!1})).map(i=>({id:i.id,...i,timestamp:i.created_at,read:i.read||!1}));s(p),f(p.filter(i=>!i.read).length),n(!1)}catch(b){console.error("Notifications fetch error:",b),n(!1)}};a();const l=setInterval(()=>{a()},3e4);return()=>{clearInterval(l)}},[e,t]);const u=o.useCallback(async a=>{if(e)try{await g(a)}catch(l){console.error("Mark as read error:",l)}},[e]),y=o.useCallback(async()=>{if(!(!e||r===0))try{await h(e)}catch(a){console.error("Mark all as read error:",a)}},[e,r]),_=o.useCallback(async a=>{if(e)try{await N(a)}catch(l){console.error("Delete notification error:",l)}},[e]),w=o.useCallback(async()=>{if(e)try{await m(e)}catch(a){console.error("Clear all error:",a)}},[e]);return{notifications:c.filter(a=>!a.deleted),unreadCount:r,loading:d,markAsRead:u,markAllAsRead:y,deleteNotification:_,clearAll:w}}async function v({targetUserId:e,type:t,fromUserId:c,fromUserName:s,fromUserPhoto:r,postId:f=null,postPreview:d=null,commentId:n=null,message:u}){if(!(!e||e===c))try{await A({user_id:e,type:t,from_user_id:c,from_user_name:s,from_user_photo:r||null,post_id:f,post_preview:d,comment_id:n,message:u,metadata:{postId:f,postPreview:d,commentId:n,fromUserName:s,fromUserPhoto:r}})}catch(y){console.error("Create notification error:",y)}}export{v as c,R as u};
