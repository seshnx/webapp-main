import{r as s,j as t}from"./vendor-C40xFgTg.js";import{h as w,i as b,f as g,C as y,j as u,k as C}from"./chat-CcyNTB2o.js";import{a as j}from"./vendor-convex-CkYEP-FB.js";import{m,A as k}from"./vendor-framer-0jBYu9jQ.js";import"./vendor-firebase-CMJMOSQ_.js";function M({user:a,userData:o,openPublicProfile:x}){const[i,r]=s.useState(null),[d,n]=s.useState(!1);w(a==null?void 0:a.uid);const c=s.useMemo(()=>b(),[]),f=s.useMemo(()=>a!=null&&a.uid&&c?{userId:a.uid}:"skip",[a==null?void 0:a.uid,c]),l=j(g.conversations.getConversations,f),h=s.useMemo(()=>l?l.map(e=>({id:e.chatId,uid:e.otherUserId||e.chatId,name:e.chatName||"Unknown",n:e.chatName||"Unknown",photo:e.chatPhoto||"",type:e.chatType||"direct",lm:e.lastMessage||"",lmt:e.lastMessageTime||0,ls:e.lastSenderId||"",uc:e.unreadCount||0})).sort((e,p)=>(p.lmt||0)-(e.lmt||0)):[],[l]);return s.useEffect(()=>{},[]),t.jsxs("div",{className:"flex h-[calc(100vh-100px)] bg-white dark:bg-[#1f2128] rounded-2xl overflow-hidden border dark:border-gray-800 shadow-xl",children:[t.jsx(m.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:`w-full md:w-80 border-r dark:border-gray-800 flex flex-col ${i?"hidden md:flex":"flex"}`,children:t.jsx(y,{user:a,userData:o,conversations:h,activeChat:i,onSelectChat:r})}),t.jsxs("div",{className:`flex-1 flex flex-col relative ${i?"flex":"hidden md:flex"}`,children:[t.jsx(u,{activeChat:i,user:a,userData:o,conversations:h,onBack:()=>r(null),toggleDetails:()=>n(!d),openPublicProfile:x}),t.jsx(k,{children:d&&i&&t.jsx(m.div,{initial:{width:0,opacity:0},animate:{width:300,opacity:1},exit:{width:0,opacity:0},className:"border-l dark:border-gray-800 bg-gray-50 dark:bg-[#23262f] overflow-hidden relative z-20",children:t.jsx(C,{activeChat:i,currentUser:o,onClose:()=>n(!1)})})})]})]})}export{M as default};
