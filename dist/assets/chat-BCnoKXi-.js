import{t as We,c as Ne,j as e,U as he,a as Ve,r as o,C as Te,T as ve,P as je,A as He,X as V,L as oe,b as Qe,S as pe,d as Ae,e as at,f as lt,V as ye,g as Ke,h as ge,i as Ye,k as Je,F as nt,l as it,I as ot,m as ct,M as dt,n as ut,o as xt,R as mt,E as ft,p as Le,q as ht,s as gt,u as be,D as Fe,v as bt,w as ke,x as pt,G as yt,y as jt,z as Ce,B as Se,H as wt,J as Ge,K as _e,N as Nt,O as vt,Q as kt}from"./vendor-DTDDt3fP.js";import{g as St,i as Rt,a as $t,b as Mt,p as zt,c as At,d as Ft,e as It,f as Et,r as Tt,u as Lt,h as Ct,q as Re,w as ae,j as De,k as Pe,l as Gt,m as re,s as _t,n as Dt,o as xe,t as Pt,v as Ut,x as Ot,y as Bt,z as qt,A as Ue,B as Wt,C as Vt,D as Ht,E as Qt,F as Kt}from"./vendor-firebase-C38qHjbM.js";import{C as Yt,u as ee,a as Ie}from"./vendor-convex-DiXsReyd.js";import{m as D,A as ie}from"./vendor-framer-CzAUfL-F.js";const le={apiKey:"AIzaSyCRRmP9lfWF2hWdquNmo1t-x5Pjz-l6idM",authDomain:"auth.seshnx.net",databaseURL:"https://seshnx-db-default-rtdb.firebaseio.com",projectId:"seshnx-70c04",storageBucket:"seshnx-70c04.firebasestorage.app",messagingSenderId:"98272119648",appId:"1:98272119648:web:ff6d186adf94a03fe0ac05",measurementId:"G-7SP53NK9FM"};le.databaseURL||(le.databaseURL="https://seshnx-db-default-rtdb.firebaseio.com");let $e=null;try{$e=St()}catch{$e=null}const ue=$e||Rt(le),Ss=$t(ue);let Me;try{Me=Mt(ue,{localCache:zt({tabManager:At()})})}catch{Me=Ft(ue)}const de=Me;let ze=null,Xe=null;const Jt=()=>{const t=le.databaseURL;if(!t||t.trim()==="")return null;try{return Et(ue)||null}catch{return null}};Xe=Jt();if(le.storageBucket&&le.storageBucket.trim()!=="")try{ze=It(ue)}catch{ze=null}const Oe=ze,W=Xe,T=le.projectId,Xt=t=>({userProfile:`artifacts/${T}/users/${t}/profiles/main`,userSubProfile:a=>`artifacts/${T}/users/${t}/profiles/${a}`,userPublicProfile:`artifacts/${T}/users/${t}/public_profile/main`,publicProfileCollectionGroup:"public_profile",publicFeed:`artifacts/${T}/public/data/posts`,serviceRequests:`artifacts/${T}/public/data/service_requests`,messages:`artifacts/${T}/public/data/direct_messages`,marketplaceItems:`artifacts/${T}/public/data/market_items`,userLibrary:`artifacts/${T}/users/${t}/library`,marketAssets:`artifacts/${T}/users/${t}/assets/market`,userWallet:`artifacts/${T}/users/${t}/wallet/account`,profileImages:`artifacts/${T}/users/${t}/images/profile`,equipmentSubmissions:`artifacts/${T}/public/data/equipment_submissions`,studentRecord:(a,s)=>`schools/${a}/students/${s}`,distributionReleases:`artifacts/${T}/distribution/${t}/releases`,royaltyReports:`artifacts/${T}/distribution/${t}/royalty_reports`,distributionStats:`artifacts/${T}/distribution/${t}/stats/main`,labelRoster:a=>`artifacts/${T}/labels/${a}/roster`,labelInvites:a=>`artifacts/${T}/labels/${a}/invites`,gearListings:`artifacts/${T}/public/data/gear_listings`,followers:`artifacts/${T}/users/${t}/followers`,following:`artifacts/${T}/users/${t}/following`,socialStats:`artifacts/${T}/users/${t}/stats/social`,notifications:`artifacts/${T}/users/${t}/notifications`,savedPosts:`artifacts/${T}/users/${t}/savedPosts`}),Zt=t=>{if(!t)return"";const a=t.trim().split(" ");return a.length>=2?(a[0][0]+a[1][0]).toUpperCase():t.substring(0,2).toUpperCase()};function ce({src:t,name:a,size:s="md",className:n,onClick:u,status:l,isGroup:g=!1,square:b=!1}){const f=We(Ne("relative overflow-hidden flex items-center justify-center shrink-0 bg-gray-200 dark:bg-gray-700 border border-transparent transition-all select-none",b?"rounded-xl":"rounded-full",{xs:"h-6 w-6 text-[10px]",sm:"h-8 w-8 text-xs",md:"h-10 w-10 text-sm",lg:"h-12 w-12 text-base",xl:"h-14 w-14 text-lg","2xl":"h-24 w-24 text-2xl","3xl":"h-32 w-32 text-4xl"}[s],u&&"cursor-pointer hover:opacity-90",n));return e.jsxs("div",{className:f,onClick:u,children:[t?e.jsx("img",{src:t,alt:a||"Avatar",className:"h-full w-full object-cover",onError:j=>j.target.style.display="none"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gradient-to-br from-brand-blue to-purple-600 text-white font-bold",children:g?e.jsx(he,{className:"w-1/2 h-1/2"}):a?Zt(a):e.jsx(Ve,{className:"w-1/2 h-1/2"})}),l&&e.jsx("span",{className:Ne("absolute bottom-0 right-0 rounded-full border-2 border-white dark:border-gray-900",l==="online"?"bg-green-500":"bg-gray-400",s==="xs"||s==="sm"?"h-2 w-2":"h-3.5 w-3.5")})]})}const Ze="http://127.0.0.1:3210",es=Ze,Rs=new Yt(es),Ee=()=>Ze!=="";function et(){return new Proxy({},{get(t,a){if(a===Symbol.toStringTag)return"ConvexApi";if(!(a==="then"||a==="catch"||a==="finally"))return et()},has(t,a){return!0}})}const ts=et(),H=ts;function we({title:t,value:a,icon:s,sub:n,bg:u="bg-white dark:bg-[#2c2e36]",text:l="text-gray-900 dark:text-white"}){return e.jsxs("div",{className:`${u} p-5 rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm flex flex-col justify-between h-28`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${l==="text-white"?"text-blue-100":"text-gray-500"}`,children:t}),e.jsx("div",{className:`text-2xl font-extrabold ${l}`,children:a})]}),e.jsx("div",{className:"opacity-80",children:s})]}),n&&e.jsx("div",{className:"text-xs mt-auto opacity-75",children:n})]})}const ss=()=>{const[t,a]=o.useState(!1),[s,n]=o.useState(null);return{uploadMedia:async(l,g)=>{if(!l)return null;if(!Oe)return n("Firebase Storage is not configured. Please set VITE_FIREBASE_STORAGE_BUCKET in your environment variables."),console.error("Firebase Storage is not available. storageBucket is missing from Firebase config."),null;a(!0),n(null);try{const y=`${Date.now()}_${l.name.replace(/[^a-zA-Z0-9.]/g,"_")}`,f=`${g}/${y}`,j=Tt(Oe,f),k=await Lt(j,l),i=await Ct(k.ref);return a(!1),{url:i,type:l.type.startsWith("video/")?"video":l.type.startsWith("audio/")?"audio":"image",name:l.name}}catch(b){return console.error("Upload failed:",b),n(b),a(!1),null}},uploading:t,error:s}};function $s(t){const a=o.useRef(!1),s=ee(H.presence.updatePresence);o.useEffect(()=>{if(!t)return;s({userId:t,online:!0,lastSeen:Date.now()}).then(()=>{a.current=!0}).catch(u=>{console.error("Presence online error:",u)});const n=setInterval(()=>{a.current&&s({userId:t,online:!0,lastSeen:Date.now()}).catch(console.error)},3e4);return()=>{clearInterval(n),a.current&&(s({userId:t,online:!1,lastSeen:Date.now()}).catch(console.error),a.current=!1)}},[t,s])}function tt(t){const a=Ie(H.presence.getPresence,t&&Ee()?{userId:t}:"skip");return a?{online:a.online===!0,lastSeen:a.lastSeen,loading:!1}:{online:!1,lastSeen:null,loading:!1}}function rs(t){if(!t)return"Never";const a=t,n=Date.now()-a,u=Math.floor(n/6e4),l=Math.floor(u/60),g=Math.floor(l/24);return u<1?"Just now":u<60?`${u}m ago`:l<24?`${l}h ago`:g<7?`${g}d ago`:new Date(a).toLocaleDateString()}function st({online:t,lastSeen:a,showText:s=!1,size:n="sm"}){const u={xs:"w-1.5 h-1.5",sm:"w-2 h-2",md:"w-2.5 h-2.5"},l={xs:"text-[10px]",sm:"text-xs",md:"text-sm"};return e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:`${u[n]} ${t?"fill-green-500 text-green-500":"fill-gray-400 text-gray-400"}`}),t&&e.jsx("div",{className:"absolute inset-0 animate-ping",children:e.jsx(Te,{className:`${u[n]} fill-green-500 opacity-75`})})]}),s&&e.jsx("span",{className:`${l[n]} ${t?"text-green-500":"text-gray-400"} font-medium`,children:t?"Online":rs(a)})]})}function as({conversation:t,activeChat:a,currentUserId:s,onSelect:n,onDelete:u}){const l=t.type==="direct"?t.uid||(t.id.includes("_")?t.id.split("_").find(y=>y!==s):null):null,{online:g,lastSeen:b}=tt(l||"");return e.jsxs("div",{onClick:()=>n(t),className:`group relative flex gap-3 p-4 cursor-pointer transition border-b dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-white/5 ${(a==null?void 0:a.id)===t.id?"bg-blue-50 dark:bg-blue-900/10 border-l-4 border-l-brand-blue":""}`,children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx(ce,{src:t.photo,name:t.n,size:"lg",isGroup:t.type==="group"}),t.type==="direct"&&l&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5",children:e.jsx(st,{online:g,lastSeen:b,size:"xs"})}),t.uc>0&&e.jsx("div",{className:"absolute -top-1 -right-1 h-5 w-5 bg-brand-blue text-white text-[10px] font-bold flex items-center justify-center rounded-full border-2 border-white dark:border-[#2c2e36]",children:t.uc>99?"99+":t.uc})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[e.jsx("h4",{className:`text-sm truncate ${t.uc>0?"font-extrabold text-gray-900 dark:text-white":"font-bold text-gray-700 dark:text-gray-300"}`,children:t.n}),e.jsx("span",{className:"text-[10px] text-gray-400 shrink-0 ml-2",children:t.lmt?new Date(t.lmt).toLocaleDateString():""})]}),e.jsxs("p",{className:`text-xs truncate ${t.uc>0?"text-gray-800 dark:text-gray-200 font-medium":"text-gray-500"}`,children:[t.ls===s?"You: ":"",t.lm]})]}),e.jsx("button",{onClick:y=>{y.stopPropagation(),u==null||u(t.id)},className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-white dark:bg-gray-800 shadow-md rounded-full text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all z-10",children:e.jsx(ve,{size:16})})]})}function Ms({user:t,conversations:a=[],activeChat:s,onSelectChat:n}){const[u,l]=o.useState(!1),[g,b]=o.useState(!1),[y,f]=o.useState("direct"),[j,k]=o.useState(!1),[i,m]=o.useState(""),[c,x]=o.useState([]),[w,R]=o.useState(""),[d,N]=o.useState([]),v=async p=>{R(p);const S=p.trim();if(S.length>1){const C=S.toLowerCase(),B=C.charAt(0).toUpperCase()+C.slice(1),Q=Re(De(de,"public_profile"),ae("firstName",">=",B),ae("firstName","<=",B+"ï£¿")),K=Re(De(de,"public_profile"),ae("lastName",">=",B),ae("lastName","<=",B+"ï£¿"));try{const[O,X]=await Promise.all([Pe(Q),Pe(K)]),Y=new Map,Z=te=>{const J=te.ref.parent.parent.id;J!==t.uid&&Y.set(J,{id:J,...te.data()})};O.forEach(Z),X.forEach(Z),N(Array.from(Y.values()))}catch(O){console.error("Search error:",O),N([])}}else N([])},F=p=>{if(y==="direct"){const S=[t.uid,p.id].sort().join("_");n({id:S,uid:p.id,name:`${p.firstName} ${p.lastName}`,type:"direct"}),I()}else y==="add_member"&&(c.find(S=>S.id===p.id)||x(S=>[...S,p]),I())},I=()=>{l(!1),R(""),N([])},G=()=>{m(""),x([]),b(!0)},_=()=>{f("add_member"),l(!0)},z=async()=>{if(!i||c.length===0)return alert("Name and members required.");if(!W){alert("Chat functionality is not available. Realtime Database is not configured.");return}k(!0);try{const S=Gt(re(W,"chats")).key,C=_t(),B=[t.uid,...c.map(O=>O.id)],Q={meta:{name:i,createdBy:t.uid,createdAt:C},members:{}};B.forEach(O=>Q.members[O]=!0),await Dt(re(W,`chats/${S}`),Q);const K={};B.forEach(O=>{K[`conversations/${O}/${S}`]={uid:S,n:i,type:"group",lmt:C,lm:"Group created",ls:t.uid,uc:O===t.uid?0:1}}),await xe(re(W),K),b(!1),n({id:S,name:i,type:"group"})}catch(p){console.error("Group creation failed",p),alert("Group creation failed: "+p.message)}finally{k(!1)}},P=async(p,S)=>{if(window.confirm("Delete this conversation?")){if(!W){alert("Chat functionality is not available. Realtime Database is not configured.");return}try{await Pt(re(W,`conversations/${t.uid}/${S}`)),(s==null?void 0:s.id)===S&&n(null)}catch(C){console.error(C)}}};return e.jsxs("div",{className:"flex flex-col h-full relative overflow-hidden bg-white dark:bg-[#1f2128]",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] shrink-0",children:[e.jsx("h2",{className:"font-extrabold text-lg dark:text-white tracking-tight",children:"Messages"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:G,className:"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition",title:"New Group",children:e.jsx(he,{size:18})}),e.jsx("button",{onClick:()=>{f("direct"),l(!0)},className:"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition",title:"New Chat",children:e.jsx(je,{size:18})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:a.map(p=>e.jsx(as,{conversation:p,activeChat:s,currentUserId:t.uid,onSelect:n,onDelete:S=>{window.confirm("Delete this conversation?")&&P({},S)}},p.id))}),g&&e.jsxs("div",{className:"absolute inset-0 bg-white dark:bg-[#1f2128] z-20 flex flex-col animate-in slide-in-from-right-10 duration-200",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center gap-3 bg-gray-50 dark:bg-[#23262f]",children:[e.jsx("button",{onClick:()=>b(!1),className:"hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded-full",children:e.jsx(He,{size:20})}),e.jsx("h3",{className:"font-bold dark:text-white",children:"New Group"})]}),e.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"1. Group Name"}),e.jsx("input",{className:"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none",placeholder:"Enter group name...",value:i,onChange:p=>m(p.target.value),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase",children:["2. Members (",c.length,")"]}),e.jsxs("button",{onClick:_,className:"text-xs font-bold text-brand-blue flex items-center gap-1 hover:underline",children:[e.jsx(je,{size:14})," Add Member"]})]}),e.jsx("div",{className:"space-y-2",children:c.length===0?e.jsx("div",{className:"text-center py-8 border-2 border-dashed dark:border-gray-700 rounded-xl text-gray-400 text-sm",children:"No members selected"}):c.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-white/5 rounded-lg border dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ce,{src:p.photoURL,name:p.firstName,size:"sm"}),e.jsxs("span",{className:"text-sm font-bold dark:text-white",children:[p.firstName," ",p.lastName]})]}),e.jsx("button",{onClick:()=>x(S=>S.filter(C=>C.id!==p.id)),className:"text-gray-400 hover:text-red-500",children:e.jsx(V,{size:16})})]},p.id))})]})]}),e.jsx("div",{className:"p-4 border-t dark:border-gray-700",children:e.jsx("button",{onClick:z,disabled:!i||c.length===0||j,className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition shadow-lg flex justify-center items-center gap-2",children:j?e.jsx(oe,{className:"animate-spin",size:20}):e.jsxs(e.Fragment,{children:["Create Group ",e.jsx(Qe,{size:18})]})})})]}),u&&e.jsxs("div",{className:"absolute inset-0 bg-white dark:bg-[#1f2128] z-30 flex flex-col animate-in fade-in duration-200",children:[e.jsxs("div",{className:"p-3 border-b dark:border-gray-700 flex items-center gap-2 bg-white dark:bg-[#1f2128]",children:[e.jsx(pe,{size:18,className:"text-gray-400 ml-2"}),e.jsx("input",{autoFocus:!0,className:"flex-1 p-2 bg-transparent outline-none dark:text-white placeholder-gray-400",placeholder:"Search...",value:w,onChange:p=>v(p.target.value)}),e.jsx("button",{onClick:I,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:e.jsx(V,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[d.length===0&&w.length>1&&e.jsx("div",{className:"text-center py-10 text-gray-400 text-sm",children:"No users found."}),d.map(p=>{const S=y==="add_member"&&c.find(C=>C.id===p.id);return e.jsxs("div",{onClick:()=>F(p),className:`flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl cursor-pointer transition mb-1 ${S?"opacity-50 pointer-events-none":""}`,children:[e.jsx(ce,{src:p.photoURL,name:p.firstName,size:"md"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-bold dark:text-white",children:[p.firstName," ",p.lastName]}),e.jsx("div",{className:"text-xs text-gray-500",children:p.role||"User"})]}),y==="add_member"&&e.jsx(je,{size:18,className:"text-brand-blue"})]},p.id)})]})]})]})}const me={Recent:["ðŸ‘","â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ”¥","ðŸŽ‰","ðŸ‘"],Smileys:["ðŸ˜€","ðŸ˜ƒ","ðŸ˜„","ðŸ˜","ðŸ˜†","ðŸ˜…","ðŸ¤£","ðŸ˜‚","ðŸ™‚","ðŸ™ƒ","ðŸ˜‰","ðŸ˜Š","ðŸ˜‡","ðŸ¥°","ðŸ˜","ðŸ¤©","ðŸ˜˜","ðŸ˜—","ðŸ˜š","ðŸ˜™","ðŸ˜‹","ðŸ˜›","ðŸ˜œ","ðŸ¤ª","ðŸ˜","ðŸ¤‘","ðŸ¤—","ðŸ¤­","ðŸ¤«","ðŸ¤”","ðŸ¤","ðŸ¤¨","ðŸ˜","ðŸ˜‘","ðŸ˜¶","ðŸ˜","ðŸ˜’","ðŸ™„","ðŸ˜¬","ðŸ¤¥","ðŸ˜Œ","ðŸ˜”","ðŸ˜ª","ðŸ¤¤","ðŸ˜´","ðŸ˜·","ðŸ¤’","ðŸ¤•","ðŸ¤¢","ðŸ¤®"],Gestures:["ðŸ‘‹","ðŸ¤š","ðŸ–ï¸","âœ‹","ðŸ––","ðŸ‘Œ","ðŸ¤Œ","ðŸ¤","âœŒï¸","ðŸ¤ž","ðŸ¤Ÿ","ðŸ¤˜","ðŸ¤™","ðŸ‘ˆ","ðŸ‘‰","ðŸ‘†","ðŸ–•","ðŸ‘‡","â˜ï¸","ðŸ‘","ðŸ‘Ž","âœŠ","ðŸ‘Š","ðŸ¤›","ðŸ¤œ","ðŸ‘","ðŸ™Œ","ðŸ‘","ðŸ¤²","ðŸ¤","ðŸ™"],Hearts:["â¤ï¸","ðŸ§¡","ðŸ’›","ðŸ’š","ðŸ’™","ðŸ’œ","ðŸ–¤","ðŸ¤","ðŸ¤Ž","ðŸ’”","â¤ï¸â€ðŸ”¥","â¤ï¸â€ðŸ©¹","ðŸ’•","ðŸ’ž","ðŸ’“","ðŸ’—","ðŸ’–","ðŸ’˜","ðŸ’","ðŸ’Ÿ"],Objects:["ðŸ’Ž","ðŸ””","ðŸ”•","ðŸŽµ","ðŸŽ¶","ðŸŽ¤","ðŸŽ§","ðŸ“»","ðŸŽ·","ðŸŽº","ðŸŽ¸","ðŸŽ¹","ðŸŽ®","ðŸ•¹ï¸","ðŸŽ¯","ðŸŽ²","ðŸŽ³","ðŸŽ´","ðŸƒ","ðŸ€„","ðŸŽ°","ðŸ“±","ðŸ“ž","â˜Žï¸","ðŸ“Ÿ","ðŸ“ ","ðŸ’»","ðŸ–¥ï¸","ðŸ–¨ï¸","âŒ¨ï¸","ðŸ–±ï¸","ðŸ–²ï¸","ðŸ•¹ï¸","ðŸ—œï¸","ðŸ’¾","ðŸ’¿","ðŸ“€"],Flags:["ðŸ³ï¸","ðŸ´","ðŸ","ðŸš©","ðŸ³ï¸â€ðŸŒˆ","ðŸ³ï¸â€âš§ï¸","ðŸ‡ºðŸ‡¸","ðŸ‡¬ðŸ‡§","ðŸ‡¨ðŸ‡¦","ðŸ‡¦ðŸ‡º","ðŸ‡«ðŸ‡·","ðŸ‡©ðŸ‡ª","ðŸ‡®ðŸ‡¹","ðŸ‡ªðŸ‡¸","ðŸ‡¯ðŸ‡µ","ðŸ‡°ðŸ‡·","ðŸ‡¨ðŸ‡³","ðŸ‡®ðŸ‡³","ðŸ‡§ðŸ‡·","ðŸ‡²ðŸ‡½"],Music:["ðŸŽµ","ðŸŽ¶","ðŸŽ¤","ðŸŽ§","ðŸ“»","ðŸŽ·","ðŸŽº","ðŸŽ¸","ðŸŽ¹","ðŸ¥","ðŸª˜","ðŸŽ»","ðŸŽª","ðŸŽ­","ðŸŽ¨","ðŸŽ¬","ðŸŽ¤","ðŸŽ§","ðŸŽ¼","ðŸŽ¹"],Reactions:["ðŸ‘","ðŸ‘Ž","â¤ï¸","ðŸ”¥","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ‘","ðŸ™Œ","ðŸ¤","ðŸ¤—","ðŸ¤”","ðŸ¤¦","ðŸ¤·","ðŸ™","ðŸ‘€","ðŸ’ª","ðŸ¤˜","âœŒï¸","ðŸ¤ž"]},ls=Object.values(me).flat();function ns({onSelect:t,onClose:a,position:s="bottom"}){const[n,u]=o.useState("Recent"),[l,g]=o.useState(""),[b,y]=o.useState(()=>{const i=localStorage.getItem("recentEmojis");return i?JSON.parse(i):me.Recent}),f=o.useMemo(()=>l.trim()?ls.filter(i=>i.includes(l)||l.includes(i)):n==="Recent"?b:me[n]||[],[l,n,b]),j=i=>{const m=[i,...b.filter(c=>c!==i)].slice(0,8);y(m),localStorage.setItem("recentEmojis",JSON.stringify(m)),t(i),a&&a()},k=Object.keys(me);return e.jsxs(D.div,{initial:{opacity:0,scale:.95,y:s==="bottom"?-10:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:`
                absolute ${s==="bottom"?"bottom-full mb-2":"top-full mt-2"} 
                left-0
                w-[340px] bg-white dark:bg-gray-800 
                rounded-2xl shadow-2xl border dark:border-gray-700
                z-50 overflow-hidden
            `,children:[e.jsxs("div",{className:"p-3 border-b dark:border-gray-700",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx(pe,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search emojis...",value:l,onChange:i=>g(i.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white"}),l&&e.jsx("button",{onClick:()=>g(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(V,{size:16})})]}),e.jsx("div",{className:"flex gap-1 overflow-x-auto scrollbar-hide",children:k.map(i=>e.jsxs("button",{onClick:()=>u(i),className:`
                                px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition
                                ${n===i?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}
                            `,children:[i==="Recent"?e.jsx(Ae,{size:12,className:"inline mr-1"}):null,i]},i))})]}),e.jsx("div",{className:"h-[280px] overflow-y-auto custom-scrollbar p-3",children:f.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:e.jsx("p",{className:"text-sm",children:"No emojis found"})}):e.jsx("div",{className:"grid grid-cols-8 gap-1",children:f.map((i,m)=>e.jsx(D.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>j(i),className:"w-10 h-10 flex items-center justify-center text-xl rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:i},`${i}-${m}`))})})]})}const Be="lfDGNSxY36zoFTAiGMVIOxjovvzFoBRp",qe="https://api.giphy.com/v1/gifs";function is({onSelect:t,onClose:a,position:s="bottom"}){const[n,u]=o.useState(""),[l,g]=o.useState([]),[b,y]=o.useState([]),[f,j]=o.useState(!1),[k,i]=o.useState("trending"),m=o.useRef(null);o.useEffect(()=>{c()},[]),o.useEffect(()=>(n.trim()?(i("search"),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{x(n)},500)):(i("trending"),g([])),()=>{m.current&&clearTimeout(m.current)}),[n]);const c=async()=>{j(!0);try{const N=await(await fetch(`${qe}/trending?api_key=${Be}&limit=24&rating=g`)).json();N.data&&y(N.data)}catch(d){console.error("Giphy trending error:",d)}j(!1)},x=async d=>{if(d.trim()){j(!0);try{const v=await(await fetch(`${qe}/search?api_key=${Be}&q=${encodeURIComponent(d)}&limit=24&rating=g`)).json();v.data&&g(v.data)}catch(N){console.error("Giphy search error:",N)}j(!1)}},w=d=>{t==null||t({url:d.images.fixed_height.url||d.images.original.url,previewUrl:d.images.preview_gif.url||d.images.fixed_height_small.url,width:d.images.fixed_height.width,height:d.images.fixed_height.height,title:d.title||"GIF"}),a&&a()},R=k==="trending"?b:l;return e.jsxs(D.div,{initial:{opacity:0,scale:.95,y:s==="bottom"?-10:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:`
                absolute ${s==="bottom"?"bottom-full mb-2":"top-full mt-2"} 
                left-0
                w-[380px] bg-white dark:bg-gray-800 
                rounded-2xl shadow-2xl border dark:border-gray-700
                z-50 overflow-hidden
            `,children:[e.jsx("div",{className:"p-3 border-b dark:border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(pe,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search GIFs...",value:n,onChange:d=>u(d.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white"}),n&&e.jsx("button",{onClick:()=>u(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(V,{size:16})})]})}),e.jsx("div",{className:"h-[320px] overflow-y-auto custom-scrollbar p-3",children:f?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx(oe,{className:"animate-spin text-brand-blue mb-2",size:24}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading GIFs..."})]}):R.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[e.jsx(at,{size:32,className:"mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:k==="search"?"No GIFs found. Try a different search.":"Loading trending GIFs..."})]}):e.jsx("div",{className:"grid grid-cols-2 gap-2",children:R.map(d=>e.jsxs(D.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>w(d),className:"relative aspect-square rounded-lg overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-700 group",children:[e.jsx("img",{src:d.images.fixed_height_small.url||d.images.preview_gif.url,alt:d.title,className:"w-full h-full object-cover",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition"})]},d.id))})}),e.jsx("div",{className:"p-2 border-t dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-center",children:e.jsxs("p",{className:"text-[10px] text-gray-400",children:["Powered by ",e.jsx("span",{className:"font-bold",children:"GIPHY"})]})})]})}function os({onRecorded:t,onClose:a,maxDuration:s=60}){const[n,u]=o.useState(!1),[l,g]=o.useState(null),[b,y]=o.useState(0),[f,j]=o.useState(null),[k,i]=o.useState(null),m=o.useRef(null),c=o.useRef(null),x=o.useRef(null),w=o.useRef([]),R=o.useRef(null);o.useEffect(()=>(d(),()=>{N()}),[]);const d=async()=>{try{const z=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!0});c.current=z,m.current&&(m.current.srcObject=z),j(!0),i(null)}catch(z){console.error("Permission error:",z),j(!1),i("Camera/microphone access denied")}},N=()=>{c.current&&(c.current.getTracks().forEach(z=>z.stop()),c.current=null),R.current&&clearInterval(R.current)},v=async()=>{if(!c.current){await d();return}try{w.current=[];const z={mimeType:"video/webm;codecs=vp9,opus",videoBitsPerSecond:25e5};x.current=new MediaRecorder(c.current,z),x.current.ondataavailable=P=>{P.data.size>0&&w.current.push(P.data)},x.current.onstop=()=>{const P=new Blob(w.current,{type:"video/webm"});g(P),u(!1),y(0),R.current&&clearInterval(R.current)},x.current.start(),u(!0),y(0),R.current=setInterval(()=>{y(P=>{const p=P+1;return p>=s&&F(),p})},1e3)}catch(z){console.error("Recording error:",z),i("Failed to start recording")}},F=()=>{x.current&&n&&x.current.stop()},I=()=>{g(null),y(0),u(!1)},G=()=>{if(l){const z=new File([l],`video_${Date.now()}.webm`,{type:"video/webm"});t==null||t(z),N(),a==null||a()}},_=z=>{const P=Math.floor(z/60),p=z%60;return`${P}:${p.toString().padStart(2,"0")}`};return!f&&f!==null?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:e.jsx(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-[#2c2e36] rounded-2xl p-6 max-w-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx(lt,{size:48,className:"text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold dark:text-white mb-2",children:"Camera Access Required"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please allow camera and microphone access to record video messages."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,className:"flex-1 px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200 transition",children:"Cancel"}),e.jsx("button",{onClick:d,className:"flex-1 px-4 py-2 bg-brand-blue text-white rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Allow Access"})]})]})})}):e.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-[80]",children:e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"relative w-full max-w-2xl aspect-video bg-black rounded-2xl overflow-hidden",children:[e.jsx("video",{ref:m,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),n&&e.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 flex items-center gap-2 bg-red-500 text-white px-4 py-2 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-bold",children:_(b)})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent",children:e.jsx("div",{className:"flex items-center justify-center gap-4",children:l?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:I,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:e.jsx(V,{size:24})}),e.jsx("button",{onClick:G,className:"p-4 bg-green-500 hover:bg-green-600 rounded-full text-white transition shadow-lg",children:e.jsx(ge,{size:28})}),e.jsx("div",{className:"w-12"})," "]}):e.jsx(e.Fragment,{children:n?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:I,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:e.jsx(V,{size:24})}),e.jsx("button",{onClick:F,className:"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg animate-pulse",children:e.jsx(Ke,{size:28})}),e.jsx("div",{className:"w-12"})," "]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:a,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:e.jsx(V,{size:24})}),e.jsx("button",{onClick:v,className:"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg",children:e.jsx(ye,{size:28})}),e.jsx("div",{className:"w-12"})," "]})})})}),k&&e.jsx("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-4 py-2 rounded-lg text-sm",children:k})]})})}function cs({activeChatId:t,uid:a,onSend:s,replyingTo:n,editingMessage:u,onCancelReply:l,typingUsers:g=[]}){const[b,y]=o.useState(""),[f,j]=o.useState(null),[k,i]=o.useState(!1),[m,c]=o.useState(!1),[x,w]=o.useState(!1),[R,d]=o.useState(!1),[N,v]=o.useState(!1),F=o.useRef(null),I=o.useRef(null),G=o.useRef(null),_=o.useRef(null),z=o.useRef([]),P=o.useRef(null),p=o.useRef(null),{uploadMedia:S,uploading:C}=ss();o.useEffect(()=>{var r;u&&(y(u.b||""),(r=G.current)==null||r.focus())},[u]),o.useEffect(()=>{var r;n&&((r=G.current)==null||r.focus())},[n]),o.useEffect(()=>{const r=h=>{P.current&&!P.current.contains(h.target)&&w(!1),p.current&&!p.current.contains(h.target)&&d(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const B=async r=>{try{const $=await(await fetch(r.url)).blob(),L=new File([$],`gif_${Date.now()}.gif`,{type:"image/gif"}),A=await S(L,`chat_media/${t}`);if(A){const M={url:A.url,type:"image",name:r.title||"GIF",gif:!0};s("",M)}}catch(h){console.error("GIF upload error:",h),alert("Failed to send GIF")}d(!1)},Q=async r=>{try{const h=await S(r,`chat_media/${t}`);if(h){const $={url:h.url,type:"video",name:r.name};s("",$)}}catch(h){console.error("Video upload error:",h),alert("Failed to send video")}v(!1)},K=r=>{y(r.target.value),t&&a&&W&&(xe(re(W,`chats/${t}/typing`),{[a]:!0}),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{W&&xe(re(W,`chats/${t}/typing`),{[a]:!1})},2e3))},O=r=>{const h=G.current;if(h){const $=h.selectionStart,L=h.selectionEnd,A=b.substring(0,$)+r+b.substring(L);y(A),setTimeout(()=>{h.selectionStart=h.selectionEnd=$+r.length,h.focus()},0)}else y($=>$+r)},X=async()=>{try{const r=await navigator.mediaDevices.getUserMedia({audio:!0});_.current=new MediaRecorder(r),z.current=[],_.current.ondataavailable=h=>z.current.push(h.data),_.current.onstop=()=>{const h=new Blob(z.current,{type:"audio/mp3"}),$=new File([h],`voice_note_${Date.now()}.mp3`,{type:"audio/mp3"});j({file:$,type:"audio",previewUrl:URL.createObjectURL(h)}),r.getTracks().forEach(L=>L.stop())},_.current.start(),i(!0)}catch{alert("Microphone access denied.")}},Y=()=>{_.current&&_.current.stop(),i(!1)},Z=r=>{r.preventDefault(),r.stopPropagation(),r.type==="dragenter"||r.type==="dragover"?c(!0):c(!1)},te=r=>{r.preventDefault(),r.stopPropagation(),c(!1),r.dataTransfer.files&&r.dataTransfer.files[0]&&J(r.dataTransfer.files[0])},J=r=>{const h=r.type.startsWith("image/")?"image":r.type.startsWith("video/")?"video":r.type.startsWith("audio/")?"audio":"file";j({file:r,type:h,previewUrl:URL.createObjectURL(r)})},E=async r=>{if(r.preventDefault(),!b.trim()&&!f||C)return;let h=null;if(f){const $=await S(f.file,`chat_media/${t}`);$&&(h={url:$.url,type:$.type,name:$.name})}s(b,h),y(""),j(null),t&&a&&W&&xe(re(W,`chats/${t}/typing`),{[a]:!1})},q=()=>{u&&y(""),l==null||l()},ne=()=>{var r,h;return u?((r=u.b)==null?void 0:r.substring(0,50))||"Message":n?((h=n.b)==null?void 0:h.substring(0,50))||"Media":""};return e.jsxs("div",{className:`p-3 bg-white dark:bg-[#2c2e36] border-t dark:border-gray-700 shrink-0 transition-colors ${m?"bg-blue-50 dark:bg-blue-900/20 border-blue-400":""}`,onDragEnter:Z,onDragLeave:Z,onDragOver:Z,onDrop:te,children:[e.jsx(ie,{children:g.length>0&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mb-2 px-2 flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),e.jsxs("span",{className:"text-xs text-gray-400 italic",children:[g.length>1?"Multiple people are":"Someone is"," typing..."]})]})}),e.jsx(ie,{children:(n||u)&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-between items-center bg-gray-100 dark:bg-gray-800 p-2.5 px-4 rounded-xl border-l-4 border-brand-blue mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[u?e.jsx(Ye,{size:16,className:"text-brand-blue shrink-0"}):e.jsx(Je,{size:16,className:"text-brand-blue shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-xs font-bold text-brand-blue block",children:u?"Editing Message":`Replying to ${(n==null?void 0:n.n)||"User"}`}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate block",children:ne()})]})]}),e.jsx("button",{onClick:q,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:e.jsx(V,{size:16,className:"text-gray-400 hover:text-red-500"})})]})}),e.jsx(ie,{children:f&&e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800 rounded-xl mb-2 border dark:border-gray-700",children:[f.type==="image"?e.jsx("img",{src:f.previewUrl,className:"h-14 w-14 object-cover rounded-lg"}):f.type==="video"?e.jsx("video",{src:f.previewUrl,className:"h-14 w-14 object-cover rounded-lg"}):e.jsx("div",{className:"h-14 w-14 bg-purple-100 dark:bg-purple-900/30 text-purple-600 flex items-center justify-center rounded-lg",children:e.jsx(nt,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-bold dark:text-white truncate",children:f.file.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(f.file.size/1024).toFixed(1)," KB"]})]}),e.jsx("button",{onClick:()=>j(null),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:e.jsx(V,{size:18,className:"text-gray-400 hover:text-red-500"})})]})}),e.jsxs("form",{onSubmit:E,className:"flex items-end gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",ref:I,className:"hidden",accept:"image/*,audio/*,video/*,.pdf,.doc,.docx,.txt,.zip",onChange:r=>J(r.target.files[0])}),e.jsx("button",{type:"button",onClick:()=>{var r;return(r=I.current)==null?void 0:r.click()},className:"p-2.5 text-gray-500 hover:text-brand-blue hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition shrink-0",title:"Attach file",children:e.jsx(it,{size:20})})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r dark:border-gray-700 pr-2",children:[e.jsx("button",{type:"button",onClick:()=>{v(!0),w(!1),d(!1)},className:"p-2 text-gray-500 hover:text-red-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition",title:"Record video",children:e.jsx(ye,{size:18})}),e.jsxs("button",{type:"button",onClick:()=>{d(!R),w(!1)},className:"p-2 text-gray-500 hover:text-purple-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition relative",title:"GIF",ref:p,children:[e.jsx(ot,{size:18}),R&&e.jsx(is,{onSelect:B,onClose:()=>d(!1),position:"bottom"})]})]}),e.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-[#1f2128] rounded-2xl border dark:border-gray-700 focus-within:ring-2 focus-within:ring-brand-blue transition-all flex items-end relative",children:[e.jsx("textarea",{ref:G,className:"w-full bg-transparent p-3 max-h-32 min-h-[44px] text-sm resize-none outline-none dark:text-white custom-scrollbar pr-20",placeholder:u?"Update message...":m?"Drop files here...":"Type a message...",value:b,onChange:K,onKeyDown:r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),E(r))},rows:1}),e.jsxs("div",{className:"absolute right-2 bottom-1.5 flex items-center gap-1",children:[e.jsxs("div",{className:"relative",ref:P,children:[e.jsx("button",{type:"button",onClick:()=>{w(!x),d(!1)},className:`p-1.5 rounded-full transition ${x?"bg-brand-blue/20 text-brand-blue":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"}`,title:"Emoji",children:e.jsx(ct,{size:18})}),e.jsx(ie,{children:x&&e.jsx(ns,{onSelect:O,onClose:()=>w(!1),position:"bottom"})})]}),e.jsx("button",{type:"button",onClick:k?Y:X,className:`p-1.5 rounded-full transition ${k?"bg-red-500 text-white animate-pulse":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"}`,children:k?e.jsx(Ke,{size:18}):e.jsx(dt,{size:18})})]})]}),e.jsx("button",{type:"submit",disabled:!b.trim()&&!f||C,className:`p-2.5 text-white rounded-full shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all shrink-0 ${u?"bg-green-600 hover:bg-green-700":"bg-brand-blue hover:bg-blue-600"}`,children:C?e.jsx(oe,{size:20,className:"animate-spin"}):u?e.jsx(ut,{size:20}):e.jsx(xt,{size:20})})]}),N&&e.jsx(os,{onRecorded:Q,onClose:()=>v(!1),maxDuration:60})]})}function ds(...t){return We(Ne(t))}const fe=mt.forwardRef(({className:t,variant:a="default",size:s="default",...n},u)=>{const l={default:"bg-blue-600 text-white hover:bg-blue-700 shadow-sm",destructive:"bg-red-500 text-white hover:bg-red-600 shadow-sm",outline:"border border-gray-200 bg-transparent hover:bg-gray-100 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 hover:text-gray-900 text-gray-600",link:"text-blue-600 underline-offset-4 hover:underline"},g={default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"};return e.jsx("button",{ref:u,className:ds("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50",l[a],g[s],t),...n})});fe.displayName="Button";function us({url:t,isOpen:a,onClose:s,previewData:n}){if(!a||!t)return null;const u=new URL(t).pathname;let l="Content";u.startsWith("/profile/")?l="User Profile":u.startsWith("/session/")?l="Session Details":u.startsWith("/studio/")&&(l="Studio Listing");const g=(n==null?void 0:n.title)||`${l} Preview`;return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black bg-opacity-70 backdrop-blur-sm",onClick:s,children:e.jsxs("div",{className:"bg-gray-900 rounded-xl shadow-2xl w-full max-w-2xl h-3/4 max-h-[800px] flex flex-col transform transition-all duration-300 scale-100 opacity-100",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800 rounded-t-xl sticky top-0",children:[e.jsx("h3",{className:"text-xl font-bold text-white truncate max-w-[80%]",children:g}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:e.jsx(fe,{variant:"ghost",size:"icon",className:"text-blue-400 hover:text-blue-300",children:e.jsx(ft,{className:"w-5 h-5"})})}),e.jsx(fe,{onClick:s,variant:"ghost",size:"icon",className:"text-white hover:bg-gray-700",children:e.jsx(V,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 p-4 overflow-y-auto custom-scrollbar text-gray-400 flex flex-col items-center justify-center text-center",children:[e.jsx("p",{className:"mb-4 text-lg font-medium text-white",children:"Embedded Content Simulation"}),e.jsx("p",{className:"mb-2",children:"This is where the actual SeshNx content (e.g., profile card, session details) would be rendered, based on the URL:"}),e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline break-all p-2 bg-gray-700 rounded-lg text-sm",children:t}),e.jsx("p",{className:"mt-4 text-sm",children:'In a real implementation, you would use a dedicated component (e.g., `ProfileCard id="..."`) here instead of an iframe to display the content securely and natively.'})]}),e.jsx("div",{className:"p-3 border-t border-gray-700 bg-gray-800 rounded-b-xl flex justify-end",children:e.jsx(fe,{onClick:s,variant:"secondary",children:"Done"})})]})})}function xs({status:t="sent",size:a=12,className:s=""}){const n={sending:{icon:Ae,color:"text-gray-400",animate:!0},sent:{icon:ge,color:"text-gray-400",animate:!1},delivered:{icon:Le,color:"text-gray-400",animate:!1},read:{icon:Le,color:"text-brand-blue",animate:!1}},u=n[t]||n.sent,l=u.icon;return e.jsx(D.div,{animate:u.animate?{rotate:[0,360]}:{},transition:u.animate?{duration:2,repeat:1/0,ease:"linear"}:{},className:`inline-flex items-center ${u.color} ${s}`,children:e.jsx(l,{size:a,className:t==="read"?"fill-current":""})})}function ms({audioUrl:t,color:a="brand-blue",height:s=40}){const n=o.useRef(null),u=o.useRef(null),l=o.useRef(null),g=o.useRef(null),b=o.useRef(null),[y,f]=o.useState(!1);o.useEffect(()=>{if(!t||!n.current)return;const i=n.current,m=i.getContext("2d"),c=new Audio(t);u.current=c,i.width=i.offsetWidth,i.height=s;const x=new(window.AudioContext||window.webkitAudioContext),w=x.createAnalyser(),R=x.createMediaElementSource(c);w.fftSize=256,R.connect(w),w.connect(x.destination),g.current=x,b.current=w;const d=w.frequencyBinCount,N=new Uint8Array(d),v=()=>{if(c.paused){j(m,i.width,i.height);return}l.current=requestAnimationFrame(v),w.getByteFrequencyData(N),m.clearRect(0,0,i.width,i.height);const F=i.width/d*2;let I=0;for(let G=0;G<d;G++){const _=N[G]/255*i.height,z=m.createLinearGradient(0,0,0,i.height);z.addColorStop(0,"#3b82f6"),z.addColorStop(1,"#8b5cf6"),m.fillStyle=z,m.fillRect(I,i.height-_,F-1,_),I+=F}};return c.addEventListener("play",()=>{f(!0),v()}),c.addEventListener("pause",()=>{f(!1),l.current&&cancelAnimationFrame(l.current),j(m,i.width,i.height)}),c.addEventListener("ended",()=>{f(!1),l.current&&cancelAnimationFrame(l.current),j(m,i.width,i.height)}),j(m,i.width,i.height),()=>{var F;l.current&&cancelAnimationFrame(l.current),c.pause(),(F=g.current)==null||F.close()}},[t,s,y]);const j=(i,m,c)=>{i.clearRect(0,0,m,c),i.fillStyle="#3b82f6";const x=50,w=m/x,R=2;for(let d=0;d<x;d++){const N=Math.random()*c*.3+c*.1,v=d*w;i.fillRect(v,c-N,w-R,N)}},k=()=>{u.current&&(y?u.current.pause():u.current.play())};return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:k,className:"w-10 h-10 flex items-center justify-center bg-brand-blue text-white rounded-full hover:bg-blue-600 transition shrink-0",children:y?e.jsx(ht,{size:16}):e.jsx(gt,{size:16,className:"ml-0.5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("canvas",{ref:n,className:"w-full rounded",style:{height:`${s}px`}}),e.jsx("audio",{ref:u,src:t})]})]})}const fs=["ðŸ‘","â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ”¥"];function hs({message:t,isCurrentUser:a,previousMessage:s,currentUserId:n,chatId:u,linkPreviewData:l,messageStatus:g="sent",onReaction:b,onReply:y,onEdit:f,onDelete:j,onForward:k,onSeshNxLinkClick:i,onUserClick:m}){var J;const[c,x]=o.useState(!1),[w,R]=o.useState(!1),[d,N]=o.useState(!1),v=o.useRef(null),F=o.useRef(null),I=!s||s.s!==t.s,G=s&&new Date(t.t).toDateString()===new Date(s.t).toDateString(),_=t.t||Date.now(),z=(s==null?void 0:s.t)||0,P=s&&_-z>3e5,p=!G||!s,S=I||P,C=!a&&I,B=new Date(t.t||Date.now());o.useEffect(()=>{const E=q=>{v.current&&!v.current.contains(q.target)&&(x(!1),R(!1))};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[]);const Q=()=>{navigator.clipboard.writeText(t.b||""),N(!0),setTimeout(()=>N(!1),2e3),x(!1)},K=E=>{b==null||b(t.id,E),R(!1),x(!1)},O=t.reactions?Object.entries(t.reactions).reduce((E,[q,ne])=>{const r=typeof ne=="object"?Object.keys(ne).length:0;return r>0&&(E[q]=r),E},{}):{},X=Object.keys(O).length>0,Y=t.reactions?(J=Object.entries(t.reactions).find(([E,q])=>typeof q=="object"&&q[n]))==null?void 0:J[0]:null,Z=a?"bg-brand-blue text-white rounded-br-sm":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white rounded-bl-sm";if(t.deleted||t.deletedForAll)return e.jsx("div",{className:`flex ${a?"justify-end":"justify-start"} ${I?"mt-3":"mt-0.5"}`,children:e.jsx("div",{className:"px-4 py-2 rounded-2xl bg-gray-100 dark:bg-gray-800 text-gray-400 italic text-sm",children:"ðŸš« This message was deleted"})});if(t.deletedFor&&t.deletedFor[n])return null;const te=()=>{var q;if(!l)return null;const E=(q=l.url)==null?void 0:q.includes("seshnx.net");return e.jsx("div",{className:"mt-2 block border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden bg-white dark:bg-gray-800 max-w-[280px]",children:E?e.jsxs("button",{onClick:()=>i==null?void 0:i(l),className:"w-full text-left",children:[l.image&&e.jsx("div",{className:"h-28 w-full bg-cover bg-center",style:{backgroundImage:`url(${l.image})`}}),e.jsxs("div",{className:"p-2",children:[e.jsxs("p",{className:"font-semibold text-xs text-brand-blue truncate flex items-center",children:[e.jsx(pt,{className:"w-3 h-3 mr-1"}),l.title||"SeshNx Link"]}),l.description&&e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 line-clamp-2",children:l.description})]})]}):e.jsxs("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",children:[l.image&&e.jsx("div",{className:"h-28 w-full bg-cover bg-center",style:{backgroundImage:`url(${l.image})`}}),e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"font-semibold text-xs text-brand-blue truncate",children:l.title||l.url}),l.description&&e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 line-clamp-2",children:l.description}),e.jsxs("p",{className:"text-[10px] text-gray-400 mt-1 flex items-center",children:[e.jsx(yt,{className:"w-2.5 h-2.5 mr-1"}),new URL(l.url).hostname]})]})]})})};return e.jsxs(e.Fragment,{children:[p&&e.jsx("div",{className:"text-center my-4",children:e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-bold uppercase tracking-wider bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full",children:B.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})}),e.jsxs("div",{className:`group flex items-end gap-2 ${a?"flex-row-reverse":"flex-row"} ${I?"mt-3":"mt-0.5"}`,ref:F,children:[!a&&e.jsx("div",{className:"w-8 shrink-0",children:C&&e.jsx(ce,{src:t.photo,name:t.n,size:"xs",className:"cursor-pointer",onClick:()=>m==null?void 0:m(t.s)})}),e.jsxs("div",{className:`relative max-w-[75%] ${a?"items-end":"items-start"}`,children:[!a&&I&&t.n&&e.jsx("p",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 mb-1 ml-1",children:t.n}),t.replyTo&&e.jsxs("div",{className:`mb-1 px-3 py-1.5 rounded-lg text-xs border-l-2 border-brand-blue ${a?"bg-blue-400/30 text-blue-100":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}`,children:[e.jsx("p",{className:"font-bold text-[10px] mb-0.5",children:t.replyTo.sender}),e.jsx("p",{className:"truncate opacity-80",children:t.replyTo.text})]}),e.jsxs("div",{className:`relative px-3 py-2 rounded-2xl shadow-sm ${Z} cursor-pointer transition-all hover:shadow-md`,onClick:()=>x(!c),children:[t.media&&e.jsxs("div",{className:"mb-2",children:[t.media.type==="image"&&e.jsxs("div",{className:"relative rounded-lg overflow-hidden",children:[t.media.gif&&e.jsx("span",{className:"absolute top-2 left-2 bg-black/60 text-white text-xs px-2 py-0.5 rounded-full font-bold",children:"GIF"}),e.jsx("img",{src:t.media.url,alt:"Shared",className:"max-w-full h-auto rounded-lg max-h-60 object-cover"})]}),t.media.type==="video"&&e.jsx("video",{controls:!0,src:t.media.url,className:"max-w-full h-auto rounded-lg max-h-60"}),t.media.type==="audio"&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 max-w-[280px]",children:e.jsx(ms,{audioUrl:t.media.url,height:50})}),t.media.type==="file"&&e.jsxs("a",{href:t.media.url,target:"_blank",rel:"noopener noreferrer",download:t.media.name,className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition group",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center shrink-0",children:e.jsx(be,{size:20,className:"text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold dark:text-white truncate",children:t.media.name||"File"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click to download"})]}),e.jsx(Fe,{size:18,className:"text-gray-400 group-hover:text-brand-blue transition shrink-0"})]})]}),t.b&&e.jsx("p",{className:"text-sm break-words whitespace-pre-wrap leading-relaxed",children:t.b}),t.b&&te(),t.edited&&e.jsx("span",{className:`text-[9px] ${a?"text-blue-200":"text-gray-400"} ml-1`,children:"(edited)"})]}),X&&e.jsx("div",{className:`flex flex-wrap gap-1 mt-1 ${a?"justify-end":"justify-start"}`,children:Object.entries(O).map(([E,q])=>e.jsxs(D.button,{initial:{scale:0},animate:{scale:1},onClick:()=>K(E),className:`flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-xs border transition-all ${Y===E?"bg-brand-blue/20 border-brand-blue text-brand-blue":"bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:[e.jsx("span",{children:E}),e.jsx("span",{className:"text-[10px] font-bold",children:q})]},E))}),S&&e.jsxs("div",{className:`flex items-center gap-1 mt-1 ${a?"justify-end":"justify-start"}`,children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:B.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}),a&&e.jsx(xs,{status:g,size:10,className:"ml-0.5"})]}),e.jsx(ie,{children:c&&e.jsxs(D.div,{ref:v,initial:{opacity:0,scale:.9,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-10},className:`absolute z-50 ${a?"right-0":"left-0"} bottom-full mb-2 bg-white dark:bg-gray-800 rounded-xl shadow-xl border dark:border-gray-700 overflow-hidden min-w-[180px]`,children:[e.jsx("div",{className:"flex justify-center gap-1 p-2 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:fs.map(E=>e.jsx(D.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>K(E),className:`text-lg p-1 rounded-full transition ${Y===E?"bg-brand-blue/20":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:E},E))}),e.jsxs("div",{className:"p-1",children:[e.jsxs("button",{onClick:()=>{y==null||y(t),x(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[e.jsx(Je,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"dark:text-gray-200",children:"Reply"})]}),e.jsxs("button",{onClick:Q,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[e.jsx(bt,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"dark:text-gray-200",children:d?"Copied!":"Copy"})]}),e.jsxs("button",{onClick:()=>{k==null||k(t),x(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[e.jsx(ke,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"dark:text-gray-200",children:"Forward"})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{f==null||f(t),x(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[e.jsx(Ye,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"dark:text-gray-200",children:"Edit"})]}),e.jsxs("button",{onClick:()=>{j==null||j(t,"everyone"),x(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition text-red-500",children:[e.jsx(ve,{size:16}),e.jsx("span",{children:"Delete for Everyone"})]})]}),e.jsxs("button",{onClick:()=>{j==null||j(t,"me"),x(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition text-gray-500",children:[e.jsx(ve,{size:16}),e.jsx("span",{children:"Delete for Me"})]})]})]})})]}),a&&e.jsx("div",{className:"w-8 shrink-0"})]})]})}function gs({message:t,conversations:a,currentUserId:s,onForward:n,onClose:u}){const[l,g]=o.useState(""),[b,y]=o.useState([]),[f,j]=o.useState(!1),k=l.trim()?a.filter(x=>{var w;return(w=x.n)==null?void 0:w.toLowerCase().includes(l.toLowerCase())}):a,i=x=>{y(w=>w.includes(x)?w.filter(R=>R!==x):[...w,x])},m=async()=>{if(b.length!==0){j(!0);try{await n(t,b),u()}catch(x){console.error("Forward error:",x),alert("Failed to forward message")}j(!1)}},c=()=>{var x;return t.media?t.media.type==="image"?"ðŸ“· Image":t.media.type==="video"?"ðŸŽ¥ Video":t.media.type==="audio"?"ðŸŽµ Audio":"ðŸ“Ž File":((x=t.b)==null?void 0:x.substring(0,100))||"Message"};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:e.jsxs(D.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{className:"text-brand-blue",size:20}),e.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Forward Message"})]}),e.jsx("button",{onClick:u,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:e.jsx(V,{size:20})})]}),e.jsxs("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Forwarding:"}),e.jsx("div",{className:"bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600",children:e.jsx("p",{className:"text-sm dark:text-gray-200 line-clamp-2",children:c()})})]}),e.jsx("div",{className:"px-4 py-3 border-b dark:border-gray-700 shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(pe,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search conversations...",value:l,onChange:x=>g(x.target.value),className:"w-full pl-9 pr-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white transition"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:k.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"No conversations found"})}):k.map(x=>{const w=b.includes(x.id);return e.jsxs(D.div,{whileTap:{scale:.98},onClick:()=>i(x.id),className:`
                                        flex items-center gap-3 p-4 cursor-pointer transition
                                        border-b dark:border-gray-700/50
                                        ${w?"bg-brand-blue/10 dark:bg-brand-blue/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}
                                    `,children:[e.jsxs("div",{className:"relative",children:[e.jsx(ce,{src:x.photo,name:x.n,size:"md",isGroup:x.type==="group"}),w&&e.jsx(D.div,{initial:{scale:0},animate:{scale:1},className:"absolute -bottom-1 -right-1 w-5 h-5 bg-brand-blue rounded-full flex items-center justify-center",children:e.jsx(ge,{size:12,className:"text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm dark:text-white truncate",children:x.n}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:x.type==="group"?"Group":"Direct message"})]}),e.jsx("div",{className:`
                                        w-5 h-5 rounded-full border-2 transition
                                        ${w?"border-brand-blue bg-brand-blue":"border-gray-300 dark:border-gray-600"}
                                    `,children:w&&e.jsx(ge,{size:12,className:"text-white m-auto"})})]},x.id)})}),e.jsxs("div",{className:"p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[b.length," conversation",b.length!==1?"s":""," selected"]}),b.length>0&&e.jsx("button",{onClick:()=>y([]),className:"text-xs text-brand-blue hover:underline",children:"Clear all"})]}),e.jsx("button",{onClick:m,disabled:b.length===0||f,className:"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"animate-spin",size:18}),"Forwarding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{size:18}),"Forward"]})})]})]})})}function bs(t,a){var k;const s=Ie(H.readReceipts.getReadReceipts,t&&a&&Ee()?{chatId:t}:"skip"),n=ee(H.readReceipts.markAsRead),u=ee(H.readReceipts.markMultipleAsRead),l=o.useMemo(()=>{if(!s)return{};const i={};return s.forEach(m=>{i[m.userId]?m.readAt>i[m.userId].readAt&&(i[m.userId]={lastReadMessageId:m.messageId,readAt:m.readAt}):i[m.userId]={lastReadMessageId:m.messageId,readAt:m.readAt}}),i},[s]),g=((k=l[a])==null?void 0:k.lastReadMessageId)||null,b=o.useCallback(async i=>{if(!(!t||!a||!i||!n||!u))try{const m=Array.isArray(i)?i:[i];m.length===1?await n({chatId:t,messageId:m[0],userId:a}):await u({chatId:t,messageIds:m,userId:a})}catch(m){console.error("Mark as read error:",m)}},[t,a,n,u]),y=o.useCallback((i,m,c=null)=>{if(!i||!m)return!1;const x=l[m];if(!x||!x.lastReadMessageId)return!1;const w=x.lastReadMessageId;if(w===i)return!0;if(c&&Array.isArray(c)){const R=c.find(N=>N.id===i),d=c.find(N=>N.id===w);if(R&&d&&R.t&&d.t)return R.t<=d.t}return w>=i},[l]),f=o.useCallback(i=>{var m;return((m=l[i])==null?void 0:m.lastReadMessageId)||null},[l]),j=o.useCallback(i=>g===i||g&&g>=i,[g]);return{readReceipts:l,myLastRead:g,markAsRead:b,isMessageRead:y,getLastReadMessage:f,hasCurrentUserRead:j}}async function ps(t){const a=t.match(/(https?:\/\/[^\s]+)/);if(!a)return null;const s=a[0];await new Promise(u=>setTimeout(u,500));const n={url:s,title:null,description:null,image:null};return s.includes("seshnx.net")?(n.title="SeshNx Official Platform Link",n.description="Shared content from the SeshNx platform. Tap to view embed.",n.image="https://placehold.co/600x400/374151/f9fafb?text=SeshNx+Link"):s.includes("youtube.com")?(n.title="YouTube Video",n.description="Watch this video on YouTube.",n.image="https://img.youtube.com/vi/dQw4w9WgXcQ/mqdefault.jpg"):s.includes("spotify.com")?(n.title="New Track on Spotify",n.description="Listen to the latest release now!",n.image="https://placehold.co/600x400/1DB954/f9fafb?text=Spotify+Album"):s.includes("github.com")?(n.title="SeshNx WebApp Repository",n.description="Check out the source code and contribute.",n.image="https://placehold.co/600x400/000000/ffffff?text=GitHub"):(n.title=`External Link: ${s}`,n.description=`Click to visit ${s}.`),n}function zs({user:t,userData:a,activeChat:s,conversations:n,onBack:u,toggleDetails:l,openPublicProfile:g}){const[b,y]=o.useState({}),[f,j]=o.useState({isOpen:!1,url:"",previewData:null}),[k,i]=o.useState(null),[m,c]=o.useState(null),[x,w]=o.useState(null),R=o.useRef(null),d=s==null?void 0:s.id,N=(s==null?void 0:s.name)||(s==null?void 0:s.n)||"Unknown User",v=o.useMemo(()=>(s==null?void 0:s.type)==="group"?null:s!=null&&s.uid?s.uid:d&&d.includes("_")?d.split("_").find(h=>h!==(t==null?void 0:t.uid)):null,[s,d,t==null?void 0:t.uid]),{online:F,lastSeen:I,loading:G}=tt(v),{markAsRead:_,hasCurrentUserRead:z,isMessageRead:P}=bs(d,t==null?void 0:t.uid),p=Ie(H.messages.getMessages,d&&Ee()?{chatId:d,limit:100}:"skip"),S=o.useMemo(()=>p?p.map(r=>({id:r._id,b:r.content||"",s:r.senderId,n:r.senderName,photo:r.senderPhoto||"",t:r.timestamp,edited:r.edited||!1,editedAt:r.editedAt,deleted:r.deleted||!1,deletedForAll:r.deletedForAll||!1,media:r.media,replyTo:r.replyTo,reactions:r.reactions||{}})):[],[p]),C=ee(H.messages.sendMessage),B=ee(H.messages.editMessage),Q=ee(H.messages.deleteMessage),K=ee(H.messages.addReaction),O=ee(H.messages.removeReaction),X=ee(H.conversations.updateConversation),Y=ee(H.conversations.updateUnreadCount);o.useEffect(()=>{R.current&&S.length>0&&R.current.scrollIntoView({behavior:"smooth"})},[S]),o.useEffect(()=>{d&&(t!=null&&t.uid)&&S.length>0&&_(S.map(r=>r.id))},[d,t==null?void 0:t.uid,S.length]),o.useEffect(()=>{S.forEach(r=>{if(r.b){const h=r.b.match(/(https?:\/\/[^\s]+)/);if(h){const $=h[0];b[r.id]||ps($).then(L=>y(A=>({...A,[r.id]:L}))).catch(L=>console.error(L))}}})},[S]);const Z=async(r,h)=>{var $,L;if(!(!d||!(t!=null&&t.uid)))try{const A=S.find(U=>U.id===r);if(!A)return;((L=($=A.reactions)==null?void 0:$[h])==null?void 0:L.includes(t.uid))?await O({messageId:r,userId:t.uid,emoji:h}):await K({messageId:r,userId:t.uid,emoji:h})}catch(A){console.error("Reaction error:",A)}},te=async(r,h)=>{if(!C||!X){alert("Chat functionality is not available. Convex is not configured.");return}const $=r.b||"",L=r.media||null;for(const A of h)try{await C({chatId:A,senderId:t.uid,senderName:a.firstName||"User",senderPhoto:a.photoURL||null,content:`â†ª Forwarded: ${$}`,media:L});const M=n==null?void 0:n.find(se=>se.id===A),U=$||(L?`Forwarded ${L.type}`:"Forwarded message");await X({userId:t.uid,chatId:A,lastMessage:`â†ª ${U}`,lastMessageTime:Date.now(),lastSenderId:t.uid,chatName:(M==null?void 0:M.name)||(M==null?void 0:M.n),chatPhoto:(M==null?void 0:M.photo)||"",chatType:(M==null?void 0:M.type)||"direct",otherUserId:M==null?void 0:M.uid})}catch(M){console.error("Forward error for chat:",A,M)}},J=async(r,h)=>{var L;if(!d||!(r!=null&&r.trim())&&!h||!C||!B||!X||!Y)return;let $=r?r.trim():"";if($.length===0&&h&&($=h.type==="image"?"ðŸ“· Image":h.type==="video"?"ðŸŽ¥ Video":h.type==="audio"?"ðŸŽµ Audio":"ðŸ“Ž File"),m)try{await B({messageId:m.id,content:$,senderId:t.uid}),c(null);return}catch(A){console.error("Edit error:",A);return}try{await C({chatId:d,senderId:t.uid,senderName:a.firstName||"User",senderPhoto:a.photoURL||null,content:$,media:h,replyTo:k?{messageId:k.id,text:((L=k.b)==null?void 0:L.substring(0,100))||"Media",sender:k.n||"User"}:void 0});const A=$||(h?`Sent ${h.type}`:"Message");let M=[],U=s.uid;!U&&s.type!=="group"&&d&&d.includes("_")&&(U=d.split("_").find(rt=>rt!==t.uid)),s.type==="group"?M=[t.uid]:U?M=[t.uid,U]:M=[t.uid];for(const se of M)await X({userId:se,chatId:d,lastMessage:A,lastMessageTime:Date.now(),lastSenderId:t.uid,chatName:s.type==="group"?N:s.name||s.n,chatPhoto:s.photo||"",chatType:s.type||"direct",otherUserId:s.type==="direct"?se===t.uid?U:t.uid:void 0}),se===t.uid?await Y({userId:se,chatId:d,setTo:0}):await Y({userId:se,chatId:d,increment:1});i(null)}catch(A){console.error("Send message error:",A)}},E=async(r,h=!1)=>{if(!(!d||!(t!=null&&t.uid)||!Q))try{await Q({messageId:r,senderId:t.uid,forEveryone:h})}catch($){console.error("Delete error:",$)}},q=o.useMemo(()=>{var r;return e.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-800 bg-white dark:bg-[#1f2128]",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("button",{onClick:u,className:"md:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(He,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 cursor-pointer",onClick:()=>g==null?void 0:g(v?{uid:v}:null),children:[e.jsx(ce,{src:(s==null?void 0:s.photo)||((r=s==null?void 0:s.n)==null?void 0:r.photo)||"",name:N,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white truncate",children:N}),(s==null?void 0:s.type)!=="group"&&e.jsx(st,{online:F,lastSeen:I,loading:G})]}),(s==null?void 0:s.type)!=="group"&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:F?"Online":I?`Last seen ${ne(I)}`:"Offline"})]})]})]}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(jt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})},[s,N,F,I,G,v,u,l,g]),ne=r=>{if(!r)return"Never";const h=r,L=Date.now()-h,A=Math.floor(L/6e4),M=Math.floor(A/60),U=Math.floor(M/24);return A<1?"Just now":A<60?`${A}m ago`:M<24?`${M}h ago`:U<7?`${U}d ago`:new Date(h).toLocaleDateString()};return!s||!d?e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-[#1f2128] items-center justify-center text-gray-400",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-4xl",children:"ðŸ’¬"})}),e.jsx("p",{children:"Select a conversation to start chatting"})]}):e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-[#1f2128]",children:[q,e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 scrollbar-hide",children:[S.length===0?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e.jsx("p",{children:"No messages yet. Start the conversation!"})}):S.map((r,h)=>{const $=h>0?S[h-1]:null,L=r.s===(t==null?void 0:t.uid),A=P(r.id),M=z(r.id);return e.jsx(hs,{message:r,isCurrentUser:L,previousMessage:$,currentUserId:t==null?void 0:t.uid,chatId:d,linkPreviewData:b[r.id],messageStatus:A?"read":M?"delivered":"sent",onReaction:U=>Z(r.id,U),onReply:()=>i(r),onEdit:()=>c(r),onDelete:U=>E(r.id,U),onForward:()=>w(r),onSeshNxLinkClick:U=>j({isOpen:!0,url:U,previewData:null}),onUserClick:()=>g==null?void 0:g({uid:r.s})},r.id)}),e.jsx("div",{ref:R})]}),e.jsx(cs,{onSend:J,replyingTo:k,editingMessage:m,onCancelReply:()=>i(null),onCancelEdit:()=>c(null)}),x&&e.jsx(gs,{message:x,conversations:n,onClose:()=>w(null),onForward:te}),f.isOpen&&e.jsx(us,{url:f.url,previewData:f.previewData,onClose:()=>j({isOpen:!1,url:"",previewData:null})})]})}function ys({chatId:t,onClose:a,onMediaSelect:s}){const[n,u]=o.useState([]),[l,g]=o.useState(!0),[b,y]=o.useState(null),[f,j]=o.useState("all");o.useEffect(()=>{if(!t||!W)return;const c=Ut(re(W,`messages/${t}`),Bt("t"),Ot(500)),x=qt(c,w=>{const R=w.val();if(R){const N=Object.entries(R).map(([v,F])=>({id:v,...F})).filter(v=>v.media&&!v.deleted&&!v.deletedForAll).map(v=>({id:v.id,...v.media,messageId:v.id,timestamp:v.t,sender:v.n})).sort((v,F)=>(v.timestamp||0)-(F.timestamp||0));u(N)}else u([]);g(!1)});return()=>x()},[t,W]);const k=f==="all"?n:n.filter(c=>f==="images"?c.type==="image":f==="videos"?c.type==="video":f==="audio"?c.type==="audio":f==="files"?c.type==="file":!0),i=c=>{y(c),s&&s(c)},m=c=>{const x=document.createElement("a");x.href=c.url,x.download=c.name||"download",x.target="_blank",document.body.appendChild(x),x.click(),document.body.removeChild(x)};return e.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:[e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0",children:[e.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Media Gallery"}),e.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:e.jsx(V,{size:20})})]}),e.jsx("div",{className:"p-3 border-b dark:border-gray-700 flex gap-2 overflow-x-auto scrollbar-hide shrink-0",children:[{key:"all",label:"All",icon:null},{key:"images",label:"Images",icon:Ce},{key:"videos",label:"Videos",icon:ye},{key:"audio",label:"Audio",icon:Se},{key:"files",label:"Files",icon:be}].map(c=>e.jsxs("button",{onClick:()=>j(c.key),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition ${f===c.key?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200"}`,children:[c.icon&&e.jsx(c.icon,{size:16}),c.label,e.jsxs("span",{className:"text-xs opacity-70",children:["(",k.filter(x=>c.key==="all"||x.type===c.key).length,")"]})]},c.key))}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:l?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-brand-blue border-t-transparent rounded-full animate-spin mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading media..."})]}):k.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[e.jsx(Ce,{size:48,className:"mb-4 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No media found"})]}):e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:k.map(c=>e.jsxs(D.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>i(c),className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 cursor-pointer group",children:[c.type==="image"?e.jsx("img",{src:c.url,alt:"Media",className:"w-full h-full object-cover"}):c.type==="video"?e.jsx("video",{src:c.url,className:"w-full h-full object-cover"}):c.type==="audio"?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-purple-100 dark:bg-purple-900/30",children:e.jsx(Se,{size:32,className:"text-purple-600 dark:text-purple-400"})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-blue-100 dark:bg-blue-900/30",children:e.jsx(be,{size:32,className:"text-blue-600 dark:text-blue-400"})}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition flex items-center justify-center",children:e.jsx(Fe,{size:20,className:"text-white opacity-0 group-hover:opacity-100 transition"})})]},c.id))})})]}),e.jsx(ie,{children:b&&e.jsx(js,{media:b,onClose:()=>y(null),onDownload:m})})]})}function js({media:t,onClose:a,onDownload:s}){const[n,u]=o.useState([]),[l,g]=o.useState(0);o.useEffect(()=>{u([t]),g(0)},[t]);const b=()=>{l<n.length-1&&g(l+1)},y=()=>{l>0&&g(l-1)},f=n[l]||t;return e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/95 z-[90] flex items-center justify-center",onClick:a,children:e.jsxs("div",{className:"relative max-w-7xl max-h-[90vh] w-full h-full flex items-center justify-center p-4",onClick:j=>j.stopPropagation(),children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 transition z-10",children:e.jsx(V,{size:24})}),f.type==="image"&&e.jsx("img",{src:f.url,alt:"Media",className:"max-w-full max-h-full object-contain rounded-lg"}),f.type==="video"&&e.jsx("video",{src:f.url,controls:!0,className:"max-w-full max-h-full rounded-lg",autoPlay:!0}),f.type==="audio"&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md",children:[e.jsx("div",{className:"w-32 h-32 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Se,{size:48,className:"text-purple-600 dark:text-purple-400"})}),e.jsx("audio",{src:f.url,controls:!0,className:"w-full",autoPlay:!0}),e.jsx("p",{className:"text-center mt-4 text-sm text-gray-500",children:f.name})]}),f.type==="file"&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md text-center",children:[e.jsx(be,{size:64,className:"text-blue-600 dark:text-blue-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-bold dark:text-white mb-2",children:f.name}),e.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-4 px-6 py-2 bg-brand-blue text-white rounded-lg hover:bg-blue-600 transition",children:"Open File"})]}),n.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:y,disabled:l===0,className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition",children:e.jsx(wt,{size:24})}),e.jsx("button",{onClick:b,disabled:l===n.length-1,className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition",children:e.jsx(Qe,{size:24})})]}),e.jsx("button",{onClick:()=>s(f),className:"absolute bottom-4 left-1/2 -translate-x-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 transition",children:e.jsx(Fe,{size:20})})]})})}function As({activeChat:t,onClose:a,currentUser:s}){const[n,u]=o.useState([]),[l,g]=o.useState({sessions:0,rating:0,responseTime:"N/A"}),[b,y]=o.useState(!0),[f,j]=o.useState(!1),[k,i]=o.useState(!1),m=t.type==="group",c=t.uid,x=t.name||t.n||"Unknown";o.useEffect(()=>{const d=async()=>{y(!0);try{if(u([]),!m&&c){const N=Ue(de,`artifacts/${T}/users/${c}/public_profile/main`),v=await Wt(N),F=v.exists()?v.data():{},I=Vt(de,`artifacts/${T}/public/data/bookings`),G=Re(I,ae("senderId","==",s.uid||""),ae("targetId","==",c),ae("status","==","Completed")),_=await Ht(G);g({sessions:_.data().count,rating:F.rating||"New",responseTime:F.responseTime||"~1hr"})}}catch(N){console.error("Failed to load details:",N)}y(!1)};t!=null&&t.id&&d()},[t.id,c,m,s==null?void 0:s.uid]);const w=async()=>{if(!(m||!c||!s)&&confirm(`Are you sure you want to block ${x}?`)){j(!0);try{const d=Ue(de,Xt(s.uid).userProfile);await Qt(d,{"settings.social.blockedUsers":Kt(c)}),alert("User blocked."),a()}catch(d){console.error("Block failed:",d),alert("Failed to block user.")}j(!1)}},R=()=>{alert("Please use the report option on their profile page for full moderation tools.")};return e.jsxs("div",{className:"absolute right-0 top-0 h-full w-full md:w-80 bg-gray-800 shadow-xl z-20 flex flex-col transition-transform duration-300 ease-in-out border-l border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-900",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Details"}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-full transition duration-150","aria-label":"Close details",children:e.jsx(V,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 flex flex-col items-center border-b border-gray-700 bg-gray-800",children:[e.jsxs("div",{className:"relative w-24 h-24 rounded-full overflow-hidden mb-4 bg-gray-700 flex items-center justify-center shadow-lg border-4 border-gray-600",children:[e.jsx("img",{src:t.photo,className:"w-full h-full object-cover",onError:d=>d.target.src="",alt:x}),!t.photo&&(m?e.jsx(he,{className:"w-10 h-10 text-gray-500"}):e.jsx(Ve,{className:"w-10 h-10 text-gray-500"}))]}),e.jsx("h4",{className:"text-xl font-bold text-white text-center leading-tight",children:x}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2 flex items-center px-3 py-1 bg-gray-700 rounded-full",children:[m?e.jsx(he,{className:"w-3 h-3 mr-1"}):e.jsx(Ge,{className:"w-3 h-3 mr-1"}),m?"Group Chat":t.role||"Creative"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:[!m&&e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase mb-3 tracking-wider",children:"Performance"}),b?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(oe,{className:"animate-spin text-brand-blue"})}):e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(we,{title:"Sessions",value:l.sessions,icon:Ge,color:"text-blue-400"}),e.jsx(we,{title:"Rating",value:l.rating,icon:_e,color:"text-yellow-400"}),e.jsx(we,{title:"Reply Time",value:l.responseTime,icon:Ae,color:"text-green-400"})]})]}),e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Shared Media"}),e.jsx("button",{onClick:()=>i(!0),className:"text-xs text-brand-blue hover:underline font-medium",children:"View All"})]}),n.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-2",children:n.slice(0,6).map((d,N)=>e.jsxs("div",{className:"aspect-square rounded-lg overflow-hidden bg-gray-700 cursor-pointer hover:opacity-80 transition",children:[d.type==="image"&&e.jsx("img",{src:d.url,className:"w-full h-full object-cover",alt:"Media"}),d.type==="video"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ye,{size:20,className:"text-gray-400"})})]},N))}):e.jsx("p",{className:"text-xs text-gray-500 text-center py-4",children:"No shared media yet"})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition",children:[e.jsx(Nt,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{children:"Mute Notifications"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition",children:[e.jsx(vt,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{children:"Media Gallery"})]}),!m&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:w,disabled:f,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition disabled:opacity-50",children:[f?e.jsx(oe,{className:"w-4 h-4 animate-spin"}):e.jsx(kt,{className:"w-4 h-4"}),e.jsx("span",{children:"Block User"})]}),e.jsxs("button",{onClick:R,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:"Report User"})]})]})]})]}),k&&e.jsx(ys,{chatId:t.id,onClose:()=>i(!1)})]})}export{Ms as C,we as S,ce as U,Ss as a,T as b,ue as c,de as d,Rs as e,H as f,Xt as g,$s as h,Ee as i,zs as j,As as k,Oe as s,ss as u};
