(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var FG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function UV(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var WV={exports:{}},Lw={},HV={exports:{}},Pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g0=Symbol.for("react.element"),$G=Symbol.for("react.portal"),BG=Symbol.for("react.fragment"),zG=Symbol.for("react.strict_mode"),UG=Symbol.for("react.profiler"),WG=Symbol.for("react.provider"),HG=Symbol.for("react.context"),qG=Symbol.for("react.forward_ref"),GG=Symbol.for("react.suspense"),KG=Symbol.for("react.memo"),QG=Symbol.for("react.lazy"),_P=Symbol.iterator;function ZG(t){return t===null||typeof t!="object"?null:(t=_P&&t[_P]||t["@@iterator"],typeof t=="function"?t:null)}var qV={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GV=Object.assign,KV={};function Em(t,e,n){this.props=t,this.context=e,this.refs=KV,this.updater=n||qV}Em.prototype.isReactComponent={};Em.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Em.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function QV(){}QV.prototype=Em.prototype;function YC(t,e,n){this.props=t,this.context=e,this.refs=KV,this.updater=n||qV}var XC=YC.prototype=new QV;XC.constructor=YC;GV(XC,Em.prototype);XC.isPureReactComponent=!0;var wP=Array.isArray,ZV=Object.prototype.hasOwnProperty,JC={current:null},YV={key:!0,ref:!0,__self:!0,__source:!0};function XV(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)ZV.call(e,r)&&!YV.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:g0,type:t,key:i,ref:o,props:s,_owner:JC.current}}function YG(t,e){return{$$typeof:g0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function e2(t){return typeof t=="object"&&t!==null&&t.$$typeof===g0}function XG(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var kP=/\/+/g;function Z1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?XG(""+t.key):e.toString(36)}function Hv(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case g0:case $G:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Z1(o,0):r,wP(s)?(n="",t!=null&&(n=t.replace(kP,"$&/")+"/"),Hv(s,e,n,"",function(d){return d})):s!=null&&(e2(s)&&(s=YG(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(kP,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",wP(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Z1(i,l);o+=Hv(i,e,n,c,s)}else if(c=ZG(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Z1(i,l++),o+=Hv(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Xx(t,e,n){if(t==null)return t;var r=[],s=0;return Hv(t,r,"","",function(i){return e.call(n,i,s++)}),r}function JG(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ps={current:null},qv={transition:null},eK={ReactCurrentDispatcher:Ps,ReactCurrentBatchConfig:qv,ReactCurrentOwner:JC};function JV(){throw Error("act(...) is not supported in production builds of React.")}Pt.Children={map:Xx,forEach:function(t,e,n){Xx(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Xx(t,function(){e++}),e},toArray:function(t){return Xx(t,function(e){return e})||[]},only:function(t){if(!e2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Pt.Component=Em;Pt.Fragment=BG;Pt.Profiler=UG;Pt.PureComponent=YC;Pt.StrictMode=zG;Pt.Suspense=GG;Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eK;Pt.act=JV;Pt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=GV({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=JC.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)ZV.call(e,c)&&!YV.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:g0,type:t.type,key:s,ref:i,props:r,_owner:o}};Pt.createContext=function(t){return t={$$typeof:HG,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:WG,_context:t},t.Consumer=t};Pt.createElement=XV;Pt.createFactory=function(t){var e=XV.bind(null,t);return e.type=t,e};Pt.createRef=function(){return{current:null}};Pt.forwardRef=function(t){return{$$typeof:qG,render:t}};Pt.isValidElement=e2;Pt.lazy=function(t){return{$$typeof:QG,_payload:{_status:-1,_result:t},_init:JG}};Pt.memo=function(t,e){return{$$typeof:KG,type:t,compare:e===void 0?null:e}};Pt.startTransition=function(t){var e=qv.transition;qv.transition={};try{t()}finally{qv.transition=e}};Pt.unstable_act=JV;Pt.useCallback=function(t,e){return Ps.current.useCallback(t,e)};Pt.useContext=function(t){return Ps.current.useContext(t)};Pt.useDebugValue=function(){};Pt.useDeferredValue=function(t){return Ps.current.useDeferredValue(t)};Pt.useEffect=function(t,e){return Ps.current.useEffect(t,e)};Pt.useId=function(){return Ps.current.useId()};Pt.useImperativeHandle=function(t,e,n){return Ps.current.useImperativeHandle(t,e,n)};Pt.useInsertionEffect=function(t,e){return Ps.current.useInsertionEffect(t,e)};Pt.useLayoutEffect=function(t,e){return Ps.current.useLayoutEffect(t,e)};Pt.useMemo=function(t,e){return Ps.current.useMemo(t,e)};Pt.useReducer=function(t,e,n){return Ps.current.useReducer(t,e,n)};Pt.useRef=function(t){return Ps.current.useRef(t)};Pt.useState=function(t){return Ps.current.useState(t)};Pt.useSyncExternalStore=function(t,e,n){return Ps.current.useSyncExternalStore(t,e,n)};Pt.useTransition=function(){return Ps.current.useTransition()};Pt.version="18.3.1";HV.exports=Pt;var N=HV.exports;const He=UV(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tK=N,nK=Symbol.for("react.element"),rK=Symbol.for("react.fragment"),sK=Object.prototype.hasOwnProperty,iK=tK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oK={key:!0,ref:!0,__self:!0,__source:!0};function e3(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)sK.call(e,r)&&!oK.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:nK,type:t,key:i,ref:o,props:s,_owner:iK.current}}Lw.Fragment=rK;Lw.jsx=e3;Lw.jsxs=e3;WV.exports=Lw;var a=WV.exports,DE={},t3={exports:{}},_i={},n3={exports:{}},r3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,Q){var H=q.length;q.push(Q);e:for(;0<H;){var X=H-1>>>1,oe=q[X];if(0<s(oe,Q))q[X]=Q,q[H]=oe,H=X;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var Q=q[0],H=q.pop();if(H!==Q){q[0]=H;e:for(var X=0,oe=q.length,ae=oe>>>1;X<ae;){var je=2*(X+1)-1,ge=q[je],te=je+1,be=q[te];if(0>s(ge,H))te<oe&&0>s(be,ge)?(q[X]=be,q[te]=H,X=te):(q[X]=ge,q[je]=H,X=je);else if(te<oe&&0>s(be,H))q[X]=be,q[te]=H,X=te;else break e}}return Q}function s(q,Q){var H=q.sortIndex-Q.sortIndex;return H!==0?H:q.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,m=null,p=3,v=!1,x=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(q){for(var Q=n(d);Q!==null;){if(Q.callback===null)r(d);else if(Q.startTime<=q)r(d),Q.sortIndex=Q.expirationTime,e(c,Q);else break;Q=n(d)}}function T(q){if(b=!1,S(q),!x)if(n(c)!==null)x=!0,ve(P);else{var Q=n(d);Q!==null&&le(T,Q.startTime-q)}}function P(q,Q){x=!1,b&&(b=!1,k(I),I=-1),v=!0;var H=p;try{for(S(Q),m=n(c);m!==null&&(!(m.expirationTime>Q)||q&&!F());){var X=m.callback;if(typeof X=="function"){m.callback=null,p=m.priorityLevel;var oe=X(m.expirationTime<=Q);Q=t.unstable_now(),typeof oe=="function"?m.callback=oe:m===n(c)&&r(c),S(Q)}else r(c);m=n(c)}if(m!==null)var ae=!0;else{var je=n(d);je!==null&&le(T,je.startTime-Q),ae=!1}return ae}finally{m=null,p=H,v=!1}}var j=!1,R=null,I=-1,O=5,D=-1;function F(){return!(t.unstable_now()-D<O)}function V(){if(R!==null){var q=t.unstable_now();D=q;var Q=!0;try{Q=R(!0,q)}finally{Q?$():(j=!1,R=null)}}else j=!1}var $;if(typeof _=="function")$=function(){_(V)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ue=J.port2;J.port1.onmessage=V,$=function(){ue.postMessage(null)}}else $=function(){E(V,0)};function ve(q){R=q,j||(j=!0,$())}function le(q,Q){I=E(function(){q(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){x||v||(x=!0,ve(P))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(q){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var H=p;p=Q;try{return q()}finally{p=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,Q){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var H=p;p=q;try{return Q()}finally{p=H}},t.unstable_scheduleCallback=function(q,Q,H){var X=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?X+H:X):H=X,q){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=H+oe,q={id:h++,callback:Q,priorityLevel:q,startTime:H,expirationTime:oe,sortIndex:-1},H>X?(q.sortIndex=H,e(d,q),n(c)===null&&q===n(d)&&(b?(k(I),I=-1):b=!0,le(T,H-X))):(q.sortIndex=oe,e(c,q),x||v||(x=!0,ve(P))),q},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(q){var Q=p;return function(){var H=p;p=Q;try{return q.apply(this,arguments)}finally{p=H}}}})(r3);n3.exports=r3;var aK=n3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lK=N,gi=aK;function xe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s3=new Set,ny={};function Ad(t,e){Af(t,e),Af(t+"Capture",e)}function Af(t,e){for(ny[t]=e,t=0;t<e.length;t++)s3.add(e[t])}var Ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),VE=Object.prototype.hasOwnProperty,cK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,NP={},EP={};function uK(t){return VE.call(EP,t)?!0:VE.call(NP,t)?!1:cK.test(t)?EP[t]=!0:(NP[t]=!0,!1)}function dK(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hK(t,e,n,r){if(e===null||typeof e>"u"||dK(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ls(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xr[t]=new Ls(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xr[e]=new Ls(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xr[t]=new Ls(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xr[t]=new Ls(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xr[t]=new Ls(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xr[t]=new Ls(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xr[t]=new Ls(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xr[t]=new Ls(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xr[t]=new Ls(t,5,!1,t.toLowerCase(),null,!1,!1)});var t2=/[\-:]([a-z])/g;function n2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(t2,n2);Xr[e]=new Ls(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(t2,n2);Xr[e]=new Ls(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(t2,n2);Xr[e]=new Ls(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xr[t]=new Ls(t,1,!1,t.toLowerCase(),null,!1,!1)});Xr.xlinkHref=new Ls("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xr[t]=new Ls(t,1,!1,t.toLowerCase(),null,!0,!0)});function r2(t,e,n,r){var s=Xr.hasOwnProperty(e)?Xr[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hK(e,n,s,r)&&(n=null),r||s===null?uK(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var cl=lK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jx=Symbol.for("react.element"),Uh=Symbol.for("react.portal"),Wh=Symbol.for("react.fragment"),s2=Symbol.for("react.strict_mode"),FE=Symbol.for("react.profiler"),i3=Symbol.for("react.provider"),o3=Symbol.for("react.context"),i2=Symbol.for("react.forward_ref"),$E=Symbol.for("react.suspense"),BE=Symbol.for("react.suspense_list"),o2=Symbol.for("react.memo"),Dl=Symbol.for("react.lazy"),a3=Symbol.for("react.offscreen"),SP=Symbol.iterator;function Cp(t){return t===null||typeof t!="object"?null:(t=SP&&t[SP]||t["@@iterator"],typeof t=="function"?t:null)}var Hn=Object.assign,Y1;function eg(t){if(Y1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Y1=e&&e[1]||""}return`
`+Y1+t}var X1=!1;function J1(t,e){if(!t||X1)return"";X1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{X1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?eg(t):""}function fK(t){switch(t.tag){case 5:return eg(t.type);case 16:return eg("Lazy");case 13:return eg("Suspense");case 19:return eg("SuspenseList");case 0:case 2:case 15:return t=J1(t.type,!1),t;case 11:return t=J1(t.type.render,!1),t;case 1:return t=J1(t.type,!0),t;default:return""}}function zE(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wh:return"Fragment";case Uh:return"Portal";case FE:return"Profiler";case s2:return"StrictMode";case $E:return"Suspense";case BE:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case o3:return(t.displayName||"Context")+".Consumer";case i3:return(t._context.displayName||"Context")+".Provider";case i2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case o2:return e=t.displayName||null,e!==null?e:zE(t.type)||"Memo";case Dl:e=t._payload,t=t._init;try{return zE(t(e))}catch{}}return null}function mK(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zE(e);case 8:return e===s2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function l3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function pK(t){var e=l3(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ev(t){t._valueTracker||(t._valueTracker=pK(t))}function c3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=l3(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Lb(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function UE(t,e){var n=e.checked;return Hn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function TP(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Sc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function u3(t,e){e=e.checked,e!=null&&r2(t,"checked",e,!1)}function WE(t,e){u3(t,e);var n=Sc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?HE(t,e.type,n):e.hasOwnProperty("defaultValue")&&HE(t,e.type,Sc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function CP(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function HE(t,e,n){(e!=="number"||Lb(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var tg=Array.isArray;function ff(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Sc(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function qE(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xe(91));return Hn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function IP(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(xe(92));if(tg(n)){if(1<n.length)throw Error(xe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Sc(n)}}function d3(t,e){var n=Sc(e.value),r=Sc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function jP(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function h3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function GE(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?h3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var tv,f3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(tv=tv||document.createElement("div"),tv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ry(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var kg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gK=["Webkit","ms","Moz","O"];Object.keys(kg).forEach(function(t){gK.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),kg[e]=kg[t]})});function m3(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||kg.hasOwnProperty(t)&&kg[t]?(""+e).trim():e+"px"}function p3(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=m3(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var yK=Hn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function KE(t,e){if(e){if(yK[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xe(62))}}function QE(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ZE=null;function a2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var YE=null,mf=null,pf=null;function AP(t){if(t=v0(t)){if(typeof YE!="function")throw Error(xe(280));var e=t.stateNode;e&&(e=Fw(e),YE(t.stateNode,t.type,e))}}function g3(t){mf?pf?pf.push(t):pf=[t]:mf=t}function y3(){if(mf){var t=mf,e=pf;if(pf=mf=null,AP(t),e)for(t=0;t<e.length;t++)AP(e[t])}}function x3(t,e){return t(e)}function v3(){}var eN=!1;function b3(t,e,n){if(eN)return t(e,n);eN=!0;try{return x3(t,e,n)}finally{eN=!1,(mf!==null||pf!==null)&&(v3(),y3())}}function sy(t,e){var n=t.stateNode;if(n===null)return null;var r=Fw(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(xe(231,e,typeof n));return n}var XE=!1;if(Ha)try{var Ip={};Object.defineProperty(Ip,"passive",{get:function(){XE=!0}}),window.addEventListener("test",Ip,Ip),window.removeEventListener("test",Ip,Ip)}catch{XE=!1}function xK(t,e,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Ng=!1,Mb=null,Ob=!1,JE=null,vK={onError:function(t){Ng=!0,Mb=t}};function bK(t,e,n,r,s,i,o,l,c){Ng=!1,Mb=null,xK.apply(vK,arguments)}function _K(t,e,n,r,s,i,o,l,c){if(bK.apply(this,arguments),Ng){if(Ng){var d=Mb;Ng=!1,Mb=null}else throw Error(xe(198));Ob||(Ob=!0,JE=d)}}function Rd(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function _3(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function RP(t){if(Rd(t)!==t)throw Error(xe(188))}function wK(t){var e=t.alternate;if(!e){if(e=Rd(t),e===null)throw Error(xe(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return RP(s),t;if(i===r)return RP(s),e;i=i.sibling}throw Error(xe(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(xe(189))}}if(n.alternate!==r)throw Error(xe(190))}if(n.tag!==3)throw Error(xe(188));return n.stateNode.current===n?t:e}function w3(t){return t=wK(t),t!==null?k3(t):null}function k3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=k3(t);if(e!==null)return e;t=t.sibling}return null}var N3=gi.unstable_scheduleCallback,PP=gi.unstable_cancelCallback,kK=gi.unstable_shouldYield,NK=gi.unstable_requestPaint,ar=gi.unstable_now,EK=gi.unstable_getCurrentPriorityLevel,l2=gi.unstable_ImmediatePriority,E3=gi.unstable_UserBlockingPriority,Db=gi.unstable_NormalPriority,SK=gi.unstable_LowPriority,S3=gi.unstable_IdlePriority,Mw=null,Fo=null;function TK(t){if(Fo&&typeof Fo.onCommitFiberRoot=="function")try{Fo.onCommitFiberRoot(Mw,t,void 0,(t.current.flags&128)===128)}catch{}}var mo=Math.clz32?Math.clz32:jK,CK=Math.log,IK=Math.LN2;function jK(t){return t>>>=0,t===0?32:31-(CK(t)/IK|0)|0}var nv=64,rv=4194304;function ng(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vb(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=ng(l):(i&=o,i!==0&&(r=ng(i)))}else o=n&~s,o!==0?r=ng(o):i!==0&&(r=ng(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-mo(e),s=1<<n,r|=t[n],e&=~s;return r}function AK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RK(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-mo(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=AK(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function eS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function T3(){var t=nv;return nv<<=1,!(nv&4194240)&&(nv=64),t}function tN(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function y0(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mo(e),t[e]=n}function PK(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-mo(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function c2(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-mo(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var rn=0;function C3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var I3,u2,j3,A3,R3,tS=!1,sv=[],oc=null,ac=null,lc=null,iy=new Map,oy=new Map,Bl=[],LK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LP(t,e){switch(t){case"focusin":case"focusout":oc=null;break;case"dragenter":case"dragleave":ac=null;break;case"mouseover":case"mouseout":lc=null;break;case"pointerover":case"pointerout":iy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":oy.delete(e.pointerId)}}function jp(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=v0(e),e!==null&&u2(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function MK(t,e,n,r,s){switch(e){case"focusin":return oc=jp(oc,t,e,n,r,s),!0;case"dragenter":return ac=jp(ac,t,e,n,r,s),!0;case"mouseover":return lc=jp(lc,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return iy.set(i,jp(iy.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,oy.set(i,jp(oy.get(i)||null,t,e,n,r,s)),!0}return!1}function P3(t){var e=Au(t.target);if(e!==null){var n=Rd(e);if(n!==null){if(e=n.tag,e===13){if(e=_3(n),e!==null){t.blockedOn=e,R3(t.priority,function(){j3(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Gv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=nS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ZE=r,n.target.dispatchEvent(r),ZE=null}else return e=v0(n),e!==null&&u2(e),t.blockedOn=n,!1;e.shift()}return!0}function MP(t,e,n){Gv(t)&&n.delete(e)}function OK(){tS=!1,oc!==null&&Gv(oc)&&(oc=null),ac!==null&&Gv(ac)&&(ac=null),lc!==null&&Gv(lc)&&(lc=null),iy.forEach(MP),oy.forEach(MP)}function Ap(t,e){t.blockedOn===e&&(t.blockedOn=null,tS||(tS=!0,gi.unstable_scheduleCallback(gi.unstable_NormalPriority,OK)))}function ay(t){function e(s){return Ap(s,t)}if(0<sv.length){Ap(sv[0],t);for(var n=1;n<sv.length;n++){var r=sv[n];r.blockedOn===t&&(r.blockedOn=null)}}for(oc!==null&&Ap(oc,t),ac!==null&&Ap(ac,t),lc!==null&&Ap(lc,t),iy.forEach(e),oy.forEach(e),n=0;n<Bl.length;n++)r=Bl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Bl.length&&(n=Bl[0],n.blockedOn===null);)P3(n),n.blockedOn===null&&Bl.shift()}var gf=cl.ReactCurrentBatchConfig,Fb=!0;function DK(t,e,n,r){var s=rn,i=gf.transition;gf.transition=null;try{rn=1,d2(t,e,n,r)}finally{rn=s,gf.transition=i}}function VK(t,e,n,r){var s=rn,i=gf.transition;gf.transition=null;try{rn=4,d2(t,e,n,r)}finally{rn=s,gf.transition=i}}function d2(t,e,n,r){if(Fb){var s=nS(t,e,n,r);if(s===null)dN(t,e,r,$b,n),LP(t,r);else if(MK(s,t,e,n,r))r.stopPropagation();else if(LP(t,r),e&4&&-1<LK.indexOf(t)){for(;s!==null;){var i=v0(s);if(i!==null&&I3(i),i=nS(t,e,n,r),i===null&&dN(t,e,r,$b,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else dN(t,e,r,null,n)}}var $b=null;function nS(t,e,n,r){if($b=null,t=a2(r),t=Au(t),t!==null)if(e=Rd(t),e===null)t=null;else if(n=e.tag,n===13){if(t=_3(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $b=t,null}function L3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(EK()){case l2:return 1;case E3:return 4;case Db:case SK:return 16;case S3:return 536870912;default:return 16}default:return 16}}var Yl=null,h2=null,Kv=null;function M3(){if(Kv)return Kv;var t,e=h2,n=e.length,r,s="value"in Yl?Yl.value:Yl.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Kv=s.slice(t,1<r?1-r:void 0)}function Qv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function iv(){return!0}function OP(){return!1}function wi(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?iv:OP,this.isPropagationStopped=OP,this}return Hn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=iv)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=iv)},persist:function(){},isPersistent:iv}),e}var Sm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f2=wi(Sm),x0=Hn({},Sm,{view:0,detail:0}),FK=wi(x0),nN,rN,Rp,Ow=Hn({},x0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:m2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Rp&&(Rp&&t.type==="mousemove"?(nN=t.screenX-Rp.screenX,rN=t.screenY-Rp.screenY):rN=nN=0,Rp=t),nN)},movementY:function(t){return"movementY"in t?t.movementY:rN}}),DP=wi(Ow),$K=Hn({},Ow,{dataTransfer:0}),BK=wi($K),zK=Hn({},x0,{relatedTarget:0}),sN=wi(zK),UK=Hn({},Sm,{animationName:0,elapsedTime:0,pseudoElement:0}),WK=wi(UK),HK=Hn({},Sm,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qK=wi(HK),GK=Hn({},Sm,{data:0}),VP=wi(GK),KK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function YK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ZK[t])?!!e[t]:!1}function m2(){return YK}var XK=Hn({},x0,{key:function(t){if(t.key){var e=KK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?QK[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:m2,charCode:function(t){return t.type==="keypress"?Qv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),JK=wi(XK),eQ=Hn({},Ow,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),FP=wi(eQ),tQ=Hn({},x0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:m2}),nQ=wi(tQ),rQ=Hn({},Sm,{propertyName:0,elapsedTime:0,pseudoElement:0}),sQ=wi(rQ),iQ=Hn({},Ow,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),oQ=wi(iQ),aQ=[9,13,27,32],p2=Ha&&"CompositionEvent"in window,Eg=null;Ha&&"documentMode"in document&&(Eg=document.documentMode);var lQ=Ha&&"TextEvent"in window&&!Eg,O3=Ha&&(!p2||Eg&&8<Eg&&11>=Eg),$P=" ",BP=!1;function D3(t,e){switch(t){case"keyup":return aQ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function V3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Hh=!1;function cQ(t,e){switch(t){case"compositionend":return V3(e);case"keypress":return e.which!==32?null:(BP=!0,$P);case"textInput":return t=e.data,t===$P&&BP?null:t;default:return null}}function uQ(t,e){if(Hh)return t==="compositionend"||!p2&&D3(t,e)?(t=M3(),Kv=h2=Yl=null,Hh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return O3&&e.locale!=="ko"?null:e.data;default:return null}}var dQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dQ[t.type]:e==="textarea"}function F3(t,e,n,r){g3(r),e=Bb(e,"onChange"),0<e.length&&(n=new f2("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Sg=null,ly=null;function hQ(t){Z3(t,0)}function Dw(t){var e=Kh(t);if(c3(e))return t}function fQ(t,e){if(t==="change")return e}var $3=!1;if(Ha){var iN;if(Ha){var oN="oninput"in document;if(!oN){var UP=document.createElement("div");UP.setAttribute("oninput","return;"),oN=typeof UP.oninput=="function"}iN=oN}else iN=!1;$3=iN&&(!document.documentMode||9<document.documentMode)}function WP(){Sg&&(Sg.detachEvent("onpropertychange",B3),ly=Sg=null)}function B3(t){if(t.propertyName==="value"&&Dw(ly)){var e=[];F3(e,ly,t,a2(t)),b3(hQ,e)}}function mQ(t,e,n){t==="focusin"?(WP(),Sg=e,ly=n,Sg.attachEvent("onpropertychange",B3)):t==="focusout"&&WP()}function pQ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dw(ly)}function gQ(t,e){if(t==="click")return Dw(e)}function yQ(t,e){if(t==="input"||t==="change")return Dw(e)}function xQ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vo=typeof Object.is=="function"?Object.is:xQ;function cy(t,e){if(vo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!VE.call(e,s)||!vo(t[s],e[s]))return!1}return!0}function HP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qP(t,e){var n=HP(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=HP(n)}}function z3(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?z3(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function U3(){for(var t=window,e=Lb();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Lb(t.document)}return e}function g2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function vQ(t){var e=U3(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&z3(n.ownerDocument.documentElement,n)){if(r!==null&&g2(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=qP(n,i);var o=qP(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var bQ=Ha&&"documentMode"in document&&11>=document.documentMode,qh=null,rS=null,Tg=null,sS=!1;function GP(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sS||qh==null||qh!==Lb(r)||(r=qh,"selectionStart"in r&&g2(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Tg&&cy(Tg,r)||(Tg=r,r=Bb(rS,"onSelect"),0<r.length&&(e=new f2("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=qh)))}function ov(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gh={animationend:ov("Animation","AnimationEnd"),animationiteration:ov("Animation","AnimationIteration"),animationstart:ov("Animation","AnimationStart"),transitionend:ov("Transition","TransitionEnd")},aN={},W3={};Ha&&(W3=document.createElement("div").style,"AnimationEvent"in window||(delete Gh.animationend.animation,delete Gh.animationiteration.animation,delete Gh.animationstart.animation),"TransitionEvent"in window||delete Gh.transitionend.transition);function Vw(t){if(aN[t])return aN[t];if(!Gh[t])return t;var e=Gh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in W3)return aN[t]=e[n];return t}var H3=Vw("animationend"),q3=Vw("animationiteration"),G3=Vw("animationstart"),K3=Vw("transitionend"),Q3=new Map,KP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qc(t,e){Q3.set(t,e),Ad(e,[t])}for(var lN=0;lN<KP.length;lN++){var cN=KP[lN],_Q=cN.toLowerCase(),wQ=cN[0].toUpperCase()+cN.slice(1);qc(_Q,"on"+wQ)}qc(H3,"onAnimationEnd");qc(q3,"onAnimationIteration");qc(G3,"onAnimationStart");qc("dblclick","onDoubleClick");qc("focusin","onFocus");qc("focusout","onBlur");qc(K3,"onTransitionEnd");Af("onMouseEnter",["mouseout","mouseover"]);Af("onMouseLeave",["mouseout","mouseover"]);Af("onPointerEnter",["pointerout","pointerover"]);Af("onPointerLeave",["pointerout","pointerover"]);Ad("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ad("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ad("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ad("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(rg));function QP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,_K(r,e,void 0,t),t.currentTarget=null}function Z3(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;QP(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;QP(s,l,d),i=c}}}if(Ob)throw t=JE,Ob=!1,JE=null,t}function wn(t,e){var n=e[cS];n===void 0&&(n=e[cS]=new Set);var r=t+"__bubble";n.has(r)||(Y3(e,t,2,!1),n.add(r))}function uN(t,e,n){var r=0;e&&(r|=4),Y3(n,t,r,e)}var av="_reactListening"+Math.random().toString(36).slice(2);function uy(t){if(!t[av]){t[av]=!0,s3.forEach(function(n){n!=="selectionchange"&&(kQ.has(n)||uN(n,!1,t),uN(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[av]||(e[av]=!0,uN("selectionchange",!1,e))}}function Y3(t,e,n,r){switch(L3(e)){case 1:var s=DK;break;case 4:s=VK;break;default:s=d2}n=s.bind(null,e,n,t),s=void 0,!XE||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function dN(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Au(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}b3(function(){var d=i,h=a2(n),m=[];e:{var p=Q3.get(t);if(p!==void 0){var v=f2,x=t;switch(t){case"keypress":if(Qv(n)===0)break e;case"keydown":case"keyup":v=JK;break;case"focusin":x="focus",v=sN;break;case"focusout":x="blur",v=sN;break;case"beforeblur":case"afterblur":v=sN;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=DP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=BK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=nQ;break;case H3:case q3:case G3:v=WK;break;case K3:v=sQ;break;case"scroll":v=FK;break;case"wheel":v=oQ;break;case"copy":case"cut":case"paste":v=qK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=FP}var b=(e&4)!==0,E=!b&&t==="scroll",k=b?p!==null?p+"Capture":null:p;b=[];for(var _=d,S;_!==null;){S=_;var T=S.stateNode;if(S.tag===5&&T!==null&&(S=T,k!==null&&(T=sy(_,k),T!=null&&b.push(dy(_,T,S)))),E)break;_=_.return}0<b.length&&(p=new v(p,x,null,n,h),m.push({event:p,listeners:b}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",p&&n!==ZE&&(x=n.relatedTarget||n.fromElement)&&(Au(x)||x[qa]))break e;if((v||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,v?(x=n.relatedTarget||n.toElement,v=d,x=x?Au(x):null,x!==null&&(E=Rd(x),x!==E||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=d),v!==x)){if(b=DP,T="onMouseLeave",k="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(b=FP,T="onPointerLeave",k="onPointerEnter",_="pointer"),E=v==null?p:Kh(v),S=x==null?p:Kh(x),p=new b(T,_+"leave",v,n,h),p.target=E,p.relatedTarget=S,T=null,Au(h)===d&&(b=new b(k,_+"enter",x,n,h),b.target=S,b.relatedTarget=E,T=b),E=T,v&&x)t:{for(b=v,k=x,_=0,S=b;S;S=wh(S))_++;for(S=0,T=k;T;T=wh(T))S++;for(;0<_-S;)b=wh(b),_--;for(;0<S-_;)k=wh(k),S--;for(;_--;){if(b===k||k!==null&&b===k.alternate)break t;b=wh(b),k=wh(k)}b=null}else b=null;v!==null&&ZP(m,p,v,b,!1),x!==null&&E!==null&&ZP(m,E,x,b,!0)}}e:{if(p=d?Kh(d):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var P=fQ;else if(zP(p))if($3)P=yQ;else{P=pQ;var j=mQ}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=gQ);if(P&&(P=P(t,d))){F3(m,P,n,h);break e}j&&j(t,p,d),t==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&HE(p,"number",p.value)}switch(j=d?Kh(d):window,t){case"focusin":(zP(j)||j.contentEditable==="true")&&(qh=j,rS=d,Tg=null);break;case"focusout":Tg=rS=qh=null;break;case"mousedown":sS=!0;break;case"contextmenu":case"mouseup":case"dragend":sS=!1,GP(m,n,h);break;case"selectionchange":if(bQ)break;case"keydown":case"keyup":GP(m,n,h)}var R;if(p2)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Hh?D3(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(O3&&n.locale!=="ko"&&(Hh||I!=="onCompositionStart"?I==="onCompositionEnd"&&Hh&&(R=M3()):(Yl=h,h2="value"in Yl?Yl.value:Yl.textContent,Hh=!0)),j=Bb(d,I),0<j.length&&(I=new VP(I,t,null,n,h),m.push({event:I,listeners:j}),R?I.data=R:(R=V3(n),R!==null&&(I.data=R)))),(R=lQ?cQ(t,n):uQ(t,n))&&(d=Bb(d,"onBeforeInput"),0<d.length&&(h=new VP("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=R))}Z3(m,e)})}function dy(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Bb(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=sy(t,n),i!=null&&r.unshift(dy(t,i,s)),i=sy(t,e),i!=null&&r.push(dy(t,i,s))),t=t.return}return r}function wh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ZP(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=sy(n,i),c!=null&&o.unshift(dy(n,c,l))):s||(c=sy(n,i),c!=null&&o.push(dy(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var NQ=/\r\n?/g,EQ=/\u0000|\uFFFD/g;function YP(t){return(typeof t=="string"?t:""+t).replace(NQ,`
`).replace(EQ,"")}function lv(t,e,n){if(e=YP(e),YP(t)!==e&&n)throw Error(xe(425))}function zb(){}var iS=null,oS=null;function aS(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lS=typeof setTimeout=="function"?setTimeout:void 0,SQ=typeof clearTimeout=="function"?clearTimeout:void 0,XP=typeof Promise=="function"?Promise:void 0,TQ=typeof queueMicrotask=="function"?queueMicrotask:typeof XP<"u"?function(t){return XP.resolve(null).then(t).catch(CQ)}:lS;function CQ(t){setTimeout(function(){throw t})}function hN(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ay(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ay(e)}function cc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function JP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Tm=Math.random().toString(36).slice(2),Ao="__reactFiber$"+Tm,hy="__reactProps$"+Tm,qa="__reactContainer$"+Tm,cS="__reactEvents$"+Tm,IQ="__reactListeners$"+Tm,jQ="__reactHandles$"+Tm;function Au(t){var e=t[Ao];if(e)return e;for(var n=t.parentNode;n;){if(e=n[qa]||n[Ao]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=JP(t);t!==null;){if(n=t[Ao])return n;t=JP(t)}return e}t=n,n=t.parentNode}return null}function v0(t){return t=t[Ao]||t[qa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Kh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(xe(33))}function Fw(t){return t[hy]||null}var uS=[],Qh=-1;function Gc(t){return{current:t}}function Sn(t){0>Qh||(t.current=uS[Qh],uS[Qh]=null,Qh--)}function bn(t,e){Qh++,uS[Qh]=t.current,t.current=e}var Tc={},ys=Gc(Tc),qs=Gc(!1),ed=Tc;function Rf(t,e){var n=t.type.contextTypes;if(!n)return Tc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Gs(t){return t=t.childContextTypes,t!=null}function Ub(){Sn(qs),Sn(ys)}function eL(t,e,n){if(ys.current!==Tc)throw Error(xe(168));bn(ys,e),bn(qs,n)}function X3(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(xe(108,mK(t)||"Unknown",s));return Hn({},n,r)}function Wb(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Tc,ed=ys.current,bn(ys,t),bn(qs,qs.current),!0}function tL(t,e,n){var r=t.stateNode;if(!r)throw Error(xe(169));n?(t=X3(t,e,ed),r.__reactInternalMemoizedMergedChildContext=t,Sn(qs),Sn(ys),bn(ys,t)):Sn(qs),bn(qs,n)}var Ta=null,$w=!1,fN=!1;function J3(t){Ta===null?Ta=[t]:Ta.push(t)}function AQ(t){$w=!0,J3(t)}function Kc(){if(!fN&&Ta!==null){fN=!0;var t=0,e=rn;try{var n=Ta;for(rn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ta=null,$w=!1}catch(s){throw Ta!==null&&(Ta=Ta.slice(t+1)),N3(l2,Kc),s}finally{rn=e,fN=!1}}return null}var Zh=[],Yh=0,Hb=null,qb=0,Pi=[],Li=0,td=null,ja=1,Aa="";function vu(t,e){Zh[Yh++]=qb,Zh[Yh++]=Hb,Hb=t,qb=e}function eF(t,e,n){Pi[Li++]=ja,Pi[Li++]=Aa,Pi[Li++]=td,td=t;var r=ja;t=Aa;var s=32-mo(r)-1;r&=~(1<<s),n+=1;var i=32-mo(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ja=1<<32-mo(e)+s|n<<s|r,Aa=i+t}else ja=1<<i|n<<s|r,Aa=t}function y2(t){t.return!==null&&(vu(t,1),eF(t,1,0))}function x2(t){for(;t===Hb;)Hb=Zh[--Yh],Zh[Yh]=null,qb=Zh[--Yh],Zh[Yh]=null;for(;t===td;)td=Pi[--Li],Pi[Li]=null,Aa=Pi[--Li],Pi[Li]=null,ja=Pi[--Li],Pi[Li]=null}var di=null,ai=null,Pn=!1,oo=null;function tF(t,e){var n=Vi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nL(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,di=t,ai=cc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,di=t,ai=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=td!==null?{id:ja,overflow:Aa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,di=t,ai=null,!0):!1;default:return!1}}function dS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hS(t){if(Pn){var e=ai;if(e){var n=e;if(!nL(t,e)){if(dS(t))throw Error(xe(418));e=cc(n.nextSibling);var r=di;e&&nL(t,e)?tF(r,n):(t.flags=t.flags&-4097|2,Pn=!1,di=t)}}else{if(dS(t))throw Error(xe(418));t.flags=t.flags&-4097|2,Pn=!1,di=t}}}function rL(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;di=t}function cv(t){if(t!==di)return!1;if(!Pn)return rL(t),Pn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!aS(t.type,t.memoizedProps)),e&&(e=ai)){if(dS(t))throw nF(),Error(xe(418));for(;e;)tF(t,e),e=cc(e.nextSibling)}if(rL(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(xe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ai=cc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ai=null}}else ai=di?cc(t.stateNode.nextSibling):null;return!0}function nF(){for(var t=ai;t;)t=cc(t.nextSibling)}function Pf(){ai=di=null,Pn=!1}function v2(t){oo===null?oo=[t]:oo.push(t)}var RQ=cl.ReactCurrentBatchConfig;function Pp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(xe(309));var r=n.stateNode}if(!r)throw Error(xe(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(xe(284));if(!n._owner)throw Error(xe(290,t))}return t}function uv(t,e){throw t=Object.prototype.toString.call(e),Error(xe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sL(t){var e=t._init;return e(t._payload)}function rF(t){function e(k,_){if(t){var S=k.deletions;S===null?(k.deletions=[_],k.flags|=16):S.push(_)}}function n(k,_){if(!t)return null;for(;_!==null;)e(k,_),_=_.sibling;return null}function r(k,_){for(k=new Map;_!==null;)_.key!==null?k.set(_.key,_):k.set(_.index,_),_=_.sibling;return k}function s(k,_){return k=fc(k,_),k.index=0,k.sibling=null,k}function i(k,_,S){return k.index=S,t?(S=k.alternate,S!==null?(S=S.index,S<_?(k.flags|=2,_):S):(k.flags|=2,_)):(k.flags|=1048576,_)}function o(k){return t&&k.alternate===null&&(k.flags|=2),k}function l(k,_,S,T){return _===null||_.tag!==6?(_=bN(S,k.mode,T),_.return=k,_):(_=s(_,S),_.return=k,_)}function c(k,_,S,T){var P=S.type;return P===Wh?h(k,_,S.props.children,T,S.key):_!==null&&(_.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Dl&&sL(P)===_.type)?(T=s(_,S.props),T.ref=Pp(k,_,S),T.return=k,T):(T=nb(S.type,S.key,S.props,null,k.mode,T),T.ref=Pp(k,_,S),T.return=k,T)}function d(k,_,S,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=_N(S,k.mode,T),_.return=k,_):(_=s(_,S.children||[]),_.return=k,_)}function h(k,_,S,T,P){return _===null||_.tag!==7?(_=zu(S,k.mode,T,P),_.return=k,_):(_=s(_,S),_.return=k,_)}function m(k,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=bN(""+_,k.mode,S),_.return=k,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Jx:return S=nb(_.type,_.key,_.props,null,k.mode,S),S.ref=Pp(k,null,_),S.return=k,S;case Uh:return _=_N(_,k.mode,S),_.return=k,_;case Dl:var T=_._init;return m(k,T(_._payload),S)}if(tg(_)||Cp(_))return _=zu(_,k.mode,S,null),_.return=k,_;uv(k,_)}return null}function p(k,_,S,T){var P=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return P!==null?null:l(k,_,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Jx:return S.key===P?c(k,_,S,T):null;case Uh:return S.key===P?d(k,_,S,T):null;case Dl:return P=S._init,p(k,_,P(S._payload),T)}if(tg(S)||Cp(S))return P!==null?null:h(k,_,S,T,null);uv(k,S)}return null}function v(k,_,S,T,P){if(typeof T=="string"&&T!==""||typeof T=="number")return k=k.get(S)||null,l(_,k,""+T,P);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Jx:return k=k.get(T.key===null?S:T.key)||null,c(_,k,T,P);case Uh:return k=k.get(T.key===null?S:T.key)||null,d(_,k,T,P);case Dl:var j=T._init;return v(k,_,S,j(T._payload),P)}if(tg(T)||Cp(T))return k=k.get(S)||null,h(_,k,T,P,null);uv(_,T)}return null}function x(k,_,S,T){for(var P=null,j=null,R=_,I=_=0,O=null;R!==null&&I<S.length;I++){R.index>I?(O=R,R=null):O=R.sibling;var D=p(k,R,S[I],T);if(D===null){R===null&&(R=O);break}t&&R&&D.alternate===null&&e(k,R),_=i(D,_,I),j===null?P=D:j.sibling=D,j=D,R=O}if(I===S.length)return n(k,R),Pn&&vu(k,I),P;if(R===null){for(;I<S.length;I++)R=m(k,S[I],T),R!==null&&(_=i(R,_,I),j===null?P=R:j.sibling=R,j=R);return Pn&&vu(k,I),P}for(R=r(k,R);I<S.length;I++)O=v(R,k,I,S[I],T),O!==null&&(t&&O.alternate!==null&&R.delete(O.key===null?I:O.key),_=i(O,_,I),j===null?P=O:j.sibling=O,j=O);return t&&R.forEach(function(F){return e(k,F)}),Pn&&vu(k,I),P}function b(k,_,S,T){var P=Cp(S);if(typeof P!="function")throw Error(xe(150));if(S=P.call(S),S==null)throw Error(xe(151));for(var j=P=null,R=_,I=_=0,O=null,D=S.next();R!==null&&!D.done;I++,D=S.next()){R.index>I?(O=R,R=null):O=R.sibling;var F=p(k,R,D.value,T);if(F===null){R===null&&(R=O);break}t&&R&&F.alternate===null&&e(k,R),_=i(F,_,I),j===null?P=F:j.sibling=F,j=F,R=O}if(D.done)return n(k,R),Pn&&vu(k,I),P;if(R===null){for(;!D.done;I++,D=S.next())D=m(k,D.value,T),D!==null&&(_=i(D,_,I),j===null?P=D:j.sibling=D,j=D);return Pn&&vu(k,I),P}for(R=r(k,R);!D.done;I++,D=S.next())D=v(R,k,I,D.value,T),D!==null&&(t&&D.alternate!==null&&R.delete(D.key===null?I:D.key),_=i(D,_,I),j===null?P=D:j.sibling=D,j=D);return t&&R.forEach(function(V){return e(k,V)}),Pn&&vu(k,I),P}function E(k,_,S,T){if(typeof S=="object"&&S!==null&&S.type===Wh&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Jx:e:{for(var P=S.key,j=_;j!==null;){if(j.key===P){if(P=S.type,P===Wh){if(j.tag===7){n(k,j.sibling),_=s(j,S.props.children),_.return=k,k=_;break e}}else if(j.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Dl&&sL(P)===j.type){n(k,j.sibling),_=s(j,S.props),_.ref=Pp(k,j,S),_.return=k,k=_;break e}n(k,j);break}else e(k,j);j=j.sibling}S.type===Wh?(_=zu(S.props.children,k.mode,T,S.key),_.return=k,k=_):(T=nb(S.type,S.key,S.props,null,k.mode,T),T.ref=Pp(k,_,S),T.return=k,k=T)}return o(k);case Uh:e:{for(j=S.key;_!==null;){if(_.key===j)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(k,_.sibling),_=s(_,S.children||[]),_.return=k,k=_;break e}else{n(k,_);break}else e(k,_);_=_.sibling}_=_N(S,k.mode,T),_.return=k,k=_}return o(k);case Dl:return j=S._init,E(k,_,j(S._payload),T)}if(tg(S))return x(k,_,S,T);if(Cp(S))return b(k,_,S,T);uv(k,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(k,_.sibling),_=s(_,S),_.return=k,k=_):(n(k,_),_=bN(S,k.mode,T),_.return=k,k=_),o(k)):n(k,_)}return E}var Lf=rF(!0),sF=rF(!1),Gb=Gc(null),Kb=null,Xh=null,b2=null;function _2(){b2=Xh=Kb=null}function w2(t){var e=Gb.current;Sn(Gb),t._currentValue=e}function fS(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function yf(t,e){Kb=t,b2=Xh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bs=!0),t.firstContext=null)}function Wi(t){var e=t._currentValue;if(b2!==t)if(t={context:t,memoizedValue:e,next:null},Xh===null){if(Kb===null)throw Error(xe(308));Xh=t,Kb.dependencies={lanes:0,firstContext:t}}else Xh=Xh.next=t;return e}var Ru=null;function k2(t){Ru===null?Ru=[t]:Ru.push(t)}function iF(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,k2(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ga(t,r)}function Ga(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vl=!1;function N2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oF(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function uc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ut&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ga(t,n)}return s=r.interleaved,s===null?(e.next=e,k2(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ga(t,n)}function Zv(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,c2(t,n)}}function iL(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qb(t,e,n,r){var s=t.updateQueue;Vl=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,h=d=c=null,l=i;do{var p=l.lane,v=l.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,b=l;switch(p=e,v=n,b.tag){case 1:if(x=b.payload,typeof x=="function"){m=x.call(v,m,p);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,p=typeof x=="function"?x.call(v,m,p):x,p==null)break e;m=Hn({},m,p);break e;case 2:Vl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else v={eventTime:v,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=v,c=m):h=h.next=v,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);rd|=o,t.lanes=o,t.memoizedState=m}}function oL(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(xe(191,s));s.call(r)}}}var b0={},$o=Gc(b0),fy=Gc(b0),my=Gc(b0);function Pu(t){if(t===b0)throw Error(xe(174));return t}function E2(t,e){switch(bn(my,e),bn(fy,t),bn($o,b0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:GE(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=GE(e,t)}Sn($o),bn($o,e)}function Mf(){Sn($o),Sn(fy),Sn(my)}function aF(t){Pu(my.current);var e=Pu($o.current),n=GE(e,t.type);e!==n&&(bn(fy,t),bn($o,n))}function S2(t){fy.current===t&&(Sn($o),Sn(fy))}var Vn=Gc(0);function Zb(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mN=[];function T2(){for(var t=0;t<mN.length;t++)mN[t]._workInProgressVersionPrimary=null;mN.length=0}var Yv=cl.ReactCurrentDispatcher,pN=cl.ReactCurrentBatchConfig,nd=0,zn=null,br=null,Lr=null,Yb=!1,Cg=!1,py=0,PQ=0;function ts(){throw Error(xe(321))}function C2(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!vo(t[n],e[n]))return!1;return!0}function I2(t,e,n,r,s,i){if(nd=i,zn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yv.current=t===null||t.memoizedState===null?DQ:VQ,t=n(r,s),Cg){i=0;do{if(Cg=!1,py=0,25<=i)throw Error(xe(301));i+=1,Lr=br=null,e.updateQueue=null,Yv.current=FQ,t=n(r,s)}while(Cg)}if(Yv.current=Xb,e=br!==null&&br.next!==null,nd=0,Lr=br=zn=null,Yb=!1,e)throw Error(xe(300));return t}function j2(){var t=py!==0;return py=0,t}function jo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lr===null?zn.memoizedState=Lr=t:Lr=Lr.next=t,Lr}function Hi(){if(br===null){var t=zn.alternate;t=t!==null?t.memoizedState:null}else t=br.next;var e=Lr===null?zn.memoizedState:Lr.next;if(e!==null)Lr=e,br=t;else{if(t===null)throw Error(xe(310));br=t,t={memoizedState:br.memoizedState,baseState:br.baseState,baseQueue:br.baseQueue,queue:br.queue,next:null},Lr===null?zn.memoizedState=Lr=t:Lr=Lr.next=t}return Lr}function gy(t,e){return typeof e=="function"?e(t):e}function gN(t){var e=Hi(),n=e.queue;if(n===null)throw Error(xe(311));n.lastRenderedReducer=t;var r=br,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var h=d.lane;if((nd&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,zn.lanes|=h,rd|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,vo(r,e.memoizedState)||(Bs=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,zn.lanes|=i,rd|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function yN(t){var e=Hi(),n=e.queue;if(n===null)throw Error(xe(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);vo(i,e.memoizedState)||(Bs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function lF(){}function cF(t,e){var n=zn,r=Hi(),s=e(),i=!vo(r.memoizedState,s);if(i&&(r.memoizedState=s,Bs=!0),r=r.queue,A2(hF.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Lr!==null&&Lr.memoizedState.tag&1){if(n.flags|=2048,yy(9,dF.bind(null,n,r,s,e),void 0,null),Vr===null)throw Error(xe(349));nd&30||uF(n,e,s)}return s}function uF(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function dF(t,e,n,r){e.value=n,e.getSnapshot=r,fF(e)&&mF(t)}function hF(t,e,n){return n(function(){fF(e)&&mF(t)})}function fF(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!vo(t,n)}catch{return!0}}function mF(t){var e=Ga(t,1);e!==null&&po(e,t,1,-1)}function aL(t){var e=jo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gy,lastRenderedState:t},e.queue=t,t=t.dispatch=OQ.bind(null,zn,t),[e.memoizedState,t]}function yy(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function pF(){return Hi().memoizedState}function Xv(t,e,n,r){var s=jo();zn.flags|=t,s.memoizedState=yy(1|e,n,void 0,r===void 0?null:r)}function Bw(t,e,n,r){var s=Hi();r=r===void 0?null:r;var i=void 0;if(br!==null){var o=br.memoizedState;if(i=o.destroy,r!==null&&C2(r,o.deps)){s.memoizedState=yy(e,n,i,r);return}}zn.flags|=t,s.memoizedState=yy(1|e,n,i,r)}function lL(t,e){return Xv(8390656,8,t,e)}function A2(t,e){return Bw(2048,8,t,e)}function gF(t,e){return Bw(4,2,t,e)}function yF(t,e){return Bw(4,4,t,e)}function xF(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function vF(t,e,n){return n=n!=null?n.concat([t]):null,Bw(4,4,xF.bind(null,e,t),n)}function R2(){}function bF(t,e){var n=Hi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&C2(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function _F(t,e){var n=Hi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&C2(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function wF(t,e,n){return nd&21?(vo(n,e)||(n=T3(),zn.lanes|=n,rd|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bs=!0),t.memoizedState=n)}function LQ(t,e){var n=rn;rn=n!==0&&4>n?n:4,t(!0);var r=pN.transition;pN.transition={};try{t(!1),e()}finally{rn=n,pN.transition=r}}function kF(){return Hi().memoizedState}function MQ(t,e,n){var r=hc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},NF(t))EF(e,n);else if(n=iF(t,e,n,r),n!==null){var s=Cs();po(n,t,r,s),SF(n,e,r)}}function OQ(t,e,n){var r=hc(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(NF(t))EF(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,vo(l,o)){var c=e.interleaved;c===null?(s.next=s,k2(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=iF(t,e,s,r),n!==null&&(s=Cs(),po(n,t,r,s),SF(n,e,r))}}function NF(t){var e=t.alternate;return t===zn||e!==null&&e===zn}function EF(t,e){Cg=Yb=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function SF(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,c2(t,n)}}var Xb={readContext:Wi,useCallback:ts,useContext:ts,useEffect:ts,useImperativeHandle:ts,useInsertionEffect:ts,useLayoutEffect:ts,useMemo:ts,useReducer:ts,useRef:ts,useState:ts,useDebugValue:ts,useDeferredValue:ts,useTransition:ts,useMutableSource:ts,useSyncExternalStore:ts,useId:ts,unstable_isNewReconciler:!1},DQ={readContext:Wi,useCallback:function(t,e){return jo().memoizedState=[t,e===void 0?null:e],t},useContext:Wi,useEffect:lL,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Xv(4194308,4,xF.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Xv(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xv(4,2,t,e)},useMemo:function(t,e){var n=jo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=MQ.bind(null,zn,t),[r.memoizedState,t]},useRef:function(t){var e=jo();return t={current:t},e.memoizedState=t},useState:aL,useDebugValue:R2,useDeferredValue:function(t){return jo().memoizedState=t},useTransition:function(){var t=aL(!1),e=t[0];return t=LQ.bind(null,t[1]),jo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=zn,s=jo();if(Pn){if(n===void 0)throw Error(xe(407));n=n()}else{if(n=e(),Vr===null)throw Error(xe(349));nd&30||uF(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,lL(hF.bind(null,r,i,t),[t]),r.flags|=2048,yy(9,dF.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=jo(),e=Vr.identifierPrefix;if(Pn){var n=Aa,r=ja;n=(r&~(1<<32-mo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=py++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=PQ++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},VQ={readContext:Wi,useCallback:bF,useContext:Wi,useEffect:A2,useImperativeHandle:vF,useInsertionEffect:gF,useLayoutEffect:yF,useMemo:_F,useReducer:gN,useRef:pF,useState:function(){return gN(gy)},useDebugValue:R2,useDeferredValue:function(t){var e=Hi();return wF(e,br.memoizedState,t)},useTransition:function(){var t=gN(gy)[0],e=Hi().memoizedState;return[t,e]},useMutableSource:lF,useSyncExternalStore:cF,useId:kF,unstable_isNewReconciler:!1},FQ={readContext:Wi,useCallback:bF,useContext:Wi,useEffect:A2,useImperativeHandle:vF,useInsertionEffect:gF,useLayoutEffect:yF,useMemo:_F,useReducer:yN,useRef:pF,useState:function(){return yN(gy)},useDebugValue:R2,useDeferredValue:function(t){var e=Hi();return br===null?e.memoizedState=t:wF(e,br.memoizedState,t)},useTransition:function(){var t=yN(gy)[0],e=Hi().memoizedState;return[t,e]},useMutableSource:lF,useSyncExternalStore:cF,useId:kF,unstable_isNewReconciler:!1};function so(t,e){if(t&&t.defaultProps){e=Hn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function mS(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Hn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zw={isMounted:function(t){return(t=t._reactInternals)?Rd(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Cs(),s=hc(t),i=Fa(r,s);i.payload=e,n!=null&&(i.callback=n),e=uc(t,i,s),e!==null&&(po(e,t,s,r),Zv(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Cs(),s=hc(t),i=Fa(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=uc(t,i,s),e!==null&&(po(e,t,s,r),Zv(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Cs(),r=hc(t),s=Fa(n,r);s.tag=2,e!=null&&(s.callback=e),e=uc(t,s,r),e!==null&&(po(e,t,r,n),Zv(e,t,r))}};function cL(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!cy(n,r)||!cy(s,i):!0}function TF(t,e,n){var r=!1,s=Tc,i=e.contextType;return typeof i=="object"&&i!==null?i=Wi(i):(s=Gs(e)?ed:ys.current,r=e.contextTypes,i=(r=r!=null)?Rf(t,s):Tc),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zw,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function uL(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&zw.enqueueReplaceState(e,e.state,null)}function pS(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},N2(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Wi(i):(i=Gs(e)?ed:ys.current,s.context=Rf(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(mS(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&zw.enqueueReplaceState(s,s.state,null),Qb(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Of(t,e){try{var n="",r=e;do n+=fK(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function xN(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function gS(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var $Q=typeof WeakMap=="function"?WeakMap:Map;function CF(t,e,n){n=Fa(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){e_||(e_=!0,SS=r),gS(t,e)},n}function IF(t,e,n){n=Fa(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){gS(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){gS(t,e),typeof r!="function"&&(dc===null?dc=new Set([this]):dc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dL(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new $Q;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=eZ.bind(null,t,e,n),e.then(t,t))}function hL(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fL(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fa(-1,1),e.tag=2,uc(n,e,1))),n.lanes|=1),t)}var BQ=cl.ReactCurrentOwner,Bs=!1;function Ns(t,e,n,r){e.child=t===null?sF(e,null,n,r):Lf(e,t.child,n,r)}function mL(t,e,n,r,s){n=n.render;var i=e.ref;return yf(e,s),r=I2(t,e,n,r,i,s),n=j2(),t!==null&&!Bs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ka(t,e,s)):(Pn&&n&&y2(e),e.flags|=1,Ns(t,e,r,s),e.child)}function pL(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!$2(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,jF(t,e,i,r,s)):(t=nb(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:cy,n(o,r)&&t.ref===e.ref)return Ka(t,e,s)}return e.flags|=1,t=fc(i,r),t.ref=e.ref,t.return=e,e.child=t}function jF(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(cy(i,r)&&t.ref===e.ref)if(Bs=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Bs=!0);else return e.lanes=t.lanes,Ka(t,e,s)}return yS(t,e,n,r,s)}function AF(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},bn(ef,ri),ri|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,bn(ef,ri),ri|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,bn(ef,ri),ri|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,bn(ef,ri),ri|=r;return Ns(t,e,s,n),e.child}function RF(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function yS(t,e,n,r,s){var i=Gs(n)?ed:ys.current;return i=Rf(e,i),yf(e,s),n=I2(t,e,n,r,i,s),r=j2(),t!==null&&!Bs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ka(t,e,s)):(Pn&&r&&y2(e),e.flags|=1,Ns(t,e,n,s),e.child)}function gL(t,e,n,r,s){if(Gs(n)){var i=!0;Wb(e)}else i=!1;if(yf(e,s),e.stateNode===null)Jv(t,e),TF(e,n,r),pS(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Wi(d):(d=Gs(n)?ed:ys.current,d=Rf(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&uL(e,o,r,d),Vl=!1;var p=e.memoizedState;o.state=p,Qb(e,r,o,s),c=e.memoizedState,l!==r||p!==c||qs.current||Vl?(typeof h=="function"&&(mS(e,n,h,r),c=e.memoizedState),(l=Vl||cL(e,n,l,r,p,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,oF(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:so(e.type,l),o.props=d,m=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Wi(c):(c=Gs(n)?ed:ys.current,c=Rf(e,c));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||p!==c)&&uL(e,o,r,c),Vl=!1,p=e.memoizedState,o.state=p,Qb(e,r,o,s);var x=e.memoizedState;l!==m||p!==x||qs.current||Vl?(typeof v=="function"&&(mS(e,n,v,r),x=e.memoizedState),(d=Vl||cL(e,n,d,r,p,x,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return xS(t,e,n,r,i,s)}function xS(t,e,n,r,s,i){RF(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&tL(e,n,!1),Ka(t,e,i);r=e.stateNode,BQ.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Lf(e,t.child,null,i),e.child=Lf(e,null,l,i)):Ns(t,e,l,i),e.memoizedState=r.state,s&&tL(e,n,!0),e.child}function PF(t){var e=t.stateNode;e.pendingContext?eL(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eL(t,e.context,!1),E2(t,e.containerInfo)}function yL(t,e,n,r,s){return Pf(),v2(s),e.flags|=256,Ns(t,e,n,r),e.child}var vS={dehydrated:null,treeContext:null,retryLane:0};function bS(t){return{baseLanes:t,cachePool:null,transitions:null}}function LF(t,e,n){var r=e.pendingProps,s=Vn.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),bn(Vn,s&1),t===null)return hS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Hw(o,r,0,null),t=zu(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=bS(n),e.memoizedState=vS,t):P2(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return zQ(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=fc(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=fc(l,i):(i=zu(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?bS(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=vS,r}return i=t.child,t=i.sibling,r=fc(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function P2(t,e){return e=Hw({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function dv(t,e,n,r){return r!==null&&v2(r),Lf(e,t.child,null,n),t=P2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function zQ(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=xN(Error(xe(422))),dv(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Hw({mode:"visible",children:r.children},s,0,null),i=zu(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Lf(e,t.child,null,o),e.child.memoizedState=bS(o),e.memoizedState=vS,i);if(!(e.mode&1))return dv(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(xe(419)),r=xN(i,r,void 0),dv(t,e,o,r)}if(l=(o&t.childLanes)!==0,Bs||l){if(r=Vr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ga(t,s),po(r,t,s,-1))}return F2(),r=xN(Error(xe(421))),dv(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=tZ.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,ai=cc(s.nextSibling),di=e,Pn=!0,oo=null,t!==null&&(Pi[Li++]=ja,Pi[Li++]=Aa,Pi[Li++]=td,ja=t.id,Aa=t.overflow,td=e),e=P2(e,r.children),e.flags|=4096,e)}function xL(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),fS(t.return,e,n)}function vN(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function MF(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ns(t,e,r.children,n),r=Vn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xL(t,n,e);else if(t.tag===19)xL(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(bn(Vn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Zb(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),vN(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Zb(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}vN(e,!0,n,null,i);break;case"together":vN(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ka(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),rd|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(xe(153));if(e.child!==null){for(t=e.child,n=fc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=fc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function UQ(t,e,n){switch(e.tag){case 3:PF(e),Pf();break;case 5:aF(e);break;case 1:Gs(e.type)&&Wb(e);break;case 4:E2(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;bn(Gb,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(bn(Vn,Vn.current&1),e.flags|=128,null):n&e.child.childLanes?LF(t,e,n):(bn(Vn,Vn.current&1),t=Ka(t,e,n),t!==null?t.sibling:null);bn(Vn,Vn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return MF(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),bn(Vn,Vn.current),r)break;return null;case 22:case 23:return e.lanes=0,AF(t,e,n)}return Ka(t,e,n)}var OF,_S,DF,VF;OF=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_S=function(){};DF=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Pu($o.current);var i=null;switch(n){case"input":s=UE(t,s),r=UE(t,r),i=[];break;case"select":s=Hn({},s,{value:void 0}),r=Hn({},r,{value:void 0}),i=[];break;case"textarea":s=qE(t,s),r=qE(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=zb)}KE(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ny.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ny.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&wn("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};VF=function(t,e,n,r){n!==r&&(e.flags|=4)};function Lp(t,e){if(!Pn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ns(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function WQ(t,e,n){var r=e.pendingProps;switch(x2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ns(e),null;case 1:return Gs(e.type)&&Ub(),ns(e),null;case 3:return r=e.stateNode,Mf(),Sn(qs),Sn(ys),T2(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(cv(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,oo!==null&&(IS(oo),oo=null))),_S(t,e),ns(e),null;case 5:S2(e);var s=Pu(my.current);if(n=e.type,t!==null&&e.stateNode!=null)DF(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(xe(166));return ns(e),null}if(t=Pu($o.current),cv(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ao]=e,r[hy]=i,t=(e.mode&1)!==0,n){case"dialog":wn("cancel",r),wn("close",r);break;case"iframe":case"object":case"embed":wn("load",r);break;case"video":case"audio":for(s=0;s<rg.length;s++)wn(rg[s],r);break;case"source":wn("error",r);break;case"img":case"image":case"link":wn("error",r),wn("load",r);break;case"details":wn("toggle",r);break;case"input":TP(r,i),wn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},wn("invalid",r);break;case"textarea":IP(r,i),wn("invalid",r)}KE(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&lv(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&lv(r.textContent,l,t),s=["children",""+l]):ny.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&wn("scroll",r)}switch(n){case"input":ev(r),CP(r,i,!0);break;case"textarea":ev(r),jP(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=zb)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=h3(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ao]=e,t[hy]=r,OF(t,e,!1,!1),e.stateNode=t;e:{switch(o=QE(n,r),n){case"dialog":wn("cancel",t),wn("close",t),s=r;break;case"iframe":case"object":case"embed":wn("load",t),s=r;break;case"video":case"audio":for(s=0;s<rg.length;s++)wn(rg[s],t);s=r;break;case"source":wn("error",t),s=r;break;case"img":case"image":case"link":wn("error",t),wn("load",t),s=r;break;case"details":wn("toggle",t),s=r;break;case"input":TP(t,r),s=UE(t,r),wn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Hn({},r,{value:void 0}),wn("invalid",t);break;case"textarea":IP(t,r),s=qE(t,r),wn("invalid",t);break;default:s=r}KE(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?p3(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&f3(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ry(t,c):typeof c=="number"&&ry(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ny.hasOwnProperty(i)?c!=null&&i==="onScroll"&&wn("scroll",t):c!=null&&r2(t,i,c,o))}switch(n){case"input":ev(t),CP(t,r,!1);break;case"textarea":ev(t),jP(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Sc(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ff(t,!!r.multiple,i,!1):r.defaultValue!=null&&ff(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=zb)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ns(e),null;case 6:if(t&&e.stateNode!=null)VF(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(xe(166));if(n=Pu(my.current),Pu($o.current),cv(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ao]=e,(i=r.nodeValue!==n)&&(t=di,t!==null))switch(t.tag){case 3:lv(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&lv(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ao]=e,e.stateNode=r}return ns(e),null;case 13:if(Sn(Vn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pn&&ai!==null&&e.mode&1&&!(e.flags&128))nF(),Pf(),e.flags|=98560,i=!1;else if(i=cv(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(xe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(xe(317));i[Ao]=e}else Pf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ns(e),i=!1}else oo!==null&&(IS(oo),oo=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Vn.current&1?Nr===0&&(Nr=3):F2())),e.updateQueue!==null&&(e.flags|=4),ns(e),null);case 4:return Mf(),_S(t,e),t===null&&uy(e.stateNode.containerInfo),ns(e),null;case 10:return w2(e.type._context),ns(e),null;case 17:return Gs(e.type)&&Ub(),ns(e),null;case 19:if(Sn(Vn),i=e.memoizedState,i===null)return ns(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Lp(i,!1);else{if(Nr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Zb(t),o!==null){for(e.flags|=128,Lp(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return bn(Vn,Vn.current&1|2),e.child}t=t.sibling}i.tail!==null&&ar()>Df&&(e.flags|=128,r=!0,Lp(i,!1),e.lanes=4194304)}else{if(!r)if(t=Zb(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Lp(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Pn)return ns(e),null}else 2*ar()-i.renderingStartTime>Df&&n!==1073741824&&(e.flags|=128,r=!0,Lp(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ar(),e.sibling=null,n=Vn.current,bn(Vn,r?n&1|2:n&1),e):(ns(e),null);case 22:case 23:return V2(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ri&1073741824&&(ns(e),e.subtreeFlags&6&&(e.flags|=8192)):ns(e),null;case 24:return null;case 25:return null}throw Error(xe(156,e.tag))}function HQ(t,e){switch(x2(e),e.tag){case 1:return Gs(e.type)&&Ub(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mf(),Sn(qs),Sn(ys),T2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return S2(e),null;case 13:if(Sn(Vn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(xe(340));Pf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Sn(Vn),null;case 4:return Mf(),null;case 10:return w2(e.type._context),null;case 22:case 23:return V2(),null;case 24:return null;default:return null}}var hv=!1,cs=!1,qQ=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Jh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Zn(t,e,r)}else n.current=null}function wS(t,e,n){try{n()}catch(r){Zn(t,e,r)}}var vL=!1;function GQ(t,e){if(iS=Fb,t=U3(),g2(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,h=0,m=t,p=null;t:for(;;){for(var v;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)p=m,m=v;for(;;){if(m===t)break t;if(p===n&&++d===s&&(l=o),p===i&&++h===r&&(c=o),(v=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=v}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(oS={focusedElem:t,selectionRange:n},Fb=!1,$e=e;$e!==null;)if(e=$e,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,$e=t;else for(;$e!==null;){e=$e;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,E=x.memoizedState,k=e.stateNode,_=k.getSnapshotBeforeUpdate(e.elementType===e.type?b:so(e.type,b),E);k.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(T){Zn(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,$e=t;break}$e=e.return}return x=vL,vL=!1,x}function Ig(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&wS(e,n,i)}s=s.next}while(s!==r)}}function Uw(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function kS(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function FF(t){var e=t.alternate;e!==null&&(t.alternate=null,FF(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ao],delete e[hy],delete e[cS],delete e[IQ],delete e[jQ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $F(t){return t.tag===5||t.tag===3||t.tag===4}function bL(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$F(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function NS(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=zb));else if(r!==4&&(t=t.child,t!==null))for(NS(t,e,n),t=t.sibling;t!==null;)NS(t,e,n),t=t.sibling}function ES(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ES(t,e,n),t=t.sibling;t!==null;)ES(t,e,n),t=t.sibling}var qr=null,io=!1;function Cl(t,e,n){for(n=n.child;n!==null;)BF(t,e,n),n=n.sibling}function BF(t,e,n){if(Fo&&typeof Fo.onCommitFiberUnmount=="function")try{Fo.onCommitFiberUnmount(Mw,n)}catch{}switch(n.tag){case 5:cs||Jh(n,e);case 6:var r=qr,s=io;qr=null,Cl(t,e,n),qr=r,io=s,qr!==null&&(io?(t=qr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qr.removeChild(n.stateNode));break;case 18:qr!==null&&(io?(t=qr,n=n.stateNode,t.nodeType===8?hN(t.parentNode,n):t.nodeType===1&&hN(t,n),ay(t)):hN(qr,n.stateNode));break;case 4:r=qr,s=io,qr=n.stateNode.containerInfo,io=!0,Cl(t,e,n),qr=r,io=s;break;case 0:case 11:case 14:case 15:if(!cs&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&wS(n,e,o),s=s.next}while(s!==r)}Cl(t,e,n);break;case 1:if(!cs&&(Jh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Zn(n,e,l)}Cl(t,e,n);break;case 21:Cl(t,e,n);break;case 22:n.mode&1?(cs=(r=cs)||n.memoizedState!==null,Cl(t,e,n),cs=r):Cl(t,e,n);break;default:Cl(t,e,n)}}function _L(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new qQ),e.forEach(function(r){var s=nZ.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function eo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:qr=l.stateNode,io=!1;break e;case 3:qr=l.stateNode.containerInfo,io=!0;break e;case 4:qr=l.stateNode.containerInfo,io=!0;break e}l=l.return}if(qr===null)throw Error(xe(160));BF(i,o,s),qr=null,io=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Zn(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)zF(e,t),e=e.sibling}function zF(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(eo(e,t),Io(t),r&4){try{Ig(3,t,t.return),Uw(3,t)}catch(b){Zn(t,t.return,b)}try{Ig(5,t,t.return)}catch(b){Zn(t,t.return,b)}}break;case 1:eo(e,t),Io(t),r&512&&n!==null&&Jh(n,n.return);break;case 5:if(eo(e,t),Io(t),r&512&&n!==null&&Jh(n,n.return),t.flags&32){var s=t.stateNode;try{ry(s,"")}catch(b){Zn(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&u3(s,i),QE(l,o);var d=QE(l,i);for(o=0;o<c.length;o+=2){var h=c[o],m=c[o+1];h==="style"?p3(s,m):h==="dangerouslySetInnerHTML"?f3(s,m):h==="children"?ry(s,m):r2(s,h,m,d)}switch(l){case"input":WE(s,i);break;case"textarea":d3(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?ff(s,!!i.multiple,v,!1):p!==!!i.multiple&&(i.defaultValue!=null?ff(s,!!i.multiple,i.defaultValue,!0):ff(s,!!i.multiple,i.multiple?[]:"",!1))}s[hy]=i}catch(b){Zn(t,t.return,b)}}break;case 6:if(eo(e,t),Io(t),r&4){if(t.stateNode===null)throw Error(xe(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){Zn(t,t.return,b)}}break;case 3:if(eo(e,t),Io(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ay(e.containerInfo)}catch(b){Zn(t,t.return,b)}break;case 4:eo(e,t),Io(t);break;case 13:eo(e,t),Io(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(O2=ar())),r&4&&_L(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(cs=(d=cs)||h,eo(e,t),cs=d):eo(e,t),Io(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for($e=t,h=t.child;h!==null;){for(m=$e=h;$e!==null;){switch(p=$e,v=p.child,p.tag){case 0:case 11:case 14:case 15:Ig(4,p,p.return);break;case 1:Jh(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(b){Zn(r,n,b)}}break;case 5:Jh(p,p.return);break;case 22:if(p.memoizedState!==null){kL(m);continue}}v!==null?(v.return=p,$e=v):kL(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=m3("display",o))}catch(b){Zn(t,t.return,b)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(b){Zn(t,t.return,b)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:eo(e,t),Io(t),r&4&&_L(t);break;case 21:break;default:eo(e,t),Io(t)}}function Io(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if($F(n)){var r=n;break e}n=n.return}throw Error(xe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ry(s,""),r.flags&=-33);var i=bL(t);ES(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=bL(t);NS(t,l,o);break;default:throw Error(xe(161))}}catch(c){Zn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function KQ(t,e,n){$e=t,UF(t)}function UF(t,e,n){for(var r=(t.mode&1)!==0;$e!==null;){var s=$e,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||hv;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||cs;l=hv;var d=cs;if(hv=o,(cs=c)&&!d)for($e=s;$e!==null;)o=$e,c=o.child,o.tag===22&&o.memoizedState!==null?NL(s):c!==null?(c.return=o,$e=c):NL(s);for(;i!==null;)$e=i,UF(i),i=i.sibling;$e=s,hv=l,cs=d}wL(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,$e=i):wL(t)}}function wL(t){for(;$e!==null;){var e=$e;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:cs||Uw(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!cs)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:so(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&oL(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}oL(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&ay(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}cs||e.flags&512&&kS(e)}catch(p){Zn(e,e.return,p)}}if(e===t){$e=null;break}if(n=e.sibling,n!==null){n.return=e.return,$e=n;break}$e=e.return}}function kL(t){for(;$e!==null;){var e=$e;if(e===t){$e=null;break}var n=e.sibling;if(n!==null){n.return=e.return,$e=n;break}$e=e.return}}function NL(t){for(;$e!==null;){var e=$e;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Uw(4,e)}catch(c){Zn(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Zn(e,s,c)}}var i=e.return;try{kS(e)}catch(c){Zn(e,i,c)}break;case 5:var o=e.return;try{kS(e)}catch(c){Zn(e,o,c)}}}catch(c){Zn(e,e.return,c)}if(e===t){$e=null;break}var l=e.sibling;if(l!==null){l.return=e.return,$e=l;break}$e=e.return}}var QQ=Math.ceil,Jb=cl.ReactCurrentDispatcher,L2=cl.ReactCurrentOwner,zi=cl.ReactCurrentBatchConfig,Ut=0,Vr=null,gr=null,Qr=0,ri=0,ef=Gc(0),Nr=0,xy=null,rd=0,Ww=0,M2=0,jg=null,$s=null,O2=0,Df=1/0,Sa=null,e_=!1,SS=null,dc=null,fv=!1,Xl=null,t_=0,Ag=0,TS=null,eb=-1,tb=0;function Cs(){return Ut&6?ar():eb!==-1?eb:eb=ar()}function hc(t){return t.mode&1?Ut&2&&Qr!==0?Qr&-Qr:RQ.transition!==null?(tb===0&&(tb=T3()),tb):(t=rn,t!==0||(t=window.event,t=t===void 0?16:L3(t.type)),t):1}function po(t,e,n,r){if(50<Ag)throw Ag=0,TS=null,Error(xe(185));y0(t,n,r),(!(Ut&2)||t!==Vr)&&(t===Vr&&(!(Ut&2)&&(Ww|=n),Nr===4&&zl(t,Qr)),Ks(t,r),n===1&&Ut===0&&!(e.mode&1)&&(Df=ar()+500,$w&&Kc()))}function Ks(t,e){var n=t.callbackNode;RK(t,e);var r=Vb(t,t===Vr?Qr:0);if(r===0)n!==null&&PP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&PP(n),e===1)t.tag===0?AQ(EL.bind(null,t)):J3(EL.bind(null,t)),TQ(function(){!(Ut&6)&&Kc()}),n=null;else{switch(C3(r)){case 1:n=l2;break;case 4:n=E3;break;case 16:n=Db;break;case 536870912:n=S3;break;default:n=Db}n=YF(n,WF.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function WF(t,e){if(eb=-1,tb=0,Ut&6)throw Error(xe(327));var n=t.callbackNode;if(xf()&&t.callbackNode!==n)return null;var r=Vb(t,t===Vr?Qr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=n_(t,r);else{e=r;var s=Ut;Ut|=2;var i=qF();(Vr!==t||Qr!==e)&&(Sa=null,Df=ar()+500,Bu(t,e));do try{XQ();break}catch(l){HF(t,l)}while(!0);_2(),Jb.current=i,Ut=s,gr!==null?e=0:(Vr=null,Qr=0,e=Nr)}if(e!==0){if(e===2&&(s=eS(t),s!==0&&(r=s,e=CS(t,s))),e===1)throw n=xy,Bu(t,0),zl(t,r),Ks(t,ar()),n;if(e===6)zl(t,r);else{if(s=t.current.alternate,!(r&30)&&!ZQ(s)&&(e=n_(t,r),e===2&&(i=eS(t),i!==0&&(r=i,e=CS(t,i))),e===1))throw n=xy,Bu(t,0),zl(t,r),Ks(t,ar()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(xe(345));case 2:bu(t,$s,Sa);break;case 3:if(zl(t,r),(r&130023424)===r&&(e=O2+500-ar(),10<e)){if(Vb(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Cs(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=lS(bu.bind(null,t,$s,Sa),e);break}bu(t,$s,Sa);break;case 4:if(zl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-mo(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ar()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*QQ(r/1960))-r,10<r){t.timeoutHandle=lS(bu.bind(null,t,$s,Sa),r);break}bu(t,$s,Sa);break;case 5:bu(t,$s,Sa);break;default:throw Error(xe(329))}}}return Ks(t,ar()),t.callbackNode===n?WF.bind(null,t):null}function CS(t,e){var n=jg;return t.current.memoizedState.isDehydrated&&(Bu(t,e).flags|=256),t=n_(t,e),t!==2&&(e=$s,$s=n,e!==null&&IS(e)),t}function IS(t){$s===null?$s=t:$s.push.apply($s,t)}function ZQ(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!vo(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zl(t,e){for(e&=~M2,e&=~Ww,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-mo(e),r=1<<n;t[n]=-1,e&=~r}}function EL(t){if(Ut&6)throw Error(xe(327));xf();var e=Vb(t,0);if(!(e&1))return Ks(t,ar()),null;var n=n_(t,e);if(t.tag!==0&&n===2){var r=eS(t);r!==0&&(e=r,n=CS(t,r))}if(n===1)throw n=xy,Bu(t,0),zl(t,e),Ks(t,ar()),n;if(n===6)throw Error(xe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bu(t,$s,Sa),Ks(t,ar()),null}function D2(t,e){var n=Ut;Ut|=1;try{return t(e)}finally{Ut=n,Ut===0&&(Df=ar()+500,$w&&Kc())}}function sd(t){Xl!==null&&Xl.tag===0&&!(Ut&6)&&xf();var e=Ut;Ut|=1;var n=zi.transition,r=rn;try{if(zi.transition=null,rn=1,t)return t()}finally{rn=r,zi.transition=n,Ut=e,!(Ut&6)&&Kc()}}function V2(){ri=ef.current,Sn(ef)}function Bu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,SQ(n)),gr!==null)for(n=gr.return;n!==null;){var r=n;switch(x2(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ub();break;case 3:Mf(),Sn(qs),Sn(ys),T2();break;case 5:S2(r);break;case 4:Mf();break;case 13:Sn(Vn);break;case 19:Sn(Vn);break;case 10:w2(r.type._context);break;case 22:case 23:V2()}n=n.return}if(Vr=t,gr=t=fc(t.current,null),Qr=ri=e,Nr=0,xy=null,M2=Ww=rd=0,$s=jg=null,Ru!==null){for(e=0;e<Ru.length;e++)if(n=Ru[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ru=null}return t}function HF(t,e){do{var n=gr;try{if(_2(),Yv.current=Xb,Yb){for(var r=zn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Yb=!1}if(nd=0,Lr=br=zn=null,Cg=!1,py=0,L2.current=null,n===null||n.return===null){Nr=1,xy=e,gr=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Qr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=l,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=hL(o);if(v!==null){v.flags&=-257,fL(v,o,l,i,e),v.mode&1&&dL(i,d,e),e=v,c=d;var x=e.updateQueue;if(x===null){var b=new Set;b.add(c),e.updateQueue=b}else x.add(c);break e}else{if(!(e&1)){dL(i,d,e),F2();break e}c=Error(xe(426))}}else if(Pn&&l.mode&1){var E=hL(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),fL(E,o,l,i,e),v2(Of(c,l));break e}}i=c=Of(c,l),Nr!==4&&(Nr=2),jg===null?jg=[i]:jg.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=CF(i,c,e);iL(i,k);break e;case 1:l=c;var _=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(dc===null||!dc.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=IF(i,l,e);iL(i,T);break e}}i=i.return}while(i!==null)}KF(n)}catch(P){e=P,gr===n&&n!==null&&(gr=n=n.return);continue}break}while(!0)}function qF(){var t=Jb.current;return Jb.current=Xb,t===null?Xb:t}function F2(){(Nr===0||Nr===3||Nr===2)&&(Nr=4),Vr===null||!(rd&268435455)&&!(Ww&268435455)||zl(Vr,Qr)}function n_(t,e){var n=Ut;Ut|=2;var r=qF();(Vr!==t||Qr!==e)&&(Sa=null,Bu(t,e));do try{YQ();break}catch(s){HF(t,s)}while(!0);if(_2(),Ut=n,Jb.current=r,gr!==null)throw Error(xe(261));return Vr=null,Qr=0,Nr}function YQ(){for(;gr!==null;)GF(gr)}function XQ(){for(;gr!==null&&!kK();)GF(gr)}function GF(t){var e=ZF(t.alternate,t,ri);t.memoizedProps=t.pendingProps,e===null?KF(t):gr=e,L2.current=null}function KF(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HQ(n,e),n!==null){n.flags&=32767,gr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nr=6,gr=null;return}}else if(n=WQ(n,e,ri),n!==null){gr=n;return}if(e=e.sibling,e!==null){gr=e;return}gr=e=t}while(e!==null);Nr===0&&(Nr=5)}function bu(t,e,n){var r=rn,s=zi.transition;try{zi.transition=null,rn=1,JQ(t,e,n,r)}finally{zi.transition=s,rn=r}return null}function JQ(t,e,n,r){do xf();while(Xl!==null);if(Ut&6)throw Error(xe(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(xe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(PK(t,i),t===Vr&&(gr=Vr=null,Qr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fv||(fv=!0,YF(Db,function(){return xf(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=zi.transition,zi.transition=null;var o=rn;rn=1;var l=Ut;Ut|=4,L2.current=null,GQ(t,n),zF(n,t),vQ(oS),Fb=!!iS,oS=iS=null,t.current=n,KQ(n),NK(),Ut=l,rn=o,zi.transition=i}else t.current=n;if(fv&&(fv=!1,Xl=t,t_=s),i=t.pendingLanes,i===0&&(dc=null),TK(n.stateNode),Ks(t,ar()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(e_)throw e_=!1,t=SS,SS=null,t;return t_&1&&t.tag!==0&&xf(),i=t.pendingLanes,i&1?t===TS?Ag++:(Ag=0,TS=t):Ag=0,Kc(),null}function xf(){if(Xl!==null){var t=C3(t_),e=zi.transition,n=rn;try{if(zi.transition=null,rn=16>t?16:t,Xl===null)var r=!1;else{if(t=Xl,Xl=null,t_=0,Ut&6)throw Error(xe(331));var s=Ut;for(Ut|=4,$e=t.current;$e!==null;){var i=$e,o=i.child;if($e.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for($e=d;$e!==null;){var h=$e;switch(h.tag){case 0:case 11:case 15:Ig(8,h,i)}var m=h.child;if(m!==null)m.return=h,$e=m;else for(;$e!==null;){h=$e;var p=h.sibling,v=h.return;if(FF(h),h===d){$e=null;break}if(p!==null){p.return=v,$e=p;break}$e=v}}}var x=i.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var E=b.sibling;b.sibling=null,b=E}while(b!==null)}}$e=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,$e=o;else e:for(;$e!==null;){if(i=$e,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ig(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,$e=k;break e}$e=i.return}}var _=t.current;for($e=_;$e!==null;){o=$e;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,$e=S;else e:for(o=_;$e!==null;){if(l=$e,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Uw(9,l)}}catch(P){Zn(l,l.return,P)}if(l===o){$e=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,$e=T;break e}$e=l.return}}if(Ut=s,Kc(),Fo&&typeof Fo.onPostCommitFiberRoot=="function")try{Fo.onPostCommitFiberRoot(Mw,t)}catch{}r=!0}return r}finally{rn=n,zi.transition=e}}return!1}function SL(t,e,n){e=Of(n,e),e=CF(t,e,1),t=uc(t,e,1),e=Cs(),t!==null&&(y0(t,1,e),Ks(t,e))}function Zn(t,e,n){if(t.tag===3)SL(t,t,n);else for(;e!==null;){if(e.tag===3){SL(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(dc===null||!dc.has(r))){t=Of(n,t),t=IF(e,t,1),e=uc(e,t,1),t=Cs(),e!==null&&(y0(e,1,t),Ks(e,t));break}}e=e.return}}function eZ(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Cs(),t.pingedLanes|=t.suspendedLanes&n,Vr===t&&(Qr&n)===n&&(Nr===4||Nr===3&&(Qr&130023424)===Qr&&500>ar()-O2?Bu(t,0):M2|=n),Ks(t,e)}function QF(t,e){e===0&&(t.mode&1?(e=rv,rv<<=1,!(rv&130023424)&&(rv=4194304)):e=1);var n=Cs();t=Ga(t,e),t!==null&&(y0(t,e,n),Ks(t,n))}function tZ(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),QF(t,n)}function nZ(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(xe(314))}r!==null&&r.delete(e),QF(t,n)}var ZF;ZF=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||qs.current)Bs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Bs=!1,UQ(t,e,n);Bs=!!(t.flags&131072)}else Bs=!1,Pn&&e.flags&1048576&&eF(e,qb,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Jv(t,e),t=e.pendingProps;var s=Rf(e,ys.current);yf(e,n),s=I2(null,e,r,t,s,n);var i=j2();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gs(r)?(i=!0,Wb(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,N2(e),s.updater=zw,e.stateNode=s,s._reactInternals=e,pS(e,r,t,n),e=xS(null,e,r,!0,i,n)):(e.tag=0,Pn&&i&&y2(e),Ns(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Jv(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=sZ(r),t=so(r,t),s){case 0:e=yS(null,e,r,t,n);break e;case 1:e=gL(null,e,r,t,n);break e;case 11:e=mL(null,e,r,t,n);break e;case 14:e=pL(null,e,r,so(r.type,t),n);break e}throw Error(xe(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:so(r,s),yS(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:so(r,s),gL(t,e,r,s,n);case 3:e:{if(PF(e),t===null)throw Error(xe(387));r=e.pendingProps,i=e.memoizedState,s=i.element,oF(t,e),Qb(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Of(Error(xe(423)),e),e=yL(t,e,r,n,s);break e}else if(r!==s){s=Of(Error(xe(424)),e),e=yL(t,e,r,n,s);break e}else for(ai=cc(e.stateNode.containerInfo.firstChild),di=e,Pn=!0,oo=null,n=sF(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pf(),r===s){e=Ka(t,e,n);break e}Ns(t,e,r,n)}e=e.child}return e;case 5:return aF(e),t===null&&hS(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,aS(r,s)?o=null:i!==null&&aS(r,i)&&(e.flags|=32),RF(t,e),Ns(t,e,o,n),e.child;case 6:return t===null&&hS(e),null;case 13:return LF(t,e,n);case 4:return E2(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Lf(e,null,r,n):Ns(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:so(r,s),mL(t,e,r,s,n);case 7:return Ns(t,e,e.pendingProps,n),e.child;case 8:return Ns(t,e,e.pendingProps.children,n),e.child;case 12:return Ns(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,bn(Gb,r._currentValue),r._currentValue=o,i!==null)if(vo(i.value,o)){if(i.children===s.children&&!qs.current){e=Ka(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Fa(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),fS(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(xe(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),fS(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ns(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,yf(e,n),s=Wi(s),r=r(s),e.flags|=1,Ns(t,e,r,n),e.child;case 14:return r=e.type,s=so(r,e.pendingProps),s=so(r.type,s),pL(t,e,r,s,n);case 15:return jF(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:so(r,s),Jv(t,e),e.tag=1,Gs(r)?(t=!0,Wb(e)):t=!1,yf(e,n),TF(e,r,s),pS(e,r,s,n),xS(null,e,r,!0,t,n);case 19:return MF(t,e,n);case 22:return AF(t,e,n)}throw Error(xe(156,e.tag))};function YF(t,e){return N3(t,e)}function rZ(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vi(t,e,n,r){return new rZ(t,e,n,r)}function $2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sZ(t){if(typeof t=="function")return $2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===i2)return 11;if(t===o2)return 14}return 2}function fc(t,e){var n=t.alternate;return n===null?(n=Vi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function nb(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")$2(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Wh:return zu(n.children,s,i,e);case s2:o=8,s|=8;break;case FE:return t=Vi(12,n,e,s|2),t.elementType=FE,t.lanes=i,t;case $E:return t=Vi(13,n,e,s),t.elementType=$E,t.lanes=i,t;case BE:return t=Vi(19,n,e,s),t.elementType=BE,t.lanes=i,t;case a3:return Hw(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case i3:o=10;break e;case o3:o=9;break e;case i2:o=11;break e;case o2:o=14;break e;case Dl:o=16,r=null;break e}throw Error(xe(130,t==null?t:typeof t,""))}return e=Vi(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function zu(t,e,n,r){return t=Vi(7,t,r,e),t.lanes=n,t}function Hw(t,e,n,r){return t=Vi(22,t,r,e),t.elementType=a3,t.lanes=n,t.stateNode={isHidden:!1},t}function bN(t,e,n){return t=Vi(6,t,null,e),t.lanes=n,t}function _N(t,e,n){return e=Vi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function iZ(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tN(0),this.expirationTimes=tN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tN(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function B2(t,e,n,r,s,i,o,l,c){return t=new iZ(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Vi(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},N2(i),t}function oZ(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Uh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function XF(t){if(!t)return Tc;t=t._reactInternals;e:{if(Rd(t)!==t||t.tag!==1)throw Error(xe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xe(171))}if(t.tag===1){var n=t.type;if(Gs(n))return X3(t,n,e)}return e}function JF(t,e,n,r,s,i,o,l,c){return t=B2(n,r,!0,t,s,i,o,l,c),t.context=XF(null),n=t.current,r=Cs(),s=hc(n),i=Fa(r,s),i.callback=e??null,uc(n,i,s),t.current.lanes=s,y0(t,s,r),Ks(t,r),t}function qw(t,e,n,r){var s=e.current,i=Cs(),o=hc(s);return n=XF(n),e.context===null?e.context=n:e.pendingContext=n,e=Fa(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=uc(s,e,o),t!==null&&(po(t,s,o,i),Zv(t,s,o)),o}function r_(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function TL(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function z2(t,e){TL(t,e),(t=t.alternate)&&TL(t,e)}function aZ(){return null}var e6=typeof reportError=="function"?reportError:function(t){console.error(t)};function U2(t){this._internalRoot=t}Gw.prototype.render=U2.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(xe(409));qw(t,e,null,null)};Gw.prototype.unmount=U2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;sd(function(){qw(null,t,null,null)}),e[qa]=null}};function Gw(t){this._internalRoot=t}Gw.prototype.unstable_scheduleHydration=function(t){if(t){var e=A3();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Bl.length&&e!==0&&e<Bl[n].priority;n++);Bl.splice(n,0,t),n===0&&P3(t)}};function W2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Kw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function CL(){}function lZ(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=r_(o);i.call(d)}}var o=JF(e,r,t,0,null,!1,!1,"",CL);return t._reactRootContainer=o,t[qa]=o.current,uy(t.nodeType===8?t.parentNode:t),sd(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=r_(c);l.call(d)}}var c=B2(t,0,!1,null,null,!1,!1,"",CL);return t._reactRootContainer=c,t[qa]=c.current,uy(t.nodeType===8?t.parentNode:t),sd(function(){qw(e,c,n,r)}),c}function Qw(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=r_(o);l.call(c)}}qw(e,o,t,s)}else o=lZ(n,e,t,s,r);return r_(o)}I3=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ng(e.pendingLanes);n!==0&&(c2(e,n|1),Ks(e,ar()),!(Ut&6)&&(Df=ar()+500,Kc()))}break;case 13:sd(function(){var r=Ga(t,1);if(r!==null){var s=Cs();po(r,t,1,s)}}),z2(t,1)}};u2=function(t){if(t.tag===13){var e=Ga(t,134217728);if(e!==null){var n=Cs();po(e,t,134217728,n)}z2(t,134217728)}};j3=function(t){if(t.tag===13){var e=hc(t),n=Ga(t,e);if(n!==null){var r=Cs();po(n,t,e,r)}z2(t,e)}};A3=function(){return rn};R3=function(t,e){var n=rn;try{return rn=t,e()}finally{rn=n}};YE=function(t,e,n){switch(e){case"input":if(WE(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Fw(r);if(!s)throw Error(xe(90));c3(r),WE(r,s)}}}break;case"textarea":d3(t,n);break;case"select":e=n.value,e!=null&&ff(t,!!n.multiple,e,!1)}};x3=D2;v3=sd;var cZ={usingClientEntryPoint:!1,Events:[v0,Kh,Fw,g3,y3,D2]},Mp={findFiberByHostInstance:Au,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uZ={bundleType:Mp.bundleType,version:Mp.version,rendererPackageName:Mp.rendererPackageName,rendererConfig:Mp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=w3(t),t===null?null:t.stateNode},findFiberByHostInstance:Mp.findFiberByHostInstance||aZ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mv.isDisabled&&mv.supportsFiber)try{Mw=mv.inject(uZ),Fo=mv}catch{}}_i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cZ;_i.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W2(e))throw Error(xe(200));return oZ(t,e,null,n)};_i.createRoot=function(t,e){if(!W2(t))throw Error(xe(299));var n=!1,r="",s=e6;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=B2(t,1,!1,null,null,n,!1,r,s),t[qa]=e.current,uy(t.nodeType===8?t.parentNode:t),new U2(e)};_i.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(xe(188)):(t=Object.keys(t).join(","),Error(xe(268,t)));return t=w3(e),t=t===null?null:t.stateNode,t};_i.flushSync=function(t){return sd(t)};_i.hydrate=function(t,e,n){if(!Kw(e))throw Error(xe(200));return Qw(null,t,e,!0,n)};_i.hydrateRoot=function(t,e,n){if(!W2(t))throw Error(xe(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=e6;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=JF(e,null,t,1,n??null,s,!1,i,o),t[qa]=e.current,uy(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Gw(e)};_i.render=function(t,e,n){if(!Kw(e))throw Error(xe(200));return Qw(null,t,e,!1,n)};_i.unmountComponentAtNode=function(t){if(!Kw(t))throw Error(xe(40));return t._reactRootContainer?(sd(function(){Qw(null,null,t,!1,function(){t._reactRootContainer=null,t[qa]=null})}),!0):!1};_i.unstable_batchedUpdates=D2;_i.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Kw(n))throw Error(xe(200));if(t==null||t._reactInternals===void 0)throw Error(xe(38));return Qw(t,e,n,!1,r)};_i.version="18.3.1-next-f1338f8080-20240426";function t6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t6)}catch(t){console.error(t)}}t6(),t3.exports=_i;var n6=t3.exports,IL=n6;DE.createRoot=IL.createRoot,DE.hydrateRoot=IL.hydrateRoot;var jL={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r6=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},dZ=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},s6={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;c||(v=64,o||(p=64)),r.push(n[h],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r6(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):dZ(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new hZ;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let hZ=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const fZ=function(t){const e=r6(t);return s6.encodeByteArray(e,!0)},s_=function(t){return fZ(t).replace(/\./g,"")},i6=function(t){try{return s6.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mZ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pZ=()=>mZ().__FIREBASE_DEFAULTS__,gZ=()=>{if(typeof process>"u"||typeof jL>"u")return;const t=jL.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},yZ=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&i6(t[1]);return e&&JSON.parse(e)},Zw=()=>{try{return pZ()||gZ()||yZ()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},o6=t=>{var e,n;return(n=(e=Zw())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},xZ=t=>{const e=o6(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},a6=()=>{var t;return(t=Zw())===null||t===void 0?void 0:t.config},l6=t=>{var e;return(e=Zw())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vZ=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bZ(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[s_(JSON.stringify(n)),s_(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _Z(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tr())}function wZ(){var t;const e=(t=Zw())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kZ(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function NZ(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function EZ(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function SZ(){const t=Tr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function c6(){return!wZ()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function u6(){try{return typeof indexedDB=="object"}catch{return!1}}function TZ(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CZ="FirebaseError";let Pd=class d6 extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=CZ,Object.setPrototypeOf(this,d6.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_0.prototype.create)}},_0=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?IZ(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Pd(s,l,r)}};function IZ(t,e){return t.replace(jZ,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const jZ=/\{\$([^}]+)}/g;function AZ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function id(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(AL(i)&&AL(o)){if(!id(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function AL(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function sg(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ig(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function RZ(t,e){const n=new PZ(t,e);return n.subscribe.bind(n)}let PZ=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");LZ(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=wN),s.error===void 0&&(s.error=wN),s.complete===void 0&&(s.complete=wN);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function LZ(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function wN(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(t){return t&&t._delegate?t._delegate:t}let od=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _u="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MZ{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new vZ;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(DZ(e))try{this.getOrInitializeService({instanceIdentifier:_u})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=_u){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_u){return this.instances.has(e)}getOptions(e=_u){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:OZ(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_u){return this.component?this.component.multipleInstances?e:_u:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function OZ(t){return t===_u?void 0:t}function DZ(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VZ{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new MZ(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Mt||(Mt={}));const FZ={debug:Mt.DEBUG,verbose:Mt.VERBOSE,info:Mt.INFO,warn:Mt.WARN,error:Mt.ERROR,silent:Mt.SILENT},$Z=Mt.INFO,BZ={[Mt.DEBUG]:"log",[Mt.VERBOSE]:"log",[Mt.INFO]:"info",[Mt.WARN]:"warn",[Mt.ERROR]:"error"},zZ=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=BZ[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let H2=class{constructor(e){this.name=e,this._logLevel=$Z,this._logHandler=zZ,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Mt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?FZ[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Mt.DEBUG,...e),this._logHandler(this,Mt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Mt.VERBOSE,...e),this._logHandler(this,Mt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Mt.INFO,...e),this._logHandler(this,Mt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Mt.WARN,...e),this._logHandler(this,Mt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Mt.ERROR,...e),this._logHandler(this,Mt.ERROR,...e)}};const UZ=(t,e)=>e.some(n=>t instanceof n);let RL,PL;function WZ(){return RL||(RL=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HZ(){return PL||(PL=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const h6=new WeakMap,jS=new WeakMap,f6=new WeakMap,kN=new WeakMap,q2=new WeakMap;function qZ(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(mc(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&h6.set(n,t)}).catch(()=>{}),q2.set(e,t),e}function GZ(t){if(jS.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});jS.set(t,e)}let AS={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jS.get(t);if(e==="objectStoreNames")return t.objectStoreNames||f6.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mc(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function KZ(t){AS=t(AS)}function QZ(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(NN(this),e,...n);return f6.set(r,e.sort?e.sort():[e]),mc(r)}:HZ().includes(t)?function(...e){return t.apply(NN(this),e),mc(h6.get(this))}:function(...e){return mc(t.apply(NN(this),e))}}function ZZ(t){return typeof t=="function"?QZ(t):(t instanceof IDBTransaction&&GZ(t),UZ(t,WZ())?new Proxy(t,AS):t)}function mc(t){if(t instanceof IDBRequest)return qZ(t);if(kN.has(t))return kN.get(t);const e=ZZ(t);return e!==t&&(kN.set(t,e),q2.set(e,t)),e}const NN=t=>q2.get(t);function YZ(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=mc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(mc(o.result),c.oldVersion,c.newVersion,mc(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const XZ=["get","getKey","getAll","getAllKeys","count"],JZ=["put","add","delete","clear"],EN=new Map;function LL(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(EN.get(e))return EN.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=JZ.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||XZ.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&c.done]))[0]};return EN.set(e,i),i}KZ(t=>({...t,get:(e,n,r)=>LL(e,n)||t.get(e,n,r),has:(e,n)=>!!LL(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eY=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tY(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function tY(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const RS="@firebase/app",ML="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa=new H2("@firebase/app"),nY="@firebase/app-compat",rY="@firebase/analytics-compat",sY="@firebase/analytics",iY="@firebase/app-check-compat",oY="@firebase/app-check",aY="@firebase/auth",lY="@firebase/auth-compat",cY="@firebase/database",uY="@firebase/data-connect",dY="@firebase/database-compat",hY="@firebase/functions",fY="@firebase/functions-compat",mY="@firebase/installations",pY="@firebase/installations-compat",gY="@firebase/messaging",yY="@firebase/messaging-compat",xY="@firebase/performance",vY="@firebase/performance-compat",bY="@firebase/remote-config",_Y="@firebase/remote-config-compat",wY="@firebase/storage",kY="@firebase/storage-compat",NY="@firebase/firestore",EY="@firebase/vertexai-preview",SY="@firebase/firestore-compat",TY="firebase",CY="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS="[DEFAULT]",IY={[RS]:"fire-core",[nY]:"fire-core-compat",[sY]:"fire-analytics",[rY]:"fire-analytics-compat",[oY]:"fire-app-check",[iY]:"fire-app-check-compat",[aY]:"fire-auth",[lY]:"fire-auth-compat",[cY]:"fire-rtdb",[uY]:"fire-data-connect",[dY]:"fire-rtdb-compat",[hY]:"fire-fn",[fY]:"fire-fn-compat",[mY]:"fire-iid",[pY]:"fire-iid-compat",[gY]:"fire-fcm",[yY]:"fire-fcm-compat",[xY]:"fire-perf",[vY]:"fire-perf-compat",[bY]:"fire-rc",[_Y]:"fire-rc-compat",[wY]:"fire-gcs",[kY]:"fire-gcs-compat",[NY]:"fire-fst",[SY]:"fire-fst-compat",[EY]:"fire-vertex","fire-js":"fire-js",[TY]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_=new Map,jY=new Map,LS=new Map;function OL(t,e){try{t.container.addComponent(e)}catch(n){Qa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Vf(t){const e=t.name;if(LS.has(e))return Qa.debug(`There were multiple attempts to register component ${e}.`),!1;LS.set(e,t);for(const n of i_.values())OL(n,t);for(const n of jY.values())OL(n,t);return!0}function Yw(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Fi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pc=new _0("app","Firebase",AY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RY{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new od("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm=CY;function m6(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:PS,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw pc.create("bad-app-name",{appName:String(s)});if(n||(n=a6()),!n)throw pc.create("no-options");const i=i_.get(s);if(i){if(id(n,i.options)&&id(r,i.config))return i;throw pc.create("duplicate-app",{appName:s})}const o=new VZ(s);for(const c of LS.values())o.addComponent(c);const l=new RY(n,r,o);return i_.set(s,l),l}function p6(t=PS){const e=i_.get(t);if(!e&&t===PS&&a6())return m6();if(!e)throw pc.create("no-app",{appName:t});return e}function gc(t,e,n){var r;let s=(r=IY[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qa.warn(l.join(" "));return}Vf(new od(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PY="firebase-heartbeat-database",LY=1,vy="firebase-heartbeat-store";let SN=null;function g6(){return SN||(SN=YZ(PY,LY,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(vy)}catch(n){console.warn(n)}}}}).catch(t=>{throw pc.create("idb-open",{originalErrorMessage:t.message})})),SN}async function MY(t){try{const n=(await g6()).transaction(vy),r=await n.objectStore(vy).get(y6(t));return await n.done,r}catch(e){if(e instanceof Pd)Qa.warn(e.message);else{const n=pc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qa.warn(n.message)}}}async function DL(t,e){try{const r=(await g6()).transaction(vy,"readwrite");await r.objectStore(vy).put(e,y6(t)),await r.done}catch(n){if(n instanceof Pd)Qa.warn(n.message);else{const r=pc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Qa.warn(r.message)}}}function y6(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OY=1024,DY=30*24*60*60*1e3;let VY=class{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $Y(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=VL();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=DY}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Qa.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=VL(),{heartbeatsToSend:r,unsentEntries:s}=FY(this._heartbeatsCache.heartbeats),i=s_(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Qa.warn(n),""}}};function VL(){return new Date().toISOString().substring(0,10)}function FY(t,e=OY){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),FL(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),FL(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}let $Y=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return u6()?TZ().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await MY(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return DL(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return DL(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}};function FL(t){return s_(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BY(t){Vf(new od("platform-logger",e=>new eY(e),"PRIVATE")),Vf(new od("heartbeat",e=>new VY(e),"PRIVATE")),gc(RS,ML,t),gc(RS,ML,"esm2017"),gc("fire-js","")}BY("");var MS=function(t,e){return MS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},MS(t,e)};function zY(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");MS(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Im(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function x6(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const UY=x6,v6=new _0("auth","Firebase",x6());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_=new H2("@firebase/auth");function WY(t,...e){o_.logLevel<=Mt.WARN&&o_.warn(`Auth (${Cm}): ${t}`,...e)}function rb(t,...e){o_.logLevel<=Mt.ERROR&&o_.error(`Auth (${Cm}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(t,...e){throw K2(t,...e)}function go(t,...e){return K2(t,...e)}function G2(t,e,n){const r=Object.assign(Object.assign({},UY()),{[e]:n});return new _0("auth","Firebase",r).create(e,{appName:t.name})}function Bo(t){return G2(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function HY(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&qi(t,"argument-error"),G2(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function K2(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return v6.create(t,...e)}function ct(t,e,...n){if(!t)throw K2(e,...n)}function Ra(t){const e="INTERNAL ASSERTION FAILED: "+t;throw rb(e),new Error(e)}function Za(t,e){t||Ra(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function qY(){return $L()==="http:"||$L()==="https:"}function $L(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qY()||NZ()||"connection"in navigator)?navigator.onLine:!0}function KY(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k0=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,Za(n>e,"Short delay should be less than long delay!"),this.isMobile=_Z()||EZ()}get(){return GY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2(t,e){Za(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b6=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ra("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ra("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ra("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZY=new k0(3e4,6e4);function ul(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function sa(t,e,n,r,s={}){return _6(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=w0(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},i);return kZ()||(d.referrerPolicy="no-referrer"),b6.fetch()(w6(t,t.config.apiHost,n,l),d)})}async function _6(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},QY),e);try{const s=new XY(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw pv(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw pv(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw pv(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw pv(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw G2(t,h,d);qi(t,h)}}catch(s){if(s instanceof Pd)throw s;qi(t,"network-request-failed",{message:String(s)})}}async function N0(t,e,n,r,s={}){const i=await sa(t,e,n,r,s);return"mfaPendingCredential"in i&&qi(t,"multi-factor-auth-required",{_serverResponse:i}),i}function w6(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Q2(t.config,s):`${t.config.apiScheme}://${s}`}function YY(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}let XY=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(go(this.auth,"network-request-failed")),ZY.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function pv(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=go(t,e,r);return s.customData._tokenResponse=n,s}function BL(t){return t!==void 0&&t.enterprise!==void 0}class JY{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return YY(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function eX(t,e){return sa(t,"GET","/v2/recaptchaConfig",ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tX(t,e){return sa(t,"POST","/v1/accounts:delete",e)}async function k6(t,e){return sa(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function nX(t,e=!1){const n=In(t),r=await n.getIdToken(e),s=Z2(r);ct(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Rg(TN(s.auth_time)),issuedAtTime:Rg(TN(s.iat)),expirationTime:Rg(TN(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function TN(t){return Number(t)*1e3}function Z2(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return rb("JWT malformed, contained fewer than 3 sections"),null;try{const s=i6(n);return s?JSON.parse(s):(rb("Failed to decode base64 JWT payload"),null)}catch(s){return rb("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function zL(t){const e=Z2(t);return ct(e,"internal-error"),ct(typeof e.exp<"u","internal-error"),ct(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ff(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Pd&&rX(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function rX({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sX=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DS=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rg(this.lastLoginAt),this.creationTime=Rg(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a_(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Ff(t,k6(n,{idToken:r}));ct(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?N6(i.providerUserInfo):[],l=oX(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=c?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new DS(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,m)}async function iX(t){const e=In(t);await a_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function oX(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function N6(t){return t.map(e=>{var{providerId:n}=e,r=Im(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aX(t,e){const n=await _6(t,{},async()=>{const r=w0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=w6(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",b6.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function lX(t,e){return sa(t,"POST","/v2/accounts:revokeToken",ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CN=class VS{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ct(e.idToken,"internal-error"),ct(typeof e.idToken<"u","internal-error"),ct(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zL(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ct(e.length!==0,"internal-error");const n=zL(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ct(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await aX(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new VS;return r&&(ct(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ct(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ct(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new VS,this.toJSON())}_performRefresh(){return Ra("not implemented")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(t,e){ct(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}let l_=class og{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Im(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sX(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new DS(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Ff(this,this.stsTokenManager.getToken(this.auth,e));return ct(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return nX(this,e)}reload(){return iX(this)}_assign(e){this!==e&&(ct(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new og(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ct(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await a_(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fi(this.auth.app))return Promise.reject(Bo(this.auth));const e=await this.getIdToken();return await Ff(this,tX(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,d,h;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,v=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=n.photoURL)!==null&&o!==void 0?o:void 0,b=(l=n.tenantId)!==null&&l!==void 0?l:void 0,E=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,k=(d=n.createdAt)!==null&&d!==void 0?d:void 0,_=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:S,emailVerified:T,isAnonymous:P,providerData:j,stsTokenManager:R}=n;ct(S&&R,e,"internal-error");const I=CN.fromJSON(this.name,R);ct(typeof S=="string",e,"internal-error"),Il(m,e.name),Il(p,e.name),ct(typeof T=="boolean",e,"internal-error"),ct(typeof P=="boolean",e,"internal-error"),Il(v,e.name),Il(x,e.name),Il(b,e.name),Il(E,e.name),Il(k,e.name),Il(_,e.name);const O=new og({uid:S,auth:e,email:p,emailVerified:T,displayName:m,isAnonymous:P,photoURL:x,phoneNumber:v,tenantId:b,stsTokenManager:I,createdAt:k,lastLoginAt:_});return j&&Array.isArray(j)&&(O.providerData=j.map(D=>Object.assign({},D))),E&&(O._redirectEventId=E),O}static async _fromIdTokenResponse(e,n,r=!1){const s=new CN;s.updateFromServerResponse(n);const i=new og({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await a_(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ct(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?N6(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new CN;l.updateFromIdToken(r);const c=new og({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new DS(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=new Map;function Pa(t){Za(t instanceof Function,"Expected a class definition");let e=UL.get(t);return e?(Za(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,UL.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E6=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}};E6.type="NONE";const WL=E6;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(t,e,n){return`firebase:${t}:${e}:${n}`}let HL=class ib{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=sb(this.userKey,s.apiKey,i),this.fullPersistenceKey=sb("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?l_._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ib(Pa(WL),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Pa(WL);const o=sb(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){const m=l_._fromJSON(e,h);d!==i&&(l=m),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ib(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new ib(i,e,r))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qL(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(I6(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(S6(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(A6(e))return"Blackberry";if(R6(e))return"Webos";if(T6(e))return"Safari";if((e.includes("chrome/")||C6(e))&&!e.includes("edge/"))return"Chrome";if(j6(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function S6(t=Tr()){return/firefox\//i.test(t)}function T6(t=Tr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function C6(t=Tr()){return/crios\//i.test(t)}function I6(t=Tr()){return/iemobile/i.test(t)}function j6(t=Tr()){return/android/i.test(t)}function A6(t=Tr()){return/blackberry/i.test(t)}function R6(t=Tr()){return/webos/i.test(t)}function Y2(t=Tr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function cX(t=Tr()){var e;return Y2(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function uX(){return SZ()&&document.documentMode===10}function P6(t=Tr()){return Y2(t)||j6(t)||R6(t)||A6(t)||/windows phone/i.test(t)||I6(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L6(t,e=[]){let n;switch(t){case"Browser":n=qL(Tr());break;case"Worker":n=`${qL(Tr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Cm}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dX{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hX(t,e={}){return sa(t,"GET","/v2/passwordPolicy",ul(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fX=6;class mX{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:fX,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pX=class{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new GL(this),this.idTokenSubscription=new GL(this),this.beforeStateQueue=new dX(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=v6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Pa(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await HL.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await k6(this,{idToken:e}),r=await l_._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Fi(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ct(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await a_(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=KY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fi(this.app))return Promise.reject(Bo(this));const n=e?In(e):null;return n&&ct(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ct(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fi(this.app)?Promise.reject(Bo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fi(this.app)?Promise.reject(Bo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Pa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await hX(this),n=new mX(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new _0("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await lX(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Pa(e)||this._popupRedirectResolver;ct(n,this,"argument-error"),this.redirectPersistenceManager=await HL.create(this,[Pa(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ct(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ct(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=L6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&WY(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}};function dl(t){return In(t)}let GL=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=RZ(n=>this.observer=n)}get next(){return ct(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gX(t){Xw=t}function M6(t){return Xw.loadJS(t)}function yX(){return Xw.recaptchaEnterpriseScript}function xX(){return Xw.gapiScript}function vX(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const bX="recaptcha-enterprise",_X="NO_RECAPTCHA";class wX{constructor(e){this.type=bX,this.auth=dl(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{eX(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new JY(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;BL(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(_X)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&BL(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=yX();c.length!==0&&(c+=l),M6(c).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function KL(t,e,n,r=!1){const s=new wX(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function c_(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await KL(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await KL(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kX(t,e){const n=Yw(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(id(i,e??{}))return s;qi(s,"already-initialized")}return n.initialize({options:e})}function NX(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Pa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function EX(t,e,n){const r=dl(t);ct(r._canInitEmulator,r,"emulator-config-failed"),ct(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=O6(e),{host:o,port:l}=SX(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),TX()}function O6(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function SX(t){const e=O6(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:QL(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:QL(o)}}}function QL(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function TX(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X2=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ra("not implemented")}_getIdTokenResponse(e){return Ra("not implemented")}_linkToIdToken(e,n){return Ra("not implemented")}_getReauthenticationResolver(e){return Ra("not implemented")}};async function CX(t,e){return sa(t,"POST","/v1/accounts:update",e)}async function IX(t,e){return sa(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jX(t,e){return N0(t,"POST","/v1/accounts:signInWithPassword",ul(t,e))}async function AX(t,e){return sa(t,"POST","/v1/accounts:sendOobCode",ul(t,e))}async function RX(t,e){return AX(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PX(t,e){return N0(t,"POST","/v1/accounts:signInWithEmailLink",ul(t,e))}async function LX(t,e){return N0(t,"POST","/v1/accounts:signInWithEmailLink",ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by extends X2{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new by(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new by(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return c_(e,n,"signInWithPassword",jX);case"emailLink":return PX(e,{email:this._email,oobCode:this._password});default:qi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return c_(e,r,"signUpPassword",IX);case"emailLink":return LX(e,{idToken:n,email:this._email,oobCode:this._password});default:qi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vf(t,e){return N0(t,"POST","/v1/accounts:signInWithIdp",ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MX="http://localhost";let Jw=class FS extends X2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new FS(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):qi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Im(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new FS(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return vf(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,vf(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,vf(e,n)}buildRequest(){const e={requestUri:MX,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=w0(n)}return e}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OX(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DX(t){const e=sg(ig(t)).link,n=e?sg(ig(e)).deep_link_id:null,r=sg(ig(t)).deep_link_id;return(r?sg(ig(r)).link:null)||r||n||e||t}class J2{constructor(e){var n,r,s,i,o,l;const c=sg(ig(e)),d=(n=c.apiKey)!==null&&n!==void 0?n:null,h=(r=c.oobCode)!==null&&r!==void 0?r:null,m=OX((s=c.mode)!==null&&s!==void 0?s:null);ct(d&&h&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=h,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=DX(e);try{return new J2(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(){this.providerId=Ld.PROVIDER_ID}static credential(e,n){return by._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=J2.parseLink(n);return ct(r,"argument-error"),by._fromEmailAndCode(e,r.code,r.tenantId)}}Ld.PROVIDER_ID="password";Ld.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ld.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eI=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E0=class extends eI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D6=class jh extends E0{constructor(){super("facebook.com")}static credential(e){return Jw._fromParams({providerId:jh.PROVIDER_ID,signInMethod:jh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jh.credentialFromTaggedObject(e)}static credentialFromError(e){return jh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jh.credential(e.oauthAccessToken)}catch{return null}}};D6.FACEBOOK_SIGN_IN_METHOD="facebook.com";D6.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tI=class Ah extends E0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Jw._fromParams({providerId:Ah.PROVIDER_ID,signInMethod:Ah.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ah.credentialFromTaggedObject(e)}static credentialFromError(e){return Ah.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ah.credential(n,r)}catch{return null}}};tI.GOOGLE_SIGN_IN_METHOD="google.com";tI.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V6=class Rh extends E0{constructor(){super("github.com")}static credential(e){return Jw._fromParams({providerId:Rh.PROVIDER_ID,signInMethod:Rh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rh.credentialFromTaggedObject(e)}static credentialFromError(e){return Rh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rh.credential(e.oauthAccessToken)}catch{return null}}};V6.GITHUB_SIGN_IN_METHOD="github.com";V6.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F6=class Ph extends E0{constructor(){super("twitter.com")}static credential(e,n){return Jw._fromParams({providerId:Ph.PROVIDER_ID,signInMethod:Ph.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ph.credentialFromTaggedObject(e)}static credentialFromError(e){return Ph.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ph.credential(n,r)}catch{return null}}};F6.TWITTER_SIGN_IN_METHOD="twitter.com";F6.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VX(t,e){return N0(t,"POST","/v1/accounts:signUp",ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ek=class $S{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await l_._fromIdTokenResponse(e,r,s),o=ZL(r);return new $S({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=ZL(r);return new $S({user:e,providerId:s,_tokenResponse:r,operationType:n})}};function ZL(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FX=class BS extends Pd{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,BS.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new BS(e,n,r,s)}};function $6(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?FX._fromErrorAndOperation(t,i,e,r):i})}async function $X(t,e,n=!1){const r=await Ff(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ek._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B6(t,e,n=!1){const{auth:r}=t;if(Fi(r.app))return Promise.reject(Bo(r));const s="reauthenticate";try{const i=await Ff(t,$6(r,s,e,t),n);ct(i.idToken,r,"internal-error");const o=Z2(i.idToken);ct(o,r,"internal-error");const{sub:l}=o;return ct(t.uid===l,r,"user-mismatch"),ek._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&qi(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z6(t,e,n=!1){if(Fi(t.app))return Promise.reject(Bo(t));const r="signIn",s=await $6(t,r,e),i=await ek._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function BX(t,e){return z6(dl(t),e)}async function zX(t,e){return B6(In(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U6(t){const e=dl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function UX(t,e,n){const r=dl(t);await c_(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",RX)}async function WX(t,e,n){if(Fi(t.app))return Promise.reject(Bo(t));const r=dl(t),o=await c_(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",VX).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&U6(t),c}),l=await ek._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function HX(t,e,n){return Fi(t.app)?Promise.reject(Bo(t)):BX(In(t),Ld.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&U6(t),r})}function qX(t,e){const n=In(t);return Fi(n.auth.app)?Promise.reject(Bo(n.auth)):W6(n,e,null)}function GX(t,e){return W6(In(t),null,e)}async function W6(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await Ff(t,CX(r,i));await t._updateTokensIfNecessary(o,!0)}function KX(t,e,n,r){return In(t).onIdTokenChanged(e,n,r)}function QX(t,e,n){return In(t).beforeAuthStateChanged(e,n)}function ZX(t,e,n,r){return In(t).onAuthStateChanged(e,n,r)}function nI(t){return In(t).signOut()}async function YX(t){return In(t).delete()}const u_="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H6=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(u_,"1"),this.storage.removeItem(u_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XX=1e3,JX=10;let q6=class extends H6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=P6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);uX()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,JX):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},XX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}};q6.type="LOCAL";const eJ=q6;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G6=class extends H6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}};G6.type="SESSION";const K6=G6;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tJ(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q6=class Z6{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Z6(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),c=await tJ(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};Q6.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rI(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nJ=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const d=rI("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(){return window}function rJ(t){zo().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y6(){return typeof zo().WorkerGlobalScope<"u"&&typeof zo().importScripts=="function"}async function sJ(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function iJ(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function oJ(){return Y6()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X6="firebaseLocalStorageDb",aJ=1,d_="firebaseLocalStorage",J6="fbase_key";let S0=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function tk(t,e){return t.transaction([d_],e?"readwrite":"readonly").objectStore(d_)}function lJ(){const t=indexedDB.deleteDatabase(X6);return new S0(t).toPromise()}function zS(){const t=indexedDB.open(X6,aJ);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(d_,{keyPath:J6})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(d_)?e(r):(r.close(),await lJ(),e(await zS()))})})}async function YL(t,e,n){const r=tk(t,!0).put({[J6]:e,value:n});return new S0(r).toPromise()}async function cJ(t,e){const n=tk(t,!1).get(e),r=await new S0(n).toPromise();return r===void 0?null:r.value}function XL(t,e){const n=tk(t,!0).delete(e);return new S0(n).toPromise()}const uJ=800,dJ=3;let e$=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zS(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>dJ)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Y6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Q6._getInstance(oJ()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await sJ(),!this.activeServiceWorker)return;this.sender=new nJ(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||iJ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zS();return await YL(e,u_,"1"),await XL(e,u_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>YL(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>cJ(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>XL(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=tk(s,!1).getAll();return new S0(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),uJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};e$.type="LOCAL";const hJ=e$;new k0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t$(t,e){return e?Pa(e):(ct(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sI=class extends X2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vf(e,this._buildIdpRequest())}_linkToIdToken(e,n){return vf(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return vf(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function fJ(t){return z6(t.auth,new sI(t),t.bypassAuthState)}function mJ(t){const{auth:e,user:n}=t;return ct(n,e,"internal-error"),B6(n,new sI(t),t.bypassAuthState)}async function pJ(t){const{auth:e,user:n}=t;return ct(n,e,"internal-error"),$X(n,new sI(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n$=class{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fJ;case"linkViaPopup":case"linkViaRedirect":return pJ;case"reauthViaPopup":case"reauthViaRedirect":return mJ;default:qi(this.auth,"internal-error")}}resolve(e){Za(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Za(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gJ=new k0(2e3,1e4);async function yJ(t,e,n){if(Fi(t.app))return Promise.reject(go(t,"operation-not-supported-in-this-environment"));const r=dl(t);HY(t,e,eI);const s=t$(r,n);return new r$(r,"signInViaPopup",e,s).executeNotNull()}let r$=class ag extends n${constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ag.currentPopupAction&&ag.currentPopupAction.cancel(),ag.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ct(e,this.auth,"internal-error"),e}async onExecution(){Za(this.filter.length===1,"Popup operations only handle one event");const e=rI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(go(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(go(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ag.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(go(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,gJ.get())};e()}};r$.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xJ="pendingRedirect",ob=new Map;let vJ=class extends n${constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ob.get(this.auth._key());if(!e){try{const r=await bJ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ob.set(this.auth._key(),e)}return this.bypassAuthState||ob.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function bJ(t,e){const n=kJ(e),r=wJ(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function _J(t,e){ob.set(t._key(),e)}function wJ(t){return Pa(t._redirectPersistence)}function kJ(t){return sb(xJ,t.config.apiKey,t.name)}async function NJ(t,e,n=!1){if(Fi(t.app))return Promise.reject(Bo(t));const r=dl(t),s=t$(r,e),o=await new vJ(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EJ=10*60*1e3;let SJ=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TJ(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!s$(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(go(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EJ&&this.cachedEventUids.clear(),this.cachedEventUids.has(JL(e))}saveEventToCache(e){this.cachedEventUids.add(JL(e)),this.lastProcessedEventTime=Date.now()}};function JL(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function s$({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TJ(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return s$(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CJ(t,e={}){return sa(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IJ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jJ=/^https?/;async function AJ(t){if(t.config.emulator)return;const{authorizedDomains:e}=await CJ(t);for(const n of e)try{if(RJ(n))return}catch{}qi(t,"unauthorized-domain")}function RJ(t){const e=OS(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!jJ.test(n))return!1;if(IJ.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PJ=new k0(3e4,6e4);function eM(){const t=zo().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function LJ(t){return new Promise((e,n)=>{var r,s,i;function o(){eM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eM(),n(go(t,"network-request-failed"))},timeout:PJ.get()})}if(!((s=(r=zo().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=zo().gapi)===null||i===void 0)&&i.load)o();else{const l=vX("iframefcb");return zo()[l]=()=>{gapi.load?o():n(go(t,"network-request-failed"))},M6(`${xX()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw ab=null,e})}let ab=null;function MJ(t){return ab=ab||LJ(t),ab}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OJ=new k0(5e3,15e3),DJ="__/auth/iframe",VJ="emulator/auth/iframe",FJ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$J=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function BJ(t){const e=t.config;ct(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Q2(e,VJ):`https://${t.config.authDomain}/${DJ}`,r={apiKey:e.apiKey,appName:t.name,v:Cm},s=$J.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${w0(r).slice(1)}`}async function zJ(t){const e=await MJ(t),n=zo().gapi;return ct(n,t,"internal-error"),e.open({where:document.body,url:BJ(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FJ,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=go(t,"network-request-failed"),l=zo().setTimeout(()=>{i(o)},OJ.get());function c(){zo().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UJ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},WJ=500,HJ=600,qJ="_blank",GJ="http://localhost";let tM=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function KJ(t,e,n,r=WJ,s=HJ){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},UJ),{width:r.toString(),height:s.toString(),top:i,left:o}),d=Tr().toLowerCase();n&&(l=C6(d)?qJ:n),S6(d)&&(e=e||GJ,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[v,x])=>`${p}${v}=${x},`,"");if(cX(d)&&l!=="_self")return QJ(e||"",l),new tM(null);const m=window.open(e||"",l,h);ct(m,t,"popup-blocked");try{m.focus()}catch{}return new tM(m)}function QJ(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZJ="__/auth/handler",YJ="emulator/auth/handler",XJ=encodeURIComponent("fac");async function nM(t,e,n,r,s,i){ct(t.config.authDomain,t,"auth-domain-config-required"),ct(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Cm,eventId:s};if(e instanceof eI){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",AZ(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))o[h]=m}if(e instanceof E0){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),d=c?`#${XJ}=${encodeURIComponent(c)}`:"";return`${JJ(t)}?${w0(l).slice(1)}${d}`}function JJ({config:t}){return t.emulator?Q2(t,YJ):`https://${t.authDomain}/${ZJ}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN="webStorageSupport";let eee=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=K6,this._completeRedirectFn=NJ,this._overrideRedirectResult=_J}async _openPopup(e,n,r,s){var i;Za((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await nM(e,n,r,OS(),s);return KJ(e,o,rI())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await nM(e,n,r,OS(),s);return rJ(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Za(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await zJ(e),r=new SJ(e);return n.register("authEvent",s=>(ct(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(IN,{type:IN},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[IN];o!==void 0&&n(!!o),qi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=AJ(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return P6()||T6()||Y2()}};const tee=eee;var rM="@firebase/auth",sM="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nee=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ct(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ree(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function see(t){Vf(new od("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ct(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:L6(t)},d=new pX(r,s,i,c);return NX(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Vf(new od("auth-internal",e=>{const n=dl(e.getProvider("auth").getImmediate());return(r=>new nee(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),gc(rM,sM,ree(t)),gc(rM,sM,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iee=5*60,oee=l6("authIdTokenMaxAge")||iee;let iM=null;const aee=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>oee)return;const s=n==null?void 0:n.token;iM!==s&&(iM=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function i$(t=p6()){const e=Yw(t,"auth");if(e.isInitialized())return e.getImmediate();const n=kX(t,{popupRedirectResolver:tee,persistence:[hJ,eJ,K6]}),r=l6("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=aee(i.toString());QX(n,o,()=>o(n.currentUser)),KX(n,l=>o(l))}}const s=o6("auth");return s&&EX(n,`http://${s}`),n}function lee(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}gX({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=go("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",lee().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});see("Browser");var oM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Uu,o$;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,I){function O(){}O.prototype=I.prototype,R.D=I.prototype,R.prototype=new O,R.prototype.constructor=R,R.C=function(D,F,V){for(var $=Array(arguments.length-2),J=2;J<arguments.length;J++)$[J-2]=arguments[J];return I.prototype[F].apply(D,$)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,I,O){O||(O=0);var D=Array(16);if(typeof I=="string")for(var F=0;16>F;++F)D[F]=I.charCodeAt(O++)|I.charCodeAt(O++)<<8|I.charCodeAt(O++)<<16|I.charCodeAt(O++)<<24;else for(F=0;16>F;++F)D[F]=I[O++]|I[O++]<<8|I[O++]<<16|I[O++]<<24;I=R.g[0],O=R.g[1],F=R.g[2];var V=R.g[3],$=I+(V^O&(F^V))+D[0]+3614090360&4294967295;I=O+($<<7&4294967295|$>>>25),$=V+(F^I&(O^F))+D[1]+3905402710&4294967295,V=I+($<<12&4294967295|$>>>20),$=F+(O^V&(I^O))+D[2]+606105819&4294967295,F=V+($<<17&4294967295|$>>>15),$=O+(I^F&(V^I))+D[3]+3250441966&4294967295,O=F+($<<22&4294967295|$>>>10),$=I+(V^O&(F^V))+D[4]+4118548399&4294967295,I=O+($<<7&4294967295|$>>>25),$=V+(F^I&(O^F))+D[5]+1200080426&4294967295,V=I+($<<12&4294967295|$>>>20),$=F+(O^V&(I^O))+D[6]+2821735955&4294967295,F=V+($<<17&4294967295|$>>>15),$=O+(I^F&(V^I))+D[7]+4249261313&4294967295,O=F+($<<22&4294967295|$>>>10),$=I+(V^O&(F^V))+D[8]+1770035416&4294967295,I=O+($<<7&4294967295|$>>>25),$=V+(F^I&(O^F))+D[9]+2336552879&4294967295,V=I+($<<12&4294967295|$>>>20),$=F+(O^V&(I^O))+D[10]+4294925233&4294967295,F=V+($<<17&4294967295|$>>>15),$=O+(I^F&(V^I))+D[11]+2304563134&4294967295,O=F+($<<22&4294967295|$>>>10),$=I+(V^O&(F^V))+D[12]+1804603682&4294967295,I=O+($<<7&4294967295|$>>>25),$=V+(F^I&(O^F))+D[13]+4254626195&4294967295,V=I+($<<12&4294967295|$>>>20),$=F+(O^V&(I^O))+D[14]+2792965006&4294967295,F=V+($<<17&4294967295|$>>>15),$=O+(I^F&(V^I))+D[15]+1236535329&4294967295,O=F+($<<22&4294967295|$>>>10),$=I+(F^V&(O^F))+D[1]+4129170786&4294967295,I=O+($<<5&4294967295|$>>>27),$=V+(O^F&(I^O))+D[6]+3225465664&4294967295,V=I+($<<9&4294967295|$>>>23),$=F+(I^O&(V^I))+D[11]+643717713&4294967295,F=V+($<<14&4294967295|$>>>18),$=O+(V^I&(F^V))+D[0]+3921069994&4294967295,O=F+($<<20&4294967295|$>>>12),$=I+(F^V&(O^F))+D[5]+3593408605&4294967295,I=O+($<<5&4294967295|$>>>27),$=V+(O^F&(I^O))+D[10]+38016083&4294967295,V=I+($<<9&4294967295|$>>>23),$=F+(I^O&(V^I))+D[15]+3634488961&4294967295,F=V+($<<14&4294967295|$>>>18),$=O+(V^I&(F^V))+D[4]+3889429448&4294967295,O=F+($<<20&4294967295|$>>>12),$=I+(F^V&(O^F))+D[9]+568446438&4294967295,I=O+($<<5&4294967295|$>>>27),$=V+(O^F&(I^O))+D[14]+3275163606&4294967295,V=I+($<<9&4294967295|$>>>23),$=F+(I^O&(V^I))+D[3]+4107603335&4294967295,F=V+($<<14&4294967295|$>>>18),$=O+(V^I&(F^V))+D[8]+1163531501&4294967295,O=F+($<<20&4294967295|$>>>12),$=I+(F^V&(O^F))+D[13]+2850285829&4294967295,I=O+($<<5&4294967295|$>>>27),$=V+(O^F&(I^O))+D[2]+4243563512&4294967295,V=I+($<<9&4294967295|$>>>23),$=F+(I^O&(V^I))+D[7]+1735328473&4294967295,F=V+($<<14&4294967295|$>>>18),$=O+(V^I&(F^V))+D[12]+2368359562&4294967295,O=F+($<<20&4294967295|$>>>12),$=I+(O^F^V)+D[5]+4294588738&4294967295,I=O+($<<4&4294967295|$>>>28),$=V+(I^O^F)+D[8]+2272392833&4294967295,V=I+($<<11&4294967295|$>>>21),$=F+(V^I^O)+D[11]+1839030562&4294967295,F=V+($<<16&4294967295|$>>>16),$=O+(F^V^I)+D[14]+4259657740&4294967295,O=F+($<<23&4294967295|$>>>9),$=I+(O^F^V)+D[1]+2763975236&4294967295,I=O+($<<4&4294967295|$>>>28),$=V+(I^O^F)+D[4]+1272893353&4294967295,V=I+($<<11&4294967295|$>>>21),$=F+(V^I^O)+D[7]+4139469664&4294967295,F=V+($<<16&4294967295|$>>>16),$=O+(F^V^I)+D[10]+3200236656&4294967295,O=F+($<<23&4294967295|$>>>9),$=I+(O^F^V)+D[13]+681279174&4294967295,I=O+($<<4&4294967295|$>>>28),$=V+(I^O^F)+D[0]+3936430074&4294967295,V=I+($<<11&4294967295|$>>>21),$=F+(V^I^O)+D[3]+3572445317&4294967295,F=V+($<<16&4294967295|$>>>16),$=O+(F^V^I)+D[6]+76029189&4294967295,O=F+($<<23&4294967295|$>>>9),$=I+(O^F^V)+D[9]+3654602809&4294967295,I=O+($<<4&4294967295|$>>>28),$=V+(I^O^F)+D[12]+3873151461&4294967295,V=I+($<<11&4294967295|$>>>21),$=F+(V^I^O)+D[15]+530742520&4294967295,F=V+($<<16&4294967295|$>>>16),$=O+(F^V^I)+D[2]+3299628645&4294967295,O=F+($<<23&4294967295|$>>>9),$=I+(F^(O|~V))+D[0]+4096336452&4294967295,I=O+($<<6&4294967295|$>>>26),$=V+(O^(I|~F))+D[7]+1126891415&4294967295,V=I+($<<10&4294967295|$>>>22),$=F+(I^(V|~O))+D[14]+2878612391&4294967295,F=V+($<<15&4294967295|$>>>17),$=O+(V^(F|~I))+D[5]+4237533241&4294967295,O=F+($<<21&4294967295|$>>>11),$=I+(F^(O|~V))+D[12]+1700485571&4294967295,I=O+($<<6&4294967295|$>>>26),$=V+(O^(I|~F))+D[3]+2399980690&4294967295,V=I+($<<10&4294967295|$>>>22),$=F+(I^(V|~O))+D[10]+4293915773&4294967295,F=V+($<<15&4294967295|$>>>17),$=O+(V^(F|~I))+D[1]+2240044497&4294967295,O=F+($<<21&4294967295|$>>>11),$=I+(F^(O|~V))+D[8]+1873313359&4294967295,I=O+($<<6&4294967295|$>>>26),$=V+(O^(I|~F))+D[15]+4264355552&4294967295,V=I+($<<10&4294967295|$>>>22),$=F+(I^(V|~O))+D[6]+2734768916&4294967295,F=V+($<<15&4294967295|$>>>17),$=O+(V^(F|~I))+D[13]+1309151649&4294967295,O=F+($<<21&4294967295|$>>>11),$=I+(F^(O|~V))+D[4]+4149444226&4294967295,I=O+($<<6&4294967295|$>>>26),$=V+(O^(I|~F))+D[11]+3174756917&4294967295,V=I+($<<10&4294967295|$>>>22),$=F+(I^(V|~O))+D[2]+718787259&4294967295,F=V+($<<15&4294967295|$>>>17),$=O+(V^(F|~I))+D[9]+3951481745&4294967295,R.g[0]=R.g[0]+I&4294967295,R.g[1]=R.g[1]+(F+($<<21&4294967295|$>>>11))&4294967295,R.g[2]=R.g[2]+F&4294967295,R.g[3]=R.g[3]+V&4294967295}r.prototype.u=function(R,I){I===void 0&&(I=R.length);for(var O=I-this.blockSize,D=this.B,F=this.h,V=0;V<I;){if(F==0)for(;V<=O;)s(this,R,V),V+=this.blockSize;if(typeof R=="string"){for(;V<I;)if(D[F++]=R.charCodeAt(V++),F==this.blockSize){s(this,D),F=0;break}}else for(;V<I;)if(D[F++]=R[V++],F==this.blockSize){s(this,D),F=0;break}}this.h=F,this.o+=I},r.prototype.v=function(){var R=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);R[0]=128;for(var I=1;I<R.length-8;++I)R[I]=0;var O=8*this.o;for(I=R.length-8;I<R.length;++I)R[I]=O&255,O/=256;for(this.u(R),R=Array(16),I=O=0;4>I;++I)for(var D=0;32>D;D+=8)R[O++]=this.g[I]>>>D&255;return R};function i(R,I){var O=l;return Object.prototype.hasOwnProperty.call(O,R)?O[R]:O[R]=I(R)}function o(R,I){this.h=I;for(var O=[],D=!0,F=R.length-1;0<=F;F--){var V=R[F]|0;D&&V==I||(O[F]=V,D=!1)}this.g=O}var l={};function c(R){return-128<=R&&128>R?i(R,function(I){return new o([I|0],0>I?-1:0)}):new o([R|0],0>R?-1:0)}function d(R){if(isNaN(R)||!isFinite(R))return m;if(0>R)return E(d(-R));for(var I=[],O=1,D=0;R>=O;D++)I[D]=R/O|0,O*=4294967296;return new o(I,0)}function h(R,I){if(R.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(R.charAt(0)=="-")return E(h(R.substring(1),I));if(0<=R.indexOf("-"))throw Error('number format error: interior "-" character');for(var O=d(Math.pow(I,8)),D=m,F=0;F<R.length;F+=8){var V=Math.min(8,R.length-F),$=parseInt(R.substring(F,F+V),I);8>V?(V=d(Math.pow(I,V)),D=D.j(V).add(d($))):(D=D.j(O),D=D.add(d($)))}return D}var m=c(0),p=c(1),v=c(16777216);t=o.prototype,t.m=function(){if(b(this))return-E(this).m();for(var R=0,I=1,O=0;O<this.g.length;O++){var D=this.i(O);R+=(0<=D?D:4294967296+D)*I,I*=4294967296}return R},t.toString=function(R){if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(x(this))return"0";if(b(this))return"-"+E(this).toString(R);for(var I=d(Math.pow(R,6)),O=this,D="";;){var F=T(O,I).g;O=k(O,F.j(I));var V=((0<O.g.length?O.g[0]:O.h)>>>0).toString(R);if(O=F,x(O))return V+D;for(;6>V.length;)V="0"+V;D=V+D}},t.i=function(R){return 0>R?0:R<this.g.length?this.g[R]:this.h};function x(R){if(R.h!=0)return!1;for(var I=0;I<R.g.length;I++)if(R.g[I]!=0)return!1;return!0}function b(R){return R.h==-1}t.l=function(R){return R=k(this,R),b(R)?-1:x(R)?0:1};function E(R){for(var I=R.g.length,O=[],D=0;D<I;D++)O[D]=~R.g[D];return new o(O,~R.h).add(p)}t.abs=function(){return b(this)?E(this):this},t.add=function(R){for(var I=Math.max(this.g.length,R.g.length),O=[],D=0,F=0;F<=I;F++){var V=D+(this.i(F)&65535)+(R.i(F)&65535),$=(V>>>16)+(this.i(F)>>>16)+(R.i(F)>>>16);D=$>>>16,V&=65535,$&=65535,O[F]=$<<16|V}return new o(O,O[O.length-1]&-2147483648?-1:0)};function k(R,I){return R.add(E(I))}t.j=function(R){if(x(this)||x(R))return m;if(b(this))return b(R)?E(this).j(E(R)):E(E(this).j(R));if(b(R))return E(this.j(E(R)));if(0>this.l(v)&&0>R.l(v))return d(this.m()*R.m());for(var I=this.g.length+R.g.length,O=[],D=0;D<2*I;D++)O[D]=0;for(D=0;D<this.g.length;D++)for(var F=0;F<R.g.length;F++){var V=this.i(D)>>>16,$=this.i(D)&65535,J=R.i(F)>>>16,ue=R.i(F)&65535;O[2*D+2*F]+=$*ue,_(O,2*D+2*F),O[2*D+2*F+1]+=V*ue,_(O,2*D+2*F+1),O[2*D+2*F+1]+=$*J,_(O,2*D+2*F+1),O[2*D+2*F+2]+=V*J,_(O,2*D+2*F+2)}for(D=0;D<I;D++)O[D]=O[2*D+1]<<16|O[2*D];for(D=I;D<2*I;D++)O[D]=0;return new o(O,0)};function _(R,I){for(;(R[I]&65535)!=R[I];)R[I+1]+=R[I]>>>16,R[I]&=65535,I++}function S(R,I){this.g=R,this.h=I}function T(R,I){if(x(I))throw Error("division by zero");if(x(R))return new S(m,m);if(b(R))return I=T(E(R),I),new S(E(I.g),E(I.h));if(b(I))return I=T(R,E(I)),new S(E(I.g),I.h);if(30<R.g.length){if(b(R)||b(I))throw Error("slowDivide_ only works with positive integers.");for(var O=p,D=I;0>=D.l(R);)O=P(O),D=P(D);var F=j(O,1),V=j(D,1);for(D=j(D,2),O=j(O,2);!x(D);){var $=V.add(D);0>=$.l(R)&&(F=F.add(O),V=$),D=j(D,1),O=j(O,1)}return I=k(R,F.j(I)),new S(F,I)}for(F=m;0<=R.l(I);){for(O=Math.max(1,Math.floor(R.m()/I.m())),D=Math.ceil(Math.log(O)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),V=d(O),$=V.j(I);b($)||0<$.l(R);)O-=D,V=d(O),$=V.j(I);x(V)&&(V=p),F=F.add(V),R=k(R,$)}return new S(F,R)}t.A=function(R){return T(this,R).h},t.and=function(R){for(var I=Math.max(this.g.length,R.g.length),O=[],D=0;D<I;D++)O[D]=this.i(D)&R.i(D);return new o(O,this.h&R.h)},t.or=function(R){for(var I=Math.max(this.g.length,R.g.length),O=[],D=0;D<I;D++)O[D]=this.i(D)|R.i(D);return new o(O,this.h|R.h)},t.xor=function(R){for(var I=Math.max(this.g.length,R.g.length),O=[],D=0;D<I;D++)O[D]=this.i(D)^R.i(D);return new o(O,this.h^R.h)};function P(R){for(var I=R.g.length+1,O=[],D=0;D<I;D++)O[D]=R.i(D)<<1|R.i(D-1)>>>31;return new o(O,R.h)}function j(R,I){var O=I>>5;I%=32;for(var D=R.g.length-O,F=[],V=0;V<D;V++)F[V]=0<I?R.i(V+O)>>>I|R.i(V+O+1)<<32-I:R.i(V+O);return new o(F,R.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,o$=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Uu=o}).apply(typeof oM<"u"?oM:typeof self<"u"?self:typeof window<"u"?window:{});var gv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var a$,lg,l$,lb,US,c$,u$,d$;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,C,M){return g==Array.prototype||g==Object.prototype||(g[C]=M.value),g};function n(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof gv=="object"&&gv];for(var C=0;C<g.length;++C){var M=g[C];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var r=n(this);function s(g,C){if(C)e:{var M=r;g=g.split(".");for(var z=0;z<g.length-1;z++){var K=g[z];if(!(K in M))break e;M=M[K]}g=g[g.length-1],z=M[g],C=C(z),C!=z&&C!=null&&e(M,g,{configurable:!0,writable:!0,value:C})}}function i(g,C){g instanceof String&&(g+="");var M=0,z=!1,K={next:function(){if(!z&&M<g.length){var se=M++;return{value:C(se,g[se]),done:!1}}return z=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}s("Array.prototype.values",function(g){return g||function(){return i(this,function(C,M){return M})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(g){var C=typeof g;return C=C!="object"?C:g?Array.isArray(g)?"array":C:"null",C=="array"||C=="object"&&typeof g.length=="number"}function d(g){var C=typeof g;return C=="object"&&g!=null||C=="function"}function h(g,C,M){return g.call.apply(g.bind,arguments)}function m(g,C,M){if(!g)throw Error();if(2<arguments.length){var z=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,z),g.apply(C,K)}}return function(){return g.apply(C,arguments)}}function p(g,C,M){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:m,p.apply(null,arguments)}function v(g,C){var M=Array.prototype.slice.call(arguments,1);return function(){var z=M.slice();return z.push.apply(z,arguments),g.apply(this,z)}}function x(g,C){function M(){}M.prototype=C.prototype,g.aa=C.prototype,g.prototype=new M,g.prototype.constructor=g,g.Qb=function(z,K,se){for(var Ce=Array(arguments.length-2),en=2;en<arguments.length;en++)Ce[en-2]=arguments[en];return C.prototype[K].apply(z,Ce)}}function b(g){const C=g.length;if(0<C){const M=Array(C);for(let z=0;z<C;z++)M[z]=g[z];return M}return[]}function E(g,C){for(let M=1;M<arguments.length;M++){const z=arguments[M];if(c(z)){const K=g.length||0,se=z.length||0;g.length=K+se;for(let Ce=0;Ce<se;Ce++)g[K+Ce]=z[Ce]}else g.push(z)}}class k{constructor(C,M){this.i=C,this.j=M,this.h=0,this.g=null}get(){let C;return 0<this.h?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function _(g){return/^[\s\xa0]*$/.test(g)}function S(){var g=l.navigator;return g&&(g=g.userAgent)?g:""}function T(g){return T[" "](g),g}T[" "]=function(){};var P=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function j(g,C,M){for(const z in g)C.call(M,g[z],z,g)}function R(g,C){for(const M in g)C.call(void 0,g[M],M,g)}function I(g){const C={};for(const M in g)C[M]=g[M];return C}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(g,C){let M,z;for(let K=1;K<arguments.length;K++){z=arguments[K];for(M in z)g[M]=z[M];for(let se=0;se<O.length;se++)M=O[se],Object.prototype.hasOwnProperty.call(z,M)&&(g[M]=z[M])}}function F(g){var C=1;g=g.split(":");const M=[];for(;0<C&&g.length;)M.push(g.shift()),C--;return g.length&&M.push(g.join(":")),M}function V(g){l.setTimeout(()=>{throw g},0)}function $(){var g=Q;let C=null;return g.g&&(C=g.g,g.g=g.g.next,g.g||(g.h=null),C.next=null),C}class J{constructor(){this.h=this.g=null}add(C,M){const z=ue.get();z.set(C,M),this.h?this.h.next=z:this.g=z,this.h=z}}var ue=new k(()=>new ve,g=>g.reset());class ve{constructor(){this.next=this.g=this.h=null}set(C,M){this.h=C,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let le,q=!1,Q=new J,H=()=>{const g=l.Promise.resolve(void 0);le=()=>{g.then(X)}};var X=()=>{for(var g;g=$();){try{g.h.call(g.g)}catch(M){V(M)}var C=ue;C.j(g),100>C.h&&(C.h++,g.next=C.g,C.g=g)}q=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ae(g,C){this.type=g,this.g=this.target=C,this.defaultPrevented=!1}ae.prototype.h=function(){this.defaultPrevented=!0};var je=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,C=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const M=()=>{};l.addEventListener("test",M,C),l.removeEventListener("test",M,C)}catch{}return g}();function ge(g,C){if(ae.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var M=this.type=g.type,z=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=C,C=g.relatedTarget){if(P){e:{try{T(C.nodeName);var K=!0;break e}catch{}K=!1}K||(C=null)}}else M=="mouseover"?C=g.fromElement:M=="mouseout"&&(C=g.toElement);this.relatedTarget=C,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:te[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&ge.aa.h.call(this)}}x(ge,ae);var te={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var be="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function vt(g,C,M,z,K){this.listener=g,this.proxy=null,this.src=C,this.type=M,this.capture=!!z,this.ha=K,this.key=++Fe,this.da=this.fa=!1}function ce(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Be(g){this.src=g,this.g={},this.h=0}Be.prototype.add=function(g,C,M,z,K){var se=g.toString();g=this.g[se],g||(g=this.g[se]=[],this.h++);var Ce=pe(g,C,z,K);return-1<Ce?(C=g[Ce],M||(C.fa=!1)):(C=new vt(C,this.src,se,!!z,K),C.fa=M,g.push(C)),C};function Ye(g,C){var M=C.type;if(M in g.g){var z=g.g[M],K=Array.prototype.indexOf.call(z,C,void 0),se;(se=0<=K)&&Array.prototype.splice.call(z,K,1),se&&(ce(C),g.g[M].length==0&&(delete g.g[M],g.h--))}}function pe(g,C,M,z){for(var K=0;K<g.length;++K){var se=g[K];if(!se.da&&se.listener==C&&se.capture==!!M&&se.ha==z)return K}return-1}var bt="closure_lm_"+(1e6*Math.random()|0),Ht={};function vr(g,C,M,z,K){if(Array.isArray(C)){for(var se=0;se<C.length;se++)vr(g,C[se],M,z,K);return null}return M=_e(M),g&&g[be]?g.K(C,M,d(z)?!!z.capture:!1,K):nr(g,C,M,!1,z,K)}function nr(g,C,M,z,K,se){if(!C)throw Error("Invalid event type");var Ce=d(K)?!!K.capture:!!K,en=Ae(g);if(en||(g[bt]=en=new Be(g)),M=en.add(C,M,z,Ce,se),M.proxy)return M;if(z=at(),M.proxy=z,z.src=g,z.listener=M,g.addEventListener)je||(K=Ce),K===void 0&&(K=!1),g.addEventListener(C.toString(),z,K);else if(g.attachEvent)g.attachEvent(G(C.toString()),z);else if(g.addListener&&g.removeListener)g.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return M}function at(){function g(M){return C.call(g.src,g.listener,M)}const C=re;return g}function he(g,C,M,z,K){if(Array.isArray(C))for(var se=0;se<C.length;se++)he(g,C[se],M,z,K);else z=d(z)?!!z.capture:!!z,M=_e(M),g&&g[be]?(g=g.i,C=String(C).toString(),C in g.g&&(se=g.g[C],M=pe(se,M,z,K),-1<M&&(ce(se[M]),Array.prototype.splice.call(se,M,1),se.length==0&&(delete g.g[C],g.h--)))):g&&(g=Ae(g))&&(C=g.g[C.toString()],g=-1,C&&(g=pe(C,M,z,K)),(M=-1<g?C[g]:null)&&U(M))}function U(g){if(typeof g!="number"&&g&&!g.da){var C=g.src;if(C&&C[be])Ye(C.i,g);else{var M=g.type,z=g.proxy;C.removeEventListener?C.removeEventListener(M,z,g.capture):C.detachEvent?C.detachEvent(G(M),z):C.addListener&&C.removeListener&&C.removeListener(z),(M=Ae(C))?(Ye(M,g),M.h==0&&(M.src=null,C[bt]=null)):ce(g)}}}function G(g){return g in Ht?Ht[g]:Ht[g]="on"+g}function re(g,C){if(g.da)g=!0;else{C=new ge(C,this);var M=g.listener,z=g.ha||g.src;g.fa&&U(g),g=M.call(z,C)}return g}function Ae(g){return g=g[bt],g instanceof Be?g:null}var Te="__closure_events_fn_"+(1e9*Math.random()>>>0);function _e(g){return typeof g=="function"?g:(g[Te]||(g[Te]=function(C){return g.handleEvent(C)}),g[Te])}function Pe(){oe.call(this),this.i=new Be(this),this.M=this,this.F=null}x(Pe,oe),Pe.prototype[be]=!0,Pe.prototype.removeEventListener=function(g,C,M,z){he(this,g,C,M,z)};function lt(g,C){var M,z=g.F;if(z)for(M=[];z;z=z.F)M.push(z);if(g=g.M,z=C.type||C,typeof C=="string")C=new ae(C,g);else if(C instanceof ae)C.target=C.target||g;else{var K=C;C=new ae(z,g),D(C,K)}if(K=!0,M)for(var se=M.length-1;0<=se;se--){var Ce=C.g=M[se];K=Vt(Ce,z,!0,C)&&K}if(Ce=C.g=g,K=Vt(Ce,z,!0,C)&&K,K=Vt(Ce,z,!1,C)&&K,M)for(se=0;se<M.length;se++)Ce=C.g=M[se],K=Vt(Ce,z,!1,C)&&K}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var g=this.i,C;for(C in g.g){for(var M=g.g[C],z=0;z<M.length;z++)ce(M[z]);delete g.g[C],g.h--}}this.F=null},Pe.prototype.K=function(g,C,M,z){return this.i.add(String(g),C,!1,M,z)},Pe.prototype.L=function(g,C,M,z){return this.i.add(String(g),C,!0,M,z)};function Vt(g,C,M,z){if(C=g.i.g[String(C)],!C)return!0;C=C.concat();for(var K=!0,se=0;se<C.length;++se){var Ce=C[se];if(Ce&&!Ce.da&&Ce.capture==M){var en=Ce.listener,ur=Ce.ha||Ce.src;Ce.fa&&Ye(g.i,Ce),K=en.call(ur,z)!==!1&&K}}return K&&!z.defaultPrevented}function Wr(g,C,M){if(typeof g=="function")M&&(g=p(g,M));else if(g&&typeof g.handleEvent=="function")g=p(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(C)?-1:l.setTimeout(g,C||0)}function ko(g){g.g=Wr(()=>{g.g=null,g.i&&(g.i=!1,ko(g))},g.l);const C=g.h;g.h=null,g.m.apply(null,C)}class Xs extends oe{constructor(C,M){super(),this.m=C,this.l=M,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:ko(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function aa(g){oe.call(this),this.h=g,this.g={}}x(aa,oe);var la=[];function No(g){j(g.g,function(C,M){this.g.hasOwnProperty(M)&&U(C)},g),g.g={}}aa.prototype.N=function(){aa.aa.N.call(this),No(this)},aa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yl=l.JSON.stringify,Yd=l.JSON.parse,ca=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function xl(){}xl.prototype.h=null;function wx(g){return g.h||(g.h=g.i())}function Jm(){}var vl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xd(){ae.call(this,"d")}x(Xd,ae);function ep(){ae.call(this,"c")}x(ep,ae);var ua={},kx=null;function Jd(){return kx=kx||new Pe}ua.La="serverreachability";function Nx(g){ae.call(this,ua.La,g)}x(Nx,ae);function iu(g){const C=Jd();lt(C,new Nx(C))}ua.STAT_EVENT="statevent";function eh(g,C){ae.call(this,ua.STAT_EVENT,g),this.stat=C}x(eh,ae);function Hr(g){const C=Jd();lt(C,new eh(C,g))}ua.Ma="timingevent";function Ex(g,C){ae.call(this,ua.Ma,g),this.size=C}x(Ex,ae);function ou(g,C){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},C)}function au(){this.g=!0}au.prototype.xa=function(){this.g=!1};function ki(g,C,M,z,K,se){g.info(function(){if(g.g)if(se)for(var Ce="",en=se.split("&"),ur=0;ur<en.length;ur++){var Ft=en[ur].split("=");if(1<Ft.length){var an=Ft[0];Ft=Ft[1];var Dn=an.split("_");Ce=2<=Dn.length&&Dn[1]=="type"?Ce+(an+"="+Ft+"&"):Ce+(an+"=redacted&")}}else Ce=null;else Ce=se;return"XMLHTTP REQ ("+z+") [attempt "+K+"]: "+C+`
`+M+`
`+Ce})}function Ze(g,C,M,z,K,se,Ce){g.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+K+"]: "+C+`
`+M+`
`+se+" "+Ce})}function da(g,C,M,z){g.info(function(){return"XMLHTTP TEXT ("+C+"): "+Tx(g,M)+(z?" "+z:"")})}function Sx(g,C){g.info(function(){return"TIMEOUT: "+C})}au.prototype.info=function(){};function Tx(g,C){if(!g.g)return C;if(!C)return null;try{var M=JSON.parse(C);if(M){for(g=0;g<M.length;g++)if(Array.isArray(M[g])){var z=M[g];if(!(2>z.length)){var K=z[1];if(Array.isArray(K)&&!(1>K.length)){var se=K[0];if(se!="noop"&&se!="stop"&&se!="close")for(var Ce=1;Ce<K.length;Ce++)K[Ce]=""}}}}return yl(M)}catch{return C}}var lu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},th={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},nh;function Qi(){}x(Qi,xl),Qi.prototype.g=function(){return new XMLHttpRequest},Qi.prototype.i=function(){return{}},nh=new Qi;function Zi(g,C,M,z){this.j=g,this.i=C,this.l=M,this.R=z||1,this.U=new aa(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Cx}function Cx(){this.i=null,this.g="",this.h=!1}var Ix={},tp={};function np(g,C,M){g.L=1,g.v=Ei(Kn(C)),g.m=M,g.P=!0,rp(g,null)}function rp(g,C){g.F=Date.now(),sh(g),g.A=Kn(g.v);var M=g.A,z=g.R;Array.isArray(z)||(z=[String(z)]),Rx(M.i,"t",z),g.C=0,M=g.j.J,g.h=new Cx,g.g=Fx(g.j,M?C:null,!g.m),0<g.O&&(g.M=new Xs(p(g.Y,g,g.g),g.O)),C=g.U,M=g.g,z=g.ca;var K="readystatechange";Array.isArray(K)||(K&&(la[0]=K.toString()),K=la);for(var se=0;se<K.length;se++){var Ce=vr(M,K[se],z||C.handleEvent,!1,C.h||C);if(!Ce)break;C.g[Ce.key]=Ce}C=g.H?I(g.H):{},g.m?(g.u||(g.u="POST"),C["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,C)):(g.u="GET",g.g.ea(g.A,g.u,null,C)),iu(),ki(g.i,g.u,g.A,g.l,g.R,g.m)}Zi.prototype.ca=function(g){g=g.target;const C=this.M;C&&_s(g)==3?C.j():this.Y(g)},Zi.prototype.Y=function(g){try{if(g==this.g)e:{const Dn=_s(this.g);var C=this.g.Ba();const Sl=this.g.Z();if(!(3>Dn)&&(Dn!=3||this.g&&(this.h.h||this.g.oa()||vp(this.g)))){this.J||Dn!=4||C==7||(C==8||0>=Sl?iu(3):iu(2)),sp(this);var M=this.g.Z();this.X=M;t:if(jx(this)){var z=vp(this.g);g="";var K=z.length,se=_s(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ha(this),cu(this);var Ce="";break t}this.h.i=new l.TextDecoder}for(C=0;C<K;C++)this.h.h=!0,g+=this.h.i.decode(z[C],{stream:!(se&&C==K-1)});z.length=0,this.h.g+=g,this.C=0,Ce=this.h.g}else Ce=this.g.oa();if(this.o=M==200,Ze(this.i,this.u,this.A,this.l,this.R,Dn,M),this.o){if(this.T&&!this.K){t:{if(this.g){var en,ur=this.g;if((en=ur.g?ur.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(en)){var Ft=en;break t}}Ft=null}if(M=Ft)da(this.i,this.l,M,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,uu(this,M);else{this.o=!1,this.s=3,Hr(12),ha(this),cu(this);break e}}if(this.P){M=!0;let rr;for(;!this.J&&this.C<Ce.length;)if(rr=rh(this,Ce),rr==tp){Dn==4&&(this.s=4,Hr(14),M=!1),da(this.i,this.l,null,"[Incomplete Response]");break}else if(rr==Ix){this.s=4,Hr(15),da(this.i,this.l,Ce,"[Invalid Chunk]"),M=!1;break}else da(this.i,this.l,rr,null),uu(this,rr);if(jx(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Dn!=4||Ce.length!=0||this.h.h||(this.s=1,Hr(16),M=!1),this.o=this.o&&M,!M)da(this.i,this.l,Ce,"[Invalid Chunked Response]"),ha(this),cu(this);else if(0<Ce.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+Ce.length),fh(an),an.M=!0,Hr(11))}}else da(this.i,this.l,Ce,null),uu(this,Ce);Dn==4&&ha(this),this.o&&!this.J&&(Dn==4?_p(this.j,this):(this.o=!1,sh(this)))}else U1(this.g),M==400&&0<Ce.indexOf("Unknown SID")?(this.s=3,Hr(12)):(this.s=0,Hr(13)),ha(this),cu(this)}}}catch{}finally{}};function jx(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function rh(g,C){var M=g.C,z=C.indexOf(`
`,M);return z==-1?tp:(M=Number(C.substring(M,z)),isNaN(M)?Ix:(z+=1,z+M>C.length?tp:(C=C.slice(z,z+M),g.C=z+M,C)))}Zi.prototype.cancel=function(){this.J=!0,ha(this)};function sh(g){g.S=Date.now()+g.I,Ax(g,g.I)}function Ax(g,C){if(g.B!=null)throw Error("WatchDog timer not null");g.B=ou(p(g.ba,g),C)}function sp(g){g.B&&(l.clearTimeout(g.B),g.B=null)}Zi.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(Sx(this.i,this.A),this.L!=2&&(iu(),Hr(17)),ha(this),this.s=2,cu(this)):Ax(this,this.S-g)};function cu(g){g.j.G==0||g.J||_p(g.j,g)}function ha(g){sp(g);var C=g.M;C&&typeof C.ma=="function"&&C.ma(),g.M=null,No(g.U),g.g&&(C=g.g,g.g=null,C.abort(),C.ma())}function uu(g,C){try{var M=g.j;if(M.G!=0&&(M.g==g||Lt(M.h,g))){if(!g.K&&Lt(M.h,g)&&M.G==3){try{var z=M.Da.g.parse(C)}catch{z=null}if(Array.isArray(z)&&z.length==3){var K=z;if(K[0]==0){e:if(!M.u){if(M.g)if(M.g.F+3e3<g.F)ph(M),dh(M);else break e;hh(M),Hr(18)}}else M.za=K[1],0<M.za-M.T&&37500>K[2]&&M.F&&M.v==0&&!M.C&&(M.C=ou(p(M.Za,M),6e3));if(1>=bl(M.h)&&M.ca){try{M.ca()}catch{}M.ca=void 0}}else ya(M,11)}else if((g.K||M.g==g)&&ph(M),!_(C))for(K=M.Da.g.parse(C),C=0;C<K.length;C++){let Ft=K[C];if(M.T=Ft[0],Ft=Ft[1],M.G==2)if(Ft[0]=="c"){M.K=Ft[1],M.ia=Ft[2];const an=Ft[3];an!=null&&(M.la=an,M.j.info("VER="+M.la));const Dn=Ft[4];Dn!=null&&(M.Aa=Dn,M.j.info("SVER="+M.Aa));const Sl=Ft[5];Sl!=null&&typeof Sl=="number"&&0<Sl&&(z=1.5*Sl,M.L=z,M.j.info("backChannelRequestTimeoutMs_="+z)),z=M;const rr=g.g;if(rr){const yh=rr.g?rr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yh){var se=z.h;se.g||yh.indexOf("spdy")==-1&&yh.indexOf("quic")==-1&&yh.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(fn(se,se.h),se.h=null))}if(z.D){const To=rr.g?rr.g.getResponseHeader("X-HTTP-Session-Id"):null;To&&(z.ya=To,ut(z.I,z.D,To))}}M.G=3,M.l&&M.l.ua(),M.ba&&(M.R=Date.now()-g.F,M.j.info("Handshake RTT: "+M.R+"ms")),z=M;var Ce=g;if(z.qa=gh(z,z.J?z.ia:null,z.W),Ce.K){hu(z.h,Ce);var en=Ce,ur=z.L;ur&&(en.I=ur),en.B&&(sp(en),sh(en)),z.g=Ce}else Ji(z);0<M.i.length&&El(M)}else Ft[0]!="stop"&&Ft[0]!="close"||ya(M,7);else M.G==3&&(Ft[0]=="stop"||Ft[0]=="close"?Ft[0]=="stop"?ya(M,7):uh(M):Ft[0]!="noop"&&M.l&&M.l.ta(Ft),M.v=0)}}iu(4)}catch{}}var du=class{constructor(g,C){this.g=g,this.map=C}};function ip(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function op(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function bl(g){return g.h?1:g.g?g.g.size:0}function Lt(g,C){return g.h?g.h==C:g.g?g.g.has(C):!1}function fn(g,C){g.g?g.g.add(C):g.h=C}function hu(g,C){g.h&&g.h==C?g.h=null:g.g&&g.g.has(C)&&g.g.delete(C)}ip.prototype.cancel=function(){if(this.i=fa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function fa(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let C=g.i;for(const M of g.g.values())C=C.concat(M.D);return C}return b(g.i)}function _l(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(c(g)){for(var C=[],M=g.length,z=0;z<M;z++)C.push(g[z]);return C}C=[],M=0;for(z in g)C[M++]=g[z];return C}function ap(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(c(g)||typeof g=="string"){var C=[];g=g.length;for(var M=0;M<g;M++)C.push(M);return C}C=[],M=0;for(const z in g)C[M++]=z;return C}}}function yt(g,C){if(g.forEach&&typeof g.forEach=="function")g.forEach(C,void 0);else if(c(g)||typeof g=="string")Array.prototype.forEach.call(g,C,void 0);else for(var M=ap(g),z=_l(g),K=z.length,se=0;se<K;se++)C.call(void 0,z[se],M&&M[se],g)}var jn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lp(g,C){if(g){g=g.split("&");for(var M=0;M<g.length;M++){var z=g[M].indexOf("="),K=null;if(0<=z){var se=g[M].substring(0,z);K=g[M].substring(z+1)}else se=g[M];C(se,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Ni(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof Ni){this.h=g.h,ih(this,g.j),this.o=g.o,this.g=g.g,ma(this,g.s),this.l=g.l;var C=g.i,M=new pa;M.i=C.i,C.g&&(M.g=new Map(C.g),M.h=C.h),Eo(this,M),this.m=g.m}else g&&(C=String(g).match(jn))?(this.h=!1,ih(this,C[1]||"",!0),this.o=Yi(C[2]||""),this.g=Yi(C[3]||"",!0),ma(this,C[4]),this.l=Yi(C[5]||"",!0),Eo(this,C[6]||"",!0),this.m=Yi(C[7]||"")):(this.h=!1,this.i=new pa(null,this.h))}Ni.prototype.toString=function(){var g=[],C=this.j;C&&g.push(Xi(C,wl,!0),":");var M=this.g;return(M||C=="file")&&(g.push("//"),(C=this.o)&&g.push(Xi(C,wl,!0),"@"),g.push(encodeURIComponent(String(M)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.s,M!=null&&g.push(":",String(M))),(M=this.l)&&(this.g&&M.charAt(0)!="/"&&g.push("/"),g.push(Xi(M,M.charAt(0)=="/"?dp:up,!0))),(M=this.i.toString())&&g.push("?",M),(M=this.m)&&g.push("#",Xi(M,hp)),g.join("")};function Kn(g){return new Ni(g)}function ih(g,C,M){g.j=M?Yi(C,!0):C,g.j&&(g.j=g.j.replace(/:$/,""))}function ma(g,C){if(C){if(C=Number(C),isNaN(C)||0>C)throw Error("Bad port number "+C);g.s=C}else g.s=null}function Eo(g,C,M){C instanceof pa?(g.i=C,Si(g.i,g.h)):(M||(C=Xi(C,oh)),g.i=new pa(C,g.h))}function ut(g,C,M){g.i.set(C,M)}function Ei(g){return ut(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function Yi(g,C){return g?C?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Xi(g,C,M){return typeof g=="string"?(g=encodeURI(g).replace(C,cp),M&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function cp(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var wl=/[#\/\?@]/g,up=/[#\?:]/g,dp=/[#\?]/g,oh=/[#\?@]/g,hp=/#/g;function pa(g,C){this.h=this.g=null,this.i=g||null,this.j=!!C}function Js(g){g.g||(g.g=new Map,g.h=0,g.i&&lp(g.i,function(C,M){g.add(decodeURIComponent(C.replace(/\+/g," ")),M)}))}t=pa.prototype,t.add=function(g,C){Js(this),this.i=null,g=st(this,g);var M=this.g.get(g);return M||this.g.set(g,M=[]),M.push(C),this.h+=1,this};function fp(g,C){Js(g),C=st(g,C),g.g.has(C)&&(g.i=null,g.h-=g.g.get(C).length,g.g.delete(C))}function ah(g,C){return Js(g),C=st(g,C),g.g.has(C)}t.forEach=function(g,C){Js(this),this.g.forEach(function(M,z){M.forEach(function(K){g.call(C,K,z,this)},this)},this)},t.na=function(){Js(this);const g=Array.from(this.g.values()),C=Array.from(this.g.keys()),M=[];for(let z=0;z<C.length;z++){const K=g[z];for(let se=0;se<K.length;se++)M.push(C[z])}return M},t.V=function(g){Js(this);let C=[];if(typeof g=="string")ah(this,g)&&(C=C.concat(this.g.get(st(this,g))));else{g=Array.from(this.g.values());for(let M=0;M<g.length;M++)C=C.concat(g[M])}return C},t.set=function(g,C){return Js(this),this.i=null,g=st(this,g),ah(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[C]),this.h+=1,this},t.get=function(g,C){return g?(g=this.V(g),0<g.length?String(g[0]):C):C};function Rx(g,C,M){fp(g,C),0<M.length&&(g.i=null,g.g.set(st(g,C),b(M)),g.h+=M.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],C=Array.from(this.g.keys());for(var M=0;M<C.length;M++){var z=C[M];const se=encodeURIComponent(String(z)),Ce=this.V(z);for(z=0;z<Ce.length;z++){var K=se;Ce[z]!==""&&(K+="="+encodeURIComponent(String(Ce[z]))),g.push(K)}}return this.i=g.join("&")};function st(g,C){return C=String(C),g.j&&(C=C.toLowerCase()),C}function Si(g,C){C&&!g.j&&(Js(g),g.i=null,g.g.forEach(function(M,z){var K=z.toLowerCase();z!=K&&(fp(this,z),Rx(this,K,M))},g)),g.j=C}function on(g,C){const M=new au;if(l.Image){const z=new Image;z.onload=v(Ti,M,"TestLoadImage: loaded",!0,C,z),z.onerror=v(Ti,M,"TestLoadImage: error",!1,C,z),z.onabort=v(Ti,M,"TestLoadImage: abort",!1,C,z),z.ontimeout=v(Ti,M,"TestLoadImage: timeout",!1,C,z),l.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=g}else C(!1)}function Px(g,C){const M=new au,z=new AbortController,K=setTimeout(()=>{z.abort(),Ti(M,"TestPingServer: timeout",!1,C)},1e4);fetch(g,{signal:z.signal}).then(se=>{clearTimeout(K),se.ok?Ti(M,"TestPingServer: ok",!0,C):Ti(M,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(K),Ti(M,"TestPingServer: error",!1,C)})}function Ti(g,C,M,z,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),z(M)}catch{}}function mp(){this.g=new ca}function pp(g,C,M){const z=M||"";try{yt(g,function(K,se){let Ce=K;d(K)&&(Ce=yl(K)),C.push(z+se+"="+encodeURIComponent(Ce))})}catch(K){throw C.push(z+"type="+encodeURIComponent("_badmap")),K}}function Ci(g){this.l=g.Ub||null,this.j=g.eb||!1}x(Ci,xl),Ci.prototype.g=function(){return new kl(this.l,this.j)},Ci.prototype.i=function(g){return function(){return g}}({});function kl(g,C){Pe.call(this),this.D=g,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(kl,Pe),t=kl.prototype,t.open=function(g,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=C,this.readyState=1,ei(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const C={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(C.body=g),(this.D||l).fetch(new Request(this.A,C)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,On(this)),this.readyState=0},t.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,ei(this)),this.g&&(this.readyState=3,ei(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nl(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nl(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}t.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var C=g.value?g.value:new Uint8Array(0);(C=this.v.decode(C,{stream:!g.done}))&&(this.response=this.responseText+=C)}g.done?On(this):ei(this),this.readyState==3&&Nl(this)}},t.Ra=function(g){this.g&&(this.response=this.responseText=g,On(this))},t.Qa=function(g){this.g&&(this.response=g,On(this))},t.ga=function(){this.g&&On(this)};function On(g){g.readyState=4,g.l=null,g.j=null,g.v=null,ei(g)}t.setRequestHeader=function(g,C){this.u.append(g,C)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],C=this.h.entries();for(var M=C.next();!M.done;)M=M.value,g.push(M[0]+": "+M[1]),M=C.next();return g.join(`\r
`)};function ei(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(kl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function gp(g){let C="";return j(g,function(M,z){C+=z,C+=":",C+=M,C+=`\r
`}),C}function lh(g,C,M){e:{for(z in M){var z=!1;break e}z=!0}z||(M=gp(M),typeof g=="string"?M!=null&&encodeURIComponent(String(M)):ut(g,C,M))}function An(g){Pe.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(An,Pe);var Lx=/^https?$/i,yp=["POST","PUT"];t=An.prototype,t.Ha=function(g){this.J=g},t.ea=function(g,C,M,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);C=C?C.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():nh.g(),this.v=this.o?wx(this.o):wx(nh),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(C,String(g),!0),this.B=!1}catch(se){Mx(this,se);return}if(g=M||"",M=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var K in z)M.set(K,z[K]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const se of z.keys())M.set(se,z.get(se));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(M.keys()).find(se=>se.toLowerCase()=="content-type"),K=l.FormData&&g instanceof l.FormData,!(0<=Array.prototype.indexOf.call(yp,C,void 0))||z||K||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,Ce]of M)this.g.setRequestHeader(se,Ce);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Os(this),this.u=!0,this.g.send(g),this.u=!1}catch(se){Mx(this,se)}};function Mx(g,C){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=C,g.m=5,xp(g),ch(g)}function xp(g){g.A||(g.A=!0,lt(g,"complete"),lt(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,lt(this,"complete"),lt(this,"abort"),ch(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ch(this,!0)),An.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rt(this):this.bb())},t.bb=function(){Rt(this)};function Rt(g){if(g.h&&typeof o<"u"&&(!g.v[1]||_s(g)!=4||g.Z()!=2)){if(g.u&&_s(g)==4)Wr(g.Ea,0,g);else if(lt(g,"readystatechange"),_s(g)==4){g.h=!1;try{const Ce=g.Z();e:switch(Ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var M;if(!(M=C)){var z;if(z=Ce===0){var K=String(g.D).match(jn)[1]||null;!K&&l.self&&l.self.location&&(K=l.self.location.protocol.slice(0,-1)),z=!Lx.test(K?K.toLowerCase():"")}M=z}if(M)lt(g,"complete"),lt(g,"success");else{g.m=6;try{var se=2<_s(g)?g.g.statusText:""}catch{se=""}g.l=se+" ["+g.Z()+"]",xp(g)}}finally{ch(g)}}}}function ch(g,C){if(g.g){Os(g);const M=g.g,z=g.v[0]?()=>{}:null;g.g=null,g.v=null,C||lt(g,"ready");try{M.onreadystatechange=z}catch{}}}function Os(g){g.I&&(l.clearTimeout(g.I),g.I=null)}t.isActive=function(){return!!this.g};function _s(g){return g.g?g.g.readyState:0}t.Z=function(){try{return 2<_s(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(g){if(this.g){var C=this.g.responseText;return g&&C.indexOf(g)==0&&(C=C.substring(g.length)),Yd(C)}};function vp(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function U1(g){const C={};g=(g.g&&2<=_s(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<g.length;z++){if(_(g[z]))continue;var M=F(g[z]);const K=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const se=C[K]||[];C[K]=se,se.push(M)}R(C,function(z){return z.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ga(g,C,M){return M&&M.internalChannelParams&&M.internalChannelParams[g]||C}function Ox(g){this.Aa=0,this.i=[],this.j=new au,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ga("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ga("baseRetryDelayMs",5e3,g),this.cb=ga("retryDelaySeedMs",1e4,g),this.Wa=ga("forwardChannelMaxRetries",2,g),this.wa=ga("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new ip(g&&g.concurrentRequestLimit),this.Da=new mp,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ox.prototype,t.la=8,t.G=1,t.connect=function(g,C,M,z){Hr(0),this.W=g,this.H=C||{},M&&z!==void 0&&(this.H.OSID=M,this.H.OAID=z),this.F=this.X,this.I=gh(this,null,this.W),El(this)};function uh(g){if(Dx(g),g.G==3){var C=g.U++,M=Kn(g.I);if(ut(M,"SID",g.K),ut(M,"RID",C),ut(M,"TYPE","terminate"),fu(g,M),C=new Zi(g,g.j,C),C.L=2,C.v=Ei(Kn(M)),M=!1,l.navigator&&l.navigator.sendBeacon)try{M=l.navigator.sendBeacon(C.v.toString(),"")}catch{}!M&&l.Image&&(new Image().src=C.v,M=!0),M||(C.g=Fx(C.j,null),C.g.ea(C.v)),C.F=Date.now(),sh(C)}Vx(g)}function dh(g){g.g&&(fh(g),g.g.cancel(),g.g=null)}function Dx(g){dh(g),g.u&&(l.clearTimeout(g.u),g.u=null),ph(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&l.clearTimeout(g.s),g.s=null)}function El(g){if(!op(g.h)&&!g.s){g.s=!0;var C=g.Ga;le||H(),q||(le(),q=!0),Q.add(C,g),g.B=0}}function W1(g,C){return bl(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=C.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=ou(p(g.Ga,g,C),wp(g,g.B)),g.B++,!0)}t.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const K=new Zi(this,this.j,g);let se=this.o;if(this.S&&(se?(se=I(se),D(se,this.S)):se=this.S),this.m!==null||this.O||(K.H=se,se=null),this.P)e:{for(var C=0,M=0;M<this.i.length;M++){t:{var z=this.i[M];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(C+=z,4096<C){C=M;break e}if(C===4096||M===this.i.length-1){C=M+1;break e}}C=1e3}else C=1e3;C=bp(this,K,C),M=Kn(this.I),ut(M,"RID",g),ut(M,"CVER",22),this.D&&ut(M,"X-HTTP-Session-Id",this.D),fu(this,M),se&&(this.O?C="headers="+encodeURIComponent(String(gp(se)))+"&"+C:this.m&&lh(M,this.m,se)),fn(this.h,K),this.Ua&&ut(M,"TYPE","init"),this.P?(ut(M,"$req",C),ut(M,"SID","null"),K.T=!0,np(K,M,null)):np(K,M,C),this.G=2}}else this.G==3&&(g?ti(this,g):this.i.length==0||op(this.h)||ti(this))};function ti(g,C){var M;C?M=C.l:M=g.U++;const z=Kn(g.I);ut(z,"SID",g.K),ut(z,"RID",M),ut(z,"AID",g.T),fu(g,z),g.m&&g.o&&lh(z,g.m,g.o),M=new Zi(g,g.j,M,g.B+1),g.m===null&&(M.H=g.o),C&&(g.i=C.D.concat(g.i)),C=bp(g,M,1e3),M.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),fn(g.h,M),np(M,z,C)}function fu(g,C){g.H&&j(g.H,function(M,z){ut(C,z,M)}),g.l&&yt({},function(M,z){ut(C,z,M)})}function bp(g,C,M){M=Math.min(g.i.length,M);var z=g.l?p(g.l.Na,g.l,g):null;e:{var K=g.i;let se=-1;for(;;){const Ce=["count="+M];se==-1?0<M?(se=K[0].g,Ce.push("ofs="+se)):se=0:Ce.push("ofs="+se);let en=!0;for(let ur=0;ur<M;ur++){let Ft=K[ur].g;const an=K[ur].map;if(Ft-=se,0>Ft)se=Math.max(0,K[ur].g-100),en=!1;else try{pp(an,Ce,"req"+Ft+"_")}catch{z&&z(an)}}if(en){z=Ce.join("&");break e}}}return g=g.i.splice(0,M),C.D=g,z}function Ji(g){if(!g.g&&!g.u){g.Y=1;var C=g.Fa;le||H(),q||(le(),q=!0),Q.add(C,g),g.v=0}}function hh(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=ou(p(g.Fa,g),wp(g,g.v)),g.v++,!0)}t.Fa=function(){if(this.u=null,mh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=ou(p(this.ab,this),g)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Hr(10),dh(this),mh(this))};function fh(g){g.A!=null&&(l.clearTimeout(g.A),g.A=null)}function mh(g){g.g=new Zi(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var C=Kn(g.qa);ut(C,"RID","rpc"),ut(C,"SID",g.K),ut(C,"AID",g.T),ut(C,"CI",g.F?"0":"1"),!g.F&&g.ja&&ut(C,"TO",g.ja),ut(C,"TYPE","xmlhttp"),fu(g,C),g.m&&g.o&&lh(C,g.m,g.o),g.L&&(g.g.I=g.L);var M=g.g;g=g.ia,M.L=1,M.v=Ei(Kn(C)),M.m=null,M.P=!0,rp(M,g)}t.Za=function(){this.C!=null&&(this.C=null,dh(this),hh(this),Hr(19))};function ph(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function _p(g,C){var M=null;if(g.g==C){ph(g),fh(g),g.g=null;var z=2}else if(Lt(g.h,C))M=C.D,hu(g.h,C),z=1;else return;if(g.G!=0){if(C.o)if(z==1){M=C.m?C.m.length:0,C=Date.now()-C.F;var K=g.B;z=Jd(),lt(z,new Ex(z,M)),El(g)}else Ji(g);else if(K=C.s,K==3||K==0&&0<C.X||!(z==1&&W1(g,C)||z==2&&hh(g)))switch(M&&0<M.length&&(C=g.h,C.i=C.i.concat(M)),K){case 1:ya(g,5);break;case 4:ya(g,10);break;case 3:ya(g,6);break;default:ya(g,2)}}}function wp(g,C){let M=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(M*=2),M*C}function ya(g,C){if(g.j.info("Error code "+C),C==2){var M=p(g.fb,g),z=g.Xa;const K=!z;z=new Ni(z||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ih(z,"https"),Ei(z),K?on(z.toString(),M):Px(z.toString(),M)}else Hr(2);g.G=0,g.l&&g.l.sa(C),Vx(g),Dx(g)}t.fb=function(g){g?(this.j.info("Successfully pinged google.com"),Hr(2)):(this.j.info("Failed to ping google.com"),Hr(1))};function Vx(g){if(g.G=0,g.ka=[],g.l){const C=fa(g.h);(C.length!=0||g.i.length!=0)&&(E(g.ka,C),E(g.ka,g.i),g.h.i.length=0,b(g.i),g.i.length=0),g.l.ra()}}function gh(g,C,M){var z=M instanceof Ni?Kn(M):new Ni(M);if(z.g!="")C&&(z.g=C+"."+z.g),ma(z,z.s);else{var K=l.location;z=K.protocol,C=C?C+"."+K.hostname:K.hostname,K=+K.port;var se=new Ni(null);z&&ih(se,z),C&&(se.g=C),K&&ma(se,K),M&&(se.l=M),z=se}return M=g.D,C=g.ya,M&&C&&ut(z,M,C),ut(z,"VER",g.la),fu(g,z),z}function Fx(g,C,M){if(C&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return C=g.Ca&&!g.pa?new An(new Ci({eb:M})):new An(g.pa),C.Ha(g.J),C}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function kp(){}t=kp.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function mu(){}mu.prototype.g=function(g,C){return new Ir(g,C)};function Ir(g,C){Pe.call(this),this.g=new Ox(C),this.l=g,this.h=C&&C.messageUrlParams||null,g=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(g?g["X-WebChannel-Content-Type"]=C.messageContentType:g={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.va&&(g?g["X-WebChannel-Client-Profile"]=C.va:g={"X-WebChannel-Client-Profile":C.va}),this.g.S=g,(g=C&&C.Sb)&&!_(g)&&(this.g.m=g),this.v=C&&C.supportsCrossDomainXhr||!1,this.u=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!_(C)&&(this.g.D=C,g=this.h,g!==null&&C in g&&(g=this.h,C in g&&delete g[C])),this.j=new Ii(this)}x(Ir,Pe),Ir.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ir.prototype.close=function(){uh(this.g)},Ir.prototype.o=function(g){var C=this.g;if(typeof g=="string"){var M={};M.__data__=g,g=M}else this.u&&(M={},M.__data__=yl(g),g=M);C.i.push(new du(C.Ya++,g)),C.G==3&&El(C)},Ir.prototype.N=function(){this.g.l=null,delete this.j,uh(this.g),delete this.g,Ir.aa.N.call(this)};function So(g){Xd.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var C=g.__sm__;if(C){e:{for(const M in C){g=M;break e}g=void 0}(this.i=g)&&(g=this.i,C=C!==null&&g in C?C[g]:void 0),this.data=C}else this.data=g}x(So,Xd);function $x(){ep.call(this),this.status=1}x($x,ep);function Ii(g){this.g=g}x(Ii,kp),Ii.prototype.ua=function(){lt(this.g,"a")},Ii.prototype.ta=function(g){lt(this.g,new So(g))},Ii.prototype.sa=function(g){lt(this.g,new $x)},Ii.prototype.ra=function(){lt(this.g,"b")},mu.prototype.createWebChannel=mu.prototype.g,Ir.prototype.send=Ir.prototype.o,Ir.prototype.open=Ir.prototype.m,Ir.prototype.close=Ir.prototype.close,d$=function(){return new mu},u$=function(){return Jd()},c$=ua,US={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},lu.NO_ERROR=0,lu.TIMEOUT=8,lu.HTTP_ERROR=6,lb=lu,th.COMPLETE="complete",l$=th,Jm.EventType=vl,vl.OPEN="a",vl.CLOSE="b",vl.ERROR="c",vl.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,lg=Jm,An.prototype.listenOnce=An.prototype.L,An.prototype.getLastError=An.prototype.Ka,An.prototype.getLastErrorCode=An.prototype.Ba,An.prototype.getStatus=An.prototype.Z,An.prototype.getResponseJson=An.prototype.Oa,An.prototype.getResponseText=An.prototype.oa,An.prototype.send=An.prototype.ea,An.prototype.setWithCredentials=An.prototype.Ha,a$=An}).apply(typeof gv<"u"?gv:typeof self<"u"?self:typeof window<"u"?window:{});const aM="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Mr.UNAUTHENTICATED=new Mr(null),Mr.GOOGLE_CREDENTIALS=new Mr("google-credentials-uid"),Mr.FIRST_PARTY=new Mr("first-party-uid"),Mr.MOCK_USER=new Mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jm="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad=new H2("@firebase/firestore");function Lh(){return ad.logLevel}function me(t,...e){if(ad.logLevel<=Mt.DEBUG){const n=e.map(iI);ad.debug(`Firestore (${jm}): ${t}`,...n)}}function lr(t,...e){if(ad.logLevel<=Mt.ERROR){const n=e.map(iI);ad.error(`Firestore (${jm}): ${t}`,...n)}}function $f(t,...e){if(ad.logLevel<=Mt.WARN){const n=e.map(iI);ad.warn(`Firestore (${jm}): ${t}`,...n)}}function iI(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(t="Unexpected state"){const e=`FIRESTORE (${jm}) INTERNAL ASSERTION FAILED: `+t;throw lr(e),new Error(e)}function Qe(t,e){t||Ue()}function ze(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends Pd{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cee{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Mr.UNAUTHENTICATED))}shutdown(){}}class uee{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class dee{constructor(e){this.t=e,this.currentUser=Mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Qe(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new yo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new yo,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new yo)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Qe(typeof r.accessToken=="string"),new h$(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qe(e===null||typeof e=="string"),new Mr(e)}}class hee{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Mr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class fee{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new hee(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mee{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pee{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Qe(this.o===void 0);const r=i=>{i.error!=null&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,me("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Qe(typeof n.token=="string"),this.R=n.token,new mee(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gee(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f${static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=gee(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ft(t,e){return t<e?-1:t>e?1:0}function Bf(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function m$(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Un.fromMillis(Date.now())}static fromDate(e){return Un.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Un(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ft(this.nanoseconds,e.nanoseconds):ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new Un(0,0))}static max(){return new Xe(new Un(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ue(),r===void 0?r=e.length-n:r>e.length-n&&Ue(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return _y.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof _y?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Yt extends _y{construct(e,n,r){return new Yt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Yt(n)}static emptyPath(){return new Yt([])}}const yee=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Fn extends _y{construct(e,n,r){return new Fn(e,n,r)}static isValidIdentifier(e){return yee.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Fn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Fn(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Ee(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ee(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new Ee(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Fn(n)}static emptyPath(){return new Fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.path=e}static fromPath(e){return new Le(Yt.fromString(e))}static fromName(e){return new Le(Yt.fromString(e).popFirst(5))}static empty(){return new Le(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Yt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Le(new Yt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function WS(t){return t.fields.find(e=>e.kind===2)}function wu(t){return t.fields.filter(e=>e.kind!==2)}h_.UNKNOWN_ID=-1;class cb{constructor(e,n){this.fieldPath=e,this.kind=n}}class wy{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new wy(0,yi.min())}}function p$(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Xe.fromTimestamp(r===1e9?new Un(n+1,0):new Un(n,r));return new yi(s,Le.empty(),e)}function g$(t){return new yi(t.readTime,t.key,-1)}class yi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new yi(Xe.min(),Le.empty(),-1)}static max(){return new yi(Xe.max(),Le.empty(),-1)}}function oI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Le.comparator(t.documentKey,e.documentKey),n!==0?n:ft(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class x${constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qc(t){if(t.code!==ie.FAILED_PRECONDITION||t.message!==y$)throw t;me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ue(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ee((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ee?n:ee.resolve(n)}catch(n){return ee.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.reject(n)}static resolve(e){return new ee((n,r)=>{n(e)})}static reject(e){return new ee((n,r)=>{r(e)})}static waitFor(e){return new ee((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=ee.resolve(!1);for(const r of e)n=n.next(s=>s?ee.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ee((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new ee((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new yo,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Pg(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=aI(r.target.error);this.V.reject(new Pg(e,s))}}static open(e,n,r,s){try{return new nk(n,e.transaction(s,r))}catch(i){throw new Pg(n,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(me("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new vee(n)}}class yc{constructor(e,n,r){this.name=e,this.version=n,this.p=r,yc.S(Tr())===12.2&&lr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return me("SimpleDb","Removing database:",e),Su(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!u6())return!1;if(yc.v())return!0;const e=Tr(),n=yc.S(e),r=0<n&&n<10,s=v$(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(me("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Pg(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Ee(ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Ee(ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Pg(e,o))},s.onupgradeneeded=i=>{me("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{me("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=nk.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(d=>(l.g(),d)).catch(d=>(l.abort(d),ee.reject(d))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,d=c.name!=="FirebaseError"&&o<3;if(me("SimpleDb","Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function v$(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class xee{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Su(this.B.delete())}}class Pg extends Ee{constructor(e,n){super(ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Zc(t){return t.name==="IndexedDbTransactionError"}class vee{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(me("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(me("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Su(r)}add(e){return me("SimpleDb","ADD",this.store.name,e,e),Su(this.store.add(e))}get(e){return Su(this.store.get(e)).next(n=>(n===void 0&&(n=null),me("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return me("SimpleDb","DELETE",this.store.name,e),Su(this.store.delete(e))}count(){return me("SimpleDb","COUNT",this.store.name),Su(this.store.count())}U(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new ee((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ee((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,n){me("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,l)=>l.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.W(s,n)}Y(e){const n=this.cursor({});return new ee((r,s)=>{n.onerror=i=>{const o=aI(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}W(e,n){const r=[];return new ee((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new xee(l),d=n(l.primaryKey,l.value,c);if(d instanceof ee){const h=d.catch(m=>(c.done(),ee.reject(m)));r.push(h)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>ee.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Su(t){return new ee((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=aI(r.target.error);n(s)}})}let lM=!1;function aI(t){const e=yc.S(Tr());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Ee("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return lM||(lM=!0,setTimeout(()=>{throw r},0)),r}}return t}class bee{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){me("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{me("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Zc(n)?me("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Qc(n)}await this.X(6e4)})}}class _ee{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let s=n,i=!0;return ee.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return me("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(l=>(me("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=g$(i);oI(o,r)>0&&(r=o)}),new yi(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}zs.oe=-1;function rk(t){return t==null}function ky(t){return t===0&&1/t==-1/0}function b$(t){return typeof t=="number"&&Number.isInteger(t)&&!ky(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=cM(e)),e=wee(t.get(n),e);return cM(e)}function wee(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function cM(t){return t+""}function Po(t){const e=t.length;if(Qe(e>=2),e===2)return Qe(t.charAt(0)===""&&t.charAt(1)===""),Yt.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&Ue(),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:Ue()}i=o+2}return new Yt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(t,e){return[t,Is(e)]}function _$(t,e,n){return[t,Is(e),n]}const kee={},Nee=["prefixPath","collectionGroup","readTime","documentId"],Eee=["prefixPath","collectionGroup","documentId"],See=["collectionGroup","readTime","prefixPath","documentId"],Tee=["canonicalId","targetId"],Cee=["targetId","path"],Iee=["path","targetId"],jee=["collectionId","parent"],Aee=["indexId","uid"],Ree=["uid","sequenceNumber"],Pee=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Lee=["indexId","uid","orderedDocumentKey"],Mee=["userId","collectionPath","documentId"],Oee=["userId","collectionPath","largestBatchId"],Dee=["userId","collectionGroup","largestBatchId"],w$=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Vee=[...w$,"documentOverlays"],k$=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],N$=k$,lI=[...N$,"indexConfiguration","indexState","indexEntries"],Fee=lI,$ee=[...lI,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS extends x${constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Cr(t,e){const n=ze(t);return yc.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dM(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Md(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Bee(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function E$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qn=class qS{constructor(e,n){this.comparator=e,this.root=n||xc.EMPTY}insert(e,n){return new qS(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,xc.BLACK,null,null))}remove(e){return new qS(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xc.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yv(this.root,e,this.comparator,!1)}getReverseIterator(){return new yv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yv(this.root,e,this.comparator,!0)}},yv=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},xc=class Na{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Na.RED,this.left=s??Na.EMPTY,this.right=i??Na.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Na(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Na.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Na.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Na.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Na.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ue();const e=this.left.check();if(e!==this.right.check())throw Ue();return e+(this.isRed()?0:1)}};xc.EMPTY=null,xc.RED=!0,xc.BLACK=!1;xc.EMPTY=new class{constructor(){this.size=0}get key(){throw Ue()}get value(){throw Ue()}get color(){throw Ue()}get left(){throw Ue()}get right(){throw Ue()}copy(e,n,r,s,i){return this}insert(e,n,r){return new xc(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.comparator=e,this.data=new qn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new hM(this.data.getIterator())}getIteratorFrom(e){return new hM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof dn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new dn(this.comparator);return n.data=e,n}}class hM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function kh(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.fields=e,e.sort(Fn.comparator)}static empty(){return new Us([])}unionWith(e){let n=new dn(Fn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Us(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Bf(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S$ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new S$("Invalid base64 string: "+i):i}}(e);return new cr(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new cr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}cr.EMPTY_BYTE_STRING=new cr("");const zee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ya(t){if(Qe(!!t),typeof t=="string"){let e=0;const n=zee.exec(t);if(Qe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Rn(t.seconds),nanos:Rn(t.nanos)}}function Rn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Cc(t){return typeof t=="string"?cr.fromBase64String(t):cr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function uI(t){const e=t.mapValue.fields.__previous_value__;return cI(e)?uI(e):e}function Ny(t){const e=Ya(t.mapValue.fields.__local_write_time__.timestampValue);return new Un(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uee{constructor(e,n,r,s,i,o,l,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}class ld{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ld("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ld&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},db={nullValue:"NULL_VALUE"};function cd(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cI(t)?4:T$(t)?9007199254740991:sk(t)?10:11:Ue()}function Zo(t,e){if(t===e)return!0;const n=cd(t);if(n!==cd(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ny(t).isEqual(Ny(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ya(s.timestampValue),l=Ya(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Cc(s.bytesValue).isEqual(Cc(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Rn(s.geoPointValue.latitude)===Rn(i.geoPointValue.latitude)&&Rn(s.geoPointValue.longitude)===Rn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Rn(s.integerValue)===Rn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Rn(s.doubleValue),l=Rn(i.doubleValue);return o===l?ky(o)===ky(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Bf(t.arrayValue.values||[],e.arrayValue.values||[],Zo);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(dM(o)!==dM(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Zo(o[c],l[c])))return!1;return!0}(t,e);default:return Ue()}}function Ey(t,e){return(t.values||[]).find(n=>Zo(n,e))!==void 0}function Ic(t,e){if(t===e)return 0;const n=cd(t),r=cd(e);if(n!==r)return ft(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ft(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Rn(i.integerValue||i.doubleValue),c=Rn(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return fM(t.timestampValue,e.timestampValue);case 4:return fM(Ny(t),Ny(e));case 5:return ft(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Cc(i),c=Cc(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const h=ft(l[d],c[d]);if(h!==0)return h}return ft(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=ft(Rn(i.latitude),Rn(o.latitude));return l!==0?l:ft(Rn(i.longitude),Rn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return mM(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,d,h;const m=i.fields||{},p=o.fields||{},v=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=(c=p.value)===null||c===void 0?void 0:c.arrayValue,b=ft(((d=v==null?void 0:v.values)===null||d===void 0?void 0:d.length)||0,((h=x==null?void 0:x.values)===null||h===void 0?void 0:h.length)||0);return b!==0?b:mM(v,x)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Jl.mapValue&&o===Jl.mapValue)return 0;if(i===Jl.mapValue)return 1;if(o===Jl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let m=0;m<c.length&&m<h.length;++m){const p=ft(c[m],h[m]);if(p!==0)return p;const v=Ic(l[c[m]],d[h[m]]);if(v!==0)return v}return ft(c.length,h.length)}(t.mapValue,e.mapValue);default:throw Ue()}}function fM(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ft(t,e);const n=Ya(t),r=Ya(e),s=ft(n.seconds,r.seconds);return s!==0?s:ft(n.nanos,r.nanos)}function mM(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ic(n[s],r[s]);if(i)return i}return ft(n.length,r.length)}function zf(t){return GS(t)}function GS(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ya(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Cc(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Le.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=GS(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${GS(n.fields[o])}`;return s+"}"}(t.mapValue):Ue()}function Sy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function KS(t){return!!t&&"integerValue"in t}function Ty(t){return!!t&&"arrayValue"in t}function pM(t){return!!t&&"nullValue"in t}function gM(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function hb(t){return!!t&&"mapValue"in t}function sk(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Lg(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Md(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Lg(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lg(t.arrayValue.values[n]);return e}return Object.assign({},t)}function T$(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const C$={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Wee(t){return"nullValue"in t?db:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Sy(ld.empty(),Le.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?sk(t)?C$:{mapValue:{}}:Ue()}function Hee(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Sy(ld.empty(),Le.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?C$:"mapValue"in t?sk(t)?{mapValue:{}}:Jl:Ue()}function yM(t,e){const n=Ic(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function xM(t,e){const n=Ic(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this.value=e}static empty(){return new ds({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!hb(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lg(n)}setAll(e){let n=Fn.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Lg(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());hb(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Zo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];hb(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Md(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ds(Lg(this.value))}}function I$(t){const e=[];return Md(t.fields,(n,r)=>{const s=new Fn([n]);if(hb(r)){const i=I$(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Us(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Yn(e,0,Xe.min(),Xe.min(),Xe.min(),ds.empty(),0)}static newFoundDocument(e,n,r,s){return new Yn(e,1,n,Xe.min(),r,s,0)}static newNoDocument(e,n){return new Yn(e,2,n,Xe.min(),Xe.min(),ds.empty(),0)}static newUnknownDocument(e,n){return new Yn(e,3,n,Xe.min(),Xe.min(),ds.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ds.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ds.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,n){this.position=e,this.inclusive=n}}function vM(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Le.comparator(Le.fromName(o.referenceValue),n.key):r=Ic(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function bM(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Zo(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,n="asc"){this.field=e,this.dir=n}}function qee(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let j$=class{};class Dt extends j${constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Gee(e,n,r):n==="array-contains"?new Zee(e,r):n==="in"?new O$(e,r):n==="not-in"?new Yee(e,r):n==="array-contains-any"?new Xee(e,r):new Dt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Kee(e,r):new Qee(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ic(n,this.value)):n!==null&&cd(this.value)===cd(n)&&this.matchesComparison(Ic(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ue()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tn extends j${constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new tn(e,n)}matches(e){return Wf(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Wf(t){return t.op==="and"}function QS(t){return t.op==="or"}function dI(t){return A$(t)&&Wf(t)}function A$(t){for(const e of t.filters)if(e instanceof tn)return!1;return!0}function ZS(t){if(t instanceof Dt)return t.field.canonicalString()+t.op.toString()+zf(t.value);if(dI(t))return t.filters.map(e=>ZS(e)).join(",");{const e=t.filters.map(n=>ZS(n)).join(",");return`${t.op}(${e})`}}function R$(t,e){return t instanceof Dt?function(r,s){return s instanceof Dt&&r.op===s.op&&r.field.isEqual(s.field)&&Zo(r.value,s.value)}(t,e):t instanceof tn?function(r,s){return s instanceof tn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&R$(o,s.filters[l]),!0):!1}(t,e):void Ue()}function P$(t,e){const n=t.filters.concat(e);return tn.create(n,t.op)}function L$(t){return t instanceof Dt?function(n){return`${n.field.canonicalString()} ${n.op} ${zf(n.value)}`}(t):t instanceof tn?function(n){return n.op.toString()+" {"+n.getFilters().map(L$).join(" ,")+"}"}(t):"Filter"}class Gee extends Dt{constructor(e,n,r){super(e,n,r),this.key=Le.fromName(r.referenceValue)}matches(e){const n=Le.comparator(e.key,this.key);return this.matchesComparison(n)}}class Kee extends Dt{constructor(e,n){super(e,"in",n),this.keys=M$("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Qee extends Dt{constructor(e,n){super(e,"not-in",n),this.keys=M$("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function M$(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Le.fromName(r.referenceValue))}class Zee extends Dt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ty(n)&&Ey(n.arrayValue,this.value)}}class O$ extends Dt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ey(this.value.arrayValue,n)}}class Yee extends Dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ey(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ey(this.value.arrayValue,n)}}class Xee extends Dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ty(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ey(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jee{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function YS(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Jee(t,e,n,r,s,i,o)}function ud(t){const e=ze(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ZS(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),rk(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>zf(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>zf(r)).join(",")),e.ue=n}return e.ue}function T0(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!qee(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!R$(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bM(t.startAt,e.startAt)&&bM(t.endAt,e.endAt)}function f_(t){return Le.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function m_(t,e){return t.filters.filter(n=>n instanceof Dt&&n.field.isEqual(e))}function _M(t,e,n){let r=db,s=!0;for(const i of m_(t,e)){let o=db,l=!0;switch(i.op){case"<":case"<=":o=Wee(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=db}yM({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];yM({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function wM(t,e,n){let r=Jl,s=!0;for(const i of m_(t,e)){let o=Jl,l=!0;switch(i.op){case">=":case">":o=Hee(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Jl}xM({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];xM({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function D$(t,e,n,r,s,i,o,l){return new Od(t,e,n,r,s,i,o,l)}function C0(t){return new Od(t)}function kM(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function V$(t){return t.collectionGroup!==null}function Mg(t){const e=ze(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new dn(Fn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Cy(i,r))}),n.has(Fn.keyField().canonicalString())||e.ce.push(new Cy(Fn.keyField(),r))}return e.ce}function hi(t){const e=ze(t);return e.le||(e.le=F$(e,Mg(t))),e.le}function ete(t){const e=ze(t);return e.he||(e.he=F$(e,t.explicitOrderBy)),e.he}function F$(t,e){if(t.limitType==="F")return YS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Cy(s.field,i)});const n=t.endAt?new Uf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Uf(t.startAt.position,t.startAt.inclusive):null;return YS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function XS(t,e){const n=t.filters.concat([e]);return new Od(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function p_(t,e,n){return new Od(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ik(t,e){return T0(hi(t),hi(e))&&t.limitType===e.limitType}function $$(t){return`${ud(hi(t))}|lt:${t.limitType}`}function Mh(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>L$(s)).join(", ")}]`),rk(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>zf(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>zf(s)).join(",")),`Target(${r})`}(hi(t))}; limitType=${t.limitType})`}function I0(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Le.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Mg(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const d=vM(o,l,c);return o.inclusive?d<=0:d<0}(r.startAt,Mg(r),s)||r.endAt&&!function(o,l,c){const d=vM(o,l,c);return o.inclusive?d>=0:d>0}(r.endAt,Mg(r),s))}(t,e)}function B$(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function z$(t){return(e,n)=>{let r=!1;for(const s of Mg(t)){const i=tte(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function tte(t,e,n){const r=t.field.isKeyField()?Le.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),d=l.data.field(i);return c!==null&&d!==null?Ic(c,d):Ue()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ue()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Md(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return E$(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nte=new qn(Le.comparator);function li(){return nte}const U$=new qn(Le.comparator);function cg(...t){let e=U$;for(const n of t)e=e.insert(n.key,n);return e}function W$(t){let e=U$;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Lo(){return Og()}function H$(){return Og()}function Og(){return new Yc(t=>t.toString(),(t,e)=>t.isEqual(e))}const rte=new qn(Le.comparator),ste=new dn(Le.comparator);function Ct(...t){let e=ste;for(const n of t)e=e.add(n);return e}const ite=new dn(ft);function hI(){return ite}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ky(e)?"-0":e}}function q$(t){return{integerValue:""+t}}function G$(t,e){return b$(e)?q$(e):fI(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this._=void 0}}function ote(t,e,n){return t instanceof Hf?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&cI(i)&&(i=uI(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof dd?Q$(t,e):t instanceof hd?Z$(t,e):function(s,i){const o=K$(s,i),l=NM(o)+NM(s.Pe);return KS(o)&&KS(s.Pe)?q$(l):fI(s.serializer,l)}(t,e)}function ate(t,e,n){return t instanceof dd?Q$(t,e):t instanceof hd?Z$(t,e):n}function K$(t,e){return t instanceof qf?function(r){return KS(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Hf extends ok{}class dd extends ok{constructor(e){super(),this.elements=e}}function Q$(t,e){const n=Y$(e);for(const r of t.elements)n.some(s=>Zo(s,r))||n.push(r);return{arrayValue:{values:n}}}class hd extends ok{constructor(e){super(),this.elements=e}}function Z$(t,e){let n=Y$(e);for(const r of t.elements)n=n.filter(s=>!Zo(s,r));return{arrayValue:{values:n}}}class qf extends ok{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function NM(t){return Rn(t.integerValue||t.doubleValue)}function Y$(t){return Ty(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,n){this.field=e,this.transform=n}}function lte(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof dd&&s instanceof dd||r instanceof hd&&s instanceof hd?Bf(r.elements,s.elements,Zo):r instanceof qf&&s instanceof qf?Zo(r.Pe,s.Pe):r instanceof Hf&&s instanceof Hf}(t.transform,e.transform)}class cte{constructor(e,n){this.version=e,this.transformResults=n}}class Er{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Er}static exists(e){return new Er(void 0,e)}static updateTime(e){return new Er(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fb(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ak{}function X$(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new A0(t.key,Er.none()):new Am(t.key,t.data,Er.none());{const n=t.data,r=ds.empty();let s=new dn(Fn.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new hl(t.key,r,new Us(s.toArray()),Er.none())}}function ute(t,e,n){t instanceof Am?function(s,i,o){const l=s.value.clone(),c=SM(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof hl?function(s,i,o){if(!fb(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=SM(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(J$(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Dg(t,e,n,r){return t instanceof Am?function(i,o,l,c){if(!fb(i.precondition,o))return l;const d=i.value.clone(),h=TM(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof hl?function(i,o,l,c){if(!fb(i.precondition,o))return l;const d=TM(i.fieldTransforms,c,o),h=o.data;return h.setAll(J$(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return fb(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function dte(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=K$(r.transform,s||null);i!=null&&(n===null&&(n=ds.empty()),n.set(r.field,i))}return n||null}function EM(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Bf(r,s,(i,o)=>lte(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Am extends ak{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class hl extends ak{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function J$(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function SM(t,e,n){const r=new Map;Qe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,ate(o,l,n[s]))}return r}function TM(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,ote(i,o,e))}return r}class A0 extends ak{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eB extends ak{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ute(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Dg(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Dg(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=H$();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=X$(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Xe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ct())}isEqual(e){return this.batchId===e.batchId&&Bf(this.mutations,e.mutations,(n,r)=>EM(n,r))&&Bf(this.baseMutations,e.baseMutations,(n,r)=>EM(n,r))}}class pI{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Qe(e.mutations.length===r.length);let s=function(){return rte}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new pI(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hte{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fte{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hr,$t;function mte(t){switch(t){default:return Ue();case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0}}function tB(t){if(t===void 0)return lr("GRPC error has no .code"),ie.UNKNOWN;switch(t){case hr.OK:return ie.OK;case hr.CANCELLED:return ie.CANCELLED;case hr.UNKNOWN:return ie.UNKNOWN;case hr.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case hr.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case hr.INTERNAL:return ie.INTERNAL;case hr.UNAVAILABLE:return ie.UNAVAILABLE;case hr.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case hr.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case hr.NOT_FOUND:return ie.NOT_FOUND;case hr.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case hr.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case hr.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case hr.ABORTED:return ie.ABORTED;case hr.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case hr.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case hr.DATA_LOSS:return ie.DATA_LOSS;default:return Ue()}}($t=hr||(hr={}))[$t.OK=0]="OK",$t[$t.CANCELLED=1]="CANCELLED",$t[$t.UNKNOWN=2]="UNKNOWN",$t[$t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$t[$t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$t[$t.NOT_FOUND=5]="NOT_FOUND",$t[$t.ALREADY_EXISTS=6]="ALREADY_EXISTS",$t[$t.PERMISSION_DENIED=7]="PERMISSION_DENIED",$t[$t.UNAUTHENTICATED=16]="UNAUTHENTICATED",$t[$t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$t[$t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$t[$t.ABORTED=10]="ABORTED",$t[$t.OUT_OF_RANGE=11]="OUT_OF_RANGE",$t[$t.UNIMPLEMENTED=12]="UNIMPLEMENTED",$t[$t.INTERNAL=13]="INTERNAL",$t[$t.UNAVAILABLE=14]="UNAVAILABLE",$t[$t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pte(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gte=new Uu([4294967295,4294967295],0);function CM(t){const e=pte().encode(t),n=new o$;return n.update(e),new Uint8Array(n.digest())}function IM(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Uu([n,r],0),new Uu([s,i],0)]}class yI{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ug(`Invalid padding: ${n}`);if(r<0)throw new ug(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ug(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ug(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Uu.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Uu.fromNumber(r)));return s.compare(gte)===1&&(s=new Uu([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=CM(e),[r,s]=IM(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new yI(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=CM(e),[r,s]=IM(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ug extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,P0.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new R0(Xe.min(),s,new qn(ft),li(),Ct())}}class P0{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new P0(r,n,Ct(),Ct(),Ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class nB{constructor(e,n){this.targetId=e,this.me=n}}class rB{constructor(e,n,r=cr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class jM{constructor(){this.fe=0,this.ge=RM(),this.pe=cr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ct(),n=Ct(),r=Ct();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Ue()}}),new P0(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=RM()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Qe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class yte{constructor(e){this.Le=e,this.Be=new Map,this.ke=li(),this.qe=AM(),this.Qe=new qn(ft)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Ue()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(f_(i))if(r===0){const o=new Le(i.path);this.Ue(n,o,Yn.newNoDocument(o,Xe.min()))}else Qe(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Cc(r).toUint8Array()}catch(c){if(c instanceof S$)return $f("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new yI(o,s,i)}catch(c){return $f(c instanceof ug?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&f_(l.target)){const c=new Le(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Yn.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Ct();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new R0(e,n,this.Qe,this.ke,r);return this.ke=li(),this.qe=AM(),this.Qe=new qn(ft),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jM,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new dn(ft),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||me("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jM),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function AM(){return new qn(Le.comparator)}function RM(){return new qn(Le.comparator)}const xte={asc:"ASCENDING",desc:"DESCENDING"},vte={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bte={and:"AND",or:"OR"};class _te{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function JS(t,e){return t.useProto3Json||rk(e)?e:{value:e}}function Gf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function sB(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function wte(t,e){return Gf(t,e.toTimestamp())}function js(t){return Qe(!!t),Xe.fromTimestamp(function(n){const r=Ya(n);return new Un(r.seconds,r.nanos)}(t))}function xI(t,e){return eT(t,e).canonicalString()}function eT(t,e){const n=function(s){return new Yt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function iB(t){const e=Yt.fromString(t);return Qe(fB(e)),e}function g_(t,e){return xI(t.databaseId,e.path)}function Wu(t,e){const n=iB(e);if(n.get(1)!==t.databaseId.projectId)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ee(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Le(lB(n))}function oB(t,e){return xI(t.databaseId,e)}function aB(t){const e=iB(t);return e.length===4?Yt.emptyPath():lB(e)}function tT(t){return new Yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function lB(t){return Qe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function PM(t,e,n){return{name:g_(t,e),fields:n.value.mapValue.fields}}function kte(t,e,n){const r=Wu(t,e.name),s=js(e.updateTime),i=e.createTime?js(e.createTime):Xe.min(),o=new ds({mapValue:{fields:e.fields}}),l=Yn.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function Nte(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ue()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(Qe(h===void 0||typeof h=="string"),cr.fromBase64String(h||"")):(Qe(h===void 0||h instanceof Buffer||h instanceof Uint8Array),cr.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?ie.UNKNOWN:tB(d.code);return new Ee(h,d.message||"")}(o);n=new rB(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Wu(t,r.document.name),i=js(r.document.updateTime),o=r.document.createTime?js(r.document.createTime):Xe.min(),l=new ds({mapValue:{fields:r.document.fields}}),c=Yn.newFoundDocument(s,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new mb(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Wu(t,r.document),i=r.readTime?js(r.readTime):Xe.min(),o=Yn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new mb([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Wu(t,r.document),i=r.removedTargetIds||[];n=new mb([],i,s,null)}else{if(!("filter"in e))return Ue();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new fte(s,i),l=r.targetId;n=new nB(l,o)}}return n}function y_(t,e){let n;if(e instanceof Am)n={update:PM(t,e.key,e.value)};else if(e instanceof A0)n={delete:g_(t,e.key)};else if(e instanceof hl)n={update:PM(t,e.key,e.data),updateMask:Ate(e.fieldMask)};else{if(!(e instanceof eB))return Ue();n={verify:g_(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Hf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof dd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof hd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof qf)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Ue()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:wte(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ue()}(t,e.precondition)),n}function nT(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Er.updateTime(js(i.updateTime)):i.exists!==void 0?Er.exists(i.exists):Er.none()}(e.currentDocument):Er.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)Qe(l.setToServerValue==="REQUEST_TIME"),c=new Hf;else if("appendMissingElements"in l){const h=l.appendMissingElements.values||[];c=new dd(h)}else if("removeAllFromArray"in l){const h=l.removeAllFromArray.values||[];c=new hd(h)}else"increment"in l?c=new qf(o,l.increment):Ue();const d=Fn.fromServerFormat(l.fieldPath);return new j0(d,c)}(t,s)):[];if(e.update){e.update.name;const s=Wu(t,e.update.name),i=new ds({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new Us(d.map(h=>Fn.fromServerFormat(h)))}(e.updateMask);return new hl(s,i,o,n,r)}return new Am(s,i,n,r)}if(e.delete){const s=Wu(t,e.delete);return new A0(s,n)}if(e.verify){const s=Wu(t,e.verify);return new eB(s,n)}return Ue()}function Ete(t,e){return t&&t.length>0?(Qe(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?js(s.updateTime):js(i);return o.isEqual(Xe.min())&&(o=js(i)),new cte(o,s.transformResults||[])}(n,e))):[]}function cB(t,e){return{documents:[oB(t,e.path)]}}function vI(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=oB(t,s);const i=function(d){if(d.length!==0)return hB(tn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:Ul(p.field),direction:Cte(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=JS(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function Ste(t,e,n,r){const{_t:s,parent:i}=vI(t,e),o={},l=[];let c=0;return n.forEach(d=>{const h="aggregate_"+c++;o[h]=d.alias,d.aggregateType==="count"?l.push({alias:h,count:{}}):d.aggregateType==="avg"?l.push({alias:h,avg:{field:Ul(d.fieldPath)}}):d.aggregateType==="sum"&&l.push({alias:h,sum:{field:Ul(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function uB(t){let e=aB(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Qe(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(m){const p=dB(m);return p instanceof tn&&dI(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(x){return new Cy(Oh(x.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(m){let p;return p=typeof m=="object"?m.value:m,rk(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(m){const p=!!m.before,v=m.values||[];return new Uf(v,p)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const p=!m.before,v=m.values||[];return new Uf(v,p)}(n.endAt)),D$(e,s,o,i,l,"F",c,d)}function Tte(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ue()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function dB(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Oh(n.unaryFilter.field);return Dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Oh(n.unaryFilter.field);return Dt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Oh(n.unaryFilter.field);return Dt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oh(n.unaryFilter.field);return Dt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ue()}}(t):t.fieldFilter!==void 0?function(n){return Dt.create(Oh(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ue()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return tn.create(n.compositeFilter.filters.map(r=>dB(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ue()}}(n.compositeFilter.op))}(t):Ue()}function Cte(t){return xte[t]}function Ite(t){return vte[t]}function jte(t){return bte[t]}function Ul(t){return{fieldPath:t.canonicalString()}}function Oh(t){return Fn.fromServerFormat(t.fieldPath)}function hB(t){return t instanceof Dt?function(n){if(n.op==="=="){if(gM(n.value))return{unaryFilter:{field:Ul(n.field),op:"IS_NAN"}};if(pM(n.value))return{unaryFilter:{field:Ul(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gM(n.value))return{unaryFilter:{field:Ul(n.field),op:"IS_NOT_NAN"}};if(pM(n.value))return{unaryFilter:{field:Ul(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ul(n.field),op:Ite(n.op),value:n.value}}}(t):t instanceof tn?function(n){const r=n.getFilters().map(s=>hB(s));return r.length===1?r[0]:{compositeFilter:{op:jte(n.op),filters:r}}}(t):Ue()}function Ate(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function fB(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,n,r,s,i=Xe.min(),o=Xe.min(),l=cr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new La(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new La(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new La(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new La(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mB{constructor(e){this.ct=e}}function Rte(t,e){let n;if(e.document)n=kte(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Le.fromSegments(e.noDocument.path),s=md(e.noDocument.readTime);n=Yn.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ue();{const r=Le.fromSegments(e.unknownDocument.path),s=md(e.unknownDocument.version);n=Yn.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Un(s[0],s[1]);return Xe.fromTimestamp(i)}(e.readTime)),n}function LM(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:x_(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:g_(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Gf(i,o.version.toTimestamp()),createTime:Gf(i,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:fd(e.version)};else{if(!e.isUnknownDocument())return Ue();r.unknownDocument={path:n.path.toArray(),version:fd(e.version)}}return r}function x_(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function fd(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function md(t){const e=new Un(t.seconds,t.nanoseconds);return Xe.fromTimestamp(e)}function Tu(t,e){const n=(e.baseMutations||[]).map(i=>nT(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>nT(t.ct,i)),s=Un.fromMillis(e.localWriteTimeMs);return new mI(e.batchId,s,n,r)}function dg(t){const e=md(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?md(t.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){return Qe(i.documents.length===1),hi(C0(aB(i.documents[0])))}(t.query):function(i){return hi(uB(i))}(t.query),new La(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,cr.fromBase64String(t.resumeToken))}function pB(t,e){const n=fd(e.snapshotVersion),r=fd(e.lastLimboFreeSnapshotVersion);let s;s=f_(e.target)?cB(t.ct,e.target):vI(t.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ud(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function gB(t){const e=uB({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?p_(e,e.limit,"L"):e}function jN(t,e){return new gI(e.largestBatchId,nT(t.ct,e.overlayMutation))}function MM(t,e){const n=e.path.lastSegment();return[t,Is(e.path.popLast()),n]}function OM(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:fd(r.readTime),documentKey:Is(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pte{getBundleMetadata(e,n){return DM(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:md(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return DM(e).put(function(s){return{bundleId:s.id,createTime:fd(js(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return VM(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:gB(i.bundledQuery),readTime:md(i.readTime)}}(r)})}saveNamedQuery(e,n){return VM(e).put(function(s){return{name:s.name,readTime:fd(js(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function DM(t){return Cr(t,"bundles")}function VM(t){return Cr(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new lk(e,r)}getOverlay(e,n){return Op(e).get(MM(this.userId,n)).next(r=>r?jN(this.serializer,r):null)}getOverlays(e,n){const r=Lo();return ee.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new gI(n,o);s.push(this.ht(e,l))}),ee.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Is(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Op(e).j("collectionPathOverlayIndex",l))}),ee.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Lo(),i=Is(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Op(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const d=jN(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Lo();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Op(e).J({index:"collectionGroupOverlayIndex",range:l},(c,d,h)=>{const m=jN(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):h.done()}).next(()=>i)}ht(e,n){return Op(e).put(function(s,i,o){const[l,c,d]=MM(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:y_(s.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Op(t){return Cr(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lte{Pt(e){return Cr(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?cr.fromUint8Array(r):cr.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Rn(e.integerValue));else if("doubleValue"in e){const r=Rn(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),ky(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Ya(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(Cc(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?T$(e)?this.dt(n,Number.MAX_SAFE_INTEGER):sk(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Ue()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const s of Object.keys(r))this.Vt(s,n),this.Tt(r[s],n)}wt(e,n){var r,s;const i=e.fields||{};this.dt(n,53);const o="value",l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(n,15),n.At(Rn(l)),this.Vt(o,n),this.Tt(i[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const s of r)this.Tt(s,n)}yt(e,n){this.dt(n,37),Le.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Cu.vt=new Cu;function Mte(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function FM(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=Mte(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class Ote{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=n.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=n.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const n=this.qt(e),r=FM(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}Kt(e){const n=this.qt(e),r=FM(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Dte{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class Vte{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Dp{constructor(){this.jt=new Ote,this.Ht=new Dte(this.jt),this.Jt=new Vte(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Iu(this.indexId,this.documentKey,this.arrayValue,r)}}function jl(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=$M(t.arrayValue,e.arrayValue),n!==0?n:(n=$M(t.directionalValue,e.directionalValue),n!==0?n:Le.comparator(t.documentKey,e.documentKey)))}function $M(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e){this.Xt=new dn((n,r)=>Fn.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Qe(e.collectionGroup===this.collectionId),this.nn)return!1;const n=WS(e);if(n!==void 0&&!this.sn(n))return!1;const r=wu(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new dn(Fn.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new cb(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new cb(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new cb(r.field,r.dir==="asc"?0:1)));return new h_(h_.UNKNOWN_ID,this.collectionId,n,wy.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(t){var e,n;if(Qe(t instanceof Dt||t instanceof tn),t instanceof Dt){if(t instanceof O$){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>Dt.create(t.field,"==",i)))||[];return tn.create(s,"or")}return t}const r=t.filters.map(s=>yB(s));return tn.create(r,t.op)}function Fte(t){if(t.getFilters().length===0)return[];const e=iT(yB(t));return Qe(xB(e)),rT(e)||sT(e)?[e]:e.getFilters()}function rT(t){return t instanceof Dt}function sT(t){return t instanceof tn&&dI(t)}function xB(t){return rT(t)||sT(t)||function(n){if(n instanceof tn&&QS(n)){for(const r of n.getFilters())if(!rT(r)&&!sT(r))return!1;return!0}return!1}(t)}function iT(t){if(Qe(t instanceof Dt||t instanceof tn),t instanceof Dt)return t;if(t.filters.length===1)return iT(t.filters[0]);const e=t.filters.map(r=>iT(r));let n=tn.create(e,t.op);return n=v_(n),xB(n)?n:(Qe(n instanceof tn),Qe(Wf(n)),Qe(n.filters.length>1),n.filters.reduce((r,s)=>bI(r,s)))}function bI(t,e){let n;return Qe(t instanceof Dt||t instanceof tn),Qe(e instanceof Dt||e instanceof tn),n=t instanceof Dt?e instanceof Dt?function(s,i){return tn.create([s,i],"and")}(t,e):zM(t,e):e instanceof Dt?zM(e,t):function(s,i){if(Qe(s.filters.length>0&&i.filters.length>0),Wf(s)&&Wf(i))return P$(s,i.getFilters());const o=QS(s)?s:i,l=QS(s)?i:s,c=o.filters.map(d=>bI(d,l));return tn.create(c,"or")}(t,e),v_(n)}function zM(t,e){if(Wf(e))return P$(e,t.getFilters());{const n=e.filters.map(r=>bI(t,r));return tn.create(n,"or")}}function v_(t){if(Qe(t instanceof Dt||t instanceof tn),t instanceof Dt)return t;const e=t.getFilters();if(e.length===1)return v_(e[0]);if(A$(t))return t;const n=e.map(s=>v_(s)),r=[];return n.forEach(s=>{s instanceof Dt?r.push(s):s instanceof tn&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:tn.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $te{constructor(){this.un=new _I}addToCollectionParentIndex(e,n){return this.un.add(n),ee.resolve()}getCollectionParents(e,n){return ee.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return ee.resolve()}deleteFieldIndex(e,n){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,n){return ee.resolve()}getDocumentsMatchingTarget(e,n){return ee.resolve(null)}getIndexType(e,n){return ee.resolve(0)}getFieldIndexes(e,n){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,n){return ee.resolve(yi.min())}getMinOffsetFromCollectionGroup(e,n){return ee.resolve(yi.min())}updateCollectionGroup(e,n,r){return ee.resolve()}updateIndexEntries(e,n){return ee.resolve()}}class _I{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new dn(Yt.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new dn(Yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv=new Uint8Array(0);class Bte{constructor(e,n){this.databaseId=n,this.cn=new _I,this.ln=new Yc(r=>ud(r),(r,s)=>T0(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const i={collectionId:r,parent:Is(s)};return UM(e).put(i)}return ee.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[m$(n),""],!1,!0);return UM(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Po(o.parent))}return r})}addFieldIndex(e,n){const r=Vp(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Eh(e);return i.next(l=>{o.put(OM(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Vp(e),s=Eh(e),i=Nh(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Vp(e),r=Nh(e),s=Eh(e);return n.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,n){return ee.forEach(this.hn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new BM(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Nh(e);let s=!0;const i=new Map;return ee.forEach(this.hn(n),o=>this.Pn(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=Ct();const l=[];return ee.forEach(i,(c,d)=>{me("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}(c)} to execute ${ud(n)}`);const h=function(S,T){const P=WS(T);if(P===void 0)return null;for(const j of m_(S,P.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(d,c),m=function(S,T){const P=new Map;for(const j of wu(T))for(const R of m_(S,j.fieldPath))switch(R.op){case"==":case"in":P.set(j.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return P.set(j.fieldPath.canonicalString(),R.value),Array.from(P.values())}return null}(d,c),p=function(S,T){const P=[];let j=!0;for(const R of wu(T)){const I=R.kind===0?_M(S,R.fieldPath,S.startAt):wM(S,R.fieldPath,S.startAt);P.push(I.value),j&&(j=I.inclusive)}return new Uf(P,j)}(d,c),v=function(S,T){const P=[];let j=!0;for(const R of wu(T)){const I=R.kind===0?wM(S,R.fieldPath,S.endAt):_M(S,R.fieldPath,S.endAt);P.push(I.value),j&&(j=I.inclusive)}return new Uf(P,j)}(d,c),x=this.In(c,d,p),b=this.In(c,d,v),E=this.Tn(c,d,m),k=this.En(c.indexId,h,x,p.inclusive,b,v.inclusive,E);return ee.forEach(k,_=>r.G(_,n.limit).next(S=>{S.forEach(T=>{const P=Le.fromSegments(T.documentKey);o.has(P)||(o=o.add(P),l.push(P))})}))}).next(()=>l)}return ee.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=Fte(tn.create(e.filters,"and")).map(r=>YS(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),d=c/(n!=null?n.length:1),h=[];for(let m=0;m<c;++m){const p=n?this.dn(n[m/d]):xv,v=this.An(e,p,r[m%d],s),x=this.Rn(e,p,i[m%d],o),b=l.map(E=>this.An(e,p,E,!0));h.push(...this.createRange(v,x,b))}return h}An(e,n,r,s){const i=new Iu(e,Le.empty(),n,r);return s?i:i.Zt()}Rn(e,n,r,s){const i=new Iu(e,Le.empty(),n,r);return s?i.Zt():i}Pn(e,n){const r=new BM(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.hn(n);return ee.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let d=new dn(Fn.comparator),h=!1;for(const m of c.filters)for(const p of m.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?h=!0:d=d.add(p.field));for(const m of c.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Vn(e,n){const r=new Dp;for(const s of wu(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);Cu.vt.It(i,o)}return r.zt()}dn(e){const n=new Dp;return Cu.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Dp;return Cu.vt.It(Sy(this.databaseId,n),r.Yt(function(i){const o=wu(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let s=[];s.push(new Dp);let i=0;for(const o of wu(e)){const l=r[i++];for(const c of s)if(this.fn(n,o.fieldPath)&&Ty(l))s=this.gn(s,o,l);else{const d=c.Yt(o.kind);Cu.vt.It(l,d)}}return this.pn(s)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new Dp;c.seed(l.zt()),Cu.vt.It(o,c.Yt(n.kind)),i.push(c)}return i}fn(e,n){return!!e.filters.find(r=>r instanceof Dt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Vp(e),s=Eh(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(i=>{const o=[];return ee.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(h,m){const p=m?new wy(m.sequenceNumber,new yi(md(m.readTime),new Le(Po(m.documentKey)),m.largestBatchId)):wy.empty(),v=h.fields.map(([x,b])=>new cb(Fn.fromServerFormat(x),b));return new h_(h.indexId,h.collectionGroup,v,p)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ft(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Vp(e),i=Eh(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(l=>ee.forEach(l,c=>i.put(OM(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return ee.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?ee.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),ee.forEach(l,c=>this.wn(e,s,c).next(d=>{const h=this.Sn(i,c);return d.isEqual(h)?ee.resolve():this.bn(e,i,c,d,h)}))))})}Dn(e,n,r,s){return Nh(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,s){return Nh(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const s=Nh(e);let i=new dn(jl);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,l)=>{i=i.add(new Iu(r.indexId,n,l.arrayValue,l.directionalValue))}).next(()=>i)}Sn(e,n){let r=new dn(jl);const s=this.Vn(n,e);if(s==null)return r;const i=WS(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Ty(o))for(const l of o.arrayValue.values||[])r=r.add(new Iu(n.indexId,e.key,this.dn(l),s))}else r=r.add(new Iu(n.indexId,e.key,xv,s));return r}bn(e,n,r,s,i){me("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(c,d,h,m,p){const v=c.getIterator(),x=d.getIterator();let b=kh(v),E=kh(x);for(;b||E;){let k=!1,_=!1;if(b&&E){const S=h(b,E);S<0?_=!0:S>0&&(k=!0)}else b!=null?_=!0:k=!0;k?(m(E),E=kh(x)):_?(p(b),b=kh(v)):(b=kh(v),E=kh(x))}}(s,i,jl,l=>{o.push(this.Dn(e,n,r,l))},l=>{o.push(this.vn(e,n,r,l))}),ee.waitFor(o)}yn(e){let n=1;return Eh(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>jl(o,l)).filter((o,l,c)=>!l||jl(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=jl(o,e),c=jl(o,n);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const l=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,xv,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,xv,[]];i.push(IDBKeyRange.bound(l,c))}return i}Cn(e,n){return jl(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(WM)}getMinOffset(e,n){return ee.mapArray(this.hn(n),r=>this.Pn(e,r).next(s=>s||Ue())).next(WM)}}function UM(t){return Cr(t,"collectionParents")}function Nh(t){return Cr(t,"indexEntries")}function Vp(t){return Cr(t,"indexConfiguration")}function Eh(t){return Cr(t,"indexState")}function WM(t){Qe(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;oI(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new yi(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Vs{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Vs(e,Vs.DEFAULT_COLLECTION_PERCENTILE,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vB(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.J({range:o},(h,m,p)=>(l++,p.delete()));i.push(c.next(()=>{Qe(l===1)}));const d=[];for(const h of n.mutations){const m=_$(e,h.key.path,n.batchId);i.push(s.delete(m)),d.push(h.key)}return ee.waitFor(i).next(()=>d)}function b_(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ue();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vs.DEFAULT_COLLECTION_PERCENTILE=10,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vs.DEFAULT=new Vs(41943040,Vs.DEFAULT_COLLECTION_PERCENTILE,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vs.DISABLED=new Vs(-1,0,0);class ck{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,n,r,s){Qe(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new ck(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Al(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Dh(e),o=Al(e);return o.add({}).next(l=>{Qe(typeof l=="number");const c=new mI(l,n,r,s),d=function(v,x,b){const E=b.baseMutations.map(_=>y_(v.ct,_)),k=b.mutations.map(_=>y_(v.ct,_));return{userId:x,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:E,mutations:k}}(this.serializer,this.userId,c),h=[];let m=new dn((p,v)=>ft(p.canonicalString(),v.canonicalString()));for(const p of s){const v=_$(this.userId,p.key.path,l);m=m.add(p.key.path.popLast()),h.push(o.put(d)),h.push(i.put(v,kee))}return m.forEach(p=>{h.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),ee.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Al(e).get(n).next(r=>r?(Qe(r.userId===this.userId),Tu(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?ee.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Fn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Al(e).J({index:"userMutationsIndex",range:s},(o,l,c)=>{l.userId===this.userId&&(Qe(l.batchId>=r),i=Tu(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Al(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Al(e).U("userMutationsIndex",n).next(r=>r.map(s=>Tu(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=ub(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Dh(e).J({range:s},(o,l,c)=>{const[d,h,m]=o,p=Po(h);if(d===this.userId&&n.path.isEqual(p))return Al(e).get(m).next(v=>{if(!v)throw Ue();Qe(v.userId===this.userId),i.push(Tu(this.serializer,v))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new dn(ft);const s=[];return n.forEach(i=>{const o=ub(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Dh(e).J({range:l},(d,h,m)=>{const[p,v,x]=d,b=Po(v);p===this.userId&&i.path.isEqual(b)?r=r.add(x):m.done()});s.push(c)}),ee.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=ub(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new dn(ft);return Dh(e).J({range:o},(c,d,h)=>{const[m,p,v]=c,x=Po(p);m===this.userId&&r.isPrefixOf(x)?x.length===s&&(l=l.add(v)):h.done()}).next(()=>this.xn(e,l))}xn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Al(e).get(i).next(o=>{if(o===null)throw Ue();Qe(o.userId===this.userId),r.push(Tu(this.serializer,o))}))}),ee.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return vB(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),ee.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return ee.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Dh(e).J({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=Po(i[1]);s.push(c)}else l.done()}).next(()=>{Qe(s.length===0)})})}containsKey(e,n){return bB(e,this.userId,n)}Nn(e){return _B(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function bB(t,e,n){const r=ub(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Dh(t).J({range:i,H:!0},(l,c,d)=>{const[h,m,p]=l;h===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function Al(t){return Cr(t,"mutations")}function Dh(t){return Cr(t,"documentMutations")}function _B(t){return Cr(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new pd(0)}static kn(){return new pd(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zte{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new pd(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Xe.fromTimestamp(new Un(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Qn(e,s)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Sh(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(Qe(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Sh(e).J((o,l)=>{const c=dg(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>ee.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Sh(e).J((r,s)=>{const i=dg(s);n(i)})}qn(e){return qM(e).get("targetGlobalKey").next(n=>(Qe(n!==null),n))}Qn(e,n){return qM(e).put("targetGlobalKey",n)}Kn(e,n){return Sh(e).put(pB(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ud(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Sh(e).J({range:s,index:"queryTargetsIndex"},(o,l,c)=>{const d=dg(l);T0(n,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Wl(e);return n.forEach(o=>{const l=Is(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),ee.waitFor(s)}removeMatchingKeys(e,n,r){const s=Wl(e);return ee.forEach(n,i=>{const o=Is(i.path);return ee.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Wl(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Wl(e);let i=Ct();return s.J({range:r,H:!0},(o,l,c)=>{const d=Po(o[1]),h=new Le(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=Is(n.path),s=IDBKeyRange.bound([r],[m$(r)],!1,!0);let i=0;return Wl(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,l],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}ot(e,n){return Sh(e).get(n).next(r=>r?dg(r):null)}}function Sh(t){return Cr(t,"targets")}function qM(t){return Cr(t,"targetGlobal")}function Wl(t){return Cr(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GM([t,e],[n,r]){const s=ft(t,n);return s===0?ft(e,r):s}class Ute{constructor(e){this.Un=e,this.buffer=new dn(GM),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();GM(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Wte{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){me("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Zc(n)?me("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Qc(n)}await this.Hn(3e5)})}}class Hte{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ee.resolve(zs.oe);const r=new Ute(n);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(me("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(HM)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HM):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,s,i,o,l,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),Lh()<=Mt.DEBUG&&me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${m} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function qte(t,e){return new Hte(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gte{constructor(e,n){this.db=e,this.garbageCollector=qte(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,s)=>n(s))}addReference(e,n,r){return vv(e,r)}removeReference(e,n,r){return vv(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return vv(e,n)}nr(e,n){return function(s,i){let o=!1;return _B(s).Y(l=>bB(s,l,i).next(c=>(c&&(o=!0),ee.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,l)=>{if(l<=n){const c=this.nr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Xe.min()),Wl(e).delete(function(m){return[0,Is(m.path)]}(o))))});s.push(c)}}).next(()=>ee.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return vv(e,n)}tr(e,n){const r=Wl(e);let s,i=zs.oe;return r.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:d})=>{o===0?(i!==zs.oe&&n(new Le(Po(s)),i),i=d,s=c):i=zs.oe}).next(()=>{i!==zs.oe&&n(new Le(Po(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function vv(t,e){return Wl(t).put(function(r,s){return{targetId:0,path:Is(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wB{constructor(){this.changes=new Yc(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Yn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ee.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kte{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return pu(e).put(r)}removeEntry(e,n,r){return pu(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],x_(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Yn.newInvalidDocument(n);return pu(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fp(n))},(s,i)=>{r=this.ir(n,i)}).next(()=>r)}sr(e,n){let r={size:0,document:Yn.newInvalidDocument(n)};return pu(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fp(n))},(s,i)=>{r={document:this.ir(n,i),size:b_(i)}}).next(()=>r)}getEntries(e,n){let r=li();return this._r(e,n,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,n){let r=li(),s=new qn(Le.comparator);return this._r(e,n,(i,o)=>{const l=this.ir(i,o);r=r.insert(i,l),s=s.insert(i,b_(o))}).next(()=>({documents:r,ur:s}))}_r(e,n,r){if(n.isEmpty())return ee.resolve();let s=new dn(ZM);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Fp(s.first()),Fp(s.last())),o=s.getIterator();let l=o.getNext();return pu(e).J({index:"documentKeyIndex",range:i},(c,d,h)=>{const m=Le.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&ZM(l,m)<0;)r(l,null),l=o.getNext();l&&l.isEqual(m)&&(r(l,d),l=o.hasNext()?o.getNext():null),l?h.$(Fp(l)):h.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),x_(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pu(e).U(IDBKeyRange.bound(l,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=li();for(const m of d){const p=this.ir(Le.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);p.isFoundDocument()&&(I0(n,p)||s.has(p.key))&&(h=h.insert(p.key,p))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=li();const o=QM(n,r),l=QM(n,yi.max());return pu(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,d,h)=>{const m=this.ir(Le.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new Qte(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return KM(e).get("remoteDocumentGlobalKey").next(n=>(Qe(!!n),n))}rr(e,n){return KM(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=Rte(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return Yn.newInvalidDocument(e)}}function kB(t){return new Kte(t)}class Qte extends wB{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new Yc(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new dn((i,o)=>ft(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.lr.get(i);if(n.push(this.cr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=LM(this.cr.serializer,o);s=s.add(i.path.popLast());const d=b_(c);r+=d-l.size,n.push(this.cr.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=LM(this.cr.serializer,o.convertToNoDocument(Xe.min()));n.push(this.cr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.cr.updateMetadata(e,r)),ee.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function KM(t){return Cr(t,"remoteDocumentGlobal")}function pu(t){return Cr(t,"remoteDocumentsV14")}function Fp(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function QM(t,e){const n=e.documentKey.path.toArray();return[t,x_(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ZM(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ft(n[i],r[i]),s)return s;return s=ft(n.length,r.length),s||(s=ft(n[n.length-2],r[r.length-2]),s||ft(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zte{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Dg(r.mutation,s,Us.empty(),Un.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ct()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ct()){const s=Lo();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=cg();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Lo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ct()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=li();const o=Og(),l=function(){return Og()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof hl)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Dg(h.mutation,d,h.mutation.getFieldMask(),Un.now())):o.set(d.key,Us.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var m;return l.set(d,new Zte(h,(m=o.get(d))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Og();let s=new qn((o,l)=>o-l),i=Ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||Us.empty();h=l.applyToLocalView(d,h),r.set(c,h);const m=(s.get(l.batchId)||Ct()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,h=c.value,m=H$();h.forEach(p=>{if(!i.has(p)){const v=X$(n.get(p),r.get(p));v!==null&&m.set(p,v),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return ee.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Le.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):V$(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):ee.resolve(Lo());let l=-1,c=i;return o.next(d=>ee.forEach(d,(h,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(h)?ee.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,Ct())).next(h=>({batchId:l,changes:W$(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Le(n)).next(r=>{let s=cg();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=cg();return this.indexManager.getCollectionParents(e,i).next(l=>ee.forEach(l,c=>{const d=function(m,p){return new Od(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Yn.newInvalidDocument(h)))});let l=cg();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&Dg(h.mutation,d,Us.empty(),Un.now()),I0(n,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yte{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return ee.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:js(s.createTime)}}(n)),ee.resolve()}getNamedQuery(e,n){return ee.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:gB(s.bundledQuery),readTime:js(s.readTime)}}(n)),ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xte{constructor(){this.overlays=new qn(Le.comparator),this.Ir=new Map}getOverlay(e,n){return ee.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Lo();return ee.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),ee.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),ee.resolve()}getOverlaysForCollection(e,n,r){const s=Lo(),i=n.length+1,o=new Le(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return ee.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new qn((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Lo(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Lo(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return ee.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new gI(n,r));let i=this.Ir.get(n);i===void 0&&(i=Ct(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jte{constructor(){this.sessionToken=cr.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(){this.Tr=new dn(Rr.Er),this.dr=new dn(Rr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Rr(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Rr(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Le(new Yt([])),r=new Rr(n,e),s=new Rr(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Le(new Yt([])),r=new Rr(n,e),s=new Rr(n,e+1);let i=Ct();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Rr(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Rr{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Le.comparator(e.key,n.key)||ft(e.wr,n.wr)}static Ar(e,n){return ft(e.wr,n.wr)||Le.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ene{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new dn(Rr.Er)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new mI(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Rr(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ee.resolve(o)}lookupMutationBatch(e,n){return ee.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return ee.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Rr(n,0),s=new Rr(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),ee.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new dn(ft);return n.forEach(s=>{const i=new Rr(s,0),o=new Rr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),ee.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Le.isDocumentKey(i)||(i=i.child(""));const o=new Rr(new Le(i),0);let l=new dn(ft);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(c.wr)),!0)},o),ee.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Qe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return ee.forEach(n.mutations,s=>{const i=new Rr(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Rr(n,0),s=this.br.firstAfterOrEqual(r);return ee.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tne{constructor(e){this.Mr=e,this.docs=function(){return new qn(Le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ee.resolve(r?r.document.mutableCopy():Yn.newInvalidDocument(n))}getEntries(e,n){let r=li();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Yn.newInvalidDocument(s))}),ee.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=li();const o=n.path,l=new Le(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||oI(g$(h),r)<=0||(s.has(h.key)||I0(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return ee.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Ue()}Or(e,n){return ee.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new nne(this)}getSize(e){return ee.resolve(this.size)}}class nne extends wB{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),ee.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rne{constructor(e){this.persistence=e,this.Nr=new Yc(n=>ud(n),T0),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new wI,this.targetCount=0,this.kr=pd.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),ee.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new pd(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,ee.resolve()}updateTargetData(e,n){return this.Kn(n),ee.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),ee.waitFor(i).next(()=>s)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return ee.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),ee.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ee.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),ee.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return ee.resolve(r)}containsKey(e,n){return ee.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EB{constructor(e,n){this.qr={},this.overlays={},this.Qr=new zs(0),this.Kr=!1,this.Kr=!0,this.$r=new Jte,this.referenceDelegate=e(this),this.Ur=new rne(this),this.indexManager=new $te,this.remoteDocumentCache=function(s){return new tne(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new mB(n),this.Gr=new Yte(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Xte,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new ene(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){me("MemoryPersistence","Starting transaction:",e);const s=new sne(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return ee.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class sne extends x${constructor(e){super(),this.currentSequenceNumber=e}}class uk{constructor(e){this.persistence=e,this.Jr=new wI,this.Yr=null}static Zr(e){return new uk(e)}get Xr(){if(this.Yr)return this.Yr;throw Ue()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),ee.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),ee.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),ee.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.Xr,r=>{const s=Le.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,Xe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return ee.or([()=>ee.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ine{constructor(e){this.serializer=e}O(e,n,r,s){const i=new nk("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uM,{unique:!0}),c.createObjectStore("documentMutations")}(e),YM(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=ee.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),YM(e)),o=o.next(()=>function(c){const d=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,d){return d.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uM,{unique:!0});const m=d.store("mutations"),p=h.map(v=>m.put(v));return ee.waitFor(p)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore("documentOverlays",{keyPath:Mee});d.createIndex("collectionPathOverlayIndex",Oee,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",Dee,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:Nee});d.createIndex("documentKeyIndex",Eee),d.createIndex("collectionGroupIndex",See)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:Aee}).createIndex("sequenceNumberIndex",Ree,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:Pee}).createIndex("documentKeyIndex",Lee,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=b_(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(s=>ee.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(l=>ee.forEach(l,c=>{Qe(c.userId===i.userId);const d=Tu(this.serializer,c);return vB(e,i.userId,d).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,l)=>{const c=new Yt(o),d=function(m){return[0,Is(m)]}(c);i.push(n.get(d).next(h=>h?ee.resolve():(m=>n.put({targetId:0,path:Is(m),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>ee.waitFor(i))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:jee});const r=n.store("collectionParents"),s=new _I,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:Is(c)})}};return n.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new Yt(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,l,c],d)=>{const h=Po(l);return i(h.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,s)=>{const i=dg(s),o=pB(this.serializer,i);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((i,o)=>{const l=n.store("remoteDocumentsV14"),c=function(m){return m.document?new Le(Yt.fromString(m.document.name).popFirst(5)):m.noDocument?Le.fromSegments(m.noDocument.path):m.unknownDocument?Le.fromSegments(m.unknownDocument.path):Ue()}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(d))}).next(()=>ee.waitFor(s))}ai(e,n){const r=n.store("mutations"),s=kB(this.serializer),i=new EB(uk.Zr,this.serializer.ct);return r.U().next(o=>{const l=new Map;return o.forEach(c=>{var d;let h=(d=l.get(c.userId))!==null&&d!==void 0?d:Ct();Tu(this.serializer,c).keys().forEach(m=>h=h.add(m)),l.set(c.userId,h)}),ee.forEach(l,(c,d)=>{const h=new Mr(d),m=lk.lt(this.serializer,h),p=i.getIndexManager(h),v=ck.lt(h,this.serializer,p,i.referenceDelegate);return new NB(s,v,m,p).recalculateAndSaveOverlaysForDocumentKeys(new HS(n,zs.oe),c).next()})})}}function YM(t){t.createObjectStore("targetDocuments",{keyPath:Cee}).createIndex("documentTargetsIndex",Iee,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Tee,{unique:!0}),t.createObjectStore("targetGlobal")}const AN="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class kI{constructor(e,n,r,s,i,o,l,c,d,h,m=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=i,this.window=o,this.document=l,this.ci=d,this.li=h,this.hi=m,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=p=>Promise.resolve(),!kI.D())throw new Ee(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Gte(this,s),this.Ai=n+"main",this.serializer=new mB(c),this.Ri=new yc(this.Ai,this.hi,new ine(this.serializer)),this.$r=new Lte,this.Ur=new zte(this.referenceDelegate,this.serializer),this.remoteDocumentCache=kB(this.serializer),this.Gr=new Pte,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&lr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ee(ie.FAILED_PRECONDITION,AN);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new zs(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>bv(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Zc(e))return me("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return me("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return $p(e).get("owner").next(n=>ee.resolve(this.vi(n)))}Ci(e){return bv(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Cr(n,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(l=>i.indexOf(l)===-1);return ee.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?ee.resolve(!0):$p(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new Ee(ie.FAILED_PRECONDITION,AN);return!1}}return!(!this.networkEnabled||!this.inForeground)||bv(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&me("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new HS(e,zs.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>bv(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return ck.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Bte(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return lk.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){me("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===17?$ee:c===16?Fee:c===15?lI:c===14?N$:c===13?k$:c===12?Vee:c===11?w$:void Ue()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,l=>(o=new HS(l,this.Qr?this.Qr.next():zs.oe),n==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw lr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Ee(ie.FAILED_PRECONDITION,y$);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return $p(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Ee(ie.FAILED_PRECONDITION,AN)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return $p(e).put("owner",n)}static D(){return yc.D()}bi(e){const n=$p(e);return n.get("owner").next(r=>this.vi(r)?(me("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):ee.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(lr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;c6()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return me("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return lr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){lr("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function $p(t){return Cr(t,"owner")}function bv(t){return Cr(t,"clientMetadata")}function SB(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Ct(),s=Ct();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new NI(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class one{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TB{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return c6()?8:v$(Tr())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new one;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Lh()<=Mt.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",Mh(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ee.resolve()):(Lh()<=Mt.DEBUG&&me("QueryEngine","Query:",Mh(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Lh()<=Mt.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",Mh(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hi(n))):ee.resolve())}Yi(e,n){if(kM(n))return ee.resolve(null);let r=hi(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=p_(n,null,"F"),r=hi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ct(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(n,l);return this.ns(n,d,o,c.readTime)?this.Yi(e,p_(n,null,"F")):this.rs(e,d,n,c)}))})))}Zi(e,n,r,s){return kM(n)||s.isEqual(Xe.min())?ee.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?ee.resolve(null):(Lh()<=Mt.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Mh(n)),this.rs(e,o,n,p$(s,-1)).next(l=>l))})}ts(e,n){let r=new dn(z$(e));return n.forEach((s,i)=>{I0(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Lh()<=Mt.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",Mh(n)),this.Ji.getDocumentsMatchingQuery(e,n,yi.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ane{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new qn(ft),this._s=new Yc(i=>ud(i),T0),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new NB(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function CB(t,e,n,r){return new ane(t,e,n,r)}async function IB(t,e){const n=ze(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Ct();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function lne(t,e){const n=ze(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,d,h){const m=d.batch,p=m.keys();let v=ee.resolve();return p.forEach(x=>{v=v.next(()=>h.getEntry(c,x)).next(b=>{const E=d.docVersions.get(x);Qe(E!==null),b.version.compareTo(E)<0&&(m.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),h.addEntry(b)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ct();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function jB(t){const e=ze(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function cne(t,e){const n=ze(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((h,m)=>{const p=s.get(m);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,m)));let v=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(cr.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(m,v),function(b,E,k){return b.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(p,v,h)&&l.push(n.Ur.updateTargetData(i,v))});let c=li(),d=Ct();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(une(i,o,e.documentUpdates).next(h=>{c=h.Ps,d=h.Is})),!r.isEqual(Xe.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return ee.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.os=s,i))}function une(t,e,n){let r=Ct(),s=Ct();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=li();return n.forEach((l,c)=>{const d=i.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(Xe.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):me("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function dne(t,e){const n=ze(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function __(t,e){const n=ze(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,ee.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new La(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Kf(t,e,n){const r=ze(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Zc(o))throw o;me("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function oT(t,e,n){const r=ze(t);let s=Xe.min(),i=Ct();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const m=ze(c),p=m._s.get(h);return p!==void 0?ee.resolve(m.os.get(p)):m.Ur.getTargetData(d,h)}(r,o,hi(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:Xe.min(),n?i:Ct())).next(l=>(PB(r,B$(e),l),{documents:l,Ts:i})))}function AB(t,e){const n=ze(t),r=ze(n.Ur),s=n.os.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function RB(t,e){const n=ze(t),r=n.us.get(e)||Xe.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.cs.getAllFromCollectionGroup(s,e,p$(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(PB(n,e,s),s))}function PB(t,e,n){let r=t.us.get(e)||Xe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}function XM(t,e){return`firestore_clients_${t}_${e}`}function JM(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function RN(t,e){return`firestore_targets_${t}_${e}`}class w_{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Rs(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new Ee(s.error.code,s.error.message))),o?new w_(e,n,s.state,i):(lr("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Vg{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new Ee(r.error.code,r.error.message))),i?new Vg(e,r.state,s):(lr("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class k_{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=hI();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=b$(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new k_(e,i):(lr("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class EI{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new EI(n.clientId,n.onlineState):(lr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class aT{constructor(){this.activeTargetIds=hI()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class PN{constructor(e,n,r,s,i){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new qn(ft),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=XM(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new aT),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(XM(this.persistenceKey,r));if(s){const i=k_.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(RN(this.persistenceKey,e));if(s){const i=Vg.Rs(e,s);i&&(r=i.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(RN(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return me("SharedClientState","READ",e,n),n}setItem(e,n){me("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){me("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(me("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void lr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(i){let o=zs.oe;if(i!=null)try{const l=JSON.parse(i);Qe(typeof l=="number"),o=l}catch(l){lr("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(n.newValue);r!==zs.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const s=new w_(this.currentUser,e,n,r),i=JM(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const n=JM(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const s=RN(this.persistenceKey,e),i=new Vg(e,n,r);this.setItem(s,i.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return k_.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return w_.Rs(new Mr(i),s,n)}Ys(e,n){const r=this.Ms.exec(e),s=Number(r[1]);return Vg.Rs(s,n)}Ls(e){return EI.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);me("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],l=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||l.push(c)}),this.syncEngine.io(o,l).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=hI();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class LB{constructor(){this.so=new aT,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new aT,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hne{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){me("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){me("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _v=null;function LN(){return _v===null?_v=function(){return 268435456+Math.round(2147483648*Math.random())}():_v++,"0x"+_v.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fne={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mne{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="WebChannelConnection";class pne extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=LN(),c=this.xo(n,r.toUriEncodedString());me("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,c,d,s).then(h=>(me("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw $f("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",c,"request:",s),h})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+jm}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=fne[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=LN();return new Promise((o,l)=>{const c=new a$;c.setWithCredentials(!0),c.listenOnce(l$.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case lb.NO_ERROR:const h=c.getResponseJson();me(rs,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case lb.TIMEOUT:me(rs,`RPC '${e}' ${i} timed out`),l(new Ee(ie.DEADLINE_EXCEEDED,"Request time out"));break;case lb.HTTP_ERROR:const m=c.getStatus();if(me(rs,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p==null?void 0:p.error;if(v&&v.status&&v.message){const x=function(E){const k=E.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(k)>=0?k:ie.UNKNOWN}(v.status);l(new Ee(x,v.message))}else l(new Ee(ie.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ee(ie.UNAVAILABLE,"Connection failed."));break;default:Ue()}}finally{me(rs,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);me(rs,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=LN(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=d$(),l=u$(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=i.join("");me(rs,`Creating RPC '${e}' stream ${s}: ${h}`,c);const m=o.createWebChannel(h,c);let p=!1,v=!1;const x=new mne({Io:E=>{v?me(rs,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(p||(me(rs,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),me(rs,`RPC '${e}' stream ${s} sending:`,E),m.send(E))},To:()=>m.close()}),b=(E,k,_)=>{E.listen(k,S=>{try{_(S)}catch(T){setTimeout(()=>{throw T},0)}})};return b(m,lg.EventType.OPEN,()=>{v||(me(rs,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),b(m,lg.EventType.CLOSE,()=>{v||(v=!0,me(rs,`RPC '${e}' stream ${s} transport closed`),x.So())}),b(m,lg.EventType.ERROR,E=>{v||(v=!0,$f(rs,`RPC '${e}' stream ${s} transport errored:`,E),x.So(new Ee(ie.UNAVAILABLE,"The operation could not be completed")))}),b(m,lg.EventType.MESSAGE,E=>{var k;if(!v){const _=E.data[0];Qe(!!_);const S=_,T=S.error||((k=S[0])===null||k===void 0?void 0:k.error);if(T){me(rs,`RPC '${e}' stream ${s} received error:`,T);const P=T.status;let j=function(O){const D=hr[O];if(D!==void 0)return tB(D)}(P),R=T.message;j===void 0&&(j=ie.INTERNAL,R="Unknown error status: "+P+" with message "+T.message),v=!0,x.So(new Ee(j,R)),m.close()}else me(rs,`RPC '${e}' stream ${s} received:`,_),x.bo(_)}}),b(l,c$.STAT_EVENT,E=>{E.stat===US.PROXY?me(rs,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===US.NOPROXY&&me(rs,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MB(){return typeof window<"u"?window:null}function pb(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t){return new _te(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OB{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&me("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DB{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new OB(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===ie.RESOURCE_EXHAUSTED?(lr(n.toString()),lr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new Ee(ie.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return me("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(me("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gne extends DB{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=Nte(this.serializer,e),r=function(i){if(!("targetChange"in i))return Xe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Xe.min():o.readTime?js(o.readTime):Xe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=tT(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=f_(c)?{documents:cB(i,c)}:{query:vI(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=sB(i,o.resumeToken);const d=JS(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Xe.min())>0){l.readTime=Gf(i,o.snapshotVersion.toTimestamp());const d=JS(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=Tte(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=tT(this.serializer),n.removeTarget=e,this.a_(n)}}class yne extends DB{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Qe(!!e.streamToken),this.lastStreamToken=e.streamToken,Qe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Qe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=Ete(e.writeResults,e.commitTime),r=js(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=tT(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>y_(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xne extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,eT(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ee(ie.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,eT(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ee(ie.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class vne{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(lr(n),this.D_=!1):me("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bne{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Dd(this)&&(me("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=ze(c);d.L_.add(4),await L0(d),d.q_.set("Unknown"),d.L_.delete(4),await hk(d)}(this))})}),this.q_=new vne(r,s)}}async function hk(t){if(Dd(t))for(const e of t.B_)await e(!0)}async function L0(t){for(const e of t.B_)await e(!1)}function fk(t,e){const n=ze(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),CI(n)?TI(n):Pm(n).r_()&&SI(n,e))}function Qf(t,e){const n=ze(t),r=Pm(n);n.N_.delete(e),r.r_()&&VB(n,e),n.N_.size===0&&(r.r_()?r.o_():Dd(n)&&n.q_.set("Unknown"))}function SI(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Pm(t).A_(e)}function VB(t,e){t.Q_.xe(e),Pm(t).R_(e)}function TI(t){t.Q_=new yte({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Pm(t).start(),t.q_.v_()}function CI(t){return Dd(t)&&!Pm(t).n_()&&t.N_.size>0}function Dd(t){return ze(t).L_.size===0}function FB(t){t.Q_=void 0}async function _ne(t){t.q_.set("Online")}async function wne(t){t.N_.forEach((e,n)=>{SI(t,e)})}async function kne(t,e){FB(t),CI(t)?(t.q_.M_(e),TI(t)):t.q_.set("Unknown")}async function Nne(t,e,n){if(t.q_.set("Online"),e instanceof rB&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){me("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await N_(t,r)}else if(e instanceof mb?t.Q_.Ke(e):e instanceof nB?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Xe.min()))try{const r=await jB(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const h=i.N_.get(c);if(!h)return;i.N_.set(c,h.withResumeToken(cr.EMPTY_BYTE_STRING,h.snapshotVersion)),VB(i,c);const m=new La(h.target,c,d,h.sequenceNumber);SI(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){me("RemoteStore","Failed to raise snapshot:",r),await N_(t,r)}}async function N_(t,e,n){if(!Zc(e))throw e;t.L_.add(1),await L0(t),t.q_.set("Offline"),n||(n=()=>jB(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{me("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await hk(t)})}function $B(t,e){return e().catch(n=>N_(t,n,e))}async function Rm(t){const e=ze(t),n=jc(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Ene(e);)try{const s=await dne(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,Sne(e,s)}catch(s){await N_(e,s)}BB(e)&&zB(e)}function Ene(t){return Dd(t)&&t.O_.length<10}function Sne(t,e){t.O_.push(e);const n=jc(t);n.r_()&&n.V_&&n.m_(e.mutations)}function BB(t){return Dd(t)&&!jc(t).n_()&&t.O_.length>0}function zB(t){jc(t).start()}async function Tne(t){jc(t).p_()}async function Cne(t){const e=jc(t);for(const n of t.O_)e.m_(n.mutations)}async function Ine(t,e,n){const r=t.O_.shift(),s=pI.from(r,e,n);await $B(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Rm(t)}async function jne(t,e){e&&jc(t).V_&&await async function(r,s){if(function(o){return mte(o)&&o!==ie.ABORTED}(s.code)){const i=r.O_.shift();jc(r).s_(),await $B(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Rm(r)}}(t,e),BB(t)&&zB(t)}async function tO(t,e){const n=ze(t);n.asyncQueue.verifyOperationInProgress(),me("RemoteStore","RemoteStore received new credentials");const r=Dd(n);n.L_.add(3),await L0(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await hk(n)}async function lT(t,e){const n=ze(t);e?(n.L_.delete(2),await hk(n)):e||(n.L_.add(2),await L0(n),n.q_.set("Unknown"))}function Pm(t){return t.K_||(t.K_=function(n,r,s){const i=ze(n);return i.w_(),new gne(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:_ne.bind(null,t),Ro:wne.bind(null,t),mo:kne.bind(null,t),d_:Nne.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),CI(t)?TI(t):t.q_.set("Unknown")):(await t.K_.stop(),FB(t))})),t.K_}function jc(t){return t.U_||(t.U_=function(n,r,s){const i=ze(n);return i.w_(),new yne(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Tne.bind(null,t),mo:jne.bind(null,t),f_:Cne.bind(null,t),g_:Ine.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Rm(t)):(await t.U_.stop(),t.O_.length>0&&(me("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new yo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new II(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jI(t,e){if(lr("AsyncQueue",`${e}: ${t}`),Zc(t))return new Ee(ie.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Le.comparator(n.key,r.key):(n,r)=>Le.comparator(n.key,r.key),this.keyedMap=cg(),this.sortedSet=new qn(this.comparator)}static emptySet(e){return new bf(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof bf)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new bf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(){this.W_=new qn(Le.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Ue():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Zf{constructor(e,n,r,s,i,o,l,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Zf(e,n,bf.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ik(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ane{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Rne{constructor(){this.queries=rO(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ze(n),i=s.queries;s.queries=rO(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new Ee(ie.ABORTED,"Firestore shutting down"))}}function rO(){return new Yc(t=>$$(t),ik)}async function AI(t,e){const n=ze(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new Ane,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=jI(o,`Initialization of query '${Mh(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&PI(n)}async function RI(t,e){const n=ze(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Pne(t,e){const n=ze(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&PI(n)}function Lne(t,e,n){const r=ze(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function PI(t){t.Y_.forEach(e=>{e.next()})}var cT,sO;(sO=cT||(cT={})).ea="default",sO.Cache="cache";class LI{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Zf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Zf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==cT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UB{constructor(e){this.key=e}}class WB{constructor(e){this.key=e}}class Mne{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ct(),this.mutatedKeys=Ct(),this.Aa=z$(e),this.Ra=new bf(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new nO,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const p=s.get(h),v=I0(this.query,m)?m:null,x=!!p&&this.mutatedKeys.has(p.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let E=!1;p&&v?p.data.isEqual(v.data)?x!==b&&(r.track({type:3,doc:v}),E=!0):this.ga(p,v)||(r.track({type:2,doc:v}),E=!0,(c&&this.Aa(v,c)>0||d&&this.Aa(v,d)<0)&&(l=!0)):!p&&v?(r.track({type:0,doc:v}),E=!0):p&&!v&&(r.track({type:1,doc:p}),E=!0,(c||d)&&(l=!0)),E&&(v?(o=o.add(v),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,m)=>function(v,x){const b=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ue()}};return b(v)-b(x)}(h.type,m.type)||this.Aa(h.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new Zf(this.query,e.Ra,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new nO,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ct(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new WB(r))}),this.da.forEach(r=>{e.has(r)||n.push(new UB(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ct();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Zf.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class One{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Dne{constructor(e){this.key=e,this.va=!1}}class Vne{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Yc(l=>$$(l),ik),this.Ma=new Map,this.xa=new Set,this.Oa=new qn(Le.comparator),this.Na=new Map,this.La=new wI,this.Ba={},this.ka=new Map,this.qa=pd.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Fne(t,e,n=!0){const r=mk(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await HB(r,e,n,!0),s}async function $ne(t,e){const n=mk(t);await HB(n,e,!0,!1)}async function HB(t,e,n,r){const s=await __(t.localStore,hi(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await MI(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&fk(t.remoteStore,s),l}async function MI(t,e,n,r,s){t.Ka=(m,p,v)=>async function(b,E,k,_){let S=E.view.ma(k);S.ns&&(S=await oT(b.localStore,E.query,!1).then(({documents:R})=>E.view.ma(R,S)));const T=_&&_.targetChanges.get(E.targetId),P=_&&_.targetMismatches.get(E.targetId)!=null,j=E.view.applyChanges(S,b.isPrimaryClient,T,P);return uT(b,E.targetId,j.wa),j.snapshot}(t,m,p,v);const i=await oT(t.localStore,e,!0),o=new Mne(e,i.Ts),l=o.ma(i.documents),c=P0.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,c);uT(t,n,d.wa);const h=new One(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function Bne(t,e,n){const r=ze(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!ik(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Kf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Qf(r.remoteStore,s.targetId),Yf(r,s.targetId)}).catch(Qc)):(Yf(r,s.targetId),await Kf(r.localStore,s.targetId,!0))}async function zne(t,e){const n=ze(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Qf(n.remoteStore,r.targetId))}async function Une(t,e,n){const r=FI(t);try{const s=await function(o,l){const c=ze(o),d=Un.now(),h=l.reduce((v,x)=>v.add(x.key),Ct());let m,p;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let x=li(),b=Ct();return c.cs.getEntries(v,h).next(E=>{x=E,x.forEach((k,_)=>{_.isValidDocument()||(b=b.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,x)).next(E=>{m=E;const k=[];for(const _ of l){const S=dte(_,m.get(_.key).overlayedDocument);S!=null&&k.push(new hl(_.key,S,I$(S.value.mapValue),Er.exists(!0)))}return c.mutationQueue.addMutationBatch(v,d,k,l)}).next(E=>{p=E;const k=E.applyToLocalDocumentSet(m,b);return c.documentOverlayCache.saveOverlays(v,E.batchId,k)})}).then(()=>({batchId:p.batchId,changes:W$(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new qn(ft)),d=d.insert(l,c),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await Xc(r,s.changes),await Rm(r.remoteStore)}catch(s){const i=jI(s,"Failed to persist write");n.reject(i)}}async function qB(t,e){const n=ze(t);try{const r=await cne(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Qe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Qe(o.va):s.removedDocuments.size>0&&(Qe(o.va),o.va=!1))}),await Xc(n,r,e)}catch(r){await Qc(r)}}function iO(t,e,n){const r=ze(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=ze(o);c.onlineState=l;let d=!1;c.queries.forEach((h,m)=>{for(const p of m.j_)p.Z_(l)&&(d=!0)}),d&&PI(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Wne(t,e,n){const r=ze(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new qn(Le.comparator);o=o.insert(i,Yn.newNoDocument(i,Xe.min()));const l=Ct().add(i),c=new R0(Xe.min(),new Map,new qn(ft),o,l);await qB(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),VI(r)}else await Kf(r.localStore,e,!1).then(()=>Yf(r,e,n)).catch(Qc)}async function Hne(t,e){const n=ze(t),r=e.batch.batchId;try{const s=await lne(n.localStore,e);DI(n,r,null),OI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Xc(n,s)}catch(s){await Qc(s)}}async function qne(t,e,n){const r=ze(t);try{const s=await function(o,l){const c=ze(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,l).next(m=>(Qe(m!==null),h=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);DI(r,e,n),OI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Xc(r,s)}catch(s){await Qc(s)}}function OI(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function DI(t,e,n){const r=ze(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Yf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||GB(t,r)})}function GB(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Qf(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),VI(t))}function uT(t,e,n){for(const r of n)r instanceof UB?(t.La.addReference(r.key,e),Gne(t,r)):r instanceof WB?(me("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||GB(t,r.key)):Ue()}function Gne(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(me("SyncEngine","New document in limbo: "+n),t.xa.add(r),VI(t))}function VI(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Le(Yt.fromString(e)),r=t.qa.next();t.Na.set(r,new Dne(n)),t.Oa=t.Oa.insert(n,r),fk(t.remoteStore,new La(hi(C0(n.path)),r,"TargetPurposeLimboResolution",zs.oe))}}async function Xc(t,e,n){const r=ze(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){s.push(d);const m=NI.Wi(c.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,d){const h=ze(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>ee.forEach(d,p=>ee.forEach(p.$i,v=>h.persistence.referenceDelegate.addReference(m,p.targetId,v)).next(()=>ee.forEach(p.Ui,v=>h.persistence.referenceDelegate.removeReference(m,p.targetId,v)))))}catch(m){if(!Zc(m))throw m;me("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const p=m.targetId;if(!m.fromCache){const v=h.os.get(p),x=v.snapshotVersion,b=v.withLastLimboFreeSnapshotVersion(x);h.os=h.os.insert(p,b)}}}(r.localStore,i))}async function Kne(t,e){const n=ze(t);if(!n.currentUser.isEqual(e)){me("SyncEngine","User change. New user:",e.toKey());const r=await IB(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new Ee(ie.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Xc(n,r.hs)}}function Qne(t,e){const n=ze(t),r=n.Na.get(e);if(r&&r.va)return Ct().add(r.key);{let s=Ct();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}async function Zne(t,e){const n=ze(t),r=await oT(n.localStore,e.query,!0),s=e.view.ba(r);return n.isPrimaryClient&&uT(n,e.targetId,s.wa),s}async function Yne(t,e){const n=ze(t);return RB(n.localStore,e).then(r=>Xc(n,r))}async function Xne(t,e,n,r){const s=ze(t),i=await function(l,c){const d=ze(l),h=ze(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>h.Mn(m,c).next(p=>p?d.localDocuments.getDocuments(m,p):ee.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await Rm(s.remoteStore):n==="acknowledged"||n==="rejected"?(DI(s,e,r||null),OI(s,e),function(l,c){ze(ze(l).mutationQueue).On(c)}(s.localStore,e)):Ue(),await Xc(s,i)):me("SyncEngine","Cannot apply mutation batch with id: "+e)}async function Jne(t,e){const n=ze(t);if(mk(n),FI(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await oO(n,r.toArray());n.Qa=!0,await lT(n.remoteStore,!0);for(const i of s)fk(n.remoteStore,i)}else if(e===!1&&n.Qa!==!1){const r=[];let s=Promise.resolve();n.Ma.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Yf(n,o),Kf(n.localStore,o,!0))),Qf(n.remoteStore,o)}),await s,await oO(n,r),function(o){const l=ze(o);l.Na.forEach((c,d)=>{Qf(l.remoteStore,d)}),l.La.pr(),l.Na=new Map,l.Oa=new qn(Le.comparator)}(n),n.Qa=!1,await lT(n.remoteStore,!1)}}async function oO(t,e,n){const r=ze(t),s=[],i=[];for(const o of e){let l;const c=r.Ma.get(o);if(c&&c.length!==0){l=await __(r.localStore,hi(c[0]));for(const d of c){const h=r.Fa.get(d),m=await Zne(r,h);m.snapshot&&i.push(m.snapshot)}}else{const d=await AB(r.localStore,o);l=await __(r.localStore,d),await MI(r,KB(d),o,!1,l.resumeToken)}s.push(l)}return r.Ca.d_(i),s}function KB(t){return D$(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ere(t){return function(n){return ze(ze(n).persistence).Qi()}(ze(t).localStore)}async function tre(t,e,n,r){const s=ze(t);if(s.Qa)return void me("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await RB(s.localStore,B$(i[0])),l=R0.createSynthesizedRemoteEventForCurrentChange(e,n==="current",cr.EMPTY_BYTE_STRING);await Xc(s,o,l);break}case"rejected":await Kf(s.localStore,e,!0),Yf(s,e,r);break;default:Ue()}}async function nre(t,e,n){const r=mk(t);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){me("SyncEngine","Adding an already active target "+s);continue}const i=await AB(r.localStore,s),o=await __(r.localStore,i);await MI(r,KB(i),o.targetId,!1,o.resumeToken),fk(r.remoteStore,o)}for(const s of n)r.Ma.has(s)&&await Kf(r.localStore,s,!1).then(()=>{Qf(r.remoteStore,s),Yf(r,s)}).catch(Qc)}}function mk(t){const e=ze(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=qB.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Wne.bind(null,e),e.Ca.d_=Pne.bind(null,e.eventManager),e.Ca.$a=Lne.bind(null,e.eventManager),e}function FI(t){const e=ze(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Hne.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qne.bind(null,e),e}class Iy{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=dk(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return CB(this.persistence,new TB,e.initialUser,this.serializer)}Ga(e){return new EB(uk.Zr,this.serializer)}Wa(e){return new LB}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Iy.provider={build:()=>new Iy};class QB extends Iy{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await FI(this.Ja.syncEngine),await Rm(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return CB(this.persistence,new TB,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new Wte(r,e.asyncQueue,n)}Ha(e,n){const r=new _ee(n,this.persistence);return new bee(e.asyncQueue,r)}Ga(e){const n=SB(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Vs.withCacheSize(this.cacheSizeBytes):Vs.DEFAULT;return new kI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,MB(),pb(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new LB}}class rre extends QB{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof PN&&(this.sharedClientState.syncEngine={no:Xne.bind(null,n),ro:tre.bind(null,n),io:nre.bind(null,n),Qi:ere.bind(null,n),eo:Yne.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await Jne(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=MB();if(!PN.D(n))throw new Ee(ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=SB(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new PN(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class jy{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>iO(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kne.bind(null,this.syncEngine),await lT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Rne}()}createDatastore(e){const n=dk(e.databaseInfo.databaseId),r=function(i){return new pne(i)}(e.databaseInfo);return function(i,o,l,c){return new xne(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new bne(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>iO(this.syncEngine,n,0),function(){return eO.D()?new eO:new hne}())}createSyncEngine(e,n){return function(s,i,o,l,c,d,h){const m=new Vne(s,i,o,l,c,d);return h&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ze(s);me("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await L0(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}jy.provider={build:()=>new jy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):lr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sre{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Mr.UNAUTHENTICATED,this.clientId=f$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{me("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(me("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new yo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=jI(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function MN(t,e){t.asyncQueue.verifyOperationInProgress(),me("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await IB(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function aO(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ire(t);me("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>tO(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>tO(e.remoteStore,s)),t._onlineComponents=e}async function ire(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){me("FirestoreClient","Using user provided OfflineComponentProvider");try{await MN(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===ie.FAILED_PRECONDITION||s.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;$f("Error using user provided cache. Falling back to memory cache: "+n),await MN(t,new Iy)}}else me("FirestoreClient","Using default OfflineComponentProvider"),await MN(t,new Iy);return t._offlineComponents}async function BI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(me("FirestoreClient","Using user provided OnlineComponentProvider"),await aO(t,t._uninitializedComponentsProvider._online)):(me("FirestoreClient","Using default OnlineComponentProvider"),await aO(t,new jy))),t._onlineComponents}function ore(t){return BI(t).then(e=>e.syncEngine)}function are(t){return BI(t).then(e=>e.datastore)}async function E_(t){const e=await BI(t),n=e.eventManager;return n.onListen=Fne.bind(null,e.syncEngine),n.onUnlisten=Bne.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$ne.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=zne.bind(null,e.syncEngine),n}function lre(t,e,n={}){const r=new yo;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const h=new $I({next:p=>{h.Za(),o.enqueueAndForget(()=>RI(i,m));const v=p.docs.has(l);!v&&p.fromCache?d.reject(new Ee(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&p.fromCache&&c&&c.source==="server"?d.reject(new Ee(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new LI(C0(l.path),h,{includeMetadataChanges:!0,_a:!0});return AI(i,m)}(await E_(t),t.asyncQueue,e,n,r)),r.promise}function cre(t,e,n={}){const r=new yo;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const h=new $I({next:p=>{h.Za(),o.enqueueAndForget(()=>RI(i,m)),p.fromCache&&c.source==="server"?d.reject(new Ee(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new LI(l,h,{includeMetadataChanges:!0,_a:!0});return AI(i,m)}(await E_(t),t.asyncQueue,e,n,r)),r.promise}function ure(t,e,n){const r=new yo;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await are(t);r.resolve(async function(o,l,c){var d;const h=ze(o),{request:m,ut:p,parent:v}=Ste(h.serializer,ete(l),c);h.connection.Fo||delete m.parent;const x=(await h.Lo("RunAggregationQuery",h.serializer.databaseId,v,m,1)).filter(E=>!!E.result);Qe(x.length===1);const b=(d=x[0].result)===null||d===void 0?void 0:d.aggregateFields;return Object.keys(b).reduce((E,k)=>(E[p[k]]=b[k],E),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZB(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t,e,n){if(!n)throw new Ee(ie.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dre(t,e,n,r){if(e===!0&&r===!0)throw new Ee(ie.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function cO(t){if(!Le.isDocumentKey(t))throw new Ee(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function uO(t){if(Le.isDocumentKey(t))throw new Ee(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function pk(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ue()}function Zr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ee(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=pk(t);throw new Ee(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function hre(t,e){if(e<=0)throw new Ee(ie.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ee(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dre("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZB((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ee(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class M0{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dO({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dO(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new cee;switch(r.type){case"firstParty":return new fee(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ee(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=lO.get(n);r&&(me("ComponentProvider","Removing Datastore"),lO.delete(n),r.terminate())}(this),Promise.resolve()}}function fre(t,e,n,r={}){var s;const i=(t=Zr(t,M0))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&$f("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Mr.MOCK_USER;else{l=bZ(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new Ee(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Mr(d)}t._authCredentials=new uee(new h$(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ia(this.firestore,e,this._query)}}class ms{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ms(this.firestore,e,this._key)}}class vc extends ia{constructor(e,n,r){super(e,n,C0(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ms(this.firestore,null,new Le(e))}withConverter(e){return new vc(this.firestore,e,this._path)}}function Re(t,e,...n){if(t=In(t),zI("collection","path",e),t instanceof M0){const r=Yt.fromString(e,...n);return uO(r),new vc(t,null,r)}{if(!(t instanceof ms||t instanceof vc))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Yt.fromString(e,...n));return uO(r),new vc(t.firestore,null,r)}}function gd(t,e){if(t=Zr(t,M0),zI("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ia(t,null,function(r){return new Od(Yt.emptyPath(),r)}(e))}function Se(t,e,...n){if(t=In(t),arguments.length===1&&(e=f$.newId()),zI("doc","path",e),t instanceof M0){const r=Yt.fromString(e,...n);return cO(r),new ms(t,null,new Le(r))}{if(!(t instanceof ms||t instanceof vc))throw new Ee(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Yt.fromString(e,...n));return cO(r),new ms(t.firestore,t instanceof vc?t.converter:null,new Le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new OB(this,"async_queue_retry"),this.Vu=()=>{const r=pb();r&&me("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=pb();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=pb();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new yo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Zc(e))throw e;me("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw lr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=II.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Ue()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function fO(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class bo extends M0{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new hO,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new hO(e),this._firestoreClient=void 0,await e}}}function mre(t,e,n){n||(n="(default)");const r=Yw(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(id(i,e))return s;throw new Ee(ie.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ee(ie.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ee(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function pre(t,e){const n=typeof t=="object"?t:p6(),r=typeof t=="string"?t:"(default)",s=Yw(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=xZ("firestore");i&&fre(s,...i)}return s}function Lm(t){if(t._terminated)throw new Ee(ie.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||gre(t),t._firestoreClient}function gre(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,d,h){return new Uee(l,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,ZB(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new sre(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yre{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class xre{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xf(cr.fromBase64String(e))}catch(n){throw new Ee(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Xf(cr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ee(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ee(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ee(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ft(this._lat,e._lat)||ft(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vre=/^__.*__$/;class bre{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new hl(e,this.data,this.fieldMask,n,this.fieldTransforms):new Am(e,this.data,n,this.fieldTransforms)}}class YB{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new hl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function XB(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ue()}}class gk{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new gk(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return S_(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(XB(this.Cu)&&vre.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class _re{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||dk(e)}Qu(e,n,r,s=!1){return new gk({Cu:e,methodName:n,qu:r,path:Fn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function D0(t){const e=t._freezeSettings(),n=dk(t._databaseId);return new _re(t._databaseId,!!e.ignoreUndefinedProperties,n)}function HI(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);ZI("Data must be an object, but it was:",o,r);const l=nz(r,o);let c,d;if(i.merge)c=new Us(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const p=dT(e,m,n);if(!o.contains(p))throw new Ee(ie.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);sz(h,p)||h.push(p)}c=new Us(h),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new bre(new ds(l),c,d)}class V0 extends Vd{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof V0}}function JB(t,e,n){return new gk({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class qI extends Vd{_toFieldTransform(e){return new j0(e.path,new Hf)}isEqual(e){return e instanceof qI}}class GI extends Vd{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=JB(this,e,!0),r=this.Ku.map(i=>Fd(i,n)),s=new dd(r);return new j0(e.path,s)}isEqual(e){return e instanceof GI&&id(this.Ku,e.Ku)}}class KI extends Vd{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=JB(this,e,!0),r=this.Ku.map(i=>Fd(i,n)),s=new hd(r);return new j0(e.path,s)}isEqual(e){return e instanceof KI&&id(this.Ku,e.Ku)}}class QI extends Vd{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new qf(e.serializer,G$(e.serializer,this.$u));return new j0(e.path,n)}isEqual(e){return e instanceof QI&&this.$u===e.$u}}function ez(t,e,n,r){const s=t.Qu(1,e,n);ZI("Data must be an object, but it was:",s,r);const i=[],o=ds.empty();Md(r,(c,d)=>{const h=YI(e,c,n);d=In(d);const m=s.Nu(h);if(d instanceof V0)i.push(h);else{const p=Fd(d,m);p!=null&&(i.push(h),o.set(h,p))}});const l=new Us(i);return new YB(o,l,s.fieldTransforms)}function tz(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[dT(e,r,n)],c=[s];if(i.length%2!=0)throw new Ee(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(dT(e,i[p])),c.push(i[p+1]);const d=[],h=ds.empty();for(let p=l.length-1;p>=0;--p)if(!sz(d,l[p])){const v=l[p];let x=c[p];x=In(x);const b=o.Nu(v);if(x instanceof V0)d.push(v);else{const E=Fd(x,b);E!=null&&(d.push(v),h.set(v,E))}}const m=new Us(d);return new YB(h,m,o.fieldTransforms)}function wre(t,e,n,r=!1){return Fd(n,t.Qu(r?4:3,e))}function Fd(t,e){if(rz(t=In(t)))return ZI("Unsupported field value:",e,t),nz(t,e);if(t instanceof Vd)return function(r,s){if(!XB(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Fd(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=In(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return G$(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Un.fromDate(r);return{timestampValue:Gf(s.serializer,i)}}if(r instanceof Un){const i=new Un(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Gf(s.serializer,i)}}if(r instanceof UI)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Xf)return{bytesValue:sB(s.serializer,r._byteString)};if(r instanceof ms){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:xI(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof WI)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return fI(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${pk(r)}`)}(t,e)}function nz(t,e){const n={};return E$(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Md(t,(r,s)=>{const i=Fd(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function rz(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Un||t instanceof UI||t instanceof Xf||t instanceof ms||t instanceof Vd||t instanceof WI)}function ZI(t,e,n){if(!rz(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=pk(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function dT(t,e,n){if((e=In(e))instanceof O0)return e._internalPath;if(typeof e=="string")return YI(t,e);throw S_("Field path arguments must be of type string or ",t,!1,void 0,n)}const kre=new RegExp("[~\\*/\\[\\]]");function YI(t,e,n){if(e.search(kre)>=0)throw S_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new O0(...e.split("."))._internalPath}catch{throw S_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function S_(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Ee(ie.INVALID_ARGUMENT,l+t+c)}function sz(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ms(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Nre(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(yk("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Nre extends iz{data(){return super.data()}}function yk(t,e){return typeof e=="string"?YI(t,e):e instanceof O0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ee(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class XI{}let JI=class extends XI{};function Et(t,e,...n){let r=[];e instanceof XI&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof ej).length,l=i.filter(c=>c instanceof xk).length;if(o>1||o>0&&l>0)throw new Ee(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class xk extends JI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new xk(e,n,r)}_apply(e){const n=this._parse(e);return az(e._query,n),new ia(e.firestore,e.converter,XS(e._query,n))}_parse(e){const n=D0(e.firestore);return function(i,o,l,c,d,h,m){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){pO(m,h);const v=[];for(const x of m)v.push(mO(c,i,x));p={arrayValue:{values:v}}}else p=mO(c,i,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||pO(m,h),p=wre(l,o,m,h==="in"||h==="not-in");return Dt.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function nn(t,e,n){const r=e,s=yk("where",t);return xk._create(s,r,n)}class ej extends XI{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ej(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:tn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)az(o,c),o=XS(o,c)}(e._query,n),new ia(e.firestore,e.converter,XS(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class tj extends JI{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new tj(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cy(i,o)}(e._query,this._field,this._direction);return new ia(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Od(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Wn(t,e="asc"){const n=e,r=yk("orderBy",t);return tj._create(r,n)}class nj extends JI{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new nj(e,n,r)}_apply(e){return new ia(e.firestore,e.converter,p_(e._query,this._limit,this._limitType))}}function Qs(t){return hre("limit",t),nj._create("limit",t,"F")}function mO(t,e,n){if(typeof(n=In(n))=="string"){if(n==="")throw new Ee(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!V$(e)&&n.indexOf("/")!==-1)throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Yt.fromString(n));if(!Le.isDocumentKey(r))throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Sy(t,new Le(r))}if(n instanceof ms)return Sy(t,n._key);throw new Ee(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pk(n)}.`)}function pO(t,e){if(!Array.isArray(t)||t.length===0)throw new Ee(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function az(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ee(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Ere{convertValue(e,n="none"){switch(cd(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Cc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ue()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Md(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Rn(o.doubleValue));return new WI(i)}convertGeoPoint(e){return new UI(Rn(e.latitude),Rn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=uI(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ny(e));default:return null}}convertTimestamp(e){const n=Ya(e);return new Un(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Yt.fromString(e);Qe(fB(r));const s=new ld(r.get(1),r.get(3)),i=new Le(r.popFirst(5));return s.isEqual(n)||lr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rj(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function Sre(){return new yre("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lz extends iz{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new gb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(yk("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class gb extends lz{data(e={}){return super.data(e)}}class cz{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new hg(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new gb(this._firestore,this._userDataWriter,r.key,r,new hg(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ee(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new gb(s._firestore,s._userDataWriter,l.doc.key,l.doc,new hg(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new gb(s._firestore,s._userDataWriter,l.doc.key,l.doc,new hg(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:Tre(l.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Tre(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ue()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t){t=Zr(t,ms);const e=Zr(t.firestore,bo);return lre(Lm(e),t._key).then(n=>uz(e,t,n))}class vk extends Ere{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xf(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ms(this.firestore,null,n)}}function Kt(t){t=Zr(t,ia);const e=Zr(t.firestore,bo),n=Lm(e),r=new vk(e);return oz(t._query),cre(n,t._query).then(s=>new cz(e,r,t,s))}function ec(t,e,n){t=Zr(t,ms);const r=Zr(t.firestore,bo),s=rj(t.converter,e,n);return F0(r,[HI(D0(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Er.none())])}function Nt(t,e,n,...r){t=Zr(t,ms);const s=Zr(t.firestore,bo),i=D0(s);let o;return o=typeof(e=In(e))=="string"||e instanceof O0?tz(i,"updateDoc",t._key,e,n,r):ez(i,"updateDoc",t._key,e),F0(s,[o.toMutation(t._key,Er.exists(!0))])}function _o(t){return F0(Zr(t.firestore,bo),[new A0(t._key,Er.none())])}function hn(t,e){const n=Zr(t.firestore,bo),r=Se(t),s=rj(t.converter,e);return F0(n,[HI(D0(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Er.exists(!1))]).then(()=>r)}function pn(t,...e){var n,r,s;t=In(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||fO(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(fO(e[o])){const m=e[o];e[o]=(n=m.next)===null||n===void 0?void 0:n.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let c,d,h;if(t instanceof ms)d=Zr(t.firestore,bo),h=C0(t._key.path),c={next:m=>{e[o]&&e[o](uz(d,t,m))},error:e[o+1],complete:e[o+2]};else{const m=Zr(t,ia);d=Zr(m.firestore,bo),h=m._query;const p=new vk(d);c={next:v=>{e[o]&&e[o](new cz(d,p,m,v))},error:e[o+1],complete:e[o+2]},oz(t._query)}return function(p,v,x,b){const E=new $I(b),k=new LI(v,E,x);return p.asyncQueue.enqueueAndForget(async()=>AI(await E_(p),k)),()=>{E.Za(),p.asyncQueue.enqueueAndForget(async()=>RI(await E_(p),k))}}(Lm(d),h,l,c)}function F0(t,e){return function(r,s){const i=new yo;return r.asyncQueue.enqueueAndForget(async()=>Une(await ore(r),s,i)),i.promise}(Lm(t),e)}function uz(t,e,n){const r=n.docs.get(e._key),s=new vk(t);return new lz(t,s,e._key,r,new hg(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(t){return Cre(t,{count:Sre()})}function Cre(t,e){const n=Zr(t.firestore,bo),r=Lm(n),s=Bee(e,(i,o)=>new hte(o,i.aggregateType,i._internalFieldPath));return ure(r,t._query,s).then(i=>function(l,c,d){const h=new vk(l);return new xre(c,h,d)}(n,t,i))}class Ire{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=Pre(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function jre(t){return new Ire(t)}class Are{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=jy.provider,this._offlineComponentProvider={build:n=>new QB(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Rre{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=jy.provider,this._offlineComponentProvider={build:n=>new rre(n,e==null?void 0:e.cacheSizeBytes)}}}function Pre(t){return new Are(void 0)}function Lre(){return new Rre}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mre{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=D0(e)}set(e,n,r){this._verifyNotCommitted();const s=ON(e,this._firestore),i=rj(s.converter,n,r),o=HI(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Er.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=ON(e,this._firestore);let o;return o=typeof(n=In(n))=="string"||n instanceof O0?tz(this._dataReader,"WriteBatch.update",i._key,n,r,s):ez(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Er.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ON(e,this._firestore);return this._mutations=this._mutations.concat(new A0(n._key,Er.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ee(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ON(t,e){if((t=In(t)).firestore!==e)throw new Ee(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ore(){return new V0("deleteField")}function zt(){return new qI("serverTimestamp")}function Ay(...t){return new GI("arrayUnion",t)}function Dre(...t){return new KI("arrayRemove",t)}function ho(t){return new QI("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t){return Lm(t=Zr(t,bo)),new Mre(t,e=>F0(t,e))}(function(e,n=!0){(function(s){jm=s})(Cm),Vf(new od("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new bo(new dee(r.getProvider("auth-internal")),new pee(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ee(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ld(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),gc(aM,"4.7.3",e),gc(aM,"4.7.3","esm2017")})();var Vre="firebase",Fre="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gc(Vre,Fre,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},$re=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Bre={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;c||(v=64,o||(p=64)),r.push(n[h],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(dz(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$re(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw Error();const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},zre=function(t){const e=dz(t);return Bre.encodeByteArray(e,!0)},hz=function(t){return zre(t).replace(/\./g,"")};function Ure(){return typeof indexedDB=="object"}function Wre(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hre="FirebaseError";let ij=class fz extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Hre,Object.setPrototypeOf(this,fz.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mz.prototype.create)}},mz=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?qre(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new ij(s,l,r)}};function qre(t,e){return t.replace(Gre,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Gre=/\{\$([^}]+)}/g;let hT=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Nn||(Nn={}));const Kre={debug:Nn.DEBUG,verbose:Nn.VERBOSE,info:Nn.INFO,warn:Nn.WARN,error:Nn.ERROR,silent:Nn.SILENT},Qre=Nn.INFO,Zre={[Nn.DEBUG]:"log",[Nn.VERBOSE]:"log",[Nn.INFO]:"info",[Nn.WARN]:"warn",[Nn.ERROR]:"error"},Yre=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Zre[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let Xre=class{constructor(e){this.name=e,this._logLevel=Qre,this._logHandler=Yre,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Nn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Kre[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Nn.DEBUG,...e),this._logHandler(this,Nn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Nn.VERBOSE,...e),this._logHandler(this,Nn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Nn.INFO,...e),this._logHandler(this,Nn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Nn.WARN,...e),this._logHandler(this,Nn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Nn.ERROR,...e),this._logHandler(this,Nn.ERROR,...e)}};const Jre=(t,e)=>e.some(n=>t instanceof n);let gO,yO;function ese(){return gO||(gO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tse(){return yO||(yO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pz=new WeakMap,fT=new WeakMap,gz=new WeakMap,DN=new WeakMap,oj=new WeakMap;function nse(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(bc(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&pz.set(n,t)}).catch(()=>{}),oj.set(e,t),e}function rse(t){if(fT.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});fT.set(t,e)}let mT={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return fT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||gz.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bc(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function sse(t){mT=t(mT)}function ise(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(VN(this),e,...n);return gz.set(r,e.sort?e.sort():[e]),bc(r)}:tse().includes(t)?function(...e){return t.apply(VN(this),e),bc(pz.get(this))}:function(...e){return bc(t.apply(VN(this),e))}}function ose(t){return typeof t=="function"?ise(t):(t instanceof IDBTransaction&&rse(t),Jre(t,ese())?new Proxy(t,mT):t)}function bc(t){if(t instanceof IDBRequest)return nse(t);if(DN.has(t))return DN.get(t);const e=ose(t);return e!==t&&(DN.set(t,e),oj.set(e,t)),e}const VN=t=>oj.get(t);function ase(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=bc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(bc(o.result),c.oldVersion,c.newVersion,bc(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",()=>s())}).catch(()=>{}),l}const lse=["get","getKey","getAll","getAllKeys","count"],cse=["put","add","delete","clear"],FN=new Map;function xO(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(FN.get(e))return FN.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=cse.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||lse.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&c.done]))[0]};return FN.set(e,i),i}sse(t=>({...t,get:(e,n,r)=>xO(e,n)||t.get(e,n,r),has:(e,n)=>!!xO(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class use{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(dse(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function dse(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pT="@firebase/app",vO="0.7.33";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd=new Xre("@firebase/app"),hse="@firebase/app-compat",fse="@firebase/analytics-compat",mse="@firebase/analytics",pse="@firebase/app-check-compat",gse="@firebase/app-check",yse="@firebase/auth",xse="@firebase/auth-compat",vse="@firebase/database",bse="@firebase/database-compat",_se="@firebase/functions",wse="@firebase/functions-compat",kse="@firebase/installations",Nse="@firebase/installations-compat",Ese="@firebase/messaging",Sse="@firebase/messaging-compat",Tse="@firebase/performance",Cse="@firebase/performance-compat",Ise="@firebase/remote-config",jse="@firebase/remote-config-compat",Ase="@firebase/storage",Rse="@firebase/storage-compat",Pse="@firebase/firestore",Lse="@firebase/firestore-compat",Mse="firebase",Ose="9.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dse="[DEFAULT]",Vse={[pT]:"fire-core",[hse]:"fire-core-compat",[mse]:"fire-analytics",[fse]:"fire-analytics-compat",[gse]:"fire-app-check",[pse]:"fire-app-check-compat",[yse]:"fire-auth",[xse]:"fire-auth-compat",[vse]:"fire-rtdb",[bse]:"fire-rtdb-compat",[_se]:"fire-fn",[wse]:"fire-fn-compat",[kse]:"fire-iid",[Nse]:"fire-iid-compat",[Ese]:"fire-fcm",[Sse]:"fire-fcm-compat",[Tse]:"fire-perf",[Cse]:"fire-perf-compat",[Ise]:"fire-rc",[jse]:"fire-rc-compat",[Ase]:"fire-gcs",[Rse]:"fire-gcs-compat",[Pse]:"fire-fst",[Lse]:"fire-fst-compat","fire-js":"fire-js",[Mse]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yz=new Map,bO=new Map;function Fse(t,e){try{t.container.addComponent(e)}catch(n){yd.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Xa(t){const e=t.name;if(bO.has(e))return yd.debug(`There were multiple attempts to register component ${e}.`),!1;bO.set(e,t);for(const n of yz.values())Fse(n,t);return!0}function Mm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $se={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},bk=new mz("app","Firebase",$se);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d=Ose;function $0(t=Dse){const e=yz.get(t);if(!e)throw bk.create("no-app",{appName:t});return e}function fi(t,e,n){var r;let s=(r=Vse[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yd.warn(l.join(" "));return}Xa(new hT(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bse="firebase-heartbeat-database",zse=1,Ry="firebase-heartbeat-store";let $N=null;function xz(){return $N||($N=ase(Bse,zse,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ry)}}}).catch(t=>{throw bk.create("idb-open",{originalErrorMessage:t.message})})),$N}async function Use(t){var e;try{return(await xz()).transaction(Ry).objectStore(Ry).get(vz(t))}catch(n){if(n instanceof ij)yd.warn(n.message);else{const r=bk.create("idb-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message});yd.warn(r.message)}}}async function _O(t,e){var n;try{const s=(await xz()).transaction(Ry,"readwrite");return await s.objectStore(Ry).put(e,vz(t)),s.done}catch(r){if(r instanceof ij)yd.warn(r.message);else{const s=bk.create("idb-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message});yd.warn(s.message)}}}function vz(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wse=1024,Hse=30*24*60*60*1e3;class qse{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Kse(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=wO();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Hse}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=wO(),{heartbeatsToSend:n,unsentEntries:r}=Gse(this._heartbeatsCache.heartbeats),s=hz(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function wO(){return new Date().toISOString().substring(0,10)}function Gse(t,e=Wse){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),kO(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),kO(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Kse{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ure()?Wre().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Use(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return _O(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return _O(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function kO(t){return hz(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qse(t){Xa(new hT("platform-logger",e=>new use(e),"PRIVATE")),Xa(new hT("heartbeat",e=>new qse(e),"PRIVATE")),fi(pT,vO,t),fi(pT,vO,"esm2017"),fi("fire-js","")}Qse("");var NO={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bz=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Zse=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},_z={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;c||(v=64,o||(p=64)),r.push(n[h],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(bz(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Zse(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new Yse;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let Yse=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const Xse=function(t){const e=bz(t);return _z.encodeByteArray(e,!0)},EO=function(t){return Xse(t).replace(/\./g,"")},Jse=function(t){try{return _z.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eie(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tie=()=>eie().__FIREBASE_DEFAULTS__,nie=()=>{if(typeof process>"u"||typeof NO>"u")return;const t=NO.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rie=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Jse(t[1]);return e&&JSON.parse(e)},sie=()=>{try{return tie()||nie()||rie()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},iie=t=>{var e,n;return(n=(e=sie())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},oie=t=>{const e=iie(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aie(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[EO(JSON.stringify(n)),EO(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lie="FirebaseError";let wz=class kz extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=lie,Object.setPrototypeOf(this,kz.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cie.prototype.create)}},cie=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?uie(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new wz(s,l,r)}};function uie(t,e){return t.replace(die,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const die=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(t){return t&&t._delegate?t._delegate:t}let hie=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz="firebasestorage.googleapis.com",Ez="storageBucket",fie=2*60*1e3,mie=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends wz{constructor(e,n,r=0){super(BN(e),`Firebase Storage: ${n} (${BN(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,tr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return BN(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Jn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Jn||(Jn={}));function BN(t){return"storage/"+t}function aj(){const t="An unknown error occurred, please check the error payload for server response.";return new tr(Jn.UNKNOWN,t)}function pie(t){return new tr(Jn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function gie(t){return new tr(Jn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function yie(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new tr(Jn.UNAUTHENTICATED,t)}function xie(){return new tr(Jn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function vie(t){return new tr(Jn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function bie(){return new tr(Jn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _ie(){return new tr(Jn.CANCELED,"User canceled the upload/download.")}function wie(t){return new tr(Jn.INVALID_URL,"Invalid URL '"+t+"'.")}function kie(t){return new tr(Jn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Nie(){return new tr(Jn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ez+"' property when initializing the app?")}function Eie(){return new tr(Jn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Sie(){return new tr(Jn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Tie(t){return new tr(Jn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function gT(t){return new tr(Jn.INVALID_ARGUMENT,t)}function Sz(){return new tr(Jn.APP_DELETED,"The Firebase app was deleted.")}function Cie(t){return new tr(Jn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Fg(t,e){return new tr(Jn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Bp(t){throw new tr(Jn.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ci.makeFromUrl(e,n)}catch{return new ci(e,"")}if(r.path==="")return r;throw kie(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(T){T.path_=decodeURIComponent(T.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",v=new RegExp(`^https?://${m}/${h}/b/${s}/o${p}`,"i"),x={bucket:1,path:3},b=n===Nz?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",k=new RegExp(`^https?://${b}/${s}/${E}`,"i"),S=[{regex:l,indices:c,postModify:i},{regex:v,indices:x,postModify:d},{regex:k,indices:{bucket:1,path:2},postModify:d}];for(let T=0;T<S.length;T++){const P=S[T],j=P.regex.exec(e);if(j){const R=j[P.indices.bucket];let I=j[P.indices.path];I||(I=""),r=new ci(R,I),P.postModify(r);break}}if(r==null)throw wie(e);return r}}class Iie{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jie(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let d=!1;function h(...E){d||(d=!0,e.apply(null,E))}function m(E){s=setTimeout(()=>{s=null,t(v,c())},E)}function p(){i&&clearTimeout(i)}function v(E,...k){if(d){p();return}if(E){p(),h.call(null,E,...k);return}if(c()||o){p(),h.call(null,E,...k);return}r<64&&(r*=2);let S;l===1?(l=2,S=0):S=(r+Math.random())*1e3,m(S)}let x=!1;function b(E){x||(x=!0,p(),!d&&(s!==null?(E||(l=2),clearTimeout(s),m(0)):E||(l=1)))}return m(0),i=setTimeout(()=>{o=!0,b(!0)},n),b}function Aie(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rie(t){return t!==void 0}function Pie(t){return typeof t=="object"&&!Array.isArray(t)}function lj(t){return typeof t=="string"||t instanceof String}function SO(t){return cj()&&t instanceof Blob}function cj(){return typeof Blob<"u"}function TO(t,e,n,r){if(r<e)throw gT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw gT(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function Tz(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Hu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Hu||(Hu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lie(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mie{constructor(e,n,r,s,i,o,l,c,d,h,m,p=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new wv(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Hu.NO_ERROR,c=i.getStatus();if(!l||Lie(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Hu.ABORT;r(!1,new wv(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new wv(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());Rie(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=aj();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?Sz():_ie();o(c)}else{const c=bie();o(c)}};this.canceled_?n(!1,new wv(!1,null,!0)):this.backoffId_=jie(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Aie(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wv{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Oie(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Die(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Vie(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Fie(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function $ie(t,e,n,r,s,i,o=!0){const l=Tz(t.urlParams),c=t.url+l,d=Object.assign({},t.headers);return Vie(d,e),Oie(d,n),Die(d,i),Fie(d,r),new Mie(c,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bie(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function zie(...t){const e=Bie();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(cj())return new Blob(t);throw new tr(Jn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Uie(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wie(t){if(typeof atob>"u")throw Tie("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zN{constructor(e,n){this.data=e,this.contentType=n||null}}function Hie(t,e){switch(t){case Mo.RAW:return new zN(Cz(e));case Mo.BASE64:case Mo.BASE64URL:return new zN(Iz(t,e));case Mo.DATA_URL:return new zN(Gie(e),Kie(e))}throw aj()}function Cz(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function qie(t){let e;try{e=decodeURIComponent(t)}catch{throw Fg(Mo.DATA_URL,"Malformed data URL.")}return Cz(e)}function Iz(t,e){switch(t){case Mo.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Fg(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Mo.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Fg(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Wie(e)}catch(s){throw s.message.includes("polyfill")?s:Fg(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class jz{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Fg(Mo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=Qie(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Gie(t){const e=new jz(t);return e.base64?Iz(Mo.BASE64,e.rest):qie(e.rest)}function Kie(t){return new jz(t).contentType}function Qie(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n){let r=0,s="";SO(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(SO(this.data_)){const r=this.data_,s=Uie(r,e,n);return s===null?null:new Hl(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Hl(r,!0)}}static getBlob(...e){if(cj()){const n=e.map(r=>r instanceof Hl?r.data_:r);return new Hl(zie.apply(null,n))}else{const n=e.map(o=>lj(o)?Hie(Mo.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Hl(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Az(t){let e;try{e=JSON.parse(t)}catch{return null}return Pie(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zie(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Yie(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function Rz(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xie(t,e){return e}class ks{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||Xie}}let kv=null;function Jie(t){return!lj(t)||t.length<2?t:Rz(t)}function Pz(){if(kv)return kv;const t=[];t.push(new ks("bucket")),t.push(new ks("generation")),t.push(new ks("metageneration")),t.push(new ks("name","fullPath",!0));function e(i,o){return Jie(o)}const n=new ks("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new ks("size");return s.xform=r,t.push(s),t.push(new ks("timeCreated")),t.push(new ks("updated")),t.push(new ks("md5Hash",null,!0)),t.push(new ks("cacheControl",null,!0)),t.push(new ks("contentDisposition",null,!0)),t.push(new ks("contentEncoding",null,!0)),t.push(new ks("contentLanguage",null,!0)),t.push(new ks("contentType",null,!0)),t.push(new ks("metadata","customMetadata",!0)),kv=t,kv}function eoe(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new ci(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function toe(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return eoe(r,t),r}function Lz(t,e,n){const r=Az(e);return r===null?null:toe(t,r,n)}function noe(t,e,n,r){const s=Az(e);if(s===null||!lj(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,m=t.fullPath,p="/b/"+o(h)+"/o/"+o(m),v=uj(p,n,r),x=Tz({alt:"media",token:d});return v+x})[0]}function roe(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class Mz{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(t){if(!t)throw aj()}function soe(t,e){function n(r,s){const i=Lz(t,s,e);return Oz(i!==null),i}return n}function ioe(t,e){function n(r,s){const i=Lz(t,s,e);return Oz(i!==null),noe(i,s,t.host,t._protocol)}return n}function Dz(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=xie():s=yie():n.getStatus()===402?s=gie(t.bucket):n.getStatus()===403?s=vie(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function ooe(t){const e=Dz(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=pie(t.path)),i.serverResponse=s.serverResponse,i}return n}function aoe(t,e,n){const r=e.fullServerUrl(),s=uj(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new Mz(s,i,ioe(t,n),o);return l.errorHandler=ooe(e),l}function loe(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function coe(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=loe(null,e)),r}function uoe(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let T=0;T<2;T++)S=S+Math.random().toString().slice(2);return S}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const d=coe(e,r,s),h=roe(d,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+c+"--",v=Hl.getBlob(m,r,p);if(v===null)throw Eie();const x={name:d.fullPath},b=uj(i,t.host,t._protocol),E="POST",k=t.maxUploadRetryTime,_=new Mz(b,E,soe(t,n),k);return _.urlParams=x,_.headers=o,_.body=v.uploadData(),_.errorHandler=Dz(e),_}class doe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hu.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hu.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hu.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Bp("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Bp("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Bp("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Bp("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Bp("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class hoe extends doe{initXhr(){this.xhr_.responseType="text"}}function Vz(){return new hoe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,n){this._service=e,n instanceof ci?this._location=n:this._location=ci.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new xd(e,n)}get root(){const e=new ci(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Rz(this._location.path)}get storage(){return this._service}get parent(){const e=Zie(this._location.path);if(e===null)return null;const n=new ci(this._location.bucket,e);return new xd(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Cie(e)}}function foe(t,e,n){t._throwIfRoot("uploadBytes");const r=uoe(t.storage,t._location,Pz(),new Hl(e,!0),n);return t.storage.makeRequestWithTokens(r,Vz).then(s=>({metadata:s,ref:t}))}function moe(t){t._throwIfRoot("getDownloadURL");const e=aoe(t.storage,t._location,Pz());return t.storage.makeRequestWithTokens(e,Vz).then(n=>{if(n===null)throw Sie();return n})}function poe(t,e){const n=Yie(t._location.path,e),r=new ci(t._location.bucket,n);return new xd(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function goe(t){return/^[A-Za-z]+:\/\//.test(t)}function yoe(t,e){return new xd(t,e)}function Fz(t,e){if(t instanceof dj){const n=t;if(n._bucket==null)throw Nie();const r=new xd(n,n._bucket);return e!=null?Fz(r,e):r}else return e!==void 0?poe(t,e):t}function xoe(t,e){if(e&&goe(e)){if(t instanceof dj)return yoe(t,e);throw gT("To use ref(service, url), the first argument must be a Storage instance.")}else return Fz(t,e)}function CO(t,e){const n=e==null?void 0:e[Ez];return n==null?null:ci.makeFromBucketSpec(n,t)}function voe(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:aie(s,t.app.options.projectId))}class dj{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=Nz,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=fie,this._maxUploadRetryTime=mie,this._requests=new Set,s!=null?this._bucket=ci.makeFromBucketSpec(s,this._host):this._bucket=CO(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ci.makeFromBucketSpec(this._url,e):this._bucket=CO(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){TO("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){TO("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xd(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new Iie(Sz());{const o=$ie(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const IO="@firebase/storage",jO="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z="storage";function Bz(t,e,n){return t=_k(t),foe(t,e,n)}function zz(t){return t=_k(t),moe(t)}function Uz(t,e){return t=_k(t),xoe(t,e)}function boe(t=$0(),e){t=_k(t);const r=Mm(t,$z).getImmediate({identifier:e}),s=oie("storage");return s&&_oe(r,...s),r}function _oe(t,e,n,r={}){voe(t,e,n,r)}function woe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new dj(n,r,s,e,$d)}function koe(){Xa(new hie($z,woe,"PUBLIC").setMultipleInstances(!0)),fi(IO,jO,""),fi(IO,jO,"esm2017")}koe();var AO={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne=function(t,e){if(!t)throw Om(e)},Om=function(t){return new Error("Firebase Database ("+Wz.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hz=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Noe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},hj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;c||(v=64,o||(p=64)),r.push(n[h],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Hz(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Noe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new Eoe;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let Eoe=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const qz=function(t){const e=Hz(t);return hj.encodeByteArray(e,!0)},RO=function(t){return qz(t).replace(/\./g,"")},yT=function(t){try{return hj.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Soe(t){return Gz(void 0,t)}function Gz(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Toe(n)||(t[n]=Gz(t[n],e[n]));return t}function Toe(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Coe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ioe=()=>Coe().__FIREBASE_DEFAULTS__,joe=()=>{if(typeof process>"u"||typeof AO>"u")return;const t=AO.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Aoe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&yT(t[1]);return e&&JSON.parse(e)},Roe=()=>{try{return Ioe()||joe()||Aoe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Poe=t=>{var e,n;return(n=(e=Roe())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Loe=t=>{const e=Poe(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Moe(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[RO(JSON.stringify(n)),RO(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ooe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Kz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ooe())}function Doe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Voe(){return Wz.NODE_ADMIN===!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(t){return JSON.parse(t)}function wr(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=Py(yT(i[0])||""),n=Py(yT(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},Foe=function(t){const e=Qz(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},$oe=function(t){const e=Qz(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Jf(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function xT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function C_(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Boe(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zoe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)r[m]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let m=0;m<16;m++)r[m]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let m=16;m<80;m++){const p=r[m-3]^r[m-8]^r[m-14]^r[m-16];r[m]=(p<<1|p>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4],d,h;for(let m=0;m<80;m++){m<40?m<20?(d=l^i&(o^l),h=1518500249):(d=i^o^l,h=1859775393):m<60?(d=i&o|l&(i|o),h=2400959708):(d=i^o^l,h=3395469782);const p=(s<<5|s>>>27)+d+c+h+r[m]&4294967295;c=l,l=o,o=(i<<30|i>>>2)&4294967295,i=s,s=p}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function em(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uoe=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,Ne(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},wk=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(t){return t&&t._delegate?t._delegate:t}let Woe=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(yn||(yn={}));const Hoe={debug:yn.DEBUG,verbose:yn.VERBOSE,info:yn.INFO,warn:yn.WARN,error:yn.ERROR,silent:yn.SILENT},qoe=yn.INFO,Goe={[yn.DEBUG]:"log",[yn.VERBOSE]:"log",[yn.INFO]:"info",[yn.WARN]:"warn",[yn.ERROR]:"error"},Koe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Goe[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let Qoe=class{constructor(e){this.name=e,this._logLevel=qoe,this._logHandler=Koe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Hoe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yn.DEBUG,...e),this._logHandler(this,yn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yn.VERBOSE,...e),this._logHandler(this,yn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yn.INFO,...e),this._logHandler(this,yn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yn.WARN,...e),this._logHandler(this,yn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yn.ERROR,...e),this._logHandler(this,yn.ERROR,...e)}};var PO={};const LO="@firebase/database",MO="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zz="";function Zoe(t){Zz=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yoe{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),wr(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Py(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xoe{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return oa(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yz=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Yoe(e)}}catch{}return new Xoe},Lu=Yz("localStorage"),Joe=Yz("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f=new Qoe("@firebase/database"),eae=function(){let t=1;return function(){return t++}}(),Xz=function(t){const e=Uoe(t),n=new zoe;n.update(e);const r=n.digest();return hj.encodeByteArray(r)},B0=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=B0.apply(null,r):typeof r=="object"?e+=wr(r):e+=r,e+=" "}return e};let $g=null,OO=!0;const tae=function(t,e){Ne(!0,"Can't turn on custom loggers persistently."),_f.logLevel=yn.VERBOSE,$g=_f.log.bind(_f)},Dr=function(...t){if(OO===!0&&(OO=!1,$g===null&&Joe.get("logging_enabled")===!0&&tae()),$g){const e=B0.apply(null,t);$g(e)}},z0=function(t){return function(...e){Dr(t,...e)}},vT=function(...t){const e="FIREBASE INTERNAL ERROR: "+B0(...t);_f.error(e)},Ja=function(...t){const e=`FIREBASE FATAL ERROR: ${B0(...t)}`;throw _f.error(e),new Error(e)},As=function(...t){const e="FIREBASE WARNING: "+B0(...t);_f.warn(e)},nae=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&As("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},kk=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},rae=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},vd="[MIN_NAME]",Ac="[MAX_NAME]",Bd=function(t,e){if(t===e)return 0;if(t===vd||e===Ac)return-1;if(e===vd||t===Ac)return 1;{const n=DO(t),r=DO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},sae=function(t,e){return t===e?0:t<e?-1:1},zp=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+wr(e))},fj=function(t){if(typeof t!="object"||t===null)return wr(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=wr(e[r]),n+=":",n+=fj(t[e[r]]);return n+="}",n},Jz=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function Fr(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const eU=function(t){Ne(!kk(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,l,c;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=l+r,o=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const d=[];for(c=n;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(i%2?1:0),i=Math.floor(i/2);d.push(s?1:0),d.reverse();const h=d.join("");let m="";for(c=0;c<64;c+=8){let p=parseInt(h.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),m=m+p}return m.toLowerCase()},iae=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},oae=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function aae(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const lae=new RegExp("^-?(0*)\\d{1,10}$"),cae=-2147483648,uae=2147483647,DO=function(t){if(lae.test(t)){const e=Number(t);if(e>=cae&&e<=uae)return e}return null},Dm=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw As("Exception was thrown by user callback.",n),e},Math.floor(0))}},dae=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Bg=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hae{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){As(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fae{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Dr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',As(e)}}class yb{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}yb.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj="5",tU="v",nU="s",rU="r",sU="f",iU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,oU="ls",aU="p",bT="ac",lU="websocket",cU="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e,n,r,s,i=!1,o="",l=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Lu.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Lu.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function mae(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function dU(t,e,n){Ne(typeof e=="string","typeof type must == string"),Ne(typeof n=="object","typeof params must == object");let r;if(e===lU)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===cU)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);mae(t)&&(n.ns=t.namespace);const s=[];return Fr(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pae{constructor(){this.counters_={}}incrementCounter(e,n=1){oa(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Soe(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN={},WN={};function pj(t){const e=t.toString();return UN[e]||(UN[e]=new pae),UN[e]}function gae(t,e){const n=t.toString();return WN[n]||(WN[n]=e()),WN[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yae{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&Dm(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VO="start",xae="close",vae="pLPCommand",bae="pRTLPCB",hU="id",fU="pw",mU="ser",_ae="cb",wae="seg",kae="ts",Nae="d",Eae="dframe",pU=1870,gU=30,Sae=pU-gU,Tae=25e3,Cae=3e4;class tf{constructor(e,n,r,s,i,o,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=z0(e),this.stats_=pj(n),this.urlFn=c=>(this.appCheckToken&&(c[bT]=this.appCheckToken),dU(n,cU,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new yae(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Cae)),rae(()=>{if(this.isClosed_)return;this.scriptTagHolder=new gj((...i)=>{const[o,l,c,d,h]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===VO)this.id=l,this.password=c;else if(o===xae)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,l]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[VO]="t",r[mU]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[_ae]=this.scriptTagHolder.uniqueCallbackIdentifier),r[tU]=mj,this.transportSessionId&&(r[nU]=this.transportSessionId),this.lastSessionId&&(r[oU]=this.lastSessionId),this.applicationId&&(r[aU]=this.applicationId),this.appCheckToken&&(r[bT]=this.appCheckToken),typeof location<"u"&&location.hostname&&iU.test(location.hostname)&&(r[rU]=sU);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){tf.forceAllow_=!0}static forceDisallow(){tf.forceDisallow_=!0}static isAvailable(){return tf.forceAllow_?!0:!tf.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!iae()&&!oae()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=wr(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=qz(n),s=Jz(r,Sae);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[Eae]="t",r[hU]=e,r[fU]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=wr(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class gj{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=eae(),window[vae+this.uniqueCallbackIdentifier]=e,window[bae+this.uniqueCallbackIdentifier]=n,this.myIFrame=gj.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){Dr("frame writing exception"),l.stack&&Dr(l.stack),Dr(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Dr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[hU]=this.myID,e[fU]=this.myPW,e[mU]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+gU+r.length<=pU;){const o=this.pendingSegs.shift();r=r+"&"+wae+s+"="+o.seg+"&"+kae+s+"="+o.ts+"&"+Nae+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(Tae)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Dr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iae=16384,jae=45e3;let I_=null;typeof MozWebSocket<"u"?I_=MozWebSocket:typeof WebSocket<"u"&&(I_=WebSocket);class ao{constructor(e,n,r,s,i,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=z0(this.connId),this.stats_=pj(n),this.connURL=ao.connectionURL_(n,o,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[tU]=mj,typeof location<"u"&&location.hostname&&iU.test(location.hostname)&&(o[rU]=sU),n&&(o[nU]=n),r&&(o[oU]=r),s&&(o[bT]=s),i&&(o[aU]=i),dU(e,lU,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Lu.set("previous_websocket_failure",!0);try{let r;Voe(),this.mySock=new I_(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){ao.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&I_!==null&&!ao.forceDisallow_}static previouslyFailed(){return Lu.isInMemoryStorage||Lu.get("previous_websocket_failure")===!0}markConnectionHealthy(){Lu.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Py(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Ne(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=wr(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Jz(n,Iae);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(jae))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ao.responsesRequiredToBeHealthy=2;ao.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[tf,ao]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=ao&&ao.isAvailable();let r=n&&!ao.previouslyFailed();if(e.webSocketOnly&&(n||As("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ao];else{const s=this.transports_=[];for(const i of Ly.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Ly.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ly.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aae=6e4,Rae=5e3,Pae=10*1024,Lae=100*1024,HN="t",FO="d",Mae="s",$O="r",Oae="e",BO="o",zO="a",UO="n",WO="p",Dae="h";class Vae{constructor(e,n,r,s,i,o,l,c,d,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=z0("c:"+this.id+":"),this.transportManager_=new Ly(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Bg(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Lae?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Pae?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(HN in e){const n=e[HN];n===zO?this.upgradeIfSecondaryHealthy_():n===$O?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===BO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=zp("t",e),r=zp("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:WO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:zO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:UO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=zp("t",e),r=zp("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=zp(HN,e);if(FO in e){const r=e[FO];if(n===Dae){const s=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===UO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Mae?this.onConnectionShutdown_(r):n===$O?this.onReset_(r):n===Oae?vT("Server Error: "+r):n===BO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):vT("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),mj!==r&&As("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Bg(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Aae))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bg(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Rae))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:WO,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Lu.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e){this.allowedEvents_=e,this.listeners_={},Ne(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){Ne(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_ extends xU{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Kz()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new j_}getInitialEvent(e){return Ne(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO=32,qO=768;class Jt{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Gt(){return new Jt("")}function St(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Rc(t){return t.pieces_.length-t.pieceNum_}function mn(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Jt(t.pieces_,e)}function yj(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Fae(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function My(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function vU(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Jt(e,0)}function $n(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Jt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Jt(n,0)}function Tt(t){return t.pieceNum_>=t.pieces_.length}function Ss(t,e){const n=St(t),r=St(e);if(n===null)return e;if(n===r)return Ss(mn(t),mn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function $ae(t,e){const n=My(t,0),r=My(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=Bd(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function xj(t,e){if(Rc(t)!==Rc(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function $i(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Rc(t)>Rc(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class Bae{constructor(e,n){this.errorPrefix_=n,this.parts_=My(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=wk(this.parts_[r]);bU(this)}}function zae(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=wk(e),bU(t)}function Uae(t){const e=t.parts_.pop();t.byteLength_-=wk(e),t.parts_.length>0&&(t.byteLength_-=1)}function bU(t){if(t.byteLength_>qO)throw new Error(t.errorPrefix_+"has a key path longer than "+qO+" bytes ("+t.byteLength_+").");if(t.parts_.length>HO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+HO+") or object contains a cycle "+ku(t))}function ku(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj extends xU{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new vj}getInitialEvent(e){return Ne(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=1e3,Wae=60*5*1e3,GO=30*1e3,Hae=1.3,qae=3e4,Gae="server_kill",KO=3;class $a extends yU{constructor(e,n,r,s,i,o,l,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=$a.nextPersistentConnectionId_++,this.log_=z0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Up,this.maxReconnectDelay_=Wae,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");vj.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&j_.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(wr(i)),Ne(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Ca,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Ne(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ne(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,l=>{const c=l.d,d=l.s;$a.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&oa(e,"w")){const r=Jf(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();As(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||$oe(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=GO)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Foe(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),Ne(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+wr(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):vT("Unrecognized action received from server: "+wr(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Ne(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Up,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Up,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>qae&&(this.reconnectDelay_=Up),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Hae)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+$a.nextConnectionId_++,i=this.lastSessionId;let o=!1,l=null;const c=function(){l?l.close():(o=!0,r())},d=function(m){Ne(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(m)};this.realtime_={close:c,sendRequest:d};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,p]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?Dr("getToken() completed but was canceled"):(Dr("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=p&&p.token,l=new Vae(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,v=>{As(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(Gae)},i))}catch(m){this.log_("Failed to get token: "+m),o||(this.repoInfo_.nodeAdmin&&As(m),c())}}}interrupt(e){Dr("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Dr("Resuming connection for reason: "+e),delete this.interruptReasons_[e],xT(this.interruptReasons_)&&(this.reconnectDelay_=Up,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>fj(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Jt(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){Dr("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=KO&&(this.reconnectDelay_=GO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Dr("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=KO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Zz.replace(/\./g,"-")]=1,Kz()?e["framework.cordova"]=1:Doe()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=j_.getInstance().currentlyOnline();return xT(this.interruptReasons_)&&e}}$a.nextPersistentConnectionId_=0;$a.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new jt(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new jt(vd,e),s=new jt(vd,n);return this.compare(r,s)!==0}minPost(){return jt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nv;class _U extends Nk{static get __EMPTY_NODE(){return Nv}static set __EMPTY_NODE(e){Nv=e}compare(e,n){return Bd(e.name,n.name)}isDefinedOn(e){throw Om("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return jt.MIN}maxPost(){return new jt(Ac,Nv)}makePost(e,n){return Ne(typeof e=="string","KeyIndex indexValue must always be a string."),new jt(e,Nv)}toString(){return".key"}}const qu=new _U;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Or{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Or.RED,this.left=s??Ws.EMPTY_NODE,this.right=i??Ws.EMPTY_NODE}copy(e,n,r,s,i){return new Or(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ws.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Ws.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Or.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Or.RED=!0;Or.BLACK=!1;class Kae{copy(e,n,r,s,i){return this}insert(e,n,r){return new Or(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ws{constructor(e,n=Ws.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Ws(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Or.BLACK,null,null))}remove(e){return new Ws(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Or.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ev(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Ev(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Ev(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Ev(this.root_,null,this.comparator_,!0,e)}}Ws.EMPTY_NODE=new Kae;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qae(t,e){return Bd(t.name,e.name)}function bj(t,e){return Bd(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _T;function Zae(t){_T=t}const wU=function(t){return typeof t=="number"?"number:"+eU(t):"string:"+t},kU=function(t){if(t.isLeafNode()){const e=t.val();Ne(typeof e=="string"||typeof e=="number"||typeof e=="object"&&oa(e,".sv"),"Priority must be a string or number.")}else Ne(t===_T||t.isEmpty(),"priority of unexpected type.");Ne(t===_T||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QO;class Ar{constructor(e,n=Ar.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Ne(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),kU(this.priorityNode_)}static set __childrenNodeConstructor(e){QO=e}static get __childrenNodeConstructor(){return QO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ar(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Ar.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Tt(e)?this:St(e)===".priority"?this.priorityNode_:Ar.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Ar.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=St(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(Ne(r!==".priority"||Rc(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Ar.__childrenNodeConstructor.EMPTY_NODE.updateChild(mn(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+wU(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=eU(this.value_):e+=this.value_,this.lazyHash_=Xz(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ar.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ar.__childrenNodeConstructor?-1:(Ne(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Ar.VALUE_TYPE_ORDER.indexOf(n),i=Ar.VALUE_TYPE_ORDER.indexOf(r);return Ne(s>=0,"Unknown leaf type: "+n),Ne(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Ar.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NU,EU;function Yae(t){NU=t}function Xae(t){EU=t}class Jae extends Nk{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?Bd(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return jt.MIN}maxPost(){return new jt(Ac,new Ar("[PRIORITY-POST]",EU))}makePost(e,n){const r=NU(e);return new jt(n,new Ar("[PRIORITY-POST]",r))}toString(){return".priority"}}const Mn=new Jae;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ele=Math.log(2);class tle{constructor(e){const n=i=>parseInt(Math.log(i)/ele,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const A_=function(t,e,n,r){t.sort(e);const s=function(c,d){const h=d-c;let m,p;if(h===0)return null;if(h===1)return m=t[c],p=n?n(m):m,new Or(p,m.node,Or.BLACK,null,null);{const v=parseInt(h/2,10)+c,x=s(c,v),b=s(v+1,d);return m=t[v],p=n?n(m):m,new Or(p,m.node,Or.BLACK,x,b)}},i=function(c){let d=null,h=null,m=t.length;const p=function(x,b){const E=m-x,k=m;m-=x;const _=s(E+1,k),S=t[E],T=n?n(S):S;v(new Or(T,S.node,b,null,_))},v=function(x){d?(d.left=x,d=x):(h=x,d=x)};for(let x=0;x<c.count;++x){const b=c.nextBitIsOne(),E=Math.pow(2,c.count-(x+1));b?p(E,Or.BLACK):(p(E,Or.BLACK),p(E,Or.RED))}return h},o=new tle(t.length),l=i(o);return new Ws(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qN;const Th={};class Ma{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return Ne(Th&&Mn,"ChildrenNode.ts has not been loaded"),qN=qN||new Ma({".priority":Th},{".priority":Mn}),qN}get(e){const n=Jf(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ws?n:null}hasIndex(e){return oa(this.indexSet_,e.toString())}addIndex(e,n){Ne(e!==qu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(jt.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let l;s?l=A_(r,e.getCompare()):l=Th;const c=e.toString(),d=Object.assign({},this.indexSet_);d[c]=e;const h=Object.assign({},this.indexes_);return h[c]=l,new Ma(h,d)}addToIndexes(e,n){const r=C_(this.indexes_,(s,i)=>{const o=Jf(this.indexSet_,i);if(Ne(o,"Missing index implementation for "+i),s===Th)if(o.isDefinedOn(e.node)){const l=[],c=n.getIterator(jt.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&l.push(d),d=c.getNext();return l.push(e),A_(l,o.getCompare())}else return Th;else{const l=n.get(e.name);let c=s;return l&&(c=c.remove(new jt(e.name,l))),c.insert(e,e.node)}});return new Ma(r,this.indexSet_)}removeFromIndexes(e,n){const r=C_(this.indexes_,s=>{if(s===Th)return s;{const i=n.get(e.name);return i?s.remove(new jt(e.name,i)):s}});return new Ma(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wp;class ot{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&kU(this.priorityNode_),this.children_.isEmpty()&&Ne(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Wp||(Wp=new ot(new Ws(bj),null,Ma.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Wp}updatePriority(e){return this.children_.isEmpty()?this:new ot(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Wp:n}}getChild(e){const n=St(e);return n===null?this:this.getImmediateChild(n).getChild(mn(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(Ne(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new jt(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Wp:this.priorityNode_;return new ot(s,o,i)}}updateChild(e,n){const r=St(e);if(r===null)return n;{Ne(St(e)!==".priority"||Rc(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(mn(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(Mn,(o,l)=>{n[o]=l.val(e),r++,i&&ot.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const l in n)o[l]=n[l];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+wU(this.getPriority().val())+":"),this.forEachChild(Mn,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":Xz(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new jt(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new jt(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new jt(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,jt.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,jt.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===U0?-1:0}withIndex(e){if(e===qu||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ot(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===qu||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Mn),s=n.getIterator(Mn);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===qu?null:this.indexMap_.get(e.toString())}}ot.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class nle extends ot{constructor(){super(new Ws(bj),ot.EMPTY_NODE,Ma.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ot.EMPTY_NODE}isEmpty(){return!1}}const U0=new nle;Object.defineProperties(jt,{MIN:{value:new jt(vd,ot.EMPTY_NODE)},MAX:{value:new jt(Ac,U0)}});_U.__EMPTY_NODE=ot.EMPTY_NODE;Ar.__childrenNodeConstructor=ot;Zae(U0);Xae(U0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rle=!0;function Xn(t,e=null){if(t===null)return ot.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),Ne(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Ar(n,Xn(e))}if(!(t instanceof Array)&&rle){const n=[];let r=!1;if(Fr(t,(o,l)=>{if(o.substring(0,1)!=="."){const c=Xn(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new jt(o,c)))}}),n.length===0)return ot.EMPTY_NODE;const i=A_(n,Qae,o=>o.name,bj);if(r){const o=A_(n,Mn.getCompare());return new ot(i,Xn(e),new Ma({".priority":o},{".priority":Mn}))}else return new ot(i,Xn(e),Ma.Default)}else{let n=ot.EMPTY_NODE;return Fr(t,(r,s)=>{if(oa(t,r)&&r.substring(0,1)!=="."){const i=Xn(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(Xn(e))}}Yae(Xn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j extends Nk{constructor(e){super(),this.indexPath_=e,Ne(!Tt(e)&&St(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?Bd(e.name,n.name):i}makePost(e,n){const r=Xn(e),s=ot.EMPTY_NODE.updateChild(this.indexPath_,r);return new jt(n,s)}maxPost(){const e=ot.EMPTY_NODE.updateChild(this.indexPath_,U0);return new jt(Ac,e)}toString(){return My(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sle extends Nk{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Bd(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return jt.MIN}maxPost(){return jt.MAX}makePost(e,n){const r=Xn(e);return new jt(n,r)}toString(){return".value"}}const SU=new sle;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(t){return{type:"value",snapshotNode:t}}function tm(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Oy(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Dy(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function ile(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){Ne(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(r.getChild(s))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Oy(n,l)):Ne(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(tm(n,r)):o.trackChildChange(Dy(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Mn,(s,i)=>{n.hasChild(s)||r.trackChildChange(Oy(s,i))}),n.isLeafNode()||n.forEachChild(Mn,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Dy(s,i,o))}else r.trackChildChange(tm(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ot.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e){this.indexedFilter_=new wj(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Vy.getStartPost_(e),this.endPost_=Vy.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new jt(n,r))||(r=ot.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ot.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(ot.EMPTY_NODE);const i=this;return n.forEachChild(Mn,(o,l)=>{i.matches(new jt(o,l))||(s=s.updateImmediateChild(o,ot.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ole{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Vy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new jt(n,r))||(r=ot.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=ot.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=ot.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const l=i.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(ot.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const l=i.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:s=s.updateImmediateChild(l.name,ot.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const m=this.index_.getCompare();o=(p,v)=>m(v,p)}else o=this.index_.getCompare();const l=e;Ne(l.numChildren()===this.limit_,"");const c=new jt(n,r),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(l.hasChild(n)){const m=l.getImmediateChild(n);let p=s.getChildAfterChild(this.index_,d,this.reverse_);for(;p!=null&&(p.name===n||l.hasChild(p.name));)p=s.getChildAfterChild(this.index_,p,this.reverse_);const v=p==null?1:o(p,c);if(h&&!r.isEmpty()&&v>=0)return i!=null&&i.trackChildChange(Dy(n,r,m)),l.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(Oy(n,m));const b=l.updateImmediateChild(n,ot.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(i!=null&&i.trackChildChange(tm(p.name,p.node)),b.updateImmediateChild(p.name,p.node)):b}}else return r.isEmpty()?e:h&&o(d,c)>=0?(i!=null&&(i.trackChildChange(Oy(d.name,d.node)),i.trackChildChange(tm(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(d.name,ot.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Mn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Ne(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Ne(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:vd}hasEnd(){return this.endSet_}getIndexEndValue(){return Ne(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Ne(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ac}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Ne(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Mn}copy(){const e=new kj;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ale(t){return t.loadsAllData()?new wj(t.getIndex()):t.hasLimit()?new ole(t):new Vy(t)}function lle(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function cle(t,e){const n=t.copy();return n.index_=e,n}function ZO(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Mn?n="$priority":t.index_===SU?n="$value":t.index_===qu?n="$key":(Ne(t.index_ instanceof _j,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=wr(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=wr(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+wr(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=wr(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+wr(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function YO(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Mn&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_ extends yU{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=z0("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(Ne(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=R_.getListenId_(e,r),l={};this.listens_[o]=l;const c=ZO(e._queryParams);this.restRequest_(i+".json",c,(d,h)=>{let m=h;if(d===404&&(m=null,d=null),d===null&&this.onDataUpdate_(i,m,!1,r),Jf(this.listens_,o)===l){let p;d?d===401?p="permission_denied":p="rest_error:"+d:p="ok",s(p,null)}})}unlisten(e,n){const r=R_.getListenId_(e,n);delete this.listens_[r]}get(e){const n=ZO(e._queryParams),r=e._path.toString(),s=new Ca;return this.restRequest_(r+".json",n,(i,o)=>{let l=o;i===404&&(l=null,i=null),i===null?(this.onDataUpdate_(r,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Boe(n);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=Py(l.responseText)}catch{As("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&As("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ule{constructor(){this.rootNode_=ot.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(){return{value:null,children:new Map}}function Vm(t,e,n){if(Tt(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=St(e);t.children.has(r)||t.children.set(r,P_());const s=t.children.get(r);e=mn(e),Vm(s,e,n)}}function wT(t,e){if(Tt(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Mn,(r,s)=>{Vm(t,new Jt(r),s)}),wT(t,e)}}else if(t.children.size>0){const n=St(e);return e=mn(e),t.children.has(n)&&wT(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function kT(t,e,n){t.value!==null?n(e,t.value):dle(t,(r,s)=>{const i=new Jt(e.toString()+"/"+r);kT(s,i,n)})}function dle(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hle{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Fr(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=10*1e3,fle=30*1e3,mle=5*60*1e3;class ple{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new hle(e);const r=XO+(fle-XO)*Math.random();Bg(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Fr(e,(s,i)=>{i>0&&oa(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),Bg(this.reportStats_.bind(this),Math.floor(Math.random()*2*mle))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fo;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(fo||(fo={}));function Nj(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ej(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Sj(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=fo.ACK_USER_WRITE,this.source=Nj()}operationForChild(e){if(Tt(this.path)){if(this.affectedTree.value!=null)return Ne(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Jt(e));return new L_(Gt(),n,this.revert)}}else return Ne(St(this.path)===e,"operationForChild called for unrelated child."),new L_(mn(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,n){this.source=e,this.path=n,this.type=fo.LISTEN_COMPLETE}operationForChild(e){return Tt(this.path)?new Fy(this.source,Gt()):new Fy(this.source,mn(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=fo.OVERWRITE}operationForChild(e){return Tt(this.path)?new bd(this.source,Gt(),this.snap.getImmediateChild(e)):new bd(this.source,mn(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=fo.MERGE}operationForChild(e){if(Tt(this.path)){const n=this.children.subtree(new Jt(e));return n.isEmpty()?null:n.value?new bd(this.source,Gt(),n.value):new nm(this.source,Gt(),n)}else return Ne(St(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new nm(this.source,mn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Tt(e))return this.isFullyInitialized()&&!this.filtered_;const n=St(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gle{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function yle(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(ile(o.childName,o.snapshotNode))}),Hp(t,s,"child_removed",e,r,n),Hp(t,s,"child_added",e,r,n),Hp(t,s,"child_moved",i,r,n),Hp(t,s,"child_changed",e,r,n),Hp(t,s,"value",e,r,n),s}function Hp(t,e,n,r,s,i){const o=r.filter(l=>l.type===n);o.sort((l,c)=>vle(t,l,c)),o.forEach(l=>{const c=xle(t,l,i);s.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(c,t.query_))})})}function xle(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function vle(t,e,n){if(e.childName==null||n.childName==null)throw Om("Should only compare child_ events.");const r=new jt(e.childName,e.snapshotNode),s=new jt(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(t,e){return{eventCache:t,serverCache:e}}function zg(t,e,n,r){return Ek(new Pc(e,n,r),t.serverCache)}function CU(t,e,n,r){return Ek(t.eventCache,new Pc(e,n,r))}function M_(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function _d(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GN;const ble=()=>(GN||(GN=new Ws(sae)),GN);class gn{constructor(e,n=ble()){this.value=e,this.children=n}static fromObject(e){let n=new gn(null);return Fr(e,(r,s)=>{n=n.set(new Jt(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Gt(),value:this.value};if(Tt(e))return null;{const r=St(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(mn(e),n);return i!=null?{path:$n(new Jt(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Tt(e))return this;{const n=St(e),r=this.children.get(n);return r!==null?r.subtree(mn(e)):new gn(null)}}set(e,n){if(Tt(e))return new gn(n,this.children);{const r=St(e),i=(this.children.get(r)||new gn(null)).set(mn(e),n),o=this.children.insert(r,i);return new gn(this.value,o)}}remove(e){if(Tt(e))return this.children.isEmpty()?new gn(null):new gn(null,this.children);{const n=St(e),r=this.children.get(n);if(r){const s=r.remove(mn(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new gn(null):new gn(this.value,i)}else return this}}get(e){if(Tt(e))return this.value;{const n=St(e),r=this.children.get(n);return r?r.get(mn(e)):null}}setTree(e,n){if(Tt(e))return n;{const r=St(e),i=(this.children.get(r)||new gn(null)).setTree(mn(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new gn(this.value,o)}}fold(e){return this.fold_(Gt(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_($n(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Gt(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(Tt(e))return null;{const i=St(e),o=this.children.get(i);return o?o.findOnPath_(mn(e),$n(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Gt(),n)}foreachOnPath_(e,n,r){if(Tt(e))return this;{this.value&&r(n,this.value);const s=St(e),i=this.children.get(s);return i?i.foreachOnPath_(mn(e),$n(n,s),r):new gn(null)}}foreach(e){this.foreach_(Gt(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_($n(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this.writeTree_=e}static empty(){return new xo(new gn(null))}}function Ug(t,e,n){if(Tt(e))return new xo(new gn(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=Ss(s,e);return i=i.updateChild(o,n),new xo(t.writeTree_.set(s,i))}else{const s=new gn(n),i=t.writeTree_.setTree(e,s);return new xo(i)}}}function NT(t,e,n){let r=t;return Fr(n,(s,i)=>{r=Ug(r,$n(e,s),i)}),r}function JO(t,e){if(Tt(e))return xo.empty();{const n=t.writeTree_.setTree(e,new gn(null));return new xo(n)}}function ET(t,e){return zd(t,e)!=null}function zd(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ss(n.path,e)):null}function eD(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Mn,(r,s)=>{e.push(new jt(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new jt(r,s.value))}),e}function _c(t,e){if(Tt(e))return t;{const n=zd(t,e);return n!=null?new xo(new gn(n)):new xo(t.writeTree_.subtree(e))}}function ST(t){return t.writeTree_.isEmpty()}function rm(t,e){return IU(Gt(),t.writeTree_,e)}function IU(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(Ne(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=IU($n(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild($n(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sk(t,e){return PU(e,t)}function _le(t,e,n,r,s){Ne(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Ug(t.visibleWrites,e,n)),t.lastWriteId=r}function wle(t,e,n,r){Ne(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=NT(t.visibleWrites,e,n),t.lastWriteId=r}function kle(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function Nle(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);Ne(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const l=t.allWrites[o];l.visible&&(o>=n&&Ele(l,r.path)?s=!1:$i(r.path,l.path)&&(i=!0)),o--}if(s){if(i)return Sle(t),!0;if(r.snap)t.visibleWrites=JO(t.visibleWrites,r.path);else{const l=r.children;Fr(l,c=>{t.visibleWrites=JO(t.visibleWrites,$n(r.path,c))})}return!0}else return!1}function Ele(t,e){if(t.snap)return $i(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&$i($n(t.path,n),e))return!0;return!1}function Sle(t){t.visibleWrites=jU(t.allWrites,Tle,Gt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Tle(t){return t.visible}function jU(t,e,n){let r=xo.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let l;if(i.snap)$i(n,o)?(l=Ss(n,o),r=Ug(r,l,i.snap)):$i(o,n)&&(l=Ss(o,n),r=Ug(r,Gt(),i.snap.getChild(l)));else if(i.children){if($i(n,o))l=Ss(n,o),r=NT(r,l,i.children);else if($i(o,n))if(l=Ss(o,n),Tt(l))r=NT(r,Gt(),i.children);else{const c=Jf(i.children,St(l));if(c){const d=c.getChild(mn(l));r=Ug(r,Gt(),d)}}}else throw Om("WriteRecord should have .snap or .children")}}return r}function AU(t,e,n,r,s){if(!r&&!s){const i=zd(t.visibleWrites,e);if(i!=null)return i;{const o=_c(t.visibleWrites,e);if(ST(o))return n;if(n==null&&!ET(o,Gt()))return null;{const l=n||ot.EMPTY_NODE;return rm(o,l)}}}else{const i=_c(t.visibleWrites,e);if(!s&&ST(i))return n;if(!s&&n==null&&!ET(i,Gt()))return null;{const o=function(d){return(d.visible||s)&&(!r||!~r.indexOf(d.writeId))&&($i(d.path,e)||$i(e,d.path))},l=jU(t.allWrites,o,e),c=n||ot.EMPTY_NODE;return rm(l,c)}}}function Cle(t,e,n){let r=ot.EMPTY_NODE;const s=zd(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Mn,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=_c(t.visibleWrites,e);return n.forEachChild(Mn,(o,l)=>{const c=rm(_c(i,new Jt(o)),l);r=r.updateImmediateChild(o,c)}),eD(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=_c(t.visibleWrites,e);return eD(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function Ile(t,e,n,r,s){Ne(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=$n(e,n);if(ET(t.visibleWrites,i))return null;{const o=_c(t.visibleWrites,i);return ST(o)?s.getChild(n):rm(o,s.getChild(n))}}function jle(t,e,n,r){const s=$n(e,n),i=zd(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=_c(t.visibleWrites,s);return rm(o,r.getNode().getImmediateChild(n))}else return null}function Ale(t,e){return zd(t.visibleWrites,e)}function Rle(t,e,n,r,s,i,o){let l;const c=_c(t.visibleWrites,e),d=zd(c,Gt());if(d!=null)l=d;else if(n!=null)l=rm(c,n);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const h=[],m=o.getCompare(),p=i?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let v=p.getNext();for(;v&&h.length<s;)m(v,r)!==0&&h.push(v),v=p.getNext();return h}else return[]}function Ple(){return{visibleWrites:xo.empty(),allWrites:[],lastWriteId:-1}}function O_(t,e,n,r){return AU(t.writeTree,t.treePath,e,n,r)}function Tj(t,e){return Cle(t.writeTree,t.treePath,e)}function tD(t,e,n,r){return Ile(t.writeTree,t.treePath,e,n,r)}function D_(t,e){return Ale(t.writeTree,$n(t.treePath,e))}function Lle(t,e,n,r,s,i){return Rle(t.writeTree,t.treePath,e,n,r,s,i)}function Cj(t,e,n){return jle(t.writeTree,t.treePath,e,n)}function RU(t,e){return PU($n(t.treePath,e),t.writeTree)}function PU(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mle{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;Ne(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),Ne(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Dy(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Oy(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,tm(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Dy(r,e.snapshotNode,s.oldSnap));else throw Om("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ole{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const LU=new Ole;class Ij{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Pc(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Cj(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:_d(this.viewCache_),i=Lle(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dle(t){return{filter:t}}function Vle(t,e){Ne(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),Ne(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Fle(t,e,n,r,s){const i=new Mle;let o,l;if(n.type===fo.OVERWRITE){const d=n;d.source.fromUser?o=TT(t,e,d.path,d.snap,r,s,i):(Ne(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!Tt(d.path),o=V_(t,e,d.path,d.snap,r,s,l,i))}else if(n.type===fo.MERGE){const d=n;d.source.fromUser?o=Ble(t,e,d.path,d.children,r,s,i):(Ne(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),o=CT(t,e,d.path,d.children,r,s,l,i))}else if(n.type===fo.ACK_USER_WRITE){const d=n;d.revert?o=Wle(t,e,d.path,r,s,i):o=zle(t,e,d.path,d.affectedTree,r,s,i)}else if(n.type===fo.LISTEN_COMPLETE)o=Ule(t,e,n.path,r,i);else throw Om("Unknown operation type: "+n.type);const c=i.getChanges();return $le(e,o,c),{viewCache:o,changes:c}}function $le(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=M_(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(TU(M_(e)))}}function MU(t,e,n,r,s,i){const o=e.eventCache;if(D_(r,n)!=null)return e;{let l,c;if(Tt(n))if(Ne(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=_d(e),h=d instanceof ot?d:ot.EMPTY_NODE,m=Tj(r,h);l=t.filter.updateFullNode(e.eventCache.getNode(),m,i)}else{const d=O_(r,_d(e));l=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const d=St(n);if(d===".priority"){Ne(Rc(n)===1,"Can't have a priority with additional path components");const h=o.getNode();c=e.serverCache.getNode();const m=tD(r,n,h,c);m!=null?l=t.filter.updatePriority(h,m):l=o.getNode()}else{const h=mn(n);let m;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const p=tD(r,n,o.getNode(),c);p!=null?m=o.getNode().getImmediateChild(d).updateChild(h,p):m=o.getNode().getImmediateChild(d)}else m=Cj(r,d,e.serverCache);m!=null?l=t.filter.updateChild(o.getNode(),d,m,h,s,i):l=o.getNode()}}return zg(e,l,o.isFullyInitialized()||Tt(n),t.filter.filtersNodes())}}function V_(t,e,n,r,s,i,o,l){const c=e.serverCache;let d;const h=o?t.filter:t.filter.getIndexedFilter();if(Tt(n))d=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){const v=c.getNode().updateChild(n,r);d=h.updateFullNode(c.getNode(),v,null)}else{const v=St(n);if(!c.isCompleteForPath(n)&&Rc(n)>1)return e;const x=mn(n),E=c.getNode().getImmediateChild(v).updateChild(x,r);v===".priority"?d=h.updatePriority(c.getNode(),E):d=h.updateChild(c.getNode(),v,E,x,LU,null)}const m=CU(e,d,c.isFullyInitialized()||Tt(n),h.filtersNodes()),p=new Ij(s,m,i);return MU(t,m,n,s,p,l)}function TT(t,e,n,r,s,i,o){const l=e.eventCache;let c,d;const h=new Ij(s,e,i);if(Tt(n))d=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=zg(e,d,!0,t.filter.filtersNodes());else{const m=St(n);if(m===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),r),c=zg(e,d,l.isFullyInitialized(),l.isFiltered());else{const p=mn(n),v=l.getNode().getImmediateChild(m);let x;if(Tt(p))x=r;else{const b=h.getCompleteChild(m);b!=null?yj(p)===".priority"&&b.getChild(vU(p)).isEmpty()?x=b:x=b.updateChild(p,r):x=ot.EMPTY_NODE}if(v.equals(x))c=e;else{const b=t.filter.updateChild(l.getNode(),m,x,p,h,o);c=zg(e,b,l.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function nD(t,e){return t.eventCache.isCompleteForChild(e)}function Ble(t,e,n,r,s,i,o){let l=e;return r.foreach((c,d)=>{const h=$n(n,c);nD(e,St(h))&&(l=TT(t,l,h,d,s,i,o))}),r.foreach((c,d)=>{const h=$n(n,c);nD(e,St(h))||(l=TT(t,l,h,d,s,i,o))}),l}function rD(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function CT(t,e,n,r,s,i,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;Tt(n)?d=r:d=new gn(null).setTree(n,r);const h=e.serverCache.getNode();return d.children.inorderTraversal((m,p)=>{if(h.hasChild(m)){const v=e.serverCache.getNode().getImmediateChild(m),x=rD(t,v,p);c=V_(t,c,new Jt(m),x,s,i,o,l)}}),d.children.inorderTraversal((m,p)=>{const v=!e.serverCache.isCompleteForChild(m)&&p.value===null;if(!h.hasChild(m)&&!v){const x=e.serverCache.getNode().getImmediateChild(m),b=rD(t,x,p);c=V_(t,c,new Jt(m),b,s,i,o,l)}}),c}function zle(t,e,n,r,s,i,o){if(D_(s,n)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Tt(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return V_(t,e,n,c.getNode().getChild(n),s,i,l,o);if(Tt(n)){let d=new gn(null);return c.getNode().forEachChild(qu,(h,m)=>{d=d.set(new Jt(h),m)}),CT(t,e,n,d,s,i,l,o)}else return e}else{let d=new gn(null);return r.foreach((h,m)=>{const p=$n(n,h);c.isCompleteForPath(p)&&(d=d.set(h,c.getNode().getChild(p)))}),CT(t,e,n,d,s,i,l,o)}}function Ule(t,e,n,r,s){const i=e.serverCache,o=CU(e,i.getNode(),i.isFullyInitialized()||Tt(n),i.isFiltered());return MU(t,o,n,r,LU,s)}function Wle(t,e,n,r,s,i){let o;if(D_(r,n)!=null)return e;{const l=new Ij(r,e,s),c=e.eventCache.getNode();let d;if(Tt(n)||St(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=O_(r,_d(e));else{const m=e.serverCache.getNode();Ne(m instanceof ot,"serverChildren would be complete if leaf node"),h=Tj(r,m)}h=h,d=t.filter.updateFullNode(c,h,i)}else{const h=St(n);let m=Cj(r,h,e.serverCache);m==null&&e.serverCache.isCompleteForChild(h)&&(m=c.getImmediateChild(h)),m!=null?d=t.filter.updateChild(c,h,m,mn(n),l,i):e.eventCache.getNode().hasChild(h)?d=t.filter.updateChild(c,h,ot.EMPTY_NODE,mn(n),l,i):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=O_(r,_d(e)),o.isLeafNode()&&(d=t.filter.updateFullNode(d,o,i)))}return o=e.serverCache.isFullyInitialized()||D_(r,Gt())!=null,zg(e,d,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hle{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new wj(r.getIndex()),i=ale(r);this.processor_=Dle(i);const o=n.serverCache,l=n.eventCache,c=s.updateFullNode(ot.EMPTY_NODE,o.getNode(),null),d=i.updateFullNode(ot.EMPTY_NODE,l.getNode(),null),h=new Pc(c,o.isFullyInitialized(),s.filtersNodes()),m=new Pc(d,l.isFullyInitialized(),i.filtersNodes());this.viewCache_=Ek(m,h),this.eventGenerator_=new gle(this.query_)}get query(){return this.query_}}function qle(t){return t.viewCache_.serverCache.getNode()}function Gle(t){return M_(t.viewCache_)}function Kle(t,e){const n=_d(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Tt(e)&&!n.getImmediateChild(St(e)).isEmpty())?n.getChild(e):null}function sD(t){return t.eventRegistrations_.length===0}function Qle(t,e){t.eventRegistrations_.push(e)}function iD(t,e,n){const r=[];if(n){Ne(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function oD(t,e,n,r){e.type===fo.MERGE&&e.source.queryId!==null&&(Ne(_d(t.viewCache_),"We should always have a full cache before handling merges"),Ne(M_(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=Fle(t.processor_,s,e,n,r);return Vle(t.processor_,i.viewCache),Ne(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,OU(t,i.changes,i.viewCache.eventCache.getNode(),null)}function Zle(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Mn,(i,o)=>{r.push(tm(i,o))}),n.isFullyInitialized()&&r.push(TU(n.getNode())),OU(t,r,n.getNode(),e)}function OU(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return yle(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F_;class DU{constructor(){this.views=new Map}}function Yle(t){Ne(!F_,"__referenceConstructor has already been defined"),F_=t}function Xle(){return Ne(F_,"Reference.ts has not been loaded"),F_}function Jle(t){return t.views.size===0}function jj(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return Ne(i!=null,"SyncTree gave us an op for an invalid query."),oD(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(oD(o,e,n,r));return i}}function VU(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let l=O_(n,s?r:null),c=!1;l?c=!0:r instanceof ot?(l=Tj(n,r),c=!1):(l=ot.EMPTY_NODE,c=!1);const d=Ek(new Pc(l,c,!1),new Pc(r,s,!1));return new Hle(e,d)}return o}function ece(t,e,n,r,s,i){const o=VU(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Qle(o,n),Zle(o,n)}function tce(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const l=Lc(t);if(s==="default")for(const[c,d]of t.views.entries())o=o.concat(iD(d,n,r)),sD(d)&&(t.views.delete(c),d.query._queryParams.loadsAllData()||i.push(d.query));else{const c=t.views.get(s);c&&(o=o.concat(iD(c,n,r)),sD(c)&&(t.views.delete(s),c.query._queryParams.loadsAllData()||i.push(c.query)))}return l&&!Lc(t)&&i.push(new(Xle())(e._repo,e._path)),{removed:i,events:o}}function FU(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function wc(t,e){let n=null;for(const r of t.views.values())n=n||Kle(r,e);return n}function $U(t,e){if(e._queryParams.loadsAllData())return Tk(t);{const r=e._queryIdentifier;return t.views.get(r)}}function BU(t,e){return $U(t,e)!=null}function Lc(t){return Tk(t)!=null}function Tk(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $_;function nce(t){Ne(!$_,"__referenceConstructor has already been defined"),$_=t}function rce(){return Ne($_,"Reference.ts has not been loaded"),$_}let sce=1;class aD{constructor(e){this.listenProvider_=e,this.syncPointTree_=new gn(null),this.pendingWriteTree_=Ple(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function zU(t,e,n,r,s){return _le(t.pendingWriteTree_,e,n,r,s),s?Fm(t,new bd(Nj(),e,n)):[]}function ice(t,e,n,r){wle(t.pendingWriteTree_,e,n,r);const s=gn.fromObject(n);return Fm(t,new nm(Nj(),e,s))}function tc(t,e,n=!1){const r=kle(t.pendingWriteTree_,e);if(Nle(t.pendingWriteTree_,e)){let i=new gn(null);return r.snap!=null?i=i.set(Gt(),!0):Fr(r.children,o=>{i=i.set(new Jt(o),!0)}),Fm(t,new L_(r.path,i,n))}else return[]}function W0(t,e,n){return Fm(t,new bd(Ej(),e,n))}function oce(t,e,n){const r=gn.fromObject(n);return Fm(t,new nm(Ej(),e,r))}function ace(t,e){return Fm(t,new Fy(Ej(),e))}function lce(t,e,n){const r=Rj(t,n);if(r){const s=Pj(r),i=s.path,o=s.queryId,l=Ss(i,e),c=new Fy(Sj(o),l);return Lj(t,i,c)}else return[]}function B_(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let l=[];if(o&&(e._queryIdentifier==="default"||BU(o,e))){const c=tce(o,e,n,r);Jle(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const d=c.removed;if(l=c.events,!s){const h=d.findIndex(p=>p._queryParams.loadsAllData())!==-1,m=t.syncPointTree_.findOnPath(i,(p,v)=>Lc(v));if(h&&!m){const p=t.syncPointTree_.subtree(i);if(!p.isEmpty()){const v=dce(p);for(let x=0;x<v.length;++x){const b=v[x],E=b.query,k=qU(t,b);t.listenProvider_.startListening(Wg(E),$y(t,E),k.hashFn,k.onComplete)}}}!m&&d.length>0&&!r&&(h?t.listenProvider_.stopListening(Wg(e),null):d.forEach(p=>{const v=t.queryToTagMap.get(Ck(p));t.listenProvider_.stopListening(Wg(p),v)}))}hce(t,d)}return l}function UU(t,e,n,r){const s=Rj(t,r);if(s!=null){const i=Pj(s),o=i.path,l=i.queryId,c=Ss(o,e),d=new bd(Sj(l),c,n);return Lj(t,o,d)}else return[]}function cce(t,e,n,r){const s=Rj(t,r);if(s){const i=Pj(s),o=i.path,l=i.queryId,c=Ss(o,e),d=gn.fromObject(n),h=new nm(Sj(l),c,d);return Lj(t,o,h)}else return[]}function IT(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(p,v)=>{const x=Ss(p,s);i=i||wc(v,x),o=o||Lc(v)});let l=t.syncPointTree_.get(s);l?(o=o||Lc(l),i=i||wc(l,Gt())):(l=new DU,t.syncPointTree_=t.syncPointTree_.set(s,l));let c;i!=null?c=!0:(c=!1,i=ot.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((v,x)=>{const b=wc(x,Gt());b&&(i=i.updateImmediateChild(v,b))}));const d=BU(l,e);if(!d&&!e._queryParams.loadsAllData()){const p=Ck(e);Ne(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");const v=fce();t.queryToTagMap.set(p,v),t.tagToQueryMap.set(v,p)}const h=Sk(t.pendingWriteTree_,s);let m=ece(l,e,n,h,i,c);if(!d&&!o&&!r){const p=$U(l,e);m=m.concat(mce(t,e,p))}return m}function Aj(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,l)=>{const c=Ss(o,e),d=wc(l,c);if(d)return d});return AU(s,e,i,n,!0)}function uce(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(d,h)=>{const m=Ss(d,n);r=r||wc(h,m)});let s=t.syncPointTree_.get(n);s?r=r||wc(s,Gt()):(s=new DU,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new Pc(r,!0,!1):null,l=Sk(t.pendingWriteTree_,e._path),c=VU(s,e,l,i?o.getNode():ot.EMPTY_NODE,i);return Gle(c)}function Fm(t,e){return WU(e,t.syncPointTree_,null,Sk(t.pendingWriteTree_,Gt()))}function WU(t,e,n,r){if(Tt(t.path))return HU(t,e,n,r);{const s=e.get(Gt());n==null&&s!=null&&(n=wc(s,Gt()));let i=[];const o=St(t.path),l=t.operationForChild(o),c=e.children.get(o);if(c&&l){const d=n?n.getImmediateChild(o):null,h=RU(r,o);i=i.concat(WU(l,c,d,h))}return s&&(i=i.concat(jj(s,t,r,n))),i}}function HU(t,e,n,r){const s=e.get(Gt());n==null&&s!=null&&(n=wc(s,Gt()));let i=[];return e.children.inorderTraversal((o,l)=>{const c=n?n.getImmediateChild(o):null,d=RU(r,o),h=t.operationForChild(o);h&&(i=i.concat(HU(h,l,c,d)))}),s&&(i=i.concat(jj(s,t,r,n))),i}function qU(t,e){const n=e.query,r=$y(t,n);return{hashFn:()=>(qle(e)||ot.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?lce(t,n._path,r):ace(t,n._path);{const i=aae(s,n);return B_(t,n,null,i)}}}}function $y(t,e){const n=Ck(e);return t.queryToTagMap.get(n)}function Ck(t){return t._path.toString()+"$"+t._queryIdentifier}function Rj(t,e){return t.tagToQueryMap.get(e)}function Pj(t){const e=t.indexOf("$");return Ne(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Jt(t.substr(0,e))}}function Lj(t,e,n){const r=t.syncPointTree_.get(e);Ne(r,"Missing sync point for query tag that we're tracking");const s=Sk(t.pendingWriteTree_,e);return jj(r,n,s,null)}function dce(t){return t.fold((e,n,r)=>{if(n&&Lc(n))return[Tk(n)];{let s=[];return n&&(s=FU(n)),Fr(r,(i,o)=>{s=s.concat(o)}),s}})}function Wg(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(rce())(t._repo,t._path):t}function hce(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=Ck(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function fce(){return sce++}function mce(t,e,n){const r=e._path,s=$y(t,e),i=qU(t,n),o=t.listenProvider_.startListening(Wg(e),s,i.hashFn,i.onComplete),l=t.syncPointTree_.subtree(r);if(s)Ne(!Lc(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((d,h,m)=>{if(!Tt(d)&&h&&Lc(h))return[Tk(h).query];{let p=[];return h&&(p=p.concat(FU(h).map(v=>v.query))),Fr(m,(v,x)=>{p=p.concat(x)}),p}});for(let d=0;d<c.length;++d){const h=c[d];t.listenProvider_.stopListening(Wg(h),$y(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Mj(n)}node(){return this.node_}}class Oj{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=$n(this.path_,e);return new Oj(this.syncTree_,n)}node(){return Aj(this.syncTree_,this.path_)}}const pce=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},lD=function(t,e,n){if(!t||typeof t!="object")return t;if(Ne(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return gce(t[".sv"],e,n);if(typeof t[".sv"]=="object")return yce(t[".sv"],e);Ne(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},gce=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Ne(!1,"Unexpected server value: "+t)}},yce=function(t,e,n){t.hasOwnProperty("increment")||Ne(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&Ne(!1,"Unexpected increment value: "+r);const s=e.node();if(Ne(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},GU=function(t,e,n,r){return Dj(e,new Oj(n,t),r)},KU=function(t,e,n){return Dj(t,new Mj(e),n)};function Dj(t,e,n){const r=t.getPriority().val(),s=lD(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,l=lD(o.getValue(),e,n);return l!==o.getValue()||s!==o.getPriority().val()?new Ar(l,Xn(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new Ar(s))),o.forEachChild(Mn,(l,c)=>{const d=Dj(c,e.getImmediateChild(l),n);d!==c&&(i=i.updateImmediateChild(l,d))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Fj(t,e){let n=e instanceof Jt?e:new Jt(e),r=t,s=St(n);for(;s!==null;){const i=Jf(r.node.children,s)||{children:{},childCount:0};r=new Vj(s,r,i),n=mn(n),s=St(n)}return r}function $m(t){return t.node.value}function QU(t,e){t.node.value=e,jT(t)}function ZU(t){return t.node.childCount>0}function xce(t){return $m(t)===void 0&&!ZU(t)}function Ik(t,e){Fr(t.node.children,(n,r)=>{e(new Vj(n,t,r))})}function YU(t,e,n,r){n&&e(t),Ik(t,s=>{YU(s,e,!0)})}function vce(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function H0(t){return new Jt(t.parent===null?t.name:H0(t.parent)+"/"+t.name)}function jT(t){t.parent!==null&&bce(t.parent,t.name,t)}function bce(t,e,n){const r=xce(n),s=oa(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,jT(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,jT(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ce=/[\[\].#$\/\u0000-\u001F\u007F]/,wce=/[\[\].#$\u0000-\u001F\u007F]/,KN=10*1024*1024,$j=function(t){return typeof t=="string"&&t.length!==0&&!_ce.test(t)},XU=function(t){return typeof t=="string"&&t.length!==0&&!wce.test(t)},kce=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),XU(t)},z_=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!kk(t)||t&&typeof t=="object"&&oa(t,".sv")},U_=function(t,e,n,r){r&&e===void 0||jk(em(t,"value"),e,n)},jk=function(t,e,n){const r=n instanceof Jt?new Bae(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+ku(r));if(typeof e=="function")throw new Error(t+"contains a function "+ku(r)+" with contents = "+e.toString());if(kk(e))throw new Error(t+"contains "+e.toString()+" "+ku(r));if(typeof e=="string"&&e.length>KN/3&&wk(e)>KN)throw new Error(t+"contains a string greater than "+KN+" utf8 bytes "+ku(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(Fr(e,(o,l)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!$j(o)))throw new Error(t+" contains an invalid key ("+o+") "+ku(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);zae(r,o),jk(t,l,r),Uae(r)}),s&&i)throw new Error(t+' contains ".value" child '+ku(r)+" in addition to actual children.")}},Nce=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=My(r);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!$j(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort($ae);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&$i(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},JU=function(t,e,n,r){const s=em(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];Fr(e,(o,l)=>{const c=new Jt(o);if(jk(s,l,$n(n,c)),yj(c)===".priority"&&!z_(l))throw new Error(s+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),Nce(s,i)},Ece=function(t,e,n){if(kk(e))throw new Error(em(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!z_(e))throw new Error(em(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Bj=function(t,e,n,r){if(!XU(n))throw new Error(em(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Sce=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Bj(t,e,n)},Mu=function(t,e){if(St(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Tce=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!$j(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!kce(n))throw new Error(em(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cce{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ak(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!xj(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function e9(t,e,n){Ak(t,n),t9(t,r=>xj(r,e))}function Gi(t,e,n){Ak(t,n),t9(t,r=>$i(r,e)||$i(e,r))}function t9(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(Ice(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Ice(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();$g&&Dr("event: "+n.toString()),Dm(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jce="repo_interrupt",Ace=25;class Rce{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Cce,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=P_(),this.transactionQueueTree_=new Vj,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Pce(t,e,n){if(t.stats_=pj(t.repoInfo_),t.forceRestClient_||dae())t.server_=new R_(t.repoInfo_,(r,s,i,o)=>{cD(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>uD(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{wr(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new $a(t.repoInfo_,e,(r,s,i,o)=>{cD(t,r,s,i,o)},r=>{uD(t,r)},r=>{Lce(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=gae(t.repoInfo_,()=>new ple(t.stats_,t.server_)),t.infoData_=new ule,t.infoSyncTree_=new aD({startListening:(r,s,i,o)=>{let l=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(l=W0(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),zj(t,"connected",!1),t.serverSyncTree_=new aD({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(l,c)=>{const d=o(l,c);Gi(t.eventQueue_,r._path,d)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function n9(t){const n=t.infoData_.getNode(new Jt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Rk(t){return pce({timestamp:n9(t)})}function cD(t,e,n,r,s){t.dataUpdateCount++;const i=new Jt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const c=C_(n,d=>Xn(d));o=cce(t.serverSyncTree_,i,c,s)}else{const c=Xn(n);o=UU(t.serverSyncTree_,i,c,s)}else if(r){const c=C_(n,d=>Xn(d));o=oce(t.serverSyncTree_,i,c)}else{const c=Xn(n);o=W0(t.serverSyncTree_,i,c)}let l=i;o.length>0&&(l=sm(t,i)),Gi(t.eventQueue_,l,o)}function uD(t,e){zj(t,"connected",e),e===!1&&Vce(t)}function Lce(t,e){Fr(e,(n,r)=>{zj(t,n,r)})}function zj(t,e,n){const r=new Jt("/.info/"+e),s=Xn(n);t.infoData_.updateSnapshot(r,s);const i=W0(t.infoSyncTree_,r,s);Gi(t.eventQueue_,r,i)}function Uj(t){return t.nextWriteId_++}function Mce(t,e,n){const r=uce(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const i=Xn(s).withIndex(e._queryParams.getIndex());IT(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=W0(t.serverSyncTree_,e._path,i);else{const l=$y(t.serverSyncTree_,e);o=UU(t.serverSyncTree_,e._path,i,l)}return Gi(t.eventQueue_,e._path,o),B_(t.serverSyncTree_,e,n,null,!0),i},s=>(q0(t,"get for query "+wr(e)+" failed: "+s),Promise.reject(new Error(s))))}function Oce(t,e,n,r,s){q0(t,"set",{path:e.toString(),value:n,priority:r});const i=Rk(t),o=Xn(n,r),l=Aj(t.serverSyncTree_,e),c=KU(o,l,i),d=Uj(t),h=zU(t.serverSyncTree_,e,c,d,!0);Ak(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(p,v)=>{const x=p==="ok";x||As("set at "+e+" failed: "+p);const b=tc(t.serverSyncTree_,d,!x);Gi(t.eventQueue_,e,b),Mc(t,s,p,v)});const m=Hj(t,e);sm(t,m),Gi(t.eventQueue_,m,[])}function Dce(t,e,n,r){q0(t,"update",{path:e.toString(),value:n});let s=!0;const i=Rk(t),o={};if(Fr(n,(l,c)=>{s=!1,o[l]=GU($n(e,l),Xn(c),t.serverSyncTree_,i)}),s)Dr("update() called with empty data.  Don't do anything."),Mc(t,r,"ok",void 0);else{const l=Uj(t),c=ice(t.serverSyncTree_,e,o,l);Ak(t.eventQueue_,c),t.server_.merge(e.toString(),n,(d,h)=>{const m=d==="ok";m||As("update at "+e+" failed: "+d);const p=tc(t.serverSyncTree_,l,!m),v=p.length>0?sm(t,e):e;Gi(t.eventQueue_,v,p),Mc(t,r,d,h)}),Fr(n,d=>{const h=Hj(t,$n(e,d));sm(t,h)}),Gi(t.eventQueue_,e,[])}}function Vce(t){q0(t,"onDisconnectEvents");const e=Rk(t),n=P_();kT(t.onDisconnect_,Gt(),(s,i)=>{const o=GU(s,i,t.serverSyncTree_,e);Vm(n,s,o)});let r=[];kT(n,Gt(),(s,i)=>{r=r.concat(W0(t.serverSyncTree_,s,i));const o=Hj(t,s);sm(t,o)}),t.onDisconnect_=P_(),Gi(t.eventQueue_,Gt(),r)}function Fce(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&wT(t.onDisconnect_,e),Mc(t,n,r,s)})}function dD(t,e,n,r){const s=Xn(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(i,o)=>{i==="ok"&&Vm(t.onDisconnect_,e,s),Mc(t,r,i,o)})}function $ce(t,e,n,r,s){const i=Xn(n,r);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,l)=>{o==="ok"&&Vm(t.onDisconnect_,e,i),Mc(t,s,o,l)})}function Bce(t,e,n,r){if(xT(n)){Dr("onDisconnect().update() called with empty data.  Don't do anything."),Mc(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,i)=>{s==="ok"&&Fr(n,(o,l)=>{const c=Xn(l);Vm(t.onDisconnect_,$n(e,o),c)}),Mc(t,r,s,i)})}function zce(t,e,n){let r;St(e._path)===".info"?r=IT(t.infoSyncTree_,e,n):r=IT(t.serverSyncTree_,e,n),e9(t.eventQueue_,e._path,r)}function hD(t,e,n){let r;St(e._path)===".info"?r=B_(t.infoSyncTree_,e,n):r=B_(t.serverSyncTree_,e,n),e9(t.eventQueue_,e._path,r)}function Uce(t){t.persistentConnection_&&t.persistentConnection_.interrupt(jce)}function q0(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Dr(n,...e)}function Mc(t,e,n,r){e&&Dm(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function r9(t,e,n){return Aj(t.serverSyncTree_,e,n)||ot.EMPTY_NODE}function Wj(t,e=t.transactionQueueTree_){if(e||Pk(t,e),$m(e)){const n=i9(t,e);Ne(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&Wce(t,H0(e),n)}else ZU(e)&&Ik(e,n=>{Wj(t,n)})}function Wce(t,e,n){const r=n.map(d=>d.currentWriteId),s=r9(t,e,r);let i=s;const o=s.hash();for(let d=0;d<n.length;d++){const h=n[d];Ne(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const m=Ss(e,h.path);i=i.updateChild(m,h.currentOutputSnapshotRaw)}const l=i.val(!0),c=e;t.server_.put(c.toString(),l,d=>{q0(t,"transaction put response",{path:c.toString(),status:d});let h=[];if(d==="ok"){const m=[];for(let p=0;p<n.length;p++)n[p].status=2,h=h.concat(tc(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&m.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();Pk(t,Fj(t.transactionQueueTree_,e)),Wj(t,t.transactionQueueTree_),Gi(t.eventQueue_,e,h);for(let p=0;p<m.length;p++)Dm(m[p])}else{if(d==="datastale")for(let m=0;m<n.length;m++)n[m].status===3?n[m].status=4:n[m].status=0;else{As("transaction at "+c.toString()+" failed: "+d);for(let m=0;m<n.length;m++)n[m].status=4,n[m].abortReason=d}sm(t,e)}},o)}function sm(t,e){const n=s9(t,e),r=H0(n),s=i9(t,n);return Hce(t,s,r),r}function Hce(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],d=Ss(n,c.path);let h=!1,m;if(Ne(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)h=!0,m=c.abortReason,s=s.concat(tc(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Ace)h=!0,m="maxretry",s=s.concat(tc(t.serverSyncTree_,c.currentWriteId,!0));else{const p=r9(t,c.path,o);c.currentInputSnapshot=p;const v=e[l].update(p.val());if(v!==void 0){jk("transaction failed: Data returned ",v,c.path);let x=Xn(v);typeof v=="object"&&v!=null&&oa(v,".priority")||(x=x.updatePriority(p.getPriority()));const E=c.currentWriteId,k=Rk(t),_=KU(x,p,k);c.currentOutputSnapshotRaw=x,c.currentOutputSnapshotResolved=_,c.currentWriteId=Uj(t),o.splice(o.indexOf(E),1),s=s.concat(zU(t.serverSyncTree_,c.path,_,c.currentWriteId,c.applyLocally)),s=s.concat(tc(t.serverSyncTree_,E,!0))}else h=!0,m="nodata",s=s.concat(tc(t.serverSyncTree_,c.currentWriteId,!0))}Gi(t.eventQueue_,n,s),s=[],h&&(e[l].status=2,function(p){setTimeout(p,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(m==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(m),!1,null))))}Pk(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)Dm(r[l]);Wj(t,t.transactionQueueTree_)}function s9(t,e){let n,r=t.transactionQueueTree_;for(n=St(e);n!==null&&$m(r)===void 0;)r=Fj(r,n),e=mn(e),n=St(e);return r}function i9(t,e){const n=[];return o9(t,e,n),n.sort((r,s)=>r.order-s.order),n}function o9(t,e,n){const r=$m(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Ik(e,s=>{o9(t,s,n)})}function Pk(t,e){const n=$m(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,QU(e,n.length>0?n:void 0)}Ik(e,r=>{Pk(t,r)})}function Hj(t,e){const n=H0(s9(t,e)),r=Fj(t.transactionQueueTree_,e);return vce(r,s=>{QN(t,s)}),QN(t,r),YU(r,s=>{QN(t,s)}),n}function QN(t,e){const n=$m(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(Ne(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(Ne(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(tc(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?QU(e,void 0):n.length=i+1,Gi(t.eventQueue_,H0(e),s);for(let o=0;o<r.length;o++)Dm(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qce(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function Gce(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):As(`Invalid query segment '${n}' in query '${t}'`)}return e}const fD=function(t,e){const n=Kce(t),r=n.namespace;n.domain==="firebase.com"&&Ja(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Ja("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||nae();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new uU(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Jt(n.pathString)}},Kce=function(t){let e="",n="",r="",s="",i="",o=!0,l="https",c=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(l=t.substring(0,d-1),t=t.substring(d+2));let h=t.indexOf("/");h===-1&&(h=t.length);let m=t.indexOf("?");m===-1&&(m=t.length),e=t.substring(0,Math.min(h,m)),h<m&&(s=qce(t.substring(h,m)));const p=Gce(t.substring(Math.min(t.length,m)));d=e.indexOf(":"),d>=0?(o=l==="https"||l==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const v=e.slice(0,d);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{const x=e.indexOf(".");r=e.substring(0,x).toLowerCase(),n=e.substring(x+1),i=r}"ns"in p&&(i=p.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:l,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Qce=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const i=new Array(8);for(s=7;s>=0;s--)i[s]=mD.charAt(n%64),n=Math.floor(n/64);Ne(n===0,"Cannot push at time == 0");let o=i.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)o+=mD.charAt(e[s]);return Ne(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zce{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+wr(this.snapshot.exportVal())}}class Yce{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a9{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return Ne(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xce{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Ca;return Fce(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Mu("OnDisconnect.remove",this._path);const e=new Ca;return dD(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Mu("OnDisconnect.set",this._path),U_("OnDisconnect.set",e,this._path,!1);const n=new Ca;return dD(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Mu("OnDisconnect.setWithPriority",this._path),U_("OnDisconnect.setWithPriority",e,this._path,!1),Ece("OnDisconnect.setWithPriority",n);const r=new Ca;return $ce(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Mu("OnDisconnect.update",this._path),JU("OnDisconnect.update",e,this._path);const n=new Ca;return Bce(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return Tt(this._path)?null:yj(this._path)}get ref(){return new ml(this._repo,this._path)}get _queryIdentifier(){const e=YO(this._queryParams),n=fj(e);return n==="{}"?"default":n}get _queryObject(){return YO(this._queryParams)}isEqual(e){if(e=fl(e),!(e instanceof G0))return!1;const n=this._repo===e._repo,r=xj(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Fae(this._path)}}function Jce(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function eue(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===qu){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==vd)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==Ac)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===Mn){if(e!=null&&!z_(e)||n!=null&&!z_(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Ne(t.getIndex()instanceof _j||t.getIndex()===SU,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class ml extends G0{constructor(e,n){super(e,n,new kj,!1)}get parent(){const e=vU(this._path);return e===null?null:new ml(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class By{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Jt(e),r=zy(this.ref,e);return new By(this._node.getChild(n),r,Mn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new By(s,zy(this.ref,r),Mn)))}hasChild(e){const n=new Jt(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ln(t,e){return t=fl(t),t._checkNotDeleted("ref"),e!==void 0?zy(t._root,e):t._root}function zy(t,e){return t=fl(t),St(t._path)===null?Sce("child","path",e):Bj("child","path",e),new ml(t._repo,$n(t._path,e))}function tue(t){return t=fl(t),new Xce(t._repo,t._path)}function AT(t,e){t=fl(t),Mu("push",t._path),U_("push",e,t._path,!0);const n=n9(t._repo),r=Qce(n),s=zy(t,r),i=zy(t,r);let o;return o=Promise.resolve(i),s.then=o.then.bind(o),s.catch=o.then.bind(o,void 0),s}function RT(t){return Mu("remove",t._path),Gu(t,null)}function Gu(t,e){t=fl(t),Mu("set",t._path),U_("set",e,t._path,!1);const n=new Ca;return Oce(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Ia(t,e){JU("update",e,t._path);const n=new Ca;return Dce(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Sv(t){t=fl(t);const e=new a9(()=>{}),n=new Lk(e);return Mce(t._repo,t,n).then(r=>new By(r,new ml(t._repo,t._path),t._queryParams.getIndex()))}class Lk{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new Zce("value",this,new By(e.snapshotNode,new ml(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Yce(this,e,n):null}matches(e){return e instanceof Lk?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function nue(t,e,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const c=n,d=(h,m)=>{hD(t._repo,t,l),c(h,m)};d.userCallback=n.userCallback,d.context=n.context,n=d}const o=new a9(n,i||void 0),l=new Lk(o);return zce(t._repo,t,l),()=>hD(t._repo,t,l)}function Ud(t,e,n,r){return nue(t,"value",e,n,r)}class l9{}class rue extends l9{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new G0(e._repo,e._path,lle(e._queryParams,this._limit),e._orderByCalled)}}function qj(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new rue(t)}class sue extends l9{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Jce(e,"orderByChild");const n=new Jt(this._path);if(Tt(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new _j(n),s=cle(e._queryParams,r);return eue(s),new G0(e._repo,e._path,s,!0)}}function Gj(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Bj("orderByChild","path",t),new sue(t)}function Mk(t,...e){let n=fl(t);for(const r of e)n=r._apply(n);return n}Yle(ml);nce(ml);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iue="FIREBASE_DATABASE_EMULATOR_HOST",PT={};let oue=!1;function aue(t,e,n,r){t.repoInfo_=new uU(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function lue(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Ja("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Dr("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=fD(i,s),l=o.repoInfo,c;typeof process<"u"&&PO&&(c=PO[iue]),c?(i=`http://${c}?ns=${l.namespace}`,o=fD(i,s),l=o.repoInfo):o.repoInfo.secure;const d=new fae(t.name,t.options,e);Tce("Invalid Firebase Database URL",o),Tt(o.path)||Ja("Database URL must point to the root of a Firebase Database (not including a child path).");const h=uue(l,t,d,new hae(t.name,n));return new due(h,t)}function cue(t,e){const n=PT[e];(!n||n[t.key]!==t)&&Ja(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Uce(t),delete n[t.key]}function uue(t,e,n,r){let s=PT[e.name];s||(s={},PT[e.name]=s);let i=s[t.toURLString()];return i&&Ja("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Rce(t,oue,n,r),s[t.toURLString()]=i,i}let due=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Pce(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ml(this._repo,Gt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(cue(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ja("Cannot call "+e+" on a deleted database.")}};function hue(t=$0(),e){const n=Mm(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=Loe("database");r&&fue(n,...r)}return n}function fue(t,e,n,r={}){t=fl(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Ja("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&Ja('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new yb(yb.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:Moe(r.mockUserToken,t.app.options.projectId);i=new yb(o)}aue(s,e,n,i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mue(t){Zoe($d),Xa(new Woe("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return lue(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),fi(LO,MO,t),fi(LO,MO,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pue={".sv":"timestamp"};function nc(){return pue}$a.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};$a.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};mue();fi("firestore-stripe-payments","0.0.6");function gue(t,e){return Kj.create(t,e)}class Kj{constructor(e,n){this.app=e,this.options=n,this.components={}}static create(e,n){return new Kj(e,n)}get customersCollection(){return this.options.customersCollection}get productsCollection(){return this.options.productsCollection}getComponent(e){let n=this.components[e];return n||null}setComponent(e,n){this.components[e]=n}}class xb extends Error{constructor(e,n,r){super(n),this.code=e,this.message=n,this.cause=r}}var pD={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},yue=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},u9={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;c||(v=64,o||(p=64)),r.push(n[h],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(c9(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):yue(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new xue;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let xue=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const vue=function(t){const e=c9(t);return u9.encodeByteArray(e,!0)},gD=function(t){return vue(t).replace(/\./g,"")},bue=function(t){try{return u9.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _ue(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wue=()=>_ue().__FIREBASE_DEFAULTS__,kue=()=>{if(typeof process>"u"||typeof pD>"u")return;const t=pD.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Nue=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&bue(t[1]);return e&&JSON.parse(e)},Eue=()=>{try{return wue()||kue()||Nue()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Sue=t=>{var e,n;return(n=(e=Eue())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Tue=t=>{const e=Sue(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cue(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[gD(JSON.stringify(n)),gD(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iue="FirebaseError";let d9=class h9 extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Iue,Object.setPrototypeOf(this,h9.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jue.prototype.create)}},jue=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Aue(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new d9(s,l,r)}};function Aue(t,e){return t.replace(Rue,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Rue=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(t){return t&&t._delegate?t._delegate:t}let Pue=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Xt||(Xt={}));const Lue={debug:Xt.DEBUG,verbose:Xt.VERBOSE,info:Xt.INFO,warn:Xt.WARN,error:Xt.ERROR,silent:Xt.SILENT},Mue=Xt.INFO,Oue={[Xt.DEBUG]:"log",[Xt.VERBOSE]:"log",[Xt.INFO]:"info",[Xt.WARN]:"warn",[Xt.ERROR]:"error"},Due=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Oue[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let Vue=class{constructor(e){this.name=e,this._logLevel=Mue,this._logHandler=Due,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Lue[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xt.DEBUG,...e),this._logHandler(this,Xt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xt.VERBOSE,...e),this._logHandler(this,Xt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xt.INFO,...e),this._logHandler(this,Xt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xt.WARN,...e),this._logHandler(this,Xt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xt.ERROR,...e),this._logHandler(this,Xt.ERROR,...e)}};var Fue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Me,Qj=Qj||{},ht=Fue||self;function Ok(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Dk(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function $ue(t,e,n){return t.call.apply(t.bind,arguments)}function Bue(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function ps(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ps=$ue:ps=Bue,ps.apply(null,arguments)}function Tv(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function zr(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var o=Array(arguments.length-2),l=2;l<arguments.length;l++)o[l-2]=arguments[l];return e.prototype[s].apply(r,o)}}function Jc(){this.s=this.s,this.o=this.o}var zue=0;Jc.prototype.s=!1;Jc.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),zue!=0)};Jc.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const f9=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Zj(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function yD(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Ok(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let o=0;o<i;o++)t[s+o]=r[o]}else t.push(r)}}function gs(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}gs.prototype.h=function(){this.defaultPrevented=!0};var Uue=function(){if(!ht.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ht.addEventListener("test",()=>{},e),ht.removeEventListener("test",()=>{},e)}catch{}return t}();function Uy(t){return/^[\s\xa0]*$/.test(t)}function Vk(){var t=ht.navigator;return t&&(t=t.userAgent)?t:""}function Ro(t){return Vk().indexOf(t)!=-1}function Yj(t){return Yj[" "](t),t}Yj[" "]=function(){};function Wue(t,e){var n=Dde;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var Hue=Ro("Opera"),om=Ro("Trident")||Ro("MSIE"),m9=Ro("Edge"),LT=m9||om,p9=Ro("Gecko")&&!(Vk().toLowerCase().indexOf("webkit")!=-1&&!Ro("Edge"))&&!(Ro("Trident")||Ro("MSIE"))&&!Ro("Edge"),que=Vk().toLowerCase().indexOf("webkit")!=-1&&!Ro("Edge");function g9(){var t=ht.document;return t?t.documentMode:void 0}var MT;e:{var ZN="",YN=function(){var t=Vk();if(p9)return/rv:([^\);]+)(\)|;)/.exec(t);if(m9)return/Edge\/([\d\.]+)/.exec(t);if(om)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(que)return/WebKit\/(\S+)/.exec(t);if(Hue)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(YN&&(ZN=YN?YN[1]:""),om){var XN=g9();if(XN!=null&&XN>parseFloat(ZN)){MT=String(XN);break e}}MT=ZN}var OT;if(ht.document&&om){var xD=g9();OT=xD||parseInt(MT,10)||void 0}else OT=void 0;var Gue=OT;function Wy(t,e){if(gs.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(p9){e:{try{Yj(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Kue[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Wy.$.h.call(this)}}zr(Wy,gs);var Kue={2:"touch",3:"pen",4:"mouse"};Wy.prototype.h=function(){Wy.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Fk="closure_listenable_"+(1e6*Math.random()|0),Que=0;function Zue(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++Que,this.fa=this.ia=!1}function $k(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Xj(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Yue(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function y9(t){const e={};for(const n in t)e[n]=t[n];return e}const vD="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x9(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<vD.length;i++)n=vD[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Bk(t){this.src=t,this.g={},this.h=0}Bk.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=VT(t,e,r,s);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new Zue(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function DT(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=f9(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&($k(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function VT(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var Jj="closure_lm_"+(1e6*Math.random()|0),JN={};function v9(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)v9(t,e[i],n,r,s);return null}return n=w9(n),t&&t[Fk]?t.O(e,n,Dk(r)?!!r.capture:!1,s):Xue(t,e,n,!1,r,s)}function Xue(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Dk(s)?!!s.capture:!!s,l=tA(t);if(l||(t[Jj]=l=new Bk(t)),n=l.add(e,n,r,o,i),n.proxy)return n;if(r=Jue(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Uue||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(_9(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Jue(){function t(n){return e.call(t.src,t.listener,n)}const e=ede;return t}function b9(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)b9(t,e[i],n,r,s);else r=Dk(r)?!!r.capture:!!r,n=w9(n),t&&t[Fk]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=VT(i,n,r,s),-1<n&&($k(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=tA(t))&&(e=t.g[e.toString()],t=-1,e&&(t=VT(e,n,r,s)),(n=-1<t?e[t]:null)&&eA(n))}function eA(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Fk])DT(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_9(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=tA(e))?(DT(n,t),n.h==0&&(n.src=null,e[Jj]=null)):$k(t)}}}function _9(t){return t in JN?JN[t]:JN[t]="on"+t}function ede(t,e){if(t.fa)t=!0;else{e=new Wy(e,this);var n=t.listener,r=t.la||t.src;t.ia&&eA(t),t=n.call(r,e)}return t}function tA(t){return t=t[Jj],t instanceof Bk?t:null}var eE="__closure_events_fn_"+(1e9*Math.random()>>>0);function w9(t){return typeof t=="function"?t:(t[eE]||(t[eE]=function(e){return t.handleEvent(e)}),t[eE])}function $r(){Jc.call(this),this.i=new Bk(this),this.S=this,this.J=null}zr($r,Jc);$r.prototype[Fk]=!0;$r.prototype.removeEventListener=function(t,e,n,r){b9(this,t,e,n,r)};function Yr(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new gs(e,t);else if(e instanceof gs)e.target=e.target||t;else{var s=e;e=new gs(r,t),x9(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=Cv(o,r,!0,e)&&s}if(o=e.g=t,s=Cv(o,r,!0,e)&&s,s=Cv(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=Cv(o,r,!1,e)&&s}$r.prototype.N=function(){if($r.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)$k(n[r]);delete t.g[e],t.h--}}this.J=null};$r.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};$r.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Cv(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==n){var l=o.listener,c=o.la||o.src;o.ia&&DT(t.i,o),s=l.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var nA=ht.JSON.stringify;class tde{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function nde(){var t=rA;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class rde{constructor(){this.h=this.g=null}add(e,n){const r=k9.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var k9=new tde(()=>new sde,t=>t.reset());class sde{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function ide(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function ode(t){ht.setTimeout(()=>{throw t},0)}let Hy,qy=!1,rA=new rde,N9=()=>{const t=ht.Promise.resolve(void 0);Hy=()=>{t.then(ade)}};var ade=()=>{for(var t;t=nde();){try{t.h.call(t.g)}catch(n){ode(n)}var e=k9;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}qy=!1};function zk(t,e){$r.call(this),this.h=t||1,this.g=e||ht,this.j=ps(this.qb,this),this.l=Date.now()}zr(zk,$r);Me=zk.prototype;Me.ga=!1;Me.T=null;Me.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Yr(this,"tick"),this.ga&&(sA(this),this.start()))}};Me.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function sA(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}Me.N=function(){zk.$.N.call(this),sA(this),delete this.g};function iA(t,e,n){if(typeof t=="function")n&&(t=ps(t,n));else if(t&&typeof t.handleEvent=="function")t=ps(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ht.setTimeout(t,e||0)}function E9(t){t.g=iA(()=>{t.g=null,t.i&&(t.i=!1,E9(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class lde extends Jc{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:E9(this)}N(){super.N(),this.g&&(ht.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gy(t){Jc.call(this),this.h=t,this.g={}}zr(Gy,Jc);var bD=[];function S9(t,e,n,r){Array.isArray(n)||(n&&(bD[0]=n.toString()),n=bD);for(var s=0;s<n.length;s++){var i=v9(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function T9(t){Xj(t.g,function(e,n){this.g.hasOwnProperty(n)&&eA(e)},t),t.g={}}Gy.prototype.N=function(){Gy.$.N.call(this),T9(this)};Gy.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Uk(){this.g=!0}Uk.prototype.Ea=function(){this.g=!1};function cde(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",l=i.split("&"),c=0;c<l.length;c++){var d=l[c].split("=");if(1<d.length){var h=d[0];d=d[1];var m=h.split("_");o=2<=m.length&&m[1]=="type"?o+(h+"="+d+"&"):o+(h+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function ude(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function nf(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+hde(t,n)+(r?" "+r:"")})}function dde(t,e){t.info(function(){return"TIMEOUT: "+e})}Uk.prototype.info=function(){};function hde(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return nA(n)}catch{return e}}var Wd={},_D=null;function Wk(){return _D=_D||new $r}Wd.Ta="serverreachability";function C9(t){gs.call(this,Wd.Ta,t)}zr(C9,gs);function Ky(t){const e=Wk();Yr(e,new C9(e))}Wd.STAT_EVENT="statevent";function I9(t,e){gs.call(this,Wd.STAT_EVENT,t),this.stat=e}zr(I9,gs);function Ts(t){const e=Wk();Yr(e,new I9(e,t))}Wd.Ua="timingevent";function j9(t,e){gs.call(this,Wd.Ua,t),this.size=e}zr(j9,gs);function K0(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ht.setTimeout(function(){t()},e)}var Hk={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},A9={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function oA(){}oA.prototype.h=null;function wD(t){return t.h||(t.h=t.i())}function R9(){}var Q0={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function aA(){gs.call(this,"d")}zr(aA,gs);function lA(){gs.call(this,"c")}zr(lA,gs);var FT;function qk(){}zr(qk,oA);qk.prototype.g=function(){return new XMLHttpRequest};qk.prototype.i=function(){return{}};FT=new qk;function Z0(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Gy(this),this.P=fde,t=LT?125:void 0,this.V=new zk(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new P9}function P9(){this.i=null,this.g="",this.h=!1}var fde=45e3,$T={},W_={};Me=Z0.prototype;Me.setTimeout=function(t){this.P=t};function BT(t,e,n){t.L=1,t.v=Kk(el(e)),t.s=n,t.S=!0,L9(t,null)}function L9(t,e){t.G=Date.now(),Y0(t),t.A=el(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),z9(n.i,"t",r),t.C=0,n=t.l.J,t.h=new P9,t.g=c8(t.l,n?e:null,!t.s),0<t.O&&(t.M=new lde(ps(t.Pa,t,t.g),t.O)),S9(t.U,t.g,"readystatechange",t.nb),e=t.I?y9(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Ky(),cde(t.j,t.u,t.A,t.m,t.W,t.s)}Me.nb=function(t){t=t.target;const e=this.M;e&&Oo(t)==3?e.l():this.Pa(t)};Me.Pa=function(t){try{if(t==this.g)e:{const h=Oo(this.g);var e=this.g.Ia();const m=this.g.da();if(!(3>h)&&(h!=3||LT||this.g&&(this.h.h||this.g.ja()||SD(this.g)))){this.J||h!=4||e==7||(e==8||0>=m?Ky(3):Ky(2)),Gk(this);var n=this.g.da();this.ca=n;t:if(M9(this)){var r=SD(this.g);t="";var s=r.length,i=Oo(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ou(this),Hg(this);var o="";break t}this.h.i=new ht.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,ude(this.j,this.u,this.A,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Uy(l)){var d=l;break t}}d=null}if(n=d)nf(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zT(this,n);else{this.i=!1,this.o=3,Ts(12),Ou(this),Hg(this);break e}}this.S?(O9(this,h,o),LT&&this.i&&h==3&&(S9(this.U,this.V,"tick",this.mb),this.V.start())):(nf(this.j,this.m,o,null),zT(this,o)),h==4&&Ou(this),this.i&&!this.J&&(h==4?i8(this.l,this):(this.i=!1,Y0(this)))}else Lde(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,Ts(12)):(this.o=0,Ts(13)),Ou(this),Hg(this)}}}catch{}finally{}};function M9(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function O9(t,e,n){let r=!0,s;for(;!t.J&&t.C<n.length;)if(s=mde(t,n),s==W_){e==4&&(t.o=4,Ts(14),r=!1),nf(t.j,t.m,null,"[Incomplete Response]");break}else if(s==$T){t.o=4,Ts(15),nf(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else nf(t.j,t.m,s,null),zT(t,s);M9(t)&&s!=W_&&s!=$T&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Ts(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),mA(e),e.M=!0,Ts(11))):(nf(t.j,t.m,n,"[Invalid Chunked Response]"),Ou(t),Hg(t))}Me.mb=function(){if(this.g){var t=Oo(this.g),e=this.g.ja();this.C<e.length&&(Gk(this),O9(this,t,e),this.i&&t!=4&&Y0(this))}};function mde(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?W_:(n=Number(e.substring(n,r)),isNaN(n)?$T:(r+=1,r+n>e.length?W_:(e=e.slice(r,r+n),t.C=r+n,e)))}Me.cancel=function(){this.J=!0,Ou(this)};function Y0(t){t.Y=Date.now()+t.P,D9(t,t.P)}function D9(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=K0(ps(t.lb,t),e)}function Gk(t){t.B&&(ht.clearTimeout(t.B),t.B=null)}Me.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(dde(this.j,this.A),this.L!=2&&(Ky(),Ts(17)),Ou(this),this.o=2,Hg(this)):D9(this,this.Y-t)};function Hg(t){t.l.H==0||t.J||i8(t.l,t)}function Ou(t){Gk(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,sA(t.V),T9(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function zT(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||UT(n.i,t))){if(!t.K&&UT(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)G_(n),Yk(n);else break e;fA(n),Ts(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=K0(ps(n.ib,n),6e3));if(1>=H9(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Du(n,11)}else if((t.K||n.g==t)&&G_(n),!Uy(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let d=s[e];if(n.V=d[0],d=d[1],n.H==2)if(d[0]=="c"){n.K=d[1],n.pa=d[2];const h=d[3];h!=null&&(n.ra=h,n.l.info("VER="+n.ra));const m=d[4];m!=null&&(n.Ga=m,n.l.info("SVER="+n.Ga));const p=d[5];p!=null&&typeof p=="number"&&0<p&&(r=1.5*p,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const v=t.g;if(v){const x=v.g?v.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(x){var i=r.i;i.g||x.indexOf("spdy")==-1&&x.indexOf("quic")==-1&&x.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(cA(i,i.h),i.h=null))}if(r.F){const b=v.g?v.g.getResponseHeader("X-HTTP-Session-Id"):null;b&&(r.Da=b,En(r.I,r.F,b))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=l8(r,r.J?r.pa:null,r.Y),o.K){q9(r.i,o);var l=o,c=r.L;c&&l.setTimeout(c),l.B&&(Gk(l),Y0(l)),r.g=o}else r8(r);0<n.j.length&&Xk(n)}else d[0]!="stop"&&d[0]!="close"||Du(n,7);else n.H==3&&(d[0]=="stop"||d[0]=="close"?d[0]=="stop"?Du(n,7):hA(n):d[0]!="noop"&&n.h&&n.h.Aa(d),n.A=0)}}Ky(4)}catch{}}function pde(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Ok(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function gde(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Ok(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function V9(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Ok(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=gde(t),r=pde(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var F9=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yde(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Ku(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ku){this.h=t.h,H_(this,t.j),this.s=t.s,this.g=t.g,q_(this,t.m),this.l=t.l;var e=t.i,n=new Qy;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),kD(this,n),this.o=t.o}else t&&(e=String(t).match(F9))?(this.h=!1,H_(this,e[1]||"",!0),this.s=fg(e[2]||""),this.g=fg(e[3]||"",!0),q_(this,e[4]),this.l=fg(e[5]||"",!0),kD(this,e[6]||"",!0),this.o=fg(e[7]||"")):(this.h=!1,this.i=new Qy(null,this.h))}Ku.prototype.toString=function(){var t=[],e=this.j;e&&t.push(mg(e,ND,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(mg(e,ND,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(mg(n,n.charAt(0)=="/"?bde:vde,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",mg(n,wde)),t.join("")};function el(t){return new Ku(t)}function H_(t,e,n){t.j=n?fg(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function q_(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function kD(t,e,n){e instanceof Qy?(t.i=e,kde(t.i,t.h)):(n||(e=mg(e,_de)),t.i=new Qy(e,t.h))}function En(t,e,n){t.i.set(e,n)}function Kk(t){return En(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function fg(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function mg(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,xde),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function xde(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var ND=/[#\/\?@]/g,vde=/[#\?:]/g,bde=/[#\?]/g,_de=/[#\?@]/g,wde=/#/g;function Qy(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function eu(t){t.g||(t.g=new Map,t.h=0,t.i&&yde(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}Me=Qy.prototype;Me.add=function(t,e){eu(this),this.i=null,t=Bm(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function $9(t,e){eu(t),e=Bm(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function B9(t,e){return eu(t),e=Bm(t,e),t.g.has(e)}Me.forEach=function(t,e){eu(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};Me.ta=function(){eu(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};Me.Z=function(t){eu(this);let e=[];if(typeof t=="string")B9(this,t)&&(e=e.concat(this.g.get(Bm(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};Me.set=function(t,e){return eu(this),this.i=null,t=Bm(this,t),B9(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};Me.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function z9(t,e,n){$9(t,e),0<n.length&&(t.i=null,t.g.set(Bm(t,e),Zj(n)),t.h+=n.length)}Me.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),t.push(s)}}return this.i=t.join("&")};function Bm(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function kde(t,e){e&&!t.j&&(eu(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&($9(this,r),z9(this,s,n))},t)),t.j=e}var Nde=class{constructor(t,e){this.g=t,this.map=e}};function U9(t){this.l=t||Ede,ht.PerformanceNavigationTiming?(t=ht.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ht.g&&ht.g.Ka&&ht.g.Ka()&&ht.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ede=10;function W9(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function H9(t){return t.h?1:t.g?t.g.size:0}function UT(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function cA(t,e){t.g?t.g.add(e):t.h=e}function q9(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}U9.prototype.cancel=function(){if(this.i=G9(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function G9(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Zj(t.i)}var Sde=class{stringify(t){return ht.JSON.stringify(t,void 0)}parse(t){return ht.JSON.parse(t,void 0)}};function Tde(){this.g=new Sde}function Cde(t,e,n){const r=n||"";try{V9(t,function(s,i){let o=s;Dk(s)&&(o=nA(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Ide(t,e){const n=new Uk;if(ht.Image){const r=new Image;r.onload=Tv(Iv,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Tv(Iv,n,r,"TestLoadImage: error",!1,e),r.onabort=Tv(Iv,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Tv(Iv,n,r,"TestLoadImage: timeout",!1,e),ht.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Iv(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function X0(t){this.l=t.fc||null,this.j=t.ob||!1}zr(X0,oA);X0.prototype.g=function(){return new Qk(this.l,this.j)};X0.prototype.i=function(t){return function(){return t}}({});function Qk(t,e){$r.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=uA,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zr(Qk,$r);var uA=0;Me=Qk.prototype;Me.open=function(t,e){if(this.readyState!=uA)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Zy(this)};Me.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ht).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};Me.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,J0(this)),this.readyState=uA};Me.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Zy(this)),this.g&&(this.readyState=3,Zy(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ht.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;K9(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function K9(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}Me.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?J0(this):Zy(this),this.readyState==3&&K9(this)}};Me.Za=function(t){this.g&&(this.response=this.responseText=t,J0(this))};Me.Ya=function(t){this.g&&(this.response=t,J0(this))};Me.ka=function(){this.g&&J0(this)};function J0(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Zy(t)}Me.setRequestHeader=function(t,e){this.v.append(t,e)};Me.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};Me.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Zy(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Qk.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var jde=ht.JSON.parse;function er(t){$r.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Q9,this.L=this.M=!1}zr(er,$r);var Q9="",Ade=/^https?$/i,Rde=["POST","PUT"];Me=er.prototype;Me.Oa=function(t){this.M=t};Me.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():FT.g(),this.C=this.u?wD(this.u):wD(FT),this.g.onreadystatechange=ps(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){ED(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=ht.FormData&&t instanceof ht.FormData,!(0<=f9(Rde,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{X9(this),0<this.B&&((this.L=Pde(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ps(this.ua,this)):this.A=iA(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){ED(this,i)}};function Pde(t){return om&&typeof t.timeout=="number"&&t.ontimeout!==void 0}Me.ua=function(){typeof Qj<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Yr(this,"timeout"),this.abort(8))};function ED(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Z9(t),Zk(t)}function Z9(t){t.F||(t.F=!0,Yr(t,"complete"),Yr(t,"error"))}Me.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Yr(this,"complete"),Yr(this,"abort"),Zk(this))};Me.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Zk(this,!0)),er.$.N.call(this)};Me.La=function(){this.s||(this.G||this.v||this.l?Y9(this):this.kb())};Me.kb=function(){Y9(this)};function Y9(t){if(t.h&&typeof Qj<"u"&&(!t.C[1]||Oo(t)!=4||t.da()!=2)){if(t.v&&Oo(t)==4)iA(t.La,0,t);else if(Yr(t,"readystatechange"),Oo(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var s=String(t.I).match(F9)[1]||null;!s&&ht.self&&ht.self.location&&(s=ht.self.location.protocol.slice(0,-1)),r=!Ade.test(s?s.toLowerCase():"")}n=r}if(n)Yr(t,"complete"),Yr(t,"success");else{t.m=6;try{var i=2<Oo(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",Z9(t)}}finally{Zk(t)}}}}function Zk(t,e){if(t.g){X9(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Yr(t,"ready");try{n.onreadystatechange=r}catch{}}}function X9(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ht.clearTimeout(t.A),t.A=null)}Me.isActive=function(){return!!this.g};function Oo(t){return t.g?t.g.readyState:0}Me.da=function(){try{return 2<Oo(this)?this.g.status:-1}catch{return-1}};Me.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};Me.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),jde(e)}};function SD(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Q9:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Lde(t){const e={};t=(t.g&&2<=Oo(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Uy(t[r]))continue;var n=ide(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}Yue(e,function(r){return r.join(", ")})}Me.Ia=function(){return this.m};Me.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function J9(t){let e="";return Xj(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function dA(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=J9(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):En(t,e,n))}function qp(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function e8(t){this.Ga=0,this.j=[],this.l=new Uk,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=qp("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=qp("baseRetryDelayMs",5e3,t),this.hb=qp("retryDelaySeedMs",1e4,t),this.eb=qp("forwardChannelMaxRetries",2,t),this.xa=qp("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new U9(t&&t.concurrentRequestLimit),this.Ja=new Tde,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}Me=e8.prototype;Me.ra=8;Me.H=1;function hA(t){if(t8(t),t.H==3){var e=t.W++,n=el(t.I);if(En(n,"SID",t.K),En(n,"RID",e),En(n,"TYPE","terminate"),ex(t,n),e=new Z0(t,t.l,e),e.L=2,e.v=Kk(el(n)),n=!1,ht.navigator&&ht.navigator.sendBeacon)try{n=ht.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&ht.Image&&(new Image().src=e.v,n=!0),n||(e.g=c8(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Y0(e)}a8(t)}function Yk(t){t.g&&(mA(t),t.g.cancel(),t.g=null)}function t8(t){Yk(t),t.u&&(ht.clearTimeout(t.u),t.u=null),G_(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ht.clearTimeout(t.m),t.m=null)}function Xk(t){if(!W9(t.i)&&!t.m){t.m=!0;var e=t.Na;Hy||N9(),qy||(Hy(),qy=!0),rA.add(e,t),t.C=0}}function Mde(t,e){return H9(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=K0(ps(t.Na,t,e),o8(t,t.C)),t.C++,!0)}Me.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new Z0(this,this.l,t);let i=this.s;if(this.U&&(i?(i=y9(i),x9(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=n8(this,s,e),n=el(this.I),En(n,"RID",t),En(n,"CVER",22),this.F&&En(n,"X-HTTP-Session-Id",this.F),ex(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(J9(i)))+"&"+e:this.o&&dA(n,this.o,i)),cA(this.i,s),this.bb&&En(n,"TYPE","init"),this.P?(En(n,"$req",e),En(n,"SID","null"),s.aa=!0,BT(s,n,null)):BT(s,n,e),this.H=2}}else this.H==3&&(t?TD(this,t):this.j.length==0||W9(this.i)||TD(this))};function TD(t,e){var n;e?n=e.m:n=t.W++;const r=el(t.I);En(r,"SID",t.K),En(r,"RID",n),En(r,"AID",t.V),ex(t,r),t.o&&t.s&&dA(r,t.o,t.s),n=new Z0(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=n8(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),cA(t.i,n),BT(n,r,e)}function ex(t,e){t.na&&Xj(t.na,function(n,r){En(e,r,n)}),t.h&&V9({},function(n,r){En(e,r,n)})}function n8(t,e,n){n=Math.min(t.j.length,n);var r=t.h?ps(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let l=!0;for(let c=0;c<n;c++){let d=s[c].g;const h=s[c].map;if(d-=i,0>d)i=Math.max(0,s[c].g-100),l=!1;else try{Cde(h,o,"req"+d+"_")}catch{r&&r(h)}}if(l){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function r8(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Hy||N9(),qy||(Hy(),qy=!0),rA.add(e,t),t.A=0}}function fA(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=K0(ps(t.Ma,t),o8(t,t.A)),t.A++,!0)}Me.Ma=function(){if(this.u=null,s8(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=K0(ps(this.jb,this),t)}};Me.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ts(10),Yk(this),s8(this))};function mA(t){t.B!=null&&(ht.clearTimeout(t.B),t.B=null)}function s8(t){t.g=new Z0(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=el(t.wa);En(e,"RID","rpc"),En(e,"SID",t.K),En(e,"AID",t.V),En(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&En(e,"TO",t.qa),En(e,"TYPE","xmlhttp"),ex(t,e),t.o&&t.s&&dA(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Kk(el(e)),n.s=null,n.S=!0,L9(n,t)}Me.ib=function(){this.v!=null&&(this.v=null,Yk(this),fA(this),Ts(19))};function G_(t){t.v!=null&&(ht.clearTimeout(t.v),t.v=null)}function i8(t,e){var n=null;if(t.g==e){G_(t),mA(t),t.g=null;var r=2}else if(UT(t.i,e))n=e.F,q9(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;r=Wk(),Yr(r,new j9(r,n)),Xk(t)}else r8(t);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&Mde(t,e)||r==2&&fA(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Du(t,5);break;case 4:Du(t,10);break;case 3:Du(t,6);break;default:Du(t,2)}}}function o8(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Du(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=ps(t.pb,t);n||(n=new Ku("//www.google.com/images/cleardot.gif"),ht.location&&ht.location.protocol=="http"||H_(n,"https"),Kk(n)),Ide(n.toString(),r)}else Ts(2);t.H=0,t.h&&t.h.za(e),a8(t),t8(t)}Me.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Ts(2)):(this.l.info("Failed to ping google.com"),Ts(1))};function a8(t){if(t.H=0,t.ma=[],t.h){const e=G9(t.i);(e.length!=0||t.j.length!=0)&&(yD(t.ma,e),yD(t.ma,t.j),t.i.i.length=0,Zj(t.j),t.j.length=0),t.h.ya()}}function l8(t,e,n){var r=n instanceof Ku?el(n):new Ku(n);if(r.g!="")e&&(r.g=e+"."+r.g),q_(r,r.m);else{var s=ht.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new Ku(null);r&&H_(i,r),e&&(i.g=e),s&&q_(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&En(r,n,e),En(r,"VER",t.ra),ex(t,r),r}function c8(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new er(new X0({ob:!0})):new er(t.va),e.Oa(t.J),e}Me.isActive=function(){return!!this.h&&this.h.isActive(this)};function u8(){}Me=u8.prototype;Me.Ba=function(){};Me.Aa=function(){};Me.za=function(){};Me.ya=function(){};Me.isActive=function(){return!0};Me.Va=function(){};function K_(){if(om&&!(10<=Number(Gue)))throw Error("Environmental error: no available transport.")}K_.prototype.g=function(t,e){return new xi(t,e)};function xi(t,e){$r.call(this),this.g=new e8(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Uy(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Uy(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new zm(this)}zr(xi,$r);xi.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Ts(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=l8(t,null,t.Y),Xk(t)};xi.prototype.close=function(){hA(this.g)};xi.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=nA(t),t=n);e.j.push(new Nde(e.fb++,t)),e.H==3&&Xk(e)};xi.prototype.N=function(){this.g.h=null,delete this.j,hA(this.g),delete this.g,xi.$.N.call(this)};function d8(t){aA.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}zr(d8,aA);function h8(){lA.call(this),this.status=1}zr(h8,lA);function zm(t){this.g=t}zr(zm,u8);zm.prototype.Ba=function(){Yr(this.g,"a")};zm.prototype.Aa=function(t){Yr(this.g,new d8(t))};zm.prototype.za=function(t){Yr(this.g,new h8)};zm.prototype.ya=function(){Yr(this.g,"b")};function Ode(){this.blockSize=-1}function wo(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}zr(wo,Ode);wo.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function tE(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],o=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}wo.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)tE(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){tE(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){tE(this,r),s=0;break}}this.h=s,this.i+=e};wo.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function sn(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var Dde={};function pA(t){return-128<=t&&128>t?Wue(t,function(e){return new sn([e|0],0>e?-1:0)}):new sn([t|0],0>t?-1:0)}function Do(t){if(isNaN(t)||!isFinite(t))return wf;if(0>t)return Kr(Do(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=WT;return new sn(e,0)}function f8(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Kr(f8(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Do(Math.pow(e,8)),r=wf,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+i),e);8>i?(i=Do(Math.pow(e,i)),r=r.R(i).add(Do(o))):(r=r.R(n),r=r.add(Do(o)))}return r}var WT=4294967296,wf=pA(0),HT=pA(1),CD=pA(16777216);Me=sn.prototype;Me.ea=function(){if(Mi(this))return-Kr(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:WT+r)*e,e*=WT}return t};Me.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Oa(this))return"0";if(Mi(this))return"-"+Kr(this).toString(t);for(var e=Do(Math.pow(t,6)),n=this,r="";;){var s=Z_(n,e).g;n=Q_(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,Oa(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};Me.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Oa(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Mi(t){return t.h==-1}Me.X=function(t){return t=Q_(this,t),Mi(t)?-1:Oa(t)?0:1};function Kr(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new sn(n,~t.h).add(HT)}Me.abs=function(){return Mi(this)?Kr(this):this};Me.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new sn(n,n[n.length-1]&-2147483648?-1:0)};function Q_(t,e){return t.add(Kr(e))}Me.R=function(t){if(Oa(this)||Oa(t))return wf;if(Mi(this))return Mi(t)?Kr(this).R(Kr(t)):Kr(Kr(this).R(t));if(Mi(t))return Kr(this.R(Kr(t)));if(0>this.X(CD)&&0>t.X(CD))return Do(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,l=t.D(s)>>>16,c=t.D(s)&65535;n[2*r+2*s]+=o*c,jv(n,2*r+2*s),n[2*r+2*s+1]+=i*c,jv(n,2*r+2*s+1),n[2*r+2*s+1]+=o*l,jv(n,2*r+2*s+1),n[2*r+2*s+2]+=i*l,jv(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new sn(n,0)};function jv(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Gp(t,e){this.g=t,this.h=e}function Z_(t,e){if(Oa(e))throw Error("division by zero");if(Oa(t))return new Gp(wf,wf);if(Mi(t))return e=Z_(Kr(t),e),new Gp(Kr(e.g),Kr(e.h));if(Mi(e))return e=Z_(t,Kr(e)),new Gp(Kr(e.g),e.h);if(30<t.g.length){if(Mi(t)||Mi(e))throw Error("slowDivide_ only works with positive integers.");for(var n=HT,r=e;0>=r.X(t);)n=ID(n),r=ID(r);var s=Ch(n,1),i=Ch(r,1);for(r=Ch(r,2),n=Ch(n,2);!Oa(r);){var o=i.add(r);0>=o.X(t)&&(s=s.add(n),i=o),r=Ch(r,1),n=Ch(n,1)}return e=Q_(t,s.R(e)),new Gp(s,e)}for(s=wf;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=Do(n),o=i.R(e);Mi(o)||0<o.X(t);)n-=r,i=Do(n),o=i.R(e);Oa(i)&&(i=HT),s=s.add(i),t=Q_(t,o)}return new Gp(s,t)}Me.gb=function(t){return Z_(this,t).h};Me.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new sn(n,this.h&t.h)};Me.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new sn(n,this.h|t.h)};Me.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new sn(n,this.h^t.h)};function ID(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new sn(n,t.h)}function Ch(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new sn(s,t.h)}K_.prototype.createWebChannel=K_.prototype.g;xi.prototype.send=xi.prototype.u;xi.prototype.open=xi.prototype.m;xi.prototype.close=xi.prototype.close;Hk.NO_ERROR=0;Hk.TIMEOUT=8;Hk.HTTP_ERROR=6;A9.COMPLETE="complete";R9.EventType=Q0;Q0.OPEN="a";Q0.CLOSE="b";Q0.ERROR="c";Q0.MESSAGE="d";$r.prototype.listen=$r.prototype.O;er.prototype.listenOnce=er.prototype.P;er.prototype.getLastError=er.prototype.Sa;er.prototype.getLastErrorCode=er.prototype.Ia;er.prototype.getStatus=er.prototype.da;er.prototype.getResponseJson=er.prototype.Wa;er.prototype.getResponseText=er.prototype.ja;er.prototype.send=er.prototype.ha;er.prototype.setWithCredentials=er.prototype.Oa;wo.prototype.digest=wo.prototype.l;wo.prototype.reset=wo.prototype.reset;wo.prototype.update=wo.prototype.j;sn.prototype.add=sn.prototype.add;sn.prototype.multiply=sn.prototype.R;sn.prototype.modulo=sn.prototype.gb;sn.prototype.compare=sn.prototype.X;sn.prototype.toNumber=sn.prototype.ea;sn.prototype.toString=sn.prototype.toString;sn.prototype.getBits=sn.prototype.D;sn.fromNumber=Do;sn.fromString=f8;var Vde=function(){return new K_},Fde=function(){return Wk()},nE=Hk,$de=A9,Bde=Wd,jD={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},zde=X0,Av=R9,Ude=er,Wde=wo,kf=sn;const AD="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let as=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};as.UNAUTHENTICATED=new as(null),as.GOOGLE_CREDENTIALS=new as("google-credentials-uid"),as.FIRST_PARTY=new as("first-party-uid"),as.MOCK_USER=new as("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Um="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wd=new Vue("@firebase/firestore");function RD(){return wd.logLevel}function Ke(t,...e){if(wd.logLevel<=Xt.DEBUG){const n=e.map(gA);wd.debug(`Firestore (${Um}): ${t}`,...n)}}function tl(t,...e){if(wd.logLevel<=Xt.ERROR){const n=e.map(gA);wd.error(`Firestore (${Um}): ${t}`,...n)}}function am(t,...e){if(wd.logLevel<=Xt.WARN){const n=e.map(gA);wd.warn(`Firestore (${Um}): ${t}`,...n)}}function gA(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t="Unexpected state"){const e=`FIRESTORE (${Um}) INTERNAL ASSERTION FAILED: `+t;throw tl(e),new Error(e)}function Tn(t,e){t||dt()}function wt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ye={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Je extends d9{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}let Hde=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(as.UNAUTHENTICATED))}shutdown(){}},qde=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}};class Gde{constructor(e){this.t=e,this.currentUser=as.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Qu;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Qu,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Qu)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Tn(typeof r.accessToken=="string"),new m8(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Tn(e===null||typeof e=="string"),new as(e)}}let Kde=class{constructor(e,n,r){this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=as.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}},Qde=class{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new Kde(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(as.FIRST_PARTY))}shutdown(){}invalidateToken(){}};class Zde{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}let Yde=class{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const r=i=>{i.error!=null&&Ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.T;return this.T=i.token,Ke("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.I.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.I.getImmediate({optional:!0});i?s(i):Ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Tn(typeof n.token=="string"),this.T=n.token,new Zde(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xde(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=Xde(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Zt(t,e){return t<e?-1:t>e?1:0}function lm(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Je(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Je(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Je(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Je(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Sr.fromMillis(Date.now())}static fromDate(e){return Sr.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Sr(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Zt(this.nanoseconds,e.nanoseconds):Zt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new mt(e)}static min(){return new mt(new Sr(0,0))}static max(){return new mt(new Sr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,n,r){n===void 0?n=0:n>e.length&&dt(),r===void 0?r=e.length-n:r>e.length-n&&dt(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Yy.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Yy?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ln extends Yy{construct(e,n,r){return new Ln(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Je(ye.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ln(n)}static emptyPath(){return new Ln([])}}const Jde=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hs extends Yy{construct(e,n,r){return new hs(e,n,r)}static isValidIdentifier(e){return Jde.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new hs(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Je(ye.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Je(ye.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Je(ye.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new Je(ye.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hs(n)}static emptyPath(){return new hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.path=e}static fromPath(e){return new et(Ln.fromString(e))}static fromName(e){return new et(Ln.fromString(e).popFirst(5))}static empty(){return new et(Ln.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ln.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ln.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new Ln(e.slice()))}}function ehe(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=mt.fromTimestamp(r===1e9?new Sr(n+1,0):new Sr(n,r));return new Oc(s,et.empty(),e)}function the(t){return new Oc(t.readTime,t.key,-1)}class Oc{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Oc(mt.min(),et.empty(),-1)}static max(){return new Oc(mt.max(),et.empty(),-1)}}function nhe(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=et.comparator(t.documentKey,e.documentKey),n!==0?n:Zt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rhe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class she{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tx(t){if(t.code!==ye.FAILED_PRECONDITION||t.message!==rhe)throw t;Ke("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new we((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof we?n:we.resolve(n)}catch(n){return we.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):we.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):we.reject(n)}static resolve(e){return new we((n,r)=>{n(e)})}static reject(e){return new we((n,r)=>{r(e)})}static waitFor(e){return new we((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=we.resolve(!1);for(const r of e)n=n.next(s=>s?we.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new we((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new we((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function nx(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>n.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}yA.ct=-1;function Jk(t){return t==null}function Y_(t){return t===0&&1/t==-1/0}function ihe(t){return typeof t=="number"&&Number.isInteger(t)&&!Y_(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Wm(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function g8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,n){this.comparator=e,this.root=n||kc.EMPTY}insert(e,n){return new Gn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,kc.BLACK,null,null))}remove(e){return new Gn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,kc.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rv(this.root,e,this.comparator,!0)}}let Rv=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},kc=class Ea{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ea.RED,this.left=s??Ea.EMPTY,this.right=i??Ea.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ea(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ea.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ea.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ea.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ea.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dt();const e=this.left.check();if(e!==this.right.check())throw dt();return e+(this.isRed()?0:1)}};kc.EMPTY=null,kc.RED=!0,kc.BLACK=!1;kc.EMPTY=new class{constructor(){this.size=0}get key(){throw dt()}get value(){throw dt()}get color(){throw dt()}get left(){throw dt()}get right(){throw dt()}copy(t,e,n,r,s){return this}insert(t,e,n){return new kc(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mi=class qT{constructor(e){this.comparator=e,this.data=new Gn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new LD(this.data.getIterator())}getIteratorFrom(e){return new LD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof qT)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new qT(this.comparator);return n.data=e,n}},LD=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rc=class GT{constructor(e){this.fields=e,e.sort(hs.comparator)}static empty(){return new GT([])}unionWith(e){let n=new mi(hs.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new GT(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return lm(this.fields,e.fields,(n,r)=>n.isEqual(r))}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let y8=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new y8("Invalid base64 string: "+s):s}}(e);return new xs(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new xs(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Zt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xs.EMPTY_BYTE_STRING=new xs("");const ohe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dc(t){if(Tn(!!t),typeof t=="string"){let e=0;const n=ohe.exec(t);if(Tn(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pr(t.seconds),nanos:pr(t.nanos)}}function pr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function kd(t){return typeof t=="string"?xs.fromBase64String(t):xs.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function vA(t){const e=t.mapValue.fields.__previous_value__;return xA(e)?vA(e):e}function Xy(t){const e=Dc(t.mapValue.fields.__local_write_time__.timestampValue);return new Sr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ahe{constructor(e,n,r,s,i,o,l,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}let x8=class KT{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new KT("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof KT&&e.projectId===this.projectId&&e.database===this.database}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv={mapValue:{}};function Nd(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xA(t)?4:lhe(t)?9007199254740991:10:dt()}function Yo(t,e){if(t===e)return!0;const n=Nd(t);if(n!==Nd(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xy(t).isEqual(Xy(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Dc(r.timestampValue),o=Dc(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return kd(r.bytesValue).isEqual(kd(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return pr(r.geoPointValue.latitude)===pr(s.geoPointValue.latitude)&&pr(r.geoPointValue.longitude)===pr(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return pr(r.integerValue)===pr(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=pr(r.doubleValue),o=pr(s.doubleValue);return i===o?Y_(i)===Y_(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return lm(t.arrayValue.values||[],e.arrayValue.values||[],Yo);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(PD(i)!==PD(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!Yo(i[l],o[l])))return!1;return!0}(t,e);default:return dt()}}function Jy(t,e){return(t.values||[]).find(n=>Yo(n,e))!==void 0}function cm(t,e){if(t===e)return 0;const n=Nd(t),r=Nd(e);if(n!==r)return Zt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Zt(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=pr(s.integerValue||s.doubleValue),l=pr(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return MD(t.timestampValue,e.timestampValue);case 4:return MD(Xy(t),Xy(e));case 5:return Zt(t.stringValue,e.stringValue);case 6:return function(s,i){const o=kd(s),l=kd(i);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=Zt(o[c],l[c]);if(d!==0)return d}return Zt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=Zt(pr(s.latitude),pr(i.latitude));return o!==0?o:Zt(pr(s.longitude),pr(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],l=i.values||[];for(let c=0;c<o.length&&c<l.length;++c){const d=cm(o[c],l[c]);if(d)return d}return Zt(o.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===Pv.mapValue&&i===Pv.mapValue)return 0;if(s===Pv.mapValue)return 1;if(i===Pv.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=i.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const m=Zt(l[h],d[h]);if(m!==0)return m;const p=cm(o[l[h]],c[d[h]]);if(p!==0)return p}return Zt(l.length,d.length)}(t.mapValue,e.mapValue);default:throw dt()}}function MD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Zt(t,e);const n=Dc(t),r=Dc(e),s=Zt(n.seconds,r.seconds);return s!==0?s:Zt(n.nanos,r.nanos)}function um(t){return QT(t)}function QT(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=Dc(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?kd(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,et.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=QT(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const l of s)o?o=!1:i+=",",i+=`${l}:${QT(r.fields[l])}`;return i+"}"}(t.mapValue):dt();var e,n}function ZT(t){return!!t&&"integerValue"in t}function bA(t){return!!t&&"arrayValue"in t}function OD(t){return!!t&&"nullValue"in t}function DD(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vb(t){return!!t&&"mapValue"in t}function qg(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Wm(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=qg(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=qg(t.arrayValue.values[n]);return e}return Object.assign({},t)}function lhe(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e){this.value=e}static empty(){return new Oi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!vb(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=qg(n)}setAll(e){let n=hs.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=qg(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());vb(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Yo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];vb(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Wm(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Oi(qg(this.value))}}function v8(t){const e=[];return Wm(t.fields,(n,r)=>{const s=new hs([n]);if(vb(r)){const i=v8(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new rc(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new us(e,0,mt.min(),mt.min(),mt.min(),Oi.empty(),0)}static newFoundDocument(e,n,r,s){return new us(e,1,n,mt.min(),r,s,0)}static newNoDocument(e,n){return new us(e,2,n,mt.min(),mt.min(),Oi.empty(),0)}static newUnknownDocument(e,n){return new us(e,3,n,mt.min(),mt.min(),Oi.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Oi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Oi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof us&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new us(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,n){this.position=e,this.inclusive=n}}function VD(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=et.comparator(et.fromName(o.referenceValue),n.key):r=cm(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function FD(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Yo(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,n="asc"){this.field=e,this.dir=n}}function che(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b8{}class kr extends b8{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new dhe(e,n,r):n==="array-contains"?new mhe(e,r):n==="in"?new phe(e,r):n==="not-in"?new ghe(e,r):n==="array-contains-any"?new yhe(e,r):new kr(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new hhe(e,r):new fhe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(cm(n,this.value)):n!==null&&Nd(this.value)===Nd(n)&&this.matchesComparison(cm(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Xo extends b8{constructor(e,n){super(),this.filters=e,this.op=n,this.lt=null}static create(e,n){return new Xo(e,n)}matches(e){return _8(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(n=>n.isInequality());return e!==null?e.field:null}ft(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function _8(t){return t.op==="and"}function w8(t){return uhe(t)&&_8(t)}function uhe(t){for(const e of t.filters)if(e instanceof Xo)return!1;return!0}function YT(t){if(t instanceof kr)return t.field.canonicalString()+t.op.toString()+um(t.value);if(w8(t))return t.filters.map(e=>YT(e)).join(",");{const e=t.filters.map(n=>YT(n)).join(",");return`${t.op}(${e})`}}function k8(t,e){return t instanceof kr?function(n,r){return r instanceof kr&&n.op===r.op&&n.field.isEqual(r.field)&&Yo(n.value,r.value)}(t,e):t instanceof Xo?function(n,r){return r instanceof Xo&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,i,o)=>s&&k8(i,r.filters[o]),!0):!1}(t,e):void dt()}function N8(t){return t instanceof kr?function(e){return`${e.field.canonicalString()} ${e.op} ${um(e.value)}`}(t):t instanceof Xo?function(e){return e.op.toString()+" {"+e.getFilters().map(N8).join(" ,")+"}"}(t):"Filter"}class dhe extends kr{constructor(e,n,r){super(e,n,r),this.key=et.fromName(r.referenceValue)}matches(e){const n=et.comparator(e.key,this.key);return this.matchesComparison(n)}}class hhe extends kr{constructor(e,n){super(e,"in",n),this.keys=E8("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class fhe extends kr{constructor(e,n){super(e,"not-in",n),this.keys=E8("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function E8(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>et.fromName(r.referenceValue))}class mhe extends kr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return bA(n)&&Jy(n.arrayValue,this.value)}}class phe extends kr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Jy(this.value.arrayValue,n)}}class ghe extends kr{constructor(e,n){super(e,"not-in",n)}matches(e){if(Jy(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Jy(this.value.arrayValue,n)}}class yhe extends kr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!bA(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Jy(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xhe{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.dt=null}}function $D(t,e=null,n=[],r=[],s=null,i=null,o=null){return new xhe(t,e,n,r,s,i,o)}function _A(t){const e=wt(t);if(e.dt===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>YT(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Jk(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>um(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>um(r)).join(",")),e.dt=n}return e.dt}function wA(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!che(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!k8(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!FD(t.startAt,e.startAt)&&FD(t.endAt,e.endAt)}function XT(t){return et.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.wt=null,this._t=null,this.startAt,this.endAt}}function vhe(t,e,n,r,s,i,o,l){return new e1(t,e,n,r,s,i,o,l)}function kA(t){return new e1(t)}function BD(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function bhe(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function _he(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function whe(t){return t.collectionGroup!==null}function Nf(t){const e=wt(t);if(e.wt===null){e.wt=[];const n=_he(e),r=bhe(e);if(n!==null&&r===null)n.isKeyField()||e.wt.push(new Gg(n)),e.wt.push(new Gg(hs.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.wt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Gg(hs.keyField(),i))}}}return e.wt}function nl(t){const e=wt(t);if(!e._t)if(e.limitType==="F")e._t=$D(e.path,e.collectionGroup,Nf(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Nf(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Gg(i.field,o))}const r=e.endAt?new X_(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new X_(e.startAt.position,e.startAt.inclusive):null;e._t=$D(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e._t}function JT(t,e,n){return new e1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function t1(t,e){return wA(nl(t),nl(e))&&t.limitType===e.limitType}function S8(t){return`${_A(nl(t))}|lt:${t.limitType}`}function eC(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>N8(r)).join(", ")}]`),Jk(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>um(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>um(r)).join(",")),`Target(${n})`}(nl(t))}; limitType=${t.limitType})`}function n1(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):et.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of Nf(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const l=VD(s,i,o);return s.inclusive?l<=0:l<0}(n.startAt,Nf(n),r)||n.endAt&&!function(s,i,o){const l=VD(s,i,o);return s.inclusive?l>=0:l>0}(n.endAt,Nf(n),r))}(t,e)}function khe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function T8(t){return(e,n)=>{let r=!1;for(const s of Nf(t)){const i=Nhe(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Nhe(t,e,n){const r=t.field.isKeyField()?et.comparator(e.key,n.key):function(s,i,o){const l=i.data.field(s),c=o.data.field(s);return l!==null&&c!==null?cm(l,c):dt()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return dt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Wm(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return g8(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ehe=new Gn(et.comparator);function rl(){return Ehe}const C8=new Gn(et.comparator);function pg(...t){let e=C8;for(const n of t)e=e.insert(n.key,n);return e}function I8(t){let e=C8;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Vu(){return Kg()}function j8(){return Kg()}function Kg(){return new Hm(t=>t.toString(),(t,e)=>t.isEqual(e))}const She=new Gn(et.comparator),The=new mi(et.comparator);function Ot(...t){let e=The;for(const n of t)e=e.add(n);return e}const Che=new mi(Zt);function Ihe(){return Che}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A8(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Y_(e)?"-0":e}}function R8(t){return{integerValue:""+t}}function jhe(t,e){return ihe(e)?R8(e):A8(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(){this._=void 0}}function Ahe(t,e,n){return t instanceof J_?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&xA(s)&&(s=vA(s)),s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof e0?L8(t,e):t instanceof t0?M8(t,e):function(r,s){const i=P8(r,s),o=zD(i)+zD(r.gt);return ZT(i)&&ZT(r.gt)?R8(o):A8(r.serializer,o)}(t,e)}function Rhe(t,e,n){return t instanceof e0?L8(t,e):t instanceof t0?M8(t,e):n}function P8(t,e){return t instanceof ew?ZT(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class J_ extends r1{}class e0 extends r1{constructor(e){super(),this.elements=e}}function L8(t,e){const n=O8(e);for(const r of t.elements)n.some(s=>Yo(s,r))||n.push(r);return{arrayValue:{values:n}}}class t0 extends r1{constructor(e){super(),this.elements=e}}function M8(t,e){let n=O8(e);for(const r of t.elements)n=n.filter(s=>!Yo(s,r));return{arrayValue:{values:n}}}class ew extends r1{constructor(e,n){super(),this.serializer=e,this.gt=n}}function zD(t){return pr(t.integerValue||t.doubleValue)}function O8(t){return bA(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Phe(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof e0&&r instanceof e0||n instanceof t0&&r instanceof t0?lm(n.elements,r.elements,Yo):n instanceof ew&&r instanceof ew?Yo(n.gt,r.gt):n instanceof J_&&r instanceof J_}(t.transform,e.transform)}class Lhe{constructor(e,n){this.version=e,this.transformResults=n}}class Ba{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ba}static exists(e){return new Ba(void 0,e)}static updateTime(e){return new Ba(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bb(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class s1{}function D8(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new F8(t.key,Ba.none()):new rx(t.key,t.data,Ba.none());{const n=t.data,r=Oi.empty();let s=new mi(hs.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Hd(t.key,r,new rc(s.toArray()),Ba.none())}}function Mhe(t,e,n){t instanceof rx?function(r,s,i){const o=r.value.clone(),l=WD(r.fieldTransforms,s,i.transformResults);o.setAll(l),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Hd?function(r,s,i){if(!bb(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=WD(r.fieldTransforms,s,i.transformResults),l=s.data;l.setAll(V8(r)),l.setAll(o),s.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function Qg(t,e,n,r){return t instanceof rx?function(s,i,o,l){if(!bb(s.precondition,i))return o;const c=s.value.clone(),d=HD(s.fieldTransforms,l,i);return c.setAll(d),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Hd?function(s,i,o,l){if(!bb(s.precondition,i))return o;const c=HD(s.fieldTransforms,l,i),d=i.data;return d.setAll(V8(s)),d.setAll(c),i.convertToFoundDocument(i.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,i,o){return bb(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function Ohe(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=P8(r.transform,s||null);i!=null&&(n===null&&(n=Oi.empty()),n.set(r.field,i))}return n||null}function UD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&lm(n,r,(s,i)=>Phe(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class rx extends s1{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Hd extends s1{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function V8(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function WD(t,e,n){const r=new Map;Tn(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,Rhe(o,l,n[s]))}return r}function HD(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Ahe(i,o,e))}return r}class F8 extends s1{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Dhe extends s1{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vhe{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Mhe(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Qg(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Qg(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=j8();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=D8(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(mt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ot())}isEqual(e){return this.batchId===e.batchId&&lm(this.mutations,e.mutations,(n,r)=>UD(n,r))&&lm(this.baseMutations,e.baseMutations,(n,r)=>UD(n,r))}}class NA{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Tn(e.mutations.length===r.length);let s=She;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new NA(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fhe{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $he{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fr,Bt;function Bhe(t){switch(t){default:return dt();case ye.CANCELLED:case ye.UNKNOWN:case ye.DEADLINE_EXCEEDED:case ye.RESOURCE_EXHAUSTED:case ye.INTERNAL:case ye.UNAVAILABLE:case ye.UNAUTHENTICATED:return!1;case ye.INVALID_ARGUMENT:case ye.NOT_FOUND:case ye.ALREADY_EXISTS:case ye.PERMISSION_DENIED:case ye.FAILED_PRECONDITION:case ye.ABORTED:case ye.OUT_OF_RANGE:case ye.UNIMPLEMENTED:case ye.DATA_LOSS:return!0}}function $8(t){if(t===void 0)return tl("GRPC error has no .code"),ye.UNKNOWN;switch(t){case fr.OK:return ye.OK;case fr.CANCELLED:return ye.CANCELLED;case fr.UNKNOWN:return ye.UNKNOWN;case fr.DEADLINE_EXCEEDED:return ye.DEADLINE_EXCEEDED;case fr.RESOURCE_EXHAUSTED:return ye.RESOURCE_EXHAUSTED;case fr.INTERNAL:return ye.INTERNAL;case fr.UNAVAILABLE:return ye.UNAVAILABLE;case fr.UNAUTHENTICATED:return ye.UNAUTHENTICATED;case fr.INVALID_ARGUMENT:return ye.INVALID_ARGUMENT;case fr.NOT_FOUND:return ye.NOT_FOUND;case fr.ALREADY_EXISTS:return ye.ALREADY_EXISTS;case fr.PERMISSION_DENIED:return ye.PERMISSION_DENIED;case fr.FAILED_PRECONDITION:return ye.FAILED_PRECONDITION;case fr.ABORTED:return ye.ABORTED;case fr.OUT_OF_RANGE:return ye.OUT_OF_RANGE;case fr.UNIMPLEMENTED:return ye.UNIMPLEMENTED;case fr.DATA_LOSS:return ye.DATA_LOSS;default:return dt()}}(Bt=fr||(fr={}))[Bt.OK=0]="OK",Bt[Bt.CANCELLED=1]="CANCELLED",Bt[Bt.UNKNOWN=2]="UNKNOWN",Bt[Bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Bt[Bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Bt[Bt.NOT_FOUND=5]="NOT_FOUND",Bt[Bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Bt[Bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Bt[Bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Bt[Bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Bt[Bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Bt[Bt.ABORTED=10]="ABORTED",Bt[Bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Bt[Bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Bt[Bt.INTERNAL=13]="INTERNAL",Bt[Bt.UNAVAILABLE=14]="UNAVAILABLE",Bt[Bt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Lv}static getOrCreateInstance(){return Lv===null&&(Lv=new EA),Lv}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let Lv=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zhe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uhe=new kf([4294967295,4294967295],0);function qD(t){const e=zhe().encode(t),n=new Wde;return n.update(e),new Uint8Array(n.digest())}function GD(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new kf([n,r],0),new kf([s,i],0)]}class SA{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new gg(`Invalid padding: ${n}`);if(r<0)throw new gg(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new gg(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new gg(`Invalid padding when bitmap length is 0: ${n}`);this.It=8*e.length-n,this.Tt=kf.fromNumber(this.It)}Et(e,n,r){let s=e.add(n.multiply(kf.fromNumber(r)));return s.compare(Uhe)===1&&(s=new kf([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const n=qD(e),[r,s]=GD(n);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);if(!this.At(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new SA(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.It===0)return;const n=qD(e),[r,s]=GD(n);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);this.Rt(o)}}Rt(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class gg extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,sx.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new i1(mt.min(),s,new Gn(Zt),rl(),Ot())}}class sx{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new sx(r,n,Ot(),Ot(),Ot())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,n,r,s){this.Pt=e,this.removedTargetIds=n,this.key=r,this.bt=s}}class B8{constructor(e,n){this.targetId=e,this.Vt=n}}class z8{constructor(e,n,r=xs.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class KD{constructor(){this.St=0,this.Dt=ZD(),this.Ct=xs.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Ot(),n=Ot(),r=Ot();return this.Dt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:dt()}}),new sx(this.Ct,this.xt,e,n,r)}Ft(){this.Nt=!1,this.Dt=ZD()}Bt(e,n){this.Nt=!0,this.Dt=this.Dt.insert(e,n)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Whe{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=rl(),this.zt=QD(),this.Wt=new Gn(Zt)}Ht(e){for(const n of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(n,e.bt):this.Yt(n,e.key,e.bt);for(const n of e.removedTargetIds)this.Yt(n,e.key,e.bt)}Xt(e){this.forEachTarget(e,n=>{const r=this.Zt(n);switch(e.state){case 0:this.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(n);break;case 3:this.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(n)&&(this.ee(n),r.$t(e.resumeToken));break;default:dt()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qt.forEach((r,s)=>{this.te(s)&&n(s)})}ne(e){var n;const r=e.targetId,s=e.Vt.count,i=this.se(r);if(i){const o=i.target;if(XT(o))if(s===0){const l=new et(o.path);this.Yt(r,l,us.newNoDocument(l,mt.min()))}else Tn(s===1);else{const l=this.ie(r);if(l!==s){const c=this.re(e,l);if(c!==0){this.ee(r);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,d)}(n=EA.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(d,h,m){var p,v,x,b,E,k;const _={localCacheCount:h,existenceFilterCount:m.count},S=m.unchangedNames;return S&&(_.bloomFilter={applied:d===0,hashCount:(p=S==null?void 0:S.hashCount)!==null&&p!==void 0?p:0,bitmapLength:(b=(x=(v=S==null?void 0:S.bits)===null||v===void 0?void 0:v.bitmap)===null||x===void 0?void 0:x.length)!==null&&b!==void 0?b:0,padding:(k=(E=S==null?void 0:S.bits)===null||E===void 0?void 0:E.padding)!==null&&k!==void 0?k:0}),_}(c,l,e.Vt))}}}}re(e,n){const{unchangedNames:r,count:s}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:i="",padding:o=0},hashCount:l=0}=r;let c,d;try{c=kd(i).toUint8Array()}catch(h){if(h instanceof y8)return am("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw h}try{d=new SA(c,o,l)}catch(h){return am(h instanceof gg?"BloomFilter error: ":"Applying bloom filter failed: ",h),1}return d.It===0?1:s!==n-this.oe(e.targetId,d)?2:0}oe(e,n){const r=this.Gt.getRemoteKeysForTarget(e);let s=0;return r.forEach(i=>{const o=this.Gt.ue(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;n.vt(l)||(this.Yt(e,i,null),s++)}),s}ce(e){const n=new Map;this.Qt.forEach((i,o)=>{const l=this.se(o);if(l){if(i.current&&XT(l.target)){const c=new et(l.target.path);this.jt.get(c)!==null||this.ae(o,c)||this.Yt(o,c,us.newNoDocument(c,e))}i.Mt&&(n.set(o,i.Ot()),i.Ft())}});let r=Ot();this.zt.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.se(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.jt.forEach((i,o)=>o.setReadTime(e));const s=new i1(e,n,this.Wt,this.jt,r);return this.jt=rl(),this.zt=QD(),this.Wt=new Gn(Zt),s}Jt(e,n){if(!this.te(e))return;const r=this.ae(e,n.key)?2:0;this.Zt(e).Bt(n.key,r),this.jt=this.jt.insert(n.key,n),this.zt=this.zt.insert(n.key,this.he(n.key).add(e))}Yt(e,n,r){if(!this.te(e))return;const s=this.Zt(e);this.ae(e,n)?s.Bt(n,1):s.Lt(n),this.zt=this.zt.insert(n,this.he(n).delete(e)),r&&(this.jt=this.jt.insert(n,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const n=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let n=this.Qt.get(e);return n||(n=new KD,this.Qt.set(e,n)),n}he(e){let n=this.zt.get(e);return n||(n=new mi(Zt),this.zt=this.zt.insert(e,n)),n}te(e){const n=this.se(e)!==null;return n||Ke("WatchChangeAggregator","Detected inactive target",e),n}se(e){const n=this.Qt.get(e);return n&&n.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new KD),this.Gt.getRemoteKeysForTarget(e).forEach(n=>{this.Yt(e,n,null)})}ae(e,n){return this.Gt.getRemoteKeysForTarget(e).has(n)}}function QD(){return new Gn(et.comparator)}function ZD(){return new Gn(et.comparator)}const Hhe={asc:"ASCENDING",desc:"DESCENDING"},qhe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ghe={and:"AND",or:"OR"};class Khe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function tC(t,e){return t.useProto3Json||Jk(e)?e:{value:e}}function tw(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function U8(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Qhe(t,e){return tw(t,e.toTimestamp())}function Uo(t){return Tn(!!t),mt.fromTimestamp(function(e){const n=Dc(e);return new Sr(n.seconds,n.nanos)}(t))}function TA(t,e){return function(n){return new Ln(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function W8(t){const e=Ln.fromString(t);return Tn(K8(e)),e}function nC(t,e){return TA(t.databaseId,e.path)}function rE(t,e){const n=W8(e);if(n.get(1)!==t.databaseId.projectId)throw new Je(ye.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Je(ye.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new et(H8(n))}function rC(t,e){return TA(t.databaseId,e)}function Zhe(t){const e=W8(t);return e.length===4?Ln.emptyPath():H8(e)}function sC(t){return new Ln(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function H8(t){return Tn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function YD(t,e,n){return{name:nC(t,e),fields:n.value.mapValue.fields}}function Yhe(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:dt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(Tn(d===void 0||typeof d=="string"),xs.fromBase64String(d||"")):(Tn(d===void 0||d instanceof Uint8Array),xs.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const d=c.code===void 0?ye.UNKNOWN:$8(c.code);return new Je(d,c.message||"")}(o);n=new z8(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=rE(t,r.document.name),i=Uo(r.document.updateTime),o=r.document.createTime?Uo(r.document.createTime):mt.min(),l=new Oi({mapValue:{fields:r.document.fields}}),c=us.newFoundDocument(s,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new _b(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=rE(t,r.document),i=r.readTime?Uo(r.readTime):mt.min(),o=us.newNoDocument(s,i),l=r.removedTargetIds||[];n=new _b([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=rE(t,r.document),i=r.removedTargetIds||[];n=new _b([],i,s,null)}else{if(!("filter"in e))return dt();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new $he(s,i),l=r.targetId;n=new B8(l,o)}}return n}function Xhe(t,e){let n;if(e instanceof rx)n={update:YD(t,e.key,e.value)};else if(e instanceof F8)n={delete:nC(t,e.key)};else if(e instanceof Hd)n={update:YD(t,e.key,e.data),updateMask:afe(e.fieldMask)};else{if(!(e instanceof Dhe))return dt();n={verify:nC(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof J_)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof e0)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof t0)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof ew)return{fieldPath:i.field.canonicalString(),increment:o.gt};throw dt()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:Qhe(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:dt()}(t,e.precondition)),n}function Jhe(t,e){return t&&t.length>0?(Tn(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?Uo(r.updateTime):Uo(s);return i.isEqual(mt.min())&&(i=Uo(s)),new Lhe(i,r.transformResults||[])}(n,e))):[]}function efe(t,e){return{documents:[rC(t,e.path)]}}function tfe(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=rC(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=rC(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length!==0)return G8(Xo.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(d=>function(h){return{field:Vh(h.field),direction:sfe(h.dir)}}(d))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=tC(t,e.limit);var l;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(l=e.startAt).inclusive,values:l.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function nfe(t){let e=Zhe(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Tn(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(h){const m=q8(h);return m instanceof Xo&&w8(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(h=>function(m){return new Gg(Fh(m.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(h)));let l=null;n.limit&&(l=function(h){let m;return m=typeof h=="object"?h.value:h,Jk(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(h){const m=!!h.before,p=h.values||[];return new X_(p,m)}(n.startAt));let d=null;return n.endAt&&(d=function(h){const m=!h.before,p=h.values||[];return new X_(p,m)}(n.endAt)),vhe(e,s,o,i,l,"F",c,d)}function rfe(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dt()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function q8(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=Fh(e.unaryFilter.field);return kr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Fh(e.unaryFilter.field);return kr.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Fh(e.unaryFilter.field);return kr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Fh(e.unaryFilter.field);return kr.create(i,"!=",{nullValue:"NULL_VALUE"});default:return dt()}}(t):t.fieldFilter!==void 0?function(e){return kr.create(Fh(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dt()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return Xo.create(e.compositeFilter.filters.map(n=>q8(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return dt()}}(e.compositeFilter.op))}(t):dt()}function sfe(t){return Hhe[t]}function ife(t){return qhe[t]}function ofe(t){return Ghe[t]}function Vh(t){return{fieldPath:t.canonicalString()}}function Fh(t){return hs.fromServerFormat(t.fieldPath)}function G8(t){return t instanceof kr?function(e){if(e.op==="=="){if(DD(e.value))return{unaryFilter:{field:Vh(e.field),op:"IS_NAN"}};if(OD(e.value))return{unaryFilter:{field:Vh(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(DD(e.value))return{unaryFilter:{field:Vh(e.field),op:"IS_NOT_NAN"}};if(OD(e.value))return{unaryFilter:{field:Vh(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vh(e.field),op:ife(e.op),value:e.value}}}(t):t instanceof Xo?function(e){const n=e.getFilters().map(r=>G8(r));return n.length===1?n[0]:{compositeFilter:{op:ofe(e.op),filters:n}}}(t):dt()}function afe(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function K8(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,n,r,s,i=mt.min(),o=mt.min(),l=xs.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new sc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new sc(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lfe{constructor(e){this.fe=e}}function cfe(t){const e=nfe({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?JT(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ufe{constructor(){this.rn=new dfe}addToCollectionParentIndex(e,n){return this.rn.add(n),we.resolve()}getCollectionParents(e,n){return we.resolve(this.rn.getEntries(n))}addFieldIndex(e,n){return we.resolve()}deleteFieldIndex(e,n){return we.resolve()}getDocumentsMatchingTarget(e,n){return we.resolve(null)}getIndexType(e,n){return we.resolve(0)}getFieldIndexes(e,n){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,n){return we.resolve(Oc.min())}getMinOffsetFromCollectionGroup(e,n){return we.resolve(Oc.min())}updateCollectionGroup(e,n,r){return we.resolve()}updateIndexEntries(e,n){return we.resolve()}}class dfe{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new mi(Ln.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new mi(Ln.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new dm(0)}static Mn(){return new dm(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hfe{constructor(){this.changes=new Hm(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,us.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?we.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ffe{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mfe{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Qg(r.mutation,s,rc.empty(),Sr.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ot()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ot()){const s=Vu();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=pg();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Vu();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ot()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=rl();const o=Kg(),l=Kg();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Hd)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Qg(h.mutation,d,h.mutation.getFieldMask(),Sr.now())):o.set(d.key,rc.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var m;return l.set(d,new ffe(h,(m=o.get(d))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Kg();let s=new Gn((o,l)=>o-l),i=Ot();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||rc.empty();h=l.applyToLocalView(d,h),r.set(c,h);const m=(s.get(l.batchId)||Ot()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,h=c.value,m=j8();h.forEach(p=>{if(!i.has(p)){const v=D8(n.get(p),r.get(p));v!==null&&m.set(p,v),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return we.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return et.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):whe(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):we.resolve(Vu());let l=-1,c=i;return o.next(d=>we.forEach(d,(h,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(h)?we.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,Ot())).next(h=>({batchId:l,changes:I8(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new et(n)).next(r=>{let s=pg();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=pg();return this.indexManager.getCollectionParents(e,s).next(o=>we.forEach(o,l=>{const c=function(d,h){return new e1(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(d=>{d.forEach((h,m)=>{i=i.insert(h,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s))).next(i=>{s.forEach((l,c)=>{const d=c.getKey();i.get(d)===null&&(i=i.insert(d,us.newInvalidDocument(d)))});let o=pg();return i.forEach((l,c)=>{const d=s.get(l);d!==void 0&&Qg(d.mutation,c,rc.empty(),Sr.now()),n1(n,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pfe{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,n){return we.resolve(this.cs.get(n))}saveBundleMetadata(e,n){var r;return this.cs.set(n.id,{id:(r=n).id,version:r.version,createTime:Uo(r.createTime)}),we.resolve()}getNamedQuery(e,n){return we.resolve(this.hs.get(n))}saveNamedQuery(e,n){return this.hs.set(n.name,function(r){return{name:r.name,query:cfe(r.bundledQuery),readTime:Uo(r.readTime)}}(n)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gfe{constructor(){this.overlays=new Gn(et.comparator),this.ls=new Map}getOverlay(e,n){return we.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Vu();return we.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.we(e,n,i)}),we.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.ls.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.ls.delete(r)),we.resolve()}getOverlaysForCollection(e,n,r){const s=Vu(),i=n.length+1,o=new et(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return we.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Gn((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Vu(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Vu(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return we.resolve(l)}we(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.ls.get(s.largestBatchId).delete(r.key);this.ls.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fhe(n,r));let i=this.ls.get(n);i===void 0&&(i=Ot(),this.ls.set(n,i)),this.ls.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.fs=new mi(Pr.ds),this.ws=new mi(Pr._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,n){const r=new Pr(e,n);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.ys(new Pr(e,n))}ps(e,n){e.forEach(r=>this.removeReference(r,n))}Is(e){const n=new et(new Ln([])),r=new Pr(n,e),s=new Pr(n,e+1),i=[];return this.ws.forEachInRange([r,s],o=>{this.ys(o),i.push(o.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const n=new et(new Ln([])),r=new Pr(n,e),s=new Pr(n,e+1);let i=Ot();return this.ws.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Pr(e,0),r=this.fs.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Pr{constructor(e,n){this.key=e,this.As=n}static ds(e,n){return et.comparator(e.key,n.key)||Zt(e.As,n.As)}static _s(e,n){return Zt(e.As,n.As)||et.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yfe{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new mi(Pr.ds)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Vhe(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Rs=this.Rs.add(new Pr(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return we.resolve(o)}lookupMutationBatch(e,n){return we.resolve(this.Ps(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.bs(r),i=s<0?0:s;return we.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Pr(n,0),s=new Pr(n,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([r,s],o=>{const l=this.Ps(o.As);i.push(l)}),we.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new mi(Zt);return n.forEach(s=>{const i=new Pr(s,0),o=new Pr(s,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([i,o],l=>{r=r.add(l.As)})}),we.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;et.isDocumentKey(i)||(i=i.child(""));const o=new Pr(new et(i),0);let l=new mi(Zt);return this.Rs.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(c.As)),!0)},o),we.resolve(this.Vs(l))}Vs(e){const n=[];return e.forEach(r=>{const s=this.Ps(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Tn(this.Ss(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return we.forEach(n.mutations,s=>{const i=new Pr(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,n){const r=new Pr(n,0),s=this.Rs.firstAfterOrEqual(r);return we.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}Ss(e,n){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const n=this.bs(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xfe{constructor(e){this.Ds=e,this.docs=new Gn(et.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Ds(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return we.resolve(r?r.document.mutableCopy():us.newInvalidDocument(n))}getEntries(e,n){let r=rl();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():us.newInvalidDocument(s))}),we.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=rl();const o=n.path,l=new et(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||nhe(the(h),r)<=0||(s.has(h.key)||n1(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return we.resolve(i)}getAllFromCollectionGroup(e,n,r,s){dt()}Cs(e,n){return we.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new vfe(this)}getSize(e){return we.resolve(this.size)}}class vfe extends hfe{constructor(e){super(),this.os=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.os.addEntry(e,s)):this.os.removeEntry(r)}),we.waitFor(n)}getFromCache(e,n){return this.os.getEntry(e,n)}getAllFromCache(e,n){return this.os.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bfe{constructor(e){this.persistence=e,this.xs=new Hm(n=>_A(n),wA),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.Ns=0,this.ks=new CA,this.targetCount=0,this.Ms=dm.kn()}forEachTarget(e,n){return this.xs.forEach((r,s)=>n(s)),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Ns&&(this.Ns=n),we.resolve()}Fn(e){this.xs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Ms=new dm(n),this.highestTargetId=n),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,n){return this.Fn(n),this.targetCount+=1,we.resolve()}updateTargetData(e,n){return this.Fn(n),we.resolve()}removeTargetData(e,n){return this.xs.delete(n.target),this.ks.Is(n.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.xs.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.xs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),we.waitFor(i).next(()=>s)}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,n){const r=this.xs.get(n)||null;return we.resolve(r)}addMatchingKeys(e,n,r){return this.ks.gs(n,r),we.resolve()}removeMatchingKeys(e,n,r){this.ks.ps(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),we.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ks.Is(n),we.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ks.Es(n);return we.resolve(r)}containsKey(e,n){return we.resolve(this.ks.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _fe{constructor(e,n){this.$s={},this.overlays={},this.Os=new yA(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new bfe(this),this.indexManager=new ufe,this.remoteDocumentCache=function(r){return new xfe(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new lfe(n),this.qs=new pfe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new gfe,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.$s[e.toKey()];return r||(r=new yfe(n,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,n,r){Ke("MemoryPersistence","Starting transaction:",e);const s=new wfe(this.Os.next());return this.referenceDelegate.Us(),r(s).next(i=>this.referenceDelegate.Ks(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gs(e,n){return we.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,n)))}}class wfe extends she{constructor(e){super(),this.currentSequenceNumber=e}}class IA{constructor(e){this.persistence=e,this.Qs=new CA,this.js=null}static zs(e){return new IA(e)}get Ws(){if(this.js)return this.js;throw dt()}addReference(e,n,r){return this.Qs.addReference(r,n),this.Ws.delete(r.toString()),we.resolve()}removeReference(e,n,r){return this.Qs.removeReference(r,n),this.Ws.add(r.toString()),we.resolve()}markPotentiallyOrphaned(e,n){return this.Ws.add(n.toString()),we.resolve()}removeTarget(e,n){this.Qs.Is(n.targetId).forEach(s=>this.Ws.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Ws.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Us(){this.js=new Set}Ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.Ws,r=>{const s=et.fromPath(r);return this.Hs(e,s).next(i=>{i||n.removeEntry(s,mt.min())})}).next(()=>(this.js=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hs(e,n).next(r=>{r?this.Ws.delete(n.toString()):this.Ws.add(n.toString())})}Ls(e){return 0}Hs(e,n){return we.or([()=>we.resolve(this.Qs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gs(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Fi=r,this.Bi=s}static Li(e,n){let r=Ot(),s=Ot();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new jA(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kfe{constructor(){this.qi=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.qi=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ki(e,n).next(i=>i||this.Gi(e,n,s,r)).next(i=>i||this.Qi(e,n))}Ki(e,n){if(BD(n))return we.resolve(null);let r=nl(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=JT(n,null,"F"),r=nl(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ot(...i);return this.Ui.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ji(n,l);return this.zi(n,d,o,c.readTime)?this.Ki(e,JT(n,null,"F")):this.Wi(e,d,n,c)}))})))}Gi(e,n,r,s){return BD(n)||s.isEqual(mt.min())?this.Qi(e,n):this.Ui.getDocuments(e,r).next(i=>{const o=this.ji(n,i);return this.zi(n,o,r,s)?this.Qi(e,n):(RD()<=Xt.DEBUG&&Ke("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),eC(n)),this.Wi(e,o,n,ehe(s,-1)))})}ji(e,n){let r=new mi(T8(e));return n.forEach((s,i)=>{n1(e,i)&&(r=r.add(i))}),r}zi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Qi(e,n){return RD()<=Xt.DEBUG&&Ke("QueryEngine","Using full collection scan to execute query:",eC(n)),this.Ui.getDocumentsMatchingQuery(e,n,Oc.min())}Wi(e,n,r,s){return this.Ui.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nfe{constructor(e,n,r,s){this.persistence=e,this.Hi=n,this.serializer=s,this.Ji=new Gn(Zt),this.Yi=new Hm(i=>_A(i),wA),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mfe(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function Efe(t,e,n,r){return new Nfe(t,e,n,r)}async function Q8(t,e){const n=wt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.tr(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Ot();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({er:d,removedBatchIds:o,addedBatchIds:l}))})})}function Sfe(t,e){const n=wt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const h=c.batch,m=h.keys();let p=we.resolve();return m.forEach(v=>{p=p.next(()=>d.getEntry(l,v)).next(x=>{const b=c.docVersions.get(v);Tn(b!==null),x.version.compareTo(b)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let l=Ot();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Z8(t){const e=wt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Bs.getLastRemoteSnapshotVersion(n))}function Tfe(t,e){const n=wt(t),r=e.snapshotVersion;let s=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Zi.newChangeBuffer({trackRemovals:!0});s=n.Ji;const l=[];e.targetChanges.forEach((h,m)=>{const p=s.get(m);if(!p)return;l.push(n.Bs.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.Bs.addMatchingKeys(i,h.addedDocuments,m)));let v=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(xs.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(m,v),function(x,b,E){return x.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(p,v,h)&&l.push(n.Bs.updateTargetData(i,v))});let c=rl(),d=Ot();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(Cfe(i,o,e.documentUpdates).next(h=>{c=h.nr,d=h.sr})),!r.isEqual(mt.min())){const h=n.Bs.getLastRemoteSnapshotVersion(i).next(m=>n.Bs.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return we.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.Ji=s,i))}function Cfe(t,e,n){let r=Ot(),s=Ot();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=rl();return n.forEach((l,c)=>{const d=i.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(mt.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ke("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{nr:o,sr:s}})}function Ife(t,e){const n=wt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function jfe(t,e){const n=wt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Bs.getTargetData(r,e).next(i=>i?(s=i,we.resolve(s)):n.Bs.allocateTargetId(r).next(o=>(s=new sc(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Bs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ji.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(e,r.targetId)),r})}async function iC(t,e,n){const r=wt(t),s=r.Ji.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!nx(o))throw o;Ke("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(s.target)}function XD(t,e,n){const r=wt(t);let s=mt.min(),i=Ot();return r.persistence.runTransaction("Execute query","readonly",o=>function(l,c,d){const h=wt(l),m=h.Yi.get(d);return m!==void 0?we.resolve(h.Ji.get(m)):h.Bs.getTargetData(c,d)}(r,o,nl(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,n?s:mt.min(),n?i:Ot())).next(l=>(Afe(r,khe(e),l),{documents:l,ir:i})))}function Afe(t,e,n){let r=t.Xi.get(e)||mt.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Xi.set(e,r)}class JD{constructor(){this.activeTargetIds=Ihe()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rfe{constructor(){this.Hr=new JD,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,n,r){this.Jr[e]=n}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new JD,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pfe{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Ke("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Ke("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mv=null;function sE(){return Mv===null?Mv=268435456+Math.round(2147483648*Math.random()):Mv++,"0x"+Mv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lfe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mfe{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="WebChannelConnection";class Ofe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.mo=n+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,n,r,s,i){const o=sE(),l=this.To(e,n);Ke("RestConnection",`Sending RPC '${e}' ${o}:`,l,r);const c={};return this.Eo(c,s,i),this.Ao(e,l,c,r).then(d=>(Ke("RestConnection",`Received RPC '${e}' ${o}: `,d),d),d=>{throw am("RestConnection",`RPC '${e}' ${o} failed with error: `,d,"url: ",l,"request:",r),d})}vo(e,n,r,s,i,o){return this.Io(e,n,r,s,i)}Eo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Um,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}To(e,n){const r=Lfe[e];return`${this.mo}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,n,r,s){const i=sE();return new Promise((o,l)=>{const c=new Ude;c.setWithCredentials(!0),c.listenOnce($de.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case nE.NO_ERROR:const h=c.getResponseJson();Ke(ss,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case nE.TIMEOUT:Ke(ss,`RPC '${e}' ${i} timed out`),l(new Je(ye.DEADLINE_EXCEEDED,"Request time out"));break;case nE.HTTP_ERROR:const m=c.getStatus();if(Ke(ss,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p==null?void 0:p.error;if(v&&v.status&&v.message){const x=function(b){const E=b.toLowerCase().replace(/_/g,"-");return Object.values(ye).indexOf(E)>=0?E:ye.UNKNOWN}(v.status);l(new Je(x,v.message))}else l(new Je(ye.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Je(ye.UNAVAILABLE,"Connection failed."));break;default:dt()}}finally{Ke(ss,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);Ke(ss,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",d,r,15)})}Ro(e,n,r){const s=sE(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Vde(),l=Fde(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.xmlHttpFactory=new zde({})),this.Eo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=i.join("");Ke(ss,`Creating RPC '${e}' stream ${s}: ${h}`,c);const m=o.createWebChannel(h,c);let p=!1,v=!1;const x=new Mfe({ro:E=>{v?Ke(ss,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(p||(Ke(ss,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),Ke(ss,`RPC '${e}' stream ${s} sending:`,E),m.send(E))},oo:()=>m.close()}),b=(E,k,_)=>{E.listen(k,S=>{try{_(S)}catch(T){setTimeout(()=>{throw T},0)}})};return b(m,Av.EventType.OPEN,()=>{v||Ke(ss,`RPC '${e}' stream ${s} transport opened.`)}),b(m,Av.EventType.CLOSE,()=>{v||(v=!0,Ke(ss,`RPC '${e}' stream ${s} transport closed`),x.wo())}),b(m,Av.EventType.ERROR,E=>{v||(v=!0,am(ss,`RPC '${e}' stream ${s} transport errored:`,E),x.wo(new Je(ye.UNAVAILABLE,"The operation could not be completed")))}),b(m,Av.EventType.MESSAGE,E=>{var k;if(!v){const _=E.data[0];Tn(!!_);const S=_,T=S.error||((k=S[0])===null||k===void 0?void 0:k.error);if(T){Ke(ss,`RPC '${e}' stream ${s} received error:`,T);const P=T.status;let j=function(I){const O=fr[I];if(O!==void 0)return $8(O)}(P),R=T.message;j===void 0&&(j=ye.INTERNAL,R="Unknown error status: "+P+" with message "+T.message),v=!0,x.wo(new Je(j,R)),m.close()}else Ke(ss,`RPC '${e}' stream ${s} received:`,_),x._o(_)}}),b(l,Bde.STAT_EVENT,E=>{E.stat===jD.PROXY?Ke(ss,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===jD.NOPROXY&&Ke(ss,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.fo()},0),x}}function iE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o1(t){return new Khe(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y8{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ii=e,this.timerId=n,this.Po=r,this.bo=s,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),s=Math.max(0,n-r);s>0&&Ke("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.So} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(e,n,r,s,i,o,l,c){this.ii=e,this.$o=r,this.Oo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Y8(e,n)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,n){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():n&&n.code===ye.RESOURCE_EXHAUSTED?(tl(n.toString()),tl("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===ye.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(n)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Fo===n&&this.Zo(r,s)},r=>{e(()=>{const s=new Je(ye.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(s)})})}Zo(e,n){const r=this.Xo(this.Fo);this.stream=this.eu(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(s=>{r(()=>this.tu(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return Ke("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.Fo===e?n():(Ke("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Dfe extends X8{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}eu(e,n){return this.connection.Ro("Listen",e,n)}onMessage(e){this.qo.reset();const n=Yhe(this.serializer,e),r=function(s){if(!("targetChange"in s))return mt.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?mt.min():i.readTime?Uo(i.readTime):mt.min()}(e);return this.listener.nu(n,r)}su(e){const n={};n.database=sC(this.serializer),n.addTarget=function(s,i){let o;const l=i.target;if(o=XT(l)?{documents:efe(s,l)}:{query:tfe(s,l)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=U8(s,i.resumeToken);const c=tC(s,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(mt.min())>0){o.readTime=tw(s,i.snapshotVersion.toTimestamp());const c=tC(s,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const r=rfe(this.serializer,e);r&&(n.labels=r),this.Wo(n)}iu(e){const n={};n.database=sC(this.serializer),n.removeTarget=e,this.Wo(n)}}class Vfe extends X8{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,n){return this.connection.Ro("Write",e,n)}onMessage(e){if(Tn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const n=Jhe(e.writeResults,e.commitTime),r=Uo(e.commitTime);return this.listener.cu(r,n)}return Tn(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=sC(this.serializer),this.Wo(e)}uu(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Xhe(this.serializer,r))};this.Wo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ffe extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.lu=!1}fu(){if(this.lu)throw new Je(ye.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Io(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Je(ye.UNKNOWN,s.toString())})}vo(e,n,r,s){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.vo(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Je(ye.UNKNOWN,i.toString())})}terminate(){this.lu=!0}}class $fe{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(tl(n),this.mu=!1):Ke("OnlineStateTracker",n)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bfe{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(o=>{r.enqueueAndForget(async()=>{qd(this)&&(Ke("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=wt(l);c.vu.add(4),await ix(c),c.bu.set("Unknown"),c.vu.delete(4),await a1(c)}(this))})}),this.bu=new $fe(r,s)}}async function a1(t){if(qd(t))for(const e of t.Ru)await e(!0)}async function ix(t){for(const e of t.Ru)await e(!1)}function J8(t,e){const n=wt(t);n.Au.has(e.targetId)||(n.Au.set(e.targetId,e),PA(n)?RA(n):qm(n).Ko()&&AA(n,e))}function e7(t,e){const n=wt(t),r=qm(n);n.Au.delete(e),r.Ko()&&t7(n,e),n.Au.size===0&&(r.Ko()?r.jo():qd(n)&&n.bu.set("Unknown"))}function AA(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qm(t).su(e)}function t7(t,e){t.Vu.qt(e),qm(t).iu(e)}function RA(t){t.Vu=new Whe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),qm(t).start(),t.bu.gu()}function PA(t){return qd(t)&&!qm(t).Uo()&&t.Au.size>0}function qd(t){return wt(t).vu.size===0}function n7(t){t.Vu=void 0}async function zfe(t){t.Au.forEach((e,n)=>{AA(t,e)})}async function Ufe(t,e){n7(t),PA(t)?(t.bu.Iu(e),RA(t)):t.bu.set("Unknown")}async function Wfe(t,e,n){if(t.bu.set("Online"),e instanceof z8&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.Au.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.Au.delete(o),r.Vu.removeTarget(o))}(t,e)}catch(r){Ke("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await nw(t,r)}else if(e instanceof _b?t.Vu.Ht(e):e instanceof B8?t.Vu.ne(e):t.Vu.Xt(e),!n.isEqual(mt.min()))try{const r=await Z8(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.Vu.ce(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.Au.get(c);d&&s.Au.set(c,d.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const d=s.Au.get(l);if(!d)return;s.Au.set(l,d.withResumeToken(xs.EMPTY_BYTE_STRING,d.snapshotVersion)),t7(s,l);const h=new sc(d.target,l,c,d.sequenceNumber);AA(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){Ke("RemoteStore","Failed to raise snapshot:",r),await nw(t,r)}}async function nw(t,e,n){if(!nx(e))throw e;t.vu.add(1),await ix(t),t.bu.set("Offline"),n||(n=()=>Z8(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ke("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await a1(t)})}function r7(t,e){return e().catch(n=>nw(t,n,e))}async function l1(t){const e=wt(t),n=Vc(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;Hfe(e);)try{const s=await Ife(e.localStore,r);if(s===null){e.Eu.length===0&&n.jo();break}r=s.batchId,qfe(e,s)}catch(s){await nw(e,s)}s7(e)&&i7(e)}function Hfe(t){return qd(t)&&t.Eu.length<10}function qfe(t,e){t.Eu.push(e);const n=Vc(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function s7(t){return qd(t)&&!Vc(t).Uo()&&t.Eu.length>0}function i7(t){Vc(t).start()}async function Gfe(t){Vc(t).hu()}async function Kfe(t){const e=Vc(t);for(const n of t.Eu)e.uu(n.mutations)}async function Qfe(t,e,n){const r=t.Eu.shift(),s=NA.from(r,e,n);await r7(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await l1(t)}async function Zfe(t,e){e&&Vc(t).ou&&await async function(n,r){if(s=r.code,Bhe(s)&&s!==ye.ABORTED){const i=n.Eu.shift();Vc(n).Qo(),await r7(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await l1(n)}var s}(t,e),s7(t)&&i7(t)}async function t4(t,e){const n=wt(t);n.asyncQueue.verifyOperationInProgress(),Ke("RemoteStore","RemoteStore received new credentials");const r=qd(n);n.vu.add(3),await ix(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await a1(n)}async function Yfe(t,e){const n=wt(t);e?(n.vu.delete(2),await a1(n)):e||(n.vu.add(2),await ix(n),n.bu.set("Unknown"))}function qm(t){return t.Su||(t.Su=function(e,n,r){const s=wt(e);return s.fu(),new Dfe(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{uo:zfe.bind(null,t),ao:Ufe.bind(null,t),nu:Wfe.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),PA(t)?RA(t):t.bu.set("Unknown")):(await t.Su.stop(),n7(t))})),t.Su}function Vc(t){return t.Du||(t.Du=function(e,n,r){const s=wt(e);return s.fu(),new Vfe(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{uo:Gfe.bind(null,t),ao:Zfe.bind(null,t),au:Kfe.bind(null,t),cu:Qfe.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await l1(t)):(await t.Du.stop(),t.Eu.length>0&&(Ke("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Qu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new LA(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Je(ye.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function MA(t,e){if(tl("AsyncQueue",`${e}: ${t}`),nx(t))return new Je(ye.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e){this.comparator=e?(n,r)=>e(n,r)||et.comparator(n.key,r.key):(n,r)=>et.comparator(n.key,r.key),this.keyedMap=pg(),this.sortedSet=new Gn(this.comparator)}static emptySet(e){return new Ef(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ef)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ef;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(){this.Cu=new Gn(et.comparator)}track(e){const n=e.doc.key,r=this.Cu.get(n);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(n,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(n):e.type===1&&r.type===2?this.Cu=this.Cu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):dt():this.Cu=this.Cu.insert(n,e)}xu(){const e=[];return this.Cu.inorderTraversal((n,r)=>{e.push(r)}),e}}class hm{constructor(e,n,r,s,i,o,l,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new hm(e,n,Ef.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&t1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xfe{constructor(){this.Nu=void 0,this.listeners=[]}}class Jfe{constructor(){this.queries=new Hm(e=>S8(e),t1),this.onlineState="Unknown",this.ku=new Set}}async function eme(t,e){const n=wt(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new Xfe),s)try{i.Nu=await n.onListen(r)}catch(o){const l=MA(o,`Initialization of query '${eC(e.query)}' failed`);return void e.onError(l)}n.queries.set(r,i),i.listeners.push(e),e.Mu(n.onlineState),i.Nu&&e.$u(i.Nu)&&OA(n)}async function tme(t,e){const n=wt(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function nme(t,e){const n=wt(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.listeners)l.$u(s)&&(r=!0);o.Nu=s}}r&&OA(n)}function rme(t,e,n){const r=wt(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function OA(t){t.ku.forEach(e=>{e.next()})}class sme{constructor(e,n,r){this.query=e,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new hm(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),n=!0):this.qu(e,this.onlineState)&&(this.Uu(e),n=!0),this.Bu=e,n}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let n=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),n=!0),n}qu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const n=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Uu(e){e=hm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o7{constructor(e){this.key=e}}class a7{constructor(e){this.key=e}}class ime{constructor(e,n){this.query=e,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Ot(),this.mutatedKeys=Ot(),this.tc=T8(e),this.ec=new Ef(this.tc)}get nc(){return this.Yu}sc(e,n){const r=n?n.ic:new n4,s=n?n.ec:this.ec;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const p=s.get(h),v=n1(this.query,m)?m:null,x=!!p&&this.mutatedKeys.has(p.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let E=!1;p&&v?p.data.isEqual(v.data)?x!==b&&(r.track({type:3,doc:v}),E=!0):this.rc(p,v)||(r.track({type:2,doc:v}),E=!0,(c&&this.tc(v,c)>0||d&&this.tc(v,d)<0)&&(l=!0)):!p&&v?(r.track({type:0,doc:v}),E=!0):p&&!v&&(r.track({type:1,doc:p}),E=!0,(c||d)&&(l=!0)),E&&(v?(o=o.add(v),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{ec:o,ic:r,zi:l,mutatedKeys:i}}rc(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((d,h)=>function(m,p){const v=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt()}};return v(m)-v(p)}(d.type,h.type)||this.tc(d.doc,h.doc)),this.oc(r);const o=n?this.uc():[],l=this.Zu.size===0&&this.current?1:0,c=l!==this.Xu;return this.Xu=l,i.length!==0||c?{snapshot:new hm(this.query,e.ec,s,i,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new n4,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(n=>this.Yu=this.Yu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Yu=this.Yu.delete(n)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Ot(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const n=[];return e.forEach(r=>{this.Zu.has(r)||n.push(new a7(r))}),this.Zu.forEach(r=>{e.has(r)||n.push(new o7(r))}),n}hc(e){this.Yu=e.ir,this.Zu=Ot();const n=this.sc(e.documents);return this.applyChanges(n,!0)}lc(){return hm.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class ome{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ame{constructor(e){this.key=e,this.fc=!1}}class lme{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Hm(l=>S8(l),t1),this._c=new Map,this.mc=new Set,this.gc=new Gn(et.comparator),this.yc=new Map,this.Ic=new CA,this.Tc={},this.Ec=new Map,this.Ac=dm.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function cme(t,e){const n=vme(t);let r,s;const i=n.wc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.lc();else{const o=await jfe(n.localStore,nl(e)),l=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await ume(n,e,r,l==="current",o.resumeToken),n.isPrimaryClient&&J8(n.remoteStore,o)}return s}async function ume(t,e,n,r,s){t.Rc=(m,p,v)=>async function(x,b,E,k){let _=b.view.sc(E);_.zi&&(_=await XD(x.localStore,b.query,!1).then(({documents:P})=>b.view.sc(P,_)));const S=k&&k.targetChanges.get(b.targetId),T=b.view.applyChanges(_,x.isPrimaryClient,S);return s4(x,b.targetId,T.cc),T.snapshot}(t,m,p,v);const i=await XD(t.localStore,e,!0),o=new ime(e,i.ir),l=o.sc(i.documents),c=sx.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,c);s4(t,n,d.cc);const h=new ome(e,n,o);return t.wc.set(e,h),t._c.has(n)?t._c.get(n).push(e):t._c.set(n,[e]),d.snapshot}async function dme(t,e){const n=wt(t),r=n.wc.get(e),s=n._c.get(r.targetId);if(s.length>1)return n._c.set(r.targetId,s.filter(i=>!t1(i,e))),void n.wc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await iC(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),e7(n.remoteStore,r.targetId),oC(n,r.targetId)}).catch(tx)):(oC(n,r.targetId),await iC(n.localStore,r.targetId,!0))}async function hme(t,e,n){const r=bme(t);try{const s=await function(i,o){const l=wt(i),c=Sr.now(),d=o.reduce((p,v)=>p.add(v.key),Ot());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=rl(),x=Ot();return l.Zi.getEntries(p,d).next(b=>{v=b,v.forEach((E,k)=>{k.isValidDocument()||(x=x.add(E))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(b=>{h=b;const E=[];for(const k of o){const _=Ohe(k,h.get(k.key).overlayedDocument);_!=null&&E.push(new Hd(k.key,_,v8(_.value.mapValue),Ba.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,E,o)}).next(b=>{m=b;const E=b.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(p,b.batchId,E)})}).then(()=>({batchId:m.batchId,changes:I8(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Tc[i.currentUser.toKey()];c||(c=new Gn(Zt)),c=c.insert(o,l),i.Tc[i.currentUser.toKey()]=c}(r,s.batchId,n),await ox(r,s.changes),await l1(r.remoteStore)}catch(s){const i=MA(s,"Failed to persist write");n.reject(i)}}async function l7(t,e){const n=wt(t);try{const r=await Tfe(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.yc.get(i);o&&(Tn(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.fc=!0:s.modifiedDocuments.size>0?Tn(o.fc):s.removedDocuments.size>0&&(Tn(o.fc),o.fc=!1))}),await ox(n,r,e)}catch(r){await tx(r)}}function r4(t,e,n){const r=wt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.wc.forEach((i,o)=>{const l=o.view.Mu(e);l.snapshot&&s.push(l.snapshot)}),function(i,o){const l=wt(i);l.onlineState=o;let c=!1;l.queries.forEach((d,h)=>{for(const m of h.listeners)m.Mu(o)&&(c=!0)}),c&&OA(l)}(r.eventManager,e),s.length&&r.dc.nu(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function fme(t,e,n){const r=wt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.yc.get(e),i=s&&s.key;if(i){let o=new Gn(et.comparator);o=o.insert(i,us.newNoDocument(i,mt.min()));const l=Ot().add(i),c=new i1(mt.min(),new Map,new Gn(Zt),o,l);await l7(r,c),r.gc=r.gc.remove(i),r.yc.delete(e),DA(r)}else await iC(r.localStore,e,!1).then(()=>oC(r,e,n)).catch(tx)}async function mme(t,e){const n=wt(t),r=e.batch.batchId;try{const s=await Sfe(n.localStore,e);u7(n,r,null),c7(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ox(n,s)}catch(s){await tx(s)}}async function pme(t,e,n){const r=wt(t);try{const s=await function(i,o){const l=wt(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Tn(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);u7(r,e,n),c7(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ox(r,s)}catch(s){await tx(s)}}function c7(t,e){(t.Ec.get(e)||[]).forEach(n=>{n.resolve()}),t.Ec.delete(e)}function u7(t,e,n){const r=wt(t);let s=r.Tc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Tc[r.currentUser.toKey()]=s}}function oC(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t._c.get(e))t.wc.delete(r),n&&t.dc.Pc(r,n);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(r=>{t.Ic.containsKey(r)||d7(t,r)})}function d7(t,e){t.mc.delete(e.path.canonicalString());const n=t.gc.get(e);n!==null&&(e7(t.remoteStore,n),t.gc=t.gc.remove(e),t.yc.delete(n),DA(t))}function s4(t,e,n){for(const r of n)r instanceof o7?(t.Ic.addReference(r.key,e),gme(t,r)):r instanceof a7?(Ke("SyncEngine","Document no longer in limbo: "+r.key),t.Ic.removeReference(r.key,e),t.Ic.containsKey(r.key)||d7(t,r.key)):dt()}function gme(t,e){const n=e.key,r=n.path.canonicalString();t.gc.get(n)||t.mc.has(r)||(Ke("SyncEngine","New document in limbo: "+n),t.mc.add(r),DA(t))}function DA(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const n=new et(Ln.fromString(e)),r=t.Ac.next();t.yc.set(r,new ame(n)),t.gc=t.gc.insert(n,r),J8(t.remoteStore,new sc(nl(kA(n.path)),r,"TargetPurposeLimboResolution",yA.ct))}}async function ox(t,e,n){const r=wt(t),s=[],i=[],o=[];r.wc.isEmpty()||(r.wc.forEach((l,c)=>{o.push(r.Rc(c,e,n).then(d=>{if((d||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,d!=null&&d.fromCache?"not-current":"current"),d){s.push(d);const h=jA.Li(c.targetId,d);i.push(h)}}))}),await Promise.all(o),r.dc.nu(s),await async function(l,c){const d=wt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>we.forEach(c,m=>we.forEach(m.Fi,p=>d.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>we.forEach(m.Bi,p=>d.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!nx(h))throw h;Ke("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=d.Ji.get(m),v=p.snapshotVersion,x=p.withLastLimboFreeSnapshotVersion(v);d.Ji=d.Ji.insert(m,x)}}}(r.localStore,i))}async function yme(t,e){const n=wt(t);if(!n.currentUser.isEqual(e)){Ke("SyncEngine","User change. New user:",e.toKey());const r=await Q8(n.localStore,e);n.currentUser=e,function(s,i){s.Ec.forEach(o=>{o.forEach(l=>{l.reject(new Je(ye.CANCELLED,i))})}),s.Ec.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ox(n,r.er)}}function xme(t,e){const n=wt(t),r=n.yc.get(e);if(r&&r.fc)return Ot().add(r.key);{let s=Ot();const i=n._c.get(e);if(!i)return s;for(const o of i){const l=n.wc.get(o);s=s.unionWith(l.view.nc)}return s}}function vme(t){const e=wt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=l7.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xme.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=fme.bind(null,e),e.dc.nu=nme.bind(null,e.eventManager),e.dc.Pc=rme.bind(null,e.eventManager),e}function bme(t){const e=wt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mme.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pme.bind(null,e),e}class i4{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=o1(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Efe(this.persistence,new kfe,e.initialUser,this.serializer)}createPersistence(e){return new _fe(IA.zs,this.serializer)}createSharedClientState(e){return new Rfe}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class _me{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>r4(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=yme.bind(null,this.syncEngine),await Yfe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Jfe}createDatastore(e){const n=o1(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new Ofe(s));var s;return function(i,o,l,c){return new Ffe(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=l=>r4(this.syncEngine,l,0),o=e4.D()?new e4:new Pfe,new Bfe(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,l,c,d){const h=new lme(r,s,i,o,l,c);return d&&(h.vc=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=wt(e);Ke("RemoteStore","RemoteStore shutting down."),n.vu.add(5),await ix(n),n.Pu.shutdown(),n.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wme{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):tl("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kme{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=as.UNAUTHENTICATED,this.clientId=p8.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{Ke("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(Ke("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Je(ye.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=MA(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function oE(t,e){t.asyncQueue.verifyOperationInProgress(),Ke("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Q8(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function o4(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Eme(t);Ke("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>t4(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>t4(e.remoteStore,i)),t._onlineComponents=e}function Nme(t){return t.name==="FirebaseError"?t.code===ye.FAILED_PRECONDITION||t.code===ye.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function Eme(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ke("FirestoreClient","Using user provided OfflineComponentProvider");try{await oE(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!Nme(n))throw n;am("Error using user provided cache. Falling back to memory cache: "+n),await oE(t,new i4)}}else Ke("FirestoreClient","Using default OfflineComponentProvider"),await oE(t,new i4);return t._offlineComponents}async function h7(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ke("FirestoreClient","Using user provided OnlineComponentProvider"),await o4(t,t._uninitializedComponentsProvider._online)):(Ke("FirestoreClient","Using default OnlineComponentProvider"),await o4(t,new _me))),t._onlineComponents}function Sme(t){return h7(t).then(e=>e.syncEngine)}async function a4(t){const e=await h7(t),n=e.eventManager;return n.onListen=cme.bind(null,e.syncEngine),n.onUnlisten=dme.bind(null,e.syncEngine),n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f7(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m7(t,e,n){if(!n)throw new Je(ye.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Tme(t,e,n,r){if(e===!0&&r===!0)throw new Je(ye.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function c4(t){if(!et.isDocumentKey(t))throw new Je(ye.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function u4(t){if(et.isDocumentKey(t))throw new Je(ye.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function VA(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dt()}function Zg(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Je(ye.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=VA(t);throw new Je(ye.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Je(ye.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Je(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Tme("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=f7((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Je(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Je(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Je(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(n=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,n.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var n,r}}class c1{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new d4({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Je(ye.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Je(ye.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new d4(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Hde;switch(n.type){case"firstParty":return new Qde(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Je(ye.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=l4.get(e);n&&(Ke("ComponentProvider","Removing Datastore"),l4.delete(e),n.terminate())}(this),Promise.resolve()}}function Cme(t,e,n,r={}){var s;const i=(t=Zg(t,c1))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&am("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=as.MOCK_USER;else{l=Cue(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new Je(ye.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new as(d)}t._authCredentials=new qde(new m8(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ui(this.firestore,e,this._key)}}class u1{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new u1(this.firestore,e,this._query)}}class Nc extends u1{constructor(e,n,r){super(e,n,kA(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ui(this.firestore,null,new et(e))}withConverter(e){return new Nc(this.firestore,e,this._path)}}function Ime(t,e,...n){if(t=im(t),m7("collection","path",e),t instanceof c1){const r=Ln.fromString(e,...n);return u4(r),new Nc(t,null,r)}{if(!(t instanceof Ui||t instanceof Nc))throw new Je(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ln.fromString(e,...n));return u4(r),new Nc(t.firestore,null,r)}}function jme(t,e,...n){if(t=im(t),arguments.length===1&&(e=p8.A()),m7("doc","path",e),t instanceof c1){const r=Ln.fromString(e,...n);return c4(r),new Ui(t,null,new et(r))}{if(!(t instanceof Ui||t instanceof Nc))throw new Je(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ln.fromString(e,...n));return c4(r),new Ui(t.firestore,t instanceof Nc?t.converter:null,new et(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ame{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Y8(this,"async_queue_retry"),this.Xc=()=>{const n=iE();n&&Ke("AsyncQueue","Visibility state changed to "+n.visibilityState),this.qo.Mo()};const e=iE();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const n=iE();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const n=new Qu;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!nx(e))throw e;Ke("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const n=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw tl("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Hc=!1,r))));return this.Gc=n,n}enqueueAfterDelay(e,n,r){this.Zc(),this.Yc.indexOf(e)>-1&&(n=0);const s=LA.createAndSchedule(this,e,n,r,i=>this.na(i));return this.zc.push(s),s}Zc(){this.Wc&&dt()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const n of this.zc)if(n.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.zc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const n=this.zc.indexOf(e);this.zc.splice(n,1)}}function h4(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}let rw=class extends c1{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Ame,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||g7(this),this._firestoreClient.terminate()}};function Rme(t,e){const n=typeof t=="object"?t:$0(),r=typeof t=="string"?t:"(default)",s=Mm(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Tue("firestore");i&&Cme(s,...i)}return s}function p7(t){return t._firestoreClient||g7(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function g7(t){var e,n,r;const s=t._freezeSettings(),i=function(o,l,c,d){return new ahe(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,f7(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new kme(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=s.cache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fm(xs.fromBase64String(e))}catch(n){throw new Je(ye.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new fm(xs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Je(ye.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Je(ye.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Je(ye.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Zt(this._lat,e._lat)||Zt(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pme=/^__.*__$/;class Lme{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Hd(e,this.data,this.fieldMask,n,this.fieldTransforms):new rx(e,this.data,n,this.fieldTransforms)}}function x7(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt()}}class BA{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new BA(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.aa({path:r,la:!1});return s.fa(e),s}da(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.aa({path:r,la:!1});return s.ua(),s}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return sw(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(x7(this.ca)&&Pme.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Mme{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||o1(e)}ya(e,n,r,s=!1){return new BA({ca:e,methodName:n,ga:r,path:hs.emptyPath(),la:!1,ma:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ome(t){const e=t._freezeSettings(),n=o1(t._databaseId);return new Mme(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Dme(t,e,n,r,s,i={}){const o=t.ya(i.merge||i.mergeFields?2:0,e,n,s);w7("Data must be an object, but it was:",o,r);const l=b7(r,o);let c,d;if(i.merge)c=new rc(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const p=Vme(e,m,n);if(!o.contains(p))throw new Je(ye.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);$me(h,p)||h.push(p)}c=new rc(h),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new Lme(new Oi(l),c,d)}function v7(t,e){if(_7(t=im(t)))return w7("Unsupported field value:",e,t),b7(t,e);if(t instanceof y7)return function(n,r){if(!x7(r.ca))throw r._a(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let l=v7(o,r.wa(i));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=im(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return jhe(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Sr.fromDate(n);return{timestampValue:tw(r.serializer,s)}}if(n instanceof Sr){const s=new Sr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:tw(r.serializer,s)}}if(n instanceof $A)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof fm)return{bytesValue:U8(r.serializer,n._byteString)};if(n instanceof Ui){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:TA(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r._a(`Unsupported field value: ${VA(n)}`)}(t,e)}function b7(t,e){const n={};return g8(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wm(t,(r,s)=>{const i=v7(s,e.ha(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function _7(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Sr||t instanceof $A||t instanceof fm||t instanceof Ui||t instanceof y7)}function w7(t,e,n){if(!_7(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=VA(n);throw r==="an object"?e._a(t+" a custom object"):e._a(t+" "+r)}}function Vme(t,e,n){if((e=im(e))instanceof FA)return e._internalPath;if(typeof e=="string")return k7(t,e);throw sw("Field path arguments must be of type string or ",t,!1,void 0,n)}const Fme=new RegExp("[~\\*/\\[\\]]");function k7(t,e,n){if(e.search(Fme)>=0)throw sw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new FA(...e.split("."))._internalPath}catch{throw sw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function sw(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Je(ye.INVALID_ARGUMENT,l+t+c)}function $me(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ui(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Bme(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(E7("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Bme extends N7{data(){return super.data()}}function E7(t,e){return typeof e=="string"?k7(t,e):e instanceof FA?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zme(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Je(ye.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ume{convertValue(e,n="none"){switch(Nd(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(kd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw dt()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Wm(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new $A(pr(e.latitude),pr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=vA(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xy(e));default:return null}}convertTimestamp(e){const n=Dc(e);return new Sr(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ln.fromString(e);Tn(K8(r));const s=new x8(r.get(1),r.get(3)),i=new et(r.popFirst(5));return s.isEqual(n)||tl(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wme(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class S7 extends N7{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new wb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(E7("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class wb extends S7{data(e={}){return super.data(e)}}class Hme{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new yg(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new wb(this._firestore,this._userDataWriter,r.key,r,new yg(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Je(ye.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>{const l=new wb(r._firestore,r._userDataWriter,o.doc.key,o.doc,new yg(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new wb(r._firestore,r._userDataWriter,o.doc.key,o.doc,new yg(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,d=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),d=i.indexOf(o.doc.key)),{type:qme(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function qme(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt()}}class T7 extends Ume{constructor(e){super(),this.firestore=e}convertBytes(e){return new fm(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ui(this.firestore,null,n)}}function Gme(t,e){const n=Zg(t.firestore,rw),r=jme(t),s=Wme(t.converter,e);return Qme(n,[Dme(Ome(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Ba.exists(!1))]).then(()=>r)}function Kme(t,...e){var n,r,s;t=im(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||h4(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges};if(h4(e[o])){const m=e[o];e[o]=(n=m.next)===null||n===void 0?void 0:n.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let c,d,h;if(t instanceof Ui)d=Zg(t.firestore,rw),h=kA(t._key.path),c={next:m=>{e[o]&&e[o](Zme(d,t,m))},error:e[o+1],complete:e[o+2]};else{const m=Zg(t,u1);d=Zg(m.firestore,rw),h=m._query;const p=new T7(d);c={next:v=>{e[o]&&e[o](new Hme(d,p,m,v))},error:e[o+1],complete:e[o+2]},zme(t._query)}return function(m,p,v,x){const b=new wme(x),E=new sme(p,b,v);return m.asyncQueue.enqueueAndForget(async()=>eme(await a4(m),E)),()=>{b.Dc(),m.asyncQueue.enqueueAndForget(async()=>tme(await a4(m),E))}}(p7(d),h,l,c)}function Qme(t,e){return function(n,r){const s=new Qu;return n.asyncQueue.enqueueAndForget(async()=>hme(await Sme(n),r,s)),s.promise}(p7(t),e)}function Zme(t,e,n){const r=n.docs.get(e._key),s=new T7(t);return new S7(t,s,e._key,r,new yg(n.hasPendingWrites,n.fromCache),e.converter)}(function(t,e=!0){(function(n){Um=n})($d),Xa(new Pue("firestore",(n,{instanceIdentifier:r,options:s})=>{const i=n.getProvider("app").getImmediate(),o=new rw(new Gde(n.getProvider("auth-internal")),new Yde(n.getProvider("app-check-internal")),function(l,c){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Je(ye.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new x8(l.options.projectId,c)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),fi(AD,"3.13.0",t),fi(AD,"3.13.0","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yme=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Xme=function(t){for(var e=[],n=0,r=0;n<t.length;){var s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){var i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){var i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{var i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Jme={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],s=0;s<t.length;s+=3){var i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4,p=(l&15)<<2|d>>6,v=d&63;c||(v=64,o||(p=64)),r.push(n[h],n[m],n[p],n[v])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Yme(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Xme(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],s=0;s<t.length;){var i=n[t.charAt(s++)],o=s<t.length,l=o?n[t.charAt(s)]:0;++s;var c=s<t.length,d=c?n[t.charAt(s)]:64;++s;var h=s<t.length,m=h?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw Error();var p=i<<2|l>>4;if(r.push(p),d!==64){var v=l<<4&240|d>>2;if(r.push(v),m!==64){var x=d<<6&192|m;r.push(x)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},epe=function(t){try{return Jme.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tpe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vs())}function npe(){var t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function rpe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function spe(){var t=vs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ipe="FirebaseError",d1=function(t){zY(e,t);function e(n,r,s){var i=t.call(this,r)||this;return i.code=n,i.customData=s,i.name=ipe,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,h1.prototype.create),i}return e}(Error),h1=function(){function t(e,n,r){this.service=e,this.serviceName=n,this.errors=r}return t.prototype.create=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var s=n[0]||{},i=this.service+"/"+e,o=this.errors[e],l=o?ope(o,s):"Error",c=this.serviceName+": "+l+" ("+i+").",d=new d1(i,c,s);return d},t}();function ope(t,e){return t.replace(ape,function(n,r){var s=e[r];return s!=null?String(s):"<"+r+"?>"})}var ape=/\{\$([^}]+)}/g;function lpe(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function C7(t,e){if(t===e)return!0;for(var n=Object.keys(t),r=Object.keys(e),s=0,i=n;s<i.length;s++){var o=i[s];if(!r.includes(o))return!1;var l=t[o],c=e[o];if(f4(l)&&f4(c)){if(!C7(l,c))return!1}else if(l!==c)return!1}for(var d=0,h=r;d<h.length;d++){var o=h[d];if(!n.includes(o))return!1}return!0}function f4(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(t){for(var e=[],n=function(c,d){Array.isArray(d)?d.forEach(function(h){e.push(encodeURIComponent(c)+"="+encodeURIComponent(h))}):e.push(encodeURIComponent(c)+"="+encodeURIComponent(d))},r=0,s=Object.entries(t);r<s.length;r++){var i=s[r],o=i[0],l=i[1];n(o,l)}return e.length?"&"+e.join("&"):""}function cpe(t,e){var n=new upe(t,e);return n.subscribe.bind(n)}var upe=function(){function t(e,n){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){e(r)}).catch(function(s){r.error(s)})}return t.prototype.next=function(e){this.forEachObserver(function(n){n.next(e)})},t.prototype.error=function(e){this.forEachObserver(function(n){n.error(e)}),this.close(e)},t.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},t.prototype.subscribe=function(e,n,r){var s=this,i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");dpe(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=aE),i.error===void 0&&(i.error=aE),i.complete===void 0&&(i.complete=aE);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{s.finalError?i.error(s.finalError):i.complete()}catch{}}),this.observers.push(i),o},t.prototype.unsubscribeOne=function(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},t.prototype.forEachObserver=function(e){if(!this.finalized)for(var n=0;n<this.observers.length;n++)this.sendOne(n,e)},t.prototype.sendOne=function(e,n){var r=this;this.task.then(function(){if(r.observers!==void 0&&r.observers[e]!==void 0)try{n(r.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})},t.prototype.close=function(e){var n=this;this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(function(){n.observers=void 0,n.onNoObservers=void 0}))},t}();function dpe(t,e){if(typeof t!="object"||t===null)return!1;for(var n=0,r=e;n<r.length;n++){var s=r[n];if(s in t&&typeof t[s]=="function")return!0}return!1}function aE(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(t){return t&&t._delegate?t._delegate:t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function no(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,l=i.length;o<l;o++,s++)r[s]=i[o];return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gu,xn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xn||(xn={}));var hpe={debug:xn.DEBUG,verbose:xn.VERBOSE,info:xn.INFO,warn:xn.WARN,error:xn.ERROR,silent:xn.SILENT},fpe=xn.INFO,mpe=(gu={},gu[xn.DEBUG]="log",gu[xn.VERBOSE]="log",gu[xn.INFO]="info",gu[xn.WARN]="warn",gu[xn.ERROR]="error",gu),ppe=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var s=new Date().toISOString(),i=mpe[e];if(i)console[i].apply(console,no(["["+s+"]  "+t.name+":"],n));else throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}},gpe=function(){function t(e){this.name=e,this._logLevel=fpe,this._logHandler=ppe,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in xn))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(e){this._logLevel=typeof e=="string"?hpe[e]:e},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,no([this,xn.DEBUG],e)),this._logHandler.apply(this,no([this,xn.DEBUG],e))},t.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,no([this,xn.VERBOSE],e)),this._logHandler.apply(this,no([this,xn.VERBOSE],e))},t.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,no([this,xn.INFO],e)),this._logHandler.apply(this,no([this,xn.INFO],e))},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,no([this,xn.WARN],e)),this._logHandler.apply(this,no([this,xn.WARN],e))},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,no([this,xn.ERROR],e)),this._logHandler.apply(this,no([this,xn.ERROR],e))},t}(),m4=function(){function t(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},t.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},t.prototype.setServiceProps=function(e){return this.serviceProps=e,this},t.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},t}();function I7(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ype=I7,j7=new h1("auth","Firebase",I7());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4=new gpe("@firebase/auth");function kb(t,...e){p4.logLevel<=xn.ERROR&&p4.error(`Auth (${$d}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(t,...e){throw zA(t,...e)}function Wo(t,...e){return zA(t,...e)}function xpe(t,e,n){const r=Object.assign(Object.assign({},ype()),{[e]:n});return new h1("auth","Firebase",r).create(e,{appName:t.name})}function zA(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return j7.create(t,...e)}function xt(t,e,...n){if(!t)throw zA(e,...n)}function Da(t){const e="INTERNAL ASSERTION FAILED: "+t;throw kb(e),new Error(e)}function il(t,e){t||Da(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4=new Map;function Va(t){il(t instanceof Function,"Expected a class definition");let e=g4.get(t);return e?(il(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,g4.set(t,e),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vpe(t,e){const n=Mm(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(C7(i,e??{}))return s;sl(s,"already-initialized")}return n.initialize({options:e})}function bpe(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Va);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function _pe(){return y4()==="http:"||y4()==="https:"}function y4(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wpe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_pe()||npe()||"connection"in navigator)?navigator.onLine:!0}function kpe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e,n){this.shortDelay=e,this.longDelay=n,il(n>e,"Short delay should be less than long delay!"),this.isMobile=tpe()||rpe()}get(){return wpe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(t,e){il(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Da("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Da("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Da("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Npe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Epe=new lx(3e4,6e4);function Spe(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function m1(t,e,n,r,s={}){return A7(t,s,()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=ax(Object.assign({key:t.config.apiKey},o)).slice(1),c=new(lC.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&c.set("X-Firebase-Locale",t.languageCode),lC.fetch()(R7(t,t.config.apiHost,n,l),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function A7(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Npe),e);try{const s=new Cpe(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw lE(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw lE(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw lE(t,"email-already-in-use",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw xpe(t,h,d);sl(t,h)}}catch(s){if(s instanceof d1)throw s;sl(t,"network-request-failed")}}async function Tpe(t,e,n,r,s={}){const i=await m1(t,e,n,r,s);return"mfaPendingCredential"in i&&sl(t,"multi-factor-auth-required",{serverResponse:i}),i}function R7(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?UA(t.config,s):`${t.config.apiScheme}://${s}`}class Cpe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Wo(this.auth,"timeout")),Epe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function lE(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Wo(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ipe(t,e){return m1(t,"POST","/v1/accounts:delete",e)}async function jpe(t,e){return m1(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yg(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ape(t,e=!1){const n=f1(t),r=await n.getIdToken(e),s=WA(r);xt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Yg(cE(s.auth_time)),issuedAtTime:Yg(cE(s.iat)),expirationTime:Yg(cE(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function cE(t){return Number(t)*1e3}function WA(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return kb("JWT malformed, contained fewer than 3 sections"),null;try{const s=epe(n);return s?JSON.parse(s):(kb("Failed to decode base64 JWT payload"),null)}catch(s){return kb("Caught error parsing JWT payload as JSON",s),null}}function Rpe(t){const e=WA(t);return xt(e,"internal-error"),xt(typeof e.exp<"u","internal-error"),xt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n0(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof d1&&Ppe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Ppe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lpe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yg(this.lastLoginAt),this.creationTime=Yg(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iw(t){var e;const n=t.auth,r=await t.getIdToken(),s=await n0(t,jpe(n,{idToken:r}));xt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Dpe(i.providerUserInfo):[],l=Ope(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=c?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new P7(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,m)}async function Mpe(t){const e=f1(t);await iw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ope(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Dpe(t){return t.map(e=>{var{providerId:n}=e,r=Im(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vpe(t,e){const n=await A7(t,{},()=>{const r=ax({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=R7(t,s,"/v1/token",`key=${i}`);return lC.fetch()(o,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xt(e.idToken,"internal-error"),xt(typeof e.idToken<"u","internal-error"),xt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Rpe(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return xt(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Vpe(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new r0;return r&&(xt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(xt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(xt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new r0,this.toJSON())}_performRefresh(){return Da("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(t,e){xt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zu{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Im(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Lpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new P7(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await n0(this,this.stsTokenManager.getToken(this.auth,e));return xt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ape(this,e)}reload(){return Mpe(this)}_assign(e){this!==e&&(xt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Zu(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){xt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await iw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await n0(this,Ipe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,d,h;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,v=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=n.photoURL)!==null&&o!==void 0?o:void 0,b=(l=n.tenantId)!==null&&l!==void 0?l:void 0,E=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,k=(d=n.createdAt)!==null&&d!==void 0?d:void 0,_=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:S,emailVerified:T,isAnonymous:P,providerData:j,stsTokenManager:R}=n;xt(S&&R,e,"internal-error");const I=r0.fromJSON(this.name,R);xt(typeof S=="string",e,"internal-error"),Rl(m,e.name),Rl(p,e.name),xt(typeof T=="boolean",e,"internal-error"),xt(typeof P=="boolean",e,"internal-error"),Rl(v,e.name),Rl(x,e.name),Rl(b,e.name),Rl(E,e.name),Rl(k,e.name),Rl(_,e.name);const O=new Zu({uid:S,auth:e,email:p,emailVerified:T,displayName:m,isAnonymous:P,photoURL:x,phoneNumber:v,tenantId:b,stsTokenManager:I,createdAt:k,lastLoginAt:_});return j&&Array.isArray(j)&&(O.providerData=j.map(D=>Object.assign({},D))),E&&(O._redirectEventId=E),O}static async _fromIdTokenResponse(e,n,r=!1){const s=new r0;s.updateFromServerResponse(n);const i=new Zu({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await iw(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}L7.type="NONE";const x4=L7;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nb(t,e,n){return`firebase:${t}:${e}:${n}`}class Sf{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Nb(this.userKey,s.apiKey,i),this.fullPersistenceKey=Nb("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Zu._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Sf(Va(x4),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Va(x4);const o=Nb(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){const m=Zu._fromJSON(e,h);d!==i&&(l=m),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Sf(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Sf(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(D7(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(M7(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(F7(e))return"Blackberry";if($7(e))return"Webos";if(HA(e))return"Safari";if((e.includes("chrome/")||O7(e))&&!e.includes("edge/"))return"Chrome";if(V7(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function M7(t=vs()){return/firefox\//i.test(t)}function HA(t=vs()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function O7(t=vs()){return/crios\//i.test(t)}function D7(t=vs()){return/iemobile/i.test(t)}function V7(t=vs()){return/android/i.test(t)}function F7(t=vs()){return/blackberry/i.test(t)}function $7(t=vs()){return/webos/i.test(t)}function p1(t=vs()){return/iphone|ipad|ipod/i.test(t)}function Fpe(t=vs()){var e;return p1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function $pe(){return spe()&&document.documentMode===10}function B7(t=vs()){return p1(t)||V7(t)||$7(t)||F7(t)||/windows phone/i.test(t)||D7(t)}function Bpe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z7(t,e=[]){let n;switch(t){case"Browser":n=v4(vs());break;case"Worker":n=`${v4(vs())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${$d}/${r}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zpe{constructor(e,n){this.app=e,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new b4(this),this.idTokenSubscription=new b4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=j7,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Va(n)),this._initializationPromise=this.queue(async()=>{var r;this._deleted||(this.persistenceManager=await Sf.create(this,e),!this._deleted&&(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(n),!this._deleted&&(this._isInitialized=!0)))}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e)}}async initializeCurrentUser(e){var n;let r=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,i=r==null?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===i)&&(o!=null&&o.user)&&(r=o.user)}return r?r._redirectEventId?(xt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)):this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await iw(e)}catch(n){if(n.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kpe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?f1(e):null;return n&&xt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&xt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Va(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new h1("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Va(e)||this._popupRedirectResolver;xt(n,this,"argument-error"),this.redirectPersistenceManager=await Sf.create(this,[Va(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return xt(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,r,s):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=z7(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function U7(t){return f1(t)}class b4{constructor(e){this.auth=e,this.observer=null,this.addObserver=cpe(n=>this.observer=n)}get next(){return xt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Da("not implemented")}_getIdTokenResponse(e){return Da("not implemented")}_linkToIdToken(e,n){return Da("not implemented")}_getReauthenticationResolver(e){return Da("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tf(t,e){return Tpe(t,"POST","/v1/accounts:signInWithIdp",Spe(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Upe="http://localhost";class Ed extends W7{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ed(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):sl("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Im(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ed(r,s);return Object.assign(o,i),o}_getIdTokenResponse(e){const n=this.buildRequest();return Tf(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Tf(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Tf(e,n)}buildRequest(){const e={requestUri:Upe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ax(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx extends H7{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql extends cx{constructor(){super("facebook.com")}static credential(e){return Ed._fromParams({providerId:ql.PROVIDER_ID,signInMethod:ql.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ql.credentialFromTaggedObject(e)}static credentialFromError(e){return ql.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ql.credential(e.oauthAccessToken)}catch{return null}}}ql.FACEBOOK_SIGN_IN_METHOD="facebook.com";ql.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl extends cx{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ed._fromParams({providerId:Gl.PROVIDER_ID,signInMethod:Gl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Gl.credentialFromTaggedObject(e)}static credentialFromError(e){return Gl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Gl.credential(n,r)}catch{return null}}}Gl.GOOGLE_SIGN_IN_METHOD="google.com";Gl.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl extends cx{constructor(){super("github.com")}static credential(e){return Ed._fromParams({providerId:Kl.PROVIDER_ID,signInMethod:Kl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kl.credentialFromTaggedObject(e)}static credentialFromError(e){return Kl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kl.credential(e.oauthAccessToken)}catch{return null}}}Kl.GITHUB_SIGN_IN_METHOD="github.com";Kl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql extends cx{constructor(){super("twitter.com")}static credential(e,n){return Ed._fromParams({providerId:Ql.PROVIDER_ID,signInMethod:Ql.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ql.credentialFromTaggedObject(e)}static credentialFromError(e){return Ql.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ql.credential(n,r)}catch{return null}}}Ql.TWITTER_SIGN_IN_METHOD="twitter.com";Ql.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Zu._fromIdTokenResponse(e,r,s),o=_4(r);return new mm({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=_4(r);return new mm({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function _4(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow extends d1{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,this.name="FirebaseError",Object.setPrototypeOf(this,ow.prototype),this.appName=e.name,this.code=n.code,this.tenantId=(i=e.tenantId)!==null&&i!==void 0?i:void 0,this.serverResponse=n.customData.serverResponse}static _fromErrorAndOperation(e,n,r,s){return new ow(e,n,r,s)}}function q7(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ow._fromErrorAndOperation(t,i,e,r):i})}async function Wpe(t,e,n=!1){const r=await n0(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return mm._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hpe(t,e,n=!1){const{auth:r}=t,s="reauthenticate";try{const i=await n0(t,q7(r,s,e,t),n);xt(i.idToken,r,"internal-error");const o=WA(i.idToken);xt(o,r,"internal-error");const{sub:l}=o;return xt(t.uid===l,r,"user-mismatch"),mm._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&sl(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qpe(t,e,n=!1){const r="signIn",s=await q7(t,r,e),i=await mm._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}const aw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(e,n){this.storage=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(aw,"1"),this.storage.removeItem(aw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gpe(){const t=vs();return HA(t)||p1(t)}const Kpe=1e3,Qpe=10;class K7 extends G7{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Gpe()&&Bpe(),this.fallbackToPolling=B7(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);$pe()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Qpe):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Kpe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}K7.type="LOCAL";const Zpe=K7;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7 extends G7{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Q7.type="SESSION";const Z7=Q7;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ype(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new g1(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),c=await Ype(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}g1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xpe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const d=qA("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ho(){return window}function Jpe(t){Ho().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y7(){return typeof Ho().WorkerGlobalScope<"u"&&typeof Ho().importScripts=="function"}async function ege(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function nge(){return Y7()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X7="firebaseLocalStorageDb",rge=1,lw="firebaseLocalStorage",J7="fbase_key";class ux{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function y1(t,e){return t.transaction([lw],e?"readwrite":"readonly").objectStore(lw)}function sge(){const t=indexedDB.deleteDatabase(X7);return new ux(t).toPromise()}function cC(){const t=indexedDB.open(X7,rge);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(lw,{keyPath:J7})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(lw)?e(r):(r.close(),await sge(),e(await cC()))})})}async function w4(t,e,n){const r=y1(t,!0).put({[J7]:e,value:n});return new ux(r).toPromise()}async function ige(t,e){const n=y1(t,!1).get(e),r=await new ux(n).toPromise();return r===void 0?null:r.value}function k4(t,e){const n=y1(t,!0).delete(e);return new ux(n).toPromise()}const oge=800,age=3;class eW{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await cC(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>age)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Y7()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=g1._getInstance(nge()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await ege(),!this.activeServiceWorker)return;this.sender=new Xpe(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await cC();return await w4(e,aw,"1"),await k4(e,aw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>w4(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ige(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>k4(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=y1(s,!1).getAll();return new ux(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),oge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eW.type="LOCAL";const lge=eW;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cge(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function uge(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Wo("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",cge().appendChild(r)})}function dge(t){return`__${t}${Math.floor(Math.random()*1e6)}`}new lx(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hge(t,e){return e?Va(e):(xt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA extends W7{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Tf(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Tf(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Tf(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function fge(t){return qpe(t.auth,new GA(t),t.bypassAuthState)}function mge(t){const{auth:e,user:n}=t;return xt(n,e,"internal-error"),Hpe(n,new GA(t),t.bypassAuthState)}async function pge(t){const{auth:e,user:n}=t;return xt(n,e,"internal-error"),Wpe(n,new GA(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tW{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fge;case"linkViaPopup":case"linkViaRedirect":return pge;case"reauthViaPopup":case"reauthViaRedirect":return mge;default:sl(this.auth,"internal-error")}}resolve(e){il(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){il(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gge=new lx(2e3,1e4);class rf extends tW{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,rf.currentPopupAction&&rf.currentPopupAction.cancel(),rf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xt(e,this.auth,"internal-error"),e}async onExecution(){il(this.filter.length===1,"Popup operations only handle one event");const e=qA();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Wo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Wo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rf.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wo(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,gge.get())};e()}}rf.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yge="pendingRedirect",N4=new Map;class xge extends tW{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=N4.get(this.auth._key());if(!e){try{const r=await vge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}N4.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vge(t,e){const n=bge(e),r=await E4(t)._get(n)==="true";return await E4(t)._remove(n),r}function E4(t){return Va(t._redirectPersistence)}function bge(t){return Nb(yge,t.config.apiKey,t.name)}async function _ge(t,e,n=!1){const r=U7(t),s=hge(r,e),o=await new xge(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wge=10*60*1e3;class kge{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Nge(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!nW(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Wo(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wge&&this.cachedEventUids.clear(),this.cachedEventUids.has(S4(e))}saveEventToCache(e){this.cachedEventUids.add(S4(e)),this.lastProcessedEventTime=Date.now()}}function S4(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function nW({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Nge(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nW(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ege(t,e={}){return m1(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sge=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tge=/^https?/;async function Cge(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Ege(t);for(const n of e)try{if(Ige(n))return}catch{}sl(t,"unauthorized-domain")}function Ige(t){const e=aC(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Tge.test(n))return!1;if(Sge.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jge=new lx(3e4,6e4);function T4(){const t=Ho().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Age(t){return new Promise((e,n)=>{var r,s,i;function o(){T4(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{T4(),n(Wo(t,"network-request-failed"))},timeout:jge.get()})}if(!((s=(r=Ho().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Ho().gapi)===null||i===void 0)&&i.load)o();else{const l=dge("iframefcb");return Ho()[l]=()=>{gapi.load?o():n(Wo(t,"network-request-failed"))},uge(`https://apis.google.com/js/api.js?onload=${l}`)}}).catch(e=>{throw Eb=null,e})}let Eb=null;function Rge(t){return Eb=Eb||Age(t),Eb}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pge=new lx(5e3,15e3),Lge="__/auth/iframe",Mge="emulator/auth/iframe",Oge={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},Dge=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Vge(t){const e=t.config;xt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?UA(e,Mge):`https://${t.config.authDomain}/${Lge}`,r={apiKey:e.apiKey,appName:t.name,v:$d},s=Dge.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ax(r).slice(1)}`}async function Fge(t){const e=await Rge(t),n=Ho().gapi;return xt(n,t,"internal-error"),e.open({where:document.body,url:Vge(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Oge,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Wo(t,"network-request-failed"),l=Ho().setTimeout(()=>{i(o)},Pge.get());function c(){Ho().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ge={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Bge=500,zge=600,Uge="_blank",Wge="http://localhost";class C4{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Hge(t,e,n,r=Bge,s=zge){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},$ge),{width:r.toString(),height:s.toString(),top:i,left:o}),d=vs().toLowerCase();n&&(l=O7(d)?Uge:n),M7(d)&&(e=e||Wge,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[v,x])=>`${p}${v}=${x},`,"");if(Fpe(d)&&l!=="_self")return qge(e||"",l),new C4(null);const m=window.open(e||"",l,h);xt(m,t,"popup-blocked");try{m.focus()}catch{}return new C4(m)}function qge(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gge="__/auth/handler",Kge="emulator/auth/handler";function I4(t,e,n,r,s,i){xt(t.config.authDomain,t,"auth-domain-config-required"),xt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:$d,eventId:s};if(e instanceof H7){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",lpe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,d]of Object.entries({}))o[c]=d}if(e instanceof cx){const c=e.getScopes().filter(d=>d!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const c of Object.keys(l))l[c]===void 0&&delete l[c];return`${Qge(t)}?${ax(l).slice(1)}`}function Qge({config:t}){return t.emulator?UA(t,Kge):`https://${t.authDomain}/${Gge}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE="webStorageSupport";class Zge{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Z7,this._completeRedirectFn=_ge}async _openPopup(e,n,r,s){var i;il((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=I4(e,n,r,aC(),s);return Hge(e,o,qA())}async _openRedirect(e,n,r,s){return await this._originValidation(e),Jpe(I4(e,n,r,aC(),s)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(il(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r}async initAndGetManager(e){const n=await Fge(e),r=new kge(e);return n.register("authEvent",s=>(xt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(uE,{type:uE},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[uE];o!==void 0&&n(!!o),sl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Cge(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return B7()||HA()||p1()}}const Yge=Zge;var Xge="@firebase/auth",Jge="0.17.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eye{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{var s;e(((s=r)===null||s===void 0?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){xt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tye(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function nye(t){Xa(new m4("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),{apiKey:s,authDomain:i}=r.options;return(o=>{xt(s&&!s.includes(":"),"invalid-api-key",{appName:o.name}),xt(!(i!=null&&i.includes(":")),"argument-error",{appName:o.name});const l={apiKey:s,authDomain:i,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:z7(t)},c=new zpe(o,l);return bpe(c,n),c})(r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Xa(new m4("auth-internal",e=>{const n=U7(e.getProvider("auth").getImmediate());return(r=>new eye(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),fi(Xge,Jge,tye(t))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rye(t=$0()){const e=Mm(t,"auth");return e.isInitialized()?e.getImmediate():vpe(t,{popupRedirectResolver:Yge,persistence:[lge,Zpe,Z7]})}nye("Browser");function sye(t){try{const e=iye(t);return Promise.resolve(e)}catch(e){return Promise.reject(e)}}function iye(t){return aye(t).getCurrentUser()}class oye{constructor(e){this.auth=rye(e)}getCurrentUser(){var e;const n=(e=this.auth.currentUser)===null||e===void 0?void 0:e.uid;if(!n)throw new xb("unauthenticated","Failed to determine currently signed in user. User not signed in.");return n}}const rW="user-dao";function aye(t){let e=t.getComponent(rW);return e||(e=new oye(t.app),lye(t,e)),e}function lye(t,e){t.setComponent(rW,e)}function uC(t,e){if(typeof t!="string"||t==="")throw new Error(e??"arg must be a non-empty string.")}function cye(t,e){if(typeof t!="number"||isNaN(t)||t<=0)throw new Error(e)}function uye(t,e){if(!Array.isArray(t)||t.length===0)throw new Error(e)}var j4=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(h){try{d(r.next(h))}catch(m){o(m)}}function c(h){try{d(r.throw(h))}catch(m){o(m)}}function d(h){h.done?i(h.value):s(h.value).then(l,c)}d((r=r.apply(t,e||[])).next())})},dye=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};function hye(t){return"line_items"in t}const fye=30*1e3;function mye(t,e,n){e=Object.assign({},e),pye(e),hye(e)?gye(e):yye(e);const r=xye();return sye(t).then(s=>kye(t).createCheckoutSession(s,e,r))}function pye(t){var e;typeof t.cancel_url<"u"?uC(t.cancel_url,"cancel_url must be a non-empty string."):t.cancel_url=window.location.href,(e=t.mode)!==null&&e!==void 0||(t.mode="subscription"),typeof t.success_url<"u"?uC(t.success_url,"success_url must be a non-empty string."):t.success_url=window.location.href}function gye(t){uye(t.line_items,"line_items must be a non-empty array.")}function yye(t){uC(t.price,"price must be a non-empty string."),typeof t.quantity<"u"&&cye(t.quantity,"quantity must be a positive integer.")}function xye(t){return fye}class vye{constructor(e,n){this.customersCollection=n,this.firestore=Rme(e)}createCheckoutSession(e,n,r){return j4(this,void 0,void 0,function*(){const s=yield this.addSessionDoc(e,n);return this.waitForSessionId(s,r)})}addSessionDoc(e,n){return j4(this,void 0,void 0,function*(){const r=Ime(this.firestore,this.customersCollection,e,"checkout_sessions");try{return yield Gme(r,n)}catch(s){throw new xb("internal","Error while querying Firestore.",s)}})}waitForSessionId(e,n){let r;return new Promise((s,i)=>{const o=setTimeout(()=>{i(new xb("deadline-exceeded","Timeout while waiting for session response."))},n);r=Kme(e.withConverter(_ye),l=>{const c=l.data();bye(c)&&(clearTimeout(o),s(c))},l=>{clearTimeout(o),i(new xb("internal","Error while querying Firestore.",l))})}).finally(()=>r())}}function bye(t){return typeof(t==null?void 0:t.id)<"u"}const _ye={toFirestore:()=>{throw new Error("Not implemented for readonly Session type.")},fromFirestore:t=>{const e=t.data(),{created:n,sessionId:r}=e,s=dye(e,["created","sessionId"]);return typeof r<"u"?Object.assign(Object.assign({},s),{id:r,created_at:wye(n)}):Object.assign({},s)}};function wye(t){return t.toDate().toUTCString()}const sW="checkout-session-dao";function kye(t){let e=t.getComponent(sW);return e||(e=new vye(t.app,t.customersCollection),Nye(t,e)),e}function Nye(t,e){t.setComponent(sW,e)}const iW={apiKey:"AIzaSyCRRmP9lfWF2hWdquNmo1t-x5Pjz-l6idM",authDomain:"auth.seshnx.net",projectId:"seshnx-70c04",storageBucket:"seshnx-70c04.firebasestorage.app",messagingSenderId:"98272119648",appId:"1:98272119648:web:ff6d186adf94a03fe0ac05",measurementId:""},Fc=m6(iW),sf=i$(Fc),Z=mre(Fc,{localCache:jre({tabManager:Lre()})}),oW=boe(Fc),cn=hue(Fc),Eye=gue(Fc,{productsCollection:"products",customersCollection:"customers"}),Ge=iW.projectId,Ve=t=>({userProfile:`artifacts/${Ge}/users/${t}/profiles/main`,userSubProfile:e=>`artifacts/${Ge}/users/${t}/profiles/${e}`,userPublicProfile:`artifacts/${Ge}/users/${t}/public_profile/main`,publicProfileCollectionGroup:"public_profile",publicFeed:`artifacts/${Ge}/public/data/posts`,serviceRequests:`artifacts/${Ge}/public/data/service_requests`,messages:`artifacts/${Ge}/public/data/direct_messages`,marketplaceItems:`artifacts/${Ge}/public/data/market_items`,userLibrary:`artifacts/${Ge}/users/${t}/library`,marketAssets:`artifacts/${Ge}/users/${t}/assets/market`,userWallet:`artifacts/${Ge}/users/${t}/wallet/account`,profileImages:`artifacts/${Ge}/users/${t}/images/profile`,equipmentSubmissions:`artifacts/${Ge}/public/data/equipment_submissions`,studentRecord:(e,n)=>`schools/${e}/students/${n}`,distributionReleases:`artifacts/${Ge}/distribution/${t}/releases`,royaltyReports:`artifacts/${Ge}/distribution/${t}/royalty_reports`,distributionStats:`artifacts/${Ge}/distribution/${t}/stats/main`,labelRoster:e=>`artifacts/${Ge}/labels/${e}/roster`,labelInvites:e=>`artifacts/${Ge}/labels/${e}/invites`,gearListings:`artifacts/${Ge}/public/data/gear_listings`,followers:`artifacts/${Ge}/users/${t}/followers`,following:`artifacts/${Ge}/users/${t}/following`,socialStats:`artifacts/${Ge}/users/${t}/stats/social`,notifications:`artifacts/${Ge}/users/${t}/notifications`,savedPosts:`artifacts/${Ge}/users/${t}/savedPosts`});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Sye={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tye=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),de=(t,e)=>{const n=N.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},h)=>N.createElement("svg",{ref:h,...Sye,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Tye(t)}`,l].join(" "),...d},[...e.map(([m,p])=>N.createElement(m,p)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=de("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=de("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=de("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cye=de("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=de("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=de("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iye=de("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=de("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aW=de("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=de("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=de("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jye=de("CameraOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=de("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lW=de("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dC=de("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=de("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=de("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=de("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cW=de("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=de("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=de("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=de("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aye=de("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rye=de("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uW=de("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pye=de("CornerDownRight",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dW=de("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lye=de("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hW=de("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mye=de("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=de("Disc",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=de("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=de("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fW=de("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oye=de("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dye=de("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=de("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=de("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pm=de("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=de("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=de("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=de("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vye=de("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fye=de("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ye=de("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bye=de("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=de("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zye=de("Images",[["path",{d:"M18 22H4a2 2 0 0 1-2-2V6",key:"pblm9e"}],["path",{d:"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18",key:"nf6bnh"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["rect",{width:"16",height:"16",x:"6",y:"2",rx:"2",key:"12espp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mW=de("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=de("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uye=de("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wye=de("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=de("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=de("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=de("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pW=de("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=de("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=de("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gW=de("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hye=de("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=de("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=de("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qye=de("Mic2",[["path",{d:"m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12",key:"zoua8r"}],["circle",{cx:"17",cy:"7",r:"5",key:"1fomce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gye=de("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JA=de("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kye=de("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=de("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yW=de("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xW=de("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vW=de("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qye=de("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=de("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bW=de("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=de("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=de("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=de("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uw=de("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=de("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=de("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=de("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=de("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=de("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zye=de("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=de("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=de("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _W=de("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=de("Sliders",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wW=de("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=de("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kW=de("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NW=de("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yye=de("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xye=de("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=de("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=de("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=de("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EW=de("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=de("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=de("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jye=de("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=de("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=de("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=de("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=de("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=de("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0e=de("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=de("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0e=de("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=de("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=de("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),rR=N.createContext({});function sR(t){const e=N.useRef(null);return e.current===null&&(e.current=t()),e.current}const w1=N.createContext(null),iR=N.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class n0e extends N.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function r0e({children:t,isPresent:e}){const n=N.useId(),r=N.useRef(null),s=N.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=N.useContext(iR);return N.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:d}=s.current;if(e||!r.current||!o||!l)return;r.current.dataset.motionPopId=n;const h=document.createElement("style");return i&&(h.nonce=i),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${c}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),a.jsx(n0e,{isPresent:e,childRef:r,sizeRef:s,children:N.cloneElement(t,{ref:r})})}const s0e=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=sR(i0e),c=N.useId(),d=N.useCallback(m=>{l.set(m,!0);for(const p of l.values())if(!p)return;r&&r()},[l,r]),h=N.useMemo(()=>({id:c,initial:e,isPresent:n,custom:s,onExitComplete:d,register:m=>(l.set(m,!1),()=>l.delete(m))}),i?[Math.random(),d]:[n,d]);return N.useMemo(()=>{l.forEach((m,p)=>l.set(p,!1))},[n]),N.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(t=a.jsx(r0e,{isPresent:n,children:t})),a.jsx(w1.Provider,{value:h,children:t})};function i0e(){return new Map}function SW(t=!0){const e=N.useContext(w1);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,i=N.useId();N.useEffect(()=>{t&&s(i)},[t]);const o=N.useCallback(()=>t&&r&&r(i),[i,r,t]);return!n&&r?[!1,o]:[!0]}const Ov=t=>t.key||"";function L4(t){const e=[];return N.Children.forEach(t,n=>{N.isValidElement(n)&&e.push(n)}),e}const oR=typeof window<"u",TW=oR?N.useLayoutEffect:N.useEffect,yr=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:o=!1})=>{const[l,c]=SW(o),d=N.useMemo(()=>L4(t),[t]),h=o&&!l?[]:d.map(Ov),m=N.useRef(!0),p=N.useRef(d),v=sR(()=>new Map),[x,b]=N.useState(d),[E,k]=N.useState(d);TW(()=>{m.current=!1,p.current=d;for(let T=0;T<E.length;T++){const P=Ov(E[T]);h.includes(P)?v.delete(P):v.get(P)!==!0&&v.set(P,!1)}},[E,h.length,h.join("-")]);const _=[];if(d!==x){let T=[...d];for(let P=0;P<E.length;P++){const j=E[P],R=Ov(j);h.includes(R)||(T.splice(P,0,j),_.push(j))}i==="wait"&&_.length&&(T=_),k(L4(T)),b(d);return}const{forceRender:S}=N.useContext(rR);return a.jsx(a.Fragment,{children:E.map(T=>{const P=Ov(T),j=o&&!l?!1:d===E||h.includes(P),R=()=>{if(v.has(P))v.set(P,!0);else return;let I=!0;v.forEach(O=>{O||(I=!1)}),I&&(S==null||S(),k(p.current),o&&(c==null||c()),r&&r())};return a.jsx(s0e,{isPresent:j,initial:!m.current||n?void 0:!1,custom:j?void 0:e,presenceAffectsLayout:s,mode:i,onExitComplete:j?void 0:R,children:T},P)})})},pi=t=>t;let CW=pi;function aR(t){let e;return()=>(e===void 0&&(e=t()),e)}const ym=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},za=t=>t*1e3,Ua=t=>t/1e3,o0e={useManualTiming:!1};function a0e(t){let e=new Set,n=new Set,r=!1,s=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(d){i.has(d)&&(c.schedule(d),t()),d(o)}const c={schedule:(d,h=!1,m=!1)=>{const v=m&&r?e:n;return h&&i.add(d),v.has(d)||v.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,r){s=!0;return}r=!0,[e,n]=[n,e],e.forEach(l),e.clear(),r=!1,s&&(s=!1,c.process(d))}};return c}const Dv=["read","resolveKeyframes","update","preRender","render","postRender"],l0e=40;function IW(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Dv.reduce((k,_)=>(k[_]=a0e(i),k),{}),{read:l,resolveKeyframes:c,update:d,preRender:h,render:m,postRender:p}=o,v=()=>{const k=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(k-s.timestamp,l0e),1),s.timestamp=k,s.isProcessing=!0,l.process(s),c.process(s),d.process(s),h.process(s),m.process(s),p.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(v))},x=()=>{n=!0,r=!0,s.isProcessing||t(v)};return{schedule:Dv.reduce((k,_)=>{const S=o[_];return k[_]=(T,P=!1,j=!1)=>(n||x(),S.schedule(T,P,j)),k},{}),cancel:k=>{for(let _=0;_<Dv.length;_++)o[Dv[_]].cancel(k)},state:s,steps:o}}const{schedule:Cn,cancel:zc,state:Gr,steps:dE}=IW(typeof requestAnimationFrame<"u"?requestAnimationFrame:pi,!0),jW=N.createContext({strict:!1}),M4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},xm={};for(const t in M4)xm[t]={isEnabled:e=>M4[t].some(n=>!!e[n])};function c0e(t){for(const e in t)xm[e]={...xm[e],...t[e]}}const u0e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hw(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||u0e.has(t)}let AW=t=>!hw(t);function d0e(t){t&&(AW=e=>e.startsWith("on")?!hw(e):t(e))}try{d0e(require("@emotion/is-prop-valid").default)}catch{}function h0e(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(AW(s)||n===!0&&hw(s)||!e&&!hw(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function f0e(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,s)=>s==="create"?t:(e.has(s)||e.set(s,t(s)),e.get(s))})}const k1=N.createContext({});function o0(t){return typeof t=="string"||Array.isArray(t)}function N1(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const lR=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],cR=["initial",...lR];function E1(t){return N1(t.animate)||cR.some(e=>o0(t[e]))}function RW(t){return!!(E1(t)||t.variants)}function m0e(t,e){if(E1(t)){const{initial:n,animate:r}=t;return{initial:n===!1||o0(n)?n:void 0,animate:o0(r)?r:void 0}}return t.inherit!==!1?e:{}}function p0e(t){const{initial:e,animate:n}=m0e(t,N.useContext(k1));return N.useMemo(()=>({initial:e,animate:n}),[O4(e),O4(n)])}function O4(t){return Array.isArray(t)?t.join(" "):t}const g0e=Symbol.for("motionComponentSymbol");function af(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function y0e(t,e,n){return N.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):af(n)&&(n.current=r))},[e])}const uR=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),x0e="framerAppearId",PW="data-"+uR(x0e),{schedule:dR}=IW(queueMicrotask,!1),LW=N.createContext({});function v0e(t,e,n,r,s){var i,o;const{visualElement:l}=N.useContext(k1),c=N.useContext(jW),d=N.useContext(w1),h=N.useContext(iR).reducedMotion,m=N.useRef(null);r=r||c.renderer,!m.current&&r&&(m.current=r(t,{visualState:e,parent:l,props:n,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:h}));const p=m.current,v=N.useContext(LW);p&&!p.projection&&s&&(p.type==="html"||p.type==="svg")&&b0e(m.current,n,s,v);const x=N.useRef(!1);N.useInsertionEffect(()=>{p&&x.current&&p.update(n,d)});const b=n[PW],E=N.useRef(!!b&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,b))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,b)));return TW(()=>{p&&(x.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),dR.render(p.render),E.current&&p.animationState&&p.animationState.animateChanges())}),N.useEffect(()=>{p&&(!E.current&&p.animationState&&p.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var k;(k=window.MotionHandoffMarkAsComplete)===null||k===void 0||k.call(window,b)}),E.current=!1))}),p}function b0e(t,e,n,r){const{layoutId:s,layout:i,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:d}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:MW(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||l&&af(l),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,layoutScroll:c,layoutRoot:d})}function MW(t){if(t)return t.options.allowProjection!==!1?t.projection:MW(t.parent)}function _0e({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){var i,o;t&&c0e(t);function l(d,h){let m;const p={...N.useContext(iR),...d,layoutId:w0e(d)},{isStatic:v}=p,x=p0e(d),b=r(d,v);if(!v&&oR){k0e();const E=N0e(p);m=E.MeasureLayout,x.visualElement=v0e(s,b,p,e,E.ProjectionNode)}return a.jsxs(k1.Provider,{value:x,children:[m&&x.visualElement?a.jsx(m,{visualElement:x.visualElement,...p}):null,n(s,d,y0e(b,x.visualElement,h),b,v,x.visualElement)]})}l.displayName=`motion.${typeof s=="string"?s:`create(${(o=(i=s.displayName)!==null&&i!==void 0?i:s.name)!==null&&o!==void 0?o:""})`}`;const c=N.forwardRef(l);return c[g0e]=s,c}function w0e({layoutId:t}){const e=N.useContext(rR).id;return e&&t!==void 0?e+"-"+t:t}function k0e(t,e){N.useContext(jW).strict}function N0e(t){const{drag:e,layout:n}=xm;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const E0e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function hR(t){return typeof t!="string"||t.includes("-")?!1:!!(E0e.indexOf(t)>-1||/[A-Z]/u.test(t))}function D4(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function fR(t,e,n,r){if(typeof e=="function"){const[s,i]=D4(r);e=e(n!==void 0?n:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=D4(r);e=e(n!==void 0?n:t.custom,s,i)}return e}const mC=t=>Array.isArray(t),S0e=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),T0e=t=>mC(t)?t[t.length-1]||0:t,fs=t=>!!(t&&t.getVelocity);function Tb(t){const e=fs(t)?t.get():t;return S0e(e)?e.toValue():e}function C0e({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},r,s,i){const o={latestValues:I0e(r,s,i,t),renderState:e()};return n&&(o.onMount=l=>n({props:r,current:l,...o}),o.onUpdate=l=>n(l)),o}const OW=t=>(e,n)=>{const r=N.useContext(k1),s=N.useContext(w1),i=()=>C0e(t,e,r,s);return n?i():sR(i)};function I0e(t,e,n,r){const s={},i=r(t,{});for(const p in i)s[p]=Tb(i[p]);let{initial:o,animate:l}=t;const c=E1(t),d=RW(t);e&&d&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const m=h?l:o;if(m&&typeof m!="boolean"&&!N1(m)){const p=Array.isArray(m)?m:[m];for(let v=0;v<p.length;v++){const x=fR(t,p[v]);if(x){const{transitionEnd:b,transition:E,...k}=x;for(const _ in k){let S=k[_];if(Array.isArray(S)){const T=h?S.length-1:0;S=S[T]}S!==null&&(s[_]=S)}for(const _ in b)s[_]=b[_]}}}return s}const Qm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Zd=new Set(Qm),DW=t=>e=>typeof e=="string"&&e.startsWith(t),VW=DW("--"),j0e=DW("var(--"),mR=t=>j0e(t)?A0e.test(t.split("/*")[0].trim()):!1,A0e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,FW=(t,e)=>e&&typeof t=="number"?e.transform(t):t,ol=(t,e,n)=>n>e?e:n<t?t:n,Zm={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},a0={...Zm,transform:t=>ol(0,1,t)},Vv={...Zm,default:1},fx=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ol=fx("deg"),Go=fx("%"),tt=fx("px"),R0e=fx("vh"),P0e=fx("vw"),V4={...Go,parse:t=>Go.parse(t)/100,transform:t=>Go.transform(t*100)},L0e={borderWidth:tt,borderTopWidth:tt,borderRightWidth:tt,borderBottomWidth:tt,borderLeftWidth:tt,borderRadius:tt,radius:tt,borderTopLeftRadius:tt,borderTopRightRadius:tt,borderBottomRightRadius:tt,borderBottomLeftRadius:tt,width:tt,maxWidth:tt,height:tt,maxHeight:tt,top:tt,right:tt,bottom:tt,left:tt,padding:tt,paddingTop:tt,paddingRight:tt,paddingBottom:tt,paddingLeft:tt,margin:tt,marginTop:tt,marginRight:tt,marginBottom:tt,marginLeft:tt,backgroundPositionX:tt,backgroundPositionY:tt},M0e={rotate:Ol,rotateX:Ol,rotateY:Ol,rotateZ:Ol,scale:Vv,scaleX:Vv,scaleY:Vv,scaleZ:Vv,skew:Ol,skewX:Ol,skewY:Ol,distance:tt,translateX:tt,translateY:tt,translateZ:tt,x:tt,y:tt,z:tt,perspective:tt,transformPerspective:tt,opacity:a0,originX:V4,originY:V4,originZ:tt},F4={...Zm,transform:Math.round},pR={...L0e,...M0e,zIndex:F4,size:tt,fillOpacity:a0,strokeOpacity:a0,numOctaves:F4},O0e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},D0e=Qm.length;function V0e(t,e,n){let r="",s=!0;for(let i=0;i<D0e;i++){const o=Qm[i],l=t[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const d=FW(l,pR[o]);if(!c){s=!1;const h=O0e[o]||o;r+=`${h}(${d}) `}n&&(e[o]=d)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function gR(t,e,n){const{style:r,vars:s,transformOrigin:i}=t;let o=!1,l=!1;for(const c in e){const d=e[c];if(Zd.has(c)){o=!0;continue}else if(VW(c)){s[c]=d;continue}else{const h=FW(d,pR[c]);c.startsWith("origin")?(l=!0,i[c]=h):r[c]=h}}if(e.transform||(o||n?r.transform=V0e(e,t.transform,n):r.transform&&(r.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:h=0}=i;r.transformOrigin=`${c} ${d} ${h}`}}const F0e={offset:"stroke-dashoffset",array:"stroke-dasharray"},$0e={offset:"strokeDashoffset",array:"strokeDasharray"};function B0e(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?F0e:$0e;t[i.offset]=tt.transform(-r);const o=tt.transform(e),l=tt.transform(n);t[i.array]=`${o} ${l}`}function $4(t,e,n){return typeof t=="string"?t:tt.transform(e+n*t)}function z0e(t,e,n){const r=$4(e,t.x,t.width),s=$4(n,t.y,t.height);return`${r} ${s}`}function yR(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...d},h,m){if(gR(t,d,m),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:v,dimensions:x}=t;p.transform&&(x&&(v.transform=p.transform),delete p.transform),x&&(s!==void 0||i!==void 0||v.transform)&&(v.transformOrigin=z0e(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(p.x=e),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),o!==void 0&&B0e(p,o,l,c,!1)}const xR=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),$W=()=>({...xR(),attrs:{}}),vR=t=>typeof t=="string"&&t.toLowerCase()==="svg";function BW(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const zW=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function UW(t,e,n,r){BW(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(zW.has(s)?s:uR(s),e.attrs[s])}const fw={};function U0e(t){Object.assign(fw,t)}function WW(t,{layout:e,layoutId:n}){return Zd.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!fw[t]||t==="opacity")}function bR(t,e,n){var r;const{style:s}=t,i={};for(const o in s)(fs(s[o])||e.style&&fs(e.style[o])||WW(o,t)||((r=n==null?void 0:n.getValue(o))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(i[o]=s[o]);return i}function HW(t,e,n){const r=bR(t,e,n);for(const s in t)if(fs(t[s])||fs(e[s])){const i=Qm.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=t[s]}return r}function W0e(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const B4=["x","y","width","height","cx","cy","r"],H0e={useVisualState:OW({scrapeMotionValuesFromProps:HW,createRenderState:$W,onUpdate:({props:t,prevProps:e,current:n,renderState:r,latestValues:s})=>{if(!n)return;let i=!!t.drag;if(!i){for(const l in s)if(Zd.has(l)){i=!0;break}}if(!i)return;let o=!e;if(e)for(let l=0;l<B4.length;l++){const c=B4[l];t[c]!==e[c]&&(o=!0)}o&&Cn.read(()=>{W0e(n,r),Cn.render(()=>{yR(r,s,vR(n.tagName),t.transformTemplate),UW(n,r)})})}})},q0e={useVisualState:OW({scrapeMotionValuesFromProps:bR,createRenderState:xR})};function qW(t,e,n){for(const r in e)!fs(e[r])&&!WW(r,n)&&(t[r]=e[r])}function G0e({transformTemplate:t},e){return N.useMemo(()=>{const n=xR();return gR(n,e,t),Object.assign({},n.vars,n.style)},[e])}function K0e(t,e){const n=t.style||{},r={};return qW(r,n,t),Object.assign(r,G0e(t,e)),r}function Q0e(t,e){const n={},r=K0e(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}function Z0e(t,e,n,r){const s=N.useMemo(()=>{const i=$W();return yR(i,e,vR(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};qW(i,t.style,t),s.style={...i,...s.style}}return s}function Y0e(t=!1){return(n,r,s,{latestValues:i},o)=>{const c=(hR(n)?Z0e:Q0e)(r,i,o,n),d=h0e(r,typeof n=="string",t),h=n!==N.Fragment?{...d,...c,ref:s}:{},{children:m}=r,p=N.useMemo(()=>fs(m)?m.get():m,[m]);return N.createElement(n,{...h,children:p})}}function X0e(t,e){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const o={...hR(r)?H0e:q0e,preloadedFeatures:t,useRender:Y0e(s),createVisualElement:e,Component:r};return _0e(o)}}function GW(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function S1(t,e,n){const r=t.getProps();return fR(r,e,n!==void 0?n:r.custom,t)}const J0e=aR(()=>window.ScrollTimeline!==void 0);class exe{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e,n){const r=this.animations.map(s=>{if(J0e()&&s.attachTimeline)return s.attachTimeline(e);if(typeof n=="function")return n(s)});return()=>{r.forEach((s,i)=>{s&&s(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class txe extends exe{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function _R(t,e){return t?t[e]||t.default||t:void 0}const pC=2e4;function KW(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<pC;)e+=n,r=t.next(e);return e>=pC?1/0:e}function wR(t){return typeof t=="function"}function z4(t,e){t.timeline=e,t.onfinish=null}const kR=t=>Array.isArray(t)&&typeof t[0]=="number",nxe={linearEasing:void 0};function rxe(t,e){const n=aR(t);return()=>{var r;return(r=nxe[e])!==null&&r!==void 0?r:n()}}const mw=rxe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),QW=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let i=0;i<s;i++)r+=t(ym(0,s-1,i))+", ";return`linear(${r.substring(0,r.length-2)})`};function ZW(t){return!!(typeof t=="function"&&mw()||!t||typeof t=="string"&&(t in gC||mw())||kR(t)||Array.isArray(t)&&t.every(ZW))}const xg=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,gC={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:xg([0,.65,.55,1]),circOut:xg([.55,0,1,.45]),backIn:xg([.31,.01,.66,-.59]),backOut:xg([.33,1.53,.69,.99])};function YW(t,e){if(t)return typeof t=="function"&&mw()?QW(t,e):kR(t)?xg(t):Array.isArray(t)?t.map(n=>YW(n,e)||gC.easeOut):gC[t]}const ro={x:!1,y:!1};function XW(){return ro.x||ro.y}function sxe(t,e,n){var r;if(t instanceof Element)return[t];if(typeof t=="string"){let s=document;const i=(r=void 0)!==null&&r!==void 0?r:s.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}function JW(t,e){const n=sxe(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function U4(t){return e=>{e.pointerType==="touch"||XW()||t(e)}}function ixe(t,e,n={}){const[r,s,i]=JW(t,n),o=U4(l=>{const{target:c}=l,d=e(l);if(typeof d!="function"||!c)return;const h=U4(m=>{d(m),c.removeEventListener("pointerleave",h)});c.addEventListener("pointerleave",h,s)});return r.forEach(l=>{l.addEventListener("pointerenter",o,s)}),i}const eH=(t,e)=>e?t===e?!0:eH(t,e.parentElement):!1,NR=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,oxe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function axe(t){return oxe.has(t.tagName)||t.tabIndex!==-1}const vg=new WeakSet;function W4(t){return e=>{e.key==="Enter"&&t(e)}}function hE(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const lxe=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=W4(()=>{if(vg.has(n))return;hE(n,"down");const s=W4(()=>{hE(n,"up")}),i=()=>hE(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function H4(t){return NR(t)&&!XW()}function cxe(t,e,n={}){const[r,s,i]=JW(t,n),o=l=>{const c=l.currentTarget;if(!H4(l)||vg.has(c))return;vg.add(c);const d=e(l),h=(v,x)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",p),!(!H4(v)||!vg.has(c))&&(vg.delete(c),typeof d=="function"&&d(v,{success:x}))},m=v=>{h(v,n.useGlobalTarget||eH(c,v.target))},p=v=>{h(v,!1)};window.addEventListener("pointerup",m,s),window.addEventListener("pointercancel",p,s)};return r.forEach(l=>{!axe(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(n.useGlobalTarget?window:l).addEventListener("pointerdown",o,s),l.addEventListener("focus",d=>lxe(d,s),s)}),i}function uxe(t){return t==="x"||t==="y"?ro[t]?null:(ro[t]=!0,()=>{ro[t]=!1}):ro.x||ro.y?null:(ro.x=ro.y=!0,()=>{ro.x=ro.y=!1})}const tH=new Set(["width","height","top","left","right","bottom",...Qm]);let Cb;function dxe(){Cb=void 0}const Ko={now:()=>(Cb===void 0&&Ko.set(Gr.isProcessing||o0e.useManualTiming?Gr.timestamp:performance.now()),Cb),set:t=>{Cb=t,queueMicrotask(dxe)}};function ER(t,e){t.indexOf(e)===-1&&t.push(e)}function SR(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class TR{constructor(){this.subscriptions=[]}add(e){return ER(this.subscriptions,e),()=>SR(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function nH(t,e){return e?t*(1e3/e):0}const q4=30,hxe=t=>!isNaN(parseFloat(t));class fxe{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{const i=Ko.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Ko.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=hxe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new TR);const r=this.events[e].add(n);return e==="change"?()=>{r(),Cn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ko.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>q4)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,q4);return nH(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function l0(t,e){return new fxe(t,e)}function mxe(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,l0(n))}function pxe(t,e){const n=S1(t,e);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const o in i){const l=T0e(i[o]);mxe(t,o,l)}}function gxe(t){return!!(fs(t)&&t.add)}function yC(t,e){const n=t.getValue("willChange");if(gxe(n))return n.add(e)}function rH(t){return t.props[PW]}const sH=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,yxe=1e-7,xxe=12;function vxe(t,e,n,r,s){let i,o,l=0;do o=e+(n-e)/2,i=sH(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>yxe&&++l<xxe);return o}function mx(t,e,n,r){if(t===e&&n===r)return pi;const s=i=>vxe(i,0,1,t,n);return i=>i===0||i===1?i:sH(s(i),e,r)}const iH=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,oH=t=>e=>1-t(1-e),aH=mx(.33,1.53,.69,.99),CR=oH(aH),lH=iH(CR),cH=t=>(t*=2)<1?.5*CR(t):.5*(2-Math.pow(2,-10*(t-1))),IR=t=>1-Math.sin(Math.acos(t)),uH=oH(IR),dH=iH(IR),hH=t=>/^0[^.\s]+$/u.test(t);function bxe(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||hH(t):!0}const Xg=t=>Math.round(t*1e5)/1e5,jR=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function _xe(t){return t==null}const wxe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,AR=(t,e)=>n=>!!(typeof n=="string"&&wxe.test(n)&&n.startsWith(t)||e&&!_xe(n)&&Object.prototype.hasOwnProperty.call(n,e)),fH=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,i,o,l]=r.match(jR);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},kxe=t=>ol(0,255,t),fE={...Zm,transform:t=>Math.round(kxe(t))},Fu={test:AR("rgb","red"),parse:fH("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+fE.transform(t)+", "+fE.transform(e)+", "+fE.transform(n)+", "+Xg(a0.transform(r))+")"};function Nxe(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const xC={test:AR("#"),parse:Nxe,transform:Fu.transform},lf={test:AR("hsl","hue"),parse:fH("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Go.transform(Xg(e))+", "+Go.transform(Xg(n))+", "+Xg(a0.transform(r))+")"},os={test:t=>Fu.test(t)||xC.test(t)||lf.test(t),parse:t=>Fu.test(t)?Fu.parse(t):lf.test(t)?lf.parse(t):xC.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Fu.transform(t):lf.transform(t)},Exe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Sxe(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(jR))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Exe))===null||n===void 0?void 0:n.length)||0)>0}const mH="number",pH="color",Txe="var",Cxe="var(",G4="${}",Ixe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function c0(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const l=e.replace(Ixe,c=>(os.test(c)?(r.color.push(i),s.push(pH),n.push(os.parse(c))):c.startsWith(Cxe)?(r.var.push(i),s.push(Txe),n.push(c)):(r.number.push(i),s.push(mH),n.push(parseFloat(c))),++i,G4)).split(G4);return{values:n,split:l,indexes:r,types:s}}function gH(t){return c0(t).values}function yH(t){const{split:e,types:n}=c0(t),r=e.length;return s=>{let i="";for(let o=0;o<r;o++)if(i+=e[o],s[o]!==void 0){const l=n[o];l===mH?i+=Xg(s[o]):l===pH?i+=os.transform(s[o]):i+=s[o]}return i}}const jxe=t=>typeof t=="number"?0:t;function Axe(t){const e=gH(t);return yH(t)(e.map(jxe))}const Uc={test:Sxe,parse:gH,createTransformer:yH,getAnimatableNone:Axe},Rxe=new Set(["brightness","contrast","saturate","opacity"]);function Pxe(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(jR)||[];if(!r)return t;const s=n.replace(r,"");let i=Rxe.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const Lxe=/\b([a-z-]*)\(.*?\)/gu,vC={...Uc,getAnimatableNone:t=>{const e=t.match(Lxe);return e?e.map(Pxe).join(" "):t}},Mxe={...pR,color:os,backgroundColor:os,outlineColor:os,fill:os,stroke:os,borderColor:os,borderTopColor:os,borderRightColor:os,borderBottomColor:os,borderLeftColor:os,filter:vC,WebkitFilter:vC},RR=t=>Mxe[t];function xH(t,e){let n=RR(t);return n!==vC&&(n=Uc),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Oxe=new Set(["auto","none","0"]);function Dxe(t,e,n){let r=0,s;for(;r<t.length&&!s;){const i=t[r];typeof i=="string"&&!Oxe.has(i)&&c0(i).values.length&&(s=t[r]),r++}if(s&&n)for(const i of e)t[i]=xH(n,s)}const K4=t=>t===Zm||t===tt,Q4=(t,e)=>parseFloat(t.split(", ")[e]),Z4=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/u);if(s)return Q4(s[1],e);{const i=r.match(/^matrix\((.+)\)$/u);return i?Q4(i[1],t):0}},Vxe=new Set(["x","y","z"]),Fxe=Qm.filter(t=>!Vxe.has(t));function $xe(t){const e=[];return Fxe.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const vm={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Z4(4,13),y:Z4(5,14)};vm.translateX=vm.x;vm.translateY=vm.y;const Ju=new Set;let bC=!1,_C=!1;function vH(){if(_C){const t=Array.from(Ju).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=$xe(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,o])=>{var l;(l=r.getValue(i))===null||l===void 0||l.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}_C=!1,bC=!1,Ju.forEach(t=>t.complete()),Ju.clear()}function bH(){Ju.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(_C=!0)})}function Bxe(){bH(),vH()}class PR{constructor(e,n,r,s,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ju.add(this),bC||(bC=!0,Cn.read(bH),Cn.resolveKeyframes(vH))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=s==null?void 0:s.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(r&&n){const c=r.readValue(n,l);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=l),s&&o===void 0&&s.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Ju.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ju.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const _H=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),zxe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Uxe(t){const e=zxe.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function wH(t,e,n=1){const[r,s]=Uxe(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return _H(o)?parseFloat(o):o}return mR(s)?wH(s,e,n+1):s}const kH=t=>e=>e.test(t),Wxe={test:t=>t==="auto",parse:t=>t},NH=[Zm,tt,Go,Ol,P0e,R0e,Wxe],Y4=t=>NH.find(kH(t));class EH extends PR{constructor(e,n,r,s,i){super(e,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let d=e[c];if(typeof d=="string"&&(d=d.trim(),mR(d))){const h=wH(d,n.current);h!==void 0&&(e[c]=h),c===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!tH.has(r)||e.length!==2)return;const[s,i]=e,o=Y4(s),l=Y4(i);if(o!==l)if(K4(o)&&K4(l))for(let c=0;c<e.length;c++){const d=e[c];typeof d=="string"&&(e[c]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)bxe(e[s])&&r.push(s);r.length&&Dxe(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=vm[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:s}=this;if(!n||!n.current)return;const i=n.getValue(r);i&&i.jump(this.measuredOrigin,!1);const o=s.length-1,l=s[o];s[o]=vm[r](n.measureViewportBox(),window.getComputedStyle(n.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,d])=>{n.getValue(c).set(d)}),this.resolveNoneKeyframes()}}const X4=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Uc.test(t)||t==="0")&&!t.startsWith("url("));function Hxe(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function qxe(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=X4(s,e),l=X4(i,e);return!o||!l?!1:Hxe(t)||(n==="spring"||wR(n))&&r}const Gxe=t=>t!==null;function T1(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(Gxe),i=e&&n!=="loop"&&e%2===1?0:s.length-1;return!i||r===void 0?s[i]:r}const Kxe=40;class SH{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ko.now(),this.options={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Kxe?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Bxe(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Ko.now(),this.hasAttemptedResolve=!0;const{name:r,type:s,velocity:i,delay:o,onComplete:l,onUpdate:c,isGenerator:d}=this.options;if(!d&&!qxe(e,r,s,i))if(o)this.options.duration=0;else{c&&c(T1(e,this.options,n)),l&&l(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,n);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...h},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Bn=(t,e,n)=>t+(e-t)*n;function mE(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Qxe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=mE(c,l,t+1/3),i=mE(c,l,t),o=mE(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}function pw(t,e){return n=>n>0?e:t}const pE=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},Zxe=[xC,Fu,lf],Yxe=t=>Zxe.find(e=>e.test(t));function J4(t){const e=Yxe(t);if(!e)return!1;let n=e.parse(t);return e===lf&&(n=Qxe(n)),n}const e5=(t,e)=>{const n=J4(t),r=J4(e);if(!n||!r)return pw(t,e);const s={...n};return i=>(s.red=pE(n.red,r.red,i),s.green=pE(n.green,r.green,i),s.blue=pE(n.blue,r.blue,i),s.alpha=Bn(n.alpha,r.alpha,i),Fu.transform(s))},Xxe=(t,e)=>n=>e(t(n)),px=(...t)=>t.reduce(Xxe),wC=new Set(["none","hidden"]);function Jxe(t,e){return wC.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function eve(t,e){return n=>Bn(t,e,n)}function LR(t){return typeof t=="number"?eve:typeof t=="string"?mR(t)?pw:os.test(t)?e5:rve:Array.isArray(t)?TH:typeof t=="object"?os.test(t)?e5:tve:pw}function TH(t,e){const n=[...t],r=n.length,s=t.map((i,o)=>LR(i)(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}}function tve(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=LR(t[s])(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function nve(t,e){var n;const r=[],s={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],l=t.indexes[o][s[o]],c=(n=t.values[l])!==null&&n!==void 0?n:0;r[i]=c,s[o]++}return r}const rve=(t,e)=>{const n=Uc.createTransformer(e),r=c0(t),s=c0(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?wC.has(t)&&!s.values.length||wC.has(e)&&!r.values.length?Jxe(t,e):px(TH(nve(r,s),s.values),n):pw(t,e)};function CH(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Bn(t,e,n):LR(t)(t,e)}const sve=5;function IH(t,e,n){const r=Math.max(e-sve,0);return nH(n-t(r),e-r)}const Qn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},gE=.001;function ive({duration:t=Qn.duration,bounce:e=Qn.bounce,velocity:n=Qn.velocity,mass:r=Qn.mass}){let s,i,o=1-e;o=ol(Qn.minDamping,Qn.maxDamping,o),t=ol(Qn.minDuration,Qn.maxDuration,Ua(t)),o<1?(s=d=>{const h=d*o,m=h*t,p=h-n,v=kC(d,o),x=Math.exp(-m);return gE-p/v*x},i=d=>{const m=d*o*t,p=m*n+n,v=Math.pow(o,2)*Math.pow(d,2)*t,x=Math.exp(-m),b=kC(Math.pow(d,2),o);return(-s(d)+gE>0?-1:1)*((p-v)*x)/b}):(s=d=>{const h=Math.exp(-d*t),m=(d-n)*t+1;return-gE+h*m},i=d=>{const h=Math.exp(-d*t),m=(n-d)*(t*t);return h*m});const l=5/t,c=ave(s,i,l);if(t=za(t),isNaN(c))return{stiffness:Qn.stiffness,damping:Qn.damping,duration:t};{const d=Math.pow(c,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const ove=12;function ave(t,e,n){let r=n;for(let s=1;s<ove;s++)r=r-t(r)/e(r);return r}function kC(t,e){return t*Math.sqrt(1-e*e)}const lve=["duration","bounce"],cve=["stiffness","damping","mass"];function t5(t,e){return e.some(n=>t[n]!==void 0)}function uve(t){let e={velocity:Qn.velocity,stiffness:Qn.stiffness,damping:Qn.damping,mass:Qn.mass,isResolvedFromDuration:!1,...t};if(!t5(t,cve)&&t5(t,lve))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*ol(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Qn.mass,stiffness:s,damping:i}}else{const n=ive(t);e={...e,...n,mass:Qn.mass},e.isResolvedFromDuration=!0}return e}function jH(t=Qn.visualDuration,e=Qn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:d,mass:h,duration:m,velocity:p,isResolvedFromDuration:v}=uve({...n,velocity:-Ua(n.velocity||0)}),x=p||0,b=d/(2*Math.sqrt(c*h)),E=o-i,k=Ua(Math.sqrt(c/h)),_=Math.abs(E)<5;r||(r=_?Qn.restSpeed.granular:Qn.restSpeed.default),s||(s=_?Qn.restDelta.granular:Qn.restDelta.default);let S;if(b<1){const P=kC(k,b);S=j=>{const R=Math.exp(-b*k*j);return o-R*((x+b*k*E)/P*Math.sin(P*j)+E*Math.cos(P*j))}}else if(b===1)S=P=>o-Math.exp(-k*P)*(E+(x+k*E)*P);else{const P=k*Math.sqrt(b*b-1);S=j=>{const R=Math.exp(-b*k*j),I=Math.min(P*j,300);return o-R*((x+b*k*E)*Math.sinh(I)+P*E*Math.cosh(I))/P}}const T={calculatedDuration:v&&m||null,next:P=>{const j=S(P);if(v)l.done=P>=m;else{let R=0;b<1&&(R=P===0?za(x):IH(S,P,j));const I=Math.abs(R)<=r,O=Math.abs(o-j)<=s;l.done=I&&O}return l.value=l.done?o:j,l},toString:()=>{const P=Math.min(KW(T),pC),j=QW(R=>T.next(P*R).value,P,30);return P+"ms "+j}};return T}function n5({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:h}){const m=t[0],p={done:!1,value:m},v=I=>l!==void 0&&I<l||c!==void 0&&I>c,x=I=>l===void 0?c:c===void 0||Math.abs(l-I)<Math.abs(c-I)?l:c;let b=n*e;const E=m+b,k=o===void 0?E:o(E);k!==E&&(b=k-m);const _=I=>-b*Math.exp(-I/r),S=I=>k+_(I),T=I=>{const O=_(I),D=S(I);p.done=Math.abs(O)<=d,p.value=p.done?k:D};let P,j;const R=I=>{v(p.value)&&(P=I,j=jH({keyframes:[p.value,x(p.value)],velocity:IH(S,I,p.value),damping:s,stiffness:i,restDelta:d,restSpeed:h}))};return R(0),{calculatedDuration:null,next:I=>{let O=!1;return!j&&P===void 0&&(O=!0,T(I),R(I)),P!==void 0&&I>=P?j.next(I-P):(!O&&T(I),p)}}}const dve=mx(.42,0,1,1),hve=mx(0,0,.58,1),AH=mx(.42,0,.58,1),fve=t=>Array.isArray(t)&&typeof t[0]!="number",mve={linear:pi,easeIn:dve,easeInOut:AH,easeOut:hve,circIn:IR,circInOut:dH,circOut:uH,backIn:CR,backInOut:lH,backOut:aH,anticipate:cH},r5=t=>{if(kR(t)){CW(t.length===4);const[e,n,r,s]=t;return mx(e,n,r,s)}else if(typeof t=="string")return mve[t];return t};function pve(t,e,n){const r=[],s=n||CH,i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||pi:e;l=px(c,l)}r.push(l)}return r}function gve(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(CW(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const l=pve(e,r,s),c=l.length,d=h=>{if(o&&h<t[0])return e[0];let m=0;if(c>1)for(;m<t.length-2&&!(h<t[m+1]);m++);const p=ym(t[m],t[m+1],h);return l[m](p)};return n?h=>d(ol(t[0],t[i-1],h)):d}function yve(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=ym(0,e,r);t.push(Bn(n,1,s))}}function xve(t){const e=[0];return yve(e,t.length-1),e}function vve(t,e){return t.map(n=>n*e)}function bve(t,e){return t.map(()=>e||AH).splice(0,t.length-1)}function gw({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=fve(r)?r.map(r5):r5(r),i={done:!1,value:e[0]},o=vve(n&&n.length===e.length?n:xve(e),t),l=gve(o,e,{ease:Array.isArray(s)?s:bve(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}const _ve=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Cn.update(e,!0),stop:()=>zc(e),now:()=>Gr.isProcessing?Gr.timestamp:Ko.now()}},wve={decay:n5,inertia:n5,tween:gw,keyframes:gw,spring:jH},kve=t=>t/100;class MR extends SH{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:n,motionValue:r,element:s,keyframes:i}=this.options,o=(s==null?void 0:s.KeyframeResolver)||PR,l=(c,d)=>this.onKeyframesResolved(c,d);this.resolver=new o(i,l,n,r,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=this.options,l=wR(n)?n:wve[n]||gw;let c,d;l!==gw&&typeof e[0]!="number"&&(c=px(kve,CH(e[0],e[1])),e=[0,100]);const h=l({...this.options,keyframes:e});i==="mirror"&&(d=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=KW(h));const{calculatedDuration:m}=h,p=m+s,v=p*(r+1)-s;return{generator:h,mirroredGenerator:d,mapPercentToKeyframes:c,calculatedDuration:m,resolvedDuration:p,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:I}=this.options;return{done:!0,value:I[I.length-1]}}const{finalKeyframe:s,generator:i,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:c,calculatedDuration:d,totalDuration:h,resolvedDuration:m}=r;if(this.startTime===null)return i.next(0);const{delay:p,repeat:v,repeatType:x,repeatDelay:b,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const k=this.currentTime-p*(this.speed>=0?1:-1),_=this.speed>=0?k<0:k>h;this.currentTime=Math.max(k,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let S=this.currentTime,T=i;if(v){const I=Math.min(this.currentTime,h)/m;let O=Math.floor(I),D=I%1;!D&&I>=1&&(D=1),D===1&&O--,O=Math.min(O,v+1),!!(O%2)&&(x==="reverse"?(D=1-D,b&&(D-=b/m)):x==="mirror"&&(T=o)),S=ol(0,1,D)*m}const P=_?{done:!1,value:c[0]}:T.next(S);l&&(P.value=l(P.value));let{done:j}=P;!_&&d!==null&&(j=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return R&&s!==void 0&&(P.value=T1(c,this.options,s)),E&&E(P.value),R&&this.finish(),P}get duration(){const{resolved:e}=this;return e?Ua(e.calculatedDuration):0}get time(){return Ua(this.currentTime)}set time(e){e=za(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ua(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=_ve,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Nve=new Set(["opacity","clipPath","filter","transform"]);function Eve(t,e,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:l="easeInOut",times:c}={}){const d={[e]:n};c&&(d.offset=c);const h=YW(l,s);return Array.isArray(h)&&(d.easing=h),t.animate(d,{delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const Sve=aR(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),yw=10,Tve=2e4;function Cve(t){return wR(t.type)||t.type==="spring"||!ZW(t.ease)}function Ive(t,e){const n=new MR({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const s=[];let i=0;for(;!r.done&&i<Tve;)r=n.sample(i),s.push(r.value),i+=yw;return{times:void 0,keyframes:s,duration:i-yw,ease:"linear"}}const RH={anticipate:cH,backInOut:lH,circInOut:dH};function jve(t){return t in RH}class s5 extends SH{constructor(e){super(e);const{name:n,motionValue:r,element:s,keyframes:i}=this.options;this.resolver=new EH(i,(o,l)=>this.onKeyframesResolved(o,l),n,r,s),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:r=300,times:s,ease:i,type:o,motionValue:l,name:c,startTime:d}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof i=="string"&&mw()&&jve(i)&&(i=RH[i]),Cve(this.options)){const{onComplete:m,onUpdate:p,motionValue:v,element:x,...b}=this.options,E=Ive(e,b);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,s=E.times,i=E.ease,o="keyframes"}const h=Eve(l.owner.current,c,e,{...this.options,duration:r,times:s,ease:i});return h.startTime=d??this.calcStartTime(),this.pendingTimeline?(z4(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:m}=this.options;l.set(T1(e,this.options,n)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:s,type:o,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Ua(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Ua(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=za(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return pi;const{animation:r}=n;z4(r,e)}return pi}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:s,type:i,ease:o,times:l}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:h,onComplete:m,element:p,...v}=this.options,x=new MR({...v,keyframes:r,duration:s,type:i,ease:o,times:l,isGenerator:!0}),b=za(this.time);d.setWithVelocity(x.sample(b-yw).value,x.sample(b).value,yw)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:s,repeatType:i,damping:o,type:l}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=n.owner.getProps();return Sve()&&r&&Nve.has(r)&&!c&&!d&&!s&&i!=="mirror"&&o!==0&&l!=="inertia"}}const Ave={type:"spring",stiffness:500,damping:25,restSpeed:10},Rve=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Pve={type:"keyframes",duration:.8},Lve={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Mve=(t,{keyframes:e})=>e.length>2?Pve:Zd.has(t)?t.startsWith("scale")?Rve(e[1]):Ave:Lve;function Ove({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:d,...h}){return!!Object.keys(h).length}const OR=(t,e,n,r={},s,i)=>o=>{const l=_R(r,t)||{},c=l.delay||r.delay||0;let{elapsed:d=0}=r;d=d-za(c);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-d,onUpdate:p=>{e.set(p),l.onUpdate&&l.onUpdate(p)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:t,motionValue:e,element:i?void 0:s};Ove(l)||(h={...h,...Mve(t,h)}),h.duration&&(h.duration=za(h.duration)),h.repeatDelay&&(h.repeatDelay=za(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let m=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(m=!0)),m&&!i&&e.get()!==void 0){const p=T1(h.keyframes,l);if(p!==void 0)return Cn.update(()=>{h.onUpdate(p),h.onComplete()}),new txe([])}return!i&&s5.supports(h)?new s5(h):new MR(h)};function Dve({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function PH(t,e,{delay:n=0,transitionOverride:r,type:s}={}){var i;let{transition:o=t.getDefaultTransition(),transitionEnd:l,...c}=e;r&&(o=r);const d=[],h=s&&t.animationState&&t.animationState.getState()[s];for(const m in c){const p=t.getValue(m,(i=t.latestValues[m])!==null&&i!==void 0?i:null),v=c[m];if(v===void 0||h&&Dve(h,m))continue;const x={delay:n,..._R(o||{},m)};let b=!1;if(window.MotionHandoffAnimation){const k=rH(t);if(k){const _=window.MotionHandoffAnimation(k,m,Cn);_!==null&&(x.startTime=_,b=!0)}}yC(t,m),p.start(OR(m,p,v,t.shouldReduceMotion&&tH.has(m)?{type:!1}:x,t,b));const E=p.animation;E&&d.push(E)}return l&&Promise.all(d).then(()=>{Cn.update(()=>{l&&pxe(t,l)})}),d}function NC(t,e,n={}){var r;const s=S1(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(i=n.transitionOverride);const o=s?()=>Promise.all(PH(t,s,n)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(d=0)=>{const{delayChildren:h=0,staggerChildren:m,staggerDirection:p}=i;return Vve(t,e,h+d,m,p,n)}:()=>Promise.resolve(),{when:c}=i;if(c){const[d,h]=c==="beforeChildren"?[o,l]:[l,o];return d().then(()=>h())}else return Promise.all([o(),l(n.delay)])}function Vve(t,e,n=0,r=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*r,c=s===1?(d=0)=>d*r:(d=0)=>l-d*r;return Array.from(t.variantChildren).sort(Fve).forEach((d,h)=>{d.notify("AnimationStart",e),o.push(NC(d,e,{...i,delay:n+c(h)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(o)}function Fve(t,e){return t.sortNodePosition(e)}function $ve(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>NC(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=NC(t,e,n);else{const s=typeof e=="function"?S1(t,e,n.custom):e;r=Promise.all(PH(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const Bve=cR.length;function LH(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?LH(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<Bve;n++){const r=cR[n],s=t.props[r];(o0(s)||s===!1)&&(e[r]=s)}return e}const zve=[...lR].reverse(),Uve=lR.length;function Wve(t){return e=>Promise.all(e.map(({animation:n,options:r})=>$ve(t,n,r)))}function Hve(t){let e=Wve(t),n=i5(),r=!0;const s=c=>(d,h)=>{var m;const p=S1(t,h,c==="exit"?(m=t.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(p){const{transition:v,transitionEnd:x,...b}=p;d={...d,...b,...x}}return d};function i(c){e=c(t)}function o(c){const{props:d}=t,h=LH(t.parent)||{},m=[],p=new Set;let v={},x=1/0;for(let E=0;E<Uve;E++){const k=zve[E],_=n[k],S=d[k]!==void 0?d[k]:h[k],T=o0(S),P=k===c?_.isActive:null;P===!1&&(x=E);let j=S===h[k]&&S!==d[k]&&T;if(j&&r&&t.manuallyAnimateOnMount&&(j=!1),_.protectedKeys={...v},!_.isActive&&P===null||!S&&!_.prevProp||N1(S)||typeof S=="boolean")continue;const R=qve(_.prevProp,S);let I=R||k===c&&_.isActive&&!j&&T||E>x&&T,O=!1;const D=Array.isArray(S)?S:[S];let F=D.reduce(s(k),{});P===!1&&(F={});const{prevResolvedValues:V={}}=_,$={...V,...F},J=le=>{I=!0,p.has(le)&&(O=!0,p.delete(le)),_.needsAnimating[le]=!0;const q=t.getValue(le);q&&(q.liveStyle=!1)};for(const le in $){const q=F[le],Q=V[le];if(v.hasOwnProperty(le))continue;let H=!1;mC(q)&&mC(Q)?H=!GW(q,Q):H=q!==Q,H?q!=null?J(le):p.add(le):q!==void 0&&p.has(le)?J(le):_.protectedKeys[le]=!0}_.prevProp=S,_.prevResolvedValues=F,_.isActive&&(v={...v,...F}),r&&t.blockInitialAnimation&&(I=!1),I&&(!(j&&R)||O)&&m.push(...D.map(le=>({animation:le,options:{type:k}})))}if(p.size){const E={};p.forEach(k=>{const _=t.getBaseTarget(k),S=t.getValue(k);S&&(S.liveStyle=!0),E[k]=_??null}),m.push({animation:E})}let b=!!m.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(b=!1),r=!1,b?e(m):Promise.resolve()}function l(c,d){var h;if(n[c].isActive===d)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(p=>{var v;return(v=p.animationState)===null||v===void 0?void 0:v.setActive(c,d)}),n[c].isActive=d;const m=o(c);for(const p in n)n[p].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n,reset:()=>{n=i5(),r=!0}}}function qve(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!GW(e,t):!1}function yu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function i5(){return{animate:yu(!0),whileInView:yu(),whileHover:yu(),whileTap:yu(),whileDrag:yu(),whileFocus:yu(),exit:yu()}}class ru{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Gve extends ru{constructor(e){super(e),e.animationState||(e.animationState=Hve(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();N1(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Kve=0;class Qve extends ru{constructor(){super(...arguments),this.id=Kve++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Zve={animation:{Feature:Gve},exit:{Feature:Qve}};function u0(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function gx(t){return{point:{x:t.pageX,y:t.pageY}}}const Yve=t=>e=>NR(e)&&t(e,gx(e));function Jg(t,e,n,r){return u0(t,e,Yve(n),r)}const o5=(t,e)=>Math.abs(t-e);function Xve(t,e){const n=o5(t.x,e.x),r=o5(t.y,e.y);return Math.sqrt(n**2+r**2)}class MH{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=xE(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,v=Xve(m.offset,{x:0,y:0})>=3;if(!p&&!v)return;const{point:x}=m,{timestamp:b}=Gr;this.history.push({...x,timestamp:b});const{onStart:E,onMove:k}=this.handlers;p||(E&&E(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,m)},this.handlePointerMove=(m,p)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=yE(p,this.transformPagePoint),Cn.update(this.updatePoint,!0)},this.handlePointerUp=(m,p)=>{this.end();const{onEnd:v,onSessionEnd:x,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=xE(m.type==="pointercancel"?this.lastMoveEventInfo:yE(p,this.transformPagePoint),this.history);this.startEvent&&v&&v(m,E),x&&x(m,E)},!NR(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=gx(e),l=yE(o,this.transformPagePoint),{point:c}=l,{timestamp:d}=Gr;this.history=[{...c,timestamp:d}];const{onSessionStart:h}=n;h&&h(e,xE(l,this.history)),this.removeListeners=px(Jg(this.contextWindow,"pointermove",this.handlePointerMove),Jg(this.contextWindow,"pointerup",this.handlePointerUp),Jg(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),zc(this.updatePoint)}}function yE(t,e){return e?{point:e(t.point)}:t}function a5(t,e){return{x:t.x-e.x,y:t.y-e.y}}function xE({point:t},e){return{point:t,delta:a5(t,OH(e)),offset:a5(t,Jve(e)),velocity:ebe(e,.1)}}function Jve(t){return t[0]}function OH(t){return t[t.length-1]}function ebe(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=OH(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>za(e)));)n--;if(!r)return{x:0,y:0};const i=Ua(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const DH=1e-4,tbe=1-DH,nbe=1+DH,VH=.01,rbe=0-VH,sbe=0+VH;function vi(t){return t.max-t.min}function ibe(t,e,n){return Math.abs(t-e)<=n}function l5(t,e,n,r=.5){t.origin=r,t.originPoint=Bn(e.min,e.max,t.origin),t.scale=vi(n)/vi(e),t.translate=Bn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=tbe&&t.scale<=nbe||isNaN(t.scale))&&(t.scale=1),(t.translate>=rbe&&t.translate<=sbe||isNaN(t.translate))&&(t.translate=0)}function ey(t,e,n,r){l5(t.x,e.x,n.x,r?r.originX:void 0),l5(t.y,e.y,n.y,r?r.originY:void 0)}function c5(t,e,n){t.min=n.min+e.min,t.max=t.min+vi(e)}function obe(t,e,n){c5(t.x,e.x,n.x),c5(t.y,e.y,n.y)}function u5(t,e,n){t.min=e.min-n.min,t.max=t.min+vi(e)}function ty(t,e,n){u5(t.x,e.x,n.x),u5(t.y,e.y,n.y)}function abe(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Bn(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Bn(n,t,r.max):Math.min(t,n)),t}function d5(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function lbe(t,{top:e,left:n,bottom:r,right:s}){return{x:d5(t.x,n,s),y:d5(t.y,e,r)}}function h5(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function cbe(t,e){return{x:h5(t.x,e.x),y:h5(t.y,e.y)}}function ube(t,e){let n=.5;const r=vi(t),s=vi(e);return s>r?n=ym(e.min,e.max-r,t.min):r>s&&(n=ym(t.min,t.max-s,e.min)),ol(0,1,n)}function dbe(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const EC=.35;function hbe(t=EC){return t===!1?t=0:t===!0&&(t=EC),{x:f5(t,"left","right"),y:f5(t,"top","bottom")}}function f5(t,e,n){return{min:m5(t,e),max:m5(t,n)}}function m5(t,e){return typeof t=="number"?t:t[e]||0}const p5=()=>({translate:0,scale:1,origin:0,originPoint:0}),cf=()=>({x:p5(),y:p5()}),g5=()=>({min:0,max:0}),ir=()=>({x:g5(),y:g5()});function Ri(t){return[t("x"),t("y")]}function FH({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function fbe({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function mbe(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function vE(t){return t===void 0||t===1}function SC({scale:t,scaleX:e,scaleY:n}){return!vE(t)||!vE(e)||!vE(n)}function Nu(t){return SC(t)||$H(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function $H(t){return y5(t.x)||y5(t.y)}function y5(t){return t&&t!=="0%"}function xw(t,e,n){const r=t-n,s=e*r;return n+s}function x5(t,e,n,r,s){return s!==void 0&&(t=xw(t,s,r)),xw(t,n,r)+e}function TC(t,e=0,n=1,r,s){t.min=x5(t.min,e,n,r,s),t.max=x5(t.max,e,n,r,s)}function BH(t,{x:e,y:n}){TC(t.x,e.translate,e.scale,e.originPoint),TC(t.y,n.translate,n.scale,n.originPoint)}const v5=.999999999999,b5=1.0000000000001;function pbe(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=n[l],o=i.projectionDelta;const{visualElement:c}=i.options;c&&c.props.style&&c.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&df(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,BH(t,o)),r&&Nu(i.latestValues)&&df(t,i.latestValues))}e.x<b5&&e.x>v5&&(e.x=1),e.y<b5&&e.y>v5&&(e.y=1)}function uf(t,e){t.min=t.min+e,t.max=t.max+e}function _5(t,e,n,r,s=.5){const i=Bn(t.min,t.max,s);TC(t,e,n,i,r)}function df(t,e){_5(t.x,e.x,e.scaleX,e.scale,e.originX),_5(t.y,e.y,e.scaleY,e.scale,e.originY)}function zH(t,e){return FH(mbe(t.getBoundingClientRect(),e))}function gbe(t,e,n){const r=zH(t,n),{scroll:s}=e;return s&&(uf(r.x,s.offset.x),uf(r.y,s.offset.y)),r}const UH=({current:t})=>t?t.ownerDocument.defaultView:null,ybe=new WeakMap;class xbe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ir(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=h=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(gx(h).point)},i=(h,m)=>{const{drag:p,dragPropagation:v,onDragStart:x}=this.getProps();if(p&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=uxe(p),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ri(E=>{let k=this.getAxisMotionValue(E).get()||0;if(Go.test(k)){const{projection:_}=this.visualElement;if(_&&_.layout){const S=_.layout.layoutBox[E];S&&(k=vi(S)*(parseFloat(k)/100))}}this.originPoint[E]=k}),x&&Cn.postRender(()=>x(h,m)),yC(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},o=(h,m)=>{const{dragPropagation:p,dragDirectionLock:v,onDirectionLock:x,onDrag:b}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:E}=m;if(v&&this.currentDirection===null){this.currentDirection=vbe(E),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",m.point,E),this.updateAxis("y",m.point,E),this.visualElement.render(),b&&b(h,m)},l=(h,m)=>this.stop(h,m),c=()=>Ri(h=>{var m;return this.getAnimationState(h)==="paused"&&((m=this.getAxisMotionValue(h).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new MH(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:UH(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&Cn.postRender(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Fv(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=abe(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&af(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=lbe(s.layoutBox,n):this.constraints=!1,this.elastic=hbe(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Ri(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=dbe(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!af(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=gbe(r,s.root,this.visualElement.getTransformPagePoint());let o=cbe(s.layout.layoutBox,i);if(n){const l=n(fbe(o));this.hasMutatedConstraints=!!l,l&&(o=FH(l))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Ri(h=>{if(!Fv(h,n,this.currentDirection))return;let m=c&&c[h]||{};o&&(m={min:0,max:0});const p=s?200:1e6,v=s?40:1e7,x={type:"inertia",velocity:r?e[h]:0,bounceStiffness:p,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...i,...m};return this.startAxisValueAnimation(h,x)});return Promise.all(d).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return yC(this.visualElement,e),r.start(OR(e,r,0,n,this.visualElement,!1))}stopAnimation(){Ri(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ri(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ri(n=>{const{drag:r}=this.getProps();if(!Fv(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[n];i.set(e[n]-Bn(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!af(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ri(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();s[o]=ube({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ri(o=>{if(!Fv(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];l.set(Bn(c,d,s[o]))})}addListeners(){if(!this.visualElement.current)return;ybe.set(this.visualElement,this);const e=this.visualElement.current,n=Jg(e,"pointerdown",c=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();af(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Cn.read(r);const o=u0(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ri(h=>{const m=this.getAxisMotionValue(h);m&&(this.originPoint[h]+=c[h].translate,m.set(m.get()+c[h].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=EC,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Fv(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function vbe(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class bbe extends ru{constructor(e){super(e),this.removeGroupControls=pi,this.removeListeners=pi,this.controls=new xbe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pi}unmount(){this.removeGroupControls(),this.removeListeners()}}const w5=t=>(e,n)=>{t&&Cn.postRender(()=>t(e,n))};class _be extends ru{constructor(){super(...arguments),this.removePointerDownListener=pi}onPointerDown(e){this.session=new MH(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:UH(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:w5(e),onStart:w5(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&Cn.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=Jg(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ib={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function k5(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Kp={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(tt.test(t))t=parseFloat(t);else return t;const n=k5(t,e.target.x),r=k5(t,e.target.y);return`${n}% ${r}%`}},wbe={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=Uc.parse(t);if(s.length>5)return r;const i=Uc.createTransformer(t),o=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const d=Bn(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=d),typeof s[3+o]=="number"&&(s[3+o]/=d),i(s)}};class kbe extends N.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;U0e(Nbe),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Ib.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Cn.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),dR.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function WH(t){const[e,n]=SW(),r=N.useContext(rR);return a.jsx(kbe,{...t,layoutGroup:r,switchLayoutGroup:N.useContext(LW),isPresent:e,safeToRemove:n})}const Nbe={borderRadius:{...Kp,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Kp,borderTopRightRadius:Kp,borderBottomLeftRadius:Kp,borderBottomRightRadius:Kp,boxShadow:wbe};function Ebe(t,e,n){const r=fs(t)?t:l0(t);return r.start(OR("",r,e,n)),r.animation}function Sbe(t){return t instanceof SVGElement&&t.tagName!=="svg"}const Tbe=(t,e)=>t.depth-e.depth;class Cbe{constructor(){this.children=[],this.isDirty=!1}add(e){ER(this.children,e),this.isDirty=!0}remove(e){SR(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Tbe),this.isDirty=!1,this.children.forEach(e)}}function Ibe(t,e){const n=Ko.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(zc(r),t(i-e))};return Cn.read(r,!0),()=>zc(r)}const HH=["TopLeft","TopRight","BottomLeft","BottomRight"],jbe=HH.length,N5=t=>typeof t=="string"?parseFloat(t):t,E5=t=>typeof t=="number"||tt.test(t);function Abe(t,e,n,r,s,i){s?(t.opacity=Bn(0,n.opacity!==void 0?n.opacity:1,Rbe(r)),t.opacityExit=Bn(e.opacity!==void 0?e.opacity:1,0,Pbe(r))):i&&(t.opacity=Bn(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<jbe;o++){const l=`border${HH[o]}Radius`;let c=S5(e,l),d=S5(n,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||E5(c)===E5(d)?(t[l]=Math.max(Bn(N5(c),N5(d),r),0),(Go.test(d)||Go.test(c))&&(t[l]+="%")):t[l]=d}(e.rotate||n.rotate)&&(t.rotate=Bn(e.rotate||0,n.rotate||0,r))}function S5(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Rbe=qH(0,.5,uH),Pbe=qH(.5,.95,pi);function qH(t,e,n){return r=>r<t?0:r>e?1:n(ym(t,e,r))}function T5(t,e){t.min=e.min,t.max=e.max}function Ai(t,e){T5(t.x,e.x),T5(t.y,e.y)}function C5(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function I5(t,e,n,r,s){return t-=e,t=xw(t,1/n,r),s!==void 0&&(t=xw(t,1/s,r)),t}function Lbe(t,e=0,n=1,r=.5,s,i=t,o=t){if(Go.test(e)&&(e=parseFloat(e),e=Bn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Bn(i.min,i.max,r);t===i&&(l-=e),t.min=I5(t.min,e,n,l,s),t.max=I5(t.max,e,n,l,s)}function j5(t,e,[n,r,s],i,o){Lbe(t,e[n],e[r],e[s],e.scale,i,o)}const Mbe=["x","scaleX","originX"],Obe=["y","scaleY","originY"];function A5(t,e,n,r){j5(t.x,e,Mbe,n?n.x:void 0,r?r.x:void 0),j5(t.y,e,Obe,n?n.y:void 0,r?r.y:void 0)}function R5(t){return t.translate===0&&t.scale===1}function GH(t){return R5(t.x)&&R5(t.y)}function P5(t,e){return t.min===e.min&&t.max===e.max}function Dbe(t,e){return P5(t.x,e.x)&&P5(t.y,e.y)}function L5(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function KH(t,e){return L5(t.x,e.x)&&L5(t.y,e.y)}function M5(t){return vi(t.x)/vi(t.y)}function O5(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Vbe{constructor(){this.members=[]}add(e){ER(this.members,e),e.scheduleRender()}remove(e){if(SR(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Fbe(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((s||i||o)&&(r=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:d,rotate:h,rotateX:m,rotateY:p,skewX:v,skewY:x}=n;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),m&&(r+=`rotateX(${m}deg) `),p&&(r+=`rotateY(${p}deg) `),v&&(r+=`skewX(${v}deg) `),x&&(r+=`skewY(${x}deg) `)}const l=t.x.scale*e.x,c=t.y.scale*e.y;return(l!==1||c!==1)&&(r+=`scale(${l}, ${c})`),r||"none"}const Eu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},bg=typeof window<"u"&&window.MotionDebug!==void 0,bE=["","X","Y","Z"],$be={visibility:"hidden"},D5=1e3;let Bbe=0;function _E(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function QH(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=rH(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Cn,!(s||i))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&QH(r)}function ZH({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=Bbe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,bg&&(Eu.totalNodes=Eu.resolvedTargetDeltas=Eu.recalculatedProjection=0),this.nodes.forEach(Wbe),this.nodes.forEach(Qbe),this.nodes.forEach(Zbe),this.nodes.forEach(Hbe),bg&&window.MotionDebug.record(Eu)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Cbe)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new TR),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Sbe(o),this.instance=o;const{layoutId:c,layout:d,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),t){let m;const p=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=Ibe(p,250),Ib.hasAnimatedSinceResize&&(Ib.hasAnimatedSinceResize=!1,this.nodes.forEach(F5))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&h&&(c||d)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:p,hasRelativeTargetChanged:v,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||h.getDefaultTransition()||t_e,{onLayoutAnimationStart:E,onLayoutAnimationComplete:k}=h.getProps(),_=!this.targetLayout||!KH(this.targetLayout,x)||v,S=!p&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||p&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,S);const T={..._R(b,"layout"),onPlay:E,onComplete:k};(h.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T)}else p||F5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,zc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Ybe),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&QH(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const m=this.path[h];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(V5);return}this.isUpdating||this.nodes.forEach(Gbe),this.isUpdating=!1,this.nodes.forEach(Kbe),this.nodes.forEach(zbe),this.nodes.forEach(Ube),this.clearAllSnapshots();const l=Ko.now();Gr.delta=ol(0,1e3/60,l-Gr.timestamp),Gr.timestamp=l,Gr.isProcessing=!0,dE.update.process(Gr),dE.preRender.process(Gr),dE.render.process(Gr),Gr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,dR.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(qbe),this.sharedNodes.forEach(Xbe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Cn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Cn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ir(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const c=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!GH(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&(l||Nu(this.latestValues)||h)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),n_e(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return ir();const c=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(r_e))){const{scroll:h}=this.root;h&&(uf(c.x,h.offset.x),uf(c.y,h.offset.y))}return c}removeElementScroll(o){var l;const c=ir();if(Ai(c,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return c;for(let d=0;d<this.path.length;d++){const h=this.path[d],{scroll:m,options:p}=h;h!==this.root&&m&&p.layoutScroll&&(m.wasRoot&&Ai(c,o),uf(c.x,m.offset.x),uf(c.y,m.offset.y))}return c}applyTransform(o,l=!1){const c=ir();Ai(c,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!l&&h.options.layoutScroll&&h.scroll&&h!==h.root&&df(c,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Nu(h.latestValues)&&df(c,h.latestValues)}return Nu(this.latestValues)&&df(c,this.latestValues),c}removeTransform(o){const l=ir();Ai(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Nu(d.latestValues))continue;SC(d.latestValues)&&d.updateSnapshot();const h=ir(),m=d.measurePageBox();Ai(h,m),A5(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Nu(this.latestValues)&&A5(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Gr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:p}=this.options;if(!(!this.layout||!(m||p))){if(this.resolvedRelativeTargetAt=Gr.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ir(),this.relativeTargetOrigin=ir(),ty(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),Ai(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ir(),this.targetWithTransforms=ir()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),obe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ai(this.target,this.layout.layoutBox),BH(this.target,this.targetDelta)):Ai(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ir(),this.relativeTargetOrigin=ir(),ty(this.relativeTargetOrigin,this.target,v.target),Ai(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}bg&&Eu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||SC(this.parent.latestValues)||$H(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Gr.timestamp&&(d=!1),d)return;const{layout:h,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||m))return;Ai(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,v=this.treeScale.y;pbe(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=ir());const{target:x}=l;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(C5(this.prevProjectionDelta.x,this.projectionDelta.x),C5(this.prevProjectionDelta.y,this.projectionDelta.y)),ey(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==v||!O5(this.projectionDelta.x,this.prevProjectionDelta.x)||!O5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),bg&&Eu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=cf(),this.projectionDelta=cf(),this.projectionDeltaWithTransform=cf()}setAnimationOrigin(o,l=!1){const c=this.snapshot,d=c?c.latestValues:{},h={...this.latestValues},m=cf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const p=ir(),v=c?c.source:void 0,x=this.layout?this.layout.source:void 0,b=v!==x,E=this.getStack(),k=!E||E.members.length<=1,_=!!(b&&!k&&this.options.crossfade===!0&&!this.path.some(e_e));this.animationProgress=0;let S;this.mixTargetDelta=T=>{const P=T/1e3;$5(m.x,o.x,P),$5(m.y,o.y,P),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ty(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Jbe(this.relativeTarget,this.relativeTargetOrigin,p,P),S&&Dbe(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=ir()),Ai(S,this.relativeTarget)),b&&(this.animationValues=h,Abe(h,d,this.latestValues,P,_,k)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(zc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Cn.update(()=>{Ib.hasAnimatedSinceResize=!0,this.currentAnimation=Ebe(0,D5,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(D5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:h}=o;if(!(!l||!c||!d)){if(this!==o&&this.layout&&d&&YH(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||ir();const m=vi(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+m;const p=vi(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+p}Ai(l,c),df(l,h),ey(this.projectionDeltaWithTransform,this.layoutCorrected,l,h)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Vbe),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&_E("z",o,d,this.animationValues);for(let h=0;h<bE.length;h++)_E(`rotate${bE[h]}`,o,d,this.animationValues),_E(`skew${bE[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return $be;const d={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Tb(o==null?void 0:o.pointerEvents)||"",d.transform=h?h(this.latestValues,""):"none",d;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=Tb(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Nu(this.latestValues)&&(b.transform=h?h({},""):"none",this.hasProjected=!1),b}const p=m.animationValues||m.latestValues;this.applyTransformsToTarget(),d.transform=Fbe(this.projectionDeltaWithTransform,this.treeScale,p),h&&(d.transform=h(p,d.transform));const{x:v,y:x}=this.projectionDelta;d.transformOrigin=`${v.origin*100}% ${x.origin*100}% 0`,m.animationValues?d.opacity=m===this?(c=(l=p.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:d.opacity=m===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const b in fw){if(p[b]===void 0)continue;const{correct:E,applyTo:k}=fw[b],_=d.transform==="none"?p[b]:E(p[b],m);if(k){const S=k.length;for(let T=0;T<S;T++)d[k[T]]=_}else d[b]=_}return this.options.layoutId&&(d.pointerEvents=m===this?Tb(o==null?void 0:o.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(V5),this.root.sharedNodes.clear()}}}function zbe(t){t.updateLayout()}function Ube(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?Ri(m=>{const p=o?n.measuredBox[m]:n.layoutBox[m],v=vi(p);p.min=r[m].min,p.max=p.min+v}):YH(i,n.layoutBox,r)&&Ri(m=>{const p=o?n.measuredBox[m]:n.layoutBox[m],v=vi(r[m]);p.max=p.min+v,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+v)});const l=cf();ey(l,r,n.layoutBox);const c=cf();o?ey(c,t.applyTransform(s,!0),n.measuredBox):ey(c,r,n.layoutBox);const d=!GH(l);let h=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:p,layout:v}=m;if(p&&v){const x=ir();ty(x,n.layoutBox,p.layoutBox);const b=ir();ty(b,r,v.layoutBox),KH(x,b)||(h=!0),m.options.layoutRoot&&(t.relativeTarget=b,t.relativeTargetOrigin=x,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Wbe(t){bg&&Eu.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Hbe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function qbe(t){t.clearSnapshot()}function V5(t){t.clearMeasurements()}function Gbe(t){t.isLayoutDirty=!1}function Kbe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function F5(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Qbe(t){t.resolveTargetDelta()}function Zbe(t){t.calcProjection()}function Ybe(t){t.resetSkewAndRotation()}function Xbe(t){t.removeLeadSnapshot()}function $5(t,e,n){t.translate=Bn(e.translate,0,n),t.scale=Bn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function B5(t,e,n,r){t.min=Bn(e.min,n.min,r),t.max=Bn(e.max,n.max,r)}function Jbe(t,e,n,r){B5(t.x,e.x,n.x,r),B5(t.y,e.y,n.y,r)}function e_e(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const t_e={duration:.45,ease:[.4,0,.1,1]},z5=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),U5=z5("applewebkit/")&&!z5("chrome/")?Math.round:pi;function W5(t){t.min=U5(t.min),t.max=U5(t.max)}function n_e(t){W5(t.x),W5(t.y)}function YH(t,e,n){return t==="position"||t==="preserve-aspect"&&!ibe(M5(e),M5(n),.2)}function r_e(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const s_e=ZH({attachResizeListener:(t,e)=>u0(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),wE={current:void 0},XH=ZH({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!wE.current){const t=new s_e({});t.mount(window),t.setOptions({layoutScroll:!0}),wE.current=t}return wE.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),i_e={pan:{Feature:_be},drag:{Feature:bbe,ProjectionNode:XH,MeasureLayout:WH}};function H5(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&Cn.postRender(()=>i(e,gx(e)))}class o_e extends ru{mount(){const{current:e}=this.node;e&&(this.unmount=ixe(e,n=>(H5(this.node,n,"Start"),r=>H5(this.node,r,"End"))))}unmount(){}}class a_e extends ru{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=px(u0(this.node.current,"focus",()=>this.onFocus()),u0(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function q5(t,e,n){const{props:r}=t;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&Cn.postRender(()=>i(e,gx(e)))}class l_e extends ru{mount(){const{current:e}=this.node;e&&(this.unmount=cxe(e,n=>(q5(this.node,n,"Start"),(r,{success:s})=>q5(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const CC=new WeakMap,kE=new WeakMap,c_e=t=>{const e=CC.get(t.target);e&&e(t)},u_e=t=>{t.forEach(c_e)};function d_e({root:t,...e}){const n=t||document;kE.has(n)||kE.set(n,{});const r=kE.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(u_e,{root:t,...e})),r[s]}function h_e(t,e,n){const r=d_e(e);return CC.set(t,n),r.observe(t),()=>{CC.delete(t),r.unobserve(t)}}const f_e={some:0,all:1};class m_e extends ru{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:f_e[s]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:m}=this.node.getProps(),p=d?h:m;p&&p(c)};return h_e(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(p_e(e,n))&&this.startObserver()}unmount(){}}function p_e({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const g_e={inView:{Feature:m_e},tap:{Feature:l_e},focus:{Feature:a_e},hover:{Feature:o_e}},y_e={layout:{ProjectionNode:XH,MeasureLayout:WH}},IC={current:null},JH={current:!1};function x_e(){if(JH.current=!0,!!oR)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>IC.current=t.matches;t.addListener(e),e()}else IC.current=!1}const v_e=[...NH,os,Uc],b_e=t=>v_e.find(kH(t)),G5=new WeakMap;function __e(t,e,n){for(const r in e){const s=e[r],i=n[r];if(fs(s))t.addValue(r,s);else if(fs(i))t.addValue(r,l0(s,{owner:t}));else if(i!==s)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(r);t.addValue(r,l0(o!==void 0?o:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const K5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class w_e{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=PR,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=Ko.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Cn.render(this.render,!1,!0))};const{latestValues:c,renderState:d,onUpdate:h}=o;this.onUpdate=h,this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=d,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=E1(n),this.isVariantNode=RW(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const v in p){const x=p[v];c[v]!==void 0&&fs(x)&&x.set(c[v],!1)}}mount(e){this.current=e,G5.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),JH.current||x_e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:IC.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){G5.delete(this.current),this.projection&&this.projection.unmount(),zc(this.notifyUpdate),zc(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Zd.has(e),s=n.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Cn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in xm){const n=xm[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ir()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<K5.length;r++){const s=K5[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=__e(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=l0(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(_H(s)||hH(s))?s=parseFloat(s):!b_e(s)&&Uc.test(n)&&(s=xH(e,n)),this.setBaseTarget(e,fs(s)?s.get():s)),fs(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const o=fR(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(s=o[e])}if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!fs(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new TR),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class eq extends w_e{constructor(){super(...arguments),this.KeyframeResolver=EH}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;fs(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function k_e(t){return window.getComputedStyle(t)}class N_e extends eq{constructor(){super(...arguments),this.type="html",this.renderInstance=BW}readValueFromInstance(e,n){if(Zd.has(n)){const r=RR(n);return r&&r.default||0}else{const r=k_e(e),s=(VW(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return zH(e,n)}build(e,n,r){gR(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return bR(e,n,r)}}class E_e extends eq{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ir}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Zd.has(n)){const r=RR(n);return r&&r.default||0}return n=zW.has(n)?n:uR(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return HW(e,n,r)}build(e,n,r){yR(e,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,r,s){UW(e,n,r,s)}mount(e){this.isSVGTag=vR(e.tagName),super.mount(e)}}const S_e=(t,e)=>hR(t)?new E_e(e):new N_e(e,{allowProjection:t!==N.Fragment}),T_e=X0e({...Zve,...g_e,...i_e,...y_e},S_e),nt=f0e(T_e);let C_e={data:""},I_e=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||C_e},j_e=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,A_e=/\/\*[^]*?\*\/|  +/g,Q5=/\n+/g,Zl=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?Zl(o,i):i+"{"+Zl(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=Zl(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Zl.p?Zl.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},_a={},tq=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+tq(t[n]);return e}return t},R_e=(t,e,n,r,s)=>{let i=tq(t),o=_a[i]||(_a[i]=(c=>{let d=0,h=11;for(;d<c.length;)h=101*h+c.charCodeAt(d++)>>>0;return"go"+h})(i));if(!_a[o]){let c=i!==t?t:(d=>{let h,m,p=[{}];for(;h=j_e.exec(d.replace(A_e,""));)h[4]?p.shift():h[3]?(m=h[3].replace(Q5," ").trim(),p.unshift(p[0][m]=p[0][m]||{})):p[0][h[1]]=h[2].replace(Q5," ").trim();return p[0]})(t);_a[o]=Zl(s?{["@keyframes "+o]:c}:c,n?"":"."+o)}let l=n&&_a.g?_a.g:null;return n&&(_a.g=_a[o]),((c,d,h,m)=>{m?d.data=d.data.replace(m,c):d.data.indexOf(c)===-1&&(d.data=h?c+d.data:d.data+c)})(_a[o],e,r,l),o},P_e=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let l=o(n),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":Zl(l,""):l===!1?"":l}return r+s+(o??"")},"");function C1(t){let e=this||{},n=t.call?t(e.p):t;return R_e(n.unshift?n.raw?P_e(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,I_e(e.target),e.g,e.o,e.k)}let nq,jC,AC;C1.bind({g:1});let al=C1.bind({k:1});function L_e(t,e,n,r){Zl.p=e,nq=t,jC=n,AC=r}function su(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let l=Object.assign({},i),c=l.className||s.className;n.p=Object.assign({theme:jC&&jC()},l),n.o=/ *go\d+/.test(c),l.className=C1.apply(n,r)+(c?" "+c:"");let d=t;return t[0]&&(d=l.as||t,delete l.as),AC&&d[0]&&AC(l),nq(d,l)}return s}}var M_e=t=>typeof t=="function",vw=(t,e)=>M_e(t)?t(e):t,O_e=(()=>{let t=0;return()=>(++t).toString()})(),rq=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),D_e=20,DR="default",sq=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return sq(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},jb=[],iq={toasts:[],pausedAt:void 0,settings:{toastLimit:D_e}},Vo={},oq=(t,e=DR)=>{Vo[e]=sq(Vo[e]||iq,t),jb.forEach(([n,r])=>{n===e&&r(Vo[e])})},aq=t=>Object.keys(Vo).forEach(e=>oq(t,e)),V_e=t=>Object.keys(Vo).find(e=>Vo[e].toasts.some(n=>n.id===t)),I1=(t=DR)=>e=>{oq(e,t)},F_e={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},$_e=(t={},e=DR)=>{let[n,r]=N.useState(Vo[e]||iq),s=N.useRef(Vo[e]);N.useEffect(()=>(s.current!==Vo[e]&&r(Vo[e]),jb.push([e,r]),()=>{let o=jb.findIndex(([l])=>l===e);o>-1&&jb.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var l,c,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((l=t[o.type])==null?void 0:l.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((c=t[o.type])==null?void 0:c.duration)||(t==null?void 0:t.duration)||F_e[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},B_e=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||O_e()}),yx=t=>(e,n)=>{let r=B_e(e,t,n);return I1(r.toasterId||V_e(r.id))({type:2,toast:r}),r.id},_r=(t,e)=>yx("blank")(t,e);_r.error=yx("error");_r.success=yx("success");_r.loading=yx("loading");_r.custom=yx("custom");_r.dismiss=(t,e)=>{let n={type:3,toastId:t};e?I1(e)(n):aq(n)};_r.dismissAll=t=>_r.dismiss(void 0,t);_r.remove=(t,e)=>{let n={type:4,toastId:t};e?I1(e)(n):aq(n)};_r.removeAll=t=>_r.remove(void 0,t);_r.promise=(t,e,n)=>{let r=_r.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?vw(e.success,s):void 0;return i?_r.success(i,{id:r,...n,...n==null?void 0:n.success}):_r.dismiss(r),s}).catch(s=>{let i=e.error?vw(e.error,s):void 0;i?_r.error(i,{id:r,...n,...n==null?void 0:n.error}):_r.dismiss(r)}),t};var z_e=1e3,U_e=(t,e="default")=>{let{toasts:n,pausedAt:r}=$_e(t,e),s=N.useRef(new Map).current,i=N.useCallback((m,p=z_e)=>{if(s.has(m))return;let v=setTimeout(()=>{s.delete(m),o({type:4,toastId:m})},p);s.set(m,v)},[]);N.useEffect(()=>{if(r)return;let m=Date.now(),p=n.map(v=>{if(v.duration===1/0)return;let x=(v.duration||0)+v.pauseDuration-(m-v.createdAt);if(x<0){v.visible&&_r.dismiss(v.id);return}return setTimeout(()=>_r.dismiss(v.id,e),x)});return()=>{p.forEach(v=>v&&clearTimeout(v))}},[n,r,e]);let o=N.useCallback(I1(e),[e]),l=N.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=N.useCallback((m,p)=>{o({type:1,toast:{id:m,height:p}})},[o]),d=N.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),h=N.useCallback((m,p)=>{let{reverseOrder:v=!1,gutter:x=8,defaultPosition:b}=p||{},E=n.filter(S=>(S.position||b)===(m.position||b)&&S.height),k=E.findIndex(S=>S.id===m.id),_=E.filter((S,T)=>T<k&&S.visible).length;return E.filter(S=>S.visible).slice(...v?[_+1]:[0,_]).reduce((S,T)=>S+(T.height||0)+x,0)},[n]);return N.useEffect(()=>{n.forEach(m=>{if(m.dismissed)i(m.id,m.removeDelay);else{let p=s.get(m.id);p&&(clearTimeout(p),s.delete(m.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:l,endPause:d,calculateOffset:h}}},W_e=al`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,H_e=al`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,q_e=al`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,G_e=su("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${W_e} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${H_e} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${q_e} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,K_e=al`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Q_e=su("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${K_e} 1s linear infinite;
`,Z_e=al`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Y_e=al`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,X_e=su("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Z_e} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Y_e} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,J_e=su("div")`
  position: absolute;
`,ewe=su("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,twe=al`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,nwe=su("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${twe} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,rwe=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?N.createElement(nwe,null,e):e:n==="blank"?null:N.createElement(ewe,null,N.createElement(Q_e,{...r}),n!=="loading"&&N.createElement(J_e,null,n==="error"?N.createElement(G_e,{...r}):N.createElement(X_e,{...r})))},swe=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,iwe=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,owe="0%{opacity:0;} 100%{opacity:1;}",awe="0%{opacity:1;} 100%{opacity:0;}",lwe=su("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,cwe=su("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,uwe=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=rq()?[owe,awe]:[swe(n),iwe(n)];return{animation:e?`${al(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${al(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},dwe=N.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?uwe(t.position||e||"top-center",t.visible):{opacity:0},i=N.createElement(rwe,{toast:t}),o=N.createElement(cwe,{...t.ariaProps},vw(t.message,t));return N.createElement(lwe,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):N.createElement(N.Fragment,null,i,o))});L_e(N.createElement);var hwe=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=N.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;r(t,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return N.createElement("div",{ref:i,className:e,style:n},s)},fwe=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:rq()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},mwe=C1`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,$v=16,pwe=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:d}=U_e(n,i);return N.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:$v,left:$v,right:$v,bottom:$v,pointerEvents:"none",...o},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let m=h.position||e,p=d.calculateOffset(h,{reverseOrder:t,gutter:r,defaultPosition:e}),v=fwe(m,p);return N.createElement(hwe,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?mwe:"",style:v},h.type==="custom"?vw(h.message,h):s?s(h):N.createElement(dwe,{toast:h,position:m}))}))},un=_r;const lq="/assets/SeshNx-PNG%20cCropped%20white%20text-BvB6QJif.png",cq="/assets/SeshNx-PNG%20cCropped-mikqxod_.png";function uq(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=uq(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Id(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=uq(t))&&(r&&(r+=" "),r+=e);return r}const VR="-",gwe=t=>{const e=xwe(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const l=o.split(VR);return l[0]===""&&l.length!==1&&l.shift(),dq(l,e)||ywe(o)},getConflictingClassGroupIds:(o,l)=>{const c=n[o]||[];return l&&r[o]?[...c,...r[o]]:c}}},dq=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?dq(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(VR);return(o=e.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},Z5=/^\[(.+)\]$/,ywe=t=>{if(Z5.test(t)){const e=Z5.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},xwe=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return bwe(Object.entries(t.classGroups),n).forEach(([i,o])=>{RC(o,r,i,e)}),r},RC=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:Y5(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(vwe(s)){RC(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{RC(o,Y5(e,i),n,r)})})},Y5=(t,e)=>{let n=t;return e.split(VR).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},vwe=t=>t.isThemeGetter,bwe=(t,e)=>e?t.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[e+o,l])):i);return[n,s]}):t,_we=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},hq="!",wwe=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,s=e[0],i=e.length,o=l=>{const c=[];let d=0,h=0,m;for(let E=0;E<l.length;E++){let k=l[E];if(d===0){if(k===s&&(r||l.slice(E,E+i)===e)){c.push(l.slice(h,E)),h=E+i;continue}if(k==="/"){m=E;continue}}k==="["?d++:k==="]"&&d--}const p=c.length===0?l:l.substring(h),v=p.startsWith(hq),x=v?p.substring(1):p,b=m&&m>h?m-h:void 0;return{modifiers:c,hasImportantModifier:v,baseClassName:x,maybePostfixModifierPosition:b}};return n?l=>n({className:l,parseClassName:o}):o},kwe=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},Nwe=t=>({cache:_we(t.cacheSize),parseClassName:wwe(t),...gwe(t)}),Ewe=/\s+/,Swe=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=t.trim().split(Ewe);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:h,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:v}=n(d);let x=!!v,b=r(x?p.substring(0,v):p);if(!b){if(!x){l=d+(l.length>0?" "+l:l);continue}if(b=r(p),!b){l=d+(l.length>0?" "+l:l);continue}x=!1}const E=kwe(h).join(":"),k=m?E+hq:E,_=k+b;if(i.includes(_))continue;i.push(_);const S=s(b,x);for(let T=0;T<S.length;++T){const P=S[T];i.push(k+P)}l=d+(l.length>0?" "+l:l)}return l};function Twe(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=fq(e))&&(r&&(r+=" "),r+=n);return r}const fq=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=fq(t[r]))&&(n&&(n+=" "),n+=e);return n};function Cwe(t,...e){let n,r,s,i=o;function o(c){const d=e.reduce((h,m)=>m(h),t());return n=Nwe(d),r=n.cache.get,s=n.cache.set,i=l,l(c)}function l(c){const d=r(c);if(d)return d;const h=Swe(c,n);return s(c,h),h}return function(){return i(Twe.apply(null,arguments))}}const _n=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},mq=/^\[(?:([a-z-]+):)?(.+)\]$/i,Iwe=/^\d+\/\d+$/,jwe=new Set(["px","full","screen"]),Awe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Rwe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Pwe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Lwe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Mwe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,wa=t=>Cf(t)||jwe.has(t)||Iwe.test(t),Pl=t=>Ym(t,"length",Uwe),Cf=t=>!!t&&!Number.isNaN(Number(t)),NE=t=>Ym(t,"number",Cf),Qp=t=>!!t&&Number.isInteger(Number(t)),Owe=t=>t.endsWith("%")&&Cf(t.slice(0,-1)),kt=t=>mq.test(t),Ll=t=>Awe.test(t),Dwe=new Set(["length","size","percentage"]),Vwe=t=>Ym(t,Dwe,pq),Fwe=t=>Ym(t,"position",pq),$we=new Set(["image","url"]),Bwe=t=>Ym(t,$we,Hwe),zwe=t=>Ym(t,"",Wwe),Zp=()=>!0,Ym=(t,e,n)=>{const r=mq.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},Uwe=t=>Rwe.test(t)&&!Pwe.test(t),pq=()=>!1,Wwe=t=>Lwe.test(t),Hwe=t=>Mwe.test(t),qwe=()=>{const t=_n("colors"),e=_n("spacing"),n=_n("blur"),r=_n("brightness"),s=_n("borderColor"),i=_n("borderRadius"),o=_n("borderSpacing"),l=_n("borderWidth"),c=_n("contrast"),d=_n("grayscale"),h=_n("hueRotate"),m=_n("invert"),p=_n("gap"),v=_n("gradientColorStops"),x=_n("gradientColorStopPositions"),b=_n("inset"),E=_n("margin"),k=_n("opacity"),_=_n("padding"),S=_n("saturate"),T=_n("scale"),P=_n("sepia"),j=_n("skew"),R=_n("space"),I=_n("translate"),O=()=>["auto","contain","none"],D=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto",kt,e],V=()=>[kt,e],$=()=>["",wa,Pl],J=()=>["auto",Cf,kt],ue=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ve=()=>["solid","dashed","dotted","double","none"],le=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",kt],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],X=()=>[Cf,kt];return{cacheSize:500,separator:":",theme:{colors:[Zp],spacing:[wa,Pl],blur:["none","",Ll,kt],brightness:X(),borderColor:[t],borderRadius:["none","","full",Ll,kt],borderSpacing:V(),borderWidth:$(),contrast:X(),grayscale:Q(),hueRotate:X(),invert:Q(),gap:V(),gradientColorStops:[t],gradientColorStopPositions:[Owe,Pl],inset:F(),margin:F(),opacity:X(),padding:V(),saturate:X(),scale:X(),sepia:Q(),skew:X(),space:V(),translate:V()},classGroups:{aspect:[{aspect:["auto","square","video",kt]}],container:["container"],columns:[{columns:[Ll]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ue(),kt]}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qp,kt]}],basis:[{basis:F()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",kt]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Qp,kt]}],"grid-cols":[{"grid-cols":[Zp]}],"col-start-end":[{col:["auto",{span:["full",Qp,kt]},kt]}],"col-start":[{"col-start":J()}],"col-end":[{"col-end":J()}],"grid-rows":[{"grid-rows":[Zp]}],"row-start-end":[{row:["auto",{span:[Qp,kt]},kt]}],"row-start":[{"row-start":J()}],"row-end":[{"row-end":J()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",kt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",kt]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",kt,e]}],"min-w":[{"min-w":[kt,e,"min","max","fit"]}],"max-w":[{"max-w":[kt,e,"none","full","min","max","fit","prose",{screen:[Ll]},Ll]}],h:[{h:[kt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[kt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[kt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[kt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ll,Pl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",NE]}],"font-family":[{font:[Zp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",kt]}],"line-clamp":[{"line-clamp":["none",Cf,NE]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",wa,kt]}],"list-image":[{"list-image":["none",kt]}],"list-style-type":[{list:["none","disc","decimal",kt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[k]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[k]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ve(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",wa,Pl]}],"underline-offset":[{"underline-offset":["auto",wa,kt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:V()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",kt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",kt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[k]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ue(),Fwe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Vwe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Bwe]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[k]}],"border-style":[{border:[...ve(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[k]}],"divide-style":[{divide:ve()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...ve()]}],"outline-offset":[{"outline-offset":[wa,kt]}],"outline-w":[{outline:[wa,Pl]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:$()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[k]}],"ring-offset-w":[{"ring-offset":[wa,Pl]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ll,zwe]}],"shadow-color":[{shadow:[Zp]}],opacity:[{opacity:[k]}],"mix-blend":[{"mix-blend":[...le(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":le()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Ll,kt]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[m]}],saturate:[{saturate:[S]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[k]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",kt]}],duration:[{duration:X()}],ease:[{ease:["linear","in","out","in-out",kt]}],delay:[{delay:X()}],animate:[{animate:["none","spin","ping","pulse","bounce",kt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[Qp,kt]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",kt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",kt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":V()}],"scroll-mx":[{"scroll-mx":V()}],"scroll-my":[{"scroll-my":V()}],"scroll-ms":[{"scroll-ms":V()}],"scroll-me":[{"scroll-me":V()}],"scroll-mt":[{"scroll-mt":V()}],"scroll-mr":[{"scroll-mr":V()}],"scroll-mb":[{"scroll-mb":V()}],"scroll-ml":[{"scroll-ml":V()}],"scroll-p":[{"scroll-p":V()}],"scroll-px":[{"scroll-px":V()}],"scroll-py":[{"scroll-py":V()}],"scroll-ps":[{"scroll-ps":V()}],"scroll-pe":[{"scroll-pe":V()}],"scroll-pt":[{"scroll-pt":V()}],"scroll-pr":[{"scroll-pr":V()}],"scroll-pb":[{"scroll-pb":V()}],"scroll-pl":[{"scroll-pl":V()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",kt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[wa,Pl,NE]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},xx=Cwe(qwe),Gwe=t=>{if(!t)return"";const e=t.trim().split(" ");return e.length>=2?(e[0][0]+e[1][0]).toUpperCase():t.substring(0,2).toUpperCase()};function ra({src:t,name:e,size:n="md",className:r,onClick:s,status:i,isGroup:o=!1,square:l=!1}){const d=xx(Id("relative overflow-hidden flex items-center justify-center shrink-0 bg-gray-200 dark:bg-gray-700 border border-transparent transition-all select-none",l?"rounded-xl":"rounded-full",{xs:"h-6 w-6 text-[10px]",sm:"h-8 w-8 text-xs",md:"h-10 w-10 text-sm",lg:"h-12 w-12 text-base",xl:"h-14 w-14 text-lg","2xl":"h-24 w-24 text-2xl","3xl":"h-32 w-32 text-4xl"}[n],s&&"cursor-pointer hover:opacity-90",r));return a.jsxs("div",{className:d,onClick:s,children:[t?a.jsx("img",{src:t,alt:e||"Avatar",className:"h-full w-full object-cover",onError:h=>h.target.style.display="none"}):a.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gradient-to-br from-brand-blue to-purple-600 text-white font-bold",children:o?a.jsx(Rs,{className:"w-1/2 h-1/2"}):e?Gwe(e):a.jsx(Jr,{className:"w-1/2 h-1/2"})}),i&&a.jsx("span",{className:Id("absolute bottom-0 right-0 rounded-full border-2 border-white dark:border-gray-900",i==="online"?"bg-green-500":"bg-gray-400",n==="xs"||n==="sm"?"h-2 w-2":"h-3.5 w-3.5")})]})}const Kwe=({type:t})=>{const e={size:14},n={follow:a.jsx(nu,{...e}),like:a.jsx(Vye,{...e}),comment:a.jsx(Cd,{...e}),mention:a.jsx(Iye,{...e}),reply:a.jsx(Pye,{...e}),save:a.jsx(aW,{...e})},r={follow:"bg-brand-blue/10 text-brand-blue dark:bg-brand-blue/20",like:"bg-red-100 text-red-500 dark:bg-red-900/30 dark:text-red-400",comment:"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400",mention:"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400",reply:"bg-orange-100 text-orange-600 dark:bg-orange-900/30 dark:text-orange-400",save:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400"};return a.jsx("div",{className:`p-1.5 rounded-full ${r[t]||"bg-gray-100 text-gray-500"}`,children:n[t]||a.jsx(Td,{size:14})})},Qwe=t=>{if(!t)return"";const e=t.toMillis?new Date(t.toMillis()):new Date(t),r=new Date-e,s=Math.floor(r/6e4),i=Math.floor(s/60),o=Math.floor(i/24);return s<1?"Just now":s<60?`${s}m`:i<24?`${i}h`:o<7?`${o}d`:e.toLocaleDateString()},Zwe=({notification:t,onMarkAsRead:e,onDelete:n,onUserClick:r,onPostClick:s})=>{const i=()=>{t.read||e(t.id),t.type==="follow"&&r?r(t.fromUserId):t.postId&&s&&s(t.postId)};return a.jsxs(nt.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:`
                p-3 cursor-pointer border-b dark:border-gray-700 last:border-0 
                flex gap-3 items-start group transition-colors
                ${t.read?"hover:bg-gray-50 dark:hover:bg-gray-800":"bg-blue-50/50 dark:bg-blue-900/10 hover:bg-blue-50 dark:hover:bg-blue-900/20"}
            `,onClick:i,children:[a.jsxs("div",{className:"relative shrink-0",children:[a.jsx(ra,{src:t.fromUserPhoto,name:t.fromUserName,size:"sm"}),a.jsx("div",{className:"absolute -bottom-1 -right-1",children:a.jsx(Kwe,{type:t.type})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-start gap-2",children:[a.jsxs("p",{className:"text-sm dark:text-gray-200 leading-snug",children:[a.jsx("span",{className:"font-bold hover:text-brand-blue transition-colors",children:t.fromUserName})," ",a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t.message})]}),a.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap shrink-0",children:Qwe(t.timestamp)})]}),t.postPreview&&a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1 line-clamp-1 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:['"',t.postPreview,'"']}),!t.read&&a.jsx("div",{className:"w-2 h-2 bg-brand-blue rounded-full absolute right-3 top-1/2 -translate-y-1/2"})]}),a.jsx("button",{onClick:o=>{o.stopPropagation(),n(t.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-all text-gray-400 hover:text-red-500 shrink-0",children:a.jsx(_t,{size:14})})]})};function Ywe({notifications:t,unreadCount:e,loading:n,onMarkAsRead:r,onMarkAllAsRead:s,onDeleteNotification:i,onClearAll:o,onUserClick:l,onPostClick:c,onClose:d}){return a.jsxs("div",{className:"absolute right-0 top-full mt-3 w-80 sm:w-96 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-2xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"p-3 px-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-bold dark:text-white text-sm",children:"Notifications"}),e>0&&a.jsx("span",{className:"text-xs bg-brand-blue text-white px-2 py-0.5 rounded-full font-bold animate-pulse",children:e})]}),e>0&&a.jsxs("button",{onClick:s,className:"text-xs text-brand-blue hover:text-blue-700 font-medium flex items-center gap-1 transition",children:[a.jsx(dC,{size:14}),"Mark all read"]})]}),a.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:n?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"w-6 h-6 border-2 border-brand-blue border-t-transparent rounded-full animate-spin mx-auto mb-2"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Loading..."})]}):t.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-500 flex flex-col items-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-3",children:a.jsx(Td,{size:24,className:"opacity-30"})}),a.jsx("p",{className:"text-sm font-medium dark:text-gray-400",children:"All caught up!"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"No new notifications"})]}):a.jsx(yr,{mode:"popLayout",children:t.map(h=>a.jsx(Zwe,{notification:h,onMarkAsRead:r,onDelete:i,onUserClick:l,onPostClick:c},h.id))})}),t.length>0&&a.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-[#23262f] border-t dark:border-gray-700 flex justify-between items-center",children:[a.jsxs("button",{onClick:o,className:"text-xs text-gray-400 hover:text-red-500 font-medium flex items-center gap-1 transition px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:[a.jsx(bs,{size:12}),"Clear all"]}),a.jsx("button",{onClick:d,className:"text-xs text-gray-500 hover:text-gray-800 dark:hover:text-gray-200 px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:"Close"})]})]})}function Xwe({count:t}){return t===0?null:a.jsx(nt.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-0.5 -right-0.5 min-w-[18px] h-[18px] bg-red-500 rounded-full text-[10px] text-white font-bold flex items-center justify-center border-2 border-white dark:border-dark-card",children:t>99?"99+":t})}function Jwe(t,e=50){const[n,r]=N.useState([]),[s,i]=N.useState(0),[o,l]=N.useState(!0);N.useEffect(()=>{if(!t){l(!1);return}const p=Re(Z,Ve(t).notifications),v=Et(p,Wn("timestamp","desc"),Qs(e)),x=pn(v,b=>{const E=b.docs.map(k=>({id:k.id,...k.data()}));r(E),i(E.filter(k=>!k.read).length),l(!1)},b=>{console.error("Notifications listener error:",b),l(!1)});return()=>x()},[t,e]);const c=N.useCallback(async p=>{if(t)try{const v=Se(Z,Ve(t).notifications,p);await Nt(v,{read:!0})}catch(v){console.error("Mark as read error:",v)}},[t]),d=N.useCallback(async()=>{if(!(!t||s===0))try{const p=T_(Z);n.filter(x=>!x.read).forEach(x=>{const b=Se(Z,Ve(t).notifications,x.id);p.update(b,{read:!0})}),await p.commit()}catch(p){console.error("Mark all as read error:",p)}},[t,n,s]),h=N.useCallback(async p=>{if(t)try{const v=Se(Z,Ve(t).notifications,p);await Nt(v,{deleted:!0})}catch(v){console.error("Delete notification error:",v)}},[t]),m=N.useCallback(async()=>{if(t)try{const p=T_(Z);n.forEach(v=>{const x=Se(Z,Ve(t).notifications,v.id);p.update(x,{deleted:!0})}),await p.commit()}catch(p){console.error("Clear all error:",p)}},[t,n]);return{notifications:n.filter(p=>!p.deleted),unreadCount:s,loading:o,markAsRead:c,markAllAsRead:d,deleteNotification:h,clearAll:m}}async function gq({targetUserId:t,type:e,fromUserId:n,fromUserName:r,fromUserPhoto:s,postId:i=null,postPreview:o=null,commentId:l=null,message:c}){if(!(!t||t===n))try{await hn(Re(Z,Ve(t).notifications),{type:e,fromUserId:n,fromUserName:r,fromUserPhoto:s||null,postId:i,postPreview:o,commentId:l,message:c,read:!1,timestamp:zt()})}catch(d){console.error("Create notification error:",d)}}function eke({user:t,userData:e,subProfiles:n,darkMode:r,toggleTheme:s,activeTab:i,setActiveTab:o,onMenuClick:l,onRoleSwitch:c,openPublicProfile:d}){var H;const[h,m]=N.useState(!1),[p,v]=N.useState(!1),[x,b]=N.useState(!1),E=N.useRef(null),k=N.useRef(null),{notifications:_,unreadCount:S,loading:T,markAsRead:P,markAllAsRead:j,deleteNotification:R,clearAll:I}=Jwe(t==null?void 0:t.uid),O=(e==null?void 0:e.activeProfileRole)||((H=e==null?void 0:e.accountTypes)==null?void 0:H[0])||"User",D=(e==null?void 0:e.accountTypes)||[],F=["Student","Instructor","Intern","Admin"],V=D.some(X=>F.includes(X)),$=i.startsWith("edu"),J=X=>{if(!X||X==="Main"||X==="Fan"||X==="User")return(e==null?void 0:e.effectiveDisplayName)||(e==null?void 0:e.firstName)||"User";const oe=n==null?void 0:n[X];return(oe==null?void 0:oe.displayName)||(e==null?void 0:e.effectiveDisplayName)||(e==null?void 0:e.firstName)||"User"},ue=J(O),ve=()=>{o(O==="Student"?"edu-student":O==="Intern"?"edu-intern":"edu-overview")};N.useEffect(()=>{{b(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{b(!0)})});const X=setTimeout(()=>b(!1),600);return()=>clearTimeout(X)}},[O]),N.useEffect(()=>{function X(oe){E.current&&!E.current.contains(oe.target)&&m(!1),k.current&&!k.current.contains(oe.target)&&v(!1)}return document.addEventListener("mousedown",X),()=>document.removeEventListener("mousedown",X)},[E,k]);const le=X=>{m(!1),d&&d(X)},q=X=>{m(!1),o("feed")},Q=X=>{c&&c(X),v(!1)};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`fixed top-0 bottom-0 w-full pointer-events-none z-[9999] 
          bg-gradient-to-r from-transparent via-white/30 dark:via-white/10 to-transparent
          ${x?"left-[-100%] transition-all duration-500 ease-out":"left-[100%] transition-none duration-0"}
        `}),a.jsxs("nav",{className:"h-16 bg-white dark:bg-dark-card border-b border-gray-200 dark:border-gray-700 flex items-center justify-between px-4 shrink-0 z-20 sticky top-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:l,className:"p-2 -ml-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 lg:hidden",children:a.jsx(Hye,{size:24})}),a.jsx("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>o("dashboard"),children:a.jsx("img",{src:r?lq:cq,alt:"SeshNx Logo",className:"h-8 w-auto object-contain transition-opacity duration-300"})})]}),a.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[V&&a.jsxs("div",{className:"hidden md:flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1 border dark:border-gray-700",children:[a.jsxs("button",{onClick:()=>o("dashboard"),className:`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${$?"text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200":"bg-white dark:bg-gray-600 shadow-sm text-brand-blue dark:text-white"}`,children:[a.jsx(yW,{size:14})," Studio"]}),a.jsxs("button",{onClick:ve,className:`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${$?"bg-white dark:bg-gray-600 shadow-sm text-indigo-600 dark:text-white":"text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}`,children:[a.jsx(gm,{size:14})," Education"]})]}),D.length>1&&a.jsxs("div",{className:"relative hidden sm:flex items-center gap-3",ref:k,children:[a.jsxs("button",{onClick:()=>v(!p),className:"group flex items-center gap-2 px-3 py-1.5 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 text-xs font-bold transition border border-gray-200 dark:border-gray-700",children:[a.jsx(uw,{size:12,className:`text-brand-blue shrink-0 transition-transform ${x?"rotate-180 duration-500":""}`}),a.jsx("span",{children:O}),a.jsx(of,{size:12,className:`shrink-0 transition-transform ${p?"rotate-180":""}`})]}),a.jsxs("div",{className:"flex flex-col leading-tight",children:[a.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:"Posting as"}),a.jsx("span",{className:"text-xs font-bold dark:text-white truncate max-w-[150px]",children:ue})]}),p&&a.jsxs("div",{className:"absolute left-0 top-full mt-2 w-56 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-1 duration-200",children:[a.jsx("div",{className:"p-2 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:a.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider pl-2",children:"Switch Profile Context"})}),a.jsx("div",{className:"p-1",children:D.map(X=>{const oe=J(X);return a.jsxs("button",{onClick:()=>Q(X),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition flex items-center justify-between ${O===X?"bg-blue-50 dark:bg-blue-900/20 text-brand-blue":"hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{children:oe}),a.jsx("span",{className:"text-[10px] opacity-70 font-normal uppercase",children:X})]}),O===X&&a.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-brand-blue"})]},X)})})]})]}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300",children:r?a.jsx(NW,{size:20}):a.jsx(JA,{size:20})}),a.jsxs("div",{className:"relative",ref:E,children:[a.jsxs("button",{className:`relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 transition ${h?"bg-gray-100 dark:bg-gray-800 text-brand-blue":""}`,onClick:()=>m(!h),children:[a.jsx(Td,{size:20}),a.jsx(Xwe,{count:S})]}),h&&a.jsx(Ywe,{notifications:_,unreadCount:S,loading:T,onMarkAsRead:P,onMarkAllAsRead:j,onDeleteNotification:R,onClearAll:I,onUserClick:le,onPostClick:q,onClose:()=>m(!1)})]}),a.jsx(ra,{src:e==null?void 0:e.photoURL,name:ue,size:"sm",className:"border-2 border-transparent hover:border-brand-blue transition",onClick:()=>o("profile")})]})]})]})}const yq=N.createContext();function vx(){return N.useContext(yq)}function tke({children:t,user:e,userData:n}){var _;const[r,s]=N.useState(null),[i,o]=N.useState(null),[l,c]=N.useState(null),[d,h]=N.useState([]),[m,p]=N.useState(null),[v,x]=N.useState(!0);N.useEffect(()=>{if(!e||!(n!=null&&n.schoolId)){x(!1);return}uo(Se(Z,"schools",n.schoolId)).then(T=>{T.exists()&&s(T.data())}).catch(T=>console.error("Error fetching school data:",T)),(async()=>{var T,P,j,R;try{if((T=n.accountTypes)!=null&&T.includes("Student")||(P=n.accountTypes)!=null&&P.includes("Intern")){const I=Ve(e.uid).studentRecord(n.schoolId,e.uid);pn(Se(Z,I),async O=>{if(O.exists()){const D=O.data();if(o(D),D.internshipStudioId){const F=await uo(Se(Z,`schools/${n.schoolId}/partners/${D.internshipStudioId}`));if(F.exists())p(F.data());else{const V=await uo(Se(Z,"studios",D.internshipStudioId));V.exists()&&p(V.data())}}}})}if((j=n.accountTypes)!=null&&j.includes("Instructor")||(R=n.accountTypes)!=null&&R.includes("Admin")){const I=Et(Re(Z,`schools/${n.schoolId}/staff`),nn("uid","==",e.uid)),O=await Kt(I);if(!O.empty){const D=O.docs[0].data();if(c(D),D.roleId){const F=await uo(Se(Z,`schools/${n.schoolId}/roles/${D.roleId}`));F.exists()&&h(F.data().permissions||[])}else n.accountTypes.includes("Admin")&&h(["ALL"])}}}catch(I){console.error("Error setting up school context:",I)}finally{x(!1)}})()},[e,n]);const b=async(S,T="remote")=>{if(!(!i||!n.schoolId))try{const P=Re(Z,`schools/${n.schoolId}/internship_logs`),j=await hn(P,{studentId:e.uid,studentName:n.displayName||"Unknown",checkIn:zt(),checkOut:null,location:S||"Unknown",type:T,status:"active",description:""}),R=Ve(e.uid).studentRecord(n.schoolId,e.uid);await Nt(Se(Z,R),{activeSessionId:j.id,isClockedIn:!0})}catch(P){throw console.error("Check-in failed:",P),P}},E=async S=>{if(!(!(i!=null&&i.activeSessionId)||!n.schoolId))try{const T=`schools/${n.schoolId}/internship_logs/${i.activeSessionId}`;await Nt(Se(Z,T),{checkOut:zt(),status:"pending_approval",description:S||"No description"});const P=Ve(e.uid).studentRecord(n.schoolId,e.uid);await Nt(Se(Z,P),{activeSessionId:null,isClockedIn:!1})}catch(T){throw console.error("Check-out failed:",T),T}},k={schoolId:n==null?void 0:n.schoolId,schoolData:r,studentProfile:i,staffProfile:l,myPermissions:d,internshipStudio:m,isStudent:!!i,isStaff:!!l||((_=n==null?void 0:n.accountTypes)==null?void 0:_.includes("Admin")),checkIn:b,checkOut:E,loading:v};return a.jsx(yq.Provider,{value:k,children:t})}function nke({userData:t,activeTab:e,setActiveTab:n,sidebarOpen:r,setSidebarOpen:s,handleLogout:i}){var x,b,E,k;const{isStudent:o,isStaff:l}=vx(),c=[{id:"dashboard",icon:a.jsx(Jr,{size:18}),label:"Dashboard"},{id:"feed",icon:a.jsx(XA,{size:18}),label:"SocialNx"},{id:"marketplace",icon:a.jsx(_W,{size:18}),label:"Marketplace"},{id:"tech",icon:a.jsx(Km,{size:18}),label:"Tech Services"},{id:"bookings",icon:a.jsx(qo,{size:18}),label:"Bookings"},{id:"messages",icon:a.jsx(Cd,{size:18}),label:"Messages"},{id:"payments",icon:a.jsx(Lye,{size:18}),label:"Billing"},{id:"profile",icon:a.jsx(Kd,{size:18}),label:"Profile"}];if((x=t==null?void 0:t.accountTypes)!=null&&x.includes("Studio")){const _=c.findIndex(S=>S.id==="profile");_!==-1&&c.splice(_,0,{id:"studio-ops",icon:a.jsx(hx,{size:18}),label:"Studio Ops",highlight:!0})}const d=(b=t==null?void 0:t.accountTypes)==null?void 0:b.includes("Intern");if(o||d||l||(E=t==null?void 0:t.accountTypes)!=null&&E.includes("student")){const _=c.findIndex(P=>P.id==="payments");let S="EDU Panel";d?S="Internship":l&&(S="School Admin");let T="edu-overview";d?T="edu-intern":o&&(T="edu-student"),c.splice(_,0,{id:T,icon:a.jsx(gm,{size:18}),label:S,highlight:!0})}const h=i||(()=>nI(sf)),m=_=>{n(_),s&&s(!1)},p=({isMobile:_})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-1 py-4 overflow-y-auto scrollbar-hide",children:[_&&a.jsxs("div",{className:"px-4 mb-6 flex items-center justify-between",children:[a.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase",children:"Menu"}),a.jsx("button",{onClick:()=>s(!1),className:"p-2 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors",children:a.jsx(_t,{size:20})})]}),a.jsx("nav",{className:"space-y-1 px-2",children:c.map(S=>a.jsxs("button",{onClick:()=>m(S.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition
                ${e===S.id?"bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}
                ${S.highlight?"text-amber-600 dark:text-amber-500":""}
                `,children:[S.icon,S.label]},S.id))}),a.jsx("div",{className:"mt-auto px-2 pt-4",children:a.jsxs("button",{onClick:()=>m("legal"),className:`flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium w-full transition ${e==="legal"?"bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[a.jsx(dw,{size:18}),"Legal Center"]})})]}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 shrink-0 bg-white dark:bg-[#1f2128]",children:a.jsxs("button",{onClick:h,className:"flex items-center gap-2 text-red-500 text-sm font-medium hover:opacity-80 px-2 w-full py-2 rounded hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",children:[a.jsx(pW,{size:16})," Sign Out"]})})]});if((k=t==null?void 0:t.accountTypes)==null?void 0:k.some(_=>["Label","Agent"].includes(_))){const _=c.findIndex(S=>S.id==="bookings");_!==-1&&c.splice(_,0,{id:"roster",icon:a.jsx(dw,{size:18}),label:"Label Roster",highlight:!0})}return a.jsxs(a.Fragment,{children:[a.jsx("aside",{className:"hidden lg:flex w-64 bg-white dark:bg-[#1f2128] border-r border-gray-200 dark:border-gray-700 flex-col h-full shrink-0 relative z-30",children:a.jsx(p,{isMobile:!1})}),a.jsx("div",{className:`fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] transition-opacity duration-300 lg:hidden ${r?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>s(!1)}),a.jsx("aside",{className:`fixed inset-y-0 left-0 z-[10000] w-72 bg-white dark:bg-[#1f2128] shadow-2xl transform transition-transform duration-300 cubic-bezier(0.4, 0, 0.2, 1) flex flex-col h-full lg:hidden ${r?"translate-x-0":"-translate-x-full"}`,children:a.jsx(p,{isMobile:!0})})]})}function rke({activeTab:t,setActiveTab:e,sidebarOpen:n,setSidebarOpen:r,isGlobalAdmin:s}){const i=[{id:"edu-overview",icon:Uye,label:"Overview"},{id:"edu-roster",icon:Rs,label:"Student Roster"},{id:"edu-hours",icon:Ms,label:"Internship Hours"},{id:"edu-instructors",icon:nu,label:"Staff Management"},{id:"edu-roles",icon:s0,label:"Role Permissions"},{id:"edu-resources",icon:tu,label:"Resource Rules"},{id:"edu-news",icon:gW,label:"Announcements"},{id:"edu-partners",icon:Jo,label:"Partnerships"},{id:"edu-evaluations",icon:gm,label:"Grading & Evals"},{id:"edu-cohorts",icon:Rs,label:"Cohorts"},{id:"edu-audit",icon:KA,label:"Audit Logs"},{id:"edu-settings",icon:Kd,label:"School Settings"}],o=c=>{e(c),r&&r(!1)},l=()=>a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700",children:[a.jsxs("button",{onClick:()=>e("dashboard"),className:"flex items-center gap-2 text-xs font-bold text-gray-500 hover:text-brand-blue transition mb-4",children:[a.jsx(x1,{size:14})," Back to Studio"]}),a.jsx("h2",{className:"text-lg font-extrabold dark:text-white tracking-tight px-1",children:"EDU Control"})]}),a.jsx("div",{className:"flex-1 py-4 overflow-y-auto custom-scrollbar px-3 space-y-1",children:i.map(c=>a.jsxs("button",{onClick:()=>o(c.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors
                        ${t===c.id?"bg-indigo-50 text-indigo-600 dark:bg-indigo-900/20 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}
                        `,children:[a.jsx(c.icon,{size:18}),c.label]},c.id))}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 shrink-0 bg-gray-50 dark:bg-[#23262f]",children:a.jsxs("div",{className:"flex items-center gap-3 px-2",children:[a.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-700 dark:text-indigo-300 font-bold text-xs",children:"EA"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-xs font-bold dark:text-white truncate",children:"EDU Admin"}),a.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:"School Management"})]}),a.jsx("button",{onClick:()=>nI(sf),className:"text-gray-400 hover:text-red-500",children:a.jsx(pW,{size:16})})]})})]});return a.jsxs(a.Fragment,{children:[a.jsx("aside",{className:"hidden lg:flex w-64 bg-white dark:bg-[#1f2128] border-r border-gray-200 dark:border-gray-700 flex-col h-full shrink-0 relative z-30",children:a.jsx(l,{})}),a.jsx("div",{className:`fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] transition-opacity duration-300 lg:hidden ${n?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>r(!1)}),a.jsx("aside",{className:`fixed inset-y-0 left-0 z-[10000] w-72 bg-white dark:bg-[#1f2128] shadow-2xl transform transition-transform duration-300 cubic-bezier(0.4, 0, 0.2, 1) flex flex-col h-full lg:hidden ${n?"translate-x-0":"-translate-x-full"}`,children:a.jsx(l,{})})]})}function Wa({title:t,value:e,icon:n,sub:r,bg:s="bg-white dark:bg-[#2c2e36]",text:i="text-gray-900 dark:text-white"}){return a.jsxs("div",{className:`${s} p-5 rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm flex flex-col justify-between h-28`,children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{className:`text-sm font-medium ${i==="text-white"?"text-blue-100":"text-gray-500"}`,children:t}),a.jsx("div",{className:`text-2xl font-extrabold ${i}`,children:e})]}),a.jsx("div",{className:"opacity-80",children:n})]}),r&&a.jsx("div",{className:"text-xs mt-auto opacity-75",children:r})]})}const bw=["Artist","Musician","Engineer","Producer","Composer","Studio","Technician","Fan","Student","Instructor","Label","Agent"],ske={FREE:"FREE"},ike=["Xfer Serum","NI Massive","Sylenth1","FabFilter Pro-Q 3","Valhalla VintageVerb","RC-20 Retro Color","Omnisphere","Kontakt","Auto-Tune","Soundtoys Decapitator","Waves CLA-2A","SerumFX","Vital","Diva"],oke=[{id:"single",label:"Single",maxTracks:1},{id:"ep",label:"EP",maxTracks:6},{id:"album",label:"Album",maxTracks:100}],_g=[{id:"spotify",name:"Spotify",icon:"spotify"},{id:"apple",name:"Apple Music",icon:"apple"},{id:"tiktok",name:"TikTok / Resso",icon:"music"},{id:"instagram",name:"Instagram & Facebook",icon:"instagram"},{id:"youtube",name:"YouTube Music",icon:"youtube"},{id:"amazon",name:"Amazon Music",icon:"shopping-cart"},{id:"tidal",name:"Tidal",icon:"music"},{id:"deezer",name:"Deezer",icon:"music"},{id:"soundcloud",name:"SoundCloud",icon:"cloud"}],ake=["Alternative","Blues","Children's Music","Christian & Gospel","Classical","Comedy","Country","Dance","Electronic","Fitness & Workout","Folk","Hip Hop/Rap","Holiday","Indie Pop","Instrumental","Jazz","K-Pop","Latin","Metal","New Age","Pop","R&B/Soul","Reggae","Rock","Singer/Songwriter","Soundtrack","Spoken Word","World"],PC=[{id:"manage_roster",label:"Manage Roster",description:"Add, remove, or edit student details."},{id:"manage_enrollment",label:"Admissions",description:"Process applications and handle intake."},{id:"approve_hours",label:"Approve Hours",description:"Verify and approve internship time logs."},{id:"manage_partners",label:"Manage Partners",description:"Add or edit approved internship studios."},{id:"grade_students",label:"Grading",description:"Submit technical and soft-skill evaluations."},{id:"post_announcements",label:"Announcements",description:"Post news to the student dashboard."},{id:"manage_resources",label:"Resource Rules",description:"Set quotas and booking restrictions."},{id:"manage_staff",label:"Manage Staff",description:"Add new instructors and assign roles."},{id:"view_audit",label:"View Audit Logs",description:"See history of administrative actions."},{id:"edit_settings",label:"School Settings",description:"Change school name, address, and branding."}],LC={Vocals:["Soprano","Tenor","Baritone","Bass","Falsetto","Rapping","Beatboxing","Growling"],Guitars:["Electric Guitar","Acoustic Guitar","Bass Guitar","Classical/Nylon","12-String Acoustic","Upright Bass"],Percussion:["Drum Kit","Electronic Drums","Congas","Bongos","Djembe","Cajon","Timbales","Tabla","Marimba","Vibraphone"],Keys:["Grand Piano","Upright Piano","Electric Piano","Clavinet","Hammond Organ","Pipe Organ","Synthesizer","MIDI Controller","Accordion"],Strings:["Violin","Viola","Cello","Double Bass","Harp","Banjo","Mandolin","Ukulele","Sitar","Oud"],Wind:["Flute","Clarinet","Oboe","Bassoon","Saxophone","Trumpet","Trombone","French Horn","Tuba","Harmonica","Didgeridoo","Bagpipes"]},$h=["Rock","Alternative","Indie","Metal","Punk","Pop","Electronic","House","Techno","Dubstep","Hip Hop","Rap","Trap","R&B","Soul","Funk","Jazz","Blues","Country","Folk","Americana","Bluegrass","Classical","Reggae","Latin","World","Experimental"],xq=["Wi-Fi","Kitchen","Lounge","Private Parking","Shower","Sleep/Lodging","Accessibility Ramps","Video Feed","Loading Dock","Isolation Booth","Live Room","Grand Piano","Tape Machine"],xu=[{key:"useRealName",label:"Use Primary Name?",type:"checkbox",isToggle:!0},{key:"profileName",label:"Profile/Stage Name",type:"text"}],_w={Artist:[{key:"profileName",label:"Artist / Band Name",type:"text"},{key:"bio",label:"Artist Bio",type:"textarea"},{key:"genres",label:"Primary Genres",type:"multi_select",data:$h},{key:"rates",label:"Booking/Feature Rate ($)",type:"number"},{key:"website",label:"Official Website",type:"text"},{key:"label",label:"Record Label (Optional)",type:"text"},{key:"touring",label:"Currently Touring?",type:"select",options:["Yes","No"]}],Label:[{key:"profileName",label:"Label Name",type:"text"},{key:"bio",label:"Label Description / Mission",type:"textarea"},{key:"genres",label:"Focus Genres",type:"multi_select",data:$h},{key:"website",label:"Website",type:"text"},{key:"acceptingDemos",label:"Accepting Demos?",type:"select",options:["Yes","No"]}],Agent:[...xu,{key:"agencyName",label:"Agency Name",type:"text"},{key:"rosterSize",label:"Roster Size",type:"number"},{key:"territory",label:"Territory Focus",type:"text"}],Musician:[...xu,{key:"bio",label:"Biography",type:"textarea"},{key:"instruments",label:"Instruments & Skills",type:"nested_select",data:LC},{key:"genres",label:"Genres",type:"multi_select",data:$h},{key:"rates",label:"Session Rate ($/hr)",type:"number"},{key:"dayRate",label:"Day Rate ($)",type:"number"},{key:"travelDist",label:"Max Travel (mi)",type:"number"},{key:"gearHighlights",label:"Key Gear (Guitars, Amps, etc.)",type:"textarea"},{key:"readingSkill",label:"Sight Reading",type:"select",options:["None","Charts/Lead Sheets","Standard Notation","Expert"]},{key:"remoteWork",label:"Remote Recording Capable?",type:"select",options:["Yes","No"]}],Fan:[{key:"bio",label:"About Me",type:"textarea"},{key:"genres",label:"Favorite Genres",type:"multi_select",data:$h},{key:"lookingFor",label:"Interested In",type:"multi_select",data:["Discovering Music","Booking Talent","Learning"]}],Studio:[...xu,{key:"profileName",label:"Studio Name",type:"text"},{key:"bio",label:"Description",type:"textarea"},{key:"address",label:"Address",type:"text"},{key:"hours",label:"Hours of Operation",type:"text"},{key:"dimensions",label:"Live Room Dimensions",type:"text"},{key:"parking",label:"Parking Situation",type:"text"},{key:"amenities",label:"Amenities",type:"multi_select",data:xq}],Engineer:[...xu,{key:"bio",label:"Bio",type:"textarea"},{key:"skills",label:"Specialties",type:"multi_select",data:["Tracking","Mixing","Mastering","Live Sound","Broadcast","Dolby Atmos","Editing/Tuning"]},{key:"daw",label:"DAWs",type:"multi_select",data:["Pro Tools","Logic Pro","Ableton","FL Studio","Cubase","Reaper","Studio One","Luna"]},{key:"outboard",label:"Favorite Outboard Gear",type:"textarea"},{key:"credits",label:"Selected Credits",type:"textarea"}],Producer:[...xu,{key:"bio",label:"Bio",type:"textarea"},{key:"genres",label:"Genres",type:"multi_select",data:$h},{key:"daw",label:"Primary DAW",type:"select",options:["Pro Tools","Logic Pro","Ableton","FL Studio","Cubase","Studio One"]},{key:"credits",label:"Discography / Credits",type:"textarea"}],Composer:[...xu,{key:"bio",label:"Bio",type:"textarea"},{key:"compType",label:"Type",type:"multi_select",options:["Film/TV","Game Audio","Pop/Songwriting","Classical/Orchestral","Library Music","Jingles"]},{key:"instruments",label:"Primary Instruments",type:"nested_select",data:LC},{key:"libraries",label:"Key Sample Libraries",type:"textarea"},{key:"credits",label:"Credits",type:"textarea"}],Technician:[...xu,{key:"bio",label:"Bio",type:"textarea"},{key:"skills",label:"Skills",type:"textarea"}]},ww=[{id:"repair",label:"Equipment Repair"},{id:"wiring",label:"Studio Wiring/Install"},{id:"acoustics",label:"Acoustic Calibration"},{id:"computer",label:"DAW/Computer Support"},{id:"mods",label:"Custom Mods"}],vq=["Luthier (Guitar/Bass)","Drum Tech","Amp Tech (Tube)","Amp Tech (Solid State)","Studio Electrician","Acoustician","Piano Tuner/Tech","Synth/Keyboard Tech","Computer/IT Systems","Soldering/Cabling","Console Maintenance","Live Sound Tech"],d0=[{id:"computer_audio_and_interfaces",label:"Computer Audio & Interfaces"},{id:"microphones_and_input_transducers",label:"Microphones"},{id:"mixing_consoles_and_control",label:"Mixing Consoles"},{id:"monitoring_and_playback",label:"Monitoring & Playback"},{id:"outboard_signal_processing",label:"Outboard Gear"}];function X5({user:t,userData:e,setActiveTab:n,bookingCount:r=0,subProfiles:s={},notifications:i=[],tokenBalance:o=0}){var T,P;const[l,c]=N.useState([]),[d,h]=N.useState(null),m=(T=e==null?void 0:e.accountTypes)==null?void 0:T.includes("Studio"),p=((P=s==null?void 0:s.Studio)==null?void 0:P.rooms)||[],v=(e==null?void 0:e.profileViews)||0,x=(e==null?void 0:e.accountTypes)||[];let b=0,E=0;x.forEach(j=>{const R=(s==null?void 0:s[j])||{},I=_w[j]||[];if(I.length===0)return;const O=I.filter(F=>!F.isToggle&&F.type!=="list").length||1,D=I.filter(F=>!F.isToggle&&F.type!=="list"&&R[F.key]&&R[F.key].length).length;b+=D/O,E++});const k=E>0?Math.round(b/E*100):100,_=k<60;N.useEffect(()=>{if(!(t!=null&&t.uid))return;const j=Mk(ln(cn,`conversations/${t.uid}`),Gj("lmt"),qj(3)),R=Ud(j,I=>{const O=I.val();if(!O){c([]);return}const D=Object.entries(O).map(([F,V])=>({uid:V.uid,name:V.n,lastMessage:V.lm,timestamp:V.lmt,isMe:V.ls===t.uid})).sort((F,V)=>V.timestamp-F.timestamp);c(D)});return()=>R()},[t==null?void 0:t.uid]),N.useEffect(()=>{const j=Et(Re(Z,`artifacts/${Ge}/public/data/market_items`),Wn("timestamp","desc"),Qs(1)),R=pn(j,I=>{I.empty||h({id:I.docs[0].id,...I.docs[0].data()})});return()=>R()},[]);const S=j=>{if(!j)return"Just now";let R;if(typeof j.toMillis=="function")R=new Date(j.toMillis());else if(typeof j=="number")R=new Date(j);else if(j instanceof Date)R=j;else return"Just now";if(isNaN(R.getTime()))return"Just now";const I=new Date;return R.getDate()===I.getDate()&&R.getMonth()===I.getMonth()&&R.getFullYear()===I.getFullYear()?R.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):R.toLocaleDateString()};return a.jsxs("div",{className:"space-y-8 max-w-6xl mx-auto pb-20 animate-in fade-in duration-500",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-end gap-4",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight",children:["Welcome, ",e==null?void 0:e.firstName]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Your creative command center."})]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{className:"text-sm font-medium text-gray-500 bg-white dark:bg-[#2c2e36] px-4 py-2 rounded-full border dark:border-gray-700 shadow-sm flex items-center gap-2",children:[a.jsx(Ms,{size:14}),new Date().toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})]})})]}),_&&a.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-xl p-4 flex items-center justify-between gap-4 animate-in slide-in-from-top-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-orange-100 dark:bg-orange-900/50 p-2 rounded-full text-orange-600 dark:text-orange-400",children:a.jsx(Sd,{size:20})}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-300 text-sm",children:["Profile Incomplete (",k,"%)"]}),a.jsx("p",{className:"text-xs text-orange-700 dark:text-orange-400",children:"Please complete your profile details before booking sessions."})]})]}),a.jsx("button",{onClick:()=>n("profile"),className:"bg-orange-600 hover:bg-orange-700 text-white text-xs font-bold px-4 py-2 rounded-lg transition",children:"Complete Profile"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-600 p-5 rounded-xl text-white shadow-lg cursor-pointer transform transition hover:scale-[1.02] relative overflow-hidden group",onClick:()=>n("payments"),children:[a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"text-yellow-100 text-sm font-medium mb-1 flex items-center gap-1",children:["SeshFx Balance ",a.jsx(Sb,{size:12,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]}),a.jsxs("div",{className:"text-3xl font-extrabold flex items-center gap-2",children:[a.jsx(Ys,{fill:"currentColor",size:28})," ",o]}),a.jsx("div",{className:"text-xs text-yellow-100 mt-2 opacity-80 bg-white/20 inline-block px-2 py-0.5 rounded-full",children:"+ Add Funds"})]}),a.jsx(Ys,{size:120,className:"absolute -bottom-6 -right-6 text-white opacity-20 rotate-12 group-hover:rotate-0 transition-transform duration-500"})]}),a.jsx("div",{className:"cursor-pointer transform transition hover:scale-[1.02]",onClick:()=>n("bookings"),children:a.jsx(Wa,{title:"Pending Bookings",value:r,icon:a.jsx(qo,{className:"text-white"}),bg:"bg-gradient-to-br from-brand-blue to-blue-600",text:"text-white",sub:r>0?"Action Required":"No pending requests"})}),a.jsx("div",{className:"cursor-pointer transform transition hover:scale-[1.02]",onClick:()=>n("messages"),children:a.jsx(Wa,{title:"Active Chats",value:l.length,icon:a.jsx(Cd,{className:"text-brand-blue"}),sub:"Check Inbox"})}),a.jsx("div",{className:"cursor-pointer transform transition hover:scale-[1.02]",onClick:()=>n("profile"),children:a.jsx(Wa,{title:"Profile Views",value:v,icon:a.jsx(EW,{className:"text-brand-blue"}),sub:"Lifetime views"})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[a.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 overflow-hidden shadow-sm",children:[a.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50/50 dark:bg-[#23262f]",children:[a.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Td,{size:18,className:"text-gray-500"})," Activity Feed"]}),i&&i.length>0&&a.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full animate-pulse",children:[i.length," New"]})]}),a.jsx("div",{className:"divide-y dark:divide-gray-700",children:!i||i.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Td,{size:20,className:"text-gray-400"})}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"You're all caught up!"})]}):i.map((j,R)=>a.jsxs("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-[#25272e] transition flex justify-between items-center group cursor-pointer",onClick:()=>n("bookings"),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${j.type==="booking"?"bg-brand-blue":"bg-yellow-500"}`}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm dark:text-gray-200 font-medium",children:j.text}),a.jsx("p",{className:"text-xs text-gray-500",children:S(j.timestamp)})]})]}),a.jsx(ea,{size:14,className:"text-gray-300"})]},j.id||R))})]}),m&&a.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-5 relative overflow-hidden shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 relative z-10",children:[a.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[a.jsx(hx,{size:18,className:"text-brand-blue"})," Studio Status"]}),a.jsxs("button",{onClick:()=>n("studio-ops"),className:"text-sm text-brand-blue hover:underline flex items-center gap-1",children:["Manage Ops ",a.jsx(Sb,{size:14})]})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 relative z-10",children:p.length===0?a.jsxs("div",{className:"col-span-full text-center py-6 text-gray-400 text-sm border-2 border-dashed dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-[#1f2128]",children:[a.jsx("div",{className:"mb-2",children:"No rooms configured."}),a.jsx("button",{className:"text-brand-blue font-bold hover:underline",onClick:()=>n("studio-ops"),children:"+ Add Room"})]}):p.map((j,R)=>{var I;return a.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] p-3 rounded-lg border dark:border-gray-700 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-sm dark:text-gray-200",children:j.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:[((I=j.equipment)==null?void 0:I.length)||0," items  $",j.rate,"/hr"]})]}),a.jsxs("span",{className:`text-xs px-2 py-1 rounded-full font-bold flex items-center gap-1 ${j.active?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700"}`,children:[j.active?a.jsx(es,{size:10}):a.jsx(Sd,{size:10}),j.active?"Active":"Maint."]})]},R)})})]}),a.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-5 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Cd,{size:18,className:"text-gray-400"})," Recent Messages"]}),a.jsx("button",{onClick:()=>n("messages"),className:"text-sm text-brand-blue hover:underline",children:"View All"})]}),a.jsx("div",{className:"space-y-3",children:l.length===0?a.jsx("div",{className:"text-center text-gray-400 text-sm py-4",children:"No recent messages."}):l.map((j,R)=>a.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-[#25272e] rounded-lg cursor-pointer transition",onClick:()=>n("messages"),children:[a.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-600 dark:text-gray-300",children:j.name?j.name.charAt(0):"?"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"text-sm font-bold dark:text-gray-200 flex justify-between",children:[j.name||"Unknown User",a.jsx("span",{className:"text-[10px] text-gray-400 font-normal",children:new Date(j.timestamp).toLocaleDateString()})]}),a.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[j.isMe?"You: ":"",j.lastMessage]})]})]},j.uid+R))})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-4 shadow-sm",children:[a.jsx("h3",{className:"font-bold mb-3 dark:text-white text-sm uppercase tracking-wide text-gray-500",children:"Quick Actions"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{className:"w-full text-left px-4 py-3 rounded-lg border dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-sm flex items-center gap-3 dark:text-gray-300 transition group",onClick:()=>n("feed"),children:[a.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded text-brand-blue group-hover:scale-110 transition-transform",children:a.jsx(eR,{size:16})}),a.jsx("span",{className:"font-medium",children:"Create Post"})]}),a.jsxs("button",{className:"w-full text-left px-4 py-3 rounded-lg border dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-sm flex items-center gap-3 dark:text-gray-300 transition group",onClick:()=>n("bookings"),children:[a.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-2 rounded text-purple-600 group-hover:scale-110 transition-transform",children:a.jsx(Ur,{size:16})}),a.jsx("span",{className:"font-medium",children:"Find Talent"})]}),a.jsxs("button",{className:"w-full text-left px-4 py-3 rounded-lg border dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-sm flex items-center gap-3 dark:text-gray-300 transition group",onClick:()=>n("marketplace"),children:[a.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 p-2 rounded text-yellow-600 group-hover:scale-110 transition-transform",children:a.jsx(_W,{size:16})}),a.jsx("span",{className:"font-medium",children:"Browse Marketplace"})]})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-black text-white rounded-xl p-5 relative overflow-hidden shadow-lg",children:[a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Ys,{size:16,className:"text-yellow-400",fill:"currentColor"}),a.jsx("span",{className:"text-xs font-bold text-yellow-400 uppercase",children:"Trending on SeshFx"})]}),d?a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-bold text-lg mb-1 truncate",children:d.title}),a.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:["by ",d.author,"  ",d.price," Tokens"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-bold text-lg mb-1",children:"Discover Sounds"}),a.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Fresh beats & presets added daily."})]}),a.jsxs("button",{onClick:()=>n("seshfx"),className:"w-full bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition",children:["Visit Store ",a.jsx(Sb,{size:12})]})]}),a.jsx("div",{className:"absolute -right-4 -bottom-4 w-24 h-24 bg-yellow-500 rounded-full blur-3xl opacity-20 animate-pulse"})]}),a.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 p-4 shadow-sm",children:[a.jsx("h3",{className:"font-bold dark:text-white text-sm mb-3",children:"Completion"}),a.jsx("div",{className:"space-y-3",children:((e==null?void 0:e.accountTypes)||[]).map(j=>{const R=(s==null?void 0:s[j])||{},I=_w[j]||[];if(I.length===0)return null;const O=I.filter(V=>!V.isToggle&&V.type!=="list").length||1,D=I.filter(V=>!V.isToggle&&V.type!=="list"&&R[V.key]&&R[V.key].length).length,F=Math.round(D/O*100);return a.jsxs("div",{className:"space-y-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 p-2 rounded transition",onClick:()=>n("profile"),title:"Click to edit profile",children:[a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:j}),a.jsxs("span",{className:F===100?"text-green-500 font-bold":"text-gray-500",children:[F,"%"]})]}),a.jsx("div",{className:"w-full h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full transition-all duration-1000 ${F>=80?"bg-green-500":F>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${F}%`}})})]},j)})})]})]})]})]})}function bq(t,e){const n=N.useRef(e);N.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}function lke(t,e,n){e.center!==n.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==n.radius&&t.setRadius(e.radius)}const cke=1;function uke(t){return Object.freeze({__version:cke,map:t})}function _q(t,e){return Object.freeze({...t,...e})}const wq=N.createContext(null),kq=wq.Provider;function j1(){const t=N.useContext(wq);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function Nq(t){function e(n,r){const{instance:s,context:i}=t(n).current;return N.useImperativeHandle(r,()=>s),n.children==null?null:He.createElement(kq,{value:i},n.children)}return N.forwardRef(e)}function dke(t){function e(n,r){const[s,i]=N.useState(!1),{instance:o}=t(n,i).current;N.useImperativeHandle(r,()=>o),N.useEffect(function(){s&&o.update()},[o,s,n.children]);const l=o._contentNode;return l?n6.createPortal(n.children,l):null}return N.forwardRef(e)}function hke(t){function e(n,r){const{instance:s}=t(n).current;return N.useImperativeHandle(r,()=>s),null}return N.forwardRef(e)}function FR(t,e){const n=N.useRef();N.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function A1(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function fke(t,e){return function(r,s){const i=j1(),o=t(A1(r,i),i);return bq(i.map,r.attribution),FR(o.current,r.eventHandlers),e(o.current,i,r,s),o}}var MC={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(FG,function(n){var r="1.9.4";function s(u){var f,y,w,A;for(y=1,w=arguments.length;y<w;y++){A=arguments[y];for(f in A)u[f]=A[f]}return u}var i=Object.create||function(){function u(){}return function(f){return u.prototype=f,new u}}();function o(u,f){var y=Array.prototype.slice;if(u.bind)return u.bind.apply(u,y.call(arguments,1));var w=y.call(arguments,2);return function(){return u.apply(f,w.length?w.concat(y.call(arguments)):arguments)}}var l=0;function c(u){return"_leaflet_id"in u||(u._leaflet_id=++l),u._leaflet_id}function d(u,f,y){var w,A,B,W;return W=function(){w=!1,A&&(B.apply(y,A),A=!1)},B=function(){w?A=arguments:(u.apply(y,arguments),setTimeout(W,f),w=!0)},B}function h(u,f,y){var w=f[1],A=f[0],B=w-A;return u===w&&y?u:((u-A)%B+B)%B+A}function m(){return!1}function p(u,f){if(f===!1)return u;var y=Math.pow(10,f===void 0?6:f);return Math.round(u*y)/y}function v(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function x(u){return v(u).split(/\s+/)}function b(u,f){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?i(u.options):{});for(var y in f)u.options[y]=f[y];return u.options}function E(u,f,y){var w=[];for(var A in u)w.push(encodeURIComponent(y?A.toUpperCase():A)+"="+encodeURIComponent(u[A]));return(!f||f.indexOf("?")===-1?"?":"&")+w.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function _(u,f){return u.replace(k,function(y,w){var A=f[w];if(A===void 0)throw new Error("No value provided for variable "+y);return typeof A=="function"&&(A=A(f)),A})}var S=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function T(u,f){for(var y=0;y<u.length;y++)if(u[y]===f)return y;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function j(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var R=0;function I(u){var f=+new Date,y=Math.max(0,16-(f-R));return R=f+y,window.setTimeout(u,y)}var O=window.requestAnimationFrame||j("RequestAnimationFrame")||I,D=window.cancelAnimationFrame||j("CancelAnimationFrame")||j("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function F(u,f,y){if(y&&O===I)u.call(f);else return O.call(window,o(u,f))}function V(u){u&&D.call(window,u)}var $={__proto__:null,extend:s,create:i,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:h,falseFn:m,formatNum:p,trim:v,splitWords:x,setOptions:b,getParamString:E,template:_,isArray:S,indexOf:T,emptyImageUrl:P,requestFn:O,cancelFn:D,requestAnimFrame:F,cancelAnimFrame:V};function J(){}J.extend=function(u){var f=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},y=f.__super__=this.prototype,w=i(y);w.constructor=f,f.prototype=w;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(f[A]=this[A]);return u.statics&&s(f,u.statics),u.includes&&(ue(u.includes),s.apply(null,[w].concat(u.includes))),s(w,u),delete w.statics,delete w.includes,w.options&&(w.options=y.options?i(y.options):{},s(w.options,u.options)),w._initHooks=[],w.callInitHooks=function(){if(!this._initHooksCalled){y.callInitHooks&&y.callInitHooks.call(this),this._initHooksCalled=!0;for(var B=0,W=w._initHooks.length;B<W;B++)w._initHooks[B].call(this)}},f},J.include=function(u){var f=this.prototype.options;return s(this.prototype,u),u.options&&(this.prototype.options=f,this.mergeOptions(u.options)),this},J.mergeOptions=function(u){return s(this.prototype.options,u),this},J.addInitHook=function(u){var f=Array.prototype.slice.call(arguments,1),y=typeof u=="function"?u:function(){this[u].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(y),this};function ue(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=S(u)?u:[u];for(var f=0;f<u.length;f++)u[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ve={on:function(u,f,y){if(typeof u=="object")for(var w in u)this._on(w,u[w],f);else{u=x(u);for(var A=0,B=u.length;A<B;A++)this._on(u[A],f,y)}return this},off:function(u,f,y){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var w in u)this._off(w,u[w],f);else{u=x(u);for(var A=arguments.length===1,B=0,W=u.length;B<W;B++)A?this._off(u[B]):this._off(u[B],f,y)}return this},_on:function(u,f,y,w){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(u,f,y)===!1){y===this&&(y=void 0);var A={fn:f,ctx:y};w&&(A.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(A)}},_off:function(u,f,y){var w,A,B;if(this._events&&(w=this._events[u],!!w)){if(arguments.length===1){if(this._firingCount)for(A=0,B=w.length;A<B;A++)w[A].fn=m;delete this._events[u];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var W=this._listens(u,f,y);if(W!==!1){var Y=w[W];this._firingCount&&(Y.fn=m,this._events[u]=w=w.slice()),w.splice(W,1)}}},fire:function(u,f,y){if(!this.listens(u,y))return this;var w=s({},f,{type:u,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var A=this._events[u];if(A){this._firingCount=this._firingCount+1||1;for(var B=0,W=A.length;B<W;B++){var Y=A[B],ne=Y.fn;Y.once&&this.off(u,ne,Y.ctx),ne.call(Y.ctx||this,w)}this._firingCount--}}return y&&this._propagateEvent(w),this},listens:function(u,f,y,w){typeof u!="string"&&console.warn('"string" type argument expected');var A=f;typeof f!="function"&&(w=!!f,A=void 0,y=void 0);var B=this._events&&this._events[u];if(B&&B.length&&this._listens(u,A,y)!==!1)return!0;if(w){for(var W in this._eventParents)if(this._eventParents[W].listens(u,f,y,w))return!0}return!1},_listens:function(u,f,y){if(!this._events)return!1;var w=this._events[u]||[];if(!f)return!!w.length;y===this&&(y=void 0);for(var A=0,B=w.length;A<B;A++)if(w[A].fn===f&&w[A].ctx===y)return A;return!1},once:function(u,f,y){if(typeof u=="object")for(var w in u)this._on(w,u[w],f,!0);else{u=x(u);for(var A=0,B=u.length;A<B;A++)this._on(u[A],f,y,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[c(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[c(u)],this},_propagateEvent:function(u){for(var f in this._eventParents)this._eventParents[f].fire(u.type,s({layer:u.target,propagatedFrom:u.target},u),!0)}};ve.addEventListener=ve.on,ve.removeEventListener=ve.clearAllEventListeners=ve.off,ve.addOneTimeEventListener=ve.once,ve.fireEvent=ve.fire,ve.hasEventListeners=ve.listens;var le=J.extend(ve);function q(u,f,y){this.x=y?Math.round(u):u,this.y=y?Math.round(f):f}var Q=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(u){return this.clone()._add(H(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(H(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new q(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new q(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Q(this.x),this.y=Q(this.y),this},distanceTo:function(u){u=H(u);var f=u.x-this.x,y=u.y-this.y;return Math.sqrt(f*f+y*y)},equals:function(u){return u=H(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=H(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function H(u,f,y){return u instanceof q?u:S(u)?new q(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new q(u.x,u.y):new q(u,f,y)}function X(u,f){if(u)for(var y=f?[u,f]:u,w=0,A=y.length;w<A;w++)this.extend(y[w])}X.prototype={extend:function(u){var f,y;if(!u)return this;if(u instanceof q||typeof u[0]=="number"||"x"in u)f=y=H(u);else if(u=oe(u),f=u.min,y=u.max,!f||!y)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=y.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(y.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(y.y,this.max.y)),this},getCenter:function(u){return H((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return H(this.min.x,this.max.y)},getTopRight:function(){return H(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var f,y;return typeof u[0]=="number"||u instanceof q?u=H(u):u=oe(u),u instanceof X?(f=u.min,y=u.max):f=y=u,f.x>=this.min.x&&y.x<=this.max.x&&f.y>=this.min.y&&y.y<=this.max.y},intersects:function(u){u=oe(u);var f=this.min,y=this.max,w=u.min,A=u.max,B=A.x>=f.x&&w.x<=y.x,W=A.y>=f.y&&w.y<=y.y;return B&&W},overlaps:function(u){u=oe(u);var f=this.min,y=this.max,w=u.min,A=u.max,B=A.x>f.x&&w.x<y.x,W=A.y>f.y&&w.y<y.y;return B&&W},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var f=this.min,y=this.max,w=Math.abs(f.x-y.x)*u,A=Math.abs(f.y-y.y)*u;return oe(H(f.x-w,f.y-A),H(y.x+w,y.y+A))},equals:function(u){return u?(u=oe(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function oe(u,f){return!u||u instanceof X?u:new X(u,f)}function ae(u,f){if(u)for(var y=f?[u,f]:u,w=0,A=y.length;w<A;w++)this.extend(y[w])}ae.prototype={extend:function(u){var f=this._southWest,y=this._northEast,w,A;if(u instanceof ge)w=u,A=u;else if(u instanceof ae){if(w=u._southWest,A=u._northEast,!w||!A)return this}else return u?this.extend(te(u)||je(u)):this;return!f&&!y?(this._southWest=new ge(w.lat,w.lng),this._northEast=new ge(A.lat,A.lng)):(f.lat=Math.min(w.lat,f.lat),f.lng=Math.min(w.lng,f.lng),y.lat=Math.max(A.lat,y.lat),y.lng=Math.max(A.lng,y.lng)),this},pad:function(u){var f=this._southWest,y=this._northEast,w=Math.abs(f.lat-y.lat)*u,A=Math.abs(f.lng-y.lng)*u;return new ae(new ge(f.lat-w,f.lng-A),new ge(y.lat+w,y.lng+A))},getCenter:function(){return new ge((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ge(this.getNorth(),this.getWest())},getSouthEast:function(){return new ge(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof ge||"lat"in u?u=te(u):u=je(u);var f=this._southWest,y=this._northEast,w,A;return u instanceof ae?(w=u.getSouthWest(),A=u.getNorthEast()):w=A=u,w.lat>=f.lat&&A.lat<=y.lat&&w.lng>=f.lng&&A.lng<=y.lng},intersects:function(u){u=je(u);var f=this._southWest,y=this._northEast,w=u.getSouthWest(),A=u.getNorthEast(),B=A.lat>=f.lat&&w.lat<=y.lat,W=A.lng>=f.lng&&w.lng<=y.lng;return B&&W},overlaps:function(u){u=je(u);var f=this._southWest,y=this._northEast,w=u.getSouthWest(),A=u.getNorthEast(),B=A.lat>f.lat&&w.lat<y.lat,W=A.lng>f.lng&&w.lng<y.lng;return B&&W},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,f){return u?(u=je(u),this._southWest.equals(u.getSouthWest(),f)&&this._northEast.equals(u.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function je(u,f){return u instanceof ae?u:new ae(u,f)}function ge(u,f,y){if(isNaN(u)||isNaN(f))throw new Error("Invalid LatLng object: ("+u+", "+f+")");this.lat=+u,this.lng=+f,y!==void 0&&(this.alt=+y)}ge.prototype={equals:function(u,f){if(!u)return!1;u=te(u);var y=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return y<=(f===void 0?1e-9:f)},toString:function(u){return"LatLng("+p(this.lat,u)+", "+p(this.lng,u)+")"},distanceTo:function(u){return Fe.distance(this,te(u))},wrap:function(){return Fe.wrapLatLng(this)},toBounds:function(u){var f=180*u/40075017,y=f/Math.cos(Math.PI/180*this.lat);return je([this.lat-f,this.lng-y],[this.lat+f,this.lng+y])},clone:function(){return new ge(this.lat,this.lng,this.alt)}};function te(u,f,y){return u instanceof ge?u:S(u)&&typeof u[0]!="object"?u.length===3?new ge(u[0],u[1],u[2]):u.length===2?new ge(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new ge(u.lat,"lng"in u?u.lng:u.lon,u.alt):f===void 0?null:new ge(u,f,y)}var be={latLngToPoint:function(u,f){var y=this.projection.project(u),w=this.scale(f);return this.transformation._transform(y,w)},pointToLatLng:function(u,f){var y=this.scale(f),w=this.transformation.untransform(u,y);return this.projection.unproject(w)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var f=this.projection.bounds,y=this.scale(u),w=this.transformation.transform(f.min,y),A=this.transformation.transform(f.max,y);return new X(w,A)},infinite:!1,wrapLatLng:function(u){var f=this.wrapLng?h(u.lng,this.wrapLng,!0):u.lng,y=this.wrapLat?h(u.lat,this.wrapLat,!0):u.lat,w=u.alt;return new ge(y,f,w)},wrapLatLngBounds:function(u){var f=u.getCenter(),y=this.wrapLatLng(f),w=f.lat-y.lat,A=f.lng-y.lng;if(w===0&&A===0)return u;var B=u.getSouthWest(),W=u.getNorthEast(),Y=new ge(B.lat-w,B.lng-A),ne=new ge(W.lat-w,W.lng-A);return new ae(Y,ne)}},Fe=s({},be,{wrapLng:[-180,180],R:6371e3,distance:function(u,f){var y=Math.PI/180,w=u.lat*y,A=f.lat*y,B=Math.sin((f.lat-u.lat)*y/2),W=Math.sin((f.lng-u.lng)*y/2),Y=B*B+Math.cos(w)*Math.cos(A)*W*W,ne=2*Math.atan2(Math.sqrt(Y),Math.sqrt(1-Y));return this.R*ne}}),vt=6378137,ce={R:vt,MAX_LATITUDE:85.0511287798,project:function(u){var f=Math.PI/180,y=this.MAX_LATITUDE,w=Math.max(Math.min(y,u.lat),-y),A=Math.sin(w*f);return new q(this.R*u.lng*f,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(u){var f=180/Math.PI;return new ge((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*f,u.x*f/this.R)},bounds:function(){var u=vt*Math.PI;return new X([-u,-u],[u,u])}()};function Be(u,f,y,w){if(S(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=f,this._c=y,this._d=w}Be.prototype={transform:function(u,f){return this._transform(u.clone(),f)},_transform:function(u,f){return f=f||1,u.x=f*(this._a*u.x+this._b),u.y=f*(this._c*u.y+this._d),u},untransform:function(u,f){return f=f||1,new q((u.x/f-this._b)/this._a,(u.y/f-this._d)/this._c)}};function Ye(u,f,y,w){return new Be(u,f,y,w)}var pe=s({},Fe,{code:"EPSG:3857",projection:ce,transformation:function(){var u=.5/(Math.PI*ce.R);return Ye(u,.5,-u,.5)}()}),bt=s({},pe,{code:"EPSG:900913"});function Ht(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function vr(u,f){var y="",w,A,B,W,Y,ne;for(w=0,B=u.length;w<B;w++){for(Y=u[w],A=0,W=Y.length;A<W;A++)ne=Y[A],y+=(A?"L":"M")+ne.x+" "+ne.y;y+=f?Ze.svg?"z":"x":""}return y||"M0 0"}var nr=document.documentElement.style,at="ActiveXObject"in window,he=at&&!document.addEventListener,U="msLaunchUri"in navigator&&!("documentMode"in document),G=ki("webkit"),re=ki("android"),Ae=ki("android 2")||ki("android 3"),Te=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_e=re&&ki("Google")&&Te<537&&!("AudioNode"in window),Pe=!!window.opera,lt=!U&&ki("chrome"),Vt=ki("gecko")&&!G&&!Pe&&!at,Wr=!lt&&ki("safari"),ko=ki("phantom"),Xs="OTransition"in nr,aa=navigator.platform.indexOf("Win")===0,la=at&&"transition"in nr,No="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ae,yl="MozPerspective"in nr,Yd=!window.L_DISABLE_3D&&(la||No||yl)&&!Xs&&!ko,ca=typeof orientation<"u"||ki("mobile"),xl=ca&&G,wx=ca&&No,Jm=!window.PointerEvent&&window.MSPointerEvent,vl=!!(window.PointerEvent||Jm),Xd="ontouchstart"in window||!!window.TouchEvent,ep=!window.L_NO_TOUCH&&(Xd||vl),ua=ca&&Pe,kx=ca&&Vt,Jd=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Nx=function(){var u=!1;try{var f=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",m,f),window.removeEventListener("testPassiveEventSupport",m,f)}catch{}return u}(),iu=function(){return!!document.createElement("canvas").getContext}(),eh=!!(document.createElementNS&&Ht("svg").createSVGRect),Hr=!!eh&&function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Ex=!eh&&function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var f=u.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}}(),ou=navigator.platform.indexOf("Mac")===0,au=navigator.platform.indexOf("Linux")===0;function ki(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var Ze={ie:at,ielt9:he,edge:U,webkit:G,android:re,android23:Ae,androidStock:_e,opera:Pe,chrome:lt,gecko:Vt,safari:Wr,phantom:ko,opera12:Xs,win:aa,ie3d:la,webkit3d:No,gecko3d:yl,any3d:Yd,mobile:ca,mobileWebkit:xl,mobileWebkit3d:wx,msPointer:Jm,pointer:vl,touch:ep,touchNative:Xd,mobileOpera:ua,mobileGecko:kx,retina:Jd,passiveEvents:Nx,canvas:iu,svg:eh,vml:Ex,inlineSvg:Hr,mac:ou,linux:au},da=Ze.msPointer?"MSPointerDown":"pointerdown",Sx=Ze.msPointer?"MSPointerMove":"pointermove",Tx=Ze.msPointer?"MSPointerUp":"pointerup",lu=Ze.msPointer?"MSPointerCancel":"pointercancel",th={touchstart:da,touchmove:Sx,touchend:Tx,touchcancel:lu},nh={touchstart:sh,touchmove:rh,touchend:rh,touchcancel:rh},Qi={},Zi=!1;function Cx(u,f,y){return f==="touchstart"&&jx(),nh[f]?(y=nh[f].bind(this,y),u.addEventListener(th[f],y,!1),y):(console.warn("wrong event specified:",f),m)}function Ix(u,f,y){if(!th[f]){console.warn("wrong event specified:",f);return}u.removeEventListener(th[f],y,!1)}function tp(u){Qi[u.pointerId]=u}function np(u){Qi[u.pointerId]&&(Qi[u.pointerId]=u)}function rp(u){delete Qi[u.pointerId]}function jx(){Zi||(document.addEventListener(da,tp,!0),document.addEventListener(Sx,np,!0),document.addEventListener(Tx,rp,!0),document.addEventListener(lu,rp,!0),Zi=!0)}function rh(u,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var y in Qi)f.touches.push(Qi[y]);f.changedTouches=[f],u(f)}}function sh(u,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&On(f),rh(u,f)}function Ax(u){var f={},y,w;for(w in u)y=u[w],f[w]=y&&y.bind?y.bind(u):y;return u=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var sp=200;function cu(u,f){u.addEventListener("dblclick",f);var y=0,w;function A(B){if(B.detail!==1){w=B.detail;return}if(!(B.pointerType==="mouse"||B.sourceCapabilities&&!B.sourceCapabilities.firesTouchEvents)){var W=gp(B);if(!(W.some(function(ne){return ne instanceof HTMLLabelElement&&ne.attributes.for})&&!W.some(function(ne){return ne instanceof HTMLInputElement||ne instanceof HTMLSelectElement}))){var Y=Date.now();Y-y<=sp?(w++,w===2&&f(Ax(B))):w=1,y=Y}}}return u.addEventListener("click",A),{dblclick:f,simDblclick:A}}function ha(u,f){u.removeEventListener("dblclick",f.dblclick),u.removeEventListener("click",f.simDblclick)}var uu=ma(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),du=ma(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ip=du==="webkitTransition"||du==="OTransition"?du+"End":"transitionend";function op(u){return typeof u=="string"?document.getElementById(u):u}function bl(u,f){var y=u.style[f]||u.currentStyle&&u.currentStyle[f];if((!y||y==="auto")&&document.defaultView){var w=document.defaultView.getComputedStyle(u,null);y=w?w[f]:null}return y==="auto"?null:y}function Lt(u,f,y){var w=document.createElement(u);return w.className=f||"",y&&y.appendChild(w),w}function fn(u){var f=u.parentNode;f&&f.removeChild(u)}function hu(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function fa(u){var f=u.parentNode;f&&f.lastChild!==u&&f.appendChild(u)}function _l(u){var f=u.parentNode;f&&f.firstChild!==u&&f.insertBefore(u,f.firstChild)}function ap(u,f){if(u.classList!==void 0)return u.classList.contains(f);var y=Ni(u);return y.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(y)}function yt(u,f){if(u.classList!==void 0)for(var y=x(f),w=0,A=y.length;w<A;w++)u.classList.add(y[w]);else if(!ap(u,f)){var B=Ni(u);lp(u,(B?B+" ":"")+f)}}function jn(u,f){u.classList!==void 0?u.classList.remove(f):lp(u,v((" "+Ni(u)+" ").replace(" "+f+" "," ")))}function lp(u,f){u.className.baseVal===void 0?u.className=f:u.className.baseVal=f}function Ni(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function Kn(u,f){"opacity"in u.style?u.style.opacity=f:"filter"in u.style&&ih(u,f)}function ih(u,f){var y=!1,w="DXImageTransform.Microsoft.Alpha";try{y=u.filters.item(w)}catch{if(f===1)return}f=Math.round(f*100),y?(y.Enabled=f!==100,y.Opacity=f):u.style.filter+=" progid:"+w+"(opacity="+f+")"}function ma(u){for(var f=document.documentElement.style,y=0;y<u.length;y++)if(u[y]in f)return u[y];return!1}function Eo(u,f,y){var w=f||new q(0,0);u.style[uu]=(Ze.ie3d?"translate("+w.x+"px,"+w.y+"px)":"translate3d("+w.x+"px,"+w.y+"px,0)")+(y?" scale("+y+")":"")}function ut(u,f){u._leaflet_pos=f,Ze.any3d?Eo(u,f):(u.style.left=f.x+"px",u.style.top=f.y+"px")}function Ei(u){return u._leaflet_pos||new q(0,0)}var Yi,Xi,cp;if("onselectstart"in document)Yi=function(){st(window,"selectstart",On)},Xi=function(){on(window,"selectstart",On)};else{var wl=ma(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Yi=function(){if(wl){var u=document.documentElement.style;cp=u[wl],u[wl]="none"}},Xi=function(){wl&&(document.documentElement.style[wl]=cp,cp=void 0)}}function up(){st(window,"dragstart",On)}function dp(){on(window,"dragstart",On)}var oh,hp;function pa(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&(Js(),oh=u,hp=u.style.outlineStyle,u.style.outlineStyle="none",st(window,"keydown",Js))}function Js(){oh&&(oh.style.outlineStyle=hp,oh=void 0,hp=void 0,on(window,"keydown",Js))}function fp(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function ah(u){var f=u.getBoundingClientRect();return{x:f.width/u.offsetWidth||1,y:f.height/u.offsetHeight||1,boundingClientRect:f}}var Rx={__proto__:null,TRANSFORM:uu,TRANSITION:du,TRANSITION_END:ip,get:op,getStyle:bl,create:Lt,remove:fn,empty:hu,toFront:fa,toBack:_l,hasClass:ap,addClass:yt,removeClass:jn,setClass:lp,getClass:Ni,setOpacity:Kn,testProp:ma,setTransform:Eo,setPosition:ut,getPosition:Ei,get disableTextSelection(){return Yi},get enableTextSelection(){return Xi},disableImageDrag:up,enableImageDrag:dp,preventOutline:pa,restoreOutline:Js,getSizedParentNode:fp,getScale:ah};function st(u,f,y,w){if(f&&typeof f=="object")for(var A in f)mp(u,A,f[A],y);else{f=x(f);for(var B=0,W=f.length;B<W;B++)mp(u,f[B],y,w)}return this}var Si="_leaflet_events";function on(u,f,y,w){if(arguments.length===1)Px(u),delete u[Si];else if(f&&typeof f=="object")for(var A in f)pp(u,A,f[A],y);else if(f=x(f),arguments.length===2)Px(u,function(Y){return T(f,Y)!==-1});else for(var B=0,W=f.length;B<W;B++)pp(u,f[B],y,w);return this}function Px(u,f){for(var y in u[Si]){var w=y.split(/\d/)[0];(!f||f(w))&&pp(u,w,null,null,y)}}var Ti={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mp(u,f,y,w){var A=f+c(y)+(w?"_"+c(w):"");if(u[Si]&&u[Si][A])return this;var B=function(Y){return y.call(w||u,Y||window.event)},W=B;!Ze.touchNative&&Ze.pointer&&f.indexOf("touch")===0?B=Cx(u,f,B):Ze.touch&&f==="dblclick"?B=cu(u,B):"addEventListener"in u?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?u.addEventListener(Ti[f]||f,B,Ze.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(B=function(Y){Y=Y||window.event,yp(u,Y)&&W(Y)},u.addEventListener(Ti[f],B,!1)):u.addEventListener(f,W,!1):u.attachEvent("on"+f,B),u[Si]=u[Si]||{},u[Si][A]=B}function pp(u,f,y,w,A){A=A||f+c(y)+(w?"_"+c(w):"");var B=u[Si]&&u[Si][A];if(!B)return this;!Ze.touchNative&&Ze.pointer&&f.indexOf("touch")===0?Ix(u,f,B):Ze.touch&&f==="dblclick"?ha(u,B):"removeEventListener"in u?u.removeEventListener(Ti[f]||f,B,!1):u.detachEvent("on"+f,B),u[Si][A]=null}function Ci(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function kl(u){return mp(u,"wheel",Ci),this}function Nl(u){return st(u,"mousedown touchstart dblclick contextmenu",Ci),u._leaflet_disable_click=!0,this}function On(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function ei(u){return On(u),Ci(u),this}function gp(u){if(u.composedPath)return u.composedPath();for(var f=[],y=u.target;y;)f.push(y),y=y.parentNode;return f}function lh(u,f){if(!f)return new q(u.clientX,u.clientY);var y=ah(f),w=y.boundingClientRect;return new q((u.clientX-w.left)/y.x-f.clientLeft,(u.clientY-w.top)/y.y-f.clientTop)}var An=Ze.linux&&Ze.chrome?window.devicePixelRatio:Ze.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Lx(u){return Ze.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/An:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function yp(u,f){var y=f.relatedTarget;if(!y)return!0;try{for(;y&&y!==u;)y=y.parentNode}catch{return!1}return y!==u}var Mx={__proto__:null,on:st,off:on,stopPropagation:Ci,disableScrollPropagation:kl,disableClickPropagation:Nl,preventDefault:On,stop:ei,getPropagationPath:gp,getMousePosition:lh,getWheelDelta:Lx,isExternalTarget:yp,addListener:st,removeListener:on},xp=le.extend({run:function(u,f,y,w){this.stop(),this._el=u,this._inProgress=!0,this._duration=y||.25,this._easeOutPower=1/Math.max(w||.5,.2),this._startPos=Ei(u),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(u){var f=+new Date-this._startTime,y=this._duration*1e3;f<y?this._runFrame(this._easeOut(f/y),u):(this._runFrame(1),this._complete())},_runFrame:function(u,f){var y=this._startPos.add(this._offset.multiplyBy(u));f&&y._round(),ut(this._el,y),this.fire("step")},_complete:function(){V(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),Rt=le.extend({options:{crs:pe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,f){f=b(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(te(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=du&&Ze.any3d&&!Ze.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),st(this._proxy,ip,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,f,y){if(f=f===void 0?this._zoom:this._limitZoom(f),u=this._limitCenter(te(u),f,this.options.maxBounds),y=y||{},this._stop(),this._loaded&&!y.reset&&y!==!0){y.animate!==void 0&&(y.zoom=s({animate:y.animate},y.zoom),y.pan=s({animate:y.animate,duration:y.duration},y.pan));var w=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,f,y.zoom):this._tryAnimatedPan(u,y.pan);if(w)return clearTimeout(this._sizeTimer),this}return this._resetView(u,f,y.pan&&y.pan.noMoveStart),this},setZoom:function(u,f){return this._loaded?this.setView(this.getCenter(),u,{zoom:f}):(this._zoom=u,this)},zoomIn:function(u,f){return u=u||(Ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,f)},zoomOut:function(u,f){return u=u||(Ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,f)},setZoomAround:function(u,f,y){var w=this.getZoomScale(f),A=this.getSize().divideBy(2),B=u instanceof q?u:this.latLngToContainerPoint(u),W=B.subtract(A).multiplyBy(1-1/w),Y=this.containerPointToLatLng(A.add(W));return this.setView(Y,f,{zoom:y})},_getBoundsCenterZoom:function(u,f){f=f||{},u=u.getBounds?u.getBounds():je(u);var y=H(f.paddingTopLeft||f.padding||[0,0]),w=H(f.paddingBottomRight||f.padding||[0,0]),A=this.getBoundsZoom(u,!1,y.add(w));if(A=typeof f.maxZoom=="number"?Math.min(f.maxZoom,A):A,A===1/0)return{center:u.getCenter(),zoom:A};var B=w.subtract(y).divideBy(2),W=this.project(u.getSouthWest(),A),Y=this.project(u.getNorthEast(),A),ne=this.unproject(W.add(Y).divideBy(2).add(B),A);return{center:ne,zoom:A}},fitBounds:function(u,f){if(u=je(u),!u.isValid())throw new Error("Bounds are not valid.");var y=this._getBoundsCenterZoom(u,f);return this.setView(y.center,y.zoom,f)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,f){return this.setView(u,this._zoom,{pan:f})},panBy:function(u,f){if(u=H(u).round(),f=f||{},!u.x&&!u.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new xp,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){yt(this._mapPane,"leaflet-pan-anim");var y=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,y,f.duration||.25,f.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,f,y){if(y=y||{},y.animate===!1||!Ze.any3d)return this.setView(u,f,y);this._stop();var w=this.project(this.getCenter()),A=this.project(u),B=this.getSize(),W=this._zoom;u=te(u),f=f===void 0?W:f;var Y=Math.max(B.x,B.y),ne=Y*this.getZoomScale(W,f),fe=A.distanceTo(w)||1,Oe=1.42,it=Oe*Oe;function It(dr){var Yx=dr?-1:1,MG=dr?ne:Y,OG=ne*ne-Y*Y+Yx*it*it*fe*fe,DG=2*MG*it*fe,Q1=OG/DG,bP=Math.sqrt(Q1*Q1+1)-Q1,VG=bP<1e-9?-18:Math.log(bP);return VG}function ws(dr){return(Math.exp(dr)-Math.exp(-dr))/2}function jr(dr){return(Math.exp(dr)+Math.exp(-dr))/2}function ji(dr){return ws(dr)/jr(dr)}var Ds=It(0);function _h(dr){return Y*(jr(Ds)/jr(Ds+Oe*dr))}function AG(dr){return Y*(jr(Ds)*ji(Ds+Oe*dr)-ws(Ds))/it}function RG(dr){return 1-Math.pow(1-dr,1.5)}var PG=Date.now(),xP=(It(1)-Ds)/Oe,LG=y.duration?1e3*y.duration:1e3*xP*.8;function vP(){var dr=(Date.now()-PG)/LG,Yx=RG(dr)*xP;dr<=1?(this._flyToFrame=F(vP,this),this._move(this.unproject(w.add(A.subtract(w).multiplyBy(AG(Yx)/fe)),W),this.getScaleZoom(Y/_h(Yx),W),{flyTo:!0})):this._move(u,f)._moveEnd(!0)}return this._moveStart(!0,y.noMoveStart),vP.call(this),this},flyToBounds:function(u,f){var y=this._getBoundsCenterZoom(u,f);return this.flyTo(y.center,y.zoom,f)},setMaxBounds:function(u){return u=je(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var f=this.options.minZoom;return this.options.minZoom=u,this._loaded&&f!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var f=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&f!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,f){this._enforcingBounds=!0;var y=this.getCenter(),w=this._limitCenter(y,this._zoom,je(u));return y.equals(w)||this.panTo(w,f),this._enforcingBounds=!1,this},panInside:function(u,f){f=f||{};var y=H(f.paddingTopLeft||f.padding||[0,0]),w=H(f.paddingBottomRight||f.padding||[0,0]),A=this.project(this.getCenter()),B=this.project(u),W=this.getPixelBounds(),Y=oe([W.min.add(y),W.max.subtract(w)]),ne=Y.getSize();if(!Y.contains(B)){this._enforcingBounds=!0;var fe=B.subtract(Y.getCenter()),Oe=Y.extend(B).getSize().subtract(ne);A.x+=fe.x<0?-Oe.x:Oe.x,A.y+=fe.y<0?-Oe.y:Oe.y,this.panTo(this.unproject(A),f),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=s({animate:!1,pan:!0},u===!0?{animate:!0}:u);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var y=this.getSize(),w=f.divideBy(2).round(),A=y.divideBy(2).round(),B=w.subtract(A);return!B.x&&!B.y?this:(u.animate&&u.pan?this.panBy(B):(u.pan&&this._rawPanBy(B),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:y}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=s({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=o(this._handleGeolocationResponse,this),y=o(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,y,u):navigator.geolocation.getCurrentPosition(f,y,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var f=u.code,y=u.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+y+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var f=u.coords.latitude,y=u.coords.longitude,w=new ge(f,y),A=w.toBounds(u.coords.accuracy*2),B=this._locateOptions;if(B.setView){var W=this.getBoundsZoom(A);this.setView(w,B.maxZoom?Math.min(W,B.maxZoom):W)}var Y={latlng:w,bounds:A,timestamp:u.timestamp};for(var ne in u.coords)typeof u.coords[ne]=="number"&&(Y[ne]=u.coords[ne]);this.fire("locationfound",Y)}},addHandler:function(u,f){if(!f)return this;var y=this[u]=new f(this);return this._handlers.push(y),this.options[u]&&y.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),fn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(V(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)fn(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,f){var y="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),w=Lt("div",y,f||this._mapPane);return u&&(this._panes[u]=w),w},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),f=this.unproject(u.getBottomLeft()),y=this.unproject(u.getTopRight());return new ae(f,y)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,f,y){u=je(u),y=H(y||[0,0]);var w=this.getZoom()||0,A=this.getMinZoom(),B=this.getMaxZoom(),W=u.getNorthWest(),Y=u.getSouthEast(),ne=this.getSize().subtract(y),fe=oe(this.project(Y,w),this.project(W,w)).getSize(),Oe=Ze.any3d?this.options.zoomSnap:1,it=ne.x/fe.x,It=ne.y/fe.y,ws=f?Math.max(it,It):Math.min(it,It);return w=this.getScaleZoom(ws,w),Oe&&(w=Math.round(w/(Oe/100))*(Oe/100),w=f?Math.ceil(w/Oe)*Oe:Math.floor(w/Oe)*Oe),Math.max(A,Math.min(B,w))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,f){var y=this._getTopLeftPoint(u,f);return new X(y,y.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,f){var y=this.options.crs;return f=f===void 0?this._zoom:f,y.scale(u)/y.scale(f)},getScaleZoom:function(u,f){var y=this.options.crs;f=f===void 0?this._zoom:f;var w=y.zoom(u*y.scale(f));return isNaN(w)?1/0:w},project:function(u,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(te(u),f)},unproject:function(u,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(H(u),f)},layerPointToLatLng:function(u){var f=H(u).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(u){var f=this.project(te(u))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(te(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(je(u))},distance:function(u,f){return this.options.crs.distance(te(u),te(f))},containerPointToLayerPoint:function(u){return H(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return H(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var f=this.containerPointToLayerPoint(H(u));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(te(u)))},mouseEventToContainerPoint:function(u){return lh(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var f=this._container=op(u);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");st(f,"scroll",this._onScroll,this),this._containerId=c(f)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ze.any3d,yt(u,"leaflet-container"+(Ze.touch?" leaflet-touch":"")+(Ze.retina?" leaflet-retina":"")+(Ze.ielt9?" leaflet-oldie":"")+(Ze.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=bl(u,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ut(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(u.markerPane,"leaflet-zoom-hide"),yt(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,f,y){ut(this._mapPane,new q(0,0));var w=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var A=this._zoom!==f;this._moveStart(A,y)._move(u,f)._moveEnd(A),this.fire("viewreset"),w&&this.fire("load")},_moveStart:function(u,f){return u&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(u,f,y,w){f===void 0&&(f=this._zoom);var A=this._zoom!==f;return this._zoom=f,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),w?y&&y.pinch&&this.fire("zoom",y):((A||y&&y.pinch)&&this.fire("zoom",y),this.fire("move",y)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return V(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){ut(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[c(this._container)]=this;var f=u?on:st;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),Ze.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){V(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,f){for(var y=[],w,A=f==="mouseout"||f==="mouseover",B=u.target||u.srcElement,W=!1;B;){if(w=this._targets[c(B)],w&&(f==="click"||f==="preclick")&&this._draggableMoved(w)){W=!0;break}if(w&&w.listens(f,!0)&&(A&&!yp(B,u)||(y.push(w),A))||B===this._container)break;B=B.parentNode}return!y.length&&!W&&!A&&this.listens(f,!0)&&(y=[this]),y},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var f=u.target||u.srcElement;if(!(!this._loaded||f._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(f))){var y=u.type;y==="mousedown"&&pa(f),this._fireDOMEvent(u,y)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,f,y){if(u.type==="click"){var w=s({},u);w.type="preclick",this._fireDOMEvent(w,w.type,y)}var A=this._findEventTargets(u,f);if(y){for(var B=[],W=0;W<y.length;W++)y[W].listens(f,!0)&&B.push(y[W]);A=B.concat(A)}if(A.length){f==="contextmenu"&&On(u);var Y=A[0],ne={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var fe=Y.getLatLng&&(!Y._radius||Y._radius<=10);ne.containerPoint=fe?this.latLngToContainerPoint(Y.getLatLng()):this.mouseEventToContainerPoint(u),ne.layerPoint=this.containerPointToLayerPoint(ne.containerPoint),ne.latlng=fe?Y.getLatLng():this.layerPointToLatLng(ne.layerPoint)}for(W=0;W<A.length;W++)if(A[W].fire(f,ne,!0),ne.originalEvent._stopped||A[W].options.bubblingMouseEvents===!1&&T(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,f=this._handlers.length;u<f;u++)this._handlers[u].disable()},whenReady:function(u,f){return this._loaded?u.call(f||this,{target:this}):this.on("load",u,f),this},_getMapPanePos:function(){return Ei(this._mapPane)||new q(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,f){var y=u&&f!==void 0?this._getNewPixelOrigin(u,f):this.getPixelOrigin();return y.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,f){var y=this.getSize()._divideBy(2);return this.project(u,f)._subtract(y)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,f,y){var w=this._getNewPixelOrigin(y,f);return this.project(u,f)._subtract(w)},_latLngBoundsToNewLayerBounds:function(u,f,y){var w=this._getNewPixelOrigin(y,f);return oe([this.project(u.getSouthWest(),f)._subtract(w),this.project(u.getNorthWest(),f)._subtract(w),this.project(u.getSouthEast(),f)._subtract(w),this.project(u.getNorthEast(),f)._subtract(w)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,f,y){if(!y)return u;var w=this.project(u,f),A=this.getSize().divideBy(2),B=new X(w.subtract(A),w.add(A)),W=this._getBoundsOffset(B,y,f);return Math.abs(W.x)<=1&&Math.abs(W.y)<=1?u:this.unproject(w.add(W),f)},_limitOffset:function(u,f){if(!f)return u;var y=this.getPixelBounds(),w=new X(y.min.add(u),y.max.add(u));return u.add(this._getBoundsOffset(w,f))},_getBoundsOffset:function(u,f,y){var w=oe(this.project(f.getNorthEast(),y),this.project(f.getSouthWest(),y)),A=w.min.subtract(u.min),B=w.max.subtract(u.max),W=this._rebound(A.x,-B.x),Y=this._rebound(A.y,-B.y);return new q(W,Y)},_rebound:function(u,f){return u+f>0?Math.round(u-f)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(f))},_limitZoom:function(u){var f=this.getMinZoom(),y=this.getMaxZoom(),w=Ze.any3d?this.options.zoomSnap:1;return w&&(u=Math.round(u/w)*w),Math.max(f,Math.min(y,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){jn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,f){var y=this._getCenterOffset(u)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(y)?!1:(this.panBy(y,f),!0)},_createAnimProxy:function(){var u=this._proxy=Lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(f){var y=uu,w=this._proxy.style[y];Eo(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),w===this._proxy.style[y]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){fn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),f=this.getZoom();Eo(this._proxy,this.project(u,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,f,y){if(this._animatingZoom)return!0;if(y=y||{},!this._zoomAnimated||y.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var w=this.getZoomScale(f),A=this._getCenterOffset(u)._divideBy(1-1/w);return y.animate!==!0&&!this.getSize().contains(A)?!1:(F(function(){this._moveStart(!0,y.noMoveStart||!1)._animateZoom(u,f,!0)},this),!0)},_animateZoom:function(u,f,y,w){this._mapPane&&(y&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=f,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:f,noUpdate:w}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&jn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ch(u,f){return new Rt(u,f)}var Os=J.extend({options:{position:"topright"},initialize:function(u){b(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var f=this._map;return f&&f.removeControl(this),this.options.position=u,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var f=this._container=this.onAdd(u),y=this.getPosition(),w=u._controlCorners[y];return yt(f,"leaflet-control"),y.indexOf("bottom")!==-1?w.insertBefore(f,w.firstChild):w.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(fn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),_s=function(u){return new Os(u)};Rt.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},f="leaflet-",y=this._controlContainer=Lt("div",f+"control-container",this._container);function w(A,B){var W=f+A+" "+f+B;u[A+B]=Lt("div",W,y)}w("top","left"),w("top","right"),w("bottom","left"),w("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)fn(this._controlCorners[u]);fn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var vp=Os.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,f,y,w){return y<w?-1:w<y?1:0}},initialize:function(u,f,y){b(this,y),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var w in u)this._addLayer(u[w],w);for(w in f)this._addLayer(f[w],w,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return Os.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,f){return this._addLayer(u,f),this._map?this._update():this},addOverlay:function(u,f){return this._addLayer(u,f,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var f=this._getLayer(c(u));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):jn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return jn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",f=this._container=Lt("div",u),y=this.options.collapsed;f.setAttribute("aria-haspopup",!0),Nl(f),kl(f);var w=this._section=Lt("section",u+"-list");y&&(this._map.on("click",this.collapse,this),st(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=Lt("a",u+"-toggle",f);A.href="#",A.title="Layers",A.setAttribute("role","button"),st(A,{keydown:function(B){B.keyCode===13&&this._expandSafely()},click:function(B){On(B),this._expandSafely()}},this),y||this.expand(),this._baseLayersList=Lt("div",u+"-base",w),this._separator=Lt("div",u+"-separator",w),this._overlaysList=Lt("div",u+"-overlays",w),f.appendChild(w)},_getLayer:function(u){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&c(this._layers[f].layer)===u)return this._layers[f]},_addLayer:function(u,f,y){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:f,overlay:y}),this.options.sortLayers&&this._layers.sort(o(function(w,A){return this.options.sortFunction(w.layer,A.layer,w.name,A.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;hu(this._baseLayersList),hu(this._overlaysList),this._layerControlInputs=[];var u,f,y,w,A=0;for(y=0;y<this._layers.length;y++)w=this._layers[y],this._addItem(w),f=f||w.overlay,u=u||!w.overlay,A+=w.overlay?0:1;return this.options.hideSingleBase&&(u=u&&A>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=f&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var f=this._getLayer(c(u.target)),y=f.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;y&&this._map.fire(y,f)},_createRadioElement:function(u,f){var y='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(f?' checked="checked"':"")+"/>",w=document.createElement("div");return w.innerHTML=y,w.firstChild},_addItem:function(u){var f=document.createElement("label"),y=this._map.hasLayer(u.layer),w;u.overlay?(w=document.createElement("input"),w.type="checkbox",w.className="leaflet-control-layers-selector",w.defaultChecked=y):w=this._createRadioElement("leaflet-base-layers_"+c(this),y),this._layerControlInputs.push(w),w.layerId=c(u.layer),st(w,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+u.name;var B=document.createElement("span");f.appendChild(B),B.appendChild(w),B.appendChild(A);var W=u.overlay?this._overlaysList:this._baseLayersList;return W.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,f,y,w=[],A=[];this._handlingClick=!0;for(var B=u.length-1;B>=0;B--)f=u[B],y=this._getLayer(f.layerId).layer,f.checked?w.push(y):f.checked||A.push(y);for(B=0;B<A.length;B++)this._map.hasLayer(A[B])&&this._map.removeLayer(A[B]);for(B=0;B<w.length;B++)this._map.hasLayer(w[B])||this._map.addLayer(w[B]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,f,y,w=this._map.getZoom(),A=u.length-1;A>=0;A--)f=u[A],y=this._getLayer(f.layerId).layer,f.disabled=y.options.minZoom!==void 0&&w<y.options.minZoom||y.options.maxZoom!==void 0&&w>y.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,st(u,"click",On),this.expand();var f=this;setTimeout(function(){on(u,"click",On),f._preventClick=!1})}}),U1=function(u,f,y){return new vp(u,f,y)},ga=Os.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var f="leaflet-control-zoom",y=Lt("div",f+" leaflet-bar"),w=this.options;return this._zoomInButton=this._createButton(w.zoomInText,w.zoomInTitle,f+"-in",y,this._zoomIn),this._zoomOutButton=this._createButton(w.zoomOutText,w.zoomOutTitle,f+"-out",y,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),y},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,f,y,w,A){var B=Lt("a",y,w);return B.innerHTML=u,B.href="#",B.title=f,B.setAttribute("role","button"),B.setAttribute("aria-label",f),Nl(B),st(B,"click",ei),st(B,"click",A,this),st(B,"click",this._refocusOnMap,this),B},_updateDisabled:function(){var u=this._map,f="leaflet-disabled";jn(this._zoomInButton,f),jn(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&(yt(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&(yt(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});Rt.mergeOptions({zoomControl:!0}),Rt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ga,this.addControl(this.zoomControl))});var Ox=function(u){return new ga(u)},uh=Os.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var f="leaflet-control-scale",y=Lt("div",f),w=this.options;return this._addScales(w,f+"-line",y),u.on(w.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),y},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,f,y){u.metric&&(this._mScale=Lt("div",f,y)),u.imperial&&(this._iScale=Lt("div",f,y))},_update:function(){var u=this._map,f=u.getSize().y/2,y=u.distance(u.containerPointToLatLng([0,f]),u.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(y)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var f=this._getRoundNum(u),y=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,y,f/u)},_updateImperial:function(u){var f=u*3.2808399,y,w,A;f>5280?(y=f/5280,w=this._getRoundNum(y),this._updateScale(this._iScale,w+" mi",w/y)):(A=this._getRoundNum(f),this._updateScale(this._iScale,A+" ft",A/f))},_updateScale:function(u,f,y){u.style.width=Math.round(this.options.maxWidth*y)+"px",u.innerHTML=f},_getRoundNum:function(u){var f=Math.pow(10,(Math.floor(u)+"").length-1),y=u/f;return y=y>=10?10:y>=5?5:y>=3?3:y>=2?2:1,f*y}}),dh=function(u){return new uh(u)},Dx='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',El=Os.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ze.inlineSvg?Dx+" ":"")+"Leaflet</a>"},initialize:function(u){b(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=Lt("div","leaflet-control-attribution"),Nl(this._container);for(var f in u._layers)u._layers[f].getAttribution&&this.addAttribution(u._layers[f].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var f in this._attributions)this._attributions[f]&&u.push(f);var y=[];this.options.prefix&&y.push(this.options.prefix),u.length&&y.push(u.join(", ")),this._container.innerHTML=y.join(' <span aria-hidden="true">|</span> ')}}});Rt.mergeOptions({attributionControl:!0}),Rt.addInitHook(function(){this.options.attributionControl&&new El().addTo(this)});var W1=function(u){return new El(u)};Os.Layers=vp,Os.Zoom=ga,Os.Scale=uh,Os.Attribution=El,_s.layers=U1,_s.zoom=Ox,_s.scale=dh,_s.attribution=W1;var ti=J.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ti.addTo=function(u,f){return u.addHandler(f,this),this};var fu={Events:ve},bp=Ze.touch?"touchstart mousedown":"mousedown",Ji=le.extend({options:{clickTolerance:3},initialize:function(u,f,y,w){b(this,w),this._element=u,this._dragStartTarget=f||u,this._preventOutline=y},enable:function(){this._enabled||(st(this._dragStartTarget,bp,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ji._dragging===this&&this.finishDrag(!0),on(this._dragStartTarget,bp,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!ap(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){Ji._dragging===this&&this.finishDrag();return}if(!(Ji._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(Ji._dragging=this,this._preventOutline&&pa(this._element),up(),Yi(),!this._moving)){this.fire("down");var f=u.touches?u.touches[0]:u,y=fp(this._element);this._startPoint=new q(f.clientX,f.clientY),this._startPos=Ei(this._element),this._parentScale=ah(y);var w=u.type==="mousedown";st(document,w?"mousemove":"touchmove",this._onMove,this),st(document,w?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var f=u.touches&&u.touches.length===1?u.touches[0]:u,y=new q(f.clientX,f.clientY)._subtract(this._startPoint);!y.x&&!y.y||Math.abs(y.x)+Math.abs(y.y)<this.options.clickTolerance||(y.x/=this._parentScale.x,y.y/=this._parentScale.y,On(u),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(y),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),ut(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){jn(document.body,"leaflet-dragging"),this._lastTarget&&(jn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),on(document,"mousemove touchmove",this._onMove,this),on(document,"mouseup touchend touchcancel",this._onUp,this),dp(),Xi();var f=this._moved&&this._moving;this._moving=!1,Ji._dragging=!1,f&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function hh(u,f,y){var w,A=[1,4,2,8],B,W,Y,ne,fe,Oe,it,It;for(B=0,Oe=u.length;B<Oe;B++)u[B]._code=So(u[B],f);for(Y=0;Y<4;Y++){for(it=A[Y],w=[],B=0,Oe=u.length,W=Oe-1;B<Oe;W=B++)ne=u[B],fe=u[W],ne._code&it?fe._code&it||(It=Ir(fe,ne,it,f,y),It._code=So(It,f),w.push(It)):(fe._code&it&&(It=Ir(fe,ne,it,f,y),It._code=So(It,f),w.push(It)),w.push(ne));u=w}return u}function fh(u,f){var y,w,A,B,W,Y,ne,fe,Oe;if(!u||u.length===0)throw new Error("latlngs not passed");g(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var it=te([0,0]),It=je(u),ws=It.getNorthWest().distanceTo(It.getSouthWest())*It.getNorthEast().distanceTo(It.getNorthWest());ws<1700&&(it=mh(u));var jr=u.length,ji=[];for(y=0;y<jr;y++){var Ds=te(u[y]);ji.push(f.project(te([Ds.lat-it.lat,Ds.lng-it.lng])))}for(Y=ne=fe=0,y=0,w=jr-1;y<jr;w=y++)A=ji[y],B=ji[w],W=A.y*B.x-B.y*A.x,ne+=(A.x+B.x)*W,fe+=(A.y+B.y)*W,Y+=W*3;Y===0?Oe=ji[0]:Oe=[ne/Y,fe/Y];var _h=f.unproject(H(Oe));return te([_h.lat+it.lat,_h.lng+it.lng])}function mh(u){for(var f=0,y=0,w=0,A=0;A<u.length;A++){var B=te(u[A]);f+=B.lat,y+=B.lng,w++}return te([f/w,y/w])}var ph={__proto__:null,clipPolygon:hh,polygonCenter:fh,centroid:mh};function _p(u,f){if(!f||!u.length)return u.slice();var y=f*f;return u=Fx(u,y),u=Vx(u,y),u}function wp(u,f,y){return Math.sqrt(Ii(u,f,y,!0))}function ya(u,f,y){return Ii(u,f,y)}function Vx(u,f){var y=u.length,w=typeof Uint8Array<"u"?Uint8Array:Array,A=new w(y);A[0]=A[y-1]=1,gh(u,A,f,0,y-1);var B,W=[];for(B=0;B<y;B++)A[B]&&W.push(u[B]);return W}function gh(u,f,y,w,A){var B=0,W,Y,ne;for(Y=w+1;Y<=A-1;Y++)ne=Ii(u[Y],u[w],u[A],!0),ne>B&&(W=Y,B=ne);B>y&&(f[W]=1,gh(u,f,y,w,W),gh(u,f,y,W,A))}function Fx(u,f){for(var y=[u[0]],w=1,A=0,B=u.length;w<B;w++)$x(u[w],u[A])>f&&(y.push(u[w]),A=w);return A<B-1&&y.push(u[B-1]),y}var kp;function mu(u,f,y,w,A){var B=w?kp:So(u,y),W=So(f,y),Y,ne,fe;for(kp=W;;){if(!(B|W))return[u,f];if(B&W)return!1;Y=B||W,ne=Ir(u,f,Y,y,A),fe=So(ne,y),Y===B?(u=ne,B=fe):(f=ne,W=fe)}}function Ir(u,f,y,w,A){var B=f.x-u.x,W=f.y-u.y,Y=w.min,ne=w.max,fe,Oe;return y&8?(fe=u.x+B*(ne.y-u.y)/W,Oe=ne.y):y&4?(fe=u.x+B*(Y.y-u.y)/W,Oe=Y.y):y&2?(fe=ne.x,Oe=u.y+W*(ne.x-u.x)/B):y&1&&(fe=Y.x,Oe=u.y+W*(Y.x-u.x)/B),new q(fe,Oe,A)}function So(u,f){var y=0;return u.x<f.min.x?y|=1:u.x>f.max.x&&(y|=2),u.y<f.min.y?y|=4:u.y>f.max.y&&(y|=8),y}function $x(u,f){var y=f.x-u.x,w=f.y-u.y;return y*y+w*w}function Ii(u,f,y,w){var A=f.x,B=f.y,W=y.x-A,Y=y.y-B,ne=W*W+Y*Y,fe;return ne>0&&(fe=((u.x-A)*W+(u.y-B)*Y)/ne,fe>1?(A=y.x,B=y.y):fe>0&&(A+=W*fe,B+=Y*fe)),W=u.x-A,Y=u.y-B,w?W*W+Y*Y:new q(A,B)}function g(u){return!S(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function C(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),g(u)}function M(u,f){var y,w,A,B,W,Y,ne,fe;if(!u||u.length===0)throw new Error("latlngs not passed");g(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Oe=te([0,0]),it=je(u),It=it.getNorthWest().distanceTo(it.getSouthWest())*it.getNorthEast().distanceTo(it.getNorthWest());It<1700&&(Oe=mh(u));var ws=u.length,jr=[];for(y=0;y<ws;y++){var ji=te(u[y]);jr.push(f.project(te([ji.lat-Oe.lat,ji.lng-Oe.lng])))}for(y=0,w=0;y<ws-1;y++)w+=jr[y].distanceTo(jr[y+1])/2;if(w===0)fe=jr[0];else for(y=0,B=0;y<ws-1;y++)if(W=jr[y],Y=jr[y+1],A=W.distanceTo(Y),B+=A,B>w){ne=(B-w)/A,fe=[Y.x-ne*(Y.x-W.x),Y.y-ne*(Y.y-W.y)];break}var Ds=f.unproject(H(fe));return te([Ds.lat+Oe.lat,Ds.lng+Oe.lng])}var z={__proto__:null,simplify:_p,pointToSegmentDistance:wp,closestPointOnSegment:ya,clipSegment:mu,_getEdgeIntersection:Ir,_getBitCode:So,_sqClosestPointOnSegment:Ii,isFlat:g,_flat:C,polylineCenter:M},K={project:function(u){return new q(u.lng,u.lat)},unproject:function(u){return new ge(u.y,u.x)},bounds:new X([-180,-90],[180,90])},se={R:6378137,R_MINOR:6356752314245179e-9,bounds:new X([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var f=Math.PI/180,y=this.R,w=u.lat*f,A=this.R_MINOR/y,B=Math.sqrt(1-A*A),W=B*Math.sin(w),Y=Math.tan(Math.PI/4-w/2)/Math.pow((1-W)/(1+W),B/2);return w=-y*Math.log(Math.max(Y,1e-10)),new q(u.lng*f*y,w)},unproject:function(u){for(var f=180/Math.PI,y=this.R,w=this.R_MINOR/y,A=Math.sqrt(1-w*w),B=Math.exp(-u.y/y),W=Math.PI/2-2*Math.atan(B),Y=0,ne=.1,fe;Y<15&&Math.abs(ne)>1e-7;Y++)fe=A*Math.sin(W),fe=Math.pow((1-fe)/(1+fe),A/2),ne=Math.PI/2-2*Math.atan(B*fe)-W,W+=ne;return new ge(W*f,u.x*f/y)}},Ce={__proto__:null,LonLat:K,Mercator:se,SphericalMercator:ce},en=s({},Fe,{code:"EPSG:3395",projection:se,transformation:function(){var u=.5/(Math.PI*se.R);return Ye(u,.5,-u,.5)}()}),ur=s({},Fe,{code:"EPSG:4326",projection:K,transformation:Ye(1/180,1,-1/180,.5)}),Ft=s({},be,{projection:K,transformation:Ye(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,f){var y=f.lng-u.lng,w=f.lat-u.lat;return Math.sqrt(y*y+w*w)},infinite:!0});be.Earth=Fe,be.EPSG3395=en,be.EPSG3857=pe,be.EPSG900913=bt,be.EPSG4326=ur,be.Simple=Ft;var an=le.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[c(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[c(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var f=u.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var y=this.getEvents();f.on(y,this),this.once("remove",function(){f.off(y,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});Rt.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var f=c(u);return this._layers[f]?this:(this._layers[f]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var f=c(u);return this._layers[f]?(this._loaded&&u.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return c(u)in this._layers},eachLayer:function(u,f){for(var y in this._layers)u.call(f,this._layers[y]);return this},_addLayers:function(u){u=u?S(u)?u:[u]:[];for(var f=0,y=u.length;f<y;f++)this.addLayer(u[f])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[c(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var f=c(u);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,f=-1/0,y=this._getZoomSpan();for(var w in this._zoomBoundLayers){var A=this._zoomBoundLayers[w].options;u=A.minZoom===void 0?u:Math.min(u,A.minZoom),f=A.maxZoom===void 0?f:Math.max(f,A.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=u===1/0?void 0:u,y!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Dn=an.extend({initialize:function(u,f){b(this,f),this._layers={};var y,w;if(u)for(y=0,w=u.length;y<w;y++)this.addLayer(u[y])},addLayer:function(u){var f=this.getLayerId(u);return this._layers[f]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var f=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(u){var f=typeof u=="number"?u:this.getLayerId(u);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var f=Array.prototype.slice.call(arguments,1),y,w;for(y in this._layers)w=this._layers[y],w[u]&&w[u].apply(w,f);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,f){for(var y in this._layers)u.call(f,this._layers[y]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return c(u)}}),Sl=function(u,f){return new Dn(u,f)},rr=Dn.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),Dn.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),Dn.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new ae;for(var f in this._layers){var y=this._layers[f];u.extend(y.getBounds?y.getBounds():y.getLatLng())}return u}}),yh=function(u,f){return new rr(u,f)},To=J.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){b(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,f){var y=this._getIconUrl(u);if(!y){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var w=this._createImg(y,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(w,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),w},_setIconStyles:function(u,f){var y=this.options,w=y[f+"Size"];typeof w=="number"&&(w=[w,w]);var A=H(w),B=H(f==="shadow"&&y.shadowAnchor||y.iconAnchor||A&&A.divideBy(2,!0));u.className="leaflet-marker-"+f+" "+(y.className||""),B&&(u.style.marginLeft=-B.x+"px",u.style.marginTop=-B.y+"px"),A&&(u.style.width=A.x+"px",u.style.height=A.y+"px")},_createImg:function(u,f){return f=f||document.createElement("img"),f.src=u,f},_getIconUrl:function(u){return Ze.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function hG(u){return new To(u)}var Np=To.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof Np.imagePath!="string"&&(Np.imagePath=this._detectIconPath()),(this.options.imagePath||Np.imagePath)+To.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var f=function(y,w,A){var B=w.exec(y);return B&&B[A]};return u=f(u,/^url\((['"])?(.+)\1\)$/,2),u&&f(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=Lt("div","leaflet-default-icon-path",document.body),f=bl(u,"background-image")||bl(u,"backgroundImage");if(document.body.removeChild(u),f=this._stripUrl(f),f)return f;var y=document.querySelector('link[href$="leaflet.css"]');return y?y.href.substring(0,y.href.length-11-1):""}}),JR=ti.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new Ji(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&jn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var f=this._marker,y=f._map,w=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,B=Ei(f._icon),W=y.getPixelBounds(),Y=y.getPixelOrigin(),ne=oe(W.min._subtract(Y).add(A),W.max._subtract(Y).subtract(A));if(!ne.contains(B)){var fe=H((Math.max(ne.max.x,B.x)-ne.max.x)/(W.max.x-ne.max.x)-(Math.min(ne.min.x,B.x)-ne.min.x)/(W.min.x-ne.min.x),(Math.max(ne.max.y,B.y)-ne.max.y)/(W.max.y-ne.max.y)-(Math.min(ne.min.y,B.y)-ne.min.y)/(W.min.y-ne.min.y)).multiplyBy(w);y.panBy(fe,{animate:!1}),this._draggable._newPos._add(fe),this._draggable._startPos._add(fe),ut(f._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=F(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(V(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,u)))},_onDrag:function(u){var f=this._marker,y=f._shadow,w=Ei(f._icon),A=f._map.layerPointToLatLng(w);y&&ut(y,w),f._latlng=A,u.latlng=A,u.oldLatLng=this._oldLatLng,f.fire("move",u).fire("drag",u)},_onDragEnd:function(u){V(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),Bx=an.extend({options:{icon:new Np,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,f){b(this,f),this._latlng=te(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var f=this._latlng;return this._latlng=te(u),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),y=u.icon.createIcon(this._icon),w=!1;y!==this._icon&&(this._icon&&this._removeIcon(),w=!0,u.title&&(y.title=u.title),y.tagName==="IMG"&&(y.alt=u.alt||"")),yt(y,f),u.keyboard&&(y.tabIndex="0",y.setAttribute("role","button")),this._icon=y,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(y,"focus",this._panOnFocus,this);var A=u.icon.createShadow(this._shadow),B=!1;A!==this._shadow&&(this._removeShadow(),B=!0),A&&(yt(A,f),A.alt=""),this._shadow=A,u.opacity<1&&this._updateOpacity(),w&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&B&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&on(this._icon,"focus",this._panOnFocus,this),fn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&fn(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&ut(this._icon,u),this._shadow&&ut(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),JR)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new JR(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&Kn(this._icon,u),this._shadow&&Kn(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var f=this.options.icon.options,y=f.iconSize?H(f.iconSize):H(0,0),w=f.iconAnchor?H(f.iconAnchor):H(0,0);u.panInside(this._latlng,{paddingTopLeft:w,paddingBottomRight:y.subtract(w)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function fG(u,f){return new Bx(u,f)}var Tl=an.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return b(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),zx=Tl.extend({options:{fill:!0,radius:10},initialize:function(u,f){b(this,f),this._latlng=te(u),this._radius=this.options.radius},setLatLng:function(u){var f=this._latlng;return this._latlng=te(u),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var f=u&&u.radius||this._radius;return Tl.prototype.setStyle.call(this,u),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,f=this._radiusY||u,y=this._clickTolerance(),w=[u+y,f+y];this._pxBounds=new X(this._point.subtract(w),this._point.add(w))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function mG(u,f){return new zx(u,f)}var H1=zx.extend({initialize:function(u,f,y){if(typeof f=="number"&&(f=s({},y,{radius:f})),b(this,f),this._latlng=te(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new ae(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:Tl.prototype.setStyle,_project:function(){var u=this._latlng.lng,f=this._latlng.lat,y=this._map,w=y.options.crs;if(w.distance===Fe.distance){var A=Math.PI/180,B=this._mRadius/Fe.R/A,W=y.project([f+B,u]),Y=y.project([f-B,u]),ne=W.add(Y).divideBy(2),fe=y.unproject(ne).lat,Oe=Math.acos((Math.cos(B*A)-Math.sin(f*A)*Math.sin(fe*A))/(Math.cos(f*A)*Math.cos(fe*A)))/A;(isNaN(Oe)||Oe===0)&&(Oe=B/Math.cos(Math.PI/180*f)),this._point=ne.subtract(y.getPixelOrigin()),this._radius=isNaN(Oe)?0:ne.x-y.project([fe,u-Oe]).x,this._radiusY=ne.y-W.y}else{var it=w.unproject(w.project(this._latlng).subtract([this._mRadius,0]));this._point=y.latLngToLayerPoint(this._latlng),this._radius=this._point.x-y.latLngToLayerPoint(it).x}this._updateBounds()}});function pG(u,f,y){return new H1(u,f,y)}var xa=Tl.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,f){b(this,f),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var f=1/0,y=null,w=Ii,A,B,W=0,Y=this._parts.length;W<Y;W++)for(var ne=this._parts[W],fe=1,Oe=ne.length;fe<Oe;fe++){A=ne[fe-1],B=ne[fe];var it=w(u,A,B,!0);it<f&&(f=it,y=w(u,A,B))}return y&&(y.distance=Math.sqrt(f)),y},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return M(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,f){return f=f||this._defaultShape(),u=te(u),f.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new ae,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return g(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var f=[],y=g(u),w=0,A=u.length;w<A;w++)y?(f[w]=te(u[w]),this._bounds.extend(f[w])):f[w]=this._convertLatLngs(u[w]);return f},_project:function(){var u=new X;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),f=new q(u,u);this._rawPxBounds&&(this._pxBounds=new X([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(u,f,y){var w=u[0]instanceof ge,A=u.length,B,W;if(w){for(W=[],B=0;B<A;B++)W[B]=this._map.latLngToLayerPoint(u[B]),y.extend(W[B]);f.push(W)}else for(B=0;B<A;B++)this._projectLatlngs(u[B],f,y)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,y,w,A,B,W,Y,ne;for(y=0,A=0,B=this._rings.length;y<B;y++)for(ne=this._rings[y],w=0,W=ne.length;w<W-1;w++)Y=mu(ne[w],ne[w+1],u,w,!0),Y&&(f[A]=f[A]||[],f[A].push(Y[0]),(Y[1]!==ne[w+1]||w===W-2)&&(f[A].push(Y[1]),A++))}},_simplifyPoints:function(){for(var u=this._parts,f=this.options.smoothFactor,y=0,w=u.length;y<w;y++)u[y]=_p(u[y],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,f){var y,w,A,B,W,Y,ne=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(y=0,B=this._parts.length;y<B;y++)for(Y=this._parts[y],w=0,W=Y.length,A=W-1;w<W;A=w++)if(!(!f&&w===0)&&wp(u,Y[A],Y[w])<=ne)return!0;return!1}});function gG(u,f){return new xa(u,f)}xa._flat=C;var xh=xa.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return fh(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var f=xa.prototype._convertLatLngs.call(this,u),y=f.length;return y>=2&&f[0]instanceof ge&&f[0].equals(f[y-1])&&f.pop(),f},_setLatLngs:function(u){xa.prototype._setLatLngs.call(this,u),g(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return g(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,f=this.options.weight,y=new q(f,f);if(u=new X(u.min.subtract(y),u.max.add(y)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var w=0,A=this._rings.length,B;w<A;w++)B=hh(this._rings[w],u,!0),B.length&&this._parts.push(B)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var f=!1,y,w,A,B,W,Y,ne,fe;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(B=0,ne=this._parts.length;B<ne;B++)for(y=this._parts[B],W=0,fe=y.length,Y=fe-1;W<fe;Y=W++)w=y[W],A=y[Y],w.y>u.y!=A.y>u.y&&u.x<(A.x-w.x)*(u.y-w.y)/(A.y-w.y)+w.x&&(f=!f);return f||xa.prototype._containsPoint.call(this,u,!0)}});function yG(u,f){return new xh(u,f)}var va=rr.extend({initialize:function(u,f){b(this,f),this._layers={},u&&this.addData(u)},addData:function(u){var f=S(u)?u:u.features,y,w,A;if(f){for(y=0,w=f.length;y<w;y++)A=f[y],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var B=this.options;if(B.filter&&!B.filter(u))return this;var W=Ux(u,B);return W?(W.feature=qx(u),W.defaultOptions=W.options,this.resetStyle(W),B.onEachFeature&&B.onEachFeature(u,W),this.addLayer(W)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=s({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(f){this._setLayerStyle(f,u)},this)},_setLayerStyle:function(u,f){u.setStyle&&(typeof f=="function"&&(f=f(u.feature)),u.setStyle(f))}});function Ux(u,f){var y=u.type==="Feature"?u.geometry:u,w=y?y.coordinates:null,A=[],B=f&&f.pointToLayer,W=f&&f.coordsToLatLng||q1,Y,ne,fe,Oe;if(!w&&!y)return null;switch(y.type){case"Point":return Y=W(w),eP(B,u,Y,f);case"MultiPoint":for(fe=0,Oe=w.length;fe<Oe;fe++)Y=W(w[fe]),A.push(eP(B,u,Y,f));return new rr(A);case"LineString":case"MultiLineString":return ne=Wx(w,y.type==="LineString"?0:1,W),new xa(ne,f);case"Polygon":case"MultiPolygon":return ne=Wx(w,y.type==="Polygon"?1:2,W),new xh(ne,f);case"GeometryCollection":for(fe=0,Oe=y.geometries.length;fe<Oe;fe++){var it=Ux({geometry:y.geometries[fe],type:"Feature",properties:u.properties},f);it&&A.push(it)}return new rr(A);case"FeatureCollection":for(fe=0,Oe=y.features.length;fe<Oe;fe++){var It=Ux(y.features[fe],f);It&&A.push(It)}return new rr(A);default:throw new Error("Invalid GeoJSON object.")}}function eP(u,f,y,w){return u?u(f,y):new Bx(y,w&&w.markersInheritOptions&&w)}function q1(u){return new ge(u[1],u[0],u[2])}function Wx(u,f,y){for(var w=[],A=0,B=u.length,W;A<B;A++)W=f?Wx(u[A],f-1,y):(y||q1)(u[A]),w.push(W);return w}function G1(u,f){return u=te(u),u.alt!==void 0?[p(u.lng,f),p(u.lat,f),p(u.alt,f)]:[p(u.lng,f),p(u.lat,f)]}function Hx(u,f,y,w){for(var A=[],B=0,W=u.length;B<W;B++)A.push(f?Hx(u[B],g(u[B])?0:f-1,y,w):G1(u[B],w));return!f&&y&&A.length>0&&A.push(A[0].slice()),A}function vh(u,f){return u.feature?s({},u.feature,{geometry:f}):qx(f)}function qx(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var K1={toGeoJSON:function(u){return vh(this,{type:"Point",coordinates:G1(this.getLatLng(),u)})}};Bx.include(K1),H1.include(K1),zx.include(K1),xa.include({toGeoJSON:function(u){var f=!g(this._latlngs),y=Hx(this._latlngs,f?1:0,!1,u);return vh(this,{type:(f?"Multi":"")+"LineString",coordinates:y})}}),xh.include({toGeoJSON:function(u){var f=!g(this._latlngs),y=f&&!g(this._latlngs[0]),w=Hx(this._latlngs,y?2:f?1:0,!0,u);return f||(w=[w]),vh(this,{type:(y?"Multi":"")+"Polygon",coordinates:w})}}),Dn.include({toMultiPoint:function(u){var f=[];return this.eachLayer(function(y){f.push(y.toGeoJSON(u).geometry.coordinates)}),vh(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(u){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(u);var y=f==="GeometryCollection",w=[];return this.eachLayer(function(A){if(A.toGeoJSON){var B=A.toGeoJSON(u);if(y)w.push(B.geometry);else{var W=qx(B);W.type==="FeatureCollection"?w.push.apply(w,W.features):w.push(W)}}}),y?vh(this,{geometries:w,type:"GeometryCollection"}):{type:"FeatureCollection",features:w}}});function tP(u,f){return new va(u,f)}var xG=tP,Gx=an.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,f,y){this._url=u,this._bounds=je(f),b(this,y)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){fn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&fa(this._image),this},bringToBack:function(){return this._map&&_l(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=je(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",f=this._image=u?this._url:Lt("img");if(yt(f,"leaflet-image-layer"),this._zoomAnimated&&yt(f,"leaflet-zoom-animated"),this.options.className&&yt(f,this.options.className),f.onselectstart=m,f.onmousemove=m,f.onload=o(this.fire,this,"load"),f.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(u){var f=this._map.getZoomScale(u.zoom),y=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;Eo(this._image,y,f)},_reset:function(){var u=this._image,f=new X(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),y=f.getSize();ut(u,f.min),u.style.width=y.x+"px",u.style.height=y.y+"px"},_updateOpacity:function(){Kn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),vG=function(u,f,y){return new Gx(u,f,y)},nP=Gx.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",f=this._image=u?this._url:Lt("video");if(yt(f,"leaflet-image-layer"),this._zoomAnimated&&yt(f,"leaflet-zoom-animated"),this.options.className&&yt(f,this.options.className),f.onselectstart=m,f.onmousemove=m,f.onloadeddata=o(this.fire,this,"load"),u){for(var y=f.getElementsByTagName("source"),w=[],A=0;A<y.length;A++)w.push(y[A].src);this._url=y.length>0?w:[f.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var B=0;B<this._url.length;B++){var W=Lt("source");W.src=this._url[B],f.appendChild(W)}}});function bG(u,f,y){return new nP(u,f,y)}var rP=Gx.extend({_initImage:function(){var u=this._image=this._url;yt(u,"leaflet-image-layer"),this._zoomAnimated&&yt(u,"leaflet-zoom-animated"),this.options.className&&yt(u,this.options.className),u.onselectstart=m,u.onmousemove=m}});function _G(u,f,y){return new rP(u,f,y)}var Co=an.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,f){u&&(u instanceof ge||S(u))?(this._latlng=te(u),b(this,f)):(b(this,u),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&Kn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&Kn(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(Kn(this._container,0),this._removeTimeout=setTimeout(o(fn,void 0,this._container),200)):fn(this._container),this.options.interactive&&(jn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=te(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fa(this._container),this},bringToBack:function(){return this._map&&_l(this._container),this},_prepareOpen:function(u){var f=this._source;if(!f._map)return!1;if(f instanceof rr){f=null;var y=this._source._layers;for(var w in y)if(y[w]._map){f=y[w];break}if(!f)return!1;this._source=f}if(!u)if(f.getCenter)u=f.getCenter();else if(f.getLatLng)u=f.getLatLng();else if(f.getBounds)u=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")u.innerHTML=f;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),f=H(this.options.offset),y=this._getAnchor();this._zoomAnimated?ut(this._container,u.add(y)):f=f.add(u).add(y);var w=this._containerBottom=-f.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=w+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});Rt.include({_initOverlay:function(u,f,y,w){var A=f;return A instanceof u||(A=new u(w).setContent(f)),y&&A.setLatLng(y),A}}),an.include({_initOverlay:function(u,f,y,w){var A=y;return A instanceof u?(b(A,w),A._source=this):(A=f&&!w?f:new u(w,this),A.setContent(y)),A}});var Kx=Co.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,Co.prototype.openOn.call(this,u)},onAdd:function(u){Co.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Tl||this._source.on("preclick",Ci))},onRemove:function(u){Co.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Tl||this._source.off("preclick",Ci))},getEvents:function(){var u=Co.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",f=this._container=Lt("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),y=this._wrapper=Lt("div",u+"-content-wrapper",f);if(this._contentNode=Lt("div",u+"-content",y),Nl(f),kl(this._contentNode),st(f,"contextmenu",Ci),this._tipContainer=Lt("div",u+"-tip-container",f),this._tip=Lt("div",u+"-tip",this._tipContainer),this.options.closeButton){var w=this._closeButton=Lt("a",u+"-close-button",f);w.setAttribute("role","button"),w.setAttribute("aria-label","Close popup"),w.href="#close",w.innerHTML='<span aria-hidden="true">&#215;</span>',st(w,"click",function(A){On(A),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,f=u.style;f.width="",f.whiteSpace="nowrap";var y=u.offsetWidth;y=Math.min(y,this.options.maxWidth),y=Math.max(y,this.options.minWidth),f.width=y+1+"px",f.whiteSpace="",f.height="";var w=u.offsetHeight,A=this.options.maxHeight,B="leaflet-popup-scrolled";A&&w>A?(f.height=A+"px",yt(u,B)):jn(u,B),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),y=this._getAnchor();ut(this._container,f.add(y))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,f=parseInt(bl(this._container,"marginBottom"),10)||0,y=this._container.offsetHeight+f,w=this._containerWidth,A=new q(this._containerLeft,-y-this._containerBottom);A._add(Ei(this._container));var B=u.layerPointToContainerPoint(A),W=H(this.options.autoPanPadding),Y=H(this.options.autoPanPaddingTopLeft||W),ne=H(this.options.autoPanPaddingBottomRight||W),fe=u.getSize(),Oe=0,it=0;B.x+w+ne.x>fe.x&&(Oe=B.x+w-fe.x+ne.x),B.x-Oe-Y.x<0&&(Oe=B.x-Y.x),B.y+y+ne.y>fe.y&&(it=B.y+y-fe.y+ne.y),B.y-it-Y.y<0&&(it=B.y-Y.y),(Oe||it)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([Oe,it]))}},_getAnchor:function(){return H(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),wG=function(u,f){return new Kx(u,f)};Rt.mergeOptions({closePopupOnClick:!0}),Rt.include({openPopup:function(u,f,y){return this._initOverlay(Kx,u,f,y).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),an.include({bindPopup:function(u,f){return this._popup=this._initOverlay(Kx,this._popup,u,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof rr||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){ei(u);var f=u.layer||u.target;if(this._popup._source===f&&!(f instanceof Tl)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=f,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var Qx=Co.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){Co.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){Co.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=Co.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",f=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Lt("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var f,y,w=this._map,A=this._container,B=w.latLngToContainerPoint(w.getCenter()),W=w.layerPointToContainerPoint(u),Y=this.options.direction,ne=A.offsetWidth,fe=A.offsetHeight,Oe=H(this.options.offset),it=this._getAnchor();Y==="top"?(f=ne/2,y=fe):Y==="bottom"?(f=ne/2,y=0):Y==="center"?(f=ne/2,y=fe/2):Y==="right"?(f=0,y=fe/2):Y==="left"?(f=ne,y=fe/2):W.x<B.x?(Y="right",f=0,y=fe/2):(Y="left",f=ne+(Oe.x+it.x)*2,y=fe/2),u=u.subtract(H(f,y,!0)).add(Oe).add(it),jn(A,"leaflet-tooltip-right"),jn(A,"leaflet-tooltip-left"),jn(A,"leaflet-tooltip-top"),jn(A,"leaflet-tooltip-bottom"),yt(A,"leaflet-tooltip-"+Y),ut(A,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&Kn(this._container,u)},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(f)},_getAnchor:function(){return H(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),kG=function(u,f){return new Qx(u,f)};Rt.include({openTooltip:function(u,f,y){return this._initOverlay(Qx,u,f,y).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),an.include({bindTooltip:function(u,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Qx,this._tooltip,u,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var f=u?"off":"on",y={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?y.add=this._openTooltip:(y.mouseover=this._openTooltip,y.mouseout=this.closeTooltip,y.click=this._openTooltip,this._map?this._addFocusListeners():y.add=this._addFocusListeners),this._tooltip.options.sticky&&(y.mousemove=this._moveTooltip),this[f](y),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof rr||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var f=typeof u.getElement=="function"&&u.getElement();f&&(st(f,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),st(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var f=typeof u.getElement=="function"&&u.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var f=u.latlng,y,w;this._tooltip.options.sticky&&u.originalEvent&&(y=this._map.mouseEventToContainerPoint(u.originalEvent),w=this._map.containerPointToLayerPoint(y),f=this._map.layerPointToLatLng(w)),this._tooltip.setLatLng(f)}});var sP=To.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var f=u&&u.tagName==="DIV"?u:document.createElement("div"),y=this.options;if(y.html instanceof Element?(hu(f),f.appendChild(y.html)):f.innerHTML=y.html!==!1?y.html:"",y.bgPos){var w=H(y.bgPos);f.style.backgroundPosition=-w.x+"px "+-w.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function NG(u){return new sP(u)}To.Default=Np;var Ep=an.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ze.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){b(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),fn(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fa(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(_l(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof q?u:new q(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var f=this.getPane().children,y=-u(-1/0,1/0),w=0,A=f.length,B;w<A;w++)B=f[w].style.zIndex,f[w]!==this._container&&B&&(y=u(y,+B));isFinite(y)&&(this.options.zIndex=y+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ze.ielt9){Kn(this._container,this.options.opacity);var u=+new Date,f=!1,y=!1;for(var w in this._tiles){var A=this._tiles[w];if(!(!A.current||!A.loaded)){var B=Math.min(1,(u-A.loaded)/200);Kn(A.el,B),B<1?f=!0:(A.active?y=!0:this._onOpaqueTile(A),A.active=!0)}}y&&!this._noPrune&&this._pruneTiles(),f&&(V(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=Lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,f=this.options.maxZoom;if(u!==void 0){for(var y in this._levels)y=Number(y),this._levels[y].el.children.length||y===u?(this._levels[y].el.style.zIndex=f-Math.abs(u-y),this._onUpdateLevel(y)):(fn(this._levels[y].el),this._removeTilesAtZoom(y),this._onRemoveLevel(y),delete this._levels[y]);var w=this._levels[u],A=this._map;return w||(w=this._levels[u]={},w.el=Lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),w.el.style.zIndex=f,w.origin=A.project(A.unproject(A.getPixelOrigin()),u).round(),w.zoom=u,this._setZoomTransform(w,A.getCenter(),A.getZoom()),m(w.el.offsetWidth),this._onCreateLevel(w)),this._level=w,w}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var u,f,y=this._map.getZoom();if(y>this.options.maxZoom||y<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)f=this._tiles[u],f.retain=f.current;for(u in this._tiles)if(f=this._tiles[u],f.current&&!f.active){var w=f.coords;this._retainParent(w.x,w.y,w.z,w.z-5)||this._retainChildren(w.x,w.y,w.z,w.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var f in this._tiles)this._tiles[f].coords.z===u&&this._removeTile(f)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)fn(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,f,y,w){var A=Math.floor(u/2),B=Math.floor(f/2),W=y-1,Y=new q(+A,+B);Y.z=+W;var ne=this._tileCoordsToKey(Y),fe=this._tiles[ne];return fe&&fe.active?(fe.retain=!0,!0):(fe&&fe.loaded&&(fe.retain=!0),W>w?this._retainParent(A,B,W,w):!1)},_retainChildren:function(u,f,y,w){for(var A=2*u;A<2*u+2;A++)for(var B=2*f;B<2*f+2;B++){var W=new q(A,B);W.z=y+1;var Y=this._tileCoordsToKey(W),ne=this._tiles[Y];if(ne&&ne.active){ne.retain=!0;continue}else ne&&ne.loaded&&(ne.retain=!0);y+1<w&&this._retainChildren(A,B,y+1,w)}},_resetView:function(u){var f=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var f=this.options;return f.minNativeZoom!==void 0&&u<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<u?f.maxNativeZoom:u},_setView:function(u,f,y,w){var A=Math.round(f);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var B=this.options.updateWhenZooming&&A!==this._tileZoom;(!w||B)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(u),y||this._pruneTiles(),this._noPrune=!!y),this._setZoomTransforms(u,f)},_setZoomTransforms:function(u,f){for(var y in this._levels)this._setZoomTransform(this._levels[y],u,f)},_setZoomTransform:function(u,f,y){var w=this._map.getZoomScale(y,u.zoom),A=u.origin.multiplyBy(w).subtract(this._map._getNewPixelOrigin(f,y)).round();Ze.any3d?Eo(u.el,A,w):ut(u.el,A)},_resetGrid:function(){var u=this._map,f=u.options.crs,y=this._tileSize=this.getTileSize(),w=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,f.wrapLng[0]],w).x/y.x),Math.ceil(u.project([0,f.wrapLng[1]],w).x/y.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([f.wrapLat[0],0],w).y/y.x),Math.ceil(u.project([f.wrapLat[1],0],w).y/y.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var f=this._map,y=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),w=f.getZoomScale(y,this._tileZoom),A=f.project(u,this._tileZoom).floor(),B=f.getSize().divideBy(w*2);return new X(A.subtract(B),A.add(B))},_update:function(u){var f=this._map;if(f){var y=this._clampZoom(f.getZoom());if(u===void 0&&(u=f.getCenter()),this._tileZoom!==void 0){var w=this._getTiledPixelBounds(u),A=this._pxBoundsToTileRange(w),B=A.getCenter(),W=[],Y=this.options.keepBuffer,ne=new X(A.getBottomLeft().subtract([Y,-Y]),A.getTopRight().add([Y,-Y]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var fe in this._tiles){var Oe=this._tiles[fe].coords;(Oe.z!==this._tileZoom||!ne.contains(new q(Oe.x,Oe.y)))&&(this._tiles[fe].current=!1)}if(Math.abs(y-this._tileZoom)>1){this._setView(u,y);return}for(var it=A.min.y;it<=A.max.y;it++)for(var It=A.min.x;It<=A.max.x;It++){var ws=new q(It,it);if(ws.z=this._tileZoom,!!this._isValidTile(ws)){var jr=this._tiles[this._tileCoordsToKey(ws)];jr?jr.current=!0:W.push(ws)}}if(W.sort(function(Ds,_h){return Ds.distanceTo(B)-_h.distanceTo(B)}),W.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ji=document.createDocumentFragment();for(It=0;It<W.length;It++)this._addTile(W[It],ji);this._level.el.appendChild(ji)}}}},_isValidTile:function(u){var f=this._map.options.crs;if(!f.infinite){var y=this._globalTileRange;if(!f.wrapLng&&(u.x<y.min.x||u.x>y.max.x)||!f.wrapLat&&(u.y<y.min.y||u.y>y.max.y))return!1}if(!this.options.bounds)return!0;var w=this._tileCoordsToBounds(u);return je(this.options.bounds).overlaps(w)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var f=this._map,y=this.getTileSize(),w=u.scaleBy(y),A=w.add(y),B=f.unproject(w,u.z),W=f.unproject(A,u.z);return[B,W]},_tileCoordsToBounds:function(u){var f=this._tileCoordsToNwSe(u),y=new ae(f[0],f[1]);return this.options.noWrap||(y=this._map.wrapLatLngBounds(y)),y},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var f=u.split(":"),y=new q(+f[0],+f[1]);return y.z=+f[2],y},_removeTile:function(u){var f=this._tiles[u];f&&(fn(f.el),delete this._tiles[u],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){yt(u,"leaflet-tile");var f=this.getTileSize();u.style.width=f.x+"px",u.style.height=f.y+"px",u.onselectstart=m,u.onmousemove=m,Ze.ielt9&&this.options.opacity<1&&Kn(u,this.options.opacity)},_addTile:function(u,f){var y=this._getTilePos(u),w=this._tileCoordsToKey(u),A=this.createTile(this._wrapCoords(u),o(this._tileReady,this,u));this._initTile(A),this.createTile.length<2&&F(o(this._tileReady,this,u,null,A)),ut(A,y),this._tiles[w]={el:A,coords:u,current:!0},f.appendChild(A),this.fire("tileloadstart",{tile:A,coords:u})},_tileReady:function(u,f,y){f&&this.fire("tileerror",{error:f,tile:y,coords:u});var w=this._tileCoordsToKey(u);y=this._tiles[w],y&&(y.loaded=+new Date,this._map._fadeAnimated?(Kn(y.el,0),V(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(y.active=!0,this._pruneTiles()),f||(yt(y.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:y.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ze.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var f=new q(this._wrapX?h(u.x,this._wrapX):u.x,this._wrapY?h(u.y,this._wrapY):u.y);return f.z=u.z,f},_pxBoundsToTileRange:function(u){var f=this.getTileSize();return new X(u.min.unscaleBy(f).floor(),u.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function EG(u){return new Ep(u)}var bh=Ep.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,f){this._url=u,f=b(this,f),f.detectRetina&&Ze.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,f){return this._url===u&&f===void 0&&(f=!0),this._url=u,f||this.redraw(),this},createTile:function(u,f){var y=document.createElement("img");return st(y,"load",o(this._tileOnLoad,this,f,y)),st(y,"error",o(this._tileOnError,this,f,y)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(y.referrerPolicy=this.options.referrerPolicy),y.alt="",y.src=this.getTileUrl(u),y},getTileUrl:function(u){var f={r:Ze.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var y=this._globalTileRange.max.y-u.y;this.options.tms&&(f.y=y),f["-y"]=y}return _(this._url,s(f,this.options))},_tileOnLoad:function(u,f){Ze.ielt9?setTimeout(o(u,this,null,f),0):u(null,f)},_tileOnError:function(u,f,y){var w=this.options.errorTileUrl;w&&f.getAttribute("src")!==w&&(f.src=w),u(y,f)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,f=this.options.maxZoom,y=this.options.zoomReverse,w=this.options.zoomOffset;return y&&(u=f-u),u+w},_getSubdomain:function(u){var f=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var u,f;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(f=this._tiles[u].el,f.onload=m,f.onerror=m,!f.complete)){f.src=P;var y=this._tiles[u].coords;fn(f),delete this._tiles[u],this.fire("tileabort",{tile:f,coords:y})}},_removeTile:function(u){var f=this._tiles[u];if(f)return f.el.setAttribute("src",P),Ep.prototype._removeTile.call(this,u)},_tileReady:function(u,f,y){if(!(!this._map||y&&y.getAttribute("src")===P))return Ep.prototype._tileReady.call(this,u,f,y)}});function iP(u,f){return new bh(u,f)}var oP=bh.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,f){this._url=u;var y=s({},this.defaultWmsParams);for(var w in f)w in this.options||(y[w]=f[w]);f=b(this,f);var A=f.detectRetina&&Ze.retina?2:1,B=this.getTileSize();y.width=B.x*A,y.height=B.y*A,this.wmsParams=y},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,bh.prototype.onAdd.call(this,u)},getTileUrl:function(u){var f=this._tileCoordsToNwSe(u),y=this._crs,w=oe(y.project(f[0]),y.project(f[1])),A=w.min,B=w.max,W=(this._wmsVersion>=1.3&&this._crs===ur?[A.y,A.x,B.y,B.x]:[A.x,A.y,B.x,B.y]).join(","),Y=bh.prototype.getTileUrl.call(this,u);return Y+E(this.wmsParams,Y,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+W},setParams:function(u,f){return s(this.wmsParams,u),f||this.redraw(),this}});function SG(u,f){return new oP(u,f)}bh.WMS=oP,iP.wms=SG;var ba=an.extend({options:{padding:.1},initialize:function(u){b(this,u),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,f){var y=this._map.getZoomScale(f,this._zoom),w=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,f),B=w.multiplyBy(-y).add(A).subtract(this._map._getNewPixelOrigin(u,f));Ze.any3d?Eo(this._container,B,y):ut(this._container,B)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,f=this._map.getSize(),y=this._map.containerPointToLayerPoint(f.multiplyBy(-u)).round();this._bounds=new X(y,y.add(f.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),aP=ba.extend({options:{tolerance:0},getEvents:function(){var u=ba.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ba.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");st(u,"mousemove",this._onMouseMove,this),st(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),st(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){V(this._redrawRequest),delete this._ctx,fn(this._container),on(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var f in this._layers)u=this._layers[f],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ba.prototype._update.call(this);var u=this._bounds,f=this._container,y=u.getSize(),w=Ze.retina?2:1;ut(f,u.min),f.width=w*y.x,f.height=w*y.y,f.style.width=y.x+"px",f.style.height=y.y+"px",Ze.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){ba.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[c(u)]=u;var f=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var f=u._order,y=f.next,w=f.prev;y?y.prev=w:this._drawLast=w,w?w.next=y:this._drawFirst=y,delete u._order,delete this._layers[c(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var f=u.options.dashArray.split(/[, ]+/),y=[],w,A;for(A=0;A<f.length;A++){if(w=Number(f[A]),isNaN(w))return;y.push(w)}u.options._dashArray=y}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var f=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new X,this._redrawBounds.extend(u._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(u._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var f=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,f=this._redrawBounds;if(this._ctx.save(),f){var y=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,y.x,y.y),this._ctx.clip()}this._drawing=!0;for(var w=this._drawFirst;w;w=w.next)u=w.layer,(!f||u._pxBounds&&u._pxBounds.intersects(f))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,f){if(this._drawing){var y,w,A,B,W=u._parts,Y=W.length,ne=this._ctx;if(Y){for(ne.beginPath(),y=0;y<Y;y++){for(w=0,A=W[y].length;w<A;w++)B=W[y][w],ne[w?"lineTo":"moveTo"](B.x,B.y);f&&ne.closePath()}this._fillStroke(ne,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var f=u._point,y=this._ctx,w=Math.max(Math.round(u._radius),1),A=(Math.max(Math.round(u._radiusY),1)||w)/w;A!==1&&(y.save(),y.scale(1,A)),y.beginPath(),y.arc(f.x,f.y/A,w,0,Math.PI*2,!1),A!==1&&y.restore(),this._fillStroke(y,u)}},_fillStroke:function(u,f){var y=f.options;y.fill&&(u.globalAlpha=y.fillOpacity,u.fillStyle=y.fillColor||y.color,u.fill(y.fillRule||"evenodd")),y.stroke&&y.weight!==0&&(u.setLineDash&&u.setLineDash(f.options&&f.options._dashArray||[]),u.globalAlpha=y.opacity,u.lineWidth=y.weight,u.strokeStyle=y.color,u.lineCap=y.lineCap,u.lineJoin=y.lineJoin,u.stroke())},_onClick:function(u){for(var f=this._map.mouseEventToLayerPoint(u),y,w,A=this._drawFirst;A;A=A.next)y=A.layer,y.options.interactive&&y._containsPoint(f)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(y))&&(w=y);this._fireEvent(w?[w]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,f)}},_handleMouseOut:function(u){var f=this._hoveredLayer;f&&(jn(this._container,"leaflet-interactive"),this._fireEvent([f],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,f){if(!this._mouseHoverThrottled){for(var y,w,A=this._drawFirst;A;A=A.next)y=A.layer,y.options.interactive&&y._containsPoint(f)&&(w=y);w!==this._hoveredLayer&&(this._handleMouseOut(u),w&&(yt(this._container,"leaflet-interactive"),this._fireEvent([w],u,"mouseover"),this._hoveredLayer=w)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,f,y){this._map._fireDOMEvent(f,y||f.type,u)},_bringToFront:function(u){var f=u._order;if(f){var y=f.next,w=f.prev;if(y)y.prev=w;else return;w?w.next=y:y&&(this._drawFirst=y),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(u)}},_bringToBack:function(u){var f=u._order;if(f){var y=f.next,w=f.prev;if(w)w.next=y;else return;y?y.prev=w:w&&(this._drawLast=w),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(u)}}});function lP(u){return Ze.canvas?new aP(u):null}var Sp=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),TG={_initContainer:function(){this._container=Lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ba.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var f=u._container=Sp("shape");yt(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",u._path=Sp("path"),f.appendChild(u._path),this._updateStyle(u),this._layers[c(u)]=u},_addPath:function(u){var f=u._container;this._container.appendChild(f),u.options.interactive&&u.addInteractiveTarget(f)},_removePath:function(u){var f=u._container;fn(f),u.removeInteractiveTarget(f),delete this._layers[c(u)]},_updateStyle:function(u){var f=u._stroke,y=u._fill,w=u.options,A=u._container;A.stroked=!!w.stroke,A.filled=!!w.fill,w.stroke?(f||(f=u._stroke=Sp("stroke")),A.appendChild(f),f.weight=w.weight+"px",f.color=w.color,f.opacity=w.opacity,w.dashArray?f.dashStyle=S(w.dashArray)?w.dashArray.join(" "):w.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=w.lineCap.replace("butt","flat"),f.joinstyle=w.lineJoin):f&&(A.removeChild(f),u._stroke=null),w.fill?(y||(y=u._fill=Sp("fill")),A.appendChild(y),y.color=w.fillColor||w.color,y.opacity=w.fillOpacity):y&&(A.removeChild(y),u._fill=null)},_updateCircle:function(u){var f=u._point.round(),y=Math.round(u._radius),w=Math.round(u._radiusY||y);this._setPath(u,u._empty()?"M0 0":"AL "+f.x+","+f.y+" "+y+","+w+" 0,"+65535*360)},_setPath:function(u,f){u._path.v=f},_bringToFront:function(u){fa(u._container)},_bringToBack:function(u){_l(u._container)}},Zx=Ze.vml?Sp:Ht,Tp=ba.extend({_initContainer:function(){this._container=Zx("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Zx("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){fn(this._container),on(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ba.prototype._update.call(this);var u=this._bounds,f=u.getSize(),y=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,y.setAttribute("width",f.x),y.setAttribute("height",f.y)),ut(y,u.min),y.setAttribute("viewBox",[u.min.x,u.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(u){var f=u._path=Zx("path");u.options.className&&yt(f,u.options.className),u.options.interactive&&yt(f,"leaflet-interactive"),this._updateStyle(u),this._layers[c(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){fn(u._path),u.removeInteractiveTarget(u._path),delete this._layers[c(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var f=u._path,y=u.options;f&&(y.stroke?(f.setAttribute("stroke",y.color),f.setAttribute("stroke-opacity",y.opacity),f.setAttribute("stroke-width",y.weight),f.setAttribute("stroke-linecap",y.lineCap),f.setAttribute("stroke-linejoin",y.lineJoin),y.dashArray?f.setAttribute("stroke-dasharray",y.dashArray):f.removeAttribute("stroke-dasharray"),y.dashOffset?f.setAttribute("stroke-dashoffset",y.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),y.fill?(f.setAttribute("fill",y.fillColor||y.color),f.setAttribute("fill-opacity",y.fillOpacity),f.setAttribute("fill-rule",y.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(u,f){this._setPath(u,vr(u._parts,f))},_updateCircle:function(u){var f=u._point,y=Math.max(Math.round(u._radius),1),w=Math.max(Math.round(u._radiusY),1)||y,A="a"+y+","+w+" 0 1,0 ",B=u._empty()?"M0 0":"M"+(f.x-y)+","+f.y+A+y*2+",0 "+A+-y*2+",0 ";this._setPath(u,B)},_setPath:function(u,f){u._path.setAttribute("d",f)},_bringToFront:function(u){fa(u._path)},_bringToBack:function(u){_l(u._path)}});Ze.vml&&Tp.include(TG);function cP(u){return Ze.svg||Ze.vml?new Tp(u):null}Rt.include({getRenderer:function(u){var f=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var f=this._paneRenderers[u];return f===void 0&&(f=this._createRenderer({pane:u}),this._paneRenderers[u]=f),f},_createRenderer:function(u){return this.options.preferCanvas&&lP(u)||cP(u)}});var uP=xh.extend({initialize:function(u,f){xh.prototype.initialize.call(this,this._boundsToLatLngs(u),f)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=je(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function CG(u,f){return new uP(u,f)}Tp.create=Zx,Tp.pointsToPath=vr,va.geometryToLayer=Ux,va.coordsToLatLng=q1,va.coordsToLatLngs=Wx,va.latLngToCoords=G1,va.latLngsToCoords=Hx,va.getFeature=vh,va.asFeature=qx,Rt.mergeOptions({boxZoom:!0});var dP=ti.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){on(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){fn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Yi(),up(),this._startPoint=this._map.mouseEventToContainerPoint(u),st(document,{contextmenu:ei,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=Lt("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var f=new X(this._point,this._startPoint),y=f.getSize();ut(this._box,f.min),this._box.style.width=y.x+"px",this._box.style.height=y.y+"px"},_finish:function(){this._moved&&(fn(this._box),jn(this._container,"leaflet-crosshair")),Xi(),dp(),on(document,{contextmenu:ei,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var f=new ae(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Rt.addInitHook("addHandler","boxZoom",dP),Rt.mergeOptions({doubleClickZoom:!0});var hP=ti.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var f=this._map,y=f.getZoom(),w=f.options.zoomDelta,A=u.originalEvent.shiftKey?y-w:y+w;f.options.doubleClickZoom==="center"?f.setZoom(A):f.setZoomAround(u.containerPoint,A)}});Rt.addInitHook("addHandler","doubleClickZoom",hP),Rt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var fP=ti.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new Ji(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){jn(this._map._container,"leaflet-grab"),jn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=je(this._map.options.maxBounds);this._offsetLimit=oe(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var f=this._lastTime=+new Date,y=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(y),this._times.push(f),this._prunePositions(f)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,f){return u-(u-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;u.x<f.min.x&&(u.x=this._viscousLimit(u.x,f.min.x)),u.y<f.min.y&&(u.y=this._viscousLimit(u.y,f.min.y)),u.x>f.max.x&&(u.x=this._viscousLimit(u.x,f.max.x)),u.y>f.max.y&&(u.y=this._viscousLimit(u.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,f=Math.round(u/2),y=this._initialWorldOffset,w=this._draggable._newPos.x,A=(w-f+y)%u+f-y,B=(w+f+y)%u-f-y,W=Math.abs(A+y)<Math.abs(B+y)?A:B;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=W},_onDragEnd:function(u){var f=this._map,y=f.options,w=!y.inertia||u.noInertia||this._times.length<2;if(f.fire("dragend",u),w)f.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),B=(this._lastTime-this._times[0])/1e3,W=y.easeLinearity,Y=A.multiplyBy(W/B),ne=Y.distanceTo([0,0]),fe=Math.min(y.inertiaMaxSpeed,ne),Oe=Y.multiplyBy(fe/ne),it=fe/(y.inertiaDeceleration*W),It=Oe.multiplyBy(-it/2).round();!It.x&&!It.y?f.fire("moveend"):(It=f._limitOffset(It,f.options.maxBounds),F(function(){f.panBy(It,{duration:it,easeLinearity:W,noMoveStart:!0,animate:!0})}))}}});Rt.addInitHook("addHandler","dragging",fP),Rt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var mP=ti.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),st(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),on(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,f=document.documentElement,y=u.scrollTop||f.scrollTop,w=u.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(w,y)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var f=this._panKeys={},y=this.keyCodes,w,A;for(w=0,A=y.left.length;w<A;w++)f[y.left[w]]=[-1*u,0];for(w=0,A=y.right.length;w<A;w++)f[y.right[w]]=[u,0];for(w=0,A=y.down.length;w<A;w++)f[y.down[w]]=[0,u];for(w=0,A=y.up.length;w<A;w++)f[y.up[w]]=[0,-1*u]},_setZoomDelta:function(u){var f=this._zoomKeys={},y=this.keyCodes,w,A;for(w=0,A=y.zoomIn.length;w<A;w++)f[y.zoomIn[w]]=u;for(w=0,A=y.zoomOut.length;w<A;w++)f[y.zoomOut[w]]=-u},_addHooks:function(){st(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){on(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var f=u.keyCode,y=this._map,w;if(f in this._panKeys){if(!y._panAnim||!y._panAnim._inProgress)if(w=this._panKeys[f],u.shiftKey&&(w=H(w).multiplyBy(3)),y.options.maxBounds&&(w=y._limitOffset(H(w),y.options.maxBounds)),y.options.worldCopyJump){var A=y.wrapLatLng(y.unproject(y.project(y.getCenter()).add(w)));y.panTo(A)}else y.panBy(w)}else if(f in this._zoomKeys)y.setZoom(y.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&y._popup&&y._popup.options.closeOnEscapeKey)y.closePopup();else return;ei(u)}}});Rt.addInitHook("addHandler","keyboard",mP),Rt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var pP=ti.extend({addHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){on(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var f=Lx(u),y=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var w=Math.max(y-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),w),ei(u)},_performZoom:function(){var u=this._map,f=u.getZoom(),y=this._map.options.zoomSnap||0;u._stop();var w=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(w))))/Math.LN2,B=y?Math.ceil(A/y)*y:A,W=u._limitZoom(f+(this._delta>0?B:-B))-f;this._delta=0,this._startTime=null,W&&(u.options.scrollWheelZoom==="center"?u.setZoom(f+W):u.setZoomAround(this._lastMousePos,f+W))}});Rt.addInitHook("addHandler","scrollWheelZoom",pP);var IG=600;Rt.mergeOptions({tapHold:Ze.touchNative&&Ze.safari&&Ze.mobile,tapTolerance:15});var gP=ti.extend({addHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){on(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var f=u.touches[0];this._startPos=this._newPos=new q(f.clientX,f.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(st(document,"touchend",On),st(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),IG),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){on(document,"touchend",On),on(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),on(document,"touchend touchcancel contextmenu",this._cancel,this),on(document,"touchmove",this._onMove,this)},_onMove:function(u){var f=u.touches[0];this._newPos=new q(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,f){var y=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});y._simulated=!0,f.target.dispatchEvent(y)}});Rt.addInitHook("addHandler","tapHold",gP),Rt.mergeOptions({touchZoom:Ze.touch,bounceAtZoomLimits:!0});var yP=ti.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){jn(this._map._container,"leaflet-touch-zoom"),on(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var f=this._map;if(!(!u.touches||u.touches.length!==2||f._animatingZoom||this._zooming)){var y=f.mouseEventToContainerPoint(u.touches[0]),w=f.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(y.add(w)._divideBy(2))),this._startDist=y.distanceTo(w),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),On(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var f=this._map,y=f.mouseEventToContainerPoint(u.touches[0]),w=f.mouseEventToContainerPoint(u.touches[1]),A=y.distanceTo(w)/this._startDist;if(this._zoom=f.getScaleZoom(A,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&A<1||this._zoom>f.getMaxZoom()&&A>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var B=y._add(w)._divideBy(2)._subtract(this._centerPoint);if(A===1&&B.x===0&&B.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(B),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),V(this._animRequest);var W=o(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(W,this,!0),On(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,V(this._animRequest),on(document,"touchmove",this._onTouchMove,this),on(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Rt.addInitHook("addHandler","touchZoom",yP),Rt.BoxZoom=dP,Rt.DoubleClickZoom=hP,Rt.Drag=fP,Rt.Keyboard=mP,Rt.ScrollWheelZoom=pP,Rt.TapHold=gP,Rt.TouchZoom=yP,n.Bounds=X,n.Browser=Ze,n.CRS=be,n.Canvas=aP,n.Circle=H1,n.CircleMarker=zx,n.Class=J,n.Control=Os,n.DivIcon=sP,n.DivOverlay=Co,n.DomEvent=Mx,n.DomUtil=Rx,n.Draggable=Ji,n.Evented=le,n.FeatureGroup=rr,n.GeoJSON=va,n.GridLayer=Ep,n.Handler=ti,n.Icon=To,n.ImageOverlay=Gx,n.LatLng=ge,n.LatLngBounds=ae,n.Layer=an,n.LayerGroup=Dn,n.LineUtil=z,n.Map=Rt,n.Marker=Bx,n.Mixin=fu,n.Path=Tl,n.Point=q,n.PolyUtil=ph,n.Polygon=xh,n.Polyline=xa,n.Popup=Kx,n.PosAnimation=xp,n.Projection=Ce,n.Rectangle=uP,n.Renderer=ba,n.SVG=Tp,n.SVGOverlay=rP,n.TileLayer=bh,n.Tooltip=Qx,n.Transformation=Be,n.Util=$,n.VideoOverlay=nP,n.bind=o,n.bounds=oe,n.canvas=lP,n.circle=pG,n.circleMarker=mG,n.control=_s,n.divIcon=NG,n.extend=s,n.featureGroup=yh,n.geoJSON=tP,n.geoJson=xG,n.gridLayer=EG,n.icon=hG,n.imageOverlay=vG,n.latLng=te,n.latLngBounds=je,n.layerGroup=Sl,n.map=ch,n.marker=fG,n.point=H,n.polygon=yG,n.polyline=gG,n.popup=wG,n.rectangle=CG,n.setOptions=b,n.stamp=c,n.svg=cP,n.svgOverlay=_G,n.tileLayer=iP,n.tooltip=kG,n.transformation=Ye,n.version=r,n.videoOverlay=bG;var jG=window.L;n.noConflict=function(){return window.L=jG,this},window.L=n})})(MC,MC.exports);var Xm=MC.exports;const Eq=UV(Xm);function R1(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function P1(t,e){return e==null?function(r,s){const i=N.useRef();return i.current||(i.current=t(r,s)),i}:function(r,s){const i=N.useRef();i.current||(i.current=t(r,s));const o=N.useRef(r),{instance:l}=i.current;return N.useEffect(function(){o.current!==r&&(e(l,r,o.current),o.current=r)},[l,r,s]),i}}function Sq(t,e){N.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var i;(i=e.layerContainer)==null||i.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function Tq(t){return function(n){const r=j1(),s=t(A1(n,r),r);return bq(r.map,n.attribution),FR(s.current,n.eventHandlers),Sq(s.current,r),s}}function mke(t,e){const n=N.useRef();N.useEffect(function(){if(e.pathOptions!==n.current){const s=e.pathOptions??{};t.instance.setStyle(s),n.current=s}},[t,e])}function pke(t){return function(n){const r=j1(),s=t(A1(n,r),r);return FR(s.current,n.eventHandlers),Sq(s.current,r),mke(s.current,n),s}}function gke(t,e){const n=P1(t,e),r=Tq(n);return Nq(r)}function yke(t,e){const n=P1(t),r=fke(n,e);return dke(r)}function xke(t,e){const n=P1(t,e),r=pke(n);return Nq(r)}function vke(t,e){const n=P1(t,e),r=Tq(n);return hke(r)}function bke(t,e,n){const{opacity:r,zIndex:s}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),s!=null&&s!==n.zIndex&&t.setZIndex(s)}function Cq(){return j1().map}const Ab=xke(function({center:e,children:n,...r},s){const i=new Xm.Circle(e,r);return R1(i,_q(s,{overlayContainer:i}))},lke);function OC(){return OC=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},OC.apply(this,arguments)}function _ke({bounds:t,boundsOptions:e,center:n,children:r,className:s,id:i,placeholder:o,style:l,whenReady:c,zoom:d,...h},m){const[p]=N.useState({className:s,id:i,style:l}),[v,x]=N.useState(null);N.useImperativeHandle(m,()=>(v==null?void 0:v.map)??null,[v]);const b=N.useCallback(k=>{if(k!==null&&v===null){const _=new Xm.Map(k,h);n!=null&&d!=null?_.setView(n,d):t!=null&&_.fitBounds(t,e),c!=null&&_.whenReady(c),x(uke(_))}},[]);N.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const E=v?He.createElement(kq,{value:v},r):o??null;return He.createElement("div",OC({},p,{ref:b}),E)}const Iq=N.forwardRef(_ke),wke=gke(function({position:e,...n},r){const s=new Xm.Marker(e,n);return R1(s,_q(r,{overlayContainer:s}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),kke=yke(function(e,n){const r=new Xm.Popup(e,n.overlayContainer);return R1(r,n)},function(e,n,{position:r},s){N.useEffect(function(){const{instance:o}=e;function l(d){d.popup===o&&(o.update(),s(!0))}function c(d){d.popup===o&&s(!1)}return n.map.on({popupopen:l,popupclose:c}),n.overlayContainer==null?(r!=null&&o.setLatLng(r),o.openOn(n.map)):n.overlayContainer.bindPopup(o),function(){var h;n.map.off({popupopen:l,popupclose:c}),(h=n.overlayContainer)==null||h.unbindPopup(),n.map.removeLayer(o)}},[e,n,s,r])}),jq=vke(function({url:e,...n},r){const s=new Xm.TileLayer(e,A1(n,r));return R1(s,r)},function(e,n,r){bke(e,n,r);const{url:s}=n;s!=null&&s!==r.url&&e.setUrl(s)}),L1=async t=>{if(!t||t.length<5)return null;try{const e=await fetch(`https://api.zippopotam.us/us/${t}`);if(!e.ok)return null;const r=(await e.json()).places[0];return{lat:parseFloat(r.latitude),lng:parseFloat(r.longitude),name:r["place name"],state:r["state abbreviation"],cityState:`${r["place name"]}, ${r["state abbreviation"]}`}}catch(e){return console.warn("Geocoding failed:",e),null}},Nke=async t=>{if(!t||t.length<3)return{count:0,density:"#6B7280",label:"Scanning..."};try{const e=t.substring(0,3),n=e+"",r=Re(Z,"artifacts",Ge,"public","data","profiles"),s=Et(r,nn("zip",">=",e),nn("zip","<=",n)),o=(await sj(s)).data().count;let l="#3D84ED",c="Quiet Area";return o>25&&(l="#10B981",c="Active Area"),o>100&&(l="#F59E0B",c="Buzzing"),o>500&&(l="#EF4444",c="Hotspot"),{count:o,density:l,label:c}}catch(e){return console.warn("Regional stats failed:",e),{count:0,density:"#9CA3AF",label:"Unknown Region"}}};function Aq({isEmbedded:t=!1}){const[e,n]=N.useState("tos"),r=[{id:"tos",label:"Terms of Service",icon:$c},{id:"privacy",label:"Privacy Policy",icon:tu},{id:"cookies",label:"Cookie Policy",icon:Rye},{id:"dmca",label:"DMCA & Copyright",icon:na}];return a.jsxs("div",{className:`flex flex-col md:flex-row bg-white dark:bg-[#1f2128] h-full ${t?"":"max-w-6xl mx-auto rounded-2xl shadow-xl border dark:border-gray-700 overflow-hidden my-8 min-h-[600px]"}`,children:[a.jsxs("div",{className:"w-full md:w-72 bg-gray-50 dark:bg-[#23262f] border-r dark:border-gray-700 flex flex-col shrink-0",children:[!t&&a.jsx("div",{className:"p-6 border-b dark:border-gray-700",children:a.jsxs("h2",{className:"text-2xl font-extrabold dark:text-white flex items-center gap-2",children:[a.jsx(na,{className:"text-brand-blue"})," Legal Center"]})}),a.jsx("div",{className:"p-4 space-y-1 overflow-y-auto flex-1",children:r.map(s=>a.jsxs("button",{onClick:()=>n(s.id),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all duration-200 group text-left
                            ${e===s.id?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm border border-gray-200 dark:border-gray-600":"text-gray-600 dark:text-gray-400 hover:bg-gray-200/50 dark:hover:bg-white/5"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(s.icon,{size:18,className:e===s.id?"text-brand-blue":"text-gray-400 group-hover:text-gray-500"}),a.jsx("span",{className:"font-bold text-sm",children:s.label})]}),e===s.id&&a.jsx(ea,{size:16,className:"text-brand-blue"})]},s.id))}),a.jsxs("div",{className:"p-6 bg-blue-50 dark:bg-blue-900/10 border-t border-blue-100 dark:border-blue-800/30",children:[a.jsxs("div",{className:"flex items-center gap-2 text-blue-700 dark:text-blue-400 font-bold text-xs mb-2",children:[a.jsx(dx,{size:14})," US Compliance Standard"]}),a.jsx("p",{className:"text-[10px] text-blue-600 dark:text-blue-300 leading-relaxed opacity-80",children:"Documents compliant with CCPA, DMCA, and federal payment regulations."})]})]}),a.jsx("div",{className:"flex-1 bg-white dark:bg-[#1f2128] relative overflow-hidden flex flex-col",children:a.jsx("div",{className:"flex-1 overflow-y-auto p-6 md:p-12 custom-scrollbar",children:a.jsxs("div",{className:"max-w-3xl mx-auto animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e==="tos"&&a.jsx(Eke,{}),e==="privacy"&&a.jsx(Ske,{}),e==="cookies"&&a.jsx(Tke,{}),e==="dmca"&&a.jsx(Cke,{}),a.jsx("div",{className:"mt-20 pt-8 border-t dark:border-gray-800",children:a.jsx("p",{className:"text-xs text-gray-400 text-center font-medium",children:"Last updated: November 29, 2025  SeshNx Legal Department"})})]})})})]})}const M1=({children:t})=>a.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-white mb-8 tracking-tight",children:t}),ii=({title:t,children:e})=>a.jsxs("div",{className:"mb-10",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:t}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300 leading-7 text-sm md:text-base space-y-4",children:e})]}),h0=({items:t})=>a.jsx("ul",{className:"space-y-2 mt-2",children:t.map((e,n)=>a.jsxs("li",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"mt-2 w-1.5 h-1.5 rounded-full bg-brand-blue shrink-0"}),a.jsx("span",{dangerouslySetInnerHTML:{__html:e}})]},n))}),Eke=()=>a.jsxs(a.Fragment,{children:[a.jsx(M1,{children:"Terms of Service"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"Welcome to SeshNx. By accessing or using our platform, you agree to be bound by these Terms of Service. Please read them carefully."}),a.jsx(ii,{title:"1. Platform Services",children:a.jsx("p",{children:'SeshNx provides a marketplace and collaboration tool for music professionals ("Creatives") and educational institutions ("Schools"). We facilitate bookings, payments, and content sharing but are not a party to the actual service contracts between users.'})}),a.jsx(ii,{title:"2. User Accounts",children:a.jsx("p",{children:"You are responsible for maintaining the confidentiality of your account credentials. You must be at least 13 years old to use SeshNx. Users under 18 require parental consent or School authorization to participate in educational programs."})}),a.jsxs(ii,{title:"3. Payments & Fees",children:[a.jsxs("p",{children:["Payments are processed securely via Stripe. By using our payment features, you agree to the ",a.jsx("a",{href:"https://stripe.com/connect-account/legal",target:"_blank",rel:"noreferrer",className:"text-brand-blue hover:underline font-bold",children:"Stripe Connected Account Agreement"}),"."]}),a.jsx("p",{children:"SeshNx charges a platform fee on transactions (ranging from 0% to 20% depending on your subscription tier), which is automatically deducted at the time of payout."})]}),a.jsx(ii,{title:"4. User Generated Content",children:a.jsx("p",{children:"You retain full ownership of the content you upload (audio, images, text). By uploading, you grant SeshNx a non-exclusive, worldwide license to display, transcode, and distribute your content strictly for the purpose of operating the service."})}),a.jsxs(ii,{title:"5. Prohibited Conduct",children:[a.jsx("p",{children:"You agree not to use SeshNx for:"}),a.jsx(h0,{items:["Harassment, hate speech, or bullying.","Distribution of malware or unauthorized automated scraping.","Fraudulent transactions or money laundering.","Copyright infringement or uploading content you do not own."]}),a.jsx("p",{className:"mt-2",children:"We reserve the right to suspend or ban accounts violating these rules without prior notice."})]})]}),Ske=()=>a.jsxs(a.Fragment,{children:[a.jsx(M1,{children:"Privacy Policy"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"Your privacy is critical to us. This policy explains how we collect, use, and share your data in compliance with US and international standards."}),a.jsx(ii,{title:"1. Information We Collect",children:a.jsx(h0,{items:["<strong>Account Data:</strong> Name, email, password (hashed), and profile bio.","<strong>Financial Data:</strong> Bank account and tax info (processed and stored securely via Stripe; SeshNx does not store full credit card numbers).","<strong>Usage Data:</strong> Location (for studio search), IP address, and browser type.","<strong>Content:</strong> Direct messages, audio files, and images you upload."]})}),a.jsx(ii,{title:"2. How We Use Information",children:a.jsx("p",{children:"We use your data to: provide and personalize services, process payments, verify student enrollment with partner schools, improve platform performance, and comply with legal obligations."})}),a.jsxs(ii,{title:"3. Data Sharing",children:[a.jsx("p",{children:"We do not sell your personal data. We only share data with:"}),a.jsx(h0,{items:["<strong>Service Providers:</strong> Google (Hosting/Auth), Stripe (Payments).","<strong>Educational Institutions:</strong> If you link a student account, your School Administrators can view your internship activity logs.","<strong>Legal Authorities:</strong> When required by valid legal process or subpoena."]})]}),a.jsx(ii,{title:"4. CCPA / California Rights",children:a.jsxs("p",{children:["California residents have the right to request access to or deletion of their personal data. Please contact ",a.jsx("strong",{children:"legal@seshnx.com"})," to exercise these rights."]})})]}),Tke=()=>a.jsxs(a.Fragment,{children:[a.jsx(M1,{children:"Cookie Policy"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"SeshNx uses cookies to enhance your experience. By using our site, you consent to our use of cookies."}),a.jsx(ii,{title:"Types of Cookies We Use",children:a.jsx(h0,{items:["<strong>Essential Cookies:</strong> Required for login authentication (e.g., Firebase Auth tokens). The site cannot function without these.","<strong>Functional Cookies:</strong> Remember your preferences, such as Dark Mode settings and Sidebar state.","<strong>Analytics Cookies:</strong> Help us understand how you use the site to improve features. These are aggregated and anonymous."]})}),a.jsx(ii,{title:"Managing Cookies",children:a.jsx("p",{children:"You can control or delete cookies through your browser settings. However, please note that disabling Essential Cookies will prevent you from logging in to SeshNx."})})]}),Cke=()=>a.jsxs(a.Fragment,{children:[a.jsx(M1,{children:"DMCA & Copyright"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"SeshNx respects the intellectual property rights of others and complies with the Digital Millennium Copyright Act (DMCA)."}),a.jsxs(ii,{title:"Reporting Infringement",children:[a.jsxs("p",{children:["If you believe your copyrighted work has been infringed on SeshNx, please send a notice to our Designated Agent at ",a.jsx("strong",{children:"legal@seshnx.com"})," including:"]}),a.jsx(h0,{items:["Identification of the copyrighted work claimed to have been infringed.","Identification of the infringing material (URL or Post ID).","Your contact information (Email, Phone).","A statement of good faith belief that the use is unauthorized.","A statement, under penalty of perjury, that the information is accurate and you are the copyright owner."]})]}),a.jsx(ii,{title:"Counter-Notices",children:a.jsx("p",{children:"If your content was removed by mistake, you may file a counter-notice. We may restore the content within 10-14 business days if the complainant does not file a court action against you."})})]}),Ike=["Student","Instructor","Intern","Admin"];function jke({lat:t,lng:e}){const n=Cq();return N.useEffect(()=>{n.setView([t,e],11)},[t,e,n]),null}function Ake({zip:t}){const[e,n]=N.useState({center:[34.0522,-118.2437],userCount:0,densityColor:"gray",locationName:"",regionLabel:"",isValid:!1,loading:!1});return N.useEffect(()=>{if(!t||t.length<5)return;const s=setTimeout(async()=>{n(o=>({...o,loading:!0}));const i=await L1(t);if(i){const{count:o,density:l,label:c}=await Nke(t);n({center:[i.lat,i.lng],userCount:o,densityColor:l,locationName:i.cityState,regionLabel:c,isValid:!0,loading:!1})}else n(o=>({...o,loading:!1}))},800);return()=>clearTimeout(s)},[t]),a.jsxs("div",{className:"w-full h-36 rounded-xl overflow-hidden relative border dark:border-gray-600 shadow-inner animate-in fade-in duration-500 bg-gray-100 dark:bg-[#1f2128]",children:[a.jsxs(Iq,{center:e.center,zoom:11,scrollWheelZoom:!1,zoomControl:!1,className:"h-full w-full",style:{background:"transparent"},children:[a.jsx(jq,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://carto.com/attributions">CARTO</a>'}),a.jsx(jke,{lat:e.center[0],lng:e.center[1]}),e.isValid&&a.jsxs(a.Fragment,{children:[a.jsx(Ab,{center:e.center,radius:8e3,pathOptions:{color:e.densityColor,fillColor:e.densityColor,fillOpacity:.05,stroke:!1}}),a.jsx(Ab,{center:e.center,radius:4e3,pathOptions:{color:e.densityColor,fillColor:e.densityColor,fillOpacity:.15,stroke:!1}}),a.jsx(Ab,{center:e.center,radius:400,pathOptions:{color:"white",fillColor:e.densityColor,fillOpacity:.9,weight:2}})]})]}),a.jsxs("div",{className:"absolute bottom-3 right-3 bg-white/95 dark:bg-black/85 backdrop-blur-md p-2.5 rounded-xl shadow-lg z-[400] border border-gray-100 dark:border-gray-700 flex flex-col items-end min-w-[120px]",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${e.loading?"animate-ping":""} shadow-sm`,style:{backgroundColor:e.isValid?e.densityColor:"gray"}}),a.jsx("div",{className:"text-xs font-extrabold text-gray-700 dark:text-gray-100 leading-none",children:e.loading?"Scanning...":e.isValid?`${e.userCount} Nearby`:"Enter Zip"})]}),e.isValid&&!e.loading&&a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 font-medium uppercase tracking-wider",children:e.regionLabel}),a.jsx("span",{className:"text-[9px] text-gray-400 font-normal truncate max-w-[140px]",children:e.locationName})]})]})]})}function J5({darkMode:t,toggleTheme:e,user:n,onSuccess:r}){const[s,i]=N.useState(1),[o,l]=N.useState("login"),[c,d]=N.useState(!1),[h,m]=N.useState({email:"",password:"",firstName:"",lastName:"",zip:"",roles:[]}),[p,v]=N.useState(""),[x,b]=N.useState(!1),[E,k]=N.useState("auto"),[_,S]=N.useState(!1),[T,P]=N.useState(!1),j=N.useRef(null),[R,I]=N.useState(!1),[O,D]=N.useState(""),[F,V]=N.useState([]),[$,J]=N.useState(null),[ue,ve]=N.useState(""),[le,q]=N.useState(""),[Q,H]=N.useState(""),[X,oe]=N.useState(null),[ae,je]=N.useState(null),ge=bw.filter(he=>!Ike.includes(he)),te=()=>o==="signup"?"Create your Account":o==="forgot"?"Password Recovery":o==="onboarding"?"Finalize Setup":null;N.useEffect(()=>{if(n){l("onboarding"),i(1);const he=n.displayName?n.displayName.split(" "):["User",""];m(U=>({...U,email:n.email,firstName:he[0]||"",lastName:he.slice(1).join(" ")||""})),d(!1)}else l("login"),i(1),m({email:"",password:"",firstName:"",lastName:"",zip:"",roles:[]})},[n]);const[be,Fe]=N.useState({hasUpper:!1,hasLower:!1,hasNumber:!1,isLength:!1});N.useEffect(()=>{const he=h.password;Fe({hasUpper:/[A-Z]/.test(he),hasLower:/[a-z]/.test(he),hasNumber:/[0-9]/.test(he),isLength:he.length>=6})},[h.password]);const vt=Object.values(be).every(Boolean);N.useEffect(()=>{if(!j.current)return;const he=new ResizeObserver(()=>{if(j.current){const U=j.current.scrollHeight+80;U>200&&k(`${U}px`)}});return he.observe(j.current),()=>he.disconnect()},[s,o,p,x,h.zip,R,F,X]),N.useEffect(()=>{v("")},[s]);const ce=async()=>{if(!h.email||!h.password)return v("Please fill in all fields.");d(!0);try{await HX(sf,h.email,h.password)}catch{v("Invalid email or password."),d(!1)}},Be=async()=>{v(""),d(!0);try{const he=new tI;he.setCustomParameters({prompt:"select_account"}),await yJ(sf,he)}catch(he){console.error("Google Sign-In Error:",he),v(he.message),d(!1)}},Ye=async()=>{if(o==="signup"&&!vt)return v("Password requirements not met.");d(!0);try{let he;o==="onboarding"&&n?he=n.uid:he=(await WX(sf,h.email,h.password)).user.uid;let U=h.roles.length>0?h.roles:["Fan"];if(ae&&!U.includes("Student")&&U.push("Student"),ae){await _o(ae.ref);const re=ae.data();await ec(Se(Z,`schools/${$.id}/students`,he),{...re,uid:he,email:h.email,status:"Active"})}const G={firstName:h.firstName,lastName:h.lastName,zip:h.zip,accountTypes:U,activeProfileRole:U[0],schoolId:($==null?void 0:$.id)||null,studentId:ue||null,createdAt:zt(),email:h.email,photoURL:(n==null?void 0:n.photoURL)||null};await Promise.all([ec(Se(Z,Ve(he).userProfile),G,{merge:!0}),ec(Se(Z,Ve(he).userPublicProfile),{...G,uid:he,searchTerms:[h.firstName.toLowerCase(),h.lastName.toLowerCase(),h.zip,...U.map(re=>re.toLowerCase())]},{merge:!0}),ec(Se(Z,Ve(he).userWallet),{balance:0,createdAt:zt()},{merge:!0})]),r&&r()}catch(he){v(he.message.replace("Firebase: ","").replace("auth/","")),d(!1)}},pe=async()=>{if(!h.email)return v("Enter email address.");d(!0);try{await UX(sf,h.email),b(!0),v("")}catch(he){v(he.message)}d(!1)},bt=()=>{if(!navigator.geolocation)return v("Geolocation not supported.");S(!0),navigator.geolocation.getCurrentPosition(async he=>{try{const G=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${he.coords.latitude}&lon=${he.coords.longitude}`)).json();G.address.postcode?m(re=>({...re,zip:G.address.postcode.split("-")[0]})):v("Could not determine Zip Code.")}catch{v("Failed to find location.")}S(!1)},()=>{v("Location permission denied."),S(!1)})};N.useEffect(()=>{if(O.length<2){V([]);return}const he=setTimeout(async()=>{const U=Et(Re(Z,"schools"),nn("name",">=",O),nn("name","<=",O+"")),G=await Kt(U);V(G.docs.map(re=>({id:re.id,...re.data()})))},300);return()=>clearTimeout(he)},[O]);const Ht=async()=>{if(!$||!ue||!le)return v("All fields required.");d(!0);try{const he=Et(Re(Z,`schools/${$.id}/students`),nn("studentId","==",ue)),U=await Kt(he);if(U.empty){v("Student ID not found in this school's roster."),d(!1);return}const G=U.docs[0].data();if(G.email.toLowerCase()!==le.toLowerCase()){v("Email provided does not match the student record."),d(!1);return}m(Ae=>({...Ae,firstName:G.firstName||G.displayName.split(" ")[0],lastName:G.lastName||G.displayName.split(" ").slice(1).join(" ")}));const re=Math.floor(1e5+Math.random()*9e5).toString();console.log("MOCK AUTH CODE SENT:",re),oe(re),je(U.docs[0]),alert(`Code sent to ${le}. (Dev: ${re})`),d(!1)}catch(he){console.error(he),v("Verification failed."),d(!1)}},vr=()=>{Q===X?(m(he=>({...he,roles:[...he.roles,"Student"]})),i(5)):v("Invalid authorization code.")},nr=(he,U)=>{he.key==="Enter"&&U()},at=({met:he,text:U})=>a.jsxs("div",{className:`flex items-center gap-1.5 text-xs transition-colors ${he?"text-green-600 dark:text-green-400":"text-gray-400 dark:text-gray-500"}`,children:[he?a.jsx(Bi,{size:12,strokeWidth:3}):a.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300 dark:border-gray-600"}),U]});return a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200 p-4 dark:from-gray-900 dark:to-black transition-colors duration-500 relative",children:[a.jsx("div",{className:"absolute top-6 right-6 z-20",children:a.jsx("button",{onClick:e,className:"p-3 rounded-full bg-white/80 dark:bg-black/50 backdrop-blur-md border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:scale-110 transition-transform shadow-sm",children:t?a.jsx(NW,{size:20}):a.jsx(JA,{size:20})})}),a.jsx("div",{className:"bg-white dark:bg-dark-card dark:border dark:border-gray-700 rounded-3xl shadow-2xl w-full max-w-md relative overflow-hidden transition-[height] duration-500 z-10",style:{height:E,minHeight:"500px"},children:a.jsxs("div",{ref:j,className:"pt-12 px-8 pb-8",children:[a.jsxs("div",{className:"relative w-full h-48 mb-6 flex justify-center shrink-0",children:[a.jsx("div",{className:`absolute transition-all duration-500 ease-[cubic-bezier(0.34,1.56,0.64,1)] ${o==="signup"||o==="onboarding"?"top-0 scale-90":"top-8 scale-100"} z-0`,children:a.jsx("div",{className:`w-96 h-40 ${o==="signup"||o==="onboarding"?"":"animate-float"}`,children:a.jsx("img",{src:t?lq:cq,alt:"SeshNx",className:"w-full h-full object-contain drop-shadow-md"})})}),a.jsx("div",{className:"absolute bottom-2 w-full text-center z-10 pointer-events-none",children:te()&&a.jsx("p",{className:"text-sm font-bold text-gray-500 dark:text-gray-300 uppercase tracking-wider animate-pulse transition-opacity duration-300",children:te()})})]}),p&&a.jsxs("div",{className:"absolute top-4 left-0 right-0 mx-8 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-300 p-3 rounded-xl text-sm flex items-center gap-2 animate-in fade-in slide-in-from-top-2 z-30 border border-red-100 dark:border-red-800/30",children:[a.jsx(pl,{size:16}),a.jsx("span",{className:"capitalize font-medium",children:p})]}),x&&a.jsxs("div",{className:"absolute top-4 left-0 right-0 mx-8 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-300 p-3 rounded-xl text-sm flex items-center gap-2 animate-in fade-in slide-in-from-top-2 z-30 border border-green-100 dark:border-green-800/30",children:[a.jsx(Bi,{size:16}),a.jsx("span",{children:"Check your email."})]}),a.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4 duration-500 fill-mode-forwards",children:[o==="login"&&a.jsxs("div",{className:"space-y-4 w-full",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",placeholder:"Email Address",type:"email",value:h.email,onChange:he=>m({...h,email:he.target.value}),onKeyDown:he=>nr(he,ce),disabled:c}),a.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",type:"password",placeholder:"Password",value:h.password,onChange:he=>m({...h,password:he.target.value}),onKeyDown:he=>nr(he,ce),disabled:c})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>l("forgot"),className:"text-xs text-gray-500 hover:text-brand-blue font-medium transition-colors",children:"Forgot Password?"})}),a.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all shadow-lg flex justify-center disabled:opacity-70",onClick:ce,disabled:c,children:c?a.jsx(rt,{className:"animate-spin"}):"Sign In"}),a.jsxs("button",{onClick:Be,className:"w-full bg-white dark:bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-white py-3.5 rounded-xl font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-all flex justify-center items-center gap-2",disabled:c,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),a.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),a.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),a.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),a.jsxs("div",{className:"relative py-2",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white dark:bg-dark-card text-gray-500",children:"or"})})]}),a.jsx("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 cursor-pointer hover:text-brand-blue font-medium transition-colors pt-2",onClick:()=>l("signup"),children:"New here? Create an Account"})]}),o==="forgot"&&a.jsxs("div",{className:"space-y-4 w-full",children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center mb-2",children:"Enter your email to receive reset instructions."}),a.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",placeholder:"Email Address",type:"email",value:h.email,onChange:he=>m({...h,email:he.target.value}),onKeyDown:he=>nr(he,pe),disabled:c||x}),a.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all flex justify-center items-center gap-2 disabled:opacity-50",onClick:pe,disabled:c||x,children:c?a.jsx(rt,{className:"animate-spin"}):x?"Sent!":"Send Reset Link"}),a.jsx("button",{className:"w-full text-gray-500 text-sm hover:text-gray-800 dark:hover:text-gray-200 mt-2",onClick:()=>l("login"),children:"Back to Login"})]}),(o==="signup"||o==="onboarding")&&a.jsxs("div",{className:"w-full",children:[s===1&&a.jsx("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-8 duration-500",children:o==="signup"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{className:"w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all",placeholder:"Email Address",type:"email",value:h.email,onChange:he=>m({...h,email:he.target.value}),disabled:c}),a.jsx("input",{className:`w-full p-3.5 bg-gray-50 dark:bg-[#1f2128] border ${!vt&&h.password?"border-red-300 focus:ring-red-200":"border-gray-200 dark:border-gray-600 focus:ring-brand-blue"} rounded-xl focus:ring-2 outline-none dark:text-white transition-all`,type:"password",placeholder:"Create Password",value:h.password,onChange:he=>m({...h,password:he.target.value}),disabled:c})]}),a.jsx("div",{className:"pt-2",children:a.jsxs("div",{className:"grid grid-cols-2 gap-2 pl-1",children:[a.jsx(at,{met:be.hasUpper,text:"Uppercase Letter"}),a.jsx(at,{met:be.hasLower,text:"Lowercase Letter"}),a.jsx(at,{met:be.hasNumber,text:"Number (0-9)"}),a.jsx(at,{met:be.isLength,text:"6+ Characters"})]})}),a.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all shadow-lg flex justify-center disabled:opacity-50",onClick:()=>{if(!h.email)return v("Email required");if(!vt)return v("Fix password issues");i(2)},disabled:c||!vt||!h.email,children:"Continue"}),a.jsxs("button",{onClick:Be,className:"w-full bg-white dark:bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-white py-3.5 rounded-xl font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-all flex justify-center items-center gap-2",disabled:c,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),a.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),a.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),a.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),a.jsxs("div",{className:"relative py-2",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white dark:bg-dark-card text-gray-500",children:"or"})})]}),a.jsx("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 cursor-pointer hover:text-brand-blue font-medium transition-colors pt-2",onClick:()=>l("login"),children:"Already have an account? Log In"})]}):a.jsxs("div",{className:"space-y-6 text-center",children:[a.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-gray-100 dark:bg-gray-800 p-1 border-2 border-brand-blue shadow-lg overflow-hidden",children:n!=null&&n.photoURL?a.jsx("img",{src:n.photoURL,alt:"Profile",className:"w-full h-full object-cover rounded-full"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-brand-blue",children:a.jsx(Jr,{size:40})})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-2xl font-bold dark:text-white",children:["Welcome, ",h.firstName,"!"]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Let's finish setting up your creative profile."})]}),a.jsx("button",{className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 transition-all shadow-lg flex justify-center",onClick:()=>i(2),children:"Let's Go"})]})}),s===2&&a.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-8 duration-500",children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{className:"w-1/2 p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white",placeholder:"First Name",value:h.firstName,onChange:he=>m({...h,firstName:he.target.value}),autoFocus:!0}),a.jsx("input",{className:"w-1/2 p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white",placeholder:"Last Name",value:h.lastName,onChange:he=>m({...h,lastName:he.target.value})})]}),a.jsxs("div",{className:"relative flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx("input",{className:"w-full p-3.5 pl-10 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-brand-blue outline-none dark:text-white",placeholder:"Zip Code",maxLength:5,value:h.zip,onChange:he=>m({...h,zip:he.target.value.replace(/\D/g,"")})}),a.jsx(Br,{className:"absolute left-3 top-3.5 text-gray-400",size:18})]}),a.jsx("button",{onClick:bt,className:"p-3.5 bg-gray-50 dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 text-brand-blue transition-colors",children:_?a.jsx(rt,{size:20,className:"animate-spin"}):a.jsx(hW,{size:20})})]}),a.jsx(Ake,{zip:h.zip}),a.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-3 rounded-xl border dark:border-gray-700 flex items-center gap-3 cursor-pointer transition-colors hover:bg-gray-100 dark:hover:bg-[#2a2d36]",onClick:()=>I(!R),children:[a.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${R?"bg-brand-blue border-brand-blue":"border-gray-400"}`,children:R&&a.jsx(Bi,{size:12,className:"text-white",strokeWidth:3})}),a.jsx("span",{className:"text-sm font-bold dark:text-white flex-1",children:"Are you a student?"}),a.jsx(Bc,{size:18,className:R?"text-brand-blue":"text-gray-400"})]}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsxs("button",{className:`text-gray-500 flex items-center gap-1 text-sm font-medium ${o==="onboarding"?"opacity-0 pointer-events-none":""}`,onClick:()=>i(1),children:[a.jsx(x1,{size:16})," Back"]}),a.jsx("button",{className:"bg-gray-900 dark:bg-white dark:text-black text-white px-6 py-2.5 rounded-xl font-bold transition-transform active:scale-95",onClick:()=>{h.firstName&&h.zip?i(R?3:5):v("Info required")},children:"Next Step"})]})]}),s===3&&a.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-8 duration-500",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold dark:text-white text-lg mb-2",children:"Find your School"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Search for your institution to link your enrollment."})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{className:"absolute left-3 top-3 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none",placeholder:"Search School Name...",value:O,onChange:he=>D(he.target.value),autoFocus:!0}),F.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-xl max-h-48 overflow-y-auto p-1",children:F.map(he=>a.jsxs("div",{onClick:()=>{J(he),i(4)},className:"p-3 hover:bg-gray-50 dark:hover:bg-white/10 cursor-pointer rounded-lg flex items-center gap-3 transition",children:[a.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-gray-700 rounded flex items-center justify-center text-gray-500",children:a.jsx(Bc,{size:16})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold dark:text-white text-sm",children:he.name}),a.jsx("div",{className:"text-xs text-gray-500",children:he.city||"Location N/A"})]})]},he.id))})]}),a.jsx("button",{className:"w-full text-gray-400 text-sm hover:text-gray-600",onClick:()=>i(2),children:"Back"})]}),s===4&&$&&a.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-8 duration-500",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h4",{className:"font-bold dark:text-white text-lg",children:$.name}),a.jsx("p",{className:"text-xs text-gray-500",children:"Verify your enrollment"})]}),X?a.jsxs("div",{className:"space-y-4 text-center animate-in fade-in",children:[a.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg border border-green-100 dark:border-green-800",children:a.jsxs("p",{className:"text-xs text-green-700 dark:text-green-400",children:["Code sent to ",le]})}),a.jsxs("div",{className:"relative",children:[a.jsx(s0,{className:"absolute left-3 top-3 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white text-center font-mono tracking-widest text-lg",placeholder:"000000",maxLength:6,value:Q,onChange:he=>H(he.target.value)})]}),a.jsx("button",{onClick:vr,className:"w-full bg-green-600 text-white py-3 rounded-xl font-bold hover:bg-green-700 transition",children:"Confirm Code"})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Jr,{className:"absolute left-3 top-3 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Student ID Number",value:ue,onChange:he=>ve(he.target.value)})]}),a.jsxs("div",{className:"relative",children:[a.jsx(i0,{className:"absolute left-3 top-3 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"School Email Address",value:le,onChange:he=>q(he.target.value)})]}),a.jsx("button",{onClick:Ht,disabled:c,className:"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 transition",children:c?"Verifying...":"Verify & Send Code"})]}),a.jsx("button",{className:"w-full text-gray-400 text-sm hover:text-gray-600",onClick:()=>i(3),children:"Change School"})]}),s===5&&a.jsxs("div",{className:"space-y-5 animate-in fade-in slide-in-from-right-8 duration-500",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h4",{className:"font-bold dark:text-white",children:"Select Additional Roles"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"You can change these later."})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2.5 h-auto",children:ge.map(he=>a.jsxs("div",{onClick:()=>{const U=h.roles.includes(he)?h.roles.filter(G=>G!==he):[...h.roles,he];m({...h,roles:U})},className:`relative p-3 border-2 rounded-xl cursor-pointer text-sm font-bold text-center transition-colors duration-200 select-none ${h.roles.includes(he)?"bg-blue-50 border-brand-blue text-brand-blue dark:bg-blue-900/20 dark:border-blue-500 dark:text-blue-300 shadow-sm":"bg-white border-gray-100 text-gray-500 hover:border-gray-300 dark:bg-[#1f2128] dark:border-gray-700 dark:text-gray-400"}`,children:[he,h.roles.includes(he)&&a.jsx("div",{className:"absolute top-1 right-1 text-brand-blue",children:a.jsx(Bi,{size:10,strokeWidth:4})})]},he))}),a.jsxs("p",{className:"text-[10px] text-gray-400 text-center px-4 leading-tight",children:["By completing setup, you agree to our ",a.jsx("button",{onClick:()=>P(!0),className:"underline hover:text-brand-blue mx-1",children:"Terms of Service"})," and ",a.jsx("button",{onClick:()=>P(!0),className:"underline hover:text-brand-blue mx-1",children:"Privacy Policy"}),"."]}),a.jsx("button",{className:"w-full bg-green-600 text-white py-3.5 rounded-xl font-bold mt-2 hover:bg-green-700 transition-colors flex justify-center items-center gap-2 disabled:opacity-50",onClick:Ye,disabled:c,children:c?a.jsx(rt,{className:"animate-spin"}):"Complete Setup"}),a.jsx("button",{className:"w-full text-gray-400 text-xs hover:text-gray-600 transition-colors",onClick:()=>i(2),children:"Back to Personal Info"})]})]})]},o)]})}),a.jsx("div",{className:"absolute bottom-6 z-20",children:a.jsxs("button",{onClick:()=>P(!0),className:"text-xs text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 transition-colors flex items-center gap-2 opacity-80 hover:opacity-100 backdrop-blur-sm px-3 py-1.5 rounded-full",children:[a.jsx(dw,{size:14})," Legal Center & Terms"]})}),T&&a.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:a.jsxs("div",{className:"bg-white dark:bg-[#1f2128] w-full max-w-5xl h-[85vh] rounded-2xl shadow-2xl overflow-hidden flex flex-col border border-gray-200 dark:border-gray-700 relative animate-in slide-in-from-bottom-4",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] shrink-0",children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white flex items-center gap-2",children:[a.jsx(dw,{size:20,className:"text-brand-blue"})," Legal Center"]}),a.jsx("button",{onClick:()=>P(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:a.jsx(_t,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto relative",children:a.jsx(Aq,{isEmbedded:!0})})]})})]})}function Es(t,e,n,r){return new(n||(n=Promise))(function(s,i){function o(d){try{c(r.next(d))}catch(h){i(h)}}function l(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){var h;d.done?s(d.value):(h=d.value,h instanceof n?h:new n(function(m){m(h)})).then(o,l)}c((r=r.apply(t,e||[])).next())})}class bx{constructor(){this.listeners={}}on(e,n,r){if(this.listeners[e]||(this.listeners[e]=new Set),r==null?void 0:r.once){const s=(...i)=>{this.un(e,s),n(...i)};return this.listeners[e].add(s),()=>this.un(e,s)}return this.listeners[e].add(n),()=>this.un(e,n)}un(e,n){var r;(r=this.listeners[e])===null||r===void 0||r.delete(n)}once(e,n){return this.on(e,n,{once:!0})}unAll(){this.listeners={}}emit(e,...n){this.listeners[e]&&this.listeners[e].forEach(r=>r(...n))}}const Bv={decode:function(t,e){return Es(this,void 0,void 0,function*(){const n=new AudioContext({sampleRate:e});try{return yield n.decodeAudioData(t)}finally{n.close()}})},createBuffer:function(t,e){if(!t||t.length===0)throw new Error("channelData must be a non-empty array");if(e<=0)throw new Error("duration must be greater than 0");if(typeof t[0]=="number"&&(t=[t]),!t[0]||t[0].length===0)throw new Error("channelData must contain non-empty channel arrays");(function(r){const s=r[0];if(s.some(i=>i>1||i<-1)){const i=s.length;let o=0;for(let l=0;l<i;l++){const c=Math.abs(s[l]);c>o&&(o=c)}for(const l of r)for(let c=0;c<i;c++)l[c]/=o}})(t);const n=t.map(r=>r instanceof Float32Array?r:Float32Array.from(r));return{duration:e,length:n[0].length,sampleRate:n[0].length/e,numberOfChannels:n.length,getChannelData:r=>{const s=n[r];if(!s)throw new Error(`Channel ${r} not found`);return s},copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Rq(t,e){const n=e.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);for(const[r,s]of Object.entries(e))if(r==="children"&&s)for(const[i,o]of Object.entries(s))o instanceof Node?n.appendChild(o):typeof o=="string"?n.appendChild(document.createTextNode(o)):n.appendChild(Rq(i,o));else r==="style"?Object.assign(n.style,s):r==="textContent"?n.textContent=s:n.setAttribute(r,s.toString());return n}function eV(t,e,n){const r=Rq(t,e||{});return n==null||n.appendChild(r),r}var Rke=Object.freeze({__proto__:null,createElement:eV,default:eV});const Pke={fetchBlob:function(t,e,n){return Es(this,void 0,void 0,function*(){const r=yield fetch(t,n);if(r.status>=400)throw new Error(`Failed to fetch ${t}: ${r.status} (${r.statusText})`);return function(s,i){Es(this,void 0,void 0,function*(){if(!s.body||!s.headers)return;const o=s.body.getReader(),l=Number(s.headers.get("Content-Length"))||0;let c=0;const d=h=>{c+=(h==null?void 0:h.length)||0;const m=Math.round(c/l*100);i(m)};try{for(;;){const h=yield o.read();if(h.done)break;d(h.value)}}catch(h){console.warn("Progress tracking error:",h)}})}(r.clone(),e),r.blob()})}};function or(t){let e=t;const n=new Set;return{get value(){return e},set(r){Object.is(e,r)||(e=r,n.forEach(s=>s(e)))},update(r){this.set(r(e))},subscribe:r=>(n.add(r),()=>n.delete(r))}}function ju(t,e){const n=or(t());return e.forEach(r=>r.subscribe(()=>{const s=t();Object.is(n.value,s)||n.set(s)})),{get value(){return n.value},subscribe:r=>n.subscribe(r)}}function Fl(t,e){let n;const r=()=>{n&&(n(),n=void 0),n=t()},s=e.map(i=>i.subscribe(r));return r(),()=>{n&&(n(),n=void 0),s.forEach(i=>i())}}class Lke extends bx{get isPlayingSignal(){return this._isPlaying}get currentTimeSignal(){return this._currentTime}get durationSignal(){return this._duration}get volumeSignal(){return this._volume}get mutedSignal(){return this._muted}get playbackRateSignal(){return this._playbackRate}get seekingSignal(){return this._seeking}constructor(e){super(),this.isExternalMedia=!1,this.reactiveMediaEventCleanups=[],e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),this._isPlaying=or(!1),this._currentTime=or(0),this._duration=or(0),this._volume=or(this.media.volume),this._muted=or(this.media.muted),this._playbackRate=or(this.media.playbackRate||1),this._seeking=or(!1),this.setupReactiveMediaEvents(),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}setupReactiveMediaEvents(){this.reactiveMediaEventCleanups.push(this.onMediaEvent("play",()=>{this._isPlaying.set(!0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("pause",()=>{this._isPlaying.set(!1)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("ended",()=>{this._isPlaying.set(!1)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("timeupdate",()=>{this._currentTime.set(this.media.currentTime)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("durationchange",()=>{this._duration.set(this.media.duration||0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("loadedmetadata",()=>{this._duration.set(this.media.duration||0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("seeking",()=>{this._seeking.set(!0)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("seeked",()=>{this._seeking.set(!1)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("volumechange",()=>{this._volume.set(this.media.volume),this._muted.set(this.media.muted)})),this.reactiveMediaEventCleanups.push(this.onMediaEvent("ratechange",()=>{this._playbackRate.set(this.media.playbackRate)}))}onMediaEvent(e,n,r){return this.media.addEventListener(e,n,r),()=>this.media.removeEventListener(e,n,r)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,n){const r=this.getSrc();if(e&&r===e)return;this.revokeSrc();const s=n instanceof Blob&&(this.canPlayType(n.type)||!e)?URL.createObjectURL(n):e;if(r&&this.media.removeAttribute("src"),s||e)try{this.media.src=s}catch{this.media.src=e}}destroy(){this.reactiveMediaEventCleanups.forEach(e=>e()),this.reactiveMediaEventCleanups=[],this.isExternalMedia||(this.media.pause(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load(),this.media.remove())}setMediaElement(e){this.reactiveMediaEventCleanups.forEach(n=>n()),this.reactiveMediaEventCleanups=[],this.media=e,this.setupReactiveMediaEvents()}play(){return Es(this,void 0,void 0,function*(){try{return yield this.media.play()}catch(e){if(e instanceof DOMException&&e.name==="AbortError")return;throw e}})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,n){n!=null&&(this.media.preservesPitch=n),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}function Mke({maxTop:t,maxBottom:e,halfHeight:n,vScale:r,barMinHeight:s=0,barAlign:i}){let o=Math.round(t*n*r),l=o+Math.round(e*n*r)||1;return l<s&&(l=s,i||(o=l/2)),{topHeight:o,totalHeight:l}}function Oke({barAlign:t,halfHeight:e,topHeight:n,totalHeight:r,canvasHeight:s}){return t==="top"?0:t==="bottom"?s-r:e-n}function tV(t,e,n){const r=e-t.left,s=n-t.top;return[r/t.width,s/t.height]}function Pq(t){return!!(t.barWidth||t.barGap||t.barAlign)}function nV(t,e){if(!Pq(e))return t;const n=e.barWidth||.5,r=n+(e.barGap||n/2);return r===0?t:Math.floor(t/r)*r}function rV({scrollLeft:t,totalWidth:e,numCanvases:n}){if(e===0)return[0];const r=t/e,s=Math.floor(r*n);return[s-1,s,s+1]}function Lq(t){const e=t._cleanup;typeof e=="function"&&e()}function Dke(t){const e=or({scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth}),n=ju(()=>function(i){const{scrollLeft:o,scrollWidth:l,clientWidth:c}=i;if(l===0)return{startX:0,endX:1};const d=o/l,h=(o+c)/l;return{startX:Math.max(0,Math.min(1,d)),endX:Math.max(0,Math.min(1,h))}}(e.value),[e]),r=ju(()=>function(i){return{left:i.scrollLeft,right:i.scrollLeft+i.clientWidth}}(e.value),[e]),s=()=>{e.set({scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth})};return t.addEventListener("scroll",s,{passive:!0}),{scrollData:e,percentages:n,bounds:r,cleanup:()=>{t.removeEventListener("scroll",s),Lq(e)}}}class Vke extends bx{constructor(e,n){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.dragStream=null,this.scrollStream=null,this.subscriptions=[],this.options=e;const r=this.parentFromOptionsContainer(e.container);this.parent=r;const[s,i]=this.initHtml();r.appendChild(s),this.container=s,this.scrollContainer=i.querySelector(".scroll"),this.wrapper=i.querySelector(".wrapper"),this.canvasWrapper=i.querySelector(".canvases"),this.progressWrapper=i.querySelector(".progress"),this.cursor=i.querySelector(".cursor"),n&&i.appendChild(n),this.initEvents()}parentFromOptionsContainer(e){let n;if(typeof e=="string"?n=document.querySelector(e):e instanceof HTMLElement&&(n=e),!n)throw new Error("Container not found");return n}initEvents(){this.wrapper.addEventListener("click",n=>{const r=this.wrapper.getBoundingClientRect(),[s,i]=tV(r,n.clientX,n.clientY);this.emit("click",s,i)}),this.wrapper.addEventListener("dblclick",n=>{const r=this.wrapper.getBoundingClientRect(),[s,i]=tV(r,n.clientX,n.clientY);this.emit("dblclick",s,i)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollStream=Dke(this.scrollContainer);const e=Fl(()=>{const{startX:n,endX:r}=this.scrollStream.percentages.value,{left:s,right:i}=this.scrollStream.bounds.value;this.emit("scroll",n,r,s,i)},[this.scrollStream.percentages,this.scrollStream.bounds]);if(this.subscriptions.push(e),typeof ResizeObserver=="function"){const n=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{n().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender(),this.emit("resize"))}initDrag(){if(this.dragStream)return;this.dragStream=function(n,r={}){const{threshold:s=3,mouseButton:i=0,touchDelay:o=100}=r,l=or(null),c=new Map,d=matchMedia("(pointer: coarse)").matches;let h=()=>{};const m=p=>{if(p.button!==i||(c.set(p.pointerId,p),c.size>1))return;let v=p.clientX,x=p.clientY,b=!1;const E=Date.now(),k=n.getBoundingClientRect(),{left:_,top:S}=k,T=O=>{if(O.defaultPrevented||c.size>1||d&&Date.now()-E<o)return;const D=O.clientX,F=O.clientY,V=D-v,$=F-x;(b||Math.abs(V)>s||Math.abs($)>s)&&(O.preventDefault(),O.stopPropagation(),b||(l.set({type:"start",x:v-_,y:x-S}),b=!0),l.set({type:"move",x:D-_,y:F-S,deltaX:V,deltaY:$}),v=D,x=F)},P=O=>{if(c.delete(O.pointerId),b){const D=O.clientX,F=O.clientY;l.set({type:"end",x:D-_,y:F-S})}h()},j=O=>{c.delete(O.pointerId),O.relatedTarget&&O.relatedTarget!==document.documentElement||P(O)},R=O=>{b&&(O.stopPropagation(),O.preventDefault())},I=O=>{O.defaultPrevented||c.size>1||b&&O.preventDefault()};document.addEventListener("pointermove",T),document.addEventListener("pointerup",P),document.addEventListener("pointerout",j),document.addEventListener("pointercancel",j),document.addEventListener("touchmove",I,{passive:!1}),document.addEventListener("click",R,{capture:!0}),h=()=>{document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",P),document.removeEventListener("pointerout",j),document.removeEventListener("pointercancel",j),document.removeEventListener("touchmove",I),setTimeout(()=>{document.removeEventListener("click",R,{capture:!0})},10)}};return n.addEventListener("pointerdown",m),{signal:l,cleanup:()=>{h(),n.removeEventListener("pointerdown",m),c.clear(),Lq(l)}}}(this.wrapper);const e=Fl(()=>{const n=this.dragStream.signal.value;if(!n)return;const r=this.wrapper.getBoundingClientRect().width,s=(i=n.x/r)<0?0:i>1?1:i;var i;n.type==="start"?(this.isDragging=!0,this.emit("dragstart",s)):n.type==="move"?this.emit("drag",s):n.type==="end"&&(this.isDragging=!1,this.emit("dragend",s))},[this.dragStream.signal]);this.subscriptions.push(e)}initHtml(){const e=document.createElement("div"),n=e.attachShadow({mode:"open"}),r=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return n.innerHTML=`
      <style${r?` nonce="${r}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
          pointer-events: none;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,n]}setOptions(e){if(this.options.container!==e.container){const n=this.parentFromOptionsContainer(e.container);n.appendChild(this.container),this.parent=n}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:n}=this.scrollContainer,r=n*e;this.setScroll(r)}destroy(){var e;this.subscriptions.forEach(n=>n()),this.container.remove(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),(e=this.unsubscribeOnScroll)===null||e===void 0||e.forEach(n=>n()),this.unsubscribeOnScroll=[],this.dragStream&&(this.dragStream.cleanup(),this.dragStream=null),this.scrollStream&&(this.scrollStream.cleanup(),this.scrollStream=null)}createDelay(e=10){let n,r;const s=()=>{n&&(clearTimeout(n),n=void 0),r&&(r(),r=void 0)};return this.timeouts.push(s),()=>new Promise((i,o)=>{s(),r=o,n=setTimeout(()=>{n=void 0,r=void 0,i()},e)})}getHeight(e,n){var r;const s=((r=this.audioData)===null||r===void 0?void 0:r.numberOfChannels)||1;return function({optionsHeight:i,optionsSplitChannels:o,parentHeight:l,numberOfChannels:c,defaultHeight:d=128}){if(i==null)return d;const h=Number(i);if(!isNaN(h))return h;if(i==="auto"){const m=l||d;return o!=null&&o.every(p=>!p.overlay)?m/c:m}return d}({optionsHeight:e,optionsSplitChannels:n,parentHeight:this.parent.clientHeight,numberOfChannels:s,defaultHeight:128})}convertColorValues(e,n){return function(r,s,i){if(!Array.isArray(r))return r||"";if(r.length===0)return"#999";if(r.length<2)return r[0]||"";const o=document.createElement("canvas"),l=o.getContext("2d"),c=i??o.height*s,d=l.createLinearGradient(0,0,0,c||s),h=1/(r.length-1);return r.forEach((m,p)=>{d.addColorStop(p*h,m)}),d}(e,this.getPixelRatio(),n==null?void 0:n.canvas.height)}getPixelRatio(){return e=window.devicePixelRatio,Math.max(1,e||1);var e}renderBarWaveform(e,n,r,s){const{width:i,height:o}=r.canvas,{halfHeight:l,barWidth:c,barRadius:d,barIndexScale:h,barSpacing:m,barMinHeight:p}=function({width:x,height:b,length:E,options:k,pixelRatio:_}){const S=b/2,T=k.barWidth?k.barWidth*_:1,P=k.barGap?k.barGap*_:k.barWidth?T/2:0,j=T+P||1;return{halfHeight:S,barWidth:T,barGap:P,barRadius:k.barRadius||0,barMinHeight:k.barMinHeight?k.barMinHeight*_:0,barIndexScale:E>0?x/j/E:0,barSpacing:j}}({width:i,height:o,length:(e[0]||[]).length,options:n,pixelRatio:this.getPixelRatio()}),v=function({channelData:x,barIndexScale:b,barSpacing:E,barWidth:k,halfHeight:_,vScale:S,canvasHeight:T,barAlign:P,barMinHeight:j}){const R=x[0]||[],I=x[1]||R,O=R.length,D=[];let F=0,V=0,$=0;for(let J=0;J<=O;J++){const ue=Math.round(J*b);if(ue>F){const{topHeight:q,totalHeight:Q}=Mke({maxTop:V,maxBottom:$,halfHeight:_,vScale:S,barMinHeight:j,barAlign:P}),H=Oke({barAlign:P,halfHeight:_,topHeight:q,totalHeight:Q,canvasHeight:T});D.push({x:F*E,y:H,width:k,height:Q}),F=ue,V=0,$=0}const ve=Math.abs(R[J]||0),le=Math.abs(I[J]||0);ve>V&&(V=ve),le>$&&($=le)}return D}({channelData:e,barIndexScale:h,barSpacing:m,barWidth:c,halfHeight:l,vScale:s,canvasHeight:o,barAlign:n.barAlign,barMinHeight:p});r.beginPath();for(const x of v)d&&"roundRect"in r?r.roundRect(x.x,x.y,x.width,x.height,d):r.rect(x.x,x.y,x.width,x.height);r.fill(),r.closePath()}renderLineWaveform(e,n,r,s){const{width:i,height:o}=r.canvas,l=function({channelData:c,width:d,height:h,vScale:m}){const p=h/2,v=c[0]||[];return[v,c[1]||v].map((x,b)=>{const E=x.length,k=E?d/E:0,_=p,S=b===0?-1:1,T=[{x:0,y:_}];let P=0,j=0;for(let R=0;R<=E;R++){const I=Math.round(R*k);if(I>P){const D=_+(Math.round(j*p*m)||1)*S;T.push({x:P,y:D}),P=I,j=0}const O=Math.abs(x[R]||0);O>j&&(j=O)}return T.push({x:P,y:_}),T})}({channelData:e,width:i,height:o,vScale:s});r.beginPath();for(const c of l)if(c.length){r.moveTo(c[0].x,c[0].y);for(let d=1;d<c.length;d++){const h=c[d];r.lineTo(h.x,h.y)}}r.fill(),r.closePath()}renderWaveform(e,n,r){if(r.fillStyle=this.convertColorValues(n.waveColor,r),n.renderFunction)return void n.renderFunction(e,r);const s=function({channelData:i,barHeight:o,normalize:l,maxPeak:c}){var d;const h=o||1;if(!l)return h;const m=i[0];if(!m||m.length===0)return h;let p=c??0;if(!c)for(let v=0;v<m.length;v++){const x=(d=m[v])!==null&&d!==void 0?d:0,b=Math.abs(x);b>p&&(p=b)}return p?h/p:h}({channelData:e,barHeight:n.barHeight,normalize:n.normalize,maxPeak:n.maxPeak});Pq(n)?this.renderBarWaveform(e,n,r,s):this.renderLineWaveform(e,n,r,s)}renderSingleCanvas(e,n,r,s,i,o,l){const c=this.getPixelRatio(),d=document.createElement("canvas");d.width=Math.round(r*c),d.height=Math.round(s*c),d.style.width=`${r}px`,d.style.height=`${s}px`,d.style.left=`${Math.round(i)}px`,o.appendChild(d);const h=d.getContext("2d");if(n.renderFunction?(h.fillStyle=this.convertColorValues(n.waveColor,h),n.renderFunction(e,h)):this.renderWaveform(e,n,h),d.width>0&&d.height>0){const m=d.cloneNode(),p=m.getContext("2d");p.drawImage(d,0,0),p.globalCompositeOperation="source-in",p.fillStyle=this.convertColorValues(n.progressColor,p),p.fillRect(0,0,d.width,d.height),l.appendChild(m)}}renderMultiCanvas(e,n,r,s,i,o){const l=this.getPixelRatio(),{clientWidth:c}=this.scrollContainer,d=r/l,h=function({clientWidth:x,totalWidth:b,options:E}){return nV(Math.min(8e3,x,b),E)}({clientWidth:c,totalWidth:d,options:n});let m={};if(h===0)return;const p=x=>{if(x<0||x>=v||m[x])return;m[x]=!0;const b=x*h;let E=Math.min(d-b,h);if(E=nV(E,n),E<=0)return;const k=function({channelData:_,offset:S,clampedWidth:T,totalWidth:P}){return _.map(j=>{const R=Math.floor(S/P*j.length),I=Math.floor((S+T)/P*j.length);return j.slice(R,I)})}({channelData:e,offset:b,clampedWidth:E,totalWidth:d});this.renderSingleCanvas(k,n,E,s,b,i,o)},v=Math.ceil(d/h);if(!this.isScrollable){for(let x=0;x<v;x++)p(x);return}if(rV({scrollLeft:this.scrollContainer.scrollLeft,totalWidth:d,numCanvases:v}).forEach(x=>p(x)),v>1){const x=this.on("scroll",()=>{const{scrollLeft:b}=this.scrollContainer;Object.keys(m).length>10&&(i.innerHTML="",o.innerHTML="",m={}),rV({scrollLeft:b,totalWidth:d,numCanvases:v}).forEach(E=>p(E))});this.unsubscribeOnScroll.push(x)}}renderChannel(e,n,r,s){var{overlay:i}=n,o=function(h,m){var p={};for(var v in h)Object.prototype.hasOwnProperty.call(h,v)&&m.indexOf(v)<0&&(p[v]=h[v]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var x=0;for(v=Object.getOwnPropertySymbols(h);x<v.length;x++)m.indexOf(v[x])<0&&Object.prototype.propertyIsEnumerable.call(h,v[x])&&(p[v[x]]=h[v[x]])}return p}(n,["overlay"]);const l=document.createElement("div"),c=this.getHeight(o.height,o.splitChannels);l.style.height=`${c}px`,i&&s>0&&(l.style.marginTop=`-${c}px`),this.canvasWrapper.style.minHeight=`${c}px`,this.canvasWrapper.appendChild(l);const d=l.cloneNode();this.progressWrapper.appendChild(d),this.renderMultiCanvas(e,o,r,c,l,d)}render(e){return Es(this,void 0,void 0,function*(){var n;this.timeouts.forEach(d=>d()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const r=this.getPixelRatio(),s=this.scrollContainer.clientWidth,{scrollWidth:i,isScrollable:o,useParentWidth:l,width:c}=function({duration:d,minPxPerSec:h=0,parentWidth:m,fillParent:p,pixelRatio:v}){const x=Math.ceil(d*h),b=x>m,E=!!(p&&!b);return{scrollWidth:x,isScrollable:b,useParentWidth:E,width:(E?m:x)*v}}({duration:e.duration,minPxPerSec:this.options.minPxPerSec||0,parentWidth:s,fillParent:this.options.fillParent,pixelRatio:r});if(this.isScrollable=o,this.wrapper.style.width=l?"100%":`${i}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let d=0;d<e.numberOfChannels;d++){const h=Object.assign(Object.assign({},this.options),(n=this.options.splitChannels)===null||n===void 0?void 0:n[d]);this.renderChannel([e.getChannelData(d)],h,c,d)}else{const d=[e.getChannelData(0)];e.numberOfChannels>1&&d.push(e.getChannelData(1)),this.renderChannel(d,this.options,c,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(r=>r()),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:n}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:r}=this.progressWrapper.getBoundingClientRect(),s=function(i){const o=2*i;return(o<0?Math.floor(o):Math.ceil(o))/2}(r-n);this.scrollContainer.scrollLeft+=s}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,n=!1){const{scrollLeft:r,scrollWidth:s,clientWidth:i}=this.scrollContainer,o=e*s,l=r,c=r+i,d=i/2;if(this.isDragging)o+30>c?this.scrollContainer.scrollLeft+=30:o-30<l&&(this.scrollContainer.scrollLeft-=30);else{(o<l||o>c)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?d:0));const h=o-r-d;n&&this.options.autoCenter&&h>0&&(this.scrollContainer.scrollLeft+=h)}}renderProgress(e,n){if(isNaN(e))return;const r=100*e;this.canvasWrapper.style.clipPath=`polygon(${r}% 0%, 100% 0%, 100% 100%, ${r}% 100%)`,this.progressWrapper.style.width=`${r}%`,this.cursor.style.left=`${r}%`,this.cursor.style.transform=this.options.cursorWidth?`translateX(-${e*this.options.cursorWidth}px)`:"",this.isScrollable&&this.options.autoScroll&&this.audioData&&this.audioData.duration>0&&this.scrollIntoView(e,n)}exportImage(e,n,r){return Es(this,void 0,void 0,function*(){const s=this.canvasWrapper.querySelectorAll("canvas");if(!s.length)throw new Error("No waveform data");if(r==="dataURL"){const i=Array.from(s).map(o=>o.toDataURL(e,n));return Promise.resolve(i)}return Promise.all(Array.from(s).map(i=>new Promise((o,l)=>{i.toBlob(c=>{c?o(c):l(new Error("Could not export image"))},e,n)})))})}}class Fke extends bx{constructor(){super(...arguments),this.animationFrameId=null,this.isRunning=!1}start(){if(this.isRunning)return;this.isRunning=!0;const e=()=>{this.isRunning&&(this.emit("tick"),this.animationFrameId=requestAnimationFrame(e))};e()}stop(){this.isRunning=!1,this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop()}}class EE extends bx{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return Es(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(n=>{if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return n.arrayBuffer()}).then(n=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(n)).then(n=>{this.currentSrc===e&&(this.buffer=n,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())}).catch(n=>{console.error("WebAudioPlayer load error:",n)})}_play(){if(!this.paused)return;this.paused=!1,this.bufferNode&&(this.bufferNode.onended=null,this.bufferNode.disconnect()),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let e=this.playedDuration*this._playbackRate;(e>=this.duration||e<0)&&(e=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,e),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return Es(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){const n=e-this.currentTime,r=this.bufferNode;r==null||r.stop(this.audioContext.currentTime+n),r==null||r.addEventListener("ended",()=>{r===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(e){return Es(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const n=!this.paused;n&&this._pause(),this.playedDuration=e/this._playbackRate,n&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,n;return(e=this._duration)!==null&&e!==void 0?e:((n=this.buffer)===null||n===void 0?void 0:n.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const n=this.buffer.numberOfChannels;for(let r=0;r<n;r++)e.push(this.buffer.getChannelData(r));return e}removeAttribute(e){switch(e){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}const $ke={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class f0 extends Lke{static create(e){return new f0(e)}getState(){return this.wavesurferState}getRenderer(){return this.renderer}constructor(e){const n=e.media||(e.backend==="WebAudio"?new EE:void 0);super({media:n,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.reactiveCleanups=[],this.options=Object.assign({},$ke,e);const{state:r,actions:s}=function(l){var c,d,h,m,p,v;const x=(c=l==null?void 0:l.currentTime)!==null&&c!==void 0?c:or(0),b=(d=l==null?void 0:l.duration)!==null&&d!==void 0?d:or(0),E=(h=l==null?void 0:l.isPlaying)!==null&&h!==void 0?h:or(!1),k=(m=l==null?void 0:l.isSeeking)!==null&&m!==void 0?m:or(!1),_=(p=l==null?void 0:l.volume)!==null&&p!==void 0?p:or(1),S=(v=l==null?void 0:l.playbackRate)!==null&&v!==void 0?v:or(1),T=or(null),P=or(null),j=or(""),R=or(0),I=or(0),O=ju(()=>!E.value,[E]),D=ju(()=>T.value!==null,[T]),F=ju(()=>D.value&&b.value>0,[D,b]),V=ju(()=>x.value,[x]),$=ju(()=>b.value>0?x.value/b.value:0,[x,b]);return{state:{currentTime:x,duration:b,isPlaying:E,isPaused:O,isSeeking:k,volume:_,playbackRate:S,audioBuffer:T,peaks:P,url:j,zoom:R,scrollPosition:I,canPlay:D,isReady:F,progress:V,progressPercent:$},actions:{setCurrentTime:J=>{const ue=Math.max(0,Math.min(b.value||1/0,J));x.set(ue)},setDuration:J=>{b.set(Math.max(0,J))},setPlaying:J=>{E.set(J)},setSeeking:J=>{k.set(J)},setVolume:J=>{const ue=Math.max(0,Math.min(1,J));_.set(ue)},setPlaybackRate:J=>{const ue=Math.max(.1,Math.min(16,J));S.set(ue)},setAudioBuffer:J=>{T.set(J),J&&b.set(J.duration)},setPeaks:J=>{P.set(J)},setUrl:J=>{j.set(J)},setZoom:J=>{R.set(Math.max(0,J))},setScrollPosition:J=>{I.set(Math.max(0,J))}}}}({isPlaying:this.isPlayingSignal,currentTime:this.currentTimeSignal,duration:this.durationSignal,volume:this.volumeSignal,playbackRate:this.playbackRateSignal,isSeeking:this.seekingSignal});this.wavesurferState=r,this.wavesurferActions=s,this.timer=new Fke;const i=n?void 0:this.getMediaElement();this.renderer=new Vke(this.options,i),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initReactiveState(),this.initPlugins();const o=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:l,duration:c}=this.options;(o||l&&c)&&this.load(o,l,c).catch(d=>{this.emit("error",d instanceof Error?d:new Error(String(d)))})})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}}))}initReactiveState(){this.reactiveCleanups.push(function(e,n){const r=[];r.push(Fl(()=>{const o=e.isPlaying.value;n.emit(o?"play":"pause")},[e.isPlaying])),r.push(Fl(()=>{const o=e.currentTime.value;n.emit("timeupdate",o),e.isPlaying.value&&n.emit("audioprocess",o)},[e.currentTime,e.isPlaying])),r.push(Fl(()=>{e.isSeeking.value&&n.emit("seeking",e.currentTime.value)},[e.isSeeking,e.currentTime]));let s=!1;r.push(Fl(()=>{e.isReady.value&&!s&&(s=!0,n.emit("ready",e.duration.value))},[e.isReady,e.duration]));let i=!1;return r.push(Fl(()=>{const o=e.isPlaying.value,l=e.currentTime.value,c=e.duration.value,d=c>0&&l>=c;i&&!o&&d&&n.emit("finish"),i=o&&d},[e.isPlaying,e.currentTime,e.duration])),r.push(Fl(()=>{const o=e.zoom.value;o>0&&n.emit("zoom",o)},[e.zoom])),()=>{r.forEach(o=>o())}}(this.wavesurferState,{emit:this.emit.bind(this)}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,n)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,n))}),this.renderer.on("dblclick",(e,n)=>{this.emit("dblclick",e,n)}),this.renderer.on("scroll",(e,n,r,s)=>{const i=this.getDuration();this.emit("scroll",e*i,n*i,r,s)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}),this.renderer.on("resize",()=>{this.emit("resize")}));{let e;const n=this.renderer.on("drag",r=>{var s;if(!this.options.interact)return;this.renderer.renderProgress(r),clearTimeout(e);let i=0;const o=this.options.dragToSeek;this.isPlaying()?i=0:o===!0?i=200:o&&typeof o=="object"&&(i=(s=o.debounceTime)!==null&&s!==void 0?s:200),e=setTimeout(()=>{this.seekTo(r)},i),this.emit("interaction",r*this.getDuration()),this.emit("drag",r)});this.subscriptions.push(()=>{clearTimeout(e),n()})}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(n=>{this.registerPlugin(n)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=Bv.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=Bv.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){if(this.plugins.includes(e))return e;e._init(this),this.plugins.push(e);const n=e.once("destroy",()=>{this.plugins=this.plugins.filter(r=>r!==e),this.subscriptions=this.subscriptions.filter(r=>r!==n)});return this.subscriptions.push(n),e}unregisterPlugin(e){this.plugins=this.plugins.filter(n=>n!==e),e.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const n=e/this.getDuration();this.renderer.setScrollPercentage(n)}getActivePlugins(){return this.plugins}loadAudio(e,n,r,s){return Es(this,void 0,void 0,function*(){var i;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,(i=this.abortController)===null||i===void 0||i.abort(),this.abortController=null,!n&&!r){const l=this.options.fetchParams||{};window.AbortController&&!l.signal&&(this.abortController=new AbortController,l.signal=this.abortController.signal);const c=h=>this.emit("loading",h);n=yield Pke.fetchBlob(e,c,l);const d=this.options.blobMimeType;d&&(n=new Blob([n],{type:d}))}this.setSrc(e,n);const o=yield new Promise(l=>{const c=s||this.getDuration();c?l(c):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>l(this.getDuration()),{once:!0}))});if(!e&&!n){const l=this.getMediaElement();l instanceof EE&&(l.duration=o)}if(r)this.decodedData=Bv.createBuffer(r,o||0);else if(n){const l=yield n.arrayBuffer();this.decodedData=yield Bv.decode(l,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,n,r){return Es(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,n,r)}catch(s){throw this.emit("error",s),s}})}loadBlob(e,n,r){return Es(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,n,r)}catch(s){throw this.emit("error",s),s}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:n=8e3,precision:r=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const s=Math.min(e,this.decodedData.numberOfChannels),i=[];for(let o=0;o<s;o++){const l=this.decodedData.getChannelData(o),c=[],d=l.length/n;for(let h=0;h<n;h++){const m=l.slice(Math.floor(h*d),Math.ceil((h+1)*d));let p=0;for(let v=0;v<m.length;v++){const x=m[v];Math.abs(x)>Math.abs(p)&&(p=x)}c.push(Math.round(p*r)/r)}i.push(c)}return i}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const n=this.getDuration()*e;this.setTime(n)}play(e,n){const r=Object.create(null,{play:{get:()=>super.play}});return Es(this,void 0,void 0,function*(){e!=null&&this.setTime(e);const s=yield r.play.call(this);return n!=null&&(this.media instanceof EE?this.media.stopAt(n):this.stopAtPosition=n),s})}playPause(){return Es(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return Es(this,arguments,void 0,function*(e="image/png",n=1,r="dataURL"){return this.renderer.exportImage(e,n,r)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(n=>n.destroy()),this.subscriptions.forEach(n=>n()),this.unsubscribePlayerEvents(),this.reactiveCleanups.forEach(n=>n()),this.reactiveCleanups=[],this.timer.destroy(),this.renderer.destroy(),super.destroy()}}f0.BasePlugin=class extends bx{constructor(t){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=t}onInit(){}_init(t){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(t=>t()),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},f0.dom=Rke;const Bke="/assets/Fevicon-TMLO4Pj9.png";function DC({audioUrl:t,fileName:e="Audio Track",previewMode:n=!1}){const r=N.useRef(null),s=N.useRef(null),i=N.useRef(null),o=N.useRef(null),l=N.useRef(null),c=N.useRef(null),d=N.useRef(Math.random().toString(36).substr(2,9)),h=N.useRef(null),m=N.useRef(null),p=N.useRef(null),[v,x]=N.useState(!1),[b,E]=N.useState(!1),[k,_]=N.useState(!1),[S,T]=N.useState(!1),[P,j]=N.useState(document.documentElement.classList.contains("dark")),R=N.useRef(P),I={dark:{star:"rgba(255, 255, 255, 0.5)",special:"#3D84ED",wave:"rgba(255, 255, 255, 0.3)"},light:{star:"rgba(0, 0, 0, 0.5)",special:"#2563EB",wave:"rgba(0, 0, 0, 0.2)"}},O=400,D=120,F=80,V=N.useRef({stars:[],avg:0,width:0,height:0,cx:0,cy:0});N.useEffect(()=>{const le=new MutationObserver(q=>{q.forEach(Q=>{if(Q.attributeName==="class"){const H=document.documentElement.classList.contains("dark");j(H),R.current=H,l.current&&l.current.setOptions({waveColor:H?I.dark.wave:I.light.wave})}})});return le.observe(document.documentElement,{attributes:!0}),()=>le.disconnect()},[]),N.useEffect(()=>{if(!i.current||!o.current)return;const le=P?I.dark:I.light;l.current=f0.create({container:o.current,waveColor:le.wave,progressColor:"#3D84ED",cursorColor:"#3D84ED",barWidth:4,barGap:3,barRadius:3,height:100,responsive:!0,normalize:!0,backend:"MediaElement",media:i.current,minPxPerSec:50,fillParent:!0,interact:!n,cursorWidth:2,barAlign:"bottom"});const q=Q=>{Q.detail.id!==d.current&&l.current&&l.current.isPlaying()&&l.current.pause()};return window.addEventListener("seshnx-audio-play",q),l.current.on("ready",()=>E(!0)),l.current.on("play",()=>{x(!0),window.dispatchEvent(new CustomEvent("seshnx-audio-play",{detail:{id:d.current}}))}),l.current.on("pause",()=>x(!1)),l.current.on("finish",()=>{x(!1),cancelAnimationFrame(c.current)}),()=>{window.removeEventListener("seshnx-audio-play",q),l.current&&l.current.destroy(),cancelAnimationFrame(c.current)}},[t,n]),N.useEffect(()=>{const le=()=>{if(r.current&&s.current){const{clientWidth:q,clientHeight:Q}=r.current;s.current.width=q,s.current.height=Q,V.current.width=q,V.current.height=Q,V.current.cx=q/2,V.current.cy=Q/2,$()}};return window.addEventListener("resize",le),le(),()=>{window.removeEventListener("resize",le),h.current&&h.current.state!=="closed"&&h.current.close()}},[]);const $=()=>{V.current.stars=[];for(let le=0;le<O;le++)V.current.stars.push({x:Math.random()*V.current.width-V.current.cx,y:Math.random()*V.current.height-V.current.cy,z:Math.random()*V.current.width})},J=()=>{if(!(S||k||!i.current))try{const le=window.AudioContext||window.webkitAudioContext;h.current=new le,m.current=h.current.createAnalyser(),m.current.fftSize=2048,p.current=h.current.createMediaElementSource(i.current),p.current.connect(m.current),m.current.connect(h.current.destination),T(!0)}catch(le){console.warn("Audio Context Error:",le)}},ue=async le=>{var q;le.stopPropagation(),S||J(),((q=h.current)==null?void 0:q.state)==="suspended"&&await h.current.resume(),l.current&&l.current.playPause(),v||ve()},ve=()=>{if(!s.current)return;const le=s.current.getContext("2d"),{width:q,height:Q,cx:H,cy:X,stars:oe}=V.current;let ae=0;if(m.current){const te=m.current.frequencyBinCount,be=new Uint8Array(te);m.current.getByteFrequencyData(be);let Fe=0;for(let vt=0;vt<be.length;vt++)Fe+=be[vt];ae=Fe/be.length}V.current.avg=ae,le.clearRect(0,0,q,Q);const je=R.current?I.dark:I.light,ge=ae>F?ae/10:ae/30+.5;oe.forEach(te=>{te.z-=ge,te.z<=0&&(te.z=q,te.x=Math.random()*q-H,te.y=Math.random()*Q-X);const be=te.x/te.z*q+H,Fe=te.y/te.z*Q+X,vt=(1-te.z/q)*2.5;be>=0&&be<=q&&Fe>=0&&Fe<=Q&&(le.fillStyle=ae>D?je.special:je.star,le.globalAlpha=1-te.z/q,le.beginPath(),le.arc(be,Fe,vt,0,Math.PI*2),le.fill(),le.globalAlpha=1)}),l.current&&l.current.isPlaying()&&(c.current=requestAnimationFrame(ve))};return a.jsxs("div",{ref:r,className:"relative w-full h-32 rounded-xl overflow-hidden group bg-transparent transition-colors",children:[a.jsx("canvas",{ref:s,className:"w-full h-full absolute inset-0 z-0 pointer-events-none"}),a.jsx("div",{className:"absolute inset-0 z-20 flex flex-col justify-end pointer-events-none",children:a.jsx("div",{ref:o,className:"w-full pointer-events-auto opacity-80 hover:opacity-100 transition-opacity"})}),a.jsxs("div",{className:"absolute top-0 left-0 right-0 p-3 z-30 flex justify-between items-start pointer-events-none",children:[a.jsxs("div",{className:"flex items-center gap-2 text-black dark:text-white/90",children:[a.jsx(ta,{size:16,className:"text-brand-blue"}),a.jsx("span",{className:"text-sm font-medium truncate max-w-[200px] shadow-sm",children:e}),n&&a.jsxs("span",{className:"text-[10px] bg-yellow-500 text-black px-2 rounded font-bold flex items-center gap-1",children:[a.jsx(tu,{size:8})," PREVIEW"]})]}),k&&a.jsxs("div",{className:"bg-red-500/80 text-white text-[10px] px-2 py-0.5 rounded flex items-center gap-1",children:[a.jsx(pl,{size:10})," Visuals Disabled"]})]}),a.jsx("div",{className:"absolute bottom-2 left-2 z-30 opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none",children:a.jsx("img",{src:Bke,alt:"SeshNx",className:"w-5 h-5 object-contain"})}),a.jsx("div",{className:`absolute inset-0 z-40 flex items-center justify-center transition-opacity duration-300 pointer-events-none
                ${v?"opacity-0 group-hover:opacity-100 bg-white/20 dark:bg-black/20":"opacity-100 bg-white/10 dark:bg-black/10"}`,children:b?a.jsx("button",{onClick:ue,className:"w-14 h-14 bg-white/80 dark:bg-black/40 rounded-full flex items-center justify-center border border-gray-200 dark:border-white/40 text-brand-blue shadow-lg hover:scale-110 transition-transform pointer-events-auto",children:v?a.jsx(vW,{fill:"currentColor",className:"ml-0.5",size:24}):a.jsx(tR,{fill:"currentColor",className:"ml-1",size:24})}):a.jsx(rt,{className:"animate-spin text-brand-blue",size:32})}),a.jsx("audio",{ref:i,src:t,crossOrigin:"anonymous",onError:()=>_(!0)})]})}function zke({post:t,currentUser:e,currentUserData:n,blockedUsers:r,onCountChange:s}){const[i,o]=N.useState([]),[l,c]=N.useState(""),[d,h]=N.useState(!1);N.useEffect(()=>{const v=Et(Re(Z,`artifacts/${Ge}/public/data/posts/${t.id}/replies`),Wn("timestamp","asc")),x=pn(v,b=>{const k=b.docs.map(_=>({id:_.id,..._.data()})).filter(_=>!(r!=null&&r.includes(_.userId)));o(k),s(k.length)});return()=>x()},[t.id]);const m=async v=>{var b;if(v.preventDefault(),!l.trim()||!(e!=null&&e.uid))return;h(!0);const x=(n==null?void 0:n.effectiveDisplayName)||(n==null?void 0:n.firstName)||(e==null?void 0:e.displayName)||"User";try{await hn(Re(Z,`artifacts/${Ge}/public/data/posts/${t.id}/replies`),{text:l,userId:e.uid,displayName:x,userPhoto:(n==null?void 0:n.photoURL)||null,timestamp:zt()}),t.userId!==e.uid&&gq({targetUserId:t.userId,type:"comment",fromUserId:e.uid,fromUserName:x,fromUserPhoto:n==null?void 0:n.photoURL,postId:t.id,postPreview:(b=t.text)==null?void 0:b.substring(0,50),message:"commented on your post"}),c("")}catch(E){console.error(E)}h(!1)},p=async v=>{if(window.confirm("Delete comment?"))try{await _o(Se(Z,`artifacts/${Ge}/public/data/posts/${t.id}/replies`,v))}catch(x){console.error("Delete comment error:",x)}};return a.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] border-t dark:border-gray-700 p-4 animate-in slide-in-from-top-2",children:[a.jsxs("div",{className:"space-y-4 mb-4 max-h-80 overflow-y-auto custom-scrollbar pr-2",children:[i.length===0&&a.jsx("div",{className:"text-center text-gray-400 text-xs py-2",children:"No comments yet. Be the first!"}),i.map(v=>a.jsxs("div",{className:"group flex gap-3 text-sm",children:[a.jsx(ra,{src:v.userPhoto,name:v.displayName,size:"xs",className:"shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"bg-white dark:bg-dark-card border dark:border-gray-700 p-3 rounded-2xl rounded-tl-none inline-block max-w-full",children:[a.jsxs("div",{className:"flex justify-between items-baseline gap-2 mb-1",children:[a.jsx("span",{className:"font-bold dark:text-white text-xs truncate",children:v.displayName}),a.jsx("span",{className:"text-[10px] text-gray-400 shrink-0",children:v.timestamp?new Date(v.timestamp.toMillis()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"..."})]}),a.jsx("p",{className:"text-gray-700 dark:text-gray-300 break-words",children:v.text})]}),a.jsxs("div",{className:"flex gap-3 mt-1 ml-2",children:[a.jsx("button",{className:"text-[10px] font-bold text-gray-500 hover:text-brand-blue transition",children:"Reply"}),v.userId===(e==null?void 0:e.uid)&&a.jsx("button",{onClick:()=>p(v.id),className:"text-[10px] font-bold text-gray-400 hover:text-red-500 transition",children:"Delete"})]})]})]},v.id))]}),a.jsxs("form",{onSubmit:m,className:"flex gap-2",children:[a.jsx(ra,{src:n==null?void 0:n.photoURL,name:(n==null?void 0:n.firstName)||"You",size:"xs",className:"shrink-0 hidden sm:block"}),a.jsx("input",{className:"flex-1 bg-white dark:bg-dark-card border dark:border-gray-600 rounded-full px-4 py-2 text-sm focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition",placeholder:"Write a comment...",value:l,onChange:v=>c(v.target.value)}),a.jsx("button",{type:"submit",disabled:!l.trim()||d,className:"bg-brand-blue text-white p-2 rounded-full hover:bg-blue-600 disabled:opacity-50 transition shadow-sm",children:a.jsx(b1,{size:16,className:d?"animate-pulse":""})})]})]})}function $R({isFollowing:t,onToggle:e,size:n="md",variant:r="default",disabled:s=!1,showIcon:i=!0,className:o=""}){const[l,c]=N.useState(!1),[d,h]=N.useState(!1),m=async _=>{if(_.stopPropagation(),!(s||l)){c(!0);try{await e()}catch(S){console.error("Follow toggle error:",S)}c(!1)}},p={sm:"px-3 py-1 text-xs",md:"px-4 py-1.5 text-sm",lg:"px-6 py-2 text-base"},v={sm:12,md:14,lg:16},x=()=>t?r==="outline"||r==="minimal"?d?"border-red-300 text-red-500 hover:bg-red-50 dark:border-red-800 dark:hover:bg-red-900/20":"border-gray-300 text-gray-700 dark:border-gray-600 dark:text-gray-300":d?"bg-red-500 text-white hover:bg-red-600":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200":r==="outline"?"border-brand-blue text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20":r==="minimal"?"text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20":"bg-brand-blue text-white hover:bg-blue-600",b=`
        font-semibold rounded-full transition-all duration-200 
        flex items-center justify-center gap-1.5
        disabled:opacity-50 disabled:cursor-not-allowed
        ${r==="outline"?"border-2 bg-transparent":""}
        ${r==="minimal"?"bg-transparent":""}
        ${p[n]}
        ${x()}
        ${o}
    `,E=()=>l?a.jsx(rt,{className:"animate-spin",size:v[n]}):t?d?a.jsx(Jye,{size:v[n]}):a.jsx(fC,{size:v[n]}):a.jsx(nu,{size:v[n]}),k=()=>t?d?"Unfollow":"Following":"Follow";return a.jsx(nt.button,{whileHover:{scale:s?1:1.02},whileTap:{scale:s?1:.98},className:b,onClick:m,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),disabled:s||l,children:a.jsx(yr,{mode:"wait",children:a.jsxs(nt.span,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},transition:{duration:.15},className:"flex items-center gap-1.5",children:[i&&E(),a.jsx("span",{children:k()})]},`${t}-${d}`)})})}const Uke=["","","","","",""],Wke=t=>t?t.split(/(\s+)/).map((e,n)=>e.match(/^#\w+/)?a.jsx("span",{className:"text-brand-blue font-bold cursor-pointer hover:underline",children:e},n):e.match(/^@\w+/)?a.jsx("span",{className:"text-purple-600 font-bold cursor-pointer hover:underline",children:e},n):e):null,Hke={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:24}},exit:{opacity:0,scale:.95,transition:{duration:.2}}};function qke({post:t,currentUser:e,currentUserData:n,openPublicProfile:r,onReport:s,isFollowingAuthor:i,onToggleFollow:o}){var ve,le,q;const[l,c]=N.useState(!1),[d,h]=N.useState(t.commentCount||0),[m,p]=N.useState(!1),[v,x]=N.useState(!1),[b,E]=N.useState(!1),[k,_]=N.useState(!1),[S,T]=N.useState(!1),P=N.useRef(null),j=N.useRef(null),R=t.userId===(e==null?void 0:e.uid),I=(ve=t.reactions)==null?void 0:ve[e==null?void 0:e.uid],O=t.reactions?Object.values(t.reactions).reduce((Q,H)=>(Q[H]=(Q[H]||0)+1,Q),{}):{},D=Object.values(O).reduce((Q,H)=>Q+H,0);N.useEffect(()=>{if(!(e!=null&&e.uid))return;(async()=>{try{const H=Se(Z,Ve(e.uid).savedPosts,t.id),X=await uo(H);p(X.exists())}catch(H){console.error("Error checking saved status:",H)}})()},[e==null?void 0:e.uid,t.id]),N.useEffect(()=>{const Q=H=>{P.current&&!P.current.contains(H.target)&&x(!1),j.current&&!j.current.contains(H.target)&&E(!1)};return document.addEventListener("mousedown",Q),()=>document.removeEventListener("mousedown",Q)},[]);const F=async Q=>{var X;if(x(!1),!(e!=null&&e.uid))return;const H=Se(Z,`artifacts/${Ge}/public/data/posts/${t.id}`);try{const oe={},ae=!!I;I===Q?(oe[`reactions.${e.uid}`]=Ore(),oe.reactionCount=ho(-1)):(oe[`reactions.${e.uid}`]=Q,I||(oe.reactionCount=ho(1)),!ae&&!R&&gq({targetUserId:t.userId,type:"like",fromUserId:e.uid,fromUserName:(n==null?void 0:n.effectiveDisplayName)||(n==null?void 0:n.firstName)||"Someone",fromUserPhoto:n==null?void 0:n.photoURL,postId:t.id,postPreview:(X=t.text)==null?void 0:X.substring(0,50),message:`reacted ${Q} to your post`})),await Nt(H,oe)}catch(oe){console.error("Reaction failed",oe),un.error("Couldn't add reaction")}},V=async()=>{var Q,H;if(!(!(e!=null&&e.uid)||S)){T(!0);try{const X=Se(Z,Ve(e.uid).savedPosts,t.id),oe=Se(Z,`artifacts/${Ge}/public/data/posts/${t.id}`);m?(await _o(X),await Nt(oe,{saveCount:ho(-1)}),p(!1),un.success("Removed from saved")):(await ec(X,{postId:t.id,authorId:t.userId,authorName:t.displayName,preview:((Q=t.text)==null?void 0:Q.substring(0,100))||"Media post",savedAt:new Date,hasMedia:!!((H=t.attachments)!=null&&H.length||t.imageUrl||t.audioUrl)}),await Nt(oe,{saveCount:ho(1)}),p(!0),un.success("Post saved!"))}catch(X){console.error("Save failed",X),un.error("Couldn't save post")}T(!1)}},$=async()=>{var H;const Q=`${window.location.origin}/post/${t.id}`;if(navigator.share)try{await navigator.share({title:`Post by ${t.displayName}`,text:((H=t.text)==null?void 0:H.substring(0,100))||"Check out this post",url:Q})}catch(X){X.name!=="AbortError"&&J(Q)}else J(Q)},J=Q=>{navigator.clipboard.writeText(Q),_(!0),un.success("Link copied to clipboard!"),setTimeout(()=>_(!1),2e3)},ue=async()=>{if(R&&window.confirm("Are you sure you want to delete this post?"))try{const Q=Se(Z,`artifacts/${Ge}/public/data/posts/${t.id}`);await _o(Q),un.success("Post deleted")}catch(Q){console.error("Delete failed:",Q),un.error("Couldn't delete post")}};return a.jsxs(nt.div,{variants:Hke,initial:"hidden",animate:"show",exit:"exit",layout:!0,className:"bg-white dark:bg-dark-card border dark:border-gray-700 rounded-xl overflow-visible shadow-sm mb-4 relative",children:[a.jsxs("div",{className:"p-4 flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden cursor-pointer shrink-0",onClick:()=>r(t.userId),children:t.authorPhoto?a.jsx("img",{src:t.authorPhoto,className:"h-full w-full object-cover",alt:"avatar"}):a.jsx("div",{className:"h-full w-full bg-gradient-to-tr from-brand-blue to-purple-500 flex items-center justify-center text-white font-bold",children:((le=t.displayName)==null?void 0:le[0])||a.jsx(Jr,{size:16})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-bold dark:text-white text-sm hover:underline decoration-brand-blue cursor-pointer truncate",onClick:()=>r(t.userId),children:t.displayName}),!R&&o&&!i&&a.jsx("button",{onClick:Q=>{Q.stopPropagation(),o()},className:"text-xs font-bold text-brand-blue hover:text-blue-700 transition shrink-0",children:" Follow"})]}),a.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[a.jsx("span",{className:"truncate",children:t.role}),a.jsx("span",{children:""}),a.jsx("span",{className:"shrink-0",children:t.timestamp?new Date(t.timestamp.toMillis?t.timestamp.toMillis():t.timestamp).toLocaleDateString():"Just now"})]})]})]}),a.jsxs("div",{className:"relative",ref:j,children:[a.jsx("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-white transition p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>E(!b),children:a.jsx(Kye,{size:20})}),a.jsx(yr,{children:b&&a.jsxs(nt.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-xl border dark:border-gray-700 overflow-hidden z-50",children:[a.jsxs("button",{onClick:()=>{J(`${window.location.origin}/post/${t.id}`),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:[a.jsx(Wye,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"dark:text-gray-200",children:"Copy link"})]}),!R&&a.jsxs(a.Fragment,{children:[o&&a.jsxs("button",{onClick:()=>{o(),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:[a.jsx(nu,{size:16,className:"text-gray-400"}),a.jsxs("span",{className:"dark:text-gray-200",children:[i?"Unfollow":"Follow"," ",(q=t.displayName)==null?void 0:q.split(" ")[0]]})]}),a.jsxs("button",{onClick:()=>{s(),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition text-red-500",children:[a.jsx(pm,{size:16}),a.jsx("span",{children:"Report post"})]})]}),R&&a.jsxs("button",{onClick:()=>{ue(),E(!1)},className:"w-full px-4 py-2.5 text-left text-sm flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition text-red-500",children:[a.jsx(bs,{size:16}),a.jsx("span",{children:"Delete post"})]})]})})]})]}),a.jsxs("div",{className:"px-4 pb-2",children:[t.text&&a.jsx("p",{className:"text-gray-800 dark:text-gray-200 whitespace-pre-wrap text-sm leading-relaxed mb-3",children:Wke(t.text)}),t.attachments&&t.attachments.length>0&&a.jsx("div",{className:`grid gap-2 mb-3 ${t.attachments.length>1?"grid-cols-2":"grid-cols-1"}`,children:t.attachments.map((Q,H)=>a.jsxs("div",{className:"rounded-lg overflow-hidden bg-transparent relative",children:[Q.type==="image"&&a.jsx("img",{src:Q.url,className:"w-full h-full object-cover max-h-96",alt:"content"}),Q.type==="video"&&a.jsx("video",{src:Q.url,controls:!0,className:"w-full h-full max-h-96 bg-black"}),Q.type==="audio"&&a.jsx("div",{className:"w-full",children:a.jsx(DC,{audioUrl:Q.url,fileName:Q.name||"Audio Track"})})]},H))}),t.audioUrl&&!t.attachments&&a.jsx("div",{className:"rounded-lg overflow-hidden bg-transparent mb-3",children:a.jsx(DC,{audioUrl:t.audioUrl,fileName:t.audioName||"Track"})}),t.imageUrl&&!t.attachments&&a.jsx("img",{src:t.imageUrl,className:"rounded-lg w-full mb-3 border dark:border-gray-700",alt:"legacy content"})]}),(D>0||t.saveCount>0)&&a.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[a.jsx("div",{className:"flex gap-1",children:Object.entries(O).map(([Q,H])=>a.jsxs(nt.div,{initial:{scale:0},animate:{scale:1},className:`text-xs px-2 py-1 rounded-full border flex items-center gap-1 ${I===Q?"bg-blue-50 border-blue-200 dark:bg-blue-900/30 dark:border-blue-800":"bg-gray-50 border-gray-100 dark:bg-gray-800 dark:border-gray-700"} dark:text-gray-300`,children:[a.jsx("span",{children:Q}),a.jsx("span",{className:"font-bold",children:H})]},Q))}),t.saveCount>0&&a.jsxs("span",{className:"text-xs text-gray-400",children:[t.saveCount," save",t.saveCount!==1?"s":""]})]}),a.jsxs("div",{className:"px-4 py-3 border-t dark:border-gray-700 flex items-center justify-between relative",children:[a.jsxs("div",{className:"flex gap-2 sm:gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsxs(nt.button,{whileTap:{scale:.9},onClick:()=>x(!v),className:`flex items-center gap-1.5 sm:gap-2 text-sm font-medium transition px-2 py-1 rounded-lg ${I?"text-blue-600 bg-blue-50 dark:bg-blue-900/20":"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[I?a.jsx("span",{className:"text-lg",children:I}):a.jsx(wW,{size:18}),a.jsx("span",{className:"hidden sm:inline",children:I?"Reacted":"React"})]}),a.jsx(yr,{children:v&&a.jsx(nt.div,{ref:P,initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:10},className:"absolute bottom-full left-0 mb-2 bg-white dark:bg-gray-800 shadow-xl rounded-full p-2 flex gap-1 sm:gap-2 z-50 border dark:border-gray-600 origin-bottom-left",children:Uke.map(Q=>a.jsx(nt.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:H=>{H.stopPropagation(),F(Q)},className:`text-xl p-1 sm:p-1.5 rounded-full ${I===Q?"bg-blue-100 dark:bg-blue-900":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:Q},Q))})})]}),a.jsxs(nt.button,{whileTap:{scale:.95},onClick:()=>c(!l),className:"flex items-center gap-1.5 sm:gap-2 text-sm font-medium text-gray-500 hover:text-brand-blue transition px-2 py-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:[a.jsx(Cd,{size:18}),a.jsx("span",{className:"hidden sm:inline",children:d>0?d:"Comment"}),d>0&&a.jsx("span",{className:"sm:hidden",children:d})]}),a.jsxs(nt.button,{whileTap:{scale:.95},onClick:$,className:`flex items-center gap-1.5 sm:gap-2 text-sm font-medium transition px-2 py-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 ${k?"text-green-500":"text-gray-500 hover:text-green-500"}`,children:[k?a.jsx(Bi,{size:18}):a.jsx(Zye,{size:18}),a.jsx("span",{className:"hidden sm:inline",children:k?"Copied!":"Share"})]})]}),a.jsx(nt.button,{whileTap:{scale:.8},onClick:V,disabled:S,className:`${m?"text-brand-blue":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"} transition p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full disabled:opacity-50`,title:m?"Remove from saved":"Save post",children:a.jsx(aW,{size:18,fill:m?"currentColor":"none"})})]}),a.jsx(yr,{children:l&&a.jsx(nt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:a.jsx(zke,{post:t,currentUser:e,currentUserData:n,blockedUsers:[],onCountChange:h})})})]})}const gl=()=>{const[t,e]=N.useState(!1),[n,r]=N.useState(null);return{uploadMedia:async(i,o)=>{if(!i)return null;e(!0),r(null);try{const c=`${Date.now()}_${i.name.replace(/[^a-zA-Z0-9.]/g,"_")}`,d=`${o}/${c}`,h=Uz(oW,d),m=await Bz(h,i),p=await zz(m.ref);return e(!1),{url:p,type:i.type.startsWith("video/")?"video":i.type.startsWith("audio/")?"audio":"image",name:i.name}}catch(l){return console.error("Upload failed:",l),r(l),e(!1),null}},uploading:t,error:n}};function Mq({text:t,onRemove:e}){return a.jsxs("span",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-700 text-sm px-2 py-1 rounded-full text-gray-700 dark:text-gray-300",children:[t,a.jsx(_t,{size:12,className:"cursor-pointer hover:text-red-500",onClick:e})]})}function BR({label:t,fieldKey:e,options:n,initialValues:r,onChange:s}){const[i,o]=N.useState(""),[l,c]=N.useState(r||[]);N.useEffect(()=>{c(r||[])},[r]);const d=()=>{if(i&&!l.includes(i)){const m=[...l,i];c(m),s(e,m),o("")}},h=m=>{const p=l.filter(v=>v!==m);c(p),s(e,p)};return a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:t}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsxs("select",{className:"flex-1 p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:i,onChange:m=>o(m.target.value),children:[a.jsx("option",{value:"",children:"Select..."}),n.map(m=>a.jsx("option",{value:m,children:m},m))]}),a.jsx("button",{type:"button",onClick:d,className:"bg-brand-blue text-white px-3 rounded-lg text-sm",children:"Add"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(m=>a.jsx(Mq,{text:m,onRemove:()=>h(m)},m))})]})}function Gke({label:t,fieldKey:e,data:n,initialValues:r,onChange:s}){const[i,o]=N.useState(""),[l,c]=N.useState(""),[d,h]=N.useState(r||[]);N.useEffect(()=>{h(r||[])},[r]);const m=n[i]||[],p=()=>{const x=i&&l?`${i} - ${l}`:"";if(x&&!d.includes(x)){const b=[...d,x];h(b),s(e,b),c("")}},v=x=>{const b=d.filter(E=>E!==x);h(b),s(e,b)};return a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:t}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsxs("select",{className:"w-1/3 p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:i,onChange:x=>{o(x.target.value),c("")},children:[a.jsx("option",{value:"",children:"Category..."}),Object.keys(n).map(x=>a.jsx("option",{value:x,children:x},x))]}),a.jsxs("select",{className:"w-1/3 p-2 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:l,onChange:x=>c(x.target.value),disabled:!i,children:[a.jsx("option",{value:"",children:"Select..."}),m.map(x=>a.jsx("option",{value:x,children:x},x))]}),a.jsx("button",{type:"button",onClick:p,className:"bg-brand-blue text-white px-3 rounded-lg text-sm",children:"Add"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(x=>a.jsx(Mq,{text:x,onRemove:()=>v(x)},x))})]})}function Kke({user:t,userData:e,onPost:n}){const[r,s]=N.useState(""),[i,o]=N.useState([]),[l,c]=N.useState(!1),[d,h]=N.useState([]),[m,p]=N.useState(null),[v,x]=N.useState(!1),{uploadMedia:b}=gl(),E=(S,T)=>{if(S.target.files&&S.target.files[0]){const P=S.target.files[0],j=URL.createObjectURL(P);o([...i,{file:P,type:T,previewUrl:j}])}},k=S=>{o(i.filter((T,P)=>P!==S))},_=async()=>{if(!(!r.trim()&&i.length===0)){x(!0);try{const S=await Promise.all(i.map(async j=>{const R=j.type==="video"?"postVideos":j.type==="audio"?"postAudio":"postImages",I=`artifacts/${t.uid}/${R}`,O=await b(j.file,I);return O?{...O,type:j.type}:null}));let T=null;if(m){const j=await b(m,`artifacts/${t.uid}/postPresets`);T=j==null?void 0:j.url}const P={text:r,attachments:S.filter(j=>j!==null),seshFx:l&&(d.length>0||T)?{plugins:d,presetUrl:T,presetName:m?m.name:null}:null};await n(P),s(""),o([]),c(!1),h([]),p(null)}catch(S){console.error("Error creating post:",S),alert("Failed to create post. Please try again.")}finally{x(!1)}}};return a.jsx("div",{className:"bg-white dark:bg-dark-card p-4 rounded-xl border dark:border-gray-700 shadow-sm mb-6",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden shrink-0",children:e!=null&&e.photoURL?a.jsx("img",{src:e.photoURL,className:"h-full w-full object-cover"}):a.jsx("div",{className:"h-full w-full bg-brand-blue"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("textarea",{className:"w-full bg-transparent outline-none text-gray-900 dark:text-white placeholder-gray-500 min-h-[80px] resize-none",placeholder:"What's creating sound today? (#tags @mentions)",value:r,onChange:S=>s(S.target.value)}),i.length>0&&a.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:i.map((S,T)=>a.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-black/5 border dark:border-gray-600 aspect-video group flex items-center justify-center",children:[S.type==="image"&&a.jsx("img",{src:S.previewUrl,className:"h-full w-full object-cover"}),S.type==="video"&&a.jsx("video",{src:S.previewUrl,className:"h-full w-full object-cover"}),S.type==="audio"&&a.jsxs("div",{className:"flex flex-col items-center justify-center text-brand-blue bg-gray-100 dark:bg-gray-800 w-full h-full",children:[a.jsx(ta,{size:32}),a.jsx("span",{className:"text-xs text-gray-500 mt-2 truncate max-w-[90%] px-2",children:S.file.name})]}),a.jsx("button",{onClick:()=>k(T),className:"absolute top-1 right-1 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition hover:bg-red-500",children:a.jsx(_t,{size:12})})]},T))}),l&&a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg mb-3 border border-blue-100 dark:border-blue-800/50 animate-in slide-in-from-top-2",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-xs font-bold text-brand-blue uppercase",children:"SeshFx Data"}),a.jsx("button",{onClick:()=>c(!1),children:a.jsx(_t,{size:14,className:"text-gray-400 hover:text-brand-blue"})})]}),a.jsx(BR,{label:"",options:ike,initialValues:d,onChange:(S,T)=>h(T)}),a.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[a.jsx(xW,{size:14,className:"text-gray-400"}),a.jsx("input",{type:"file",className:"text-xs text-gray-500 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-xs file:bg-white dark:file:bg-gray-700 dark:file:text-white",onChange:S=>p(S.target.files[0])})]})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t dark:border-gray-700",children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsxs("label",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-brand-blue cursor-pointer transition",title:"Add Image",children:[a.jsx(cw,{size:20}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:S=>E(S,"image")})]}),a.jsxs("label",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-green-500 cursor-pointer transition",title:"Add Video",children:[a.jsx(Qd,{size:20}),a.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:S=>E(S,"video")})]}),a.jsxs("label",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-purple-500 cursor-pointer transition",title:"Add Audio Track",children:[a.jsx(ta,{size:20}),a.jsx("input",{type:"file",className:"hidden",accept:"audio/*",onChange:S=>E(S,"audio")})]}),a.jsx("button",{onClick:()=>c(!l),className:`p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition ${l?"bg-blue-50 dark:bg-blue-900/20 text-brand-blue":"text-gray-400"}`,title:"Add Plugin Data",children:a.jsx(hx,{size:20})})]}),a.jsx("button",{onClick:_,disabled:v||!r&&i.length===0,className:"bg-brand-blue text-white px-5 py-1.5 rounded-full font-bold text-sm hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition",children:v?a.jsx(rt,{className:"animate-spin",size:16}):a.jsxs(a.Fragment,{children:["Post ",a.jsx(b1,{size:14})]})})]})]})]})})}const sV=["Spam or commercial solicitation","Harassment or bullying","Hate speech","Nudity or sexual activity","Violence or dangerous organizations","Copyright / Intellectual Property Violation","Scam or fraud","Other"],Qke=async({contentId:t,contentType:e,contentSummary:n,reporterId:r,reporterName:s,reason:i,description:o="",schoolId:l=null,isFacultyAction:c=!1})=>{try{if(await hn(Re(Z,`artifacts/${Ge}/moderation_queue`),{type:"Report",status:"Open",priority:c?"High":"Normal",targetId:t,targetType:e,targetSummary:n||"No preview available",reporterId:r,reporterName:s,reason:i,description:o,schoolId:l,timestamp:zt()}),c&&(e==="post"||e==="comment")){const d=e==="post"?`artifacts/${Ge}/public/data/posts`:`artifacts/${Ge}/public/data/comments`;await Nt(Se(Z,d,t),{visibility:"Hidden",moderationStatus:"Flagged",flaggedBy:r,flaggedAt:zt()})}return{success:!0}}catch(d){return console.error("Reporting failed:",d),{success:!1,error:d}}};function Oq({user:t,target:e,onClose:n}){const[r,s]=N.useState(sV[0]),[i,o]=N.useState(""),[l,c]=N.useState(!1),[d,h]=N.useState(!1),m=async()=>{if(!(!r||!(t!=null&&t.uid))){c(!0);try{(await Qke({contentId:e.id,contentType:e.type,contentSummary:e.summary,reporterId:t.uid,reporterName:t.displayName||"Anonymous User",reason:r,description:i})).success?(h(!0),setTimeout(n,2e3)):alert("Failed to submit report. Please try again.")}catch(p){console.error("Submission error:",p),alert("An unexpected error occurred during submission.")}c(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:a.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-lg animate-in fade-in zoom-in-95 duration-200",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("h3",{className:"font-bold text-xl dark:text-white flex items-center gap-2 text-red-500",children:[a.jsx(Sd,{size:24})," Report Violation"]}),a.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-800 dark:text-gray-400 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 mb-6",children:["You are reporting a violation regarding: ",a.jsx("strong",{className:"font-bold",children:e.summary})," (",e.type,")"]}),d?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(pm,{size:48,className:"text-green-500 mx-auto mb-4"}),a.jsx("h4",{className:"font-bold text-lg dark:text-white",children:"Report Submitted!"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for helping keep the community safe. We will review this shortly."})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Reason for Report"}),a.jsx("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:r,onChange:p=>s(p.target.value),children:sV.map(p=>a.jsx("option",{value:p,children:p},p))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Additional Details (Optional)"}),a.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm resize-none",rows:"3",placeholder:"Provide any further context or relevant details.",value:i,onChange:p=>o(p.target.value)})]}),a.jsx("button",{onClick:m,disabled:l,className:"w-full bg-red-600 text-white py-3 rounded-xl font-bold hover:bg-red-700 transition disabled:opacity-50 flex items-center justify-center gap-2 shadow-md",children:l?a.jsx(rt,{className:"animate-spin",size:18}):a.jsxs(a.Fragment,{children:[a.jsx(pm,{size:18})," Submit Report"]})})]})]})})})}function Dq(t,e){const[n,r]=N.useState([]),[s,i]=N.useState([]),[o,l]=N.useState({followersCount:0,followingCount:0}),[c,d]=N.useState(!0);N.useEffect(()=>{if(!t){d(!1);return}const E=Re(Z,Ve(t).following),k=Re(Z,Ve(t).followers),_=Se(Z,Ve(t).socialStats),S=pn(Et(E,Wn("timestamp","desc")),j=>{const R=j.docs.map(I=>({odId:I.id,...I.data()}));r(R)},j=>console.error("Following listener error:",j)),T=pn(Et(k,Wn("timestamp","desc")),j=>{const R=j.docs.map(I=>({odId:I.id,...I.data()}));i(R)},j=>console.error("Followers listener error:",j)),P=pn(_,j=>{j.exists()&&l(j.data()),d(!1)});return()=>{S(),T(),P()}},[t]);const h=N.useCallback(E=>n.some(k=>k.odId===E),[n]),m=N.useCallback(async(E,k)=>{if(!t||!E||t===E)return;const _=T_(Z),S=Se(Z,Ve(t).following,E);_.set(S,{displayName:(k==null?void 0:k.displayName)||(k==null?void 0:k.firstName)||"User",photoURL:(k==null?void 0:k.photoURL)||null,role:(k==null?void 0:k.activeProfileRole)||"User",timestamp:zt()});const T=Se(Z,Ve(E).followers,t);_.set(T,{displayName:(e==null?void 0:e.displayName)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim()||"User",photoURL:(e==null?void 0:e.photoURL)||null,role:(e==null?void 0:e.activeProfileRole)||"User",timestamp:zt()});const P=Se(Z,Ve(t).socialStats);_.set(P,{followingCount:ho(1)},{merge:!0});const j=Se(Z,Ve(E).socialStats);_.set(j,{followersCount:ho(1)},{merge:!0});const R=Se(Re(Z,Ve(E).notifications));_.set(R,{type:"follow",fromUserId:t,fromUserName:(e==null?void 0:e.displayName)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim()||"Someone",fromUserPhoto:(e==null?void 0:e.photoURL)||null,message:"started following you",read:!1,timestamp:zt()});try{return await _.commit(),{success:!0}}catch(I){return console.error("Follow error:",I),{success:!1,error:I}}},[t,e]),p=N.useCallback(async E=>{if(!t||!E)return;const k=T_(Z),_=Se(Z,Ve(t).following,E);k.delete(_);const S=Se(Z,Ve(E).followers,t);k.delete(S);const T=Se(Z,Ve(t).socialStats);k.set(T,{followingCount:ho(-1)},{merge:!0});const P=Se(Z,Ve(E).socialStats);k.set(P,{followersCount:ho(-1)},{merge:!0});try{return await k.commit(),{success:!0}}catch(j){return console.error("Unfollow error:",j),{success:!1,error:j}}},[t]),v=N.useCallback(async(E,k)=>h(E)?p(E):m(E,k),[h,m,p]),x=N.useCallback(async E=>{try{const k=await uo(Se(Z,Ve(E).socialStats));return k.exists()?k.data():{followersCount:0,followingCount:0}}catch(k){return console.error("Get stats error:",k),{followersCount:0,followingCount:0}}},[]),b=N.useCallback(()=>n.map(E=>E.odId),[n]);return{following:n,followers:s,stats:o,loading:c,isFollowing:h,followUser:m,unfollowUser:p,toggleFollow:v,getUserStats:x,getFollowingIds:b}}function Zke(t){const[e,n]=N.useState({followersCount:0,followingCount:0}),[r,s]=N.useState(!0);return N.useEffect(()=>{if(!t){s(!1);return}const i=Se(Z,Ve(t).socialStats),o=pn(i,l=>{l.exists()&&n(l.data()),s(!1)});return()=>o()},[t]),{stats:e,loading:r}}const ni={FOR_YOU:"for_you",FOLLOWING:"following"};function Yke({user:t,userData:e,openPublicProfile:n}){const[r,s]=N.useState([]),[i,o]=N.useState(!0),[l,c]=N.useState(null),[d,h]=N.useState(ni.FOR_YOU),[m,p]=N.useState([]),[v,x]=N.useState(!1),{following:b,stats:E,loading:k,isFollowing:_,toggleFollow:S,getFollowingIds:T}=Dq(t==null?void 0:t.uid,e),P=N.useMemo(()=>T(),[b]);N.useEffect(()=>{d===ni.FOLLOWING&&P.length===0&&(t!=null&&t.uid)&&j()},[d,P.length,t==null?void 0:t.uid]);const j=async()=>{x(!0);try{const D=Et(Re(Z,`artifacts/${Ge}/public/data/posts`),Wn("timestamp","desc"),Qs(20)),F=await Kt(D),V=new Map;F.docs.forEach($=>{const J=$.data();J.userId!==(t==null?void 0:t.uid)&&!V.has(J.userId)&&V.set(J.userId,{userId:J.userId,displayName:J.displayName,photoURL:J.authorPhoto,role:J.role})}),p(Array.from(V.values()).slice(0,5))}catch(D){console.error("Error loading suggestions:",D)}x(!1)};N.useEffect(()=>{o(!0);const D=`artifacts/${Ge}/public/data/posts`;let F;d===ni.FOLLOWING&&P.length>0?F=Et(Re(Z,D),Wn("timestamp","desc"),Qs(50)):F=Et(Re(Z,D),Wn("timestamp","desc"),Qs(20));const V=pn(F,$=>{let J=$.docs.map(ue=>({id:ue.id,...ue.data()}));d===ni.FOLLOWING&&P.length>0&&(J=J.filter(ue=>P.includes(ue.userId)||ue.userId===(t==null?void 0:t.uid))),s(J),o(!1)},$=>{console.error("Feed error:",$),o(!1)});return()=>V()},[d,P,t==null?void 0:t.uid]);const R=async D=>{if(t)try{await hn(Re(Z,`artifacts/${Ge}/public/data/posts`),{...D,userId:t.uid,displayName:(e==null?void 0:e.effectiveDisplayName)||`${(e==null?void 0:e.firstName)||"User"} ${(e==null?void 0:e.lastName)||""}`.trim(),authorPhoto:(e==null?void 0:e.photoURL)||null,role:(e==null?void 0:e.activeProfileRole)||"User",timestamp:zt(),reactions:{},reactionCount:0,commentCount:0,saveCount:0,visibility:"Public"})}catch(F){console.error("Failed to post:",F),alert("Could not post update. Please try again.")}},I={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.08}}},O=({suggestedUser:D})=>a.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-between p-3 bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 hover:border-brand-blue/30 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3 cursor-pointer flex-1 min-w-0",onClick:()=>n==null?void 0:n(D.userId),children:[a.jsx(ra,{src:D.photoURL,name:D.displayName,size:"md"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h4",{className:"font-bold text-sm dark:text-white truncate hover:text-brand-blue transition",children:D.displayName}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:D.role})]})]}),a.jsx($R,{isFollowing:_(D.userId),onToggle:()=>S(D.userId,D),size:"sm",variant:"default"})]});return a.jsxs("div",{className:"max-w-2xl mx-auto pb-20",children:[a.jsx(Kke,{user:t,userData:e,onPost:R}),a.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-white dark:bg-dark-card p-1.5 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("button",{onClick:()=>h(ni.FOR_YOU),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold transition-all ${d===ni.FOR_YOU?"bg-brand-blue text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[a.jsx(Aye,{size:16}),a.jsx("span",{children:"For You"})]}),a.jsxs("button",{onClick:()=>h(ni.FOLLOWING),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold transition-all ${d===ni.FOLLOWING?"bg-brand-blue text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[a.jsx(Rs,{size:16}),a.jsx("span",{children:"Following"}),E.followingCount>0&&a.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d===ni.FOLLOWING?"bg-white/20":"bg-gray-200 dark:bg-gray-700"}`,children:E.followingCount})]})]}),i||k?a.jsx("div",{className:"flex justify-center py-10",children:a.jsx(rt,{className:"animate-spin text-brand-blue",size:32})}):a.jsxs(a.Fragment,{children:[d===ni.FOLLOWING&&P.length===0&&a.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-2xl p-6 mb-6 border border-blue-100 dark:border-blue-800/30",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-brand-blue/10 flex items-center justify-center",children:a.jsx(nu,{size:28,className:"text-brand-blue"})}),a.jsx("h3",{className:"text-lg font-bold dark:text-white mb-2",children:"Start following creators"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-sm mx-auto",children:"Follow artists, engineers, and studios to see their posts in your Following feed."})]}),v?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(rt,{className:"animate-spin text-brand-blue",size:24})}):m.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3",children:"Suggested for you"}),m.map(D=>a.jsx(O,{suggestedUser:D},D.userId))]})]}),a.jsxs(nt.div,{variants:I,initial:"hidden",animate:"show",className:"space-y-4",children:[a.jsx(yr,{mode:"popLayout",children:r.map(D=>a.jsx(qke,{post:D,currentUser:t,currentUserData:e,openPublicProfile:n||(()=>{}),onReport:()=>c(D),isFollowingAuthor:_(D.userId),onToggleFollow:()=>S(D.userId,{displayName:D.displayName,photoURL:D.authorPhoto,role:D.role})},D.id))}),r.length===0&&d===ni.FOR_YOU&&a.jsxs(nt.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-10 text-gray-500",children:[a.jsx(uw,{className:"mx-auto mb-2 opacity-50",size:32}),a.jsx("p",{children:"No posts yet. Be the first to share something!"})]}),r.length===0&&d===ni.FOLLOWING&&P.length>0&&a.jsxs(nt.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-10 text-gray-500",children:[a.jsx(Rs,{className:"mx-auto mb-2 opacity-50",size:32}),a.jsx("p",{children:"No recent posts from people you follow."}),a.jsx("button",{onClick:()=>h(ni.FOR_YOU),className:"mt-3 text-brand-blue hover:underline text-sm font-medium",children:"Browse For You feed "})]})]})]}),l&&a.jsx(Oq,{user:t,target:{id:l.id,type:"Post",summary:l.text?l.text.substring(0,50):"Media Post"},onClose:()=>c(null)})]})}function Vq({initialZip:t="",onLocationChange:e,showMap:n=!1,label:r="Location"}){const[s,i]=N.useState(t),[o,l]=N.useState(""),[c,d]=N.useState(!1),[h,m]=N.useState(null);N.useEffect(()=>{t&&t!==s&&(i(t),p(t))},[t]);const p=async x=>{const b=x.replace(/\D/g,"").slice(0,5);if(i(b),b.length===5){d(!0);const E=await L1(b);E?(l(E.cityState),m({lat:E.lat,lng:E.lng}),e({zip:b,...E})):(l("Unknown Location"),e({zip:b,valid:!1})),d(!1)}else l("")},v=()=>{if(!navigator.geolocation)return alert("Geolocation not supported");d(!0),navigator.geolocation.getCurrentPosition(async x=>{const{latitude:b,longitude:E}=x.coords;try{const S=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${b}&lon=${E}`)).json()).address.postcode;if(S){const T=S.split("-")[0];i(T),p(T)}else m({lat:b,lng:E}),l("Current Location"),e({lat:b,lng:E,name:"Current Location",valid:!0})}catch(k){console.error(k),alert("Failed to determine location.")}d(!1)},x=>{console.warn(x),alert("Location access denied."),d(!1)})};return a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:r}),a.jsxs("div",{className:"relative flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx("input",{className:"w-full pl-9 p-2.5 bg-white dark:bg-[#1f2128] border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-brand-blue outline-none dark:text-white transition-all text-sm",placeholder:"Zip Code",maxLength:5,value:s,onChange:x=>p(x.target.value)}),a.jsx(Br,{className:`absolute left-3 top-3 text-gray-400 ${c?"animate-pulse":""}`,size:16})]}),a.jsx("button",{onClick:v,disabled:c,className:"p-2.5 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 text-brand-blue transition-colors",title:"Use my location",children:c?a.jsx(rt,{size:18,className:"animate-spin"}):a.jsx(hW,{size:18})})]}),o&&a.jsxs("div",{className:"mt-1.5 text-xs font-medium text-gray-500 dark:text-gray-400 flex items-center gap-1 animate-in fade-in",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),o]})]})}const Xke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",Jke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let e1e=Eq.icon({iconUrl:Xke,shadowUrl:Jke,iconSize:[25,41],iconAnchor:[12,41]});Eq.Marker.prototype.options.icon=e1e;function t1e({center:t,zoom:e}){const n=Cq();return N.useEffect(()=>{n.setView(t,e)},[t,e,n]),null}function Fq({locations:t=[],center:e=[34.0522,-118.2437],zoom:n=10,height:r="400px",drawRadius:s=!1,radiusMiles:i=0}){const o=t.filter(c=>c.lat&&c.lng&&(!c.hideAddress||c.forceReveal)),l=i*1609.34;return a.jsx("div",{className:"rounded-xl overflow-hidden shadow-inner border dark:border-gray-700 relative z-0",style:{height:r,width:"100%"},children:a.jsxs(Iq,{center:e,zoom:n,style:{height:"100%",width:"100%"},scrollWheelZoom:!1,children:[a.jsx(jq,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),a.jsx(t1e,{center:e,zoom:n}),s&&i>0&&a.jsx(Ab,{center:e,pathOptions:{fillColor:"#3D84ED",color:"#3D84ED",fillOpacity:.2},radius:l}),o.map(c=>a.jsx(wke,{position:[c.lat,c.lng],children:a.jsx(kke,{children:a.jsxs("div",{className:"text-sm",children:[a.jsx("strong",{className:"block mb-1",children:c.name}),a.jsx("span",{className:"text-xs text-gray-500",children:c.address||"Location Hidden"})]})})},c.id))]})})}function iV(t,e,n,r){const i=(n-t)*(Math.PI/180),o=(r-e)*(Math.PI/180),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(t*(Math.PI/180))*Math.cos(n*(Math.PI/180))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))*.621371}function n1e({userData:t,sessionParams:e,setSessionParams:n,onNext:r}){var v,x;const[s,i]=N.useState(1),[o,l]=N.useState(!1),[c,d]=N.useState([]),h=b=>{b.preventDefault(),i(2),m()},m=async()=>{l(!0);try{const b=Et(gd(Z,"public_profile"),nn("accountTypes","array-contains","Studio")),_=(await Kt(b)).docs.map(S=>({id:S.ref.parent.parent.id,...S.data()})).filter(S=>!S.location||!e.location?!1:iV(e.location.lat,e.location.lng,S.location.lat,S.location.lng)<=e.radius).map(S=>({...S,distance:iV(e.location.lat,e.location.lng,S.location.lat,S.location.lng)})).sort((S,T)=>S.distance-T.distance);d(_)}catch(b){console.error("Studio fetch error:",b)}l(!1)},p=b=>{n(E=>({...E,venue:b})),r()};return a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 shadow-sm overflow-hidden min-h-[600px]",children:[a.jsxs("div",{className:"p-6 border-b dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:[a.jsxs("h2",{className:"text-xl font-extrabold dark:text-white flex items-center gap-2",children:[a.jsx("span",{className:"bg-brand-blue text-white w-8 h-8 rounded-full flex items-center justify-center text-sm",children:s}),s===1?"Session Logistics":"Select Studio"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1 ml-10",children:s===1?"Define the when and where.":`Found ${c.length} studios within range.`})]}),s===1&&a.jsxs("form",{onSubmit:h,className:"p-8 space-y-6 max-w-2xl mx-auto",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:[a.jsx(qo,{size:14,className:"inline mr-1"})," Date"]}),a.jsx("input",{type:"date",required:!0,className:"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-brand-blue",value:e.date,onChange:b=>n({...e,date:b.target.value})})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:[a.jsx(Ms,{size:14,className:"inline mr-1"})," Start Time"]}),a.jsx("input",{type:"time",required:!0,className:"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-brand-blue",value:e.time,onChange:b=>n({...e,time:b.target.value})})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(Vq,{initialZip:t==null?void 0:t.zip,label:"Center Location",onLocationChange:b=>n({...e,location:b})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Max Distance"}),a.jsxs("span",{className:"text-xs font-bold text-brand-blue",children:[e.radius," miles"]})]}),a.jsx("input",{type:"range",min:"5",max:"100",step:"5",value:e.radius,onChange:b=>n({...e,radius:parseInt(b.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-brand-blue"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:[a.jsx(pl,{size:14,className:"inline mr-1"})," Urgency"]}),a.jsx("div",{className:"flex gap-2",children:["Low","Normal","High"].map(b=>a.jsx("button",{type:"button",onClick:()=>n({...e,urgency:b}),className:`flex-1 py-2 rounded-lg text-sm font-bold border transition ${e.urgency===b?"bg-brand-blue text-white border-brand-blue":"border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:b},b))})]})]}),a.jsx("div",{className:"pt-6",children:a.jsxs("button",{type:"submit",className:"w-full bg-brand-blue text-white py-4 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex justify-center items-center gap-2",children:["Find Studios ",a.jsx(ea,{size:20})]})})]}),s===2&&a.jsx("div",{className:"flex flex-col h-[600px]",children:o?a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[a.jsx(rt,{className:"animate-spin text-brand-blue mb-4",size:40}),a.jsx("p",{className:"text-gray-500",children:"Scouting locations..."})]}):a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsxs("div",{className:"w-full md:w-1/2 overflow-y-auto p-4 space-y-3",children:[a.jsx("button",{onClick:()=>i(1),className:"text-xs text-gray-500 hover:text-brand-blue mb-2 flex items-center gap-1",children:" Change Filters"}),a.jsxs("div",{onClick:()=>p({id:"remote",name:"Remote / TBD",address:"No physical location set"}),className:"p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer text-center",children:[a.jsx("h4",{className:"font-bold text-gray-600 dark:text-gray-300",children:"No Studio Needed / Remote"}),a.jsx("p",{className:"text-xs text-gray-400",children:"Skip venue selection"})]}),c.map(b=>a.jsxs("div",{onClick:()=>p(b),className:"bg-white dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-700 hover:border-brand-blue dark:hover:border-blue-500 cursor-pointer transition shadow-sm group",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("h4",{className:"font-bold dark:text-white group-hover:text-brand-blue",children:b.name||"Studio"}),a.jsxs("span",{className:"text-xs font-mono bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-600 dark:text-gray-300",children:["$",b.rate,"/hr"]})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[a.jsx(Br,{size:10})," ",b.distance.toFixed(1)," miles away"]}),a.jsx("div",{className:"flex gap-1 mt-2",children:(b.equipmentList||[]).slice(0,3).map(E=>a.jsx("span",{className:"text-[10px] bg-blue-50 dark:bg-blue-900/20 text-blue-600 px-1.5 py-0.5 rounded",children:E},E))})]},b.id))]}),a.jsx("div",{className:"hidden md:block w-1/2 h-full border-l dark:border-gray-700 relative",children:a.jsx(Fq,{locations:c,center:[(v=e.location)==null?void 0:v.lat,(x=e.location)==null?void 0:x.lng],height:"100%",drawRadius:!0,radiusMiles:e.radius})})]})})]})}function oV({user:t,userData:e,openPublicProfile:n,onAddToCart:r,sessionCartIds:s=[],onBook:i,mode:o="direct"}){const[l,c]=N.useState(""),[d,h]=N.useState([]),[m,p]=N.useState(!1),[v,x]=N.useState("list"),[b,E]=N.useState(!0),[k,_]=N.useState({role:"All",minRate:0,maxRate:500}),S=async()=>{p(!0);try{const T=gd(Z,Ve().publicProfileCollectionGroup),P=[];k.role!=="All"&&P.push(nn("accountTypes","array-contains",k.role)),P.push(Qs(50));const j=Et(T,...P);let I=(await Kt(j)).docs.map(O=>{const D=O.data();return{id:D.uid||O.ref.parent.parent.id,...D}}).filter(O=>O.id!==t.uid);if(l){const O=l.toLowerCase();I=I.filter(D=>{var F,V,$;return((F=D.firstName)==null?void 0:F.toLowerCase().includes(O))||((V=D.lastName)==null?void 0:V.toLowerCase().includes(O))||(($=D.searchTerms)==null?void 0:$.includes(O))})}h(I)}catch(T){console.error("Search failed:",T)}p(!1)};return a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-full",children:[a.jsx("div",{className:`lg:col-span-3 space-y-4 ${b?"block":"hidden lg:block"}`,children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm h-fit sticky top-4",children:[a.jsx("div",{className:"flex justify-between items-center mb-2",children:a.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[a.jsx(ZA,{size:18})," Filters"]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Profile Type"}),a.jsxs("select",{className:"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:k.role,onChange:T=>_({...k,role:T.target.value}),children:[a.jsx("option",{value:"All",children:"All Profiles"}),a.jsx("option",{value:"Musician",children:"Musician"}),a.jsx("option",{value:"Producer",children:"Producer"}),a.jsx("option",{value:"Engineer",children:"Audio Engineer"})]})]}),a.jsx("button",{onClick:S,className:"w-full bg-brand-blue text-white py-2 rounded-lg text-sm font-bold hover:bg-blue-600 transition",children:"Update Results"})]})]})}),a.jsxs("div",{className:"lg:col-span-9 space-y-4",children:[a.jsx("div",{className:"bg-white dark:bg-[#2c2e36] p-3 rounded-xl border dark:border-gray-700 flex gap-3 items-center shadow-sm",children:a.jsxs("div",{className:"relative flex-1 w-full",children:[a.jsx(Ur,{className:"absolute left-3 top-3 text-gray-400",size:18}),a.jsx("input",{className:"w-full pl-10 p-2.5 bg-gray-50 dark:bg-[#1f2128] border-transparent focus:bg-white dark:focus:bg-black focus:border-brand-blue border rounded-lg dark:text-white transition-all outline-none",placeholder:"Search talent...",value:l,onChange:T=>c(T.target.value),onKeyDown:T=>T.key==="Enter"&&S()})]})}),a.jsx("div",{className:"min-h-[400px]",children:m?a.jsx("div",{className:"text-center py-10 text-gray-500",children:"Searching..."}):d.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(T=>{var j;const P=s.includes(T.id);return a.jsxs("div",{className:`bg-white dark:bg-[#2c2e36] p-4 rounded-xl border flex flex-col transition ${P?"border-brand-blue ring-1 ring-brand-blue bg-blue-50 dark:bg-blue-900/10":"dark:border-gray-700 hover:border-gray-400"}`,children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 cursor-pointer",onClick:()=>n(T.id,T.firstName),children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center font-bold",children:(j=T.firstName)==null?void 0:j[0]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold dark:text-white",children:[T.firstName," ",T.lastName]}),a.jsxs("p",{className:"text-xs text-gray-500",children:[T.accountTypes[0],"  $",T.rate||"?","/hr"]})]})]}),o==="planner"&&a.jsx("button",{onClick:()=>!P&&r(T),disabled:P,className:`mt-auto w-full py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 ${P?"bg-green-100 text-green-700 cursor-default":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-white hover:bg-brand-blue hover:text-white transition"}`,children:P?a.jsxs(a.Fragment,{children:[a.jsx(Bi,{size:14})," Added to Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(Zs,{size:14})," Add to Session"]})}),o==="direct"&&a.jsxs("button",{onClick:()=>i(T),className:"mt-auto w-full py-2 rounded-lg text-xs font-bold bg-brand-blue text-white hover:bg-blue-600 transition flex items-center justify-center gap-2",children:[a.jsx(qo,{size:14})," Book Now"]})]},T.id)})}):a.jsx("div",{className:"text-center py-20 text-gray-400",children:"Try adjusting filters to find talent."})})]})]})}function r1e({user:t,userData:e,broadcast:n,onClose:r}){const[s,i]=N.useState(Math.floor(n.offerAmount/(n.duration||1))),[o,l]=N.useState(""),[c,d]=N.useState(!1),h=s*(n.duration||1),m=n.offerAmount,p=h>m,v=async()=>{if(!s||!o)return alert("Please enter a rate and a message.");if(p)return alert("Your bid exceeds the client's budget.");d(!0);try{const x={type:"Bid",broadcastId:n.id,targetId:n.senderId,targetName:n.senderName,senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,serviceType:`Bid: ${n.serviceType||"Session"}`,offerAmount:h,ratePerHour:parseInt(s),message:o,status:"Pending",date:"Flexible",timestamp:zt()};await hn(Re(Z,`artifacts/${Ge}/public/data/bookings`),x),alert("Bid submitted successfully! The client has been notified."),r()}catch(x){console.error("Error submitting bid:",x),alert("Failed to submit bid.")}d(!1)};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md animate-in zoom-in-95",children:[a.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center",children:[a.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Place Your Bid"}),a.jsx("button",{onClick:r,children:a.jsx(_t,{size:20,className:"text-gray-500 hover:text-white"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800",children:[a.jsx("div",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 uppercase mb-1",children:"Client's Budget"}),a.jsxs("div",{className:"text-2xl font-extrabold dark:text-white",children:["$",m," ",a.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["Total (",n.duration," hrs)"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Your Hourly Rate ($)"}),a.jsxs("div",{className:"relative",children:[a.jsx(ui,{size:16,className:"absolute left-3 top-3.5 text-gray-400"}),a.jsx("input",{type:"number",className:`w-full pl-8 p-3 border rounded-xl font-bold text-lg outline-none dark:bg-[#1f2128] dark:text-white ${p?"border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-brand-blue"}`,value:s,onChange:x=>i(x.target.value)})]}),a.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Total Bid:"}),a.jsxs("span",{className:`font-bold ${p?"text-red-500":"text-green-600"}`,children:["$",h]})]}),p&&a.jsxs("div",{className:"text-xs text-red-500 mt-1 flex items-center gap-1",children:[a.jsx(pl,{size:12})," Bid exceeds budget. Consider lowering your rate."]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Message to Client"}),a.jsx("textarea",{className:"w-full p-3 border rounded-xl text-sm dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none resize-none",rows:"3",placeholder:"Introduce yourself and your gear...",value:o,onChange:x=>l(x.target.value)})]}),a.jsx("button",{onClick:v,disabled:c||p,className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:shadow-none",children:c?a.jsx(rt,{className:"animate-spin"}):"Submit Proposal"})]})]})})}function aV(t,e,n,r){var s=6371,i=zv(n-t),o=zv(r-e),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(zv(t))*Math.cos(zv(n))*Math.sin(o/2)*Math.sin(o/2),c=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return s*c*.621371}function zv(t){return t*(Math.PI/180)}function s1e({user:t,userData:e,onBid:n}){const[r,s]=N.useState([]),[i,o]=N.useState([]),[l,c]=N.useState(null),[d,h]=N.useState(null),[m,p]=N.useState(50);N.useEffect(()=>{(async()=>{if(e!=null&&e.zip){const b=await L1(e.zip);b&&h({lat:b.lat,lng:b.lng})}else navigator.geolocation&&navigator.geolocation.getCurrentPosition(b=>h({lat:b.coords.latitude,lng:b.coords.longitude}))})()},[e]),N.useEffect(()=>{const x=Et(Re(Z,`artifacts/${Ge}/public/data/bookings`),nn("type","==","Broadcast"),nn("status","==","Broadcasting"),Wn("timestamp","desc")),b=pn(x,E=>{s(E.docs.map(k=>({id:k.id,...k.data()})))});return()=>b()},[]),N.useEffect(()=>{if(!d){o(r);return}const x=r.filter(b=>!b.location||!b.location.lat||!b.location.lng?!0:aV(d.lat,d.lng,b.location.lat,b.location.lng)<=m).map(b=>{const E=b.location?aV(d.lat,d.lng,b.location.lat,b.location.lng):null;return{...b,distance:E}}).sort((b,E)=>(b.distance||9999)-(E.distance||9999));o(x)},[r,d,m]);const v=async x=>{if(window.confirm("Cancel this broadcast? This will remove it from the board."))try{await Nt(Se(Z,`artifacts/${Ge}/public/data/bookings`,x),{status:"Cancelled"})}catch(b){console.error(b),alert("Failed to cancel.")}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end gap-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Ys,{className:"text-yellow-500",size:20})," Open Sessions"]}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Live opportunities near you."})]}),a.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[a.jsx(Br,{size:14,className:"ml-2 text-gray-500"}),a.jsxs("select",{className:"bg-transparent text-sm font-bold text-gray-700 dark:text-gray-300 p-1 outline-none cursor-pointer",value:m,onChange:x=>p(Number(x.target.value)),children:[a.jsx("option",{value:10,children:"Within 10 mi"}),a.jsx("option",{value:25,children:"Within 25 mi"}),a.jsx("option",{value:50,children:"Within 50 mi"}),a.jsx("option",{value:100,children:"Within 100 mi"}),a.jsx("option",{value:5e3,children:"Anywhere"})]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.length===0?a.jsx("div",{className:"col-span-full text-center py-12 bg-white dark:bg-[#2c2e36] rounded-xl border border-dashed dark:border-gray-700 text-gray-500",children:"No open sessions found."}):i.map(x=>a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm hover:shadow-md transition-all group relative overflow-hidden",children:[a.jsxs("div",{className:"absolute top-0 right-0 bg-brand-blue text-white text-[10px] font-bold px-3 py-1 rounded-bl-lg",children:["BUDGET: $",x.offerAmount||"N/A"]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 flex justify-between",children:[a.jsx("span",{children:x.serviceType}),typeof x.distance=="number"&&a.jsxs("span",{className:"text-brand-blue flex items-center gap-1",children:[a.jsx(Br,{size:10})," ",x.distance.toFixed(1)," mi"]})]}),a.jsx("h4",{className:"text-lg font-bold dark:text-white truncate pr-16",children:x.targetName||"Session Request"}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-300 mt-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Jr,{size:14})," ",x.senderName]}),x.date&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ms,{size:14})," ",x.date==="Flexible"?"Flexible":new Date(x.date).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:x.requirements&&x.requirements.slice(0,3).map((b,E)=>a.jsx("span",{className:"text-[10px] bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-600 dark:text-gray-300 border dark:border-gray-600",children:b.value},E))}),a.jsx("div",{className:"flex gap-2",children:x.senderId===t.uid?a.jsxs("button",{onClick:()=>v(x.id),className:"w-full bg-red-100 text-red-600 py-2.5 rounded-lg font-bold text-sm hover:bg-red-200 transition flex items-center justify-center gap-2",children:[a.jsx(bs,{size:16})," Cancel"]}):a.jsxs("button",{onClick:()=>c(x),className:"w-full bg-gray-900 dark:bg-white dark:text-black text-white py-2.5 rounded-lg font-bold text-sm hover:opacity-90 transition flex justify-center items-center gap-2",children:["View & Bid ",a.jsx(ea,{size:16})]})})]},x.id))}),l&&a.jsx(r1e,{user:t,userData:e,broadcast:l,onClose:()=>c(null)})]})}const lV=[{id:"computer_audio_and_interfaces",label:"Computer Audio & Interfaces"},{id:"microphones_and_input_transducers",label:"Microphones"},{id:"mixing_consoles_and_control",label:"Mixing Consoles"},{id:"monitoring_and_playback",label:"Monitoring & Playback"},{id:"outboard_signal_processing",label:"Outboard Gear"}],$q=()=>{const[t,e]=N.useState({}),[n,r]=N.useState(!0);return N.useEffect(()=>{(async()=>{r(!0);const i={};try{const o=`artifacts/${Ge}/public/data/equipment_database`;await Promise.all(lV.map(async l=>{const c=Se(Z,o,l.id),d=Re(c,"items"),h=await Kt(d),m={};h.forEach(p=>{m[p.id]=p.data()}),i[l.id]=m})),e(i)}catch(o){console.error("Failed to load equipment database:",o)}r(!1)})()},[]),{loading:n,data:t,categories:lV}};function i1e({user:t,userData:e,onBack:n,onSuccess:r}){const{loading:s,data:i,categories:o}=$q(),[l,c]=N.useState(2),d=[5,10,15,25,50,100,250,500],h=d[l],[m,p]=N.useState({lat:34.0522,lng:-118.2437,name:"Default"});N.useEffect(()=>{(async()=>{if(e!=null&&e.zip){const Be=await L1(e.zip);if(Be){p({lat:Be.lat,lng:Be.lng,name:Be.cityState});return}}navigator.geolocation&&navigator.geolocation.getCurrentPosition(Be=>{p({lat:Be.coords.latitude,lng:Be.coords.longitude,name:"Current Location"})})})()},[e]);const v=ce=>{ce.lat&&ce.lng&&p({lat:ce.lat,lng:ce.lng,name:ce.cityState||"Selected Location"})},[x,b]=N.useState("Musician"),[E,k]=N.useState("Play"),[_,S]=N.useState(""),[T,P]=N.useState(""),[j,R]=N.useState(""),[I,O]=N.useState(""),[D,F]=N.useState(""),[V,$]=N.useState(""),[J,ue]=N.useState(""),[ve,le]=N.useState("Any"),[q,Q]=N.useState("Flat Rate"),[H,X]=N.useState([{id:Date.now(),type:"General",value:""}]),oe=bw.filter(ce=>ce!=="Technician"),ae=ce=>{switch(ce){case"Musician":return["Play","Compose","Improvise"];case"Engineer":return["Mix","Master","Record","Edit"];case"Producer":return["Produce","Remix","Arrange"];case"Studio":return["Host Session","Rent Gear"];default:return["Work"]}},je=()=>X([...H,{id:Date.now(),type:"Gear",value:"",gearSelection:{}}]),ge=ce=>{H.length!==1&&X(H.filter(Be=>Be.id!==ce))},te=(ce,Be,Ye)=>X(H.map(pe=>pe.id===ce?{...pe,[Be]:Ye}:pe)),be=(ce,Be,Ye)=>{X(H.map(pe=>{if(pe.id!==ce)return pe;const bt={...pe.gearSelection,[Be]:Ye};return Be==="category"&&(delete bt.subCategory,delete bt.type,delete bt.item),Be==="subCategory"&&(delete bt.type,delete bt.item),Be==="type"&&delete bt.item,{...pe,gearSelection:bt,value:Ye}}))},Fe=async()=>{if(!j||!T)return alert("Please complete the request sentence.");if(x==="Musician"&&E==="Play"&&!_)return alert("Please select an instrument.");const ce=H.filter(Ye=>Ye.value.trim()!=="");let Be=`${x} - ${E}`;_&&(Be+=` ${_}`);try{await hn(Re(Z,`artifacts/${Ge}/public/data/bookings`),{senderId:t.uid,senderName:"Broadcast Request",targetId:"BROADCAST",targetName:j,role:x,action:E,instrument:_||null,genre:T,serviceType:Be,date:I||"Flexible",time:D||"Flexible",offerAmount:V?parseInt(V):null,references:J,experienceLevel:ve,paymentType:q,requirements:ce,message:ce.map(Ye=>`[${Ye.type}] ${Ye.value}`).join(`
`),range:h,status:"Broadcasting",type:"Broadcast",location:{lat:m.lat,lng:m.lng},timestamp:zt()}),alert(`Broadcast sent to ${x}s within ${h} miles!`),r()}catch(Ye){console.error(Ye),alert("Failed to send broadcast.")}},vt=[{label:"Gear / Equipment",value:"Gear",icon:Kd},{label:"Technique / Skill",value:"Technique",icon:Ys},{label:"Feel / Vibe",value:"Vibe",icon:ta},{label:"Logistics",value:"Logistics",icon:Ms},{label:"General Note",value:"General",icon:Qye}];return a.jsxs("div",{className:"max-w-5xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 animate-in fade-in",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg text-brand-blue",children:a.jsx(Br,{size:24})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold dark:text-white",children:"Broadcast Builder"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Reach professionals in your area."})]})]}),a.jsx("button",{onClick:n,className:"text-sm font-medium text-gray-500 hover:text-brand-blue transition",children:"Cancel & Exit"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[a.jsx("div",{className:"lg:col-span-4 space-y-5",children:a.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] p-5 rounded-2xl border dark:border-gray-700",children:[a.jsx(Vq,{initialZip:e==null?void 0:e.zip,onLocationChange:v,label:"Broadcast Center"}),a.jsxs("div",{className:"mt-4 flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-extrabold text-gray-400 uppercase tracking-wider",children:"Range"}),a.jsxs("span",{className:"bg-brand-blue text-white text-xs font-bold px-2 py-1 rounded-md",children:[h," Miles"]})]}),a.jsx("div",{className:"mb-5 rounded-xl overflow-hidden border dark:border-gray-600 shadow-md relative h-48",children:a.jsx(Fq,{center:[m.lat,m.lng],zoom:9,height:"100%",drawRadius:!0,radiusMiles:h})}),a.jsx("input",{type:"range",min:"0",max:d.length-1,value:l,onChange:ce=>c(parseInt(ce.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-brand-blue"})]})}),a.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl border-2 border-blue-100 dark:border-gray-700 shadow-sm relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-brand-blue"}),a.jsx("label",{className:"text-xs font-extrabold text-brand-blue uppercase tracking-widest mb-4 block",children:"Step 1: Core Request"}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-lg md:text-xl text-gray-700 dark:text-gray-200 leading-relaxed font-medium",children:[a.jsx("span",{children:"I need a"}),a.jsxs("div",{className:"relative inline-block",children:[a.jsx("select",{value:x,onChange:ce=>{b(ce.target.value),k(ae(ce.target.value)[0])},className:"appearance-none bg-blue-50 dark:bg-gray-700 text-blue-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-blue-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-blue-100 dark:hover:bg-gray-600 transition",children:oe.map(ce=>a.jsx("option",{value:ce,children:ce},ce))}),a.jsx(of,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-blue-500 dark:text-gray-400 pointer-events-none",size:16})]}),a.jsx("span",{children:"that can"}),a.jsxs("div",{className:"relative inline-block",children:[a.jsx("select",{value:E,onChange:ce=>k(ce.target.value),className:"appearance-none bg-purple-50 dark:bg-gray-700 text-purple-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-purple-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-purple-100 dark:hover:bg-gray-600 transition",children:ae(x).map(ce=>a.jsx("option",{value:ce,children:ce},ce))}),a.jsx(of,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-purple-500 dark:text-gray-400 pointer-events-none",size:16})]}),(E==="Play"||E==="Improvise")&&a.jsxs("div",{className:"relative inline-block",children:[a.jsxs("select",{value:_,onChange:ce=>S(ce.target.value),className:"appearance-none bg-green-50 dark:bg-gray-700 text-green-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-green-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-green-100 dark:hover:bg-gray-600 transition",children:[a.jsx("option",{value:"",children:"(Select Instrument)"}),Object.entries(LC).map(([ce,Be])=>a.jsx("optgroup",{label:ce,children:Be.map(Ye=>a.jsx("option",{value:Ye,children:Ye},Ye))},ce))]}),a.jsx(of,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-green-500 dark:text-gray-400 pointer-events-none",size:16})]}),a.jsx("span",{children:"for a song in the"}),a.jsxs("div",{className:"relative inline-block",children:[a.jsxs("select",{value:T,onChange:ce=>P(ce.target.value),className:"appearance-none bg-orange-50 dark:bg-gray-700 text-orange-700 dark:text-white font-bold py-1 pl-3 pr-8 rounded-lg border-b-2 border-orange-200 dark:border-gray-600 focus:outline-none cursor-pointer hover:bg-orange-100 dark:hover:bg-gray-600 transition",children:[a.jsx("option",{value:"",children:"(Select Genre)"}),$h.map(ce=>a.jsx("option",{value:ce,children:ce},ce))]}),a.jsx(of,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-orange-500 dark:text-gray-400 pointer-events-none",size:16})]})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t dark:border-gray-700",children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Project Title"}),a.jsx("input",{className:"w-full bg-gray-50 dark:bg-black/20 border-none rounded-lg p-3 text-gray-700 dark:text-gray-200 font-medium placeholder-gray-400 focus:ring-2 focus:ring-brand-blue",placeholder:"e.g. Summer Hit Single - Drum Tracking",value:j,onChange:ce=>R(ce.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-5 rounded-xl border dark:border-gray-700",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-3 block",children:"Logistics"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Date"}),a.jsx("input",{type:"date",className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:I,onChange:ce=>O(ce.target.value)})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Time"}),a.jsx("input",{type:"time",className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:D,onChange:ce=>F(ce.target.value)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Budget ($)"}),a.jsxs("div",{className:"relative",children:[a.jsx(ui,{className:"absolute left-3 top-2.5 text-green-500",size:14}),a.jsx("input",{type:"number",className:"w-full pl-8 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm font-bold",placeholder:"Flexible",value:V,onChange:ce=>$(ce.target.value)})]})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-5 rounded-xl border dark:border-gray-700",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-3 block",children:"Project Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Payment Type"}),a.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:q,onChange:ce=>Q(ce.target.value),children:[a.jsx("option",{children:"Flat Rate"}),a.jsx("option",{children:"Hourly"}),a.jsx("option",{children:"Royalty Split"}),a.jsx("option",{children:"Trade / Barter"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Experience Required"}),a.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:ve,onChange:ce=>le(ce.target.value),children:[a.jsx("option",{children:"Any"}),a.jsx("option",{children:"Intermediate"}),a.jsx("option",{children:"Pro / Expert"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Reference Link"}),a.jsxs("div",{className:"relative",children:[a.jsx(YA,{className:"absolute left-3 top-2.5 text-gray-400",size:14}),a.jsx("input",{className:"w-full pl-8 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Spotify / SoundCloud...",value:J,onChange:ce=>ue(ce.target.value)})]})]})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-end mb-4",children:[a.jsx("label",{className:"text-xs font-extrabold text-brand-blue uppercase tracking-widest",children:"Step 2: Specific Needs"}),a.jsxs("button",{onClick:je,className:"text-xs bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-white px-3 py-1.5 rounded-full font-bold flex items-center gap-1 transition",children:[a.jsx(Zs,{size:14})," Add Condition"]})]}),a.jsx("div",{className:"flex flex-col gap-3",children:H.map(ce=>{var Be,Ye,pe,bt,Ht,vr,nr;return a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 bg-gray-50 dark:bg-black/20 p-3 rounded-xl border dark:border-gray-700 animate-in slide-in-from-bottom-2",children:[a.jsx("div",{className:"w-full sm:w-1/3 min-w-[140px]",children:a.jsx("select",{className:"w-full p-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-[#2c2e36] dark:text-white focus:ring-2 focus:ring-brand-blue outline-none",value:ce.type,onChange:at=>te(ce.id,"type",at.target.value),children:vt.map(at=>a.jsx("option",{value:at.value,children:at.label},at.value))})}),a.jsxs("div",{className:"flex-1 flex gap-2",children:[ce.type==="Gear"&&!s?a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("select",{className:"w-full p-2 text-xs border rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white",value:((Be=ce.gearSelection)==null?void 0:Be.category)||"",onChange:at=>be(ce.id,"category",at.target.value),children:[a.jsx("option",{value:"",children:"Select Category..."}),o.map(at=>a.jsx("option",{value:at.id,children:at.label},at.id))]}),((Ye=ce.gearSelection)==null?void 0:Ye.category)&&i[ce.gearSelection.category]&&a.jsxs("select",{className:"w-full p-2 text-xs border rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white",value:((pe=ce.gearSelection)==null?void 0:pe.subCategory)||"",onChange:at=>be(ce.id,"subCategory",at.target.value),children:[a.jsx("option",{value:"",children:"Select Type..."}),Object.keys(i[ce.gearSelection.category]).map(at=>a.jsx("option",{value:at,children:at.replace(/_/g," ")},at))]}),((bt=ce.gearSelection)==null?void 0:bt.subCategory)&&a.jsxs("select",{className:"w-full p-2 text-xs border rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white",value:((Ht=ce.gearSelection)==null?void 0:Ht.type)||"",onChange:at=>be(ce.id,"type",at.target.value),children:[a.jsx("option",{value:"",children:"Select Subtype..."}),Object.keys(i[ce.gearSelection.category][ce.gearSelection.subCategory]).map(at=>a.jsx("option",{value:at,children:at.replace(/_/g," ")},at))]}),((vr=ce.gearSelection)==null?void 0:vr.type)&&a.jsxs("select",{className:"w-full p-2 text-sm font-bold border-l-4 border-brand-blue rounded bg-white dark:bg-[#2c2e36] dark:border-gray-600 dark:text-white shadow-sm",value:((nr=ce.gearSelection)==null?void 0:nr.item)||"",onChange:at=>be(ce.id,"item",at.target.value),children:[a.jsx("option",{value:"",children:"Select Specific Item..."}),i[ce.gearSelection.category][ce.gearSelection.subCategory][ce.gearSelection.type].map(at=>a.jsx("option",{value:at,children:at},at))]})]}):a.jsx("input",{className:"w-full p-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-[#2c2e36] dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-brand-blue",placeholder:"Describe requirement...",value:ce.value,onChange:at=>te(ce.id,"value",at.target.value)}),a.jsx("button",{onClick:()=>ge(ce.id),className:"text-gray-400 hover:text-red-500 px-2",children:a.jsx(bs,{size:18})})]})]},ce.id)})}),a.jsx("div",{className:"h-6 w-0.5 bg-gray-200 dark:bg-gray-700 mx-auto my-2"}),a.jsxs("button",{className:"w-full bg-gradient-to-r from-brand-blue to-blue-600 text-white py-4 rounded-xl font-bold shadow-lg hover:scale-[1.01] transition-all text-lg flex items-center justify-center gap-2",onClick:Fe,children:[a.jsx(Ys,{fill:"currentColor",size:20})," Broadcast Opportunity"]})]})]})]})]})}function o1e({user:t,userData:e,target:n,onClose:r}){var b;const[s,i]=N.useState(!1),[o,l]=N.useState([]),[c,d]=N.useState("me"),h=(b=e==null?void 0:e.accountTypes)==null?void 0:b.some(E=>["Label","Agent"].includes(E)),[m,p]=N.useState({date:"",time:"",duration:2,serviceType:"Session",offerAmount:n.rate?n.rate*2:100,message:""});N.useEffect(()=>{h&&(async()=>{try{const _=(await Kt(Re(Z,Ve(t.uid).labelRoster(t.uid)))).docs.map(S=>({id:S.id,...S.data()}));l(_)}catch(k){console.error("Roster fetch error",k)}})()},[h,t.uid]);const v=E=>{const k=E.target.value,_=k===""?"":parseInt(k);p(S=>({...S,duration:_,offerAmount:_&&n.rate?n.rate*_:S.offerAmount}))},x=async()=>{if(!m.date||!m.time||!m.message)return alert("Please fill in all required fields.");if(!m.duration||m.duration<=0)return alert("Duration must be at least 1 hour.");i(!0);try{const E=new Date(`${m.date}T${m.time}`);let k={senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,onBehalfOf:null};if(c!=="me"){const _=o.find(S=>S.artistId===c);_&&(k.senderName=`${e.firstName} (for ${_.name})`,k.onBehalfOf={id:_.artistId,name:_.name,photo:_.photoURL})}await hn(Re(Z,`artifacts/${Ge}/public/data/bookings`),{...k,targetId:n.id,targetName:n.firstName?`${n.firstName} ${n.lastName}`:n.name,serviceType:m.serviceType,date:m.date,time:m.time,duration:Number(m.duration),offerAmount:Number(m.offerAmount),message:m.message,status:"Pending",timestamp:zt(),bookingStart:E,type:"Direct"}),alert("Booking request sent successfully!"),r()}catch(E){console.error("Booking failed:",E),alert("Failed to send booking request.")}i(!1)};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4 animate-in fade-in zoom-in-95",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700 flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Book Session"}),a.jsxs("p",{className:"text-xs text-gray-500",children:["with ",a.jsx("span",{className:"text-brand-blue font-bold",children:n.firstName||n.name})]})]}),a.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition text-gray-500 dark:text-gray-400",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto space-y-5",children:[h&&o.length>0&&a.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-xl border border-purple-100 dark:border-purple-800",children:[a.jsxs("label",{className:"text-xs font-bold text-purple-700 dark:text-purple-300 uppercase mb-1 flex items-center gap-1",children:[a.jsx(Jo,{size:12})," Booking On Behalf Of:"]}),a.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-[#1f2128] dark:border-purple-800/50 dark:text-white text-sm font-bold",value:c,onChange:E=>d(E.target.value),children:[a.jsxs("option",{value:"me",children:["Myself (",e.firstName,")"]}),o.map(E=>a.jsxs("option",{value:E.artistId,children:["Artist: ",E.name]},E.artistId))]})]}),n.rate&&a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl border border-blue-100 dark:border-blue-800 flex items-center gap-2 text-xs text-blue-700 dark:text-blue-300",children:[a.jsx(pl,{size:14}),a.jsxs("span",{children:["Standard Rate: ",a.jsxs("strong",{children:["$",n.rate,"/hr"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Date"}),a.jsxs("div",{className:"relative",children:[a.jsx(qo,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),a.jsx("input",{type:"date",className:"w-full pl-10 p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:m.date,onChange:E=>p({...m,date:E.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Start Time"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ms,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),a.jsx("input",{type:"time",className:"w-full pl-10 p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:m.time,onChange:E=>p({...m,time:E.target.value})})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Duration (Hrs)"}),a.jsx("input",{type:"number",min:"1",className:"w-full p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm font-bold",value:m.duration,onChange:v})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Total Offer ($)"}),a.jsxs("div",{className:"relative",children:[a.jsx(ui,{className:"absolute left-3 top-2.5 text-green-500",size:16}),a.jsx("input",{type:"number",className:"w-full pl-9 p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm font-bold text-green-600",value:m.offerAmount,onChange:E=>p({...m,offerAmount:E.target.value})})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Type"}),a.jsxs("select",{className:"w-full p-2.5 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm",value:m.serviceType,onChange:E=>p({...m,serviceType:E.target.value}),children:[a.jsx("option",{children:"Session"}),a.jsx("option",{children:"Lesson"}),a.jsx("option",{children:"Consultation"}),a.jsx("option",{children:"Mixing/Mastering"}),a.jsx("option",{children:"Rehearsal"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Message / Requirements"}),a.jsx("textarea",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white text-sm min-h-[100px] resize-none",placeholder:"Describe what you need...",value:m.message,onChange:E=>p({...m,message:E.target.value})})]})]}),a.jsx("div",{className:"p-5 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:a.jsx("button",{onClick:x,disabled:s,className:"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 transition flex items-center justify-center gap-2 shadow-lg disabled:opacity-50",children:s?a.jsx(rt,{className:"animate-spin"}):"Send Request"})})]})})}var cV={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1e=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},l1e=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},c1e={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,v=d&63;c||(v=64,o||(p=64)),r.push(n[h],n[m],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(a1e(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):l1e(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new u1e;const p=i<<2|l>>4;if(r.push(p),d!==64){const v=l<<4&240|d>>2;if(r.push(v),m!==64){const x=d<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class u1e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const d1e=function(t){try{return c1e.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1e=()=>h1e().__FIREBASE_DEFAULTS__,m1e=()=>{if(typeof process>"u"||typeof cV>"u")return;const t=cV.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},p1e=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&d1e(t[1]);return e&&JSON.parse(e)},g1e=()=>{try{return f1e()||m1e()||p1e()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},y1e=t=>{var e,n;return(n=(e=g1e())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},x1e=t=>{const e=y1e(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1e="FirebaseError";class O1 extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=v1e,Object.setPrototypeOf(this,O1.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b1e.prototype.create)}}class b1e{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?_1e(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new O1(s,l,r)}}function _1e(t,e){return t.replace(w1e,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const w1e=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zR(t){return t&&t._delegate?t._delegate:t}class k1e{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1e="type.googleapis.com/google.protobuf.Int64Value",E1e="type.googleapis.com/google.protobuf.UInt64Value";function Bq(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function VC(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>VC(e));if(typeof t=="function"||typeof t=="object")return Bq(t,e=>VC(e));throw new Error("Data cannot be encoded in JSON: "+t)}function kw(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case N1e:case E1e:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>kw(e)):typeof t=="function"||typeof t=="object"?Bq(t,e=>kw(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uV={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class If extends O1{constructor(e,n,r){super(`${UR}/${e}`,n||""),this.details=r}}function S1e(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function T1e(t,e){let n=S1e(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!uV[o])return new If("internal","internal");n=uV[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=kw(s))}}catch{}return n==="ok"?null:new If(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1e{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC="us-central1";function I1e(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new If("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class j1e{constructor(e,n,r,s,i=FC,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new C1e(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=FC}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function A1e(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function R1e(t,e,n){return r=>L1e(t,e,r,{})}async function P1e(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function L1e(t,e,n,r){const s=t._url(e);return M1e(t,s,n,r)}async function M1e(t,e,n,r){n=VC(n);const s={data:n},i={},o=await t.contextProvider.getContext(r.limitedUseAppCheckTokens);o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const l=r.timeout||7e4,c=I1e(l),d=await Promise.race([P1e(e,s,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!d)throw new If("cancelled","Firebase Functions instance was deleted.");const h=T1e(d.status,d.json);if(h)throw h;if(!d.json)throw new If("internal","Response is not valid JSON object.");let m=d.json.data;if(typeof m>"u"&&(m=d.json.result),typeof m>"u")throw new If("internal","Response is missing data field.");return{data:kw(m)}}const dV="@firebase/functions",hV="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1e="auth-internal",D1e="app-check-internal",V1e="messaging-internal";function F1e(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(O1e),l=r.getProvider(V1e),c=r.getProvider(D1e);return new j1e(i,o,l,c,s,t)};Xa(new k1e(UR,n,"PUBLIC").setMultipleInstances(!0)),fi(dV,hV,e),fi(dV,hV,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(t=$0(),e=FC){const r=Mm(zR(t),UR).getImmediate({identifier:e}),s=x1e("functions");return s&&$1e(r,...s),r}function $1e(t,e,n){A1e(zR(t),e,n)}function V1(t,e,n){return R1e(zR(t),e)}F1e(fetch.bind(self));var _x=t=>t.type==="checkbox",$u=t=>t instanceof Date,Fs=t=>t==null;const zq=t=>typeof t=="object";var xr=t=>!Fs(t)&&!Array.isArray(t)&&zq(t)&&!$u(t),Uq=t=>xr(t)&&t.target?_x(t.target)?t.target.checked:t.target.value:t,B1e=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Wq=(t,e)=>t.has(B1e(e)),z1e=t=>{const e=t.constructor&&t.constructor.prototype;return xr(e)&&e.hasOwnProperty("isPrototypeOf")},WR=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function kn(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(WR&&(t instanceof Blob||r))&&(n||xr(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!z1e(t))e=t;else for(const s in t)t.hasOwnProperty(s)&&(e[s]=kn(t[s]));else return t;return e}var F1=t=>/^\w*$/.test(t),vn=t=>t===void 0,$1=t=>Array.isArray(t)?t.filter(Boolean):[],HR=t=>$1(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Ie=(t,e,n)=>{if(!e||!xr(t))return n;const r=(F1(e)?[e]:HR(e)).reduce((s,i)=>Fs(s)?s:s[i],t);return vn(r)||r===t?vn(t[e])?n:t[e]:r},si=t=>typeof t=="boolean",Qt=(t,e,n)=>{let r=-1;const s=F1(e)?[e]:HR(e),i=s.length,o=i-1;for(;++r<i;){const l=s[r];let c=n;if(r!==o){const d=t[l];c=xr(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;t[l]=c,t=t[l]}};const Nw={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Di={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ka={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Hq=He.createContext(null);Hq.displayName="HookFormContext";const B1=()=>He.useContext(Hq);var qq=(t,e,n,r=!0)=>{const s={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(s,i,{get:()=>{const o=i;return e._proxyFormState[o]!==Di.all&&(e._proxyFormState[o]=!r||Di.all),n&&(n[o]=!0),t[o]}});return s};const z1=typeof window<"u"?He.useLayoutEffect:He.useEffect;function U1e(t){const e=B1(),{control:n=e.control,disabled:r,name:s,exact:i}=t||{},[o,l]=He.useState(n._formState),c=He.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return z1(()=>n._subscribe({name:s,formState:c.current,exact:i,callback:d=>{!r&&l({...n._formState,...d})}}),[s,r,i]),He.useEffect(()=>{c.current.isValid&&n._setValid(!0)},[n]),He.useMemo(()=>qq(o,n,c.current,!1),[o,n])}var oi=t=>typeof t=="string",$C=(t,e,n,r,s)=>oi(t)?(r&&e.watch.add(t),Ie(n,t,s)):Array.isArray(t)?t.map(i=>(r&&e.watch.add(i),Ie(n,i))):(r&&(e.watchAll=!0),n),BC=t=>Fs(t)||!zq(t);function lo(t,e,n=new WeakSet){if(BC(t)||BC(e))return Object.is(t,e);if($u(t)&&$u(e))return t.getTime()===e.getTime();const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const i of r){const o=t[i];if(!s.includes(i))return!1;if(i!=="ref"){const l=e[i];if($u(o)&&$u(l)||xr(o)&&xr(l)||Array.isArray(o)&&Array.isArray(l)?!lo(o,l,n):!Object.is(o,l))return!1}}return!0}function W1e(t){const e=B1(),{control:n=e.control,name:r,defaultValue:s,disabled:i,exact:o,compute:l}=t||{},c=He.useRef(s),d=He.useRef(l),h=He.useRef(void 0),m=He.useRef(n),p=He.useRef(r);d.current=l;const[v,x]=He.useState(()=>{const T=n._getWatch(r,c.current);return d.current?d.current(T):T}),b=He.useCallback(T=>{const P=$C(r,n._names,T||n._formValues,!1,c.current);return d.current?d.current(P):P},[n._formValues,n._names,r]),E=He.useCallback(T=>{if(!i){const P=$C(r,n._names,T||n._formValues,!1,c.current);if(d.current){const j=d.current(P);lo(j,h.current)||(x(j),h.current=j)}else x(P)}},[n._formValues,n._names,i,r]);z1(()=>((m.current!==n||!lo(p.current,r))&&(m.current=n,p.current=r,E()),n._subscribe({name:r,formState:{values:!0},exact:o,callback:T=>{E(T.values)}})),[n,o,r,E]),He.useEffect(()=>n._removeUnmounted());const k=m.current!==n,_=p.current,S=He.useMemo(()=>{if(i)return null;const T=!k&&!lo(_,r);return k||T?b():null},[i,k,r,_,b]);return S!==null?S:v}function H1e(t){const e=B1(),{name:n,disabled:r,control:s=e.control,shouldUnregister:i,defaultValue:o,exact:l=!0}=t,c=Wq(s._names.array,n),d=He.useMemo(()=>Ie(s._formValues,n,Ie(s._defaultValues,n,o)),[s,n,o]),h=W1e({control:s,name:n,defaultValue:d,exact:l}),m=U1e({control:s,name:n,exact:l}),p=He.useRef(t),v=He.useRef(void 0),x=He.useRef(s.register(n,{...t.rules,value:h,...si(t.disabled)?{disabled:t.disabled}:{}}));p.current=t;const b=He.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ie(m.errors,n)},isDirty:{enumerable:!0,get:()=>!!Ie(m.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Ie(m.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Ie(m.validatingFields,n)},error:{enumerable:!0,get:()=>Ie(m.errors,n)}}),[m,n]),E=He.useCallback(T=>x.current.onChange({target:{value:Uq(T),name:n},type:Nw.CHANGE}),[n]),k=He.useCallback(()=>x.current.onBlur({target:{value:Ie(s._formValues,n),name:n},type:Nw.BLUR}),[n,s._formValues]),_=He.useCallback(T=>{const P=Ie(s._fields,n);P&&T&&(P._f.ref={focus:()=>T.focus&&T.focus(),select:()=>T.select&&T.select(),setCustomValidity:j=>T.setCustomValidity(j),reportValidity:()=>T.reportValidity()})},[s._fields,n]),S=He.useMemo(()=>({name:n,value:h,...si(r)||m.disabled?{disabled:m.disabled||r}:{},onChange:E,onBlur:k,ref:_}),[n,r,m.disabled,E,k,_,h]);return He.useEffect(()=>{const T=s._options.shouldUnregister||i,P=v.current;P&&P!==n&&!c&&s.unregister(P),s.register(n,{...p.current.rules,...si(p.current.disabled)?{disabled:p.current.disabled}:{}});const j=(R,I)=>{const O=Ie(s._fields,R);O&&O._f&&(O._f.mount=I)};if(j(n,!0),T){const R=kn(Ie(s._options.defaultValues,n,p.current.defaultValue));Qt(s._defaultValues,n,R),vn(Ie(s._formValues,n))&&Qt(s._formValues,n,R)}return!c&&s.register(n),v.current=n,()=>{(c?T&&!s._state.action:T)?s.unregister(n):j(n,!1)}},[n,s,c,i]),He.useEffect(()=>{s._setDisabledField({disabled:r,name:n})},[r,n,s]),He.useMemo(()=>({field:S,formState:m,fieldState:b}),[S,m,b])}const q1e=t=>t.render(H1e(t));var Gq=(t,e,n,r,s)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:s||!0}}:{},Hs=t=>Array.isArray(t)?t:[t],fV=()=>{let t=[];return{get observers(){return t},next:s=>{for(const i of t)i.next&&i.next(s)},subscribe:s=>(t.push(s),{unsubscribe:()=>{t=t.filter(i=>i!==s)}}),unsubscribe:()=>{t=[]}}};function Kq(t,e){const n={};for(const r in t)if(t.hasOwnProperty(r)){const s=t[r],i=e[r];if(s&&xr(s)&&i){const o=Kq(s,i);xr(o)&&(n[r]=o)}else t[r]&&(n[r]=i)}return n}var is=t=>xr(t)&&!Object.keys(t).length,qR=t=>t.type==="file",co=t=>typeof t=="function",Ew=t=>{if(!WR)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Qq=t=>t.type==="select-multiple",GR=t=>t.type==="radio",G1e=t=>GR(t)||_x(t),SE=t=>Ew(t)&&t.isConnected;function K1e(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=vn(t)?r++:t[e[r++]];return t}function Q1e(t){for(const e in t)if(t.hasOwnProperty(e)&&!vn(t[e]))return!1;return!0}function sr(t,e){const n=Array.isArray(e)?e:F1(e)?[e]:HR(e),r=n.length===1?t:K1e(t,n),s=n.length-1,i=n[s];return r&&delete r[i],s!==0&&(xr(r)&&is(r)||Array.isArray(r)&&Q1e(r))&&sr(t,n.slice(0,-1)),t}var Z1e=t=>{for(const e in t)if(co(t[e]))return!0;return!1};function Zq(t){return Array.isArray(t)||xr(t)&&!Z1e(t)}function zC(t,e={}){for(const n in t){const r=t[n];Zq(r)?(e[n]=Array.isArray(r)?[]:{},zC(r,e[n])):vn(r)||(e[n]=!0)}return e}function Bh(t,e,n){n||(n=zC(e));for(const r in t){const s=t[r];if(Zq(s))vn(e)||BC(n[r])?n[r]=zC(s,Array.isArray(s)?[]:{}):Bh(s,Fs(e)?{}:e[r],n[r]);else{const i=e[r];n[r]=!lo(s,i)}}return n}const mV={value:!1,isValid:!1},pV={value:!0,isValid:!0};var Yq=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!vn(t[0].attributes.value)?vn(t[0].value)||t[0].value===""?pV:{value:t[0].value,isValid:!0}:pV:mV}return mV},Xq=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>vn(t)?t:e?t===""?NaN:t&&+t:n&&oi(t)?new Date(t):r?r(t):t;const gV={isValid:!1,value:null};var Jq=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,gV):gV;function yV(t){const e=t.ref;return qR(e)?e.files:GR(e)?Jq(t.refs).value:Qq(e)?[...e.selectedOptions].map(({value:n})=>n):_x(e)?Yq(t.refs).value:Xq(vn(e.value)?t.ref.value:e.value,t)}var Y1e=(t,e,n,r)=>{const s={};for(const i of t){const o=Ie(e,i);o&&Qt(s,i,o._f)}return{criteriaMode:n,names:[...t],fields:s,shouldUseNativeValidation:r}},Sw=t=>t instanceof RegExp,Yp=t=>vn(t)?t:Sw(t)?t.source:xr(t)?Sw(t.value)?t.value.source:t.value:t,hf=t=>({isOnSubmit:!t||t===Di.onSubmit,isOnBlur:t===Di.onBlur,isOnChange:t===Di.onChange,isOnAll:t===Di.all,isOnTouch:t===Di.onTouched});const xV="AsyncFunction";var X1e=t=>!!t&&!!t.validate&&!!(co(t.validate)&&t.validate.constructor.name===xV||xr(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===xV)),J1e=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),UC=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const jf=(t,e,n,r)=>{for(const s of n||Object.keys(t)){const i=Ie(t,s);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(jf(l,e))break}else if(xr(l)&&jf(l,e))break}}};function vV(t,e,n){const r=Ie(t,n);if(r||F1(n))return{error:r,name:n};const s=n.split(".");for(;s.length;){const i=s.join("."),o=Ie(e,i),l=Ie(t,i);if(o&&!Array.isArray(o)&&n!==i)return{name:n};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};s.pop()}return{name:n}}var eNe=(t,e,n,r)=>{n(t);const{name:s,...i}=t;return is(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!r||Di.all))},tNe=(t,e,n)=>!t||!e||t===e||Hs(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),nNe=(t,e,n,r,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(e||t):(n?r.isOnBlur:s.isOnBlur)?!t:(n?r.isOnChange:s.isOnChange)?t:!0,rNe=(t,e)=>!$1(Ie(t,e)).length&&sr(t,e),eG=(t,e,n)=>{const r=Hs(Ie(t,n));return Qt(r,"root",e[n]),Qt(t,n,r),t};function bV(t,e,n="validate"){if(oi(t)||Array.isArray(t)&&t.every(oi)||si(t)&&!t)return{type:n,message:oi(t)?t:"",ref:e}}var Ih=t=>xr(t)&&!Sw(t)?t:{value:t,message:""},WC=async(t,e,n,r,s,i)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:h,min:m,max:p,pattern:v,validate:x,name:b,valueAsNumber:E,mount:k}=t._f,_=Ie(n,b);if(!k||e.has(b))return{};const S=l?l[0]:o,T=V=>{s&&S.reportValidity&&(S.setCustomValidity(si(V)?"":V||""),S.reportValidity())},P={},j=GR(o),R=_x(o),I=j||R,O=(E||qR(o))&&vn(o.value)&&vn(_)||Ew(o)&&o.value===""||_===""||Array.isArray(_)&&!_.length,D=Gq.bind(null,b,r,P),F=(V,$,J,ue=ka.maxLength,ve=ka.minLength)=>{const le=V?$:J;P[b]={type:V?ue:ve,message:le,ref:o,...D(V?ue:ve,le)}};if(i?!Array.isArray(_)||!_.length:c&&(!I&&(O||Fs(_))||si(_)&&!_||R&&!Yq(l).isValid||j&&!Jq(l).isValid)){const{value:V,message:$}=oi(c)?{value:!!c,message:c}:Ih(c);if(V&&(P[b]={type:ka.required,message:$,ref:S,...D(ka.required,$)},!r))return T($),P}if(!O&&(!Fs(m)||!Fs(p))){let V,$;const J=Ih(p),ue=Ih(m);if(!Fs(_)&&!isNaN(_)){const ve=o.valueAsNumber||_&&+_;Fs(J.value)||(V=ve>J.value),Fs(ue.value)||($=ve<ue.value)}else{const ve=o.valueAsDate||new Date(_),le=H=>new Date(new Date().toDateString()+" "+H),q=o.type=="time",Q=o.type=="week";oi(J.value)&&_&&(V=q?le(_)>le(J.value):Q?_>J.value:ve>new Date(J.value)),oi(ue.value)&&_&&($=q?le(_)<le(ue.value):Q?_<ue.value:ve<new Date(ue.value))}if((V||$)&&(F(!!V,J.message,ue.message,ka.max,ka.min),!r))return T(P[b].message),P}if((d||h)&&!O&&(oi(_)||i&&Array.isArray(_))){const V=Ih(d),$=Ih(h),J=!Fs(V.value)&&_.length>+V.value,ue=!Fs($.value)&&_.length<+$.value;if((J||ue)&&(F(J,V.message,$.message),!r))return T(P[b].message),P}if(v&&!O&&oi(_)){const{value:V,message:$}=Ih(v);if(Sw(V)&&!_.match(V)&&(P[b]={type:ka.pattern,message:$,ref:o,...D(ka.pattern,$)},!r))return T($),P}if(x){if(co(x)){const V=await x(_,n),$=bV(V,S);if($&&(P[b]={...$,...D(ka.validate,$.message)},!r))return T($.message),P}else if(xr(x)){let V={};for(const $ in x){if(!is(V)&&!r)break;const J=bV(await x[$](_,n),S,$);J&&(V={...J,...D($,J.message)},T(J.message),r&&(P[b]=V))}if(!is(V)&&(P[b]={ref:S,...V},!r))return P}}return T(!0),P};const sNe={mode:Di.onSubmit,reValidateMode:Di.onChange,shouldFocusError:!0};function iNe(t={}){let e={...sNe,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:co(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=xr(e.defaultValues)||xr(e.values)?kn(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:kn(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let m={...h};const p={array:fV(),state:fV()},v=e.criteriaMode===Di.all,x=U=>G=>{clearTimeout(d),d=setTimeout(U,G)},b=async U=>{if(!e.disabled&&(h.isValid||m.isValid||U)){const G=e.resolver?is((await R()).errors):await O(r,!0);G!==n.isValid&&p.state.next({isValid:G})}},E=(U,G)=>{!e.disabled&&(h.isValidating||h.validatingFields||m.isValidating||m.validatingFields)&&((U||Array.from(l.mount)).forEach(re=>{re&&(G?Qt(n.validatingFields,re,G):sr(n.validatingFields,re))}),p.state.next({validatingFields:n.validatingFields,isValidating:!is(n.validatingFields)}))},k=(U,G=[],re,Ae,Te=!0,_e=!0)=>{if(Ae&&re&&!e.disabled){if(o.action=!0,_e&&Array.isArray(Ie(r,U))){const Pe=re(Ie(r,U),Ae.argA,Ae.argB);Te&&Qt(r,U,Pe)}if(_e&&Array.isArray(Ie(n.errors,U))){const Pe=re(Ie(n.errors,U),Ae.argA,Ae.argB);Te&&Qt(n.errors,U,Pe),rNe(n.errors,U)}if((h.touchedFields||m.touchedFields)&&_e&&Array.isArray(Ie(n.touchedFields,U))){const Pe=re(Ie(n.touchedFields,U),Ae.argA,Ae.argB);Te&&Qt(n.touchedFields,U,Pe)}(h.dirtyFields||m.dirtyFields)&&(n.dirtyFields=Bh(s,i)),p.state.next({name:U,isDirty:F(U,G),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Qt(i,U,G)},_=(U,G)=>{Qt(n.errors,U,G),p.state.next({errors:n.errors})},S=U=>{n.errors=U,p.state.next({errors:n.errors,isValid:!1})},T=(U,G,re,Ae)=>{const Te=Ie(r,U);if(Te){const _e=Ie(i,U,vn(re)?Ie(s,U):re);vn(_e)||Ae&&Ae.defaultChecked||G?Qt(i,U,G?_e:yV(Te._f)):J(U,_e),o.mount&&!o.action&&b()}},P=(U,G,re,Ae,Te)=>{let _e=!1,Pe=!1;const lt={name:U};if(!e.disabled){if(!re||Ae){(h.isDirty||m.isDirty)&&(Pe=n.isDirty,n.isDirty=lt.isDirty=F(),_e=Pe!==lt.isDirty);const Vt=lo(Ie(s,U),G);Pe=!!Ie(n.dirtyFields,U),Vt?sr(n.dirtyFields,U):Qt(n.dirtyFields,U,!0),lt.dirtyFields=n.dirtyFields,_e=_e||(h.dirtyFields||m.dirtyFields)&&Pe!==!Vt}if(re){const Vt=Ie(n.touchedFields,U);Vt||(Qt(n.touchedFields,U,re),lt.touchedFields=n.touchedFields,_e=_e||(h.touchedFields||m.touchedFields)&&Vt!==re)}_e&&Te&&p.state.next(lt)}return _e?lt:{}},j=(U,G,re,Ae)=>{const Te=Ie(n.errors,U),_e=(h.isValid||m.isValid)&&si(G)&&n.isValid!==G;if(e.delayError&&re?(c=x(()=>_(U,re)),c(e.delayError)):(clearTimeout(d),c=null,re?Qt(n.errors,U,re):sr(n.errors,U)),(re?!lo(Te,re):Te)||!is(Ae)||_e){const Pe={...Ae,..._e&&si(G)?{isValid:G}:{},errors:n.errors,name:U};n={...n,...Pe},p.state.next(Pe)}},R=async U=>{E(U,!0);const G=await e.resolver(i,e.context,Y1e(U||l.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return E(U),G},I=async U=>{const{errors:G}=await R(U);if(U)for(const re of U){const Ae=Ie(G,re);Ae?Qt(n.errors,re,Ae):sr(n.errors,re)}else n.errors=G;return G},O=async(U,G,re={valid:!0})=>{for(const Ae in U){const Te=U[Ae];if(Te){const{_f:_e,...Pe}=Te;if(_e){const lt=l.array.has(_e.name),Vt=Te._f&&X1e(Te._f);Vt&&h.validatingFields&&E([_e.name],!0);const Wr=await WC(Te,l.disabled,i,v,e.shouldUseNativeValidation&&!G,lt);if(Vt&&h.validatingFields&&E([_e.name]),Wr[_e.name]&&(re.valid=!1,G))break;!G&&(Ie(Wr,_e.name)?lt?eG(n.errors,Wr,_e.name):Qt(n.errors,_e.name,Wr[_e.name]):sr(n.errors,_e.name))}!is(Pe)&&await O(Pe,G,re)}}return re.valid},D=()=>{for(const U of l.unMount){const G=Ie(r,U);G&&(G._f.refs?G._f.refs.every(re=>!SE(re)):!SE(G._f.ref))&&be(U)}l.unMount=new Set},F=(U,G)=>!e.disabled&&(U&&G&&Qt(i,U,G),!lo(H(),s)),V=(U,G,re)=>$C(U,l,{...o.mount?i:vn(G)?s:oi(U)?{[U]:G}:G},re,G),$=U=>$1(Ie(o.mount?i:s,U,e.shouldUnregister?Ie(s,U,[]):[])),J=(U,G,re={})=>{const Ae=Ie(r,U);let Te=G;if(Ae){const _e=Ae._f;_e&&(!_e.disabled&&Qt(i,U,Xq(G,_e)),Te=Ew(_e.ref)&&Fs(G)?"":G,Qq(_e.ref)?[..._e.ref.options].forEach(Pe=>Pe.selected=Te.includes(Pe.value)):_e.refs?_x(_e.ref)?_e.refs.forEach(Pe=>{(!Pe.defaultChecked||!Pe.disabled)&&(Array.isArray(Te)?Pe.checked=!!Te.find(lt=>lt===Pe.value):Pe.checked=Te===Pe.value||!!Te)}):_e.refs.forEach(Pe=>Pe.checked=Pe.value===Te):qR(_e.ref)?_e.ref.value="":(_e.ref.value=Te,_e.ref.type||p.state.next({name:U,values:kn(i)})))}(re.shouldDirty||re.shouldTouch)&&P(U,Te,re.shouldTouch,re.shouldDirty,!0),re.shouldValidate&&Q(U)},ue=(U,G,re)=>{for(const Ae in G){if(!G.hasOwnProperty(Ae))return;const Te=G[Ae],_e=U+"."+Ae,Pe=Ie(r,_e);(l.array.has(U)||xr(Te)||Pe&&!Pe._f)&&!$u(Te)?ue(_e,Te,re):J(_e,Te,re)}},ve=(U,G,re={})=>{const Ae=Ie(r,U),Te=l.array.has(U),_e=kn(G);Qt(i,U,_e),Te?(p.array.next({name:U,values:kn(i)}),(h.isDirty||h.dirtyFields||m.isDirty||m.dirtyFields)&&re.shouldDirty&&p.state.next({name:U,dirtyFields:Bh(s,i),isDirty:F(U,_e)})):Ae&&!Ae._f&&!Fs(_e)?ue(U,_e,re):J(U,_e,re),UC(U,l)&&p.state.next({...n,name:U}),p.state.next({name:o.mount?U:void 0,values:kn(i)})},le=async U=>{o.mount=!0;const G=U.target;let re=G.name,Ae=!0;const Te=Ie(r,re),_e=Vt=>{Ae=Number.isNaN(Vt)||$u(Vt)&&isNaN(Vt.getTime())||lo(Vt,Ie(i,re,Vt))},Pe=hf(e.mode),lt=hf(e.reValidateMode);if(Te){let Vt,Wr;const ko=G.type?yV(Te._f):Uq(U),Xs=U.type===Nw.BLUR||U.type===Nw.FOCUS_OUT,aa=!J1e(Te._f)&&!e.resolver&&!Ie(n.errors,re)&&!Te._f.deps||nNe(Xs,Ie(n.touchedFields,re),n.isSubmitted,lt,Pe),la=UC(re,l,Xs);Qt(i,re,ko),Xs?(!G||!G.readOnly)&&(Te._f.onBlur&&Te._f.onBlur(U),c&&c(0)):Te._f.onChange&&Te._f.onChange(U);const No=P(re,ko,Xs),yl=!is(No)||la;if(!Xs&&p.state.next({name:re,type:U.type,values:kn(i)}),aa)return(h.isValid||m.isValid)&&(e.mode==="onBlur"?Xs&&b():Xs||b()),yl&&p.state.next({name:re,...la?{}:No});if(!Xs&&la&&p.state.next({...n}),e.resolver){const{errors:Yd}=await R([re]);if(_e(ko),Ae){const ca=vV(n.errors,r,re),xl=vV(Yd,r,ca.name||re);Vt=xl.error,re=xl.name,Wr=is(Yd)}}else E([re],!0),Vt=(await WC(Te,l.disabled,i,v,e.shouldUseNativeValidation))[re],E([re]),_e(ko),Ae&&(Vt?Wr=!1:(h.isValid||m.isValid)&&(Wr=await O(r,!0)));Ae&&(Te._f.deps&&(!Array.isArray(Te._f.deps)||Te._f.deps.length>0)&&Q(Te._f.deps),j(re,Wr,Vt,No))}},q=(U,G)=>{if(Ie(n.errors,G)&&U.focus)return U.focus(),1},Q=async(U,G={})=>{let re,Ae;const Te=Hs(U);if(e.resolver){const _e=await I(vn(U)?U:Te);re=is(_e),Ae=U?!Te.some(Pe=>Ie(_e,Pe)):re}else U?(Ae=(await Promise.all(Te.map(async _e=>{const Pe=Ie(r,_e);return await O(Pe&&Pe._f?{[_e]:Pe}:Pe)}))).every(Boolean),!(!Ae&&!n.isValid)&&b()):Ae=re=await O(r);return p.state.next({...!oi(U)||(h.isValid||m.isValid)&&re!==n.isValid?{}:{name:U},...e.resolver||!U?{isValid:re}:{},errors:n.errors}),G.shouldFocus&&!Ae&&jf(r,q,U?Te:l.mount),Ae},H=(U,G)=>{let re={...o.mount?i:s};return G&&(re=Kq(G.dirtyFields?n.dirtyFields:n.touchedFields,re)),vn(U)?re:oi(U)?Ie(re,U):U.map(Ae=>Ie(re,Ae))},X=(U,G)=>({invalid:!!Ie((G||n).errors,U),isDirty:!!Ie((G||n).dirtyFields,U),error:Ie((G||n).errors,U),isValidating:!!Ie(n.validatingFields,U),isTouched:!!Ie((G||n).touchedFields,U)}),oe=U=>{U&&Hs(U).forEach(G=>sr(n.errors,G)),p.state.next({errors:U?n.errors:{}})},ae=(U,G,re)=>{const Ae=(Ie(r,U,{_f:{}})._f||{}).ref,Te=Ie(n.errors,U)||{},{ref:_e,message:Pe,type:lt,...Vt}=Te;Qt(n.errors,U,{...Vt,...G,ref:Ae}),p.state.next({name:U,errors:n.errors,isValid:!1}),re&&re.shouldFocus&&Ae&&Ae.focus&&Ae.focus()},je=(U,G)=>co(U)?p.state.subscribe({next:re=>"values"in re&&U(V(void 0,G),re)}):V(U,G,!0),ge=U=>p.state.subscribe({next:G=>{tNe(U.name,G.name,U.exact)&&eNe(G,U.formState||h,nr,U.reRenderRoot)&&U.callback({values:{...i},...n,...G,defaultValues:s})}}).unsubscribe,te=U=>(o.mount=!0,m={...m,...U.formState},ge({...U,formState:m})),be=(U,G={})=>{for(const re of U?Hs(U):l.mount)l.mount.delete(re),l.array.delete(re),G.keepValue||(sr(r,re),sr(i,re)),!G.keepError&&sr(n.errors,re),!G.keepDirty&&sr(n.dirtyFields,re),!G.keepTouched&&sr(n.touchedFields,re),!G.keepIsValidating&&sr(n.validatingFields,re),!e.shouldUnregister&&!G.keepDefaultValue&&sr(s,re);p.state.next({values:kn(i)}),p.state.next({...n,...G.keepDirty?{isDirty:F()}:{}}),!G.keepIsValid&&b()},Fe=({disabled:U,name:G})=>{(si(U)&&o.mount||U||l.disabled.has(G))&&(U?l.disabled.add(G):l.disabled.delete(G))},vt=(U,G={})=>{let re=Ie(r,U);const Ae=si(G.disabled)||si(e.disabled);return Qt(r,U,{...re||{},_f:{...re&&re._f?re._f:{ref:{name:U}},name:U,mount:!0,...G}}),l.mount.add(U),re?Fe({disabled:si(G.disabled)?G.disabled:e.disabled,name:U}):T(U,!0,G.value),{...Ae?{disabled:G.disabled||e.disabled}:{},...e.progressive?{required:!!G.required,min:Yp(G.min),max:Yp(G.max),minLength:Yp(G.minLength),maxLength:Yp(G.maxLength),pattern:Yp(G.pattern)}:{},name:U,onChange:le,onBlur:le,ref:Te=>{if(Te){vt(U,G),re=Ie(r,U);const _e=vn(Te.value)&&Te.querySelectorAll&&Te.querySelectorAll("input,select,textarea")[0]||Te,Pe=G1e(_e),lt=re._f.refs||[];if(Pe?lt.find(Vt=>Vt===_e):_e===re._f.ref)return;Qt(r,U,{_f:{...re._f,...Pe?{refs:[...lt.filter(SE),_e,...Array.isArray(Ie(s,U))?[{}]:[]],ref:{type:_e.type,name:U}}:{ref:_e}}}),T(U,!1,void 0,_e)}else re=Ie(r,U,{}),re._f&&(re._f.mount=!1),(e.shouldUnregister||G.shouldUnregister)&&!(Wq(l.array,U)&&o.action)&&l.unMount.add(U)}}},ce=()=>e.shouldFocusError&&jf(r,q,l.mount),Be=U=>{si(U)&&(p.state.next({disabled:U}),jf(r,(G,re)=>{const Ae=Ie(r,re);Ae&&(G.disabled=Ae._f.disabled||U,Array.isArray(Ae._f.refs)&&Ae._f.refs.forEach(Te=>{Te.disabled=Ae._f.disabled||U}))},0,!1))},Ye=(U,G)=>async re=>{let Ae;re&&(re.preventDefault&&re.preventDefault(),re.persist&&re.persist());let Te=kn(i);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:_e,values:Pe}=await R();n.errors=_e,Te=kn(Pe)}else await O(r);if(l.disabled.size)for(const _e of l.disabled)sr(Te,_e);if(sr(n.errors,"root"),is(n.errors)){p.state.next({errors:{}});try{await U(Te,re)}catch(_e){Ae=_e}}else G&&await G({...n.errors},re),ce(),setTimeout(ce);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:is(n.errors)&&!Ae,submitCount:n.submitCount+1,errors:n.errors}),Ae)throw Ae},pe=(U,G={})=>{Ie(r,U)&&(vn(G.defaultValue)?ve(U,kn(Ie(s,U))):(ve(U,G.defaultValue),Qt(s,U,kn(G.defaultValue))),G.keepTouched||sr(n.touchedFields,U),G.keepDirty||(sr(n.dirtyFields,U),n.isDirty=G.defaultValue?F(U,kn(Ie(s,U))):F()),G.keepError||(sr(n.errors,U),h.isValid&&b()),p.state.next({...n}))},bt=(U,G={})=>{const re=U?kn(U):s,Ae=kn(re),Te=is(U),_e=Te?s:Ae;if(G.keepDefaultValues||(s=re),!G.keepValues){if(G.keepDirtyValues){const Pe=new Set([...l.mount,...Object.keys(Bh(s,i))]);for(const lt of Array.from(Pe))Ie(n.dirtyFields,lt)?Qt(_e,lt,Ie(i,lt)):ve(lt,Ie(_e,lt))}else{if(WR&&vn(U))for(const Pe of l.mount){const lt=Ie(r,Pe);if(lt&&lt._f){const Vt=Array.isArray(lt._f.refs)?lt._f.refs[0]:lt._f.ref;if(Ew(Vt)){const Wr=Vt.closest("form");if(Wr){Wr.reset();break}}}}if(G.keepFieldsRef)for(const Pe of l.mount)ve(Pe,Ie(_e,Pe));else r={}}i=e.shouldUnregister?G.keepDefaultValues?kn(s):{}:kn(_e),p.array.next({values:{..._e}}),p.state.next({values:{..._e}})}l={mount:G.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!h.isValid||!!G.keepIsValid||!!G.keepDirtyValues||!e.shouldUnregister&&!is(_e),o.watch=!!e.shouldUnregister,o.action=!1,G.keepErrors||(n.errors={}),p.state.next({submitCount:G.keepSubmitCount?n.submitCount:0,isDirty:Te?!1:G.keepDirty?n.isDirty:!!(G.keepDefaultValues&&!lo(U,s)),isSubmitted:G.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Te?{}:G.keepDirtyValues?G.keepDefaultValues&&i?Bh(s,i):n.dirtyFields:G.keepDefaultValues&&U?Bh(s,U):G.keepDirty?n.dirtyFields:{},touchedFields:G.keepTouched?n.touchedFields:{},errors:G.keepErrors?n.errors:{},isSubmitSuccessful:G.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},Ht=(U,G)=>bt(co(U)?U(i):U,G),vr=(U,G={})=>{const re=Ie(r,U),Ae=re&&re._f;if(Ae){const Te=Ae.refs?Ae.refs[0]:Ae.ref;Te.focus&&(Te.focus(),G.shouldSelect&&co(Te.select)&&Te.select())}},nr=U=>{n={...n,...U}},he={control:{register:vt,unregister:be,getFieldState:X,handleSubmit:Ye,setError:ae,_subscribe:ge,_runSchema:R,_focusError:ce,_getWatch:V,_getDirty:F,_setValid:b,_setFieldArray:k,_setDisabledField:Fe,_setErrors:S,_getFieldArray:$,_reset:bt,_resetDefaultValues:()=>co(e.defaultValues)&&e.defaultValues().then(U=>{Ht(U,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:D,_disableForm:Be,_subjects:p,_proxyFormState:h,get _fields(){return r},get _formValues(){return i},get _state(){return o},set _state(U){o=U},get _defaultValues(){return s},get _names(){return l},set _names(U){l=U},get _formState(){return n},get _options(){return e},set _options(U){e={...e,...U}}},subscribe:te,trigger:Q,register:vt,handleSubmit:Ye,watch:je,setValue:ve,getValues:H,reset:Ht,resetField:pe,clearErrors:oe,unregister:be,setError:ae,setFocus:vr,getFieldState:X};return{...he,formControl:he}}var Ml=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const t=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(Math.random()*16+t)%16|0;return(e=="x"?n:n&3|8).toString(16)})},TE=(t,e,n={})=>n.shouldFocus||vn(n.shouldFocus)?n.focusName||`${t}.${vn(n.focusIndex)?e:n.focusIndex}.`:"",CE=(t,e)=>[...t,...Hs(e)],IE=t=>Array.isArray(t)?t.map(()=>{}):void 0;function jE(t,e,n){return[...t.slice(0,e),...Hs(n),...t.slice(e)]}var AE=(t,e,n)=>Array.isArray(t)?(vn(t[n])&&(t[n]=void 0),t.splice(n,0,t.splice(e,1)[0]),t):[],RE=(t,e)=>[...Hs(e),...Hs(t)];function oNe(t,e){let n=0;const r=[...t];for(const s of e)r.splice(s-n,1),n++;return $1(r).length?r:[]}var PE=(t,e)=>vn(e)?[]:oNe(t,Hs(e).sort((n,r)=>n-r)),LE=(t,e,n)=>{[t[e],t[n]]=[t[n],t[e]]},_V=(t,e,n)=>(t[e]=n,t);function aNe(t){const e=B1(),{control:n=e.control,name:r,keyName:s="id",shouldUnregister:i,rules:o}=t,[l,c]=He.useState(n._getFieldArray(r)),d=He.useRef(n._getFieldArray(r).map(Ml)),h=He.useRef(!1);n._names.array.add(r),He.useMemo(()=>o&&l.length>=0&&n.register(r,o),[n,r,l.length,o]),z1(()=>n._subjects.array.subscribe({next:({values:T,name:P})=>{if(P===r||!P){const j=Ie(T,r);Array.isArray(j)&&(c(j),d.current=j.map(Ml))}}}).unsubscribe,[n,r]);const m=He.useCallback(T=>{h.current=!0,n._setFieldArray(r,T)},[n,r]),p=(T,P)=>{const j=Hs(kn(T)),R=CE(n._getFieldArray(r),j);n._names.focus=TE(r,R.length-1,P),d.current=CE(d.current,j.map(Ml)),m(R),c(R),n._setFieldArray(r,R,CE,{argA:IE(T)})},v=(T,P)=>{const j=Hs(kn(T)),R=RE(n._getFieldArray(r),j);n._names.focus=TE(r,0,P),d.current=RE(d.current,j.map(Ml)),m(R),c(R),n._setFieldArray(r,R,RE,{argA:IE(T)})},x=T=>{const P=PE(n._getFieldArray(r),T);d.current=PE(d.current,T),m(P),c(P),!Array.isArray(Ie(n._fields,r))&&Qt(n._fields,r,void 0),n._setFieldArray(r,P,PE,{argA:T})},b=(T,P,j)=>{const R=Hs(kn(P)),I=jE(n._getFieldArray(r),T,R);n._names.focus=TE(r,T,j),d.current=jE(d.current,T,R.map(Ml)),m(I),c(I),n._setFieldArray(r,I,jE,{argA:T,argB:IE(P)})},E=(T,P)=>{const j=n._getFieldArray(r);LE(j,T,P),LE(d.current,T,P),m(j),c(j),n._setFieldArray(r,j,LE,{argA:T,argB:P},!1)},k=(T,P)=>{const j=n._getFieldArray(r);AE(j,T,P),AE(d.current,T,P),m(j),c(j),n._setFieldArray(r,j,AE,{argA:T,argB:P},!1)},_=(T,P)=>{const j=kn(P),R=_V(n._getFieldArray(r),T,j);d.current=[...R].map((I,O)=>!I||O===T?Ml():d.current[O]),m(R),c([...R]),n._setFieldArray(r,R,_V,{argA:T,argB:j},!0,!1)},S=T=>{const P=Hs(kn(T));d.current=P.map(Ml),m([...P]),c([...P]),n._setFieldArray(r,[...P],j=>j,{},!0,!1)};return He.useEffect(()=>{if(n._state.action=!1,UC(r,n._names)&&n._subjects.state.next({...n._formState}),h.current&&(!hf(n._options.mode).isOnSubmit||n._formState.isSubmitted)&&!hf(n._options.reValidateMode).isOnSubmit)if(n._options.resolver)n._runSchema([r]).then(T=>{const P=Ie(T.errors,r),j=Ie(n._formState.errors,r);(j?!P&&j.type||P&&(j.type!==P.type||j.message!==P.message):P&&P.type)&&(P?Qt(n._formState.errors,r,P):sr(n._formState.errors,r),n._subjects.state.next({errors:n._formState.errors}))});else{const T=Ie(n._fields,r);T&&T._f&&!(hf(n._options.reValidateMode).isOnSubmit&&hf(n._options.mode).isOnSubmit)&&WC(T,n._names.disabled,n._formValues,n._options.criteriaMode===Di.all,n._options.shouldUseNativeValidation,!0).then(P=>!is(P)&&n._subjects.state.next({errors:eG(n._formState.errors,P,r)}))}n._subjects.state.next({name:r,values:kn(n._formValues)}),n._names.focus&&jf(n._fields,(T,P)=>{if(n._names.focus&&P.startsWith(n._names.focus)&&T.focus)return T.focus(),1}),n._names.focus="",n._setValid(),h.current=!1},[l,r,n]),He.useEffect(()=>(!Ie(n._formValues,r)&&n._setFieldArray(r),()=>{const T=(P,j)=>{const R=Ie(n._fields,P);R&&R._f&&(R._f.mount=j)};n._options.shouldUnregister||i?n.unregister(r):T(r,!1)}),[r,n,s,i]),{swap:He.useCallback(E,[m,r,n]),move:He.useCallback(k,[m,r,n]),prepend:He.useCallback(v,[m,r,n]),append:He.useCallback(p,[m,r,n]),remove:He.useCallback(x,[m,r,n]),insert:He.useCallback(b,[m,r,n]),update:He.useCallback(_,[m,r,n]),replace:He.useCallback(S,[m,r,n]),fields:He.useMemo(()=>l.map((T,P)=>({...T,[s]:d.current[P]||Ml()})),[l,s])}}function KR(t={}){const e=He.useRef(void 0),n=He.useRef(void 0),[r,s]=He.useState({isDirty:!1,isValidating:!1,isLoading:co(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:co(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!co(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...l}=iNe(t);e.current={...l,formState:r}}const i=e.current.control;return i._options=t,z1(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>s({...i._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),He.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),He.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),He.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),He.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),He.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==r.isDirty&&i._subjects.state.next({isDirty:o})}},[i,r.isDirty]),He.useEffect(()=>{var o;t.values&&!lo(t.values,n.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),!((o=i._options.resetOptions)===null||o===void 0)&&o.keepIsValid||i._setValid(),n.current=t.values,s(l=>({...l}))):i._resetDefaultValues()},[i,t.values]),He.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=qq(r,i),e.current}const wV=(t,e,n)=>{if(t&&"reportValidity"in t){const r=Ie(n,e);t.setCustomValidity(r&&r.message||""),t.reportValidity()}},tG=(t,e)=>{for(const n in e.fields){const r=e.fields[n];r&&r.ref&&"reportValidity"in r.ref?wV(r.ref,n,t):r.refs&&r.refs.forEach(s=>wV(s,n,t))}},lNe=(t,e)=>{e.shouldUseNativeValidation&&tG(t,e);const n={};for(const r in t){const s=Ie(e.fields,r),i=Object.assign(t[r]||{},{ref:s&&s.ref});if(cNe(e.names||Object.keys(t),r)){const o=Object.assign({},Ie(n,r));Qt(o,"root",i),Qt(n,r,o)}else Qt(n,r,i)}return n},cNe=(t,e)=>t.some(n=>n.startsWith(e+"."));var uNe=function(t,e){for(var n={};t.length;){var r=t[0],s=r.code,i=r.message,o=r.path.join(".");if(!n[o])if("unionErrors"in r){var l=r.unionErrors[0].errors[0];n[o]={message:l.message,type:l.code}}else n[o]={message:i,type:s};if("unionErrors"in r&&r.unionErrors.forEach(function(h){return h.errors.forEach(function(m){return t.push(m)})}),e){var c=n[o].types,d=c&&c[r.code];n[o]=Gq(o,e,n,s,d?[].concat(d,r.message):r.message)}t.shift()}return n},QR=function(t,e,n){return n===void 0&&(n={}),function(r,s,i){try{return Promise.resolve(function(o,l){try{var c=Promise.resolve(t[n.mode==="sync"?"parse":"parseAsync"](r,e)).then(function(d){return i.shouldUseNativeValidation&&tG({},i),{errors:{},values:n.raw?r:d}})}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(o))return{values:{},errors:lNe(uNe(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},qt;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of i)o[l]=s[l];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(qt||(qt={}));var kV;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(kV||(kV={}));const We=qt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),$l=t=>{switch(typeof t){case"undefined":return We.undefined;case"string":return We.string;case"number":return Number.isNaN(t)?We.nan:We.number;case"boolean":return We.boolean;case"function":return We.function;case"bigint":return We.bigint;case"symbol":return We.symbol;case"object":return Array.isArray(t)?We.array:t===null?We.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?We.promise:typeof Map<"u"&&t instanceof Map?We.map:typeof Set<"u"&&t instanceof Set?We.set:typeof Date<"u"&&t instanceof Date?We.date:We.object;default:return We.unknown}},ke=qt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ll extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(n(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(e){if(!(e instanceof ll))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,qt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const i=s.path[0];n[i]=n[i]||[],n[i].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}ll.create=t=>new ll(t);const HC=(t,e)=>{let n;switch(t.code){case ke.invalid_type:t.received===We.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ke.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,qt.jsonStringifyReplacer)}`;break;case ke.unrecognized_keys:n=`Unrecognized key(s) in object: ${qt.joinValues(t.keys,", ")}`;break;case ke.invalid_union:n="Invalid input";break;case ke.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${qt.joinValues(t.options)}`;break;case ke.invalid_enum_value:n=`Invalid enum value. Expected ${qt.joinValues(t.options)}, received '${t.received}'`;break;case ke.invalid_arguments:n="Invalid function arguments";break;case ke.invalid_return_type:n="Invalid function return type";break;case ke.invalid_date:n="Invalid date";break;case ke.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:qt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ke.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ke.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ke.custom:n="Invalid input";break;case ke.invalid_intersection_types:n="Intersection results could not be merged";break;case ke.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ke.not_finite:n="Number must be finite";break;default:n=e.defaultError,qt.assertNever(t)}return{message:n}};let dNe=HC;function hNe(){return dNe}const fNe=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...s,path:i,message:l}};function De(t,e){const n=hNe(),r=fNe({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===HC?void 0:HC].filter(s=>!!s)});t.common.issues.push(r)}class bi{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return pt;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n){const i=await s.key,o=await s.value;r.push({key:i,value:o})}return bi.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return pt;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const pt=Object.freeze({status:"aborted"}),wg=t=>({status:"dirty",value:t}),Ki=t=>({status:"valid",value:t}),NV=t=>t.status==="aborted",EV=t=>t.status==="dirty",bm=t=>t.status==="valid",Tw=t=>typeof Promise<"u"&&t instanceof Promise;var qe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(qe||(qe={}));class Wc{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const SV=(t,e)=>{if(bm(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new ll(t.common.issues);return this._error=n,this._error}}};function At(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,l)=>{const{message:c}=t;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??n??l.defaultError}},description:s}}class Wt{get description(){return this._def.description}_getType(e){return $l(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:$l(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new bi,ctx:{common:e.parent.common,data:e.data,parsedType:$l(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Tw(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:$l(e)},s=this._parseSync({data:e,path:r.path,parent:r});return SV(r,s)}"~validate"(e){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:$l(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return bm(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>bm(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:$l(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(Tw(s)?s:Promise.resolve(s));return SV(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),l=()=>i.addIssue({code:ke.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new km({schema:this,typeName:gt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ec.create(this,this._def)}nullable(){return Nm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Qo.create(this)}promise(){return Aw.create(this,this._def)}or(e){return Iw.create([this,e],this._def)}and(e){return jw.create(this,e,this._def)}transform(e){return new km({...At(this._def),schema:this,typeName:gt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new KC({...At(this._def),innerType:this,defaultValue:n,typeName:gt.ZodDefault})}brand(){return new ONe({typeName:gt.ZodBranded,type:this,...At(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new QC({...At(this._def),innerType:this,catchValue:n,typeName:gt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return ZR.create(this,e)}readonly(){return ZC.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const mNe=/^c[^\s-]{8,}$/i,pNe=/^[0-9a-z]+$/,gNe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,yNe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xNe=/^[a-z0-9_-]{21}$/i,vNe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,bNe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,_Ne=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,wNe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ME;const kNe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,NNe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ENe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,SNe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,TNe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,CNe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",INe=new RegExp(`^${nG}$`);function rG(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function jNe(t){return new RegExp(`^${rG(t)}$`)}function ANe(t){let e=`${nG}T${rG(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function RNe(t,e){return!!((e==="v4"||!e)&&kNe.test(t)||(e==="v6"||!e)&&ENe.test(t))}function PNe(t,e){if(!vNe.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function LNe(t,e){return!!((e==="v4"||!e)&&NNe.test(t)||(e==="v6"||!e)&&SNe.test(t))}class ic extends Wt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==We.string){const i=this._getOrReturnCtx(e);return De(i,{code:ke.invalid_type,expected:We.string,received:i.parsedType}),pt}const r=new bi;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),De(s,{code:ke.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),De(s,{code:ke.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,l=e.data.length<i.value;(o||l)&&(s=this._getOrReturnCtx(e,s),o?De(s,{code:ke.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&De(s,{code:ke.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")_Ne.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"email",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")ME||(ME=new RegExp(wNe,"u")),ME.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"emoji",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")yNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"uuid",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")xNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"nanoid",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")mNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"cuid",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")pNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"cuid2",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")gNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"ulid",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),De(s,{validation:"url",code:ke.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"regex",code:ke.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),De(s,{code:ke.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),De(s,{code:ke.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),De(s,{code:ke.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?ANe(i).test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{code:ke.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?INe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{code:ke.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?jNe(i).test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{code:ke.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?bNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"duration",code:ke.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?RNe(e.data,i.version)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"ip",code:ke.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?PNe(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"jwt",code:ke.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?LNe(e.data,i.version)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"cidr",code:ke.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?TNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"base64",code:ke.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?CNe.test(e.data)||(s=this._getOrReturnCtx(e,s),De(s,{validation:"base64url",code:ke.invalid_string,message:i.message}),r.dirty()):qt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:ke.invalid_string,...qe.errToObj(r)})}_addCheck(e){return new ic({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...qe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...qe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...qe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...qe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...qe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...qe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...qe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...qe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...qe.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...qe.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...qe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...qe.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...qe.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...qe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...qe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...qe.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...qe.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...qe.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...qe.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...qe.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...qe.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...qe.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...qe.errToObj(n)})}nonempty(e){return this.min(1,qe.errToObj(e))}trim(){return new ic({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ic({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ic({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ic.create=t=>new ic({checks:[],typeName:gt.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...At(t)});function MNe(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(t.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return i%o/10**s}class _m extends Wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==We.number){const i=this._getOrReturnCtx(e);return De(i,{code:ke.invalid_type,expected:We.number,received:i.parsedType}),pt}let r;const s=new bi;for(const i of this._def.checks)i.kind==="int"?qt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),De(r,{code:ke.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),De(r,{code:ke.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),De(r,{code:ke.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?MNe(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),De(r,{code:ke.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),De(r,{code:ke.not_finite,message:i.message}),s.dirty()):qt.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,qe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,qe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,qe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,qe.toString(n))}setLimit(e,n,r,s){return new _m({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:qe.toString(s)}]})}_addCheck(e){return new _m({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:qe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:qe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:qe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:qe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:qe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:qe.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:qe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:qe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:qe.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&qt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}_m.create=t=>new _m({checks:[],typeName:gt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...At(t)});class m0 extends Wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==We.bigint)return this._getInvalidInput(e);let r;const s=new bi;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),De(r,{code:ke.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),De(r,{code:ke.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),De(r,{code:ke.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):qt.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return De(n,{code:ke.invalid_type,expected:We.bigint,received:n.parsedType}),pt}gte(e,n){return this.setLimit("min",e,!0,qe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,qe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,qe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,qe.toString(n))}setLimit(e,n,r,s){return new m0({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:qe.toString(s)}]})}_addCheck(e){return new m0({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:qe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:qe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:qe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:qe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:qe.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}m0.create=t=>new m0({checks:[],typeName:gt.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...At(t)});class TV extends Wt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==We.boolean){const r=this._getOrReturnCtx(e);return De(r,{code:ke.invalid_type,expected:We.boolean,received:r.parsedType}),pt}return Ki(e.data)}}TV.create=t=>new TV({typeName:gt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...At(t)});class Cw extends Wt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==We.date){const i=this._getOrReturnCtx(e);return De(i,{code:ke.invalid_type,expected:We.date,received:i.parsedType}),pt}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return De(i,{code:ke.invalid_date}),pt}const r=new bi;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),De(s,{code:ke.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),De(s,{code:ke.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):qt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Cw({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:qe.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:qe.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Cw.create=t=>new Cw({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:gt.ZodDate,...At(t)});class CV extends Wt{_parse(e){if(this._getType(e)!==We.symbol){const r=this._getOrReturnCtx(e);return De(r,{code:ke.invalid_type,expected:We.symbol,received:r.parsedType}),pt}return Ki(e.data)}}CV.create=t=>new CV({typeName:gt.ZodSymbol,...At(t)});class IV extends Wt{_parse(e){if(this._getType(e)!==We.undefined){const r=this._getOrReturnCtx(e);return De(r,{code:ke.invalid_type,expected:We.undefined,received:r.parsedType}),pt}return Ki(e.data)}}IV.create=t=>new IV({typeName:gt.ZodUndefined,...At(t)});class jV extends Wt{_parse(e){if(this._getType(e)!==We.null){const r=this._getOrReturnCtx(e);return De(r,{code:ke.invalid_type,expected:We.null,received:r.parsedType}),pt}return Ki(e.data)}}jV.create=t=>new jV({typeName:gt.ZodNull,...At(t)});class AV extends Wt{constructor(){super(...arguments),this._any=!0}_parse(e){return Ki(e.data)}}AV.create=t=>new AV({typeName:gt.ZodAny,...At(t)});class RV extends Wt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ki(e.data)}}RV.create=t=>new RV({typeName:gt.ZodUnknown,...At(t)});class Hc extends Wt{_parse(e){const n=this._getOrReturnCtx(e);return De(n,{code:ke.invalid_type,expected:We.never,received:n.parsedType}),pt}}Hc.create=t=>new Hc({typeName:gt.ZodNever,...At(t)});class PV extends Wt{_parse(e){if(this._getType(e)!==We.undefined){const r=this._getOrReturnCtx(e);return De(r,{code:ke.invalid_type,expected:We.void,received:r.parsedType}),pt}return Ki(e.data)}}PV.create=t=>new PV({typeName:gt.ZodVoid,...At(t)});class Qo extends Wt{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==We.array)return De(n,{code:ke.invalid_type,expected:We.array,received:n.parsedType}),pt;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,l=n.data.length<s.exactLength.value;(o||l)&&(De(n,{code:o?ke.too_big:ke.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(De(n,{code:ke.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(De(n,{code:ke.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,l)=>s.type._parseAsync(new Wc(n,o,n.path,l)))).then(o=>bi.mergeArray(r,o));const i=[...n.data].map((o,l)=>s.type._parseSync(new Wc(n,o,n.path,l)));return bi.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Qo({...this._def,minLength:{value:e,message:qe.toString(n)}})}max(e,n){return new Qo({...this._def,maxLength:{value:e,message:qe.toString(n)}})}length(e,n){return new Qo({...this._def,exactLength:{value:e,message:qe.toString(n)}})}nonempty(e){return this.min(1,e)}}Qo.create=(t,e)=>new Qo({type:t,minLength:null,maxLength:null,exactLength:null,typeName:gt.ZodArray,...At(e)});function zh(t){if(t instanceof mr){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Ec.create(zh(r))}return new mr({...t._def,shape:()=>e})}else return t instanceof Qo?new Qo({...t._def,type:zh(t.element)}):t instanceof Ec?Ec.create(zh(t.unwrap())):t instanceof Nm?Nm.create(zh(t.unwrap())):t instanceof jd?jd.create(t.items.map(e=>zh(e))):t}class mr extends Wt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=qt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==We.object){const d=this._getOrReturnCtx(e);return De(d,{code:ke.invalid_type,expected:We.object,received:d.parsedType}),pt}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Hc&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const h=i[d],m=s.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new Wc(s,m,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof Hc){const d=this._def.unknownKeys;if(d==="passthrough")for(const h of l)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(d==="strict")l.length>0&&(De(s,{code:ke.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const h of l){const m=s.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new Wc(s,m,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const h of c){const m=await h.key,p=await h.value;d.push({key:m,value:p,alwaysSet:h.alwaysSet})}return d}).then(d=>bi.mergeObjectSync(r,d)):bi.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return qe.errToObj,new mr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,o;const s=((o=(i=this._def).errorMap)==null?void 0:o.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:qe.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new mr({...this._def,unknownKeys:"strip"})}passthrough(){return new mr({...this._def,unknownKeys:"passthrough"})}extend(e){return new mr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new mr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:gt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new mr({...this._def,catchall:e})}pick(e){const n={};for(const r of qt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new mr({...this._def,shape:()=>n})}omit(e){const n={};for(const r of qt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new mr({...this._def,shape:()=>n})}deepPartial(){return zh(this)}partial(e){const n={};for(const r of qt.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}return new mr({...this._def,shape:()=>n})}required(e){const n={};for(const r of qt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Ec;)i=i._def.innerType;n[r]=i}return new mr({...this._def,shape:()=>n})}keyof(){return sG(qt.objectKeys(this.shape))}}mr.create=(t,e)=>new mr({shape:()=>t,unknownKeys:"strip",catchall:Hc.create(),typeName:gt.ZodObject,...At(e)});mr.strictCreate=(t,e)=>new mr({shape:()=>t,unknownKeys:"strict",catchall:Hc.create(),typeName:gt.ZodObject,...At(e)});mr.lazycreate=(t,e)=>new mr({shape:t,unknownKeys:"strip",catchall:Hc.create(),typeName:gt.ZodObject,...At(e)});class Iw extends Wt{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return n.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new ll(l.ctx.common.issues));return De(n,{code:ke.invalid_union,unionErrors:o}),pt}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const d={...n,common:{...n.common,issues:[]},parent:null},h=c._parseSync({data:n.data,path:n.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new ll(c));return De(n,{code:ke.invalid_union,unionErrors:l}),pt}}get options(){return this._def.options}}Iw.create=(t,e)=>new Iw({options:t,typeName:gt.ZodUnion,...At(e)});function qC(t,e){const n=$l(t),r=$l(e);if(t===e)return{valid:!0,data:t};if(n===We.object&&r===We.object){const s=qt.objectKeys(e),i=qt.objectKeys(t).filter(l=>s.indexOf(l)!==-1),o={...t,...e};for(const l of i){const c=qC(t[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(n===We.array&&r===We.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],l=e[i],c=qC(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===We.date&&r===We.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class jw extends Wt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(NV(i)||NV(o))return pt;const l=qC(i.value,o.value);return l.valid?((EV(i)||EV(o))&&n.dirty(),{status:n.value,value:l.data}):(De(r,{code:ke.invalid_intersection_types}),pt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}jw.create=(t,e,n)=>new jw({left:t,right:e,typeName:gt.ZodIntersection,...At(n)});class jd extends Wt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==We.array)return De(r,{code:ke.invalid_type,expected:We.array,received:r.parsedType}),pt;if(r.data.length<this._def.items.length)return De(r,{code:ke.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),pt;!this._def.rest&&r.data.length>this._def.items.length&&(De(r,{code:ke.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new Wc(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>bi.mergeArray(n,o)):bi.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new jd({...this._def,rest:e})}}jd.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new jd({items:t,typeName:gt.ZodTuple,rest:null,...At(e)})};class LV extends Wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==We.map)return De(r,{code:ke.invalid_type,expected:We.map,received:r.parsedType}),pt;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new Wc(r,l,r.path,[d,"key"])),value:i._parse(new Wc(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return pt;(d.status==="dirty"||h.status==="dirty")&&n.dirty(),l.set(d.value,h.value)}return{status:n.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return pt;(d.status==="dirty"||h.status==="dirty")&&n.dirty(),l.set(d.value,h.value)}return{status:n.value,value:l}}}}LV.create=(t,e,n)=>new LV({valueType:e,keyType:t,typeName:gt.ZodMap,...At(n)});class p0 extends Wt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==We.set)return De(r,{code:ke.invalid_type,expected:We.set,received:r.parsedType}),pt;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(De(r,{code:ke.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(De(r,{code:ke.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const h of c){if(h.status==="aborted")return pt;h.status==="dirty"&&n.dirty(),d.add(h.value)}return{status:n.value,value:d}}const l=[...r.data.values()].map((c,d)=>i._parse(new Wc(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,n){return new p0({...this._def,minSize:{value:e,message:qe.toString(n)}})}max(e,n){return new p0({...this._def,maxSize:{value:e,message:qe.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}p0.create=(t,e)=>new p0({valueType:t,minSize:null,maxSize:null,typeName:gt.ZodSet,...At(e)});class MV extends Wt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}MV.create=(t,e)=>new MV({getter:t,typeName:gt.ZodLazy,...At(e)});class GC extends Wt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return De(n,{received:n.data,code:ke.invalid_literal,expected:this._def.value}),pt}return{status:"valid",value:e.data}}get value(){return this._def.value}}GC.create=(t,e)=>new GC({value:t,typeName:gt.ZodLiteral,...At(e)});function sG(t,e){return new wm({values:t,typeName:gt.ZodEnum,...At(e)})}class wm extends Wt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return De(n,{expected:qt.joinValues(r),received:n.parsedType,code:ke.invalid_type}),pt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return De(n,{received:n.data,code:ke.invalid_enum_value,options:r}),pt}return Ki(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return wm.create(e,{...this._def,...n})}exclude(e,n=this._def){return wm.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}wm.create=sG;class OV extends Wt{_parse(e){const n=qt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==We.string&&r.parsedType!==We.number){const s=qt.objectValues(n);return De(r,{expected:qt.joinValues(s),received:r.parsedType,code:ke.invalid_type}),pt}if(this._cache||(this._cache=new Set(qt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=qt.objectValues(n);return De(r,{received:r.data,code:ke.invalid_enum_value,options:s}),pt}return Ki(e.data)}get enum(){return this._def.values}}OV.create=(t,e)=>new OV({values:t,typeName:gt.ZodNativeEnum,...At(e)});class Aw extends Wt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==We.promise&&n.common.async===!1)return De(n,{code:ke.invalid_type,expected:We.promise,received:n.parsedType}),pt;const r=n.parsedType===We.promise?n.data:Promise.resolve(n.data);return Ki(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Aw.create=(t,e)=>new Aw({type:t,typeName:gt.ZodPromise,...At(e)});class km extends Wt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===gt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{De(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async l=>{if(n.value==="aborted")return pt;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?pt:c.status==="dirty"||n.value==="dirty"?wg(c.value):c});{if(n.value==="aborted")return pt;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?pt:l.status==="dirty"||n.value==="dirty"?wg(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?pt:(l.status==="dirty"&&n.dirty(),o(l.value),{status:n.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?pt:(l.status==="dirty"&&n.dirty(),o(l.value).then(()=>({status:n.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!bm(o))return pt;const l=s.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>bm(o)?Promise.resolve(s.transform(o.value,i)).then(l=>({status:n.value,value:l})):pt);qt.assertNever(s)}}km.create=(t,e,n)=>new km({schema:t,typeName:gt.ZodEffects,effect:e,...At(n)});km.createWithPreprocess=(t,e,n)=>new km({schema:e,effect:{type:"preprocess",transform:t},typeName:gt.ZodEffects,...At(n)});class Ec extends Wt{_parse(e){return this._getType(e)===We.undefined?Ki(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ec.create=(t,e)=>new Ec({innerType:t,typeName:gt.ZodOptional,...At(e)});class Nm extends Wt{_parse(e){return this._getType(e)===We.null?Ki(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Nm.create=(t,e)=>new Nm({innerType:t,typeName:gt.ZodNullable,...At(e)});class KC extends Wt{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===We.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}KC.create=(t,e)=>new KC({innerType:t,typeName:gt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...At(e)});class QC extends Wt{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Tw(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ll(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ll(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}QC.create=(t,e)=>new QC({innerType:t,typeName:gt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...At(e)});class DV extends Wt{_parse(e){if(this._getType(e)!==We.nan){const r=this._getOrReturnCtx(e);return De(r,{code:ke.invalid_type,expected:We.nan,received:r.parsedType}),pt}return{status:"valid",value:e.data}}}DV.create=t=>new DV({typeName:gt.ZodNaN,...At(t)});class ONe extends Wt{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ZR extends Wt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?pt:i.status==="dirty"?(n.dirty(),wg(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?pt:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new ZR({in:e,out:n,typeName:gt.ZodPipeline})}}class ZC extends Wt{_parse(e){const n=this._def.innerType._parse(e),r=s=>(bm(s)&&(s.value=Object.freeze(s.value)),s);return Tw(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}ZC.create=(t,e)=>new ZC({innerType:t,typeName:gt.ZodReadonly,...At(e)});var gt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(gt||(gt={}));const ls=ic.create,Rw=_m.create;Hc.create;const VV=Qo.create,Pw=mr.create;Iw.create;jw.create;jd.create;const FV=GC.create;wm.create;Aw.create;Ec.create;Nm.create;const DNe=Pw({sessionName:ls().min(3,"Session name must be at least 3 chars"),date:ls().optional(),time:ls().optional(),duration:Rw().min(1).max(24)});function VNe({user:t,userData:e,cart:n,onRemoveFromCart:r,onClose:s,onComplete:i}){const[o,l]=N.useState(!1),{register:c,handleSubmit:d,watch:h,formState:{errors:m,isValid:p}}=KR({resolver:QR(DNe),defaultValues:{sessionName:`${e.lastName} Session`,duration:4,date:"",time:""},mode:"onChange"}),v=h("duration")||0,x=()=>{let j=0;const R=parseInt(v)||0,I=n.map(V=>{const $=V.rate||0,J=$*R;return j+=J,{...V,itemTotal:J,hourlyRate:$}}),O=n.length>=3,D=O?j*.1:0,F=j-D;return{subtotal:j,discountAmount:D,finalTotal:F,lineItems:I,shouldDiscount:O}},{subtotal:b,discountAmount:E,finalTotal:k,lineItems:_,shouldDiscount:S}=x(),T=async j=>{l(!0);const R=un.loading("Initializing Session...");try{const I=D1();let O=null;if(k>0){const V=V1(I,"createSplitPayment"),$={totalAmount:k,description:`Session: ${j.sessionName}`,transfers:_.map(ue=>{var ve;return{recipientId:ue.id,amount:ue.itemTotal*(S?.9:1),role:((ve=ue.accountTypes)==null?void 0:ve[0])||"Creative"}})},{data:J}=await V($);if(!J.clientSecret)throw new Error("Payment initialization failed");O=J.paymentIntentId}const D=`session_${Date.now()}`,F=_.map(V=>{var $;return hn(Re(Z,`artifacts/${Ge}/public/data/bookings`),{groupId:D,sessionName:j.sessionName,senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,targetId:V.id,targetName:`${V.firstName} ${V.lastName}`,serviceType:(($=V.accountTypes)==null?void 0:$[0])||"Session",date:j.date||"Flexible",time:j.time||"Flexible",duration:j.duration,offerAmount:V.itemTotal*(S?.9:1),status:"Pending",paymentIntentId:O,timestamp:zt(),type:"GroupSession"})});await Promise.all(F),un.success("Session Created!",{id:R}),i()}catch(I){console.error("Booking Error:",I),un.error("Failed: "+I.message,{id:R})}finally{l(!1)}},P=j=>xx("w-full p-2 border rounded-lg dark:bg-black/20 dark:text-white transition-colors focus:ring-2 focus:ring-brand-blue outline-none",j?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-200 dark:border-gray-600");return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4 animate-in fade-in",children:a.jsxs("form",{onSubmit:d(T),className:"bg-white dark:bg-[#2c2e36] w-full max-w-2xl rounded-2xl shadow-2xl border dark:border-gray-700 flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] rounded-t-2xl",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-extrabold dark:text-white flex items-center gap-2",children:[a.jsx(Rs,{className:"text-brand-blue"})," Session Builder"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:[n.length," Members Selected"]})]}),a.jsx("button",{type:"button",onClick:s,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Session Name"}),a.jsx("input",{...c("sessionName"),className:P(m.sessionName),placeholder:"e.g. My Album Recording"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Date (Optional)"}),a.jsx("input",{type:"date",...c("date"),className:P(m.date)})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Time (Optional)"}),a.jsx("input",{type:"time",...c("time"),className:P(m.time)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Duration (Hours)"}),a.jsx("input",{type:"number",...c("duration",{valueAsNumber:!0}),className:P(m.duration)})]})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[a.jsx("h3",{className:"text-sm font-bold dark:text-white mb-3",children:"Session Roster"}),a.jsxs("div",{className:"space-y-2",children:[n.map(j=>{var R;return a.jsxs("div",{className:"flex justify-between items-center bg-white dark:bg-[#2c2e36] p-2 rounded-lg border dark:border-gray-600 shadow-sm animate-in slide-in-from-right-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold",children:j.firstName[0]}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs font-bold dark:text-white",children:[j.firstName," ",j.lastName]}),a.jsx("div",{className:"text-[10px] text-gray-500",children:(R=j.accountTypes)==null?void 0:R[0]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xs font-mono",children:["$",j.rate,"/hr"]}),a.jsx("button",{type:"button",onClick:()=>r(j.id),className:"text-red-400 hover:text-red-600 transition-colors",children:a.jsx(bs,{size:14})})]})]},j.id)}),n.length===0&&a.jsx("div",{className:"text-center text-xs text-gray-400 py-4 italic",children:"No members added yet."})]})]})]}),a.jsxs("div",{className:"border-t dark:border-gray-700 pt-6",children:[a.jsxs("h3",{className:"text-lg font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(ui,{size:20})," Cost Breakdown"]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-6 rounded-xl border border-blue-100 dark:border-blue-800 transition-all",children:[a.jsx("div",{className:"space-y-2 mb-4 text-sm",children:_.map(j=>a.jsxs("div",{className:"flex justify-between text-blue-900 dark:text-blue-100",children:[a.jsxs("span",{children:[j.firstName," (",j.accountTypes[0],") x ",v,"hrs"]}),a.jsxs("span",{className:"font-mono",children:["$",j.itemTotal.toFixed(2)]})]},j.id))}),a.jsxs("div",{className:"border-t border-blue-200 dark:border-blue-700 pt-2 flex justify-between items-center",children:[a.jsx("span",{className:"text-blue-800 dark:text-blue-300 font-bold",children:"Subtotal"}),a.jsxs("span",{className:"text-blue-800 dark:text-blue-300 font-bold font-mono",children:["$",b.toFixed(2)]})]}),S&&a.jsxs("div",{className:"flex justify-between items-center text-green-600 dark:text-green-400 font-bold mt-2 animate-in slide-in-from-right-2",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ys,{size:14,fill:"currentColor"})," Bundle Discount (10%)"]}),a.jsxs("span",{className:"font-mono",children:["-$",E.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between items-center mt-4 text-2xl font-black dark:text-white",children:[a.jsx("span",{children:"Total Due"}),a.jsxs("span",{className:"font-mono",children:["$",k.toFixed(2)]})]})]})]})]}),a.jsx("div",{className:"p-6 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] rounded-b-2xl",children:a.jsx("button",{type:"submit",disabled:o||n.length===0||!p,className:Id("w-full py-4 rounded-xl font-bold text-lg transition-all shadow-lg flex items-center justify-center gap-2",o||n.length===0||!p?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-blue-600 hover:scale-[1.01]"),children:o?a.jsx(rt,{className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(es,{size:20})," Confirm & Book"]})})})]})})}const OE=[{id:"Pending",label:"Created",icon:qo},{id:"Confirmed",label:"Deposit",icon:ui},{id:"En Route",label:"En Route",icon:lW},{id:"In Progress",label:"Started",icon:qye},{id:"Completed",label:"Done",icon:es}];function FNe({booking:t,user:e,onClose:n}){var v;const[r,s]=N.useState(t.status),[i,o]=N.useState(!1),l=e.uid===t.targetId,c=e.uid===t.senderId,h=(x=>{const b=OE.findIndex(E=>E.id===x);return b===-1?0:b})(r),m=async x=>{o(!0);try{await Nt(Se(Z,`artifacts/${Ge}/public/data/bookings`,t.id),{status:x,[`statusTimestamps.${x}`]:zt()}),s(x),un.success(`Session ${x}`)}catch(b){console.error("Update failed:",b),un.error("Failed to update status")}o(!1)},p=h/(OE.length-1)*100;return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[90] p-4 animate-in fade-in",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-3xl rounded-2xl shadow-2xl border dark:border-gray-700 flex flex-col max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-extrabold dark:text-white flex items-center gap-2",children:["Session Details ",a.jsxs("span",{className:"text-xs bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded-full font-medium",children:["#",t.id.slice(-6).toUpperCase()]})]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["With ",c?t.targetName:t.senderName]})]}),a.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"overflow-y-auto p-6 space-y-8",children:[a.jsxs("div",{className:"relative pt-4 pb-8 px-4",children:[a.jsx("div",{className:"absolute top-8 left-0 w-full h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full -z-10"}),a.jsx("div",{className:"absolute top-8 left-0 h-1.5 bg-brand-blue rounded-full -z-10 transition-all duration-700 ease-in-out",style:{width:`${p}%`}}),a.jsx("div",{className:"flex justify-between",children:OE.map((x,b)=>{const E=b<=h,k=b===h;return a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("div",{className:`
                                                w-10 h-10 rounded-full flex items-center justify-center border-4 transition-all duration-500
                                                ${E?"bg-brand-blue border-white dark:border-[#2c2e36] text-white":"bg-gray-200 dark:bg-gray-700 border-white dark:border-[#2c2e36] text-gray-400"}
                                                ${k?"scale-125 shadow-lg ring-4 ring-blue-100 dark:ring-blue-900/50":""}
                                            `,children:a.jsx(x.icon,{size:k?18:16,fill:E?"currentColor":"none"})}),a.jsx("span",{className:`text-xs font-bold uppercase tracking-wider transition-colors ${E?"text-brand-blue":"text-gray-400"}`,children:x.label})]},x.id)})})]}),l&&r!=="Completed"&&a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800 flex flex-wrap items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-bold text-blue-800 dark:text-blue-300",children:"Update Session Status"}),a.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Keep the client informed."})]}),a.jsxs("div",{className:"flex gap-2",children:[r==="Pending"&&a.jsx("button",{onClick:()=>m("Confirmed"),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-green-700 transition shadow-sm",children:"Accept & Confirm"}),r==="Confirmed"&&a.jsxs("button",{onClick:()=>m("En Route"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-blue-700 transition shadow-sm flex items-center gap-1",children:[a.jsx(lW,{size:14})," I'm En Route"]}),r==="En Route"&&a.jsxs("button",{onClick:()=>m("In Progress"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-bold text-xs hover:bg-purple-700 transition shadow-sm flex items-center gap-1",children:[a.jsx(tR,{size:14})," Start Session"]}),r==="In Progress"&&a.jsxs("button",{onClick:()=>m("Completed"),className:"bg-gray-900 dark:bg-white dark:text-black text-white px-4 py-2 rounded-lg font-bold text-xs hover:opacity-90 transition shadow-sm flex items-center gap-1",children:[a.jsx(es,{size:14})," Complete Session"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase border-b dark:border-gray-700 pb-2",children:"Logistics"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:a.jsx(qo,{size:20,className:"text-brand-blue"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Date"}),a.jsx("div",{className:"dark:text-white font-medium",children:t.date})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:a.jsx(Ms,{size:20,className:"text-brand-blue"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Time"}),a.jsxs("div",{className:"dark:text-white font-medium",children:[t.time," (",t.duration," hrs)"]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:a.jsx(Br,{size:20,className:"text-brand-blue"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Location"}),a.jsx("div",{className:"dark:text-white font-medium",children:((v=t.venue)==null?void 0:v.name)||"Remote / TBD"})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase border-b dark:border-gray-700 pb-2",children:"Financials"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:a.jsx(ui,{size:20,className:"text-green-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Total Value"}),a.jsxs("div",{className:"dark:text-white font-mono font-bold text-lg",children:["$",t.offerAmount]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded-lg",children:a.jsx($c,{size:20,className:"text-gray-500"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Agreement"}),a.jsx("div",{className:"text-brand-blue text-xs font-bold cursor-pointer hover:underline",children:"View Contract"})]})]})]})]}),t.message&&a.jsxs("div",{className:"bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[a.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Notes"}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 italic",children:['"',t.message,'"']})]})]})]})})}function $Ne({user:t,userData:e,openPublicProfile:n}){var Q;const[r,s]=N.useState("search"),[i,o]=N.useState("list"),[l,c]=N.useState("outgoing"),[d,h]=N.useState([]),[m,p]=N.useState([]),[v,x]=N.useState(!0),[b,E]=N.useState("wizard"),[k,_]=N.useState(!1),[S,T]=N.useState({date:"",time:"",location:null,radius:25,urgency:"Normal",venue:null}),[P,j]=N.useState([]),[R,I]=N.useState(!1),[O,D]=N.useState(null),[F,V]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;x(!0);const H=Et(Re(Z,`artifacts/${Ge}/public/data/bookings`),nn("senderId","==",t.uid)),X=Et(Re(Z,`artifacts/${Ge}/public/data/bookings`),nn("targetId","==",t.uid)),oe=pn(H,je=>{p(je.docs.map(ge=>({id:ge.id,...ge.data()}))),x(!1)}),ae=pn(X,je=>{h(je.docs.map(ge=>({id:ge.id,...ge.data()}))),x(!1)});return()=>{oe(),ae()}},[t==null?void 0:t.uid]);const $=H=>{D(H),I(!0)},J=()=>E("talent"),ue=H=>{if(P.find(X=>X.id===H.id))return un.error("Already added.");j([...P,H]),un.success("Added to Session")},ve=H=>j(P.filter(X=>X.id!==H)),le=()=>{_(!1),E("wizard"),j([]),T({date:"",time:"",location:null,radius:25,urgency:"Normal",venue:null}),s("requests")},q=(H,X)=>H.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400 border-2 border-dashed dark:border-gray-700 rounded-2xl",children:[a.jsx(qo,{size:48,className:"mb-4 opacity-20"}),a.jsxs("p",{children:["No ",X==="outgoing"?"outgoing":"incoming"," bookings found."]})]}):a.jsx("div",{className:"grid gap-4",children:H.map(oe=>{var ae,je;return a.jsx("div",{onClick:()=>V(oe),className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm hover:border-brand-blue transition group cursor-pointer",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-lg font-bold",children:X==="outgoing"?(ae=oe.targetName)==null?void 0:ae[0]:(je=oe.senderName)==null?void 0:je[0]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold dark:text-white text-lg",children:X==="outgoing"?oe.targetName:oe.senderName}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[a.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-xs",children:oe.serviceType||"Session"}),oe.date&&a.jsxs("span",{children:[" ",oe.date]})]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:`text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide inline-block mb-1 ${oe.status==="Pending"?"bg-yellow-100 text-yellow-700":oe.status==="Confirmed"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:oe.status}),a.jsxs("div",{className:"font-mono font-bold dark:text-white",children:["$",oe.offerAmount]})]})]})},oe.id)})});return a.jsxs("div",{className:"max-w-7xl mx-auto relative min-h-screen pb-20",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-end mb-6 border-b dark:border-gray-700 gap-4",children:[a.jsxs("div",{className:"flex gap-6 w-full sm:w-auto",children:[a.jsxs("button",{onClick:()=>s("broadcasts"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="broadcasts"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[a.jsx(Ys,{size:16})," Open Jobs"]}),a.jsxs("button",{onClick:()=>s("search"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="search"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[a.jsx(Ur,{size:16})," Talent Search"]})]}),a.jsxs("div",{className:"flex gap-6 w-full sm:w-auto justify-end",children:[a.jsxs("button",{onClick:()=>s("planner"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="planner"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[a.jsx(qo,{size:16})," Session Planner"]}),a.jsxs("button",{onClick:()=>s("requests"),className:`pb-4 px-2 font-bold text-sm transition border-b-2 flex items-center gap-2 ${r==="requests"?"border-brand-blue text-brand-blue dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[a.jsx(Ms,{size:16})," My Bookings"]})]})]}),a.jsxs(yr,{mode:"wait",children:[r==="broadcasts"&&a.jsx(nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i==="create_broadcast"?a.jsx(i1e,{user:t,userData:e,onBack:()=>o("list"),onSuccess:()=>o("list")}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex justify-end mb-4",children:a.jsxs("button",{onClick:()=>o("create_broadcast"),className:"bg-brand-blue text-white px-4 py-2 rounded-lg font-bold text-sm shadow-lg hover:bg-blue-600 transition flex items-center gap-2",children:[a.jsx(Ys,{size:16})," New Broadcast"]})}),a.jsx(s1e,{user:t,userData:e})]})},"broadcasts"),r==="search"&&a.jsx(nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:a.jsx(oV,{user:t,userData:e,openPublicProfile:n,onBook:$,mode:"direct"})},"search"),r==="requests"&&a.jsxs(nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold dark:text-white",children:"Booking Management"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Track your sessions and requests."})]}),a.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-1 rounded-lg flex",children:[a.jsx("button",{onClick:()=>c("outgoing"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all ${l==="outgoing"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"I Booked"}),a.jsx("button",{onClick:()=>c("incoming"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all ${l==="incoming"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"Booked Me"})]})]}),l==="outgoing"?q(m,"outgoing"):q(d,"incoming")]},"requests"),r==="planner"&&a.jsxs(nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[b==="wizard"&&a.jsx(n1e,{userData:e,sessionParams:S,setSessionParams:T,onNext:J}),b==="talent"&&a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 mb-6 flex justify-between items-center shadow-lg sticky top-4 z-40",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[a.jsx(qo,{size:18,className:"text-brand-blue"})," ",S.date||"Flexible Date"," @ ",((Q=S.venue)==null?void 0:Q.name)||"Remote"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:[P.length," talent added"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>E("wizard"),className:"text-xs font-bold text-gray-500 hover:text-gray-900 dark:hover:text-white px-3 py-2",children:"Back"}),a.jsxs("button",{onClick:()=>_(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-green-700 shadow flex items-center gap-2",children:[a.jsx(es,{size:16})," Review Session"]})]})]}),a.jsx(oV,{user:t,userData:e,openPublicProfile:n,onAddToCart:ue,sessionCartIds:P.map(H=>H.id),mode:"planner"})]})]},"planner")]}),a.jsxs(yr,{children:[R&&O&&a.jsx(o1e,{user:t,userData:e,target:O,allInstruments:[],onClose:()=>I(!1)}),k&&a.jsx(VNe,{user:t,userData:e,cart:[...S.venue&&S.venue.id!=="remote"?[{...S.venue,accountTypes:["Studio"]}]:[],...P],onRemoveFromCart:ve,onClose:()=>_(!1),onComplete:le}),F&&a.jsx(FNe,{booking:F,user:t,onClose:()=>V(null)})]})]})}const BNe=({data:t,setData:e})=>a.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4",children:[a.jsx("h3",{className:"text-lg font-bold dark:text-white mb-4",children:"Release Essentials"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Release Title"}),a.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.title,onChange:n=>e({...t,title:n.target.value}),placeholder:"e.g. Dark Side of the Moon"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Primary Artist"}),a.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.primaryArtist,onChange:n=>e({...t,primaryArtist:n.target.value}),placeholder:"e.g. Pink Floyd"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Release Type"}),a.jsx("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.type,onChange:n=>e({...t,type:n.target.value}),children:oke.map(n=>a.jsx("option",{value:n.id,children:n.label},n.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Primary Genre"}),a.jsxs("select",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.genre,onChange:n=>e({...t,genre:n.target.value}),children:[a.jsx("option",{value:"",children:"Select Genre..."}),ake.map(n=>a.jsx("option",{value:n,children:n},n))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Release Date"}),a.jsx("input",{type:"date",className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.releaseDate,onChange:n=>e({...t,releaseDate:n.target.value})}),a.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Standard: 2 weeks out. Express: 48hrs."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Label Name"}),a.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:t.labelName,onChange:n=>e({...t,labelName:n.target.value}),placeholder:"Optional (Default: Independent)"})]})]})]}),zNe=({data:t,setData:e,user:n})=>{const{uploadMedia:r,uploading:s}=gl(),[i,o]=N.useState(t.artworkUrl||null),[l,c]=N.useState(""),d=async h=>{const m=h.target.files[0];if(!m)return;const p=new Image;p.src=URL.createObjectURL(m),p.onload=async()=>{if(p.width<3e3||p.height<3e3){c("Error: Image must be at least 3000 x 3000 pixels.");return}p.width!==p.height?c("Warning: Image should be a perfect square (1:1 ratio)."):c("");const v=await r(m,`distribution/${n.uid}/artwork`);v!=null&&v.url&&(o(v.url),e({...t,artworkUrl:v.url}))}};return a.jsxs("div",{className:"flex flex-col items-center justify-center space-y-6 animate-in slide-in-from-right-4",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"Upload Cover Art"}),a.jsx("p",{className:"text-sm text-gray-500",children:"3000 x 3000 px  JPG or PNG  No Blurry Text"})]}),a.jsxs("div",{className:"relative group w-64 h-64 bg-gray-100 dark:bg-[#1f2128] rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 flex items-center justify-center overflow-hidden",children:[i?a.jsx("img",{src:i,className:"w-full h-full object-cover"}):a.jsxs("div",{className:"text-gray-400 flex flex-col items-center",children:[a.jsx(cw,{size:48,className:"mb-2"}),a.jsx("span",{className:"text-xs font-bold",children:"Click to Upload"})]}),a.jsxs("label",{className:"absolute inset-0 cursor-pointer bg-black/0 hover:bg-black/20 transition flex items-center justify-center",children:[a.jsx("input",{type:"file",className:"hidden",accept:"image/png, image/jpeg",onChange:d,disabled:s}),s&&a.jsx(rt,{className:"animate-spin text-white",size:32})]})]}),l&&a.jsxs("div",{className:"text-red-500 text-sm font-bold flex items-center gap-2 bg-red-50 dark:bg-red-900/20 px-4 py-2 rounded-lg",children:[a.jsx(pl,{size:16})," ",l]})]})},UNe=({data:t,setData:e,user:n})=>{var c,d;const{uploadMedia:r,uploading:s}=gl(),i=async h=>{if(!h.name.toLowerCase().endsWith(".wav")){alert("Only .WAV files are accepted for distribution.");return}const m={id:Date.now(),title:h.name.replace(".wav",""),fileUrl:"",status:"uploading",isExplicit:!1,isInstrumental:!1},p=[...t.tracks||[],m];e({...t,tracks:p});try{const v=await r(h,`distribution/${n.uid}/audio_vault`);if(v!=null&&v.url){const x=p.map(b=>b.id===m.id?{...b,fileUrl:v.url,status:"ready",duration:0}:b);e({...t,tracks:x})}}catch(v){console.error("Track upload failed",v),alert("Upload failed.")}},o=h=>{e({...t,tracks:t.tracks.filter(m=>m.id!==h)})},l=(h,m,p)=>{e({...t,tracks:t.tracks.map(v=>v.id===h?{...v,[m]:p}:v)})};return a.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right-4",children:[a.jsxs("div",{className:"flex justify-between items-end",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"Upload Audio"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Stereo WAV files only (16-bit / 44.1kHz minimum)"})]}),a.jsxs("label",{className:"bg-brand-blue hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-xs cursor-pointer flex items-center gap-2 transition",children:[a.jsx(_1,{size:14})," Add Track",a.jsx("input",{type:"file",className:"hidden",accept:".wav",onChange:h=>i(h.target.files[0]),disabled:s})]})]}),a.jsxs("div",{className:"space-y-3",children:[((c=t.tracks)==null?void 0:c.length)===0&&a.jsx("div",{className:"text-center py-12 border-2 border-dashed dark:border-gray-700 rounded-xl text-gray-400",children:"No tracks added yet."}),(d=t.tracks)==null?void 0:d.map((h,m)=>a.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-700 flex flex-col gap-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-gray-500 font-mono text-xs",children:["#",m+1]}),a.jsx("div",{className:"font-bold dark:text-white text-sm",children:h.status==="uploading"?a.jsxs("span",{className:"flex items-center gap-2 text-brand-blue",children:[a.jsx(rt,{className:"animate-spin",size:14})," Uploading..."]}):h.title})]}),a.jsx("button",{onClick:()=>o(h.id),className:"text-gray-400 hover:text-red-500",children:a.jsx(_t,{size:16})})]}),h.status==="ready"&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[a.jsx("input",{className:"col-span-2 p-2 text-xs border rounded bg-transparent dark:border-gray-600 dark:text-white",placeholder:"Track Title",value:h.title,onChange:p=>l(h.id,"title",p.target.value)}),a.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300 p-2 bg-gray-50 dark:bg-gray-800 rounded cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:h.isExplicit,onChange:p=>l(h.id,"isExplicit",p.target.checked)})," Explicit"]}),a.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300 p-2 bg-gray-50 dark:bg-gray-800 rounded cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:h.isInstrumental,onChange:p=>l(h.id,"isInstrumental",p.target.checked)})," Instrumental"]})]})]},h.id))]})]})},WNe=({data:t,setData:e})=>{var s;const n=i=>{const o=t.stores||[],l=o.includes(i)?o.filter(c=>c!==i):[...o,i];e({...t,stores:l})},r=()=>{var i;((i=t.stores)==null?void 0:i.length)===_g.length?e({...t,stores:[]}):e({...t,stores:_g.map(o=>o.id)})};return a.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"Select Stores"}),a.jsx("button",{onClick:r,className:"text-xs font-bold text-brand-blue hover:underline",children:((s=t.stores)==null?void 0:s.length)===_g.length?"Deselect All":"Select All"})]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:_g.map(i=>{var l;const o=(l=t.stores)==null?void 0:l.includes(i.id);return a.jsxs("div",{onClick:()=>n(i.id),className:`p-3 rounded-xl border flex items-center gap-3 cursor-pointer transition-all ${o?"bg-blue-50 border-brand-blue dark:bg-blue-900/20":"bg-white dark:bg-[#1f2128] dark:border-gray-700 hover:border-gray-300"}`,children:[a.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center ${o?"bg-brand-blue border-brand-blue":"border-gray-400"}`,children:o&&a.jsx(es,{size:12,className:"text-white"})}),a.jsx("span",{className:`text-sm font-bold ${o?"text-brand-blue dark:text-white":"text-gray-600 dark:text-gray-400"}`,children:i.name})]},i.id)})}),a.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/10 p-4 rounded-xl border border-yellow-200 dark:border-yellow-800 text-sm text-yellow-800 dark:text-yellow-200 flex items-start gap-3",children:[a.jsx(mW,{size:18,className:"mt-0.5 shrink-0"}),a.jsx("p",{children:"Deliveries usually take 2-5 days for Spotify/Apple, and up to 2 weeks for other stores. Please plan your release date accordingly."})]})]})};function HNe({user:t,userData:e,initialData:n,onCancel:r,onSuccess:s}){const[i,o]=N.useState(1),[l,c]=N.useState(!1),[d,h]=N.useState(n||{title:"",primaryArtist:`${e.firstName} ${e.lastName}`,type:"single",genre:"",releaseDate:"",labelName:"",artworkUrl:"",tracks:[],stores:_g.map(v=>v.id),status:"Draft"}),m=()=>i===1?d.title&&d.primaryArtist&&d.genre&&d.releaseDate:i===2?!!d.artworkUrl:i===3?d.tracks.length>0&&d.tracks.every(v=>v.status==="ready"):i===4?d.stores.length>0:!0,p=async()=>{c(!0);try{const v={...d,uploaderId:t.uid,updatedAt:zt(),status:"Processing"};n!=null&&n.id?await Nt(Se(Z,Ve(t.uid).distributionReleases,n.id),v):await hn(Re(Z,Ve(t.uid).distributionReleases),{...v,createdAt:zt()}),alert("Release submitted successfully! It is now in the review queue."),s()}catch(v){console.error("Submission error:",v),alert("Failed to submit release.")}c(!1)};return a.jsxs("div",{className:"max-w-4xl mx-auto bg-white dark:bg-[#2c2e36] rounded-2xl shadow-xl overflow-hidden border dark:border-gray-700 min-h-[600px] flex flex-col",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-6 border-b dark:border-gray-700 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-extrabold dark:text-white",children:"New Release"}),a.jsxs("p",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mt-1",children:["Step ",i," of 4"]})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-white",children:a.jsx(_t,{})})]}),a.jsx("div",{className:"h-1 bg-gray-200 dark:bg-gray-700 w-full",children:a.jsx("div",{className:"h-full bg-brand-blue transition-all duration-300",style:{width:`${i/4*100}%`}})}),a.jsxs("div",{className:"flex-1 p-8 overflow-y-auto",children:[i===1&&a.jsx(BNe,{data:d,setData:h}),i===2&&a.jsx(zNe,{data:d,setData:h,user:t}),i===3&&a.jsx(UNe,{data:d,setData:h,user:t}),i===4&&a.jsx(WNe,{data:d,setData:h})]}),a.jsxs("div",{className:"p-6 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] flex justify-between items-center",children:[i>1?a.jsxs("button",{onClick:()=>o(i-1),className:"flex items-center gap-2 text-gray-500 font-bold hover:text-gray-800 dark:hover:text-white transition",children:[a.jsx(cW,{size:18})," Back"]}):a.jsx("div",{}),i<4?a.jsxs("button",{onClick:()=>o(i+1),disabled:!m(),className:"bg-brand-blue text-white px-6 py-2.5 rounded-xl font-bold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-blue-600 transition",children:["Next Step ",a.jsx(ea,{size:18})]}):a.jsx("button",{onClick:p,disabled:l||!m(),className:"bg-green-600 text-white px-8 py-2.5 rounded-xl font-bold flex items-center gap-2 disabled:opacity-50 hover:bg-green-700 transition shadow-lg",children:l?a.jsx(rt,{className:"animate-spin"}):"Submit Release"})]})]})}function qNe({user:t,userData:e}){const[n,r]=N.useState("list"),[s,i]=N.useState([]),[o,l]=N.useState(!0),[c,d]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;const p=Et(Re(Z,Ve(t.uid).distributionReleases),nn("uploaderId","==",t.uid),Wn("updatedAt","desc")),v=pn(p,x=>{i(x.docs.map(b=>({id:b.id,...b.data()}))),l(!1)});return()=>v()},[t==null?void 0:t.uid]);const h=async(p,v)=>{if(confirm(`Are you sure you want to delete "${v}"? This cannot be undone if already distributed.`))try{await _o(Se(Z,Ve(t.uid).distributionReleases,p))}catch(x){console.error(x),alert("Failed to delete release.")}},m=p=>{if(p.status!=="Draft"&&p.status!=="Action Needed")return alert("Cannot edit a release that is currently processing or live. Contact support for takedowns.");d(p),r("create")};return n==="create"?a.jsx(HNe,{user:t,userData:e,initialData:c,onCancel:()=>{r("list"),d(null)},onSuccess:()=>{r("list"),d(null)}}):a.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-in fade-in",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(dx,{className:"text-brand-blue"})," Distribution Portal"]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your catalog across Spotify, Apple Music, and 150+ stores."})]}),a.jsxs("button",{onClick:()=>r("create"),className:"bg-brand-blue text-white px-6 py-3 rounded-xl font-bold hover:bg-blue-600 transition flex items-center gap-2 shadow-lg hover:shadow-blue-500/20",children:[a.jsx(Zs,{size:20})," New Release"]})]}),a.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 overflow-hidden min-h-[400px]",children:o?a.jsx("div",{className:"p-12 text-center text-gray-500",children:"Loading catalog..."}):s.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-6 rounded-full mb-4",children:a.jsx(QA,{size:48,className:"text-gray-400"})}),a.jsx("h3",{className:"text-lg font-bold dark:text-white",children:"No Releases Yet"}),a.jsx("p",{className:"text-gray-500 max-w-sm mt-2 mb-6",children:"Start your journey by uploading your first single, EP, or album to the world."}),a.jsx("button",{onClick:()=>r("create"),className:"text-brand-blue font-bold hover:underline",children:"Create First Release"})]}):a.jsx("div",{className:"divide-y dark:divide-gray-700",children:s.map(p=>{var v;return a.jsxs("div",{className:"p-5 hover:bg-gray-50 dark:hover:bg-white/5 transition flex flex-col md:flex-row md:items-center justify-between gap-4 group",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-16 w-16 bg-gray-200 dark:bg-black rounded-lg shadow-sm overflow-hidden shrink-0 border dark:border-gray-700",children:p.artworkUrl?a.jsx("img",{src:p.artworkUrl,alt:"Art",className:"h-full w-full object-cover"}):a.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:a.jsx(ta,{size:20})})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide border ${p.status==="Live"?"bg-green-100 text-green-700 border-green-200":p.status==="Processing"?"bg-blue-100 text-blue-700 border-blue-200":p.status==="Action Needed"?"bg-red-100 text-red-700 border-red-200":"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600"}`,children:p.status}),a.jsx("span",{className:"text-xs text-gray-400 uppercase font-bold",children:p.type})]}),a.jsx("h4",{className:"font-bold text-lg dark:text-white leading-tight",children:p.title||"Untitled Release"}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[p.primaryArtist,"  ",((v=p.tracks)==null?void 0:v.length)||0," Tracks"]})]})]}),a.jsxs("div",{className:"flex items-center gap-4 pl-4 md:pl-0 border-l md:border-l-0 dark:border-gray-700",children:[a.jsxs("div",{className:"text-right hidden md:block mr-4",children:[a.jsx("div",{className:"text-xs text-gray-400 uppercase font-bold",children:"Release Date"}),a.jsx("div",{className:"text-sm font-medium dark:text-gray-200",children:p.releaseDate?new Date(p.releaseDate).toLocaleDateString():"TBD"})]}),a.jsx("button",{onClick:()=>m(p),className:"p-2 text-gray-400 hover:text-brand-blue hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",title:"Edit / View Details",children:a.jsx(eR,{size:18})}),(p.status==="Draft"||p.status==="Action Needed")&&a.jsx("button",{onClick:()=>h(p.id,p.title),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",title:"Delete Release",children:a.jsx(bs,{size:18})})]})]},p.id)})})})]})}const GNe=[{id:"guitar_electric",label:"Electric Guitar"},{id:"guitar_acoustic",label:"Acoustic Guitar"},{id:"amp_head",label:"Amplifier Head"},{id:"amp_combo",label:"Combo Amp"},{id:"keyboard",label:"Keyboard/Synth"},{id:"rack_unit",label:"Rack Gear (1U/2U)"},{id:"pedal",label:"Pedal/Stompbox"}],iG=({type:t,view:e,onClick:n,markers:r=[]})=>{var d;const s=()=>r.map((h,m)=>a.jsxs("g",{transform:`translate(${h.x}, ${h.y})`,children:[a.jsx("circle",{r:"6",fill:"#ef4444",stroke:"white",strokeWidth:"2",className:"drop-shadow-md"}),a.jsx("text",{y:"-10",textAnchor:"middle",fill:"#ef4444",fontSize:"10",fontWeight:"bold",children:m+1})]},m)),i={width:"100%",height:"400",viewBox:"0 0 300 400",className:"w-full h-full cursor-crosshair touch-none select-none",onClick:h=>{const m=h.target.getBoundingClientRect(),p=(h.clientX-m.left)*(300/m.width),v=(h.clientY-m.top)*(400/m.height);n(p,v)}},o={guitar_electric:{front:a.jsx("path",{d:"M150,20 C140,20 135,25 135,40 L135,100 C110,110 90,140 90,170 C90,190 100,200 110,210 C100,220 90,240 90,270 C90,330 110,360 150,360 C190,360 210,330 210,270 C210,240 200,220 190,210 C200,200 210,190 210,170 C210,140 190,110 165,100 L165,40 C165,25 160,20 150,20 Z",fill:"#e5e7eb",stroke:"#374151",strokeWidth:"2"}),back:a.jsx("path",{d:"M150,20 C140,20 135,25 135,40 L135,100 C110,110 90,140 90,170 C90,190 100,200 110,210 C100,220 90,240 90,270 C90,330 110,360 150,360 C190,360 210,330 210,270 C210,240 200,220 190,210 C200,200 210,190 210,170 C210,140 190,110 165,100 L165,40 C165,25 160,20 150,20 Z",fill:"#d1d5db",stroke:"#374151",strokeWidth:"2",strokeDasharray:"5,5"})},amp_combo:{front:a.jsx("rect",{x:"50",y:"50",width:"200",height:"250",rx:"5",fill:"#e5e7eb",stroke:"#374151",strokeWidth:"2"}),back:a.jsxs("g",{children:[a.jsx("rect",{x:"50",y:"50",width:"200",height:"250",rx:"5",fill:"#d1d5db",stroke:"#374151",strokeWidth:"2"}),a.jsx("rect",{x:"70",y:"200",width:"160",height:"80",fill:"#9ca3af",opacity:"0.5"})]})}},l=()=>a.jsx("rect",{x:"50",y:"50",width:"200",height:"300",rx:"10",fill:"#f3f4f6",stroke:"#9ca3af",strokeWidth:"2",strokeDasharray:"4"}),c=((d=o[t])==null?void 0:d[e])||a.jsx(l,{});return a.jsxs("svg",{...i,children:[c,s()]})};function KNe({initialData:t,onSave:e,onCancel:n,type:r}){const[s,i]=N.useState((t==null?void 0:t.gearType)||"guitar_electric"),[o,l]=N.useState("front"),[c,d]=N.useState((t==null?void 0:t.markers)||[]),[h,m]=N.useState((t==null?void 0:t.notes)||""),[p,v]=N.useState((t==null?void 0:t.photos)||[]),[x,b]=N.useState(null),[E,k]=N.useState(""),{uploadMedia:_,uploading:S}=gl(),T=(R,I)=>{const O={x:R,y:I,view:o,id:Date.now(),label:""};d([...c,O]),b(O),k("")},P=()=>{x&&(d(c.map(R=>R.id===x.id?{...R,label:E}:R)),b(null))},j=async R=>{const I=R.target.files[0];if(!I)return;const O=await _(I,`inspections/${Date.now()}`);O&&v(D=>[...D,O])};return a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden flex flex-col h-[80vh]",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[a.jsxs("h3",{className:"font-bold dark:text-white flex items-center gap-2",children:[a.jsx(pl,{className:r==="Pre"?"text-orange-500":"text-green-500",size:20})," ",r,"-Inspection Report"]}),a.jsx("button",{onClick:n,children:a.jsx(_t,{className:"text-gray-500"})})]}),a.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[a.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-black/40 relative flex flex-col items-center justify-center p-4",children:[a.jsxs("div",{className:"absolute top-4 left-4 z-10 flex flex-col gap-2",children:[a.jsx("select",{className:"p-2 rounded-lg border dark:border-gray-600 bg-white dark:bg-[#1f2128] text-sm font-bold dark:text-white shadow-sm",value:s,onChange:R=>i(R.target.value),children:GNe.map(R=>a.jsx("option",{value:R.id,children:R.label},R.id))}),a.jsx("div",{className:"flex bg-white dark:bg-[#1f2128] rounded-lg border dark:border-gray-600 p-1 shadow-sm",children:["front","back","sides"].map(R=>a.jsx("button",{onClick:()=>l(R),className:`px-3 py-1 text-xs font-bold rounded-md capitalize ${o===R?"bg-brand-blue text-white":"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:R},R))})]}),a.jsxs("div",{className:"w-full max-w-md h-full aspect-[3/4] bg-white dark:bg-[#1f2128] rounded-xl shadow-inner border dark:border-gray-700 relative",children:[a.jsx(iG,{type:s,view:o,markers:c.filter(R=>R.view===o),onClick:T}),x&&a.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 bg-white dark:bg-[#2c2e36] p-4 rounded-xl shadow-2xl border border-brand-blue z-20 animate-in zoom-in-95",children:[a.jsx("h4",{className:"text-xs font-bold uppercase text-gray-500 mb-2",children:"Identify Issue"}),a.jsx("input",{autoFocus:!0,className:"w-full p-2 border rounded mb-2 text-sm dark:bg-black/20 dark:text-white",placeholder:"e.g. Scratch",value:E,onChange:R=>k(R.target.value),onKeyDown:R=>R.key==="Enter"&&P()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{d(c.filter(R=>R.id!==x.id)),b(null)},className:"flex-1 bg-red-100 text-red-600 py-1 rounded text-xs font-bold",children:"Delete"}),a.jsx("button",{onClick:P,className:"flex-1 bg-brand-blue text-white py-1 rounded text-xs font-bold",children:"Save"})]})]})]})]}),a.jsxs("div",{className:"w-full md:w-80 bg-white dark:bg-[#2c2e36] border-l dark:border-gray-700 flex flex-col",children:[a.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Damage Log"}),a.jsx("div",{className:"space-y-2",children:c.map((R,I)=>a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-black/20 rounded border dark:border-gray-700",children:[a.jsx("span",{className:"w-5 h-5 rounded-full bg-red-500 text-white flex items-center justify-center text-xs font-bold shrink-0",children:I+1}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-bold dark:text-white",children:R.label||"Unlabeled"}),a.jsxs("div",{className:"text-[10px] text-gray-500 uppercase",children:[R.view," View"]})]}),a.jsx("button",{onClick:()=>d(c.filter(O=>O.id!==R.id)),children:a.jsx(_t,{size:14,className:"text-gray-400 hover:text-red-500"})})]},I))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Notes"}),a.jsx("textarea",{className:"w-full p-3 border rounded-lg text-sm dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Overall condition...",value:h,onChange:R=>m(R.target.value)})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Evidence Photos"}),a.jsxs("label",{className:"cursor-pointer text-brand-blue hover:text-blue-600",children:[a.jsx(_1,{size:16}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:j,disabled:S})]})]}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:p.map((R,I)=>a.jsxs("div",{className:"aspect-square rounded-lg overflow-hidden border dark:border-gray-600 relative group",children:[a.jsx("img",{src:R.url,className:"w-full h-full object-cover"}),a.jsx("button",{onClick:()=>v(p.filter((O,D)=>D!==I)),className:"absolute top-1 right-1 bg-red-500 text-white p-0.5 rounded opacity-0 group-hover:opacity-100 transition",children:a.jsx(_t,{size:12})})]},I))})]})]}),a.jsx("div",{className:"p-4 border-t dark:border-gray-700",children:a.jsxs("button",{onClick:()=>e({gearType:s,markers:c,notes:h,photos:p,timestamp:new Date().toISOString()}),className:"w-full bg-green-600 text-white py-3 rounded-xl font-bold hover:bg-green-700 flex items-center justify-center gap-2",children:[a.jsx(Gd,{size:18})," Finalize Report"]})})]})]})]})}const QNe=["Mint","Excellent","Good","Fair","Non-Functioning"];function ZNe({user:t,userData:e,setActiveTab:n}){const[r,s]=N.useState("browse"),[i,o]=N.useState([]),[l,c]=N.useState("All"),[d,h]=N.useState(""),[m,p]=N.useState(null);N.useEffect(()=>{const x=Et(Re(Z,Ve(t.uid).gearListings),Wn("timestamp","desc")),b=pn(x,E=>{o(E.docs.map(k=>({id:k.id,...k.data()})))});return()=>b()},[t.uid]);const v=i.filter(x=>(l==="All"||x.category===l)&&(x.title.toLowerCase().includes(d.toLowerCase())||x.brand.toLowerCase().includes(d.toLowerCase())));return a.jsxs("div",{className:"max-w-7xl mx-auto pb-24 animate-in fade-in",children:[r==="browse"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Km,{className:"text-orange-500"})," Gear Exchange"]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Buy and sell verified studio equipment."})]}),a.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[a.jsxs("div",{className:"relative flex-1 md:w-64",children:[a.jsx(Ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-9 pr-4 py-2 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-[#2c2e36] text-sm dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Search gear...",value:d,onChange:x=>h(x.target.value)})]}),a.jsxs("button",{onClick:()=>s("create"),className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg transition",children:[a.jsx(Zs,{size:16})," Sell Gear"]})]})]}),a.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 scrollbar-hide mb-2",children:[a.jsx("button",{onClick:()=>c("All"),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition ${l==="All"?"bg-white dark:bg-white text-black shadow":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:"All Gear"}),d0.map(x=>a.jsx("button",{onClick:()=>c(x.id),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition ${l===x.id?"bg-white dark:bg-white text-black shadow":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:x.label},x.id))]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:v.map(x=>{var b;return a.jsxs("div",{onClick:()=>p(x),className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden hover:shadow-xl transition cursor-pointer group flex flex-col",children:[a.jsxs("div",{className:"aspect-square bg-gray-100 dark:bg-black/40 relative flex items-center justify-center overflow-hidden",children:[(b=x.images)!=null&&b[0]?a.jsx("img",{src:x.images[0],className:"w-full h-full object-cover group-hover:scale-105 transition duration-500"}):a.jsx(v1,{size:32,className:"text-gray-400"}),a.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 text-white text-xs font-bold px-2 py-1 rounded backdrop-blur-md",children:["$",x.price]}),x.conditionReport&&a.jsxs("div",{className:"absolute bottom-2 left-2 bg-green-500/90 text-white text-[10px] font-bold px-2 py-0.5 rounded flex items-center gap-1",children:[a.jsx(es,{size:10})," Inspected"]})]}),a.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[a.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1",children:x.brand}),a.jsx("h4",{className:"font-bold dark:text-white text-sm mb-1 line-clamp-1",children:x.title}),a.jsxs("div",{className:"text-xs text-gray-500 mb-3",children:[x.condition," Condition"]}),a.jsx("div",{className:"mt-auto pt-3 border-t dark:border-gray-700 flex justify-between items-center text-xs text-gray-400",children:a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Br,{size:10})," ",x.location||"Shipped"]})})]})]},x.id)})})]}),r==="create"&&a.jsx(YNe,{user:t,userData:e,onCancel:()=>s("browse"),onSuccess:()=>s("browse")}),m&&a.jsx(XNe,{item:m,onClose:()=>p(null),currentUser:t})]})}function YNe({user:t,userData:e,onCancel:n,onSuccess:r}){const[s,i]=N.useState(1),[o,l]=N.useState({title:"",brand:"",category:d0[0].id,condition:"Good",price:"",description:"",location:e.city||"",weight:"",length:"",width:"",height:""}),[c,d]=N.useState([]),[h,m]=N.useState(null),[p,v]=N.useState(!1),{uploadMedia:x,uploading:b}=gl(),E=async _=>{const S=_.target.files[0];if(!S)return;const T=await x(S,`gear/${t.uid}`);T!=null&&T.url&&d([...c,T.url])},k=async()=>{if(!o.title||!o.price)return alert("Title and Price required.");v(!0);try{await hn(Re(Z,Ve(t.uid).gearListings),{...o,price:parseInt(o.price),images:c,conditionReport:h,sellerId:t.uid,sellerName:`${e.firstName} ${e.lastName}`,sellerPhoto:e.photoURL||null,timestamp:zt(),status:"Active"}),alert("Listing posted!"),r()}catch(_){console.error(_),alert("Failed to post listing.")}v(!1)};return s==="inspection"?a.jsx("div",{className:"h-[600px]",children:a.jsx(KNe,{type:"Pre",onSave:_=>{m(_),i(1)},onCancel:()=>i(1)})}):a.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-8 rounded-2xl border dark:border-gray-700 shadow-xl",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold dark:text-white",children:"List Gear for Sale"}),a.jsx("button",{onClick:n,children:a.jsx(_t,{className:"text-gray-400"})})]}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Brand"}),a.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:o.brand,onChange:_=>l({...o,brand:_.target.value}),placeholder:"e.g. Fender"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Model / Title"}),a.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:o.title,onChange:_=>l({...o,title:_.target.value}),placeholder:"e.g. Stratocaster"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Category"}),a.jsx("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:o.category,onChange:_=>l({...o,category:_.target.value}),children:d0.map(_=>a.jsx("option",{value:_.id,children:_.label},_.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Condition"}),a.jsx("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:o.condition,onChange:_=>l({...o,condition:_.target.value}),children:QNe.map(_=>a.jsx("option",{value:_,children:_},_))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Price ($)"}),a.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",value:o.price,onChange:_=>l({...o,price:_.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Weight (lb)"}),a.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"lbs",value:o.weight,onChange:_=>l({...o,weight:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"L (in)"}),a.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Len",value:o.length,onChange:_=>l({...o,length:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"W (in)"}),a.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Wid",value:o.width,onChange:_=>l({...o,width:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"H (in)"}),a.jsx("input",{type:"number",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"Hgt",value:o.height,onChange:_=>l({...o,height:_.target.value})})]})]}),a.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/10 p-4 rounded-xl border border-orange-100 dark:border-orange-800 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-orange-800 dark:text-orange-400 text-sm mb-1",children:"Tech Inspection Report"}),a.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-300",children:h?a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(es,{size:12})," Report Attached (",h.markers.length," points)"]}):"Mark scratches, dents, or issues on a diagram to build trust."})]}),a.jsx("button",{onClick:()=>i("inspection"),className:`text-xs font-bold px-3 py-2 rounded-lg border transition ${h?"bg-white text-green-600 border-green-200":"bg-orange-100 text-orange-700 border-orange-200 hover:bg-orange-200"}`,children:h?"Edit Report":"Create Report"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Photos"}),a.jsxs("div",{className:"flex gap-2",children:[c.map((_,S)=>a.jsx("img",{src:_,className:"w-16 h-16 rounded-lg object-cover border dark:border-gray-600"},S)),a.jsxs("label",{className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 flex items-center justify-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",children:[b?a.jsx(rt,{className:"animate-spin text-gray-400"}):a.jsx(Zs,{className:"text-gray-400"}),a.jsx("input",{type:"file",className:"hidden",onChange:E,disabled:b})]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{onClick:n,className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition",children:"Cancel"}),a.jsx("button",{onClick:k,disabled:p||b,className:"flex-1 bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition shadow-lg flex items-center justify-center gap-2",children:p?a.jsx(rt,{className:"animate-spin"}):"Post Listing"})]})]})]})}function XNe({item:t,onClose:e,currentUser:n}){var i,o;const[r,s]=N.useState(!1);return a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-4xl h-[90vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-hidden border dark:border-gray-700",children:[a.jsxs("div",{className:"md:w-1/2 bg-black relative flex flex-col",children:[a.jsxs("div",{className:"flex-1 flex items-center justify-center p-4 relative",children:[r&&t.conditionReport?a.jsxs("div",{className:"w-full h-full bg-white rounded-xl overflow-hidden",children:[a.jsx(iG,{type:t.conditionReport.gearType,view:"front",markers:t.conditionReport.markers,onClick:()=>{}}),a.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/80 text-white px-3 py-1 rounded-full text-xs",children:"Inspection View"})]}):(i=t.images)!=null&&i[0]?a.jsx("img",{src:t.images[0],className:"max-h-full max-w-full object-contain"}):a.jsx(v1,{size:48,className:"text-gray-600"}),a.jsx("button",{onClick:e,className:"absolute top-4 left-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70",children:a.jsx(_t,{size:20})})]}),t.conditionReport&&a.jsxs("div",{className:"p-4 bg-[#1f2128] border-t border-gray-800 flex gap-2 justify-center",children:[a.jsx("button",{onClick:()=>s(!1),className:`px-4 py-2 rounded text-xs font-bold ${r?"bg-gray-800 text-gray-400":"bg-orange-600 text-white"}`,children:"Photos"}),a.jsxs("button",{onClick:()=>s(!0),className:`px-4 py-2 rounded text-xs font-bold flex items-center gap-1 ${r?"bg-orange-600 text-white":"bg-gray-800 text-gray-400"}`,children:[a.jsx(Sd,{size:12})," Condition Map"]})]})]}),a.jsxs("div",{className:"md:w-1/2 p-8 overflow-y-auto bg-white dark:bg-[#2c2e36]",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-1",children:t.brand}),a.jsx("h2",{className:"text-3xl font-extrabold dark:text-white mb-2",children:t.title}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xl font-bold text-green-600",children:["$",t.price]}),a.jsx("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded text-xs font-bold",children:t.condition})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl border dark:border-gray-700",children:[a.jsx("img",{src:t.sellerPhoto,className:"w-10 h-10 rounded-full bg-gray-300"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Seller"}),a.jsx("div",{className:"font-bold dark:text-white text-sm",children:t.sellerName})]})]}),((o=t.conditionReport)==null?void 0:o.notes)&&a.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/10 p-4 rounded-xl border border-orange-100 dark:border-orange-800/50",children:[a.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-400 text-sm mb-2 flex items-center gap-2",children:[a.jsx(Km,{size:16})," Tech Notes"]}),a.jsxs("p",{className:"text-sm text-orange-900 dark:text-orange-200 italic",children:['"',t.conditionReport.notes,'"']})]}),a.jsxs("div",{className:"prose dark:prose-invert text-sm text-gray-600 dark:text-gray-300",children:[a.jsx("h4",{className:"font-bold dark:text-white text-sm uppercase",children:"Description"}),a.jsx("p",{children:t.description||"No description provided."})]})]}),a.jsxs("div",{className:"mt-8 pt-6 border-t dark:border-gray-700",children:[t.sellerId===n.uid?a.jsx("button",{className:"w-full bg-gray-100 dark:bg-gray-700 text-gray-500 font-bold py-3 rounded-xl cursor-not-allowed",children:"You own this listing"}):a.jsxs("button",{className:"w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-4 rounded-xl shadow-lg flex items-center justify-center gap-2 transition transform hover:scale-[1.02]",children:[a.jsx(ui,{size:20})," Buy Now"]}),a.jsxs("p",{className:"text-center text-[10px] text-gray-400 mt-3 flex items-center justify-center gap-1",children:[a.jsx(es,{size:10})," Purchases covered by SeshNx Buyer Protection"]})]})]})]})})}function JNe({user:t,userData:e,tokenBalance:n,refreshWallet:r}){const[s,i]=N.useState([]),[o,l]=N.useState("All"),[c,d]=N.useState(""),[h,m]=N.useState(new Set),[p,v]=N.useState(!1),[x,b]=N.useState(null),[E,k]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;const T=Et(Re(Z,Ve(t.uid).marketplaceItems),Wn("timestamp","desc")),P=pn(T,j=>{i(j.docs.map(R=>({id:R.id,...R.data()})))});return()=>P()},[t.uid]),N.useEffect(()=>{if(!(t!=null&&t.uid))return;const T=Re(Z,Ve(t.uid).userLibrary),P=pn(T,j=>{m(new Set(j.docs.map(R=>R.data().itemId)))});return()=>P()},[t==null?void 0:t.uid]);const _=async T=>{if(n<T.price){alert("Insufficient tokens! Please top up.");return}if(window.confirm(`Purchase ${T.title} for ${T.price} Tokens?`))try{const P=Se(Z,Ve(t.uid).userWallet);await Nt(P,{balance:ho(-T.price)}),await hn(Re(Z,Ve(t.uid).userLibrary),{itemId:T.id,title:T.title,type:T.type,pricePaid:T.price,purchaseDate:zt(),downloadUrl:T.downloadUrl}),r&&r(),alert("Purchased successfully!")}catch(P){console.error(P),alert("Transaction failed.")}},S=s.filter(T=>(o==="All"||T.type===o)&&T.title.toLowerCase().includes(c.toLowerCase()));return a.jsxs("div",{className:"pb-32",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 md:pb-0 scrollbar-hide",children:["All","Presets","Samples","Beats"].map(T=>a.jsx("button",{onClick:()=>l(T),className:`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-all ${o===T?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:T},T))}),a.jsxs("div",{className:"ml-auto flex gap-2 w-full md:w-auto",children:[a.jsxs("div",{className:"relative flex-1 md:w-64",children:[a.jsx(Ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-9 pr-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-dark-card text-sm dark:text-white focus:outline-none",placeholder:"Search...",value:c,onChange:T=>d(T.target.value)})]}),a.jsxs("button",{onClick:()=>v(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-green-700",children:[a.jsx(_1,{size:16})," Upload"]})]})]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:S.map(T=>{const P=h.has(T.id);return a.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-xl border dark:border-gray-700 overflow-hidden hover:shadow-lg transition flex flex-col group",children:[a.jsxs("div",{className:"aspect-square relative bg-gray-100 dark:bg-gray-800 flex items-center justify-center cursor-pointer",onClick:()=>b(T),children:[T.type==="Presets"?a.jsx(hx,{size:40,className:"text-gray-400"}):a.jsx(QA,{size:40,className:"text-gray-400"}),P&&a.jsxs("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded flex items-center gap-1",children:[a.jsx(es,{size:8})," OWNED"]})]}),a.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[a.jsx("div",{className:"text-[10px] font-bold text-brand-blue uppercase mb-1",children:T.type}),a.jsx("h4",{className:"font-bold text-sm dark:text-white truncate mb-1",title:T.title,children:T.title}),a.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[a.jsxs("span",{className:"text-xs font-bold text-yellow-600 dark:text-yellow-400 flex items-center gap-1",children:[a.jsx(Ys,{size:10,fill:"currentColor"})," ",T.price]}),!P&&a.jsx("button",{onClick:()=>_(T),className:"bg-gray-900 dark:bg-white dark:text-black text-white px-3 py-1 rounded text-[10px] font-bold hover:opacity-80",children:"Buy"})]})]})]},T.id)})}),p&&a.jsx(eEe,{user:t,userData:e,onClose:()=>v(!1)}),x&&a.jsx(tEe,{item:x,isOwned:h.has(x.id),user:t,onClose:()=>b(null),onBuy:()=>_(x),onDownload:()=>handleDownload(x),onReport:()=>k({id:x.id,type:"market_item",summary:x.title})}),E&&a.jsx(Oq,{user:t,target:E,onClose:()=>k(null)})]})}function eEe({user:t,userData:e,onClose:n}){const[r,s]=N.useState({title:"",price:"",type:"Presets",tags:"",description:""}),[i,o]=N.useState(null),[l,c]=N.useState(""),{uploadMedia:d,uploading:h}=gl(),m=async()=>{if(!r.title||!r.price||!i)return alert("Title, Price, and Audio File are required.");try{c("Uploading Audio Asset...");const p=await d(i,Ve(t.uid).marketAssets);c("Listing Item..."),await hn(Re(Z,Ve(t.uid).marketplaceItems),{...r,price:parseInt(r.price),tags:r.tags.split(",").map(v=>v.trim()).filter(v=>v),author:`${e.firstName} ${e.lastName}`,authorId:t.uid,downloadUrl:p,timestamp:zt()}),c("Success!"),setTimeout(n,1e3)}catch(p){console.error(p),c("Error listing item."),alert("Failed to submit item to market. Check console.")}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[60] p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl p-8 w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl border dark:border-gray-700",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold dark:text-white",children:"Creator Studio"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"List a new sound for sale"})]}),a.jsx("button",{onClick:n,children:a.jsx(_t,{})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Title"}),a.jsx("input",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.title,onChange:p=>s({...r,title:p.target.value}),placeholder:"e.g. Midnight Lofi"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Type"}),a.jsxs("select",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.type,onChange:p=>s({...r,type:p.target.value}),children:[a.jsx("option",{children:"Presets"}),a.jsx("option",{children:"Samples"}),a.jsx("option",{children:"Beats"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Price (TK)"}),a.jsx("input",{type:"number",className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.price,onChange:p=>s({...r,price:p.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Description"}),a.jsx("textarea",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",rows:"3",value:r.description,onChange:p=>s({...r,description:p.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Tags (Comma Separated)"}),a.jsx("input",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:r.tags,onChange:p=>s({...r,tags:p.target.value}),placeholder:"lofi, hiphop, boom-bap"})]})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"border-2 border-dashed dark:border-gray-600 rounded-xl p-6 text-center hover:bg-gray-50 dark:hover:bg-gray-800 transition relative bg-blue-50/50 dark:bg-blue-900/10 h-full flex flex-col justify-center items-center",children:[a.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",accept:"audio/*",onChange:p=>o(p.target.files[0])}),a.jsx(ta,{size:48,className:"mx-auto text-blue-500 mb-2"}),a.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:i?i.name:"Upload Audio File (Product Asset)"}),a.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"MP3/WAV (Max 50MB)"}),i&&a.jsx("div",{className:"mt-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"Selected"})]})})]}),a.jsx("div",{className:"mt-8",children:a.jsx("button",{onClick:m,disabled:h||!r.title||!r.price||!i,className:"w-full bg-brand-blue text-white py-4 rounded-xl font-bold text-lg hover:bg-blue-600 transition flex items-center justify-center gap-2 disabled:opacity-50",children:h?a.jsxs(a.Fragment,{children:[a.jsx(rt,{className:"animate-spin"})," ",l]}):"List Item for Sale"})})]})})}function tEe({item:t,isOwned:e,onClose:n,onBuy:r,onDownload:s,onReport:i}){return a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-[60] p-4",children:a.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-2xl overflow-hidden w-full max-w-4xl shadow-2xl flex flex-col md:flex-row h-[80vh] md:h-[600px]",children:[a.jsxs("div",{className:"md:w-5/12 bg-gray-100 dark:bg-black/40 relative p-8 flex flex-col justify-center items-center text-center",children:[a.jsx("div",{className:"w-64 h-64 bg-gradient-to-br from-brand-blue to-purple-600 rounded-lg shadow-2xl mb-6 flex items-center justify-center text-white",children:t.type==="Presets"?a.jsx(hx,{size:80}):a.jsx(QA,{size:80})}),a.jsx("h2",{className:"text-2xl font-bold dark:text-white mb-2",children:t.title}),a.jsxs("div",{className:"text-brand-blue font-medium mb-6",children:["by ",t.author]}),t.downloadUrl&&a.jsx("div",{className:"w-full",children:a.jsx(DC,{audioUrl:t.downloadUrl,fileName:"Preview Track",previewMode:!e})})]}),a.jsxs("div",{className:"md:w-7/12 p-8 overflow-y-auto flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{children:[a.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded uppercase tracking-wide",children:t.type}),a.jsx("h1",{className:"text-3xl font-extrabold dark:text-white mt-2",children:t.title})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:i,className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-400 hover:text-red-500 rounded-full transition",title:"Report Violation",children:a.jsx(pm,{size:20})}),a.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:a.jsx(_t,{size:20})})]})]}),a.jsxs("div",{className:"prose dark:prose-invert text-sm text-gray-600 dark:text-gray-300 mb-8",children:[a.jsx("p",{children:t.description||"No description provided by the creator."}),!e&&a.jsxs("div",{className:"mt-4 bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded text-yellow-800 dark:text-yellow-200 text-xs flex items-center gap-2",children:[a.jsx(Info,{size:14})," Audio preview is truncated to 15 seconds. Purchase to unlock full track."]})]}),a.jsx("div",{className:"mt-auto",children:e?a.jsxs("button",{onClick:s,className:"w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-bold text-lg flex items-center justify-center gap-2 shadow-lg transition-transform hover:scale-[1.02]",children:[a.jsx(Gm,{size:24})," Download Now"]}):a.jsxs("button",{onClick:r,className:"w-full bg-gray-900 dark:bg-white dark:text-black text-white py-4 rounded-xl font-bold text-lg flex items-center justify-center gap-3 shadow-lg transition-transform hover:scale-[1.02]",children:[a.jsx("span",{children:"Buy for"}),a.jsxs("span",{className:"bg-yellow-400 text-black px-2 py-0.5 rounded text-sm flex items-center gap-1",children:[a.jsx(Ys,{size:12,fill:"black"})," ",t.price]})]})})]})]})})}function nEe({user:t,userData:e,tokenBalance:n}){const[r,s]=N.useState("distribution"),i=[{id:"distribution",label:"Music Distribution"},{id:"gear",label:"Gear Exchange"},{id:"fx",label:"SeshFX Store"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h1",{className:"text-2xl font-bold dark:text-white",children:"Marketplace"}),a.jsx("div",{className:"bg-white dark:bg-gray-800 p-1 rounded-lg border dark:border-gray-700 flex gap-1",children:i.map(o=>a.jsx("button",{onClick:()=>s(o.id),className:`px-4 py-2 text-sm font-bold rounded-md transition-all ${r===o.id?"bg-brand-blue text-white shadow-md":"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:o.label},o.id))})]}),a.jsx(yr,{mode:"wait",children:a.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[r==="distribution"&&a.jsx(qNe,{user:t,userData:e}),r==="gear"&&a.jsx(ZNe,{user:t}),r==="fx"&&a.jsx(JNe,{user:t,tokenBalance:n})]},r)})]})}function rEe(t){const e=N.useRef(!1);N.useEffect(()=>{if(!t)return;ln(cn,`presence/${t}`);const n=ln(cn,`presence/${t}`);Gu(n,{online:!0,lastSeen:null}).then(()=>{e.current=!0}).catch(i=>{console.error("Presence online error:",i)});const r=ln(cn,".info/connected"),s=Ud(r,i=>{i.val()!==!1&&tue(n).set({online:!1,lastSeen:nc()}).then(()=>{Gu(n,{online:!0,lastSeen:null})})});return()=>{s(),e.current&&(Gu(n,{online:!1,lastSeen:nc()}).catch(console.error),e.current=!1)}},[t])}function oG(t){const[e,n]=N.useState({online:!1,lastSeen:null}),[r,s]=N.useState(!0);return N.useEffect(()=>{if(!t){s(!1);return}const i=ln(cn,`presence/${t}`),o=Ud(i,l=>{if(l.exists()){const c=l.val();n({online:c.online===!0,lastSeen:c.lastSeen})}else n({online:!1,lastSeen:null});s(!1)},l=>{console.error("Presence listener error:",l),n({online:!1,lastSeen:null}),s(!1)});return()=>o()},[t]),{...e,loading:r}}function aG(t){if(!t)return"Never";const e=t,r=Date.now()-e,s=Math.floor(r/6e4),i=Math.floor(s/60),o=Math.floor(i/24);return s<1?"Just now":s<60?`${s}m ago`:i<24?`${i}h ago`:o<7?`${o}d ago`:new Date(e).toLocaleDateString()}function sEe({online:t,lastSeen:e,showText:n=!1,size:r="sm"}){const s={xs:"w-1.5 h-1.5",sm:"w-2 h-2",md:"w-2.5 h-2.5"},i={xs:"text-[10px]",sm:"text-xs",md:"text-sm"};return a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsxs("div",{className:"relative",children:[a.jsx(A4,{className:`${s[r]} ${t?"fill-green-500 text-green-500":"fill-gray-400 text-gray-400"}`}),t&&a.jsx("div",{className:"absolute inset-0 animate-ping",children:a.jsx(A4,{className:`${s[r]} fill-green-500 opacity-75`})})]}),n&&a.jsx("span",{className:`${i[r]} ${t?"text-green-500":"text-gray-400"} font-medium`,children:t?"Online":aG(e)})]})}function iEe({online:t,lastSeen:e,showLastSeen:n=!1}){return a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${t?"bg-green-500":"bg-gray-400"}`}),a.jsx("span",{className:"text-xs text-gray-500",children:t?"Online":n?`Last seen ${aG(e)}`:"Offline"})]})}function oEe({conversation:t,activeChat:e,currentUserId:n,onSelect:r,onDelete:s}){const i=t.type==="direct"?t.uid||(t.id.includes("_")?t.id.split("_").find(c=>c!==n):null):null,{online:o,lastSeen:l}=oG(i||"");return a.jsxs("div",{onClick:()=>r(t),className:`group relative flex gap-3 p-4 cursor-pointer transition border-b dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-white/5 ${(e==null?void 0:e.id)===t.id?"bg-blue-50 dark:bg-blue-900/10 border-l-4 border-l-brand-blue":""}`,children:[a.jsxs("div",{className:"relative shrink-0",children:[a.jsx(ra,{src:t.photo,name:t.n,size:"lg",isGroup:t.type==="group"}),t.type==="direct"&&i&&a.jsx("div",{className:"absolute -bottom-0.5 -right-0.5",children:a.jsx(sEe,{online:o,lastSeen:l,size:"xs"})}),t.uc>0&&a.jsx("div",{className:"absolute -top-1 -right-1 h-5 w-5 bg-brand-blue text-white text-[10px] font-bold flex items-center justify-center rounded-full border-2 border-white dark:border-[#2c2e36]",children:t.uc>99?"99+":t.uc})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[a.jsx("h4",{className:`text-sm truncate ${t.uc>0?"font-extrabold text-gray-900 dark:text-white":"font-bold text-gray-700 dark:text-gray-300"}`,children:t.n}),a.jsx("span",{className:"text-[10px] text-gray-400 shrink-0 ml-2",children:t.lmt?new Date(t.lmt).toLocaleDateString():""})]}),a.jsxs("p",{className:`text-xs truncate ${t.uc>0?"text-gray-800 dark:text-gray-200 font-medium":"text-gray-500"}`,children:[t.ls===n?"You: ":"",t.lm]})]}),a.jsx("button",{onClick:c=>{c.stopPropagation(),s==null||s(t.id)},className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-white dark:bg-gray-800 shadow-md rounded-full text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all z-10",children:a.jsx(bs,{size:16})})]})}function aEe({user:t,conversations:e=[],activeChat:n,onSelectChat:r}){const[s,i]=N.useState(!1),[o,l]=N.useState(!1),[c,d]=N.useState("direct"),[h,m]=N.useState(!1),[p,v]=N.useState(""),[x,b]=N.useState([]),[E,k]=N.useState(""),[_,S]=N.useState([]),T=async F=>{k(F);const V=F.trim();if(V.length>1){const $=V.toLowerCase(),J=$.charAt(0).toUpperCase()+$.slice(1),ue=Et(gd(Z,"public_profile"),nn("firstName",">=",J),nn("firstName","<=",J+"")),ve=Et(gd(Z,"public_profile"),nn("lastName",">=",J),nn("lastName","<=",J+""));try{const[le,q]=await Promise.all([Kt(ue),Kt(ve)]),Q=new Map,H=X=>{const oe=X.ref.parent.parent.id;oe!==t.uid&&Q.set(oe,{id:oe,...X.data()})};le.forEach(H),q.forEach(H),S(Array.from(Q.values()))}catch(le){console.error("Search error:",le),S([])}}else S([])},P=F=>{if(c==="direct"){const V=[t.uid,F.id].sort().join("_");r({id:V,uid:F.id,name:`${F.firstName} ${F.lastName}`,type:"direct"}),j()}else c==="add_member"&&(x.find(V=>V.id===F.id)||b(V=>[...V,F]),j())},j=()=>{i(!1),k(""),S([])},R=()=>{v(""),b([]),l(!0)},I=()=>{d("add_member"),i(!0)},O=async()=>{if(!p||x.length===0)return alert("Name and members required.");m(!0);try{const V=AT(ln(cn,"chats")).key,$=nc(),J=[t.uid,...x.map(le=>le.id)],ue={meta:{name:p,createdBy:t.uid,createdAt:$},members:{}};J.forEach(le=>ue.members[le]=!0),await Gu(ln(cn,`chats/${V}`),ue);const ve={};J.forEach(le=>{ve[`conversations/${le}/${V}`]={uid:V,n:p,type:"group",lmt:$,lm:"Group created",ls:t.uid,uc:le===t.uid?0:1}}),await Ia(ln(cn),ve),l(!1),r({id:V,name:p,type:"group"})}catch(F){console.error("Group creation failed",F),alert("Group creation failed: "+F.message)}finally{m(!1)}},D=async(F,V)=>{if(window.confirm("Delete this conversation?"))try{await RT(ln(cn,`conversations/${t.uid}/${V}`)),(n==null?void 0:n.id)===V&&r(null)}catch($){console.error($)}};return a.jsxs("div",{className:"flex flex-col h-full relative overflow-hidden bg-white dark:bg-[#1f2128]",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f] shrink-0",children:[a.jsx("h2",{className:"font-extrabold text-lg dark:text-white tracking-tight",children:"Messages"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:R,className:"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition",title:"New Group",children:a.jsx(Rs,{size:18})}),a.jsx("button",{onClick:()=>{d("direct"),i(!0)},className:"p-2 bg-white dark:bg-gray-700 rounded-full shadow-sm hover:text-brand-blue transition",title:"New Chat",children:a.jsx(Zs,{size:18})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:e.map(F=>a.jsx(oEe,{conversation:F,activeChat:n,currentUserId:t.uid,onSelect:r,onDelete:V=>{window.confirm("Delete this conversation?")&&D({},V)}},F.id))}),o&&a.jsxs("div",{className:"absolute inset-0 bg-white dark:bg-[#1f2128] z-20 flex flex-col animate-in slide-in-from-right-10 duration-200",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center gap-3 bg-gray-50 dark:bg-[#23262f]",children:[a.jsx("button",{onClick:()=>l(!1),className:"hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded-full",children:a.jsx(x1,{size:20})}),a.jsx("h3",{className:"font-bold dark:text-white",children:"New Group"})]}),a.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"1. Group Name"}),a.jsx("input",{className:"w-full p-3 border rounded-xl dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none",placeholder:"Enter group name...",value:p,onChange:F=>v(F.target.value),autoFocus:!0})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase",children:["2. Members (",x.length,")"]}),a.jsxs("button",{onClick:I,className:"text-xs font-bold text-brand-blue flex items-center gap-1 hover:underline",children:[a.jsx(Zs,{size:14})," Add Member"]})]}),a.jsx("div",{className:"space-y-2",children:x.length===0?a.jsx("div",{className:"text-center py-8 border-2 border-dashed dark:border-gray-700 rounded-xl text-gray-400 text-sm",children:"No members selected"}):x.map(F=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-white/5 rounded-lg border dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(UserAvatar,{src:F.photoURL,name:F.firstName,size:"sm"}),a.jsxs("span",{className:"text-sm font-bold dark:text-white",children:[F.firstName," ",F.lastName]})]}),a.jsx("button",{onClick:()=>b(V=>V.filter($=>$.id!==F.id)),className:"text-gray-400 hover:text-red-500",children:a.jsx(_t,{size:16})})]},F.id))})]})]}),a.jsx("div",{className:"p-4 border-t dark:border-gray-700",children:a.jsx("button",{onClick:O,disabled:!p||x.length===0||h,className:"w-full bg-brand-blue text-white py-3.5 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition shadow-lg flex justify-center items-center gap-2",children:h?a.jsx(rt,{className:"animate-spin",size:20}):a.jsxs(a.Fragment,{children:["Create Group ",a.jsx(ea,{size:18})]})})})]}),s&&a.jsxs("div",{className:"absolute inset-0 bg-white dark:bg-[#1f2128] z-30 flex flex-col animate-in fade-in duration-200",children:[a.jsxs("div",{className:"p-3 border-b dark:border-gray-700 flex items-center gap-2 bg-white dark:bg-[#1f2128]",children:[a.jsx(Ur,{size:18,className:"text-gray-400 ml-2"}),a.jsx("input",{autoFocus:!0,className:"flex-1 p-2 bg-transparent outline-none dark:text-white placeholder-gray-400",placeholder:"Search...",value:E,onChange:F=>T(F.target.value)}),a.jsx("button",{onClick:j,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:a.jsx(_t,{size:20,className:"text-gray-500"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[_.length===0&&E.length>1&&a.jsx("div",{className:"text-center py-10 text-gray-400 text-sm",children:"No users found."}),_.map(F=>{const V=c==="add_member"&&x.find($=>$.id===F.id);return a.jsxs("div",{onClick:()=>P(F),className:`flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl cursor-pointer transition mb-1 ${V?"opacity-50 pointer-events-none":""}`,children:[a.jsx(UserAvatar,{src:F.photoURL,name:F.firstName,size:"md"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-bold dark:text-white",children:[F.firstName," ",F.lastName]}),a.jsx("div",{className:"text-xs text-gray-500",children:F.role||"User"})]}),c==="add_member"&&a.jsx(Zs,{size:18,className:"text-brand-blue"})]},F.id)})]})]})]})}const Rb={Recent:["","","","","","","",""],Smileys:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Gestures:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Hearts:["","","","","","","","","","","","","","","","","","","",""],Objects:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Flags:["","","","","","","","","","","","","","","","","","","",""],Music:["","","","","","","","","","","","","","","","","","","",""],Reactions:["","","","","","","","","","","","","","","","","","","",""]},lEe=Object.values(Rb).flat();function cEe({onSelect:t,onClose:e,position:n="bottom"}){const[r,s]=N.useState("Recent"),[i,o]=N.useState(""),[l,c]=N.useState(()=>{const p=localStorage.getItem("recentEmojis");return p?JSON.parse(p):Rb.Recent}),d=N.useMemo(()=>i.trim()?lEe.filter(p=>p.includes(i)||i.includes(p)):r==="Recent"?l:Rb[r]||[],[i,r,l]),h=p=>{const v=[p,...l.filter(x=>x!==p)].slice(0,8);c(v),localStorage.setItem("recentEmojis",JSON.stringify(v)),t(p),e&&e()},m=Object.keys(Rb);return a.jsxs(nt.div,{initial:{opacity:0,scale:.95,y:n==="bottom"?-10:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:`
                absolute ${n==="bottom"?"bottom-full mb-2":"top-full mt-2"} 
                left-0
                w-[340px] bg-white dark:bg-gray-800 
                rounded-2xl shadow-2xl border dark:border-gray-700
                z-50 overflow-hidden
            `,children:[a.jsxs("div",{className:"p-3 border-b dark:border-gray-700",children:[a.jsxs("div",{className:"relative mb-3",children:[a.jsx(Ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search emojis...",value:i,onChange:p=>o(p.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white"}),i&&a.jsx("button",{onClick:()=>o(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a.jsx(_t,{size:16})})]}),a.jsx("div",{className:"flex gap-1 overflow-x-auto scrollbar-hide",children:m.map(p=>a.jsxs("button",{onClick:()=>s(p),className:`
                                px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition
                                ${r===p?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}
                            `,children:[p==="Recent"?a.jsx(Ms,{size:12,className:"inline mr-1"}):null,p]},p))})]}),a.jsx("div",{className:"h-[280px] overflow-y-auto custom-scrollbar p-3",children:d.length===0?a.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:a.jsx("p",{className:"text-sm",children:"No emojis found"})}):a.jsx("div",{className:"grid grid-cols-8 gap-1",children:d.map((p,v)=>a.jsx(nt.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>h(p),className:"w-10 h-10 flex items-center justify-center text-xl rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:p},`${p}-${v}`))})})]})}const $V="lfDGNSxY36zoFTAiGMVIOxjovvzFoBRp",BV="https://api.giphy.com/v1/gifs";function uEe({onSelect:t,onClose:e,position:n="bottom"}){const[r,s]=N.useState(""),[i,o]=N.useState([]),[l,c]=N.useState([]),[d,h]=N.useState(!1),[m,p]=N.useState("trending"),v=N.useRef(null);N.useEffect(()=>{x()},[]),N.useEffect(()=>(r.trim()?(p("search"),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{b(r)},500)):(p("trending"),o([])),()=>{v.current&&clearTimeout(v.current)}),[r]);const x=async()=>{h(!0);try{const S=await(await fetch(`${BV}/trending?api_key=${$V}&limit=24&rating=g`)).json();S.data&&c(S.data)}catch(_){console.error("Giphy trending error:",_)}h(!1)},b=async _=>{if(_.trim()){h(!0);try{const T=await(await fetch(`${BV}/search?api_key=${$V}&q=${encodeURIComponent(_)}&limit=24&rating=g`)).json();T.data&&o(T.data)}catch(S){console.error("Giphy search error:",S)}h(!1)}},E=_=>{t==null||t({url:_.images.fixed_height.url||_.images.original.url,previewUrl:_.images.preview_gif.url||_.images.fixed_height_small.url,width:_.images.fixed_height.width,height:_.images.fixed_height.height,title:_.title||"GIF"}),e&&e()},k=m==="trending"?l:i;return a.jsxs(nt.div,{initial:{opacity:0,scale:.95,y:n==="bottom"?-10:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:`
                absolute ${n==="bottom"?"bottom-full mb-2":"top-full mt-2"} 
                left-0
                w-[380px] bg-white dark:bg-gray-800 
                rounded-2xl shadow-2xl border dark:border-gray-700
                z-50 overflow-hidden
            `,children:[a.jsx("div",{className:"p-3 border-b dark:border-gray-700",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search GIFs...",value:r,onChange:_=>s(_.target.value),className:"w-full pl-9 pr-10 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white"}),r&&a.jsx("button",{onClick:()=>s(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a.jsx(_t,{size:16})})]})}),a.jsx("div",{className:"h-[320px] overflow-y-auto custom-scrollbar p-3",children:d?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(rt,{className:"animate-spin text-brand-blue mb-2",size:24}),a.jsx("p",{className:"text-sm text-gray-500",children:"Loading GIFs..."})]}):k.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsx(EW,{size:32,className:"mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:m==="search"?"No GIFs found. Try a different search.":"Loading trending GIFs..."})]}):a.jsx("div",{className:"grid grid-cols-2 gap-2",children:k.map(_=>a.jsxs(nt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>E(_),className:"relative aspect-square rounded-lg overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-700 group",children:[a.jsx("img",{src:_.images.fixed_height_small.url||_.images.preview_gif.url,alt:_.title,className:"w-full h-full object-cover",loading:"lazy"}),a.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition"})]},_.id))})}),a.jsx("div",{className:"p-2 border-t dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-center",children:a.jsxs("p",{className:"text-[10px] text-gray-400",children:["Powered by ",a.jsx("span",{className:"font-bold",children:"GIPHY"})]})})]})}function dEe({onRecorded:t,onClose:e,maxDuration:n=60}){const[r,s]=N.useState(!1),[i,o]=N.useState(null),[l,c]=N.useState(0),[d,h]=N.useState(null),[m,p]=N.useState(null),v=N.useRef(null),x=N.useRef(null),b=N.useRef(null),E=N.useRef([]),k=N.useRef(null);N.useEffect(()=>(_(),()=>{S()}),[]);const _=async()=>{try{const O=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!0});x.current=O,v.current&&(v.current.srcObject=O),h(!0),p(null)}catch(O){console.error("Permission error:",O),h(!1),p("Camera/microphone access denied")}},S=()=>{x.current&&(x.current.getTracks().forEach(O=>O.stop()),x.current=null),k.current&&clearInterval(k.current)},T=async()=>{if(!x.current){await _();return}try{E.current=[];const O={mimeType:"video/webm;codecs=vp9,opus",videoBitsPerSecond:25e5};b.current=new MediaRecorder(x.current,O),b.current.ondataavailable=D=>{D.data.size>0&&E.current.push(D.data)},b.current.onstop=()=>{const D=new Blob(E.current,{type:"video/webm"});o(D),s(!1),c(0),k.current&&clearInterval(k.current)},b.current.start(),s(!0),c(0),k.current=setInterval(()=>{c(D=>{const F=D+1;return F>=n&&P(),F})},1e3)}catch(O){console.error("Recording error:",O),p("Failed to start recording")}},P=()=>{b.current&&r&&b.current.stop()},j=()=>{o(null),c(0),s(!1)},R=()=>{if(i){const O=new File([i],`video_${Date.now()}.webm`,{type:"video/webm"});t==null||t(O),S(),e==null||e()}},I=O=>{const D=Math.floor(O/60),F=O%60;return`${D}:${F.toString().padStart(2,"0")}`};return!d&&d!==null?a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:a.jsx(nt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-[#2c2e36] rounded-2xl p-6 max-w-sm",children:a.jsxs("div",{className:"text-center",children:[a.jsx(jye,{size:48,className:"text-red-500 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-bold dark:text-white mb-2",children:"Camera Access Required"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please allow camera and microphone access to record video messages."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-brand-blue text-white rounded-lg text-sm font-semibold hover:bg-blue-600 transition",children:"Allow Access"})]})]})})}):a.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-[80]",children:a.jsxs(nt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"relative w-full max-w-2xl aspect-video bg-black rounded-2xl overflow-hidden",children:[a.jsx("video",{ref:v,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),r&&a.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 flex items-center gap-2 bg-red-500 text-white px-4 py-2 rounded-full",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm font-bold",children:I(l)})]}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent",children:a.jsx("div",{className:"flex items-center justify-center gap-4",children:i?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:j,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:a.jsx(_t,{size:24})}),a.jsx("button",{onClick:R,className:"p-4 bg-green-500 hover:bg-green-600 rounded-full text-white transition shadow-lg",children:a.jsx(Bi,{size:28})}),a.jsx("div",{className:"w-12"})," "]}):a.jsx(a.Fragment,{children:r?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:j,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:a.jsx(_t,{size:24})}),a.jsx("button",{onClick:P,className:"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg animate-pulse",children:a.jsx(kW,{size:28})}),a.jsx("div",{className:"w-12"})," "]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:e,className:"p-3 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:a.jsx(_t,{size:24})}),a.jsx("button",{onClick:T,className:"p-4 bg-red-500 hover:bg-red-600 rounded-full text-white transition shadow-lg",children:a.jsx(Qd,{size:28})}),a.jsx("div",{className:"w-12"})," "]})})})}),m&&a.jsx("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-4 py-2 rounded-lg text-sm",children:m})]})})}function hEe({activeChatId:t,uid:e,onSend:n,replyingTo:r,editingMessage:s,onCancelReply:i,typingUsers:o=[]}){const[l,c]=N.useState(""),[d,h]=N.useState(null),[m,p]=N.useState(!1),[v,x]=N.useState(!1),[b,E]=N.useState(!1),[k,_]=N.useState(!1),[S,T]=N.useState(!1),P=N.useRef(null),j=N.useRef(null),R=N.useRef(null),I=N.useRef(null),O=N.useRef([]),D=N.useRef(null),F=N.useRef(null),{uploadMedia:V,uploading:$}=gl();N.useEffect(()=>{var te;s&&(c(s.b||""),(te=R.current)==null||te.focus())},[s]),N.useEffect(()=>{var te;r&&((te=R.current)==null||te.focus())},[r]),N.useEffect(()=>{const te=be=>{D.current&&!D.current.contains(be.target)&&E(!1),F.current&&!F.current.contains(be.target)&&_(!1)};return document.addEventListener("mousedown",te),()=>document.removeEventListener("mousedown",te)},[]);const J=async te=>{try{const Fe=await(await fetch(te.url)).blob(),vt=new File([Fe],`gif_${Date.now()}.gif`,{type:"image/gif"}),ce=await V(vt,`chat_media/${t}`);if(ce){const Be={url:ce.url,type:"image",name:te.title||"GIF",gif:!0};n("",Be)}}catch(be){console.error("GIF upload error:",be),alert("Failed to send GIF")}_(!1)},ue=async te=>{try{const be=await V(te,`chat_media/${t}`);if(be){const Fe={url:be.url,type:"video",name:te.name};n("",Fe)}}catch(be){console.error("Video upload error:",be),alert("Failed to send video")}T(!1)},ve=te=>{c(te.target.value),t&&e&&(Ia(ln(cn,`chats/${t}/typing`),{[e]:!0}),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{Ia(ln(cn,`chats/${t}/typing`),{[e]:!1})},2e3))},le=te=>{const be=R.current;if(be){const Fe=be.selectionStart,vt=be.selectionEnd,ce=l.substring(0,Fe)+te+l.substring(vt);c(ce),setTimeout(()=>{be.selectionStart=be.selectionEnd=Fe+te.length,be.focus()},0)}else c(Fe=>Fe+te)},q=async()=>{try{const te=await navigator.mediaDevices.getUserMedia({audio:!0});I.current=new MediaRecorder(te),O.current=[],I.current.ondataavailable=be=>O.current.push(be.data),I.current.onstop=()=>{const be=new Blob(O.current,{type:"audio/mp3"}),Fe=new File([be],`voice_note_${Date.now()}.mp3`,{type:"audio/mp3"});h({file:Fe,type:"audio",previewUrl:URL.createObjectURL(be)}),te.getTracks().forEach(vt=>vt.stop())},I.current.start(),p(!0)}catch{alert("Microphone access denied.")}},Q=()=>{I.current&&I.current.stop(),p(!1)},H=te=>{te.preventDefault(),te.stopPropagation(),te.type==="dragenter"||te.type==="dragover"?x(!0):x(!1)},X=te=>{te.preventDefault(),te.stopPropagation(),x(!1),te.dataTransfer.files&&te.dataTransfer.files[0]&&oe(te.dataTransfer.files[0])},oe=te=>{const be=te.type.startsWith("image/")?"image":te.type.startsWith("video/")?"video":te.type.startsWith("audio/")?"audio":"file";h({file:te,type:be,previewUrl:URL.createObjectURL(te)})},ae=async te=>{if(te.preventDefault(),!l.trim()&&!d||$)return;let be=null;if(d){const Fe=await V(d.file,`chat_media/${t}`);Fe&&(be={url:Fe.url,type:Fe.type,name:Fe.name})}n(l,be),c(""),h(null),t&&e&&Ia(ln(cn,`chats/${t}/typing`),{[e]:!1})},je=()=>{s&&c(""),i==null||i()},ge=()=>{var te,be;return s?((te=s.b)==null?void 0:te.substring(0,50))||"Message":r?((be=r.b)==null?void 0:be.substring(0,50))||"Media":""};return a.jsxs("div",{className:`p-3 bg-white dark:bg-[#2c2e36] border-t dark:border-gray-700 shrink-0 transition-colors ${v?"bg-blue-50 dark:bg-blue-900/20 border-blue-400":""}`,onDragEnter:H,onDragLeave:H,onDragOver:H,onDrop:X,children:[a.jsx(yr,{children:o.length>0&&a.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mb-2 px-2 flex items-center gap-2",children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"}),a.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),a.jsxs("span",{className:"text-xs text-gray-400 italic",children:[o.length>1?"Multiple people are":"Someone is"," typing..."]})]})}),a.jsx(yr,{children:(r||s)&&a.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-between items-center bg-gray-100 dark:bg-gray-800 p-2.5 px-4 rounded-xl border-l-4 border-brand-blue mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s?a.jsx(bW,{size:16,className:"text-brand-blue shrink-0"}):a.jsx(dW,{size:16,className:"text-brand-blue shrink-0"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("span",{className:"text-xs font-bold text-brand-blue block",children:s?"Editing Message":`Replying to ${(r==null?void 0:r.n)||"User"}`}),a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate block",children:ge()})]})]}),a.jsx("button",{onClick:je,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:a.jsx(_t,{size:16,className:"text-gray-400 hover:text-red-500"})})]})}),a.jsx(yr,{children:d&&a.jsxs(nt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800 rounded-xl mb-2 border dark:border-gray-700",children:[d.type==="image"?a.jsx("img",{src:d.previewUrl,className:"h-14 w-14 object-cover rounded-lg"}):d.type==="video"?a.jsx("video",{src:d.previewUrl,className:"h-14 w-14 object-cover rounded-lg"}):a.jsx("div",{className:"h-14 w-14 bg-purple-100 dark:bg-purple-900/30 text-purple-600 flex items-center justify-center rounded-lg",children:a.jsx(Dye,{size:24})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-bold dark:text-white truncate",children:d.file.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:[(d.file.size/1024).toFixed(1)," KB"]})]}),a.jsx("button",{onClick:()=>h(null),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:a.jsx(_t,{size:18,className:"text-gray-400 hover:text-red-500"})})]})}),a.jsxs("form",{onSubmit:ae,className:"flex items-end gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"file",ref:j,className:"hidden",accept:"image/*,audio/*,video/*,.pdf,.doc,.docx,.txt,.zip",onChange:te=>oe(te.target.files[0])}),a.jsx("button",{type:"button",onClick:()=>{var te;return(te=j.current)==null?void 0:te.click()},className:"p-2.5 text-gray-500 hover:text-brand-blue hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition shrink-0",title:"Attach file",children:a.jsx(xW,{size:20})})]}),a.jsxs("div",{className:"flex items-center gap-1 border-r dark:border-gray-700 pr-2",children:[a.jsx("button",{type:"button",onClick:()=>{T(!0),E(!1),_(!1)},className:"p-2 text-gray-500 hover:text-red-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition",title:"Record video",children:a.jsx(Qd,{size:18})}),a.jsxs("button",{type:"button",onClick:()=>{_(!k),E(!1)},className:"p-2 text-gray-500 hover:text-purple-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition relative",title:"GIF",ref:F,children:[a.jsx(Bye,{size:18}),k&&a.jsx(uEe,{onSelect:J,onClose:()=>_(!1),position:"bottom"})]})]}),a.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-[#1f2128] rounded-2xl border dark:border-gray-700 focus-within:ring-2 focus-within:ring-brand-blue transition-all flex items-end relative",children:[a.jsx("textarea",{ref:R,className:"w-full bg-transparent p-3 max-h-32 min-h-[44px] text-sm resize-none outline-none dark:text-white custom-scrollbar pr-20",placeholder:s?"Update message...":v?"Drop files here...":"Type a message...",value:l,onChange:ve,onKeyDown:te=>{te.key==="Enter"&&!te.shiftKey&&(te.preventDefault(),ae(te))},rows:1}),a.jsxs("div",{className:"absolute right-2 bottom-1.5 flex items-center gap-1",children:[a.jsxs("div",{className:"relative",ref:D,children:[a.jsx("button",{type:"button",onClick:()=>{E(!b),_(!1)},className:`p-1.5 rounded-full transition ${b?"bg-brand-blue/20 text-brand-blue":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"}`,title:"Emoji",children:a.jsx(wW,{size:18})}),a.jsx(yr,{children:b&&a.jsx(cEe,{onSelect:le,onClose:()=>E(!1),position:"bottom"})})]}),a.jsx("button",{type:"button",onClick:m?Q:q,className:`p-1.5 rounded-full transition ${m?"bg-red-500 text-white animate-pulse":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"}`,children:m?a.jsx(kW,{size:18}):a.jsx(Gye,{size:18})})]})]}),a.jsx("button",{type:"submit",disabled:!l.trim()&&!d||$,className:`p-2.5 text-white rounded-full shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all shrink-0 ${s?"bg-green-600 hover:bg-green-700":"bg-brand-blue hover:bg-blue-600"}`,children:$?a.jsx(rt,{size:20,className:"animate-spin"}):s?a.jsx(es,{size:20}):a.jsx(b1,{size:20})})]}),S&&a.jsx(dEe,{onRecorded:ue,onClose:()=>T(!1),maxDuration:60})]})}function fEe(...t){return xx(Id(t))}const Pb=He.forwardRef(({className:t,variant:e="default",size:n="default",...r},s)=>{const i={default:"bg-blue-600 text-white hover:bg-blue-700 shadow-sm",destructive:"bg-red-500 text-white hover:bg-red-600 shadow-sm",outline:"border border-gray-200 bg-transparent hover:bg-gray-100 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 hover:text-gray-900 text-gray-600",link:"text-blue-600 underline-offset-4 hover:underline"},o={default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"};return a.jsx("button",{ref:s,className:fEe("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50",i[e],o[n],t),...r})});Pb.displayName="Button";function mEe({url:t,isOpen:e,onClose:n,previewData:r}){if(!e||!t)return null;const s=new URL(t).pathname;let i="Content";s.startsWith("/profile/")?i="User Profile":s.startsWith("/session/")?i="Session Details":s.startsWith("/studio/")&&(i="Studio Listing");const o=(r==null?void 0:r.title)||`${i} Preview`;return a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black bg-opacity-70 backdrop-blur-sm",onClick:n,children:a.jsxs("div",{className:"bg-gray-900 rounded-xl shadow-2xl w-full max-w-2xl h-3/4 max-h-[800px] flex flex-col transform transition-all duration-300 scale-100 opacity-100",onClick:l=>l.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800 rounded-t-xl sticky top-0",children:[a.jsx("h3",{className:"text-xl font-bold text-white truncate max-w-[80%]",children:o}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:a.jsx(Pb,{variant:"ghost",size:"icon",className:"text-blue-400 hover:text-blue-300",children:a.jsx(fW,{className:"w-5 h-5"})})}),a.jsx(Pb,{onClick:n,variant:"ghost",size:"icon",className:"text-white hover:bg-gray-700",children:a.jsx(_t,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{className:"flex-1 p-4 overflow-y-auto custom-scrollbar text-gray-400 flex flex-col items-center justify-center text-center",children:[a.jsx("p",{className:"mb-4 text-lg font-medium text-white",children:"Embedded Content Simulation"}),a.jsx("p",{className:"mb-2",children:"This is where the actual SeshNx content (e.g., profile card, session details) would be rendered, based on the URL:"}),a.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline break-all p-2 bg-gray-700 rounded-lg text-sm",children:t}),a.jsx("p",{className:"mt-4 text-sm",children:'In a real implementation, you would use a dedicated component (e.g., `ProfileCard id="..."`) here instead of an iframe to display the content securely and natively.'})]}),a.jsx("div",{className:"p-3 border-t border-gray-700 bg-gray-800 rounded-b-xl flex justify-end",children:a.jsx(Pb,{onClick:n,variant:"secondary",children:"Done"})})]})})}function pEe({status:t="sent",size:e=12,className:n=""}){const r={sending:{icon:Ms,color:"text-gray-400",animate:!0},sent:{icon:Bi,color:"text-gray-400",animate:!1},delivered:{icon:dC,color:"text-gray-400",animate:!1},read:{icon:dC,color:"text-brand-blue",animate:!1}},s=r[t]||r.sent,i=s.icon;return a.jsx(nt.div,{animate:s.animate?{rotate:[0,360]}:{},transition:s.animate?{duration:2,repeat:1/0,ease:"linear"}:{},className:`inline-flex items-center ${s.color} ${n}`,children:a.jsx(i,{size:e,className:t==="read"?"fill-current":""})})}function gEe({audioUrl:t,color:e="brand-blue",height:n=40}){const r=N.useRef(null),s=N.useRef(null),i=N.useRef(null),o=N.useRef(null),l=N.useRef(null),[c,d]=N.useState(!1);N.useEffect(()=>{if(!t||!r.current)return;const p=r.current,v=p.getContext("2d"),x=new Audio(t);s.current=x,p.width=p.offsetWidth,p.height=n;const b=new(window.AudioContext||window.webkitAudioContext),E=b.createAnalyser(),k=b.createMediaElementSource(x);E.fftSize=256,k.connect(E),E.connect(b.destination),o.current=b,l.current=E;const _=E.frequencyBinCount,S=new Uint8Array(_),T=()=>{if(x.paused){h(v,p.width,p.height);return}i.current=requestAnimationFrame(T),E.getByteFrequencyData(S),v.clearRect(0,0,p.width,p.height);const P=p.width/_*2;let j=0;for(let R=0;R<_;R++){const I=S[R]/255*p.height,O=v.createLinearGradient(0,0,0,p.height);O.addColorStop(0,"#3b82f6"),O.addColorStop(1,"#8b5cf6"),v.fillStyle=O,v.fillRect(j,p.height-I,P-1,I),j+=P}};return x.addEventListener("play",()=>{d(!0),T()}),x.addEventListener("pause",()=>{d(!1),i.current&&cancelAnimationFrame(i.current),h(v,p.width,p.height)}),x.addEventListener("ended",()=>{d(!1),i.current&&cancelAnimationFrame(i.current),h(v,p.width,p.height)}),h(v,p.width,p.height),()=>{var P;i.current&&cancelAnimationFrame(i.current),x.pause(),(P=o.current)==null||P.close()}},[t,n,c]);const h=(p,v,x)=>{p.clearRect(0,0,v,x),p.fillStyle="#3b82f6";const b=50,E=v/b,k=2;for(let _=0;_<b;_++){const S=Math.random()*x*.3+x*.1,T=_*E;p.fillRect(T,x-S,E-k,S)}},m=()=>{s.current&&(c?s.current.pause():s.current.play())};return a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:m,className:"w-10 h-10 flex items-center justify-center bg-brand-blue text-white rounded-full hover:bg-blue-600 transition shrink-0",children:c?a.jsx(vW,{size:16}):a.jsx(tR,{size:16,className:"ml-0.5"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("canvas",{ref:r,className:"w-full rounded",style:{height:`${n}px`}}),a.jsx("audio",{ref:s,src:t})]})]})}const yEe=["","","","","",""];function xEe({message:t,isCurrentUser:e,previousMessage:n,currentUserId:r,chatId:s,linkPreviewData:i,messageStatus:o="sent",onReaction:l,onReply:c,onEdit:d,onDelete:h,onForward:m,onSeshNxLinkClick:p,onUserClick:v}){var oe;const[x,b]=N.useState(!1),[E,k]=N.useState(!1),[_,S]=N.useState(!1),T=N.useRef(null),P=N.useRef(null),j=!n||n.s!==t.s,R=n&&new Date(t.t).toDateString()===new Date(n.t).toDateString(),I=t.t||Date.now(),O=(n==null?void 0:n.t)||0,D=n&&I-O>3e5,F=!R||!n,V=j||D,$=!e&&j,J=new Date(t.t||Date.now());N.useEffect(()=>{const ae=je=>{T.current&&!T.current.contains(je.target)&&(b(!1),k(!1))};return document.addEventListener("mousedown",ae),()=>document.removeEventListener("mousedown",ae)},[]);const ue=()=>{navigator.clipboard.writeText(t.b||""),S(!0),setTimeout(()=>S(!1),2e3),b(!1)},ve=ae=>{l==null||l(t.id,ae),k(!1),b(!1)},le=t.reactions?Object.entries(t.reactions).reduce((ae,[je,ge])=>{const te=typeof ge=="object"?Object.keys(ge).length:0;return te>0&&(ae[je]=te),ae},{}):{},q=Object.keys(le).length>0,Q=t.reactions?(oe=Object.entries(t.reactions).find(([ae,je])=>typeof je=="object"&&je[r]))==null?void 0:oe[0]:null,H=e?"bg-brand-blue text-white rounded-br-sm":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white rounded-bl-sm";if(t.deleted||t.deletedForAll)return a.jsx("div",{className:`flex ${e?"justify-end":"justify-start"} ${j?"mt-3":"mt-0.5"}`,children:a.jsx("div",{className:"px-4 py-2 rounded-2xl bg-gray-100 dark:bg-gray-800 text-gray-400 italic text-sm",children:" This message was deleted"})});if(t.deletedFor&&t.deletedFor[r])return null;const X=()=>{var je;if(!i)return null;const ae=(je=i.url)==null?void 0:je.includes("seshnx.net");return a.jsx("div",{className:"mt-2 block border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden bg-white dark:bg-gray-800 max-w-[280px]",children:ae?a.jsxs("button",{onClick:()=>p==null?void 0:p(i),className:"w-full text-left",children:[i.image&&a.jsx("div",{className:"h-28 w-full bg-cover bg-center",style:{backgroundImage:`url(${i.image})`}}),a.jsxs("div",{className:"p-2",children:[a.jsxs("p",{className:"font-semibold text-xs text-brand-blue truncate flex items-center",children:[a.jsx(YA,{className:"w-3 h-3 mr-1"}),i.title||"SeshNx Link"]}),i.description&&a.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 line-clamp-2",children:i.description})]})]}):a.jsxs("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",children:[i.image&&a.jsx("div",{className:"h-28 w-full bg-cover bg-center",style:{backgroundImage:`url(${i.image})`}}),a.jsxs("div",{className:"p-2",children:[a.jsx("p",{className:"font-semibold text-xs text-brand-blue truncate",children:i.title||i.url}),i.description&&a.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 line-clamp-2",children:i.description}),a.jsxs("p",{className:"text-[10px] text-gray-400 mt-1 flex items-center",children:[a.jsx(dx,{className:"w-2.5 h-2.5 mr-1"}),new URL(i.url).hostname]})]})]})})};return a.jsxs(a.Fragment,{children:[F&&a.jsx("div",{className:"text-center my-4",children:a.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-bold uppercase tracking-wider bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full",children:J.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})}),a.jsxs("div",{className:`group flex items-end gap-2 ${e?"flex-row-reverse":"flex-row"} ${j?"mt-3":"mt-0.5"}`,ref:P,children:[!e&&a.jsx("div",{className:"w-8 shrink-0",children:$&&a.jsx(ra,{src:t.photo,name:t.n,size:"xs",className:"cursor-pointer",onClick:()=>v==null?void 0:v(t.s)})}),a.jsxs("div",{className:`relative max-w-[75%] ${e?"items-end":"items-start"}`,children:[!e&&j&&t.n&&a.jsx("p",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 mb-1 ml-1",children:t.n}),t.replyTo&&a.jsxs("div",{className:`mb-1 px-3 py-1.5 rounded-lg text-xs border-l-2 border-brand-blue ${e?"bg-blue-400/30 text-blue-100":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}`,children:[a.jsx("p",{className:"font-bold text-[10px] mb-0.5",children:t.replyTo.sender}),a.jsx("p",{className:"truncate opacity-80",children:t.replyTo.text})]}),a.jsxs("div",{className:`relative px-3 py-2 rounded-2xl shadow-sm ${H} cursor-pointer transition-all hover:shadow-md`,onClick:()=>b(!x),children:[t.media&&a.jsxs("div",{className:"mb-2",children:[t.media.type==="image"&&a.jsxs("div",{className:"relative rounded-lg overflow-hidden",children:[t.media.gif&&a.jsx("span",{className:"absolute top-2 left-2 bg-black/60 text-white text-xs px-2 py-0.5 rounded-full font-bold",children:"GIF"}),a.jsx("img",{src:t.media.url,alt:"Shared",className:"max-w-full h-auto rounded-lg max-h-60 object-cover"})]}),t.media.type==="video"&&a.jsx("video",{controls:!0,src:t.media.url,className:"max-w-full h-auto rounded-lg max-h-60"}),t.media.type==="audio"&&a.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 max-w-[280px]",children:a.jsx(gEe,{audioUrl:t.media.url,height:50})}),t.media.type==="file"&&a.jsxs("a",{href:t.media.url,target:"_blank",rel:"noopener noreferrer",download:t.media.name,className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition group",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center shrink-0",children:a.jsx($c,{size:20,className:"text-blue-600 dark:text-blue-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold dark:text-white truncate",children:t.media.name||"File"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Click to download"})]}),a.jsx(Gm,{size:18,className:"text-gray-400 group-hover:text-brand-blue transition shrink-0"})]})]}),t.b&&a.jsx("p",{className:"text-sm break-words whitespace-pre-wrap leading-relaxed",children:t.b}),t.b&&X(),t.edited&&a.jsx("span",{className:`text-[9px] ${e?"text-blue-200":"text-gray-400"} ml-1`,children:"(edited)"})]}),q&&a.jsx("div",{className:`flex flex-wrap gap-1 mt-1 ${e?"justify-end":"justify-start"}`,children:Object.entries(le).map(([ae,je])=>a.jsxs(nt.button,{initial:{scale:0},animate:{scale:1},onClick:()=>ve(ae),className:`flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-xs border transition-all ${Q===ae?"bg-brand-blue/20 border-brand-blue text-brand-blue":"bg-gray-100 dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:[a.jsx("span",{children:ae}),a.jsx("span",{className:"text-[10px] font-bold",children:je})]},ae))}),V&&a.jsxs("div",{className:`flex items-center gap-1 mt-1 ${e?"justify-end":"justify-start"}`,children:[a.jsx("span",{className:"text-[10px] text-gray-400",children:J.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}),e&&a.jsx(pEe,{status:o,size:10,className:"ml-0.5"})]}),a.jsx(yr,{children:x&&a.jsxs(nt.div,{ref:T,initial:{opacity:0,scale:.9,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-10},className:`absolute z-50 ${e?"right-0":"left-0"} bottom-full mb-2 bg-white dark:bg-gray-800 rounded-xl shadow-xl border dark:border-gray-700 overflow-hidden min-w-[180px]`,children:[a.jsx("div",{className:"flex justify-center gap-1 p-2 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:yEe.map(ae=>a.jsx(nt.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>ve(ae),className:`text-lg p-1 rounded-full transition ${Q===ae?"bg-brand-blue/20":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:ae},ae))}),a.jsxs("div",{className:"p-1",children:[a.jsxs("button",{onClick:()=>{c==null||c(t),b(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[a.jsx(dW,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"dark:text-gray-200",children:"Reply"})]}),a.jsxs("button",{onClick:ue,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[a.jsx(uW,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"dark:text-gray-200",children:_?"Copied!":"Copy"})]}),a.jsxs("button",{onClick:()=>{m==null||m(t),b(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[a.jsx(hC,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"dark:text-gray-200",children:"Forward"})]}),e&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{d==null||d(t),b(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition",children:[a.jsx(bW,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"dark:text-gray-200",children:"Edit"})]}),a.jsxs("button",{onClick:()=>{h==null||h(t,"everyone"),b(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition text-red-500",children:[a.jsx(bs,{size:16}),a.jsx("span",{children:"Delete for Everyone"})]})]}),a.jsxs("button",{onClick:()=>{h==null||h(t,"me"),b(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition text-gray-500",children:[a.jsx(bs,{size:16}),a.jsx("span",{children:"Delete for Me"})]})]})]})})]}),e&&a.jsx("div",{className:"w-8 shrink-0"})]})]})}function vEe({message:t,conversations:e,currentUserId:n,onForward:r,onClose:s}){const[i,o]=N.useState(""),[l,c]=N.useState([]),[d,h]=N.useState(!1),m=i.trim()?e.filter(b=>{var E;return(E=b.n)==null?void 0:E.toLowerCase().includes(i.toLowerCase())}):e,p=b=>{c(E=>E.includes(b)?E.filter(k=>k!==b):[...E,b])},v=async()=>{if(l.length!==0){h(!0);try{await r(t,l),s()}catch(b){console.error("Forward error:",b),alert("Failed to forward message")}h(!1)}},x=()=>{var b;return t.media?t.media.type==="image"?" Image":t.media.type==="video"?" Video":t.media.type==="audio"?" Audio":" File":((b=t.b)==null?void 0:b.substring(0,100))||"Message"};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:a.jsxs(nt.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(hC,{className:"text-brand-blue",size:20}),a.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Forward Message"})]}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 shrink-0",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Forwarding:"}),a.jsx("div",{className:"bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600",children:a.jsx("p",{className:"text-sm dark:text-gray-200 line-clamp-2",children:x()})})]}),a.jsx("div",{className:"px-4 py-3 border-b dark:border-gray-700 shrink-0",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search conversations...",value:i,onChange:b=>o(b.target.value),className:"w-full pl-9 pr-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white transition"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:m.length===0?a.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:a.jsx("p",{className:"text-sm",children:"No conversations found"})}):m.map(b=>{const E=l.includes(b.id);return a.jsxs(nt.div,{whileTap:{scale:.98},onClick:()=>p(b.id),className:`
                                        flex items-center gap-3 p-4 cursor-pointer transition
                                        border-b dark:border-gray-700/50
                                        ${E?"bg-brand-blue/10 dark:bg-brand-blue/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}
                                    `,children:[a.jsxs("div",{className:"relative",children:[a.jsx(ra,{src:b.photo,name:b.n,size:"md",isGroup:b.type==="group"}),E&&a.jsx(nt.div,{initial:{scale:0},animate:{scale:1},className:"absolute -bottom-1 -right-1 w-5 h-5 bg-brand-blue rounded-full flex items-center justify-center",children:a.jsx(Bi,{size:12,className:"text-white"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-semibold text-sm dark:text-white truncate",children:b.n}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:b.type==="group"?"Group":"Direct message"})]}),a.jsx("div",{className:`
                                        w-5 h-5 rounded-full border-2 transition
                                        ${E?"border-brand-blue bg-brand-blue":"border-gray-300 dark:border-gray-600"}
                                    `,children:E&&a.jsx(Bi,{size:12,className:"text-white m-auto"})})]},b.id)})}),a.jsxs("div",{className:"p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f] shrink-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("span",{className:"text-sm text-gray-500",children:[l.length," conversation",l.length!==1?"s":""," selected"]}),l.length>0&&a.jsx("button",{onClick:()=>c([]),className:"text-xs text-brand-blue hover:underline",children:"Clear all"})]}),a.jsx("button",{onClick:v,disabled:l.length===0||d,className:"w-full bg-brand-blue text-white py-3 rounded-xl font-bold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-2",children:d?a.jsxs(a.Fragment,{children:[a.jsx(rt,{className:"animate-spin",size:18}),"Forwarding..."]}):a.jsxs(a.Fragment,{children:[a.jsx(hC,{size:18}),"Forward"]})})]})]})})}function bEe(t,e){const[n,r]=N.useState({}),[s,i]=N.useState(null);N.useEffect(()=>{if(!t||!e)return;const h=ln(cn,`chats/${t}/readBy`),m=Ud(h,p=>{if(p.exists()){const v=p.val();r(v),v[e]&&i(v[e].lastReadMessageId)}else r({}),i(null)},p=>{console.error("Read receipts listener error:",p)});return()=>m()},[t,e]);const o=N.useCallback(async h=>{if(!(!t||!e||!h))try{const m=ln(cn,`chats/${t}/readBy/${e}`);await Gu(m,{lastReadMessageId:h,readAt:nc()})}catch(m){console.error("Mark as read error:",m)}},[t,e]),l=N.useCallback((h,m,p=null)=>{if(!h||!m)return!1;const v=n[m];if(!v||!v.lastReadMessageId)return!1;const x=v.lastReadMessageId;if(x===h)return!0;if(p&&Array.isArray(p)){const b=p.find(k=>k.id===h),E=p.find(k=>k.id===x);if(b&&E&&b.t&&E.t)return b.t<=E.t}return x>h},[n]),c=N.useCallback(h=>{var m;return((m=n[h])==null?void 0:m.lastReadMessageId)||null},[n]),d=N.useCallback(h=>s===h,[s]);return{readReceipts:n,myLastRead:s,markAsRead:o,isMessageRead:l,getLastReadMessage:c,hasCurrentUserRead:d}}async function _Ee(t){const e=t.match(/(https?:\/\/[^\s]+)/);if(!e)return null;const n=e[0];await new Promise(s=>setTimeout(s,500));const r={url:n,title:null,description:null,image:null};return n.includes("seshnx.net")?(r.title="SeshNx Official Platform Link",r.description="Shared content from the SeshNx platform. Tap to view embed.",r.image="https://placehold.co/600x400/374151/f9fafb?text=SeshNx+Link"):n.includes("youtube.com")?(r.title="YouTube Video",r.description="Watch this video on YouTube.",r.image="https://img.youtube.com/vi/dQw4w9WgXcQ/mqdefault.jpg"):n.includes("spotify.com")?(r.title="New Track on Spotify",r.description="Listen to the latest release now!",r.image="https://placehold.co/600x400/1DB954/f9fafb?text=Spotify+Album"):n.includes("github.com")?(r.title="SeshNx WebApp Repository",r.description="Check out the source code and contribute.",r.image="https://placehold.co/600x400/000000/ffffff?text=GitHub"):(r.title=`External Link: ${n}`,r.description=`Click to visit ${n}.`),r}function wEe({user:t,userData:e,activeChat:n,conversations:r,onBack:s,toggleDetails:i,openPublicProfile:o}){const[l,c]=N.useState([]),[d,h]=N.useState({}),[m,p]=N.useState({isOpen:!1,url:"",previewData:null}),[v,x]=N.useState(null),[b,E]=N.useState(null),[k,_]=N.useState(null),S=N.useRef(null),T=n==null?void 0:n.id,P=(n==null?void 0:n.name)||(n==null?void 0:n.n)||"Unknown User",j=N.useMemo(()=>(n==null?void 0:n.type)==="group"?null:n!=null&&n.uid?n.uid:T&&T.includes("_")?T.split("_").find(X=>X!==(t==null?void 0:t.uid)):null,[n,T,t==null?void 0:t.uid]),{online:R,lastSeen:I,loading:O}=oG(j),{markAsRead:D,hasCurrentUserRead:F,isMessageRead:V}=bEe(T,t==null?void 0:t.uid);N.useEffect(()=>{var H;if((H=S.current)==null||H.scrollIntoView({behavior:"smooth"}),l.length>0&&T){const X=l[l.length-1];X.s!==(t==null?void 0:t.uid)&&!F(X.id)&&D(X.id)}},[l,T,D,F,t==null?void 0:t.uid]);const $=N.useRef(null);N.useEffect(()=>{if(!T||!l.length)return;const H={root:null,rootMargin:"0px",threshold:.5};return $.current=new IntersectionObserver(X=>{X.forEach(oe=>{if(oe.isIntersecting){const ae=oe.target.dataset.messageId;if(ae){const je=l.find(ge=>ge.id===ae);je&&je.s!==(t==null?void 0:t.uid)&&!F(ae)&&D(ae)}}})},H),l.forEach(X=>{if(X.s!==(t==null?void 0:t.uid)){const oe=document.querySelector(`[data-message-id="${X.id}"]`);oe&&$.current.observe(oe)}}),()=>{$.current&&$.current.disconnect()}},[l,T,t==null?void 0:t.uid,D,F]);const J=H=>{p({isOpen:!0,url:H.url,previewData:H})};N.useEffect(()=>{if(!T)return;const H=Mk(ln(cn,`messages/${T}`),qj(100)),X=Ud(H,oe=>{const ae=oe.val();if(ae){const je=Object.entries(ae).map(([ge,te])=>({id:ge,...te}));je.sort((ge,te)=>ge.t-te.t),c(je),je.forEach(ge=>{if(ge.b){const te=ge.b.match(/(https?:\/\/[^\s]+)/);if(te){const be=te[0];d[ge.id]||_Ee(be).then(Fe=>h(vt=>({...vt,[ge.id]:Fe}))).catch(Fe=>console.error(Fe))}}})}else c([])});return()=>X()},[T]);const ue=async(H,X)=>{if(!T||!(t!=null&&t.uid))return;const oe=`messages/${T}/${H}/reactions/${X}/${t.uid}`,ae=ln(cn,oe);try{if((await Sv(ae)).exists())await RT(ae);else{const ge=ln(cn,`messages/${T}/${H}/reactions`),te=await Sv(ge);if(te.exists()){const be=te.val();for(const[Fe,vt]of Object.entries(be))vt[t.uid]&&await RT(ln(cn,`messages/${T}/${H}/reactions/${Fe}/${t.uid}`))}await Gu(ae,!0)}}catch(je){console.error("Reaction error:",je)}},ve=async(H,X)=>{if(!T)return;const oe=X==="everyone"?"Delete this message for everyone? This cannot be undone.":"Delete this message for yourself?";if(window.confirm(oe))try{const ae=ln(cn,`messages/${T}/${H.id}`);X==="everyone"?await Ia(ae,{deletedForAll:!0,deleted:!0,deletedAt:nc()}):await Ia(ae,{[`deletedFor/${t.uid}`]:!0})}catch(ae){console.error("Delete error:",ae),alert("Failed to delete message")}},le=async(H,X)=>{const oe=nc(),ae=H.b||"",je=H.media||null;for(const ge of X)try{const te=AT(ln(cn,`messages/${ge}`)).key,be={};be[`messages/${ge}/${te}`]={b:ae,s:t.uid,t:oe,n:e.firstName||"User",forwarded:!0,forwardedFrom:P,...je&&{media:je}};const Fe=r==null?void 0:r.find(Be=>Be.id===ge),vt=ae||(je?`Forwarded ${je.type}`:"Forwarded message");let ce=[t.uid];if((Fe==null?void 0:Fe.type)==="group"){const Be=await Sv(ln(cn,`chats/${ge}/members`));Be.exists()&&(ce=Object.keys(Be.val()))}else Fe!=null&&Fe.uid&&(ce=[t.uid,Fe.uid]);ce.forEach(Be=>{const Ye=`conversations/${Be}/${ge}`;be[`${Ye}/lm`]=` ${vt}`,be[`${Ye}/lmt`]=oe,be[`${Ye}/ls`]=t.uid}),await Ia(ln(cn),be)}catch(te){console.error("Forward error for chat:",ge,te)}},q=async(H,X)=>{var ce;if(!T||!(H!=null&&H.trim())&&!X)return;const oe=nc();let ae=H?H.trim():"";if(ae.length===0&&X&&(ae=X.type==="image"?" Image":X.type==="video"?" Video":X.type==="audio"?" Audio":" File"),b)try{await Ia(ln(cn,`messages/${T}/${b.id}`),{b:ae,edited:!0,editedAt:nc()}),E(null);return}catch(Be){console.error("Edit error:",Be);return}const je=AT(ln(cn,`messages/${T}`)).key,ge={},te={b:ae,s:t.uid,t:oe,n:e.firstName||"User",photo:e.photoURL||null,...X&&{media:X}};v&&(te.replyTo={id:v.id,text:((ce=v.b)==null?void 0:ce.substring(0,100))||"Media",sender:v.n||"User"}),ge[`messages/${T}/${je}`]=te;const be=ae||(X?`Sent ${X.type}`:"Message");let Fe=[],vt=n.uid;if(!vt&&n.type!=="group"&&T&&T.includes("_")&&(vt=T.split("_").find(Ye=>Ye!==t.uid)),n.type==="group")try{const Be=await Sv(ln(cn,`chats/${T}/members`));Be.exists()&&(Fe=Object.keys(Be.val()))}catch(Be){console.error(Be),Fe=[t.uid]}else vt?Fe=[t.uid,vt]:Fe=[t.uid];Fe.forEach(Be=>{const Ye=`conversations/${Be}/${T}`;if(ge[`${Ye}/lm`]=be,ge[`${Ye}/lmt`]=oe,ge[`${Ye}/ls`]=t.uid,Be===t.uid&&(ge[`${Ye}/uc`]=0),n.type==="group")ge[`${Ye}/n`]=P,ge[`${Ye}/type`]="group",ge[`${Ye}/uid`]=T;else{const pe=Be===t.uid,bt=n.name||n.n,Ht=e.displayName||`${e.firstName} ${e.lastName}`;ge[`${Ye}/n`]=pe?bt:Ht,ge[`${Ye}/photo`]=pe?n.photo||"":e.photoURL||"",ge[`${Ye}/uid`]=pe?vt||T:t.uid,ge[`${Ye}/type`]="direct"}});try{await Ia(ln(cn),ge),x(null)}catch(Be){console.error(Be)}},Q=N.useMemo(()=>a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-[#1f2128] sticky top-0 z-10 shadow-sm",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("button",{onClick:s,className:"p-2 mr-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition md:hidden",children:a.jsx(x1,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>{n.type!=="group"&&(o==null||o(n.uid||j))},children:[a.jsx(ra,{src:n.photo,name:P,size:"md",isGroup:n.type==="group"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-bold text-gray-900 dark:text-white truncate max-w-[150px] md:max-w-xs text-sm",children:P}),n.type!=="group"&&!O&&a.jsx(iEe,{online:R,lastSeen:I,showLastSeen:!R}),n.type==="group"&&a.jsx("span",{className:"text-xs text-gray-500",children:"Group chat"})]})]})]}),a.jsx("button",{onClick:i,className:"p-2 text-gray-500 hover:text-brand-blue dark:text-gray-400 dark:hover:text-white rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:a.jsx(mW,{className:"w-5 h-5"})})]}),[n,P,s,i,o,j,R,I,O]);return a.jsxs("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-[#1f2128]",children:[Q,a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1 custom-scrollbar bg-gray-50 dark:bg-[#1f2128]",children:[l.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-400",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:a.jsx(XA,{className:"w-8 h-8 text-gray-300 dark:text-gray-600"})}),a.jsx("p",{className:"font-bold text-gray-600 dark:text-gray-300",children:"No messages yet"}),a.jsx("p",{className:"text-sm",children:"Say hello to start the conversation!"})]}):l.map((H,X)=>{let oe="sent";return H.s===t.uid&&(j&&V(H.id,j,l)?oe="read":oe="delivered"),a.jsx(xEe,{"data-message-id":H.id,message:H,isCurrentUser:H.s===t.uid,previousMessage:l[X-1],currentUserId:t.uid,chatId:T,linkPreviewData:d[H.id],messageStatus:oe,onReaction:ue,onReply:ae=>x(ae),onEdit:ae=>E(ae),onDelete:ve,onForward:ae=>_(ae),onSeshNxLinkClick:J,onUserClick:o},H.id)}),a.jsx("div",{ref:S})]}),a.jsx("div",{className:"sticky bottom-0 z-20",children:a.jsx(hEe,{activeChatId:T,uid:t.uid,onSend:q,typingUsers:[],replyingTo:v,editingMessage:b,onCancelReply:()=>{x(null),E(null)}})}),a.jsx(mEe,{url:m.url,isOpen:m.isOpen,onClose:()=>p({isOpen:!1,url:"",previewData:null}),previewData:m.previewData}),k&&a.jsx(vEe,{message:k,conversations:r||[],currentUserId:t.uid,onForward:le,onClose:()=>_(null)})]})}function kEe({chatId:t,onClose:e,onMediaSelect:n}){const[r,s]=N.useState([]),[i,o]=N.useState(!0),[l,c]=N.useState(null),[d,h]=N.useState("all");N.useEffect(()=>{if(!t)return;const x=Mk(ln(cn,`messages/${t}`),Gj("t"),qj(500)),b=Ud(x,E=>{const k=E.val();if(k){const S=Object.entries(k).map(([T,P])=>({id:T,...P})).filter(T=>T.media&&!T.deleted&&!T.deletedForAll).map(T=>({id:T.id,...T.media,messageId:T.id,timestamp:T.t,sender:T.n})).sort((T,P)=>(T.timestamp||0)-(P.timestamp||0));s(S)}else s([]);o(!1)});return()=>b()},[t]);const m=d==="all"?r:r.filter(x=>d==="images"?x.type==="image":d==="videos"?x.type==="video":d==="audio"?x.type==="audio":d==="files"?x.type==="file":!0),p=x=>{c(x),n&&n(x)},v=x=>{const b=document.createElement("a");b.href=x.url,b.download=x.name||"download",b.target="_blank",document.body.appendChild(b),b.click(),document.body.removeChild(b)};return a.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[80] p-4",children:[a.jsxs(nt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex items-center justify-between shrink-0",children:[a.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Media Gallery"}),a.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:a.jsx(_t,{size:20})})]}),a.jsx("div",{className:"p-3 border-b dark:border-gray-700 flex gap-2 overflow-x-auto scrollbar-hide shrink-0",children:[{key:"all",label:"All",icon:null},{key:"images",label:"Images",icon:cw},{key:"videos",label:"Videos",icon:Qd},{key:"audio",label:"Audio",icon:ta},{key:"files",label:"Files",icon:$c}].map(x=>a.jsxs("button",{onClick:()=>h(x.key),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition ${d===x.key?"bg-brand-blue text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200"}`,children:[x.icon&&a.jsx(x.icon,{size:16}),x.label,a.jsxs("span",{className:"text-xs opacity-70",children:["(",m.filter(b=>x.key==="all"||b.type===x.key).length,")"]})]},x.key))}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:i?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx("div",{className:"w-8 h-8 border-2 border-brand-blue border-t-transparent rounded-full animate-spin mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Loading media..."})]}):m.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsx(cw,{size:48,className:"mb-4 opacity-30"}),a.jsx("p",{className:"text-sm",children:"No media found"})]}):a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:m.map(x=>a.jsxs(nt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(x),className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 cursor-pointer group",children:[x.type==="image"?a.jsx("img",{src:x.url,alt:"Media",className:"w-full h-full object-cover"}):x.type==="video"?a.jsx("video",{src:x.url,className:"w-full h-full object-cover"}):x.type==="audio"?a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-purple-100 dark:bg-purple-900/30",children:a.jsx(ta,{size:32,className:"text-purple-600 dark:text-purple-400"})}):a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-blue-100 dark:bg-blue-900/30",children:a.jsx($c,{size:32,className:"text-blue-600 dark:text-blue-400"})}),a.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition flex items-center justify-center",children:a.jsx(Gm,{size:20,className:"text-white opacity-0 group-hover:opacity-100 transition"})})]},x.id))})})]}),a.jsx(yr,{children:l&&a.jsx(NEe,{media:l,onClose:()=>c(null),onDownload:v})})]})}function NEe({media:t,onClose:e,onDownload:n}){const[r,s]=N.useState([]),[i,o]=N.useState(0);N.useEffect(()=>{s([t]),o(0)},[t]);const l=()=>{i<r.length-1&&o(i+1)},c=()=>{i>0&&o(i-1)},d=r[i]||t;return a.jsx(nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/95 z-[90] flex items-center justify-center",onClick:e,children:a.jsxs("div",{className:"relative max-w-7xl max-h-[90vh] w-full h-full flex items-center justify-center p-4",onClick:h=>h.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 transition z-10",children:a.jsx(_t,{size:24})}),d.type==="image"&&a.jsx("img",{src:d.url,alt:"Media",className:"max-w-full max-h-full object-contain rounded-lg"}),d.type==="video"&&a.jsx("video",{src:d.url,controls:!0,className:"max-w-full max-h-full rounded-lg",autoPlay:!0}),d.type==="audio"&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md",children:[a.jsx("div",{className:"w-32 h-32 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(ta,{size:48,className:"text-purple-600 dark:text-purple-400"})}),a.jsx("audio",{src:d.url,controls:!0,className:"w-full",autoPlay:!0}),a.jsx("p",{className:"text-center mt-4 text-sm text-gray-500",children:d.name})]}),d.type==="file"&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 max-w-md text-center",children:[a.jsx($c,{size:64,className:"text-blue-600 dark:text-blue-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-bold dark:text-white mb-2",children:d.name}),a.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-4 px-6 py-2 bg-brand-blue text-white rounded-lg hover:bg-blue-600 transition",children:"Open File"})]}),r.length>1&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:c,disabled:i===0,className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition",children:a.jsx(cW,{size:24})}),a.jsx("button",{onClick:l,disabled:i===r.length-1,className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 disabled:opacity-30 transition",children:a.jsx(ea,{size:24})})]}),a.jsx("button",{onClick:()=>n(d),className:"absolute bottom-4 left-1/2 -translate-x-1/2 p-3 bg-black/50 text-white rounded-full hover:bg-black/70 transition",children:a.jsx(Gm,{size:20})})]})})}function EEe({activeChat:t,onClose:e,currentUser:n}){const[r,s]=N.useState([]),[i,o]=N.useState({sessions:0,rating:0,responseTime:"N/A"}),[l,c]=N.useState(!0),[d,h]=N.useState(!1),[m,p]=N.useState(!1),v=t.type==="group",x=t.uid,b=t.name||t.n||"Unknown";N.useEffect(()=>{const _=async()=>{c(!0);try{if(s([]),!v&&x){const S=Se(Z,`artifacts/${Ge}/users/${x}/public_profile/main`),T=await uo(S),P=T.exists()?T.data():{},j=Re(Z,`artifacts/${Ge}/public/data/bookings`),R=Et(j,nn("senderId","==",n.uid||""),nn("targetId","==",x),nn("status","==","Completed")),I=await sj(R);o({sessions:I.data().count,rating:P.rating||"New",responseTime:P.responseTime||"~1hr"})}}catch(S){console.error("Failed to load details:",S)}c(!1)};t!=null&&t.id&&_()},[t.id,x,v,n==null?void 0:n.uid]);const E=async()=>{if(!(v||!x||!n)&&confirm(`Are you sure you want to block ${b}?`)){h(!0);try{const _=Se(Z,Ve(n.uid).userProfile);await Nt(_,{"settings.social.blockedUsers":Ay(x)}),alert("User blocked."),e()}catch(_){console.error("Block failed:",_),alert("Failed to block user.")}h(!1)}},k=()=>{alert("Please use the report option on their profile page for full moderation tools.")};return a.jsxs("div",{className:"absolute right-0 top-0 h-full w-full md:w-80 bg-gray-800 shadow-xl z-20 flex flex-col transition-transform duration-300 ease-in-out border-l border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-900",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Details"}),a.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-full transition duration-150","aria-label":"Close details",children:a.jsx(_t,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 flex flex-col items-center border-b border-gray-700 bg-gray-800",children:[a.jsxs("div",{className:"relative w-24 h-24 rounded-full overflow-hidden mb-4 bg-gray-700 flex items-center justify-center shadow-lg border-4 border-gray-600",children:[a.jsx("img",{src:t.photo,className:"w-full h-full object-cover",onError:_=>_.target.src="",alt:b}),!t.photo&&(v?a.jsx(Rs,{className:"w-10 h-10 text-gray-500"}):a.jsx(Jr,{className:"w-10 h-10 text-gray-500"}))]}),a.jsx("h4",{className:"text-xl font-bold text-white text-center leading-tight",children:b}),a.jsxs("p",{className:"text-xs text-gray-400 mt-2 flex items-center px-3 py-1 bg-gray-700 rounded-full",children:[v?a.jsx(Rs,{className:"w-3 h-3 mr-1"}):a.jsx(Jo,{className:"w-3 h-3 mr-1"}),v?"Group Chat":t.role||"Creative"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:[!v&&a.jsxs("div",{className:"p-4 border-b border-gray-700",children:[a.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase mb-3 tracking-wider",children:"Performance"}),l?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(rt,{className:"animate-spin text-brand-blue"})}):a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx(Wa,{title:"Sessions",value:i.sessions,icon:Jo,color:"text-blue-400"}),a.jsx(Wa,{title:"Rating",value:i.rating,icon:pm,color:"text-yellow-400"}),a.jsx(Wa,{title:"Reply Time",value:i.responseTime,icon:Ms,color:"text-green-400"})]})]}),a.jsxs("div",{className:"p-4 border-b border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h5",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Shared Media"}),a.jsx("button",{onClick:()=>p(!0),className:"text-xs text-brand-blue hover:underline font-medium",children:"View All"})]}),r.length>0?a.jsx("div",{className:"grid grid-cols-3 gap-2",children:r.slice(0,6).map((_,S)=>a.jsxs("div",{className:"aspect-square rounded-lg overflow-hidden bg-gray-700 cursor-pointer hover:opacity-80 transition",children:[_.type==="image"&&a.jsx("img",{src:_.url,className:"w-full h-full object-cover",alt:"Media"}),_.type==="video"&&a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx(Qd,{size:20,className:"text-gray-400"})})]},S))}):a.jsx("p",{className:"text-xs text-gray-500 text-center py-4",children:"No shared media yet"})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition",children:[a.jsx(Td,{className:"w-4 h-4 text-yellow-500"}),a.jsx("span",{children:"Mute Notifications"})]}),a.jsxs("button",{onClick:()=>p(!0),className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition",children:[a.jsx(zye,{className:"w-4 h-4 text-purple-500"}),a.jsx("span",{children:"Media Gallery"})]}),!v&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:E,disabled:d,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition disabled:opacity-50",children:[d?a.jsx(rt,{className:"w-4 h-4 animate-spin"}):a.jsx(tu,{className:"w-4 h-4"}),a.jsx("span",{children:"Block User"})]}),a.jsxs("button",{onClick:k,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-red-400 hover:bg-red-900/20 hover:text-red-300 rounded-lg transition",children:[a.jsx(pm,{className:"w-4 h-4"}),a.jsx("span",{children:"Report User"})]})]})]})]}),m&&a.jsx(kEe,{chatId:t.id,onClose:()=>p(!1)})]})}function SEe({user:t,userData:e,openPublicProfile:n}){const[r,s]=N.useState(null),[i,o]=N.useState(!1),[l,c]=N.useState([]);return rEe(t==null?void 0:t.uid),N.useEffect(()=>{if(!(t!=null&&t.uid))return;const d=Mk(ln(cn,`conversations/${t.uid}`),Gj("lmt")),h=Ud(d,m=>{const p=m.val();if(p){const v=Object.entries(p).map(([x,b])=>({id:x,...b})).sort((x,b)=>(b.lmt||0)-(x.lmt||0));c(v)}else c([])});return()=>h()},[t==null?void 0:t.uid]),a.jsxs("div",{className:"flex h-[calc(100vh-100px)] bg-white dark:bg-[#1f2128] rounded-2xl overflow-hidden border dark:border-gray-800 shadow-xl",children:[a.jsx(nt.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:`w-full md:w-80 border-r dark:border-gray-800 flex flex-col ${r?"hidden md:flex":"flex"}`,children:a.jsx(aEe,{user:t,userData:e,conversations:l,activeChat:r,onSelectChat:s})}),a.jsx("div",{className:`flex-1 flex flex-col relative ${r?"flex":"hidden md:flex"}`,children:a.jsx(yr,{mode:"wait",children:r?a.jsxs(nt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex-1 flex",children:[a.jsx("div",{className:"flex-1 flex flex-col",children:a.jsx(wEe,{activeChat:r,user:t,userData:e,conversations:l,onBack:()=>s(null),toggleDetails:()=>o(!i),openPublicProfile:n})}),a.jsx(yr,{children:i&&a.jsx(nt.div,{initial:{width:0,opacity:0},animate:{width:300,opacity:1},exit:{width:0,opacity:0},className:"border-l dark:border-gray-800 bg-gray-50 dark:bg-[#23262f] overflow-hidden relative z-20",children:a.jsx(EEe,{activeChat:r,currentUser:e,onClose:()=>o(!1)})})})]},r.id):a.jsxs(nt.div,{initial:{opacity:0},animate:{opacity:1},className:"flex-1 flex items-center justify-center text-gray-400 flex-col",children:[a.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:a.jsx("span",{className:"text-4xl",children:""})}),a.jsx("p",{children:"Select a conversation to start chatting"})]})})})]})}const TEe=()=>{const{data:t,loading:e}=$q(),[n,r]=N.useState([]),s=N.useMemo(()=>{if(e||!t)return[];let o=[];try{Object.keys(t).forEach(l=>{const c=t[l];c&&Object.entries(c).forEach(([d,h])=>{if(!h||typeof h!="object")return;const m=h.brand||h.searchTokens&&h.searchTokens[0]||"Unknown",p=h.name||h.searchTokens&&h.searchTokens[1]||"Unknown Item",v=h.searchTokens||[],x=[p,m,...v].join(" ").toLowerCase();o.push({id:d,name:p,brand:m,category:h.category||l,subCategory:h.subCategory||"General",searchString:x,original:h})})})}catch(l){console.warn("Error processing equipment data:",l)}return o},[t,e]);return{searchEquipment:o=>{if(!o||o.trim().length<1){r([]);return}const l=o.toLowerCase().trim().split(/\s+/),c=s.filter(d=>l.every(h=>d.searchString.includes(h))).slice(0,50);r(c)},results:n,loading:e}};function lG({onSelect:t,placeholder:e="Search for gear (e.g. U87, SSL)...",className:n="",value:r,onChange:s,multi:i=!1}){const{searchEquipment:o,results:l,loading:c}=TEe(),[d,h]=N.useState(""),[m,p]=N.useState(!1),v=N.useRef(null),x=r!==void 0?r:d;N.useEffect(()=>{function k(_){v.current&&!v.current.contains(_.target)&&p(!1)}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[v]);const b=k=>{const _=k.target.value;s?s(_):h(_);const S=i?_.split(",").pop().trim():_;S.length>=2?(o(S),p(!0)):p(!1)},E=k=>{const _=k.brand!=="Various"&&k.brand!=="Unknown"?`${k.brand} ${k.name}`:k.name;if(i){const S=x.split(",");S.pop();const P=[...S.map(j=>j.trim()).filter(Boolean),_].join(", ")+", ";s?s(P):h(P)}else t&&t({...k,fullName:_}),s?s(_):h(_);p(!1)};return a.jsxs("div",{ref:v,className:`relative ${n}`,children:[a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{className:"absolute left-3 top-3 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-9 pr-8 p-3 text-sm border rounded-xl bg-white dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-brand-blue outline-none transition-all",placeholder:e,value:x,onChange:b,onFocus:k=>b(k)}),x&&a.jsx("button",{type:"button",onClick:()=>{s?s(""):h(""),p(!1)},className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:a.jsx(_t,{size:16})})]}),m&&l.length>0&&a.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl max-h-60 overflow-y-auto animate-in fade-in slide-in-from-top-2",children:a.jsx("div",{className:"py-1",children:l.map(k=>{var _;return a.jsxs("button",{type:"button",onClick:()=>E(k),className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b dark:border-gray-700/50 last:border-0 group",children:[a.jsx("div",{className:"font-bold text-sm dark:text-white group-hover:text-brand-blue transition-colors",children:k.name}),a.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1.5 mt-0.5",children:[a.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:k.brand}),a.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600"}),a.jsx("span",{className:"opacity-75",children:(_=k.subCategory)==null?void 0:_.replace(/_/g," ")})]})]},k.id)})})}),m&&c&&a.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-[#2c2e36] border dark:border-gray-600 rounded-xl shadow-xl p-4 text-center text-gray-500 flex items-center justify-center gap-2",children:[a.jsx(rt,{className:"animate-spin",size:16})," Searching database..."]})]})}const CEe=Pw({studioName:ls().min(3,"Studio name is required"),address:ls().min(5,"Address is required"),description:ls().max(1e3).optional(),rules:ls().optional(),amenities:VV(ls()).optional(),rooms:VV(Pw({name:ls().min(1,"Room name required"),rate:Rw().min(0),capacity:Rw().min(1),equipment:ls().optional()})).optional()});function IEe({user:t,userData:e}){const[n,r]=N.useState(!1),{register:s,control:i,handleSubmit:o,watch:l,setValue:c,formState:{errors:d,isDirty:h}}=KR({resolver:QR(CEe),defaultValues:{studioName:(e==null?void 0:e.studioName)||"",address:(e==null?void 0:e.address)||"",description:(e==null?void 0:e.studioDescription)||"",rules:(e==null?void 0:e.studioRules)||"",amenities:(e==null?void 0:e.amenities)||[],rooms:(e==null?void 0:e.rooms)||[{name:"Main Room",rate:50,capacity:5,equipment:""}]}}),{fields:m,append:p,remove:v}=aNe({control:i,name:"rooms"}),x=l("amenities"),b=_=>{const S=x||[];S.includes(_)?c("amenities",S.filter(T=>T!==_),{shouldDirty:!0}):c("amenities",[...S,_],{shouldDirty:!0})},E=async _=>{r(!0);const S=un.loading("Saving Studio Settings...");try{const T=Se(Z,`artifacts/${Ge}/users/${t.uid}/profiles/main`);await Nt(T,{studioName:_.studioName,address:_.address,studioDescription:_.description,studioRules:_.rules,amenities:_.amenities,rooms:_.rooms,isStudio:!0}),un.success("Studio Settings Saved!",{id:S})}catch(T){console.error("Studio update failed",T),un.error("Failed to save settings.",{id:S})}finally{r(!1)}},k=_=>xx("w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none",_?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-200 dark:border-gray-700");return a.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[a.jsxs("h1",{className:"text-3xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx($ye,{className:"text-brand-blue"})," Studio Manager"]}),a.jsxs("form",{onSubmit:o(E),className:"space-y-8",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm space-y-4",children:[a.jsx("h3",{className:"text-lg font-bold dark:text-white mb-4",children:"General Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Studio Name"}),a.jsx("input",{...s("studioName"),className:k(d.studioName)}),d.studioName&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.studioName.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Location Address"}),a.jsx("input",{...s("address"),className:k(d.address),placeholder:"123 Music Row, Nashville TN"}),d.address&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.address.message})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Description"}),a.jsx("textarea",{...s("description"),rows:"3",className:k(d.description),placeholder:"Describe the vibe and gear..."})]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"text-lg font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(e0e,{size:20})," Amenities"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:xq.map(_=>a.jsx("button",{type:"button",onClick:()=>b(_),className:Id("px-3 py-2 rounded-lg text-sm font-medium transition-all border",x!=null&&x.includes(_)?"bg-brand-blue text-white border-brand-blue shadow-md":"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"),children:_},_))})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-lg font-bold dark:text-white flex items-center gap-2",children:[a.jsx(yW,{size:20})," Rooms & Rates"]}),a.jsxs("button",{type:"button",onClick:()=>p({name:"New Room",rate:0,capacity:1,equipment:""}),className:"text-sm bg-green-100 text-green-700 px-3 py-1.5 rounded-lg font-bold hover:bg-green-200 transition flex items-center gap-1",children:[a.jsx(Zs,{size:16})," Add Room"]})]}),a.jsxs("div",{className:"space-y-4",children:[m.map((_,S)=>{var T,P,j,R,I,O;return a.jsxs("div",{className:"bg-gray-50 dark:bg-[#1f2128] p-4 rounded-xl border dark:border-gray-600 relative group",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-2",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Room Name"}),a.jsx("input",{...s(`rooms.${S}.name`),className:k((P=(T=d.rooms)==null?void 0:T[S])==null?void 0:P.name)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Hourly Rate ($)"}),a.jsx("input",{type:"number",...s(`rooms.${S}.rate`,{valueAsNumber:!0}),className:k((R=(j=d.rooms)==null?void 0:j[S])==null?void 0:R.rate)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Capacity"}),a.jsx("input",{type:"number",...s(`rooms.${S}.capacity`,{valueAsNumber:!0}),className:k((O=(I=d.rooms)==null?void 0:I[S])==null?void 0:O.capacity)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase",children:"Equipment (Comma separated)"}),a.jsx(q1e,{control:i,name:`rooms.${S}.equipment`,render:({field:{onChange:D,value:F}})=>a.jsx(lG,{value:F||"",onChange:D,placeholder:"Console, Monitors, Mics...",multi:!0})})]}),a.jsx("button",{type:"button",onClick:()=>v(S),className:"absolute top-2 right-2 p-2 text-gray-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",children:a.jsx(bs,{size:18})})]},_.id)}),m.length===0&&a.jsx("p",{className:"text-center text-gray-400 py-4 italic",children:"No rooms listed."})]})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",disabled:n||!h,className:Id("px-8 py-4 rounded-xl font-bold text-lg flex items-center gap-2 transition-all shadow-xl",n||!h?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-blue-600 hover:scale-[1.01]"),children:n?a.jsx(rt,{className:"animate-spin",size:24}):a.jsxs(a.Fragment,{children:[a.jsx(Gd,{size:24})," Save Changes"]})})})]})]})}const YR=()=>{const[t,e]=N.useState(!1),[n,r]=N.useState(null);return{uploadImage:async(i,o)=>{if(!i)return null;e(!0),r(null);try{const c=`${Date.now()}_${i.name}`,d=`${o}/${c}`,h=Uz(oW,d),m=await Bz(h,i),p=await zz(m.ref);return e(!1),p}catch(l){return console.error("Upload failed:",l),r(l),e(!1),null}},uploading:t,error:n}},jEe=["Student","Instructor","Intern","Admin"];function cG({user:t,userData:e,onUpdate:n,onRoleSwitch:r}){var te,be,Fe,vt,ce,Be,Ye;const[s,i]=N.useState(e.settings||{notifications:{email:!0,push:!0,marketing:!1},privacy:{publicProfile:!0,showLocation:!0,hideProfile:!1},theme:"system",social:{mutedUsers:[],blockedUsers:[]},messenger:{mutedThreads:[],blockedContacts:[]},preferences:{seeAllProfiles:!1}}),[o,l]=N.useState(e.accountTypes||[]),[c,d]=N.useState(e.preferredRole||o[0]),[h,m]=N.useState(e.activeProfileRole||o[0]),[p,v]=N.useState(!1),[x,b]=N.useState(!1),[E,k]=N.useState(!1),[_,S]=N.useState(""),[T,P]=N.useState(!1),[j,R]=N.useState(!1),[I,O]=N.useState(null),[D,F]=N.useState({newEmail:"",newPassword:"",currentPassword:""}),[V,$]=N.useState(!1),[J,ue]=N.useState(!1);N.useEffect(()=>{e.activeProfileRole&&m(e.activeProfileRole)},[e.activeProfileRole]);const ve=(pe,bt)=>{i(Ht=>{var nr;const vr={...Ht,[pe]:{...Ht[pe],[bt]:!((nr=Ht[pe])!=null&&nr[bt])}};return n(vr),vr})},le=pe=>{i(bt=>{const Ht={...bt,theme:pe};return n(Ht),Ht})},q=async()=>{if(o.length===0)return alert("You must have at least one role.");v(!0);try{await Nt(Se(Z,Ve(t.uid).userProfile),{accountTypes:o,preferredRole:c,activeProfileRole:h}),h!==e.activeProfileRole&&r&&r(h);for(const pe of o){const bt=Se(Z,Ve(t.uid).userSubProfile(pe));(await uo(bt)).exists()||await ec(bt,{useRealName:!0,useGlobalName:!0})}alert("Roles & Preferences updated!")}catch(pe){console.error(pe),alert("Failed to update.")}v(!1)},Q=pe=>{l(bt=>bt.includes(pe)?bt.filter(Ht=>Ht!==pe):[...bt,pe])},H=pe=>{O(pe),F({newEmail:"",newPassword:"",currentPassword:""}),R(!0)},X=async()=>{if(!D.currentPassword)return alert("Current password is required to verify your identity.");$(!0);try{const pe=Ld.credential(t.email,D.currentPassword);if(await zX(t,pe),I==="email"){if(!D.newEmail)throw new Error("New email address is required.");await qX(t,D.newEmail),await Nt(Se(Z,Ve(t.uid).userProfile),{email:D.newEmail}),alert("Email updated successfully.")}else if(I==="password"){if(D.newPassword.length<6)throw new Error("Password must be at least 6 characters.");await GX(t,D.newPassword),alert("Password updated successfully.")}R(!1),F({newEmail:"",newPassword:"",currentPassword:""})}catch(pe){console.error("Security Update Error:",pe),pe.code==="auth/wrong-password"?alert("Incorrect current password."):pe.code==="auth/email-already-in-use"?alert("This email is already associated with another account."):alert("Failed to update: "+pe.message)}$(!1)},oe=async()=>{b(!0);try{const pe=D1(),vr=(await V1(pe,"exportUserData")()).data.data,nr=new Blob([vr],{type:"application/json"}),at=URL.createObjectURL(nr),he=document.createElement("a");he.href=at,he.download=`seshnx_data_export_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(he),he.click(),document.body.removeChild(he),alert("Your data has been downloaded successfully.")}catch(pe){console.error(pe),alert("Failed to export data. Please try again later.")}b(!1)},ae=async()=>{if(_==="DELETE"){k(!0);try{await YX(t)}catch(pe){console.error("Deletion Error:",pe),pe.code==="auth/requires-recent-login"?alert("For security, please log out and log back in before deleting your account."):alert("Failed to delete account: "+pe.message),k(!1)}}},je=({title:pe,items:bt,type:Ht,icon:vr})=>a.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[a.jsxs("h5",{className:"text-sm font-bold dark:text-gray-300 mb-2 flex items-center gap-2",children:[a.jsx(vr,{size:14})," ",pe]}),bt&&bt.length>0?a.jsx("div",{className:"flex flex-wrap gap-2",children:bt.map((nr,at)=>a.jsxs("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded flex items-center gap-1 text-gray-600 dark:text-gray-300",children:[nr.substring(0,8),"... ",a.jsx(_t,{size:10,className:"cursor-pointer hover:text-red-500"})]},at))}):a.jsxs("p",{className:"text-xs text-gray-400 italic",children:["No active ",Ht,"."]})]}),ge=J?[...new Set([...bw,...jEe])]:bw;return a.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-300 pb-20",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(Rs,{size:18,className:"text-purple-500"})," Roles & Workflow"]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block",children:"Active Account Types"}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-yellow-50 dark:bg-yellow-900/10 px-2 py-1 rounded border border-yellow-200 dark:border-yellow-800",children:[a.jsx("input",{type:"checkbox",checked:J,onChange:pe=>ue(pe.target.checked),className:"rounded text-yellow-600 focus:ring-yellow-500"}),a.jsx("span",{className:"text-[10px] font-bold text-yellow-700 dark:text-yellow-400",children:"Unlock All Roles"})]})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:ge.map(pe=>a.jsx("button",{onClick:()=>Q(pe),className:`px-3 py-1.5 rounded-full text-xs font-bold transition border ${o.includes(pe)?"bg-purple-100 border-purple-200 text-purple-700 dark:bg-purple-900/30 dark:border-purple-700 dark:text-purple-300":"bg-gray-50 border-gray-200 text-gray-500 dark:bg-transparent dark:border-gray-600 dark:text-gray-400"}`,children:pe},pe))})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[a.jsx(nR,{size:12})," Preferred Profile"]}),a.jsx("select",{className:"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:c,onChange:pe=>d(pe.target.value),children:o.map(pe=>a.jsx("option",{value:pe,children:pe},pe))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[a.jsx(uw,{size:12})," Active Workflow Context"]}),a.jsx("select",{className:"w-full p-2 text-sm border rounded-lg dark:bg-[#1f2128] dark:border-gray-600 dark:text-white",value:h,onChange:pe=>m(pe.target.value),children:o.map(pe=>a.jsx("option",{value:pe,children:pe},pe))})]})]}),a.jsxs("label",{className:"flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded transition border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ZA,{size:16,className:"text-brand-blue"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-200",children:"See All (Unfiltered View)"}),a.jsx("p",{className:"text-[10px] text-gray-500",children:"Show all content types regardless of active workflow."})]})]}),a.jsxs("div",{className:`w-10 h-5 rounded-full p-0.5 flex transition-colors ${(te=s.preferences)!=null&&te.seeAllProfiles?"bg-brand-blue justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:[a.jsx("input",{type:"checkbox",className:"hidden",checked:((be=s.preferences)==null?void 0:be.seeAllProfiles)||!1,onChange:()=>ve("preferences","seeAllProfiles")}),a.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t dark:border-gray-700",children:a.jsxs("button",{onClick:q,disabled:p,className:"w-full bg-purple-600 text-white px-4 py-2.5 rounded-lg font-bold hover:bg-purple-700 disabled:opacity-50 flex items-center justify-center gap-2 shadow-md transition",children:[p?a.jsx(rt,{className:"animate-spin",size:16}):a.jsx(uw,{size:16})," Save Workflow Settings"]})})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(na,{size:18,className:"text-blue-500"})," Account Security"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full text-blue-600 dark:text-blue-400",children:a.jsx(i0,{size:18})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold dark:text-white",children:"Email Address"}),a.jsx("div",{className:"text-xs text-gray-500",children:t.email})]})]}),a.jsx("button",{onClick:()=>H("email"),className:"text-xs font-bold bg-white dark:bg-gray-700 border dark:border-gray-600 px-3 py-1.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition",children:"Change Email"})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full text-blue-600 dark:text-blue-400",children:a.jsx(s0,{size:18})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold dark:text-white",children:"Password"}),a.jsx("div",{className:"text-xs text-gray-500",children:"Last changed: Never (or unknown)"})]})]}),a.jsx("button",{onClick:()=>H("password"),className:"text-xs font-bold bg-white dark:bg-gray-700 border dark:border-gray-600 px-3 py-1.5 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition",children:"Change Password"})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(Kd,{size:18,className:"text-gray-500"})," Content & Safety"]}),a.jsx(je,{title:"Blocked Users",items:(Fe=s.social)==null?void 0:Fe.blockedUsers,type:"blocks",icon:P4}),a.jsx(je,{title:"Muted Threads",items:(vt=s.messenger)==null?void 0:vt.mutedThreads,type:"mutes",icon:XA})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(Td,{size:18,className:"text-brand-blue"})," Notification Preferences"]}),a.jsx("div",{className:"space-y-3",children:Object.entries({email:"Email Notifications",push:"Push Notifications",marketing:"Marketing & Updates"}).map(([pe,bt])=>{var Ht;return a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm dark:text-gray-300",children:bt}),a.jsx("div",{onClick:()=>ve("notifications",pe),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(Ht=s.notifications)!=null&&Ht[pe]?"bg-brand-blue justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:a.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]},pe)})})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(na,{size:18,className:"text-green-500"})," Privacy & Visibility"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Oye,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"text-sm dark:text-gray-300",children:"Public Profile Visibility"})]}),a.jsx("div",{onClick:()=>ve("privacy","publicProfile"),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(ce=s.privacy)!=null&&ce.publicProfile?"bg-green-500 justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:a.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Br,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"text-sm dark:text-gray-300",children:"Show Location on Map"})]}),a.jsx("div",{onClick:()=>ve("privacy","showLocation"),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(Be=s.privacy)!=null&&Be.showLocation?"bg-green-500 justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:a.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(P4,{size:16,className:"text-gray-400"}),a.jsx("span",{className:"text-sm dark:text-gray-300",children:"Hide Profile Completely"})]}),a.jsx("div",{onClick:()=>ve("privacy","hideProfile"),className:`w-10 h-5 rounded-full p-0.5 flex cursor-pointer transition-colors ${(Ye=s.privacy)!=null&&Ye.hideProfile?"bg-brand-blue justify-end":"bg-gray-300 dark:bg-gray-600 justify-start"}`,children:a.jsx("div",{className:"w-4 h-4 bg-white rounded-full shadow-sm"})})]}),a.jsx("div",{className:"pt-4 mt-2 border-t dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold dark:text-white",children:"Your Data"}),a.jsx("p",{className:"text-[10px] text-gray-500",children:"Download a copy of your personal data (GDPR/CCPA)."})]}),a.jsxs("button",{onClick:oe,disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs font-bold text-gray-700 dark:text-gray-200 transition",children:[x?a.jsx(rt,{size:14,className:"animate-spin"}):a.jsx(Gm,{size:14}),"Download Data"]})]})})]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(JA,{size:18,className:"text-purple-500"})," Appearance"]}),a.jsx("div",{className:"flex bg-gray-100 dark:bg-black/20 p-1 rounded-lg",children:["light","dark","system"].map(pe=>a.jsx("button",{onClick:()=>le(pe),className:`flex-1 py-2 text-xs font-bold rounded-md capitalize transition-all ${s.theme===pe?"bg-white dark:bg-gray-700 shadow-sm text-brand-blue":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:pe},pe))})]}),a.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 p-6 rounded-xl border border-red-100 dark:border-red-800/30 shadow-sm",children:[a.jsxs("h3",{className:"font-bold text-lg text-red-600 dark:text-red-400 mb-2 flex items-center gap-2",children:[a.jsx(tu,{size:18})," Danger Zone"]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Deleting your account is permanent. This action will trigger the data cleanup process, removing your profile, posts, and messages."}),T?a.jsxs("div",{className:"bg-white dark:bg-[#1f2128] p-4 rounded-xl border border-red-200 dark:border-red-900 shadow-lg animate-in fade-in slide-in-from-bottom-2",children:[a.jsxs("h4",{className:"font-bold text-red-600 dark:text-red-400 mb-2 flex items-center gap-2",children:[a.jsx(Sd,{size:16})," Confirm Deletion"]}),a.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-3",children:["Type ",a.jsx("strong",{children:"DELETE"})," below to confirm. This cannot be undone."]}),a.jsx("input",{type:"text",className:"w-full p-2 border border-red-300 dark:border-red-900 rounded mb-3 text-sm focus:ring-2 focus:ring-red-500 outline-none dark:bg-black/20 dark:text-white",placeholder:"Type DELETE",value:_,onChange:pe=>S(pe.target.value)}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:ae,disabled:_!=="DELETE"||E,className:"flex-1 bg-red-600 text-white py-2 rounded font-bold text-xs hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:E?a.jsx(rt,{className:"animate-spin",size:14}):"Confirm Delete"}),a.jsx("button",{onClick:()=>{P(!1),S("")},className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-xs hover:opacity-80",children:"Cancel"})]})]}):a.jsx("button",{onClick:()=>P(!0),className:"bg-red-100 hover:bg-red-200 dark:bg-red-900/40 dark:hover:bg-red-900/60 text-red-700 dark:text-red-300 px-4 py-2 rounded-lg text-sm font-bold transition",children:"Delete Account"})]}),j&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 shadow-2xl animate-in zoom-in-95 border dark:border-gray-700",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-lg font-bold dark:text-white flex items-center gap-2",children:[I==="email"?a.jsx(i0,{size:20}):a.jsx(s0,{size:20}),"Update ",I==="email"?"Email":"Password"]}),a.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-white",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Current Password (Required)"}),a.jsx("input",{type:"password",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Verify your identity",value:D.currentPassword,onChange:pe=>F({...D,currentPassword:pe.target.value})})]}),I==="email"?a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"New Email Address"}),a.jsx("input",{type:"email",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"name@example.com",value:D.newEmail,onChange:pe=>F({...D,newEmail:pe.target.value})})]}):a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"New Password"}),a.jsx("input",{type:"password",className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Min 6 characters",value:D.newPassword,onChange:pe=>F({...D,newPassword:pe.target.value})})]}),a.jsxs("button",{onClick:X,disabled:V,className:"w-full bg-blue-600 text-white py-2.5 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2 shadow-lg mt-2",children:[V?a.jsx(rt,{className:"animate-spin",size:18}):a.jsx(es,{size:18}),"Confirm Update"]})]})]})})]})}const AEe=Pw({firstName:ls().min(2,"First name too short"),lastName:ls().min(2,"Last name too short"),displayName:ls().optional(),bio:ls().max(500,"Bio exceeds 500 characters").optional(),zip:ls().regex(/^\d{5}$/,"Invalid ZIP code").optional().or(FV("")),hourlyRate:Rw().min(0,"Rate cannot be negative").optional(),website:ls().url("Invalid URL").optional().or(FV(""))}),REe=(t,e,n)=>n?n.substring(0,2).toUpperCase():(((t==null?void 0:t[0])||"")+((e==null?void 0:e[0])||"")).toUpperCase()||"U";function PEe({user:t,userData:e,subProfiles:n={},handleLogout:r}){const[s,i]=N.useState("details"),[o,l]=N.useState("Main"),[c,d]=N.useState(!1),{uploadImage:h,uploading:m}=YR(),[p,v]=N.useState((e==null?void 0:e.useLegalNameOnly)||!1),[x,b]=N.useState((e==null?void 0:e.useUserNameOnly)||!1);N.useEffect(()=>{v((e==null?void 0:e.useLegalNameOnly)||!1),b((e==null?void 0:e.useUserNameOnly)||!1)},[e]);const E=()=>{const D=!p;v(D),D&&b(!1)},k=()=>{const D=!x;b(D),D&&v(!1)},{register:_,handleSubmit:S,formState:{errors:T,isDirty:P}}=KR({resolver:QR(AEe),defaultValues:{firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",displayName:(e==null?void 0:e.displayName)||"",bio:(e==null?void 0:e.bio)||"",zip:(e==null?void 0:e.zip)||"",hourlyRate:(e==null?void 0:e.hourlyRate)||0,website:(e==null?void 0:e.website)||""}}),j=async D=>{d(!0);const F=un.loading("Saving main profile...");try{let V=`${D.firstName} ${D.lastName}`;p?V=`${D.firstName} ${D.lastName}`:x&&D.displayName?V=D.displayName:D.displayName&&(V=`${D.firstName} "${D.displayName}" ${D.lastName}`);const $=Se(Z,Ve(t.uid).userProfile);await Nt($,{...D,useLegalNameOnly:p,useUserNameOnly:x,effectiveDisplayName:V,searchTerms:[D.firstName.toLowerCase(),D.lastName.toLowerCase(),(D.displayName||"").toLowerCase(),V.toLowerCase()].filter(Boolean)}),un.success("Main Profile Updated!",{id:F})}catch(V){console.error("Update failed",V),un.error("Failed to update profile.",{id:F})}finally{d(!1)}},R=async D=>{const F=D.target.files[0];if(!F)return;const V=un.loading("Uploading photo...");try{const $=await h(F,`users/${t.uid}/avatars`),J=Se(Z,Ve(t.uid).userProfile);await Nt(J,{photoURL:$}),un.success("Photo uploaded!",{id:V})}catch($){console.error($),un.error("Photo upload failed",{id:V})}},I=async D=>{try{const F=Se(Z,Ve(t.uid).userProfile);await Nt(F,{settings:D}),un.success("Settings saved.")}catch(F){console.error("Settings save failed",F),un.error("Failed to save settings.")}},O=D=>xx("w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white transition-all focus:ring-2 focus:ring-brand-blue outline-none",D?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-200 dark:border-gray-700");return a.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[a.jsxs("h1",{className:"text-3xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Jr,{className:"text-brand-blue"})," ",s==="details"?"Edit Profile":"Account Settings"]}),a.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-1 rounded-lg flex gap-1 self-start md:self-auto",children:[a.jsx("button",{onClick:()=>i("details"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all ${s==="details"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"Edit Details"}),a.jsxs("button",{onClick:()=>i("settings"),className:`px-4 py-2 text-xs font-bold rounded-md transition-all flex items-center gap-1 ${s==="settings"?"bg-white dark:bg-[#2c2e36] text-brand-blue shadow-sm":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"}`,children:[a.jsx(Kd,{size:14})," Settings"]})]})]}),s==="details"?a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 animate-in fade-in slide-in-from-bottom-2",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-2",children:[a.jsx("div",{className:"font-bold text-xs text-gray-500 uppercase tracking-wider mb-2 px-1",children:"Profiles"}),a.jsxs("button",{onClick:()=>l("Main"),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all ${o==="Main"?"bg-brand-blue text-white shadow-md":"bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jr,{size:16})," ",a.jsx("span",{className:"font-bold text-sm",children:"Main Profile"})]}),o==="Main"&&a.jsx(ea,{size:16})]}),((e==null?void 0:e.accountTypes)||[]).map(D=>_w[D]?a.jsxs("button",{onClick:()=>l(D),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all ${o===D?"bg-brand-blue text-white shadow-md":"bg-white dark:bg-dark-card hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jo,{size:16})," ",a.jsx("span",{className:"font-bold text-sm",children:D})]}),o===D&&a.jsx(ea,{size:16})]},D):null)]}),a.jsx("div",{className:"lg:col-span-3",children:o==="Main"?a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"md:col-span-1 space-y-4",children:[a.jsxs("div",{className:"relative group w-full aspect-square rounded-full overflow-hidden bg-gray-100 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 shadow-md",children:[e!=null&&e.photoURL?a.jsx("img",{src:e.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):a.jsx("div",{className:"flex items-center justify-center h-full bg-gradient-to-tr from-brand-blue to-purple-500 text-white font-bold text-4xl",children:REe(e==null?void 0:e.firstName,e==null?void 0:e.lastName,e==null?void 0:e.displayName)}),a.jsxs("label",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity",children:[a.jsx("span",{className:"text-white font-bold text-sm",children:"Change Photo"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:R,disabled:m})]}),m&&a.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:a.jsx(rt,{className:"animate-spin text-white"})})]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl text-xs text-blue-800 dark:text-blue-200",children:[a.jsx("p",{className:"font-bold mb-1",children:"Pro Tip:"}),"High-quality profile photos increase booking rates by 40%."]})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsxs("form",{onSubmit:S(j),className:"space-y-6 bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"First Name (Legal)"}),a.jsx("input",{..._("firstName"),className:O(T.firstName)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Last Name (Legal)"}),a.jsx("input",{..._("lastName"),className:O(T.lastName)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"User Name (Display Name)"}),a.jsx("input",{..._("displayName"),className:O(T.displayName),placeholder:"e.g. SeshMaster"})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Display Name Preferences"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use Legal Name Only"}),a.jsx("button",{type:"button",onClick:E,className:"text-brand-blue",children:p?a.jsx(Xu,{size:28}):a.jsx(Yu,{size:28,className:"text-gray-400"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use User Name Only"}),a.jsx("button",{type:"button",onClick:k,className:"text-brand-blue",children:x?a.jsx(Xu,{size:28}):a.jsx(Yu,{size:28,className:"text-gray-400"})})]}),a.jsxs("div",{className:"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2",children:["Preview: ",a.jsx("strong",{className:"text-brand-blue",children:p?`${e.firstName} ${e.lastName}`:x?e.displayName||"Not Set":`${e.firstName} "${e.displayName||"User"}" ${e.lastName}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Bio / About"}),a.jsx("textarea",{..._("bio"),rows:"4",className:O(T.bio),placeholder:"Tell us about your musical journey..."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[a.jsx(Br,{size:12})," ZIP Code"]}),a.jsx("input",{..._("zip"),className:O(T.zip)})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block flex items-center gap-1",children:[a.jsx(ui,{size:12})," Hourly Rate ($)"]}),a.jsx("input",{type:"number",..._("hourlyRate",{valueAsNumber:!0}),className:O(T.hourlyRate)})]})]}),a.jsx("div",{className:"pt-4 border-t dark:border-gray-700 flex justify-end",children:a.jsx("button",{type:"button",onClick:S(j),disabled:c,className:Id("px-8 py-3 rounded-xl font-bold flex items-center gap-2 transition-all shadow-lg",c?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-brand-blue text-white hover:bg-blue-600 hover:scale-105"),children:c?a.jsx(rt,{className:"animate-spin",size:20}):a.jsxs(a.Fragment,{children:[a.jsx(Gd,{size:20})," Save Changes"]})})})]})})]}):a.jsx(LEe,{user:t,userData:e,role:o,initialData:n[o]||{},schema:_w[o]||[]})})]}):a.jsx("div",{className:"animate-in fade-in slide-in-from-right-2",children:a.jsx(cG,{user:t,userData:e,handleLogout:r,onUpdate:I})})]})}function LEe({user:t,userData:e,role:n,initialData:r,schema:s}){const[i,o]=N.useState(r),[l,c]=N.useState(!1),[d,h]=N.useState(r.followMainProfile??!0),[m,p]=N.useState(r.useLegalNameOnly??!1),[v,x]=N.useState(r.useUserNameOnly??!1),[b,E]=N.useState(r.syncStudioOps??!1);N.useEffect(()=>{o(r||{}),h(r.followMainProfile??!0),p(r.useLegalNameOnly??!1),x(r.useUserNameOnly??!1),E(r.syncStudioOps??!1)},[r]);const k=(j,R)=>o(I=>({...I,[j]:R})),_=()=>{p(!m),m||x(!1)},S=()=>{x(!v),v||p(!1)},T=async j=>{j.preventDefault(),c(!0);const R=un.loading(`Saving ${n} profile...`);try{let I="";d?I=e.effectiveDisplayName||`${e.firstName} ${e.lastName}`:m?I=`${e.firstName} ${e.lastName}`:v?I=e.displayName||`${e.firstName} ${e.lastName}`:I=i.profileName||`${e.firstName} ${e.lastName}`;const O={...i,followMainProfile:d,useLegalNameOnly:m,useUserNameOnly:v,syncStudioOps:b,displayName:I},D=Se(Z,Ve(t.uid).userSubProfile(n));if(await ec(D,O,{merge:!0}),e.activeProfileRole===n){const F=Se(Z,Ve(t.uid).userPublicProfile);await Nt(F,{displayName:I,searchTerms:[I.toLowerCase()]})}if(n==="Studio"&&b){const F=Se(Z,Ve(t.uid).userProfile);await Nt(F,{studioName:I})}un.success(`${n} Profile Saved!`,{id:R})}catch(I){console.error(I),un.error("Failed to save.",{id:R})}finally{c(!1)}};if(s.length===0)return a.jsx("div",{className:"p-10 text-center text-gray-500",children:"No configuration available for this role."});const P=s.filter(j=>j.key!=="profileName"&&j.key!=="useRealName");return a.jsxs("form",{onSubmit:T,className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm space-y-6",children:[a.jsxs("h2",{className:"text-xl font-bold dark:text-white border-b dark:border-gray-700 pb-2",children:[n," Identity & Details"]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-[#23262f] p-4 rounded-xl border dark:border-gray-600 space-y-3",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Identity Settings"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold dark:text-white",children:"Follow Main Profile Name"}),a.jsxs("div",{className:"text-xs text-gray-500",children:['Use "',e.effectiveDisplayName||`${e.firstName} ${e.lastName}`,'"']})]}),a.jsx("button",{type:"button",onClick:()=>h(!d),className:"text-brand-blue",children:d?a.jsx(Xu,{size:28}):a.jsx(Yu,{size:28,className:"text-gray-400"})})]}),!d&&a.jsxs("div",{className:"space-y-3 animate-in slide-in-from-top-1 pt-3 border-t dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use Legal Name Only"}),a.jsx("button",{type:"button",onClick:_,className:"text-brand-blue",children:m?a.jsx(Xu,{size:28}):a.jsx(Yu,{size:28,className:"text-gray-400"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm dark:text-gray-200",children:"Use Main User Name Only"}),a.jsx("button",{type:"button",onClick:S,className:"text-brand-blue",children:v?a.jsx(Xu,{size:28}):a.jsx(Yu,{size:28,className:"text-gray-400"})})]}),!m&&!v&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("label",{className:"text-xs font-bold text-brand-blue uppercase mb-1 block",children:[n," Name"]}),a.jsx("input",{type:"text",className:"w-full p-3 border rounded-lg dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none font-bold",placeholder:`e.g. ${n==="Studio"?"Sound City":"The Weeknd"}`,value:i.profileName||"",onChange:j=>k("profileName",j.target.value)}),n==="Studio"&&a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("input",{type:"checkbox",checked:b,onChange:j=>E(j.target.checked),className:"rounded text-brand-blue focus:ring-brand-blue"}),a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Force "Studio Ops" to use this name'})]})]}),a.jsxs("div",{className:"text-xs text-gray-500 italic mt-2 border-t dark:border-gray-700 pt-2",children:["Preview: ",a.jsx("strong",{className:"text-brand-blue",children:m?`${e.firstName} ${e.lastName}`:v?e.displayName||"Not Set":i.profileName||"Not Set"})]})]})]}),P.map(j=>{var R;return j.isToggle?null:a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:j.label}),j.type==="textarea"?a.jsx("textarea",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none",rows:4,value:i[j.key]||"",onChange:I=>k(j.key,I.target.value)}):j.type==="select"?a.jsx("select",{className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none",value:i[j.key]||"",onChange:I=>k(j.key,I.target.value),children:(R=j.options)==null?void 0:R.map(I=>a.jsx("option",{value:I,children:I},I))}):j.type==="multi_select"?a.jsx(BR,{label:"",fieldKey:j.key,options:j.data||j.options||[],initialValues:i[j.key]||[],onChange:k}):j.type==="nested_select"?a.jsx(Gke,{label:"",fieldKey:j.key,data:j.data,initialValues:i[j.key]||[],onChange:k}):j.key==="equipment"?a.jsx(lG,{multi:!0,value:i[j.key]||"",onChange:I=>k(j.key,I),placeholder:"Add gear..."}):a.jsx("input",{type:j.type==="number"?"number":"text",className:"w-full p-3 border rounded-xl dark:bg-[#1f2128] dark:text-white dark:border-gray-600 focus:ring-2 focus:ring-brand-blue outline-none",value:i[j.key]||"",onChange:I=>k(j.key,I.target.value)})]},j.key)}),a.jsx("div",{className:"pt-4 border-t dark:border-gray-700 flex justify-end",children:a.jsx("button",{type:"submit",disabled:l,className:"px-8 py-3 rounded-xl font-bold bg-brand-blue text-white hover:bg-blue-600 flex items-center gap-2 transition shadow-lg disabled:opacity-50",children:l?a.jsx(rt,{className:"animate-spin",size:20}):a.jsxs(a.Fragment,{children:[a.jsx(Gd,{size:20})," Save ",n," Profile"]})})})]})}function MEe({rating:t=0,setRating:e,interactive:n=!1,size:r=16}){const[s,i]=N.useState(0);return a.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(o=>a.jsx(nR,{size:r,className:`transition-colors ${n?"cursor-pointer":""} ${(n&&s||t)>=o?"fill-yellow-400 text-yellow-400":"text-gray-300 dark:text-gray-600"}`,fill:(n&&s||t)>=o?"currentColor":"none",onMouseEnter:()=>n&&i(o),onMouseLeave:()=>n&&i(0),onClick:()=>n&&e(o)},o))})}const to={FOLLOWERS:"followers",FOLLOWING:"following"};function OEe({userId:t,userName:e,initialTab:n=to.FOLLOWERS,currentUser:r,currentUserData:s,isFollowing:i,toggleFollow:o,onClose:l,openPublicProfile:c}){const[d,h]=N.useState(n),[m,p]=N.useState([]),[v,x]=N.useState([]),[b,E]=N.useState(!0),[k,_]=N.useState("");N.useEffect(()=>{if(!t)return;E(!0);const I=Re(Z,Ve(t).followers),O=Et(I,Wn("timestamp","desc"),Qs(100)),D=pn(O,F=>{const V=F.docs.map($=>({odId:$.id,userId:$.id,...$.data()}));p(V),E(!1)},F=>{console.error("Followers fetch error:",F),E(!1)});return()=>D()},[t]),N.useEffect(()=>{if(!t)return;const I=Re(Z,Ve(t).following),O=Et(I,Wn("timestamp","desc"),Qs(100)),D=pn(O,F=>{const V=F.docs.map($=>({odId:$.id,userId:$.id,...$.data()}));x(V)},F=>{console.error("Following fetch error:",F)});return()=>D()},[t]);const S=d===to.FOLLOWERS?m:v,T=k.trim()?S.filter(I=>{var O;return(O=I.displayName)==null?void 0:O.toLowerCase().includes(k.toLowerCase())}):S,P=t===(r==null?void 0:r.uid),j=I=>{c&&(c(I),l())},R=async I=>{o&&await o(I.userId,{displayName:I.displayName,photoURL:I.photoURL,role:I.role})};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:a.jsxs(nt.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white dark:bg-[#2c2e36] rounded-2xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 shrink-0",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-bold text-lg dark:text-white",children:e||"User"}),a.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 transition",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-800 rounded-xl p-1",children:[a.jsxs("button",{onClick:()=>h(to.FOLLOWERS),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${d===to.FOLLOWERS?"bg-white dark:bg-gray-700 shadow-sm text-brand-blue":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[a.jsx(Rs,{size:16}),a.jsx("span",{children:"Followers"}),a.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d===to.FOLLOWERS?"bg-brand-blue/10 text-brand-blue":"bg-gray-200 dark:bg-gray-600"}`,children:m.length})]}),a.jsxs("button",{onClick:()=>h(to.FOLLOWING),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${d===to.FOLLOWING?"bg-white dark:bg-gray-700 shadow-sm text-brand-blue":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[a.jsx(fC,{size:16}),a.jsx("span",{children:"Following"}),a.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${d===to.FOLLOWING?"bg-brand-blue/10 text-brand-blue":"bg-gray-200 dark:bg-gray-600"}`,children:v.length})]})]})]}),S.length>5&&a.jsx("div",{className:"px-4 py-3 border-b dark:border-gray-700 shrink-0",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search...",value:k,onChange:I=>_(I.target.value),className:"w-full pl-9 pr-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm outline-none focus:ring-2 focus:ring-brand-blue dark:text-white transition"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:b?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(rt,{className:"animate-spin text-brand-blue mb-2",size:28}),a.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."})]}):T.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-4",children:d===to.FOLLOWERS?a.jsx(Rs,{size:24,className:"text-gray-400"}):a.jsx(fC,{size:24,className:"text-gray-400"})}),a.jsx("p",{className:"text-gray-500 text-center",children:k?`No results for "${k}"`:d===to.FOLLOWERS?P?"You don't have any followers yet":"No followers yet":P?"You're not following anyone yet":"Not following anyone yet"}),!k&&d===to.FOLLOWING&&P&&a.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Find artists and creators to follow in the feed!"})]}):a.jsx(yr,{mode:"popLayout",children:T.map((I,O)=>a.jsx(DEe,{user:I,index:O,currentUserId:r==null?void 0:r.uid,isFollowingUser:i==null?void 0:i(I.userId),onToggleFollow:()=>R(I),onUserClick:()=>j(I.userId)},I.userId))})})]})})}function DEe({user:t,index:e,currentUserId:n,isFollowingUser:r,onToggleFollow:s,onUserClick:i}){const o=t.userId===n;return a.jsxs(nt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-10},transition:{delay:e*.03},className:"flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition border-b dark:border-gray-700/50 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 cursor-pointer",onClick:i,children:[a.jsx(ra,{src:t.photoURL,name:t.displayName,size:"md"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h4",{className:"font-semibold text-sm dark:text-white truncate hover:text-brand-blue transition",children:t.displayName}),t.role&&a.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.role})]})]}),!o&&a.jsx($R,{isFollowing:r,onToggle:s,size:"sm",variant:"outline"}),o&&a.jsx("span",{className:"text-xs text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded-full",children:"You"})]})}function VEe({followersCount:t=0,followingCount:e=0,onFollowersClick:n,onFollowingClick:r,size:s="md"}){const i={sm:"text-xs gap-3",md:"text-sm gap-4",lg:"text-base gap-5"},o={sm:"text-sm",md:"text-base",lg:"text-lg"};return a.jsxs("div",{className:`flex items-center ${i[s]}`,children:[a.jsxs("button",{onClick:n,className:"flex items-center gap-1 hover:text-brand-blue transition group",children:[a.jsx("span",{className:`font-bold dark:text-white group-hover:text-brand-blue ${o[s]}`,children:t.toLocaleString()}),a.jsx("span",{className:"text-gray-500",children:t===1?"Follower":"Followers"})]}),a.jsx("span",{className:"text-gray-300 dark:text-gray-600",children:""}),a.jsxs("button",{onClick:r,className:"flex items-center gap-1 hover:text-brand-blue transition group",children:[a.jsx("span",{className:`font-bold dark:text-white group-hover:text-brand-blue ${o[s]}`,children:e.toLocaleString()}),a.jsx("span",{className:"text-gray-500",children:"Following"})]})]})}function FEe({userId:t,currentUser:e,currentUserData:n,onClose:r,onMessage:s}){var D,F,V,$,J;const[i,o]=N.useState(null),[l,c]=N.useState(!0),[d,h]=N.useState(null),[m,p]=N.useState(!1),[v,x]=N.useState(!1),[b,E]=N.useState("followers"),k=(e==null?void 0:e.uid)===t,{uploadImage:_}=YR(),{isFollowing:S,toggleFollow:T}=Dq(e==null?void 0:e.uid,n),{stats:P}=Zke(t),j=(ue="followers")=>{E(ue),x(!0)},R=async()=>{try{const ue=Se(Z,Ve(t).userPublicProfile),ve=await uo(ue);if(ve.exists())o(ve.data());else{const le=Se(Z,Ve(t).userProfile),q=await uo(le);q.exists()?o(q.data()):h("Profile not found or is private.")}}catch(ue){console.error("Failed to load profile:",ue),h("Unable to load profile. Please try again later.")}finally{c(!1)}};N.useEffect(()=>{t&&R()},[t]);const I=async ue=>{const ve=ue.target.files[0];if(!(!ve||!k)){p(!0);try{const le=await _(ve,`artifacts/${t}/images/banners`);le&&(await Nt(Se(Z,Ve(t).userPublicProfile),{bannerURL:le}),o(q=>({...q,bannerURL:le})))}catch(le){console.error("Banner upload failed:",le),alert("Failed to upload banner.")}p(!1)}};if(!t)return null;const O=()=>a.jsxs("div",{className:"p-8 flex flex-col items-center space-y-6 animate-pulse",children:[a.jsx("div",{className:"h-40 w-full bg-gray-200 dark:bg-gray-700 rounded-xl"}),a.jsx("div",{className:"h-28 w-28 bg-gray-300 dark:bg-gray-600 rounded-full -mt-20 border-4 border-white dark:border-dark-card"}),a.jsx("div",{className:"h-6 w-1/2 bg-gray-200 dark:bg-gray-700 rounded"}),a.jsx("div",{className:"h-4 w-1/3 bg-gray-200 dark:bg-gray-700 rounded"})]});return a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:[a.jsxs("div",{className:"bg-white dark:bg-[#1f2128] w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] border border-gray-200 dark:border-gray-700",onClick:ue=>ue.stopPropagation(),children:[a.jsx("button",{onClick:r,className:"absolute top-4 right-4 z-30 p-2 bg-black/30 hover:bg-black/50 text-white rounded-full transition-colors backdrop-blur-md",children:a.jsx(_t,{size:20})}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar relative",children:l?a.jsx(O,{}):d||!i?a.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-12 text-gray-500",children:[a.jsx(Sd,{size:48,className:"text-yellow-500 mb-4 opacity-80"}),a.jsx("h3",{className:"text-xl font-bold dark:text-gray-200 mb-2",children:"Profile Unavailable"}),a.jsx("p",{className:"text-sm text-center max-w-xs",children:d||"This user's profile information could not be retrieved."}),a.jsx("button",{onClick:r,className:"mt-6 px-6 py-2 bg-gray-200 dark:bg-gray-700 rounded-full font-bold text-sm hover:bg-gray-300 transition",children:"Close"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"h-48 relative bg-gray-800 group",children:[i.bannerURL?a.jsx("img",{src:i.bannerURL,alt:"Cover",className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full bg-gradient-to-r from-brand-blue to-purple-600",children:a.jsx("div",{className:"absolute inset-0 opacity-30 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"})}),k&&a.jsxs("label",{className:"absolute top-4 left-4 cursor-pointer bg-black/40 hover:bg-black/60 text-white px-3 py-1.5 rounded-lg text-xs font-bold backdrop-blur-md transition-all flex items-center gap-2 border border-white/10",children:[m?a.jsx(rt,{size:14,className:"animate-spin"}):a.jsx(v1,{size:14}),m?"Uploading...":"Edit Cover",a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:I,disabled:m})]}),a.jsxs("div",{className:"absolute bottom-4 right-6 flex gap-3 opacity-90",children:[i.rate>0&&a.jsxs("span",{className:"bg-black/60 backdrop-blur-md text-white text-xs font-bold px-3 py-1 rounded-full border border-white/10 flex items-center gap-1 shadow-sm",children:[a.jsx(ui,{size:12})," $",i.rate,"/hr"]}),i.city&&a.jsxs("span",{className:"bg-black/60 backdrop-blur-md text-white text-xs font-bold px-3 py-1 rounded-full border border-white/10 flex items-center gap-1 shadow-sm",children:[a.jsx(Br,{size:12})," ",i.city,", ",i.state]})]})]}),a.jsxs("div",{className:"px-8 pb-8 relative",children:[a.jsxs("div",{className:"flex justify-between items-end -mt-14 mb-6",children:[a.jsx("div",{className:"relative z-10 group",children:a.jsx("div",{className:"h-32 w-32 rounded-full border-[5px] border-white dark:border-[#1f2128] bg-gray-200 dark:bg-gray-700 overflow-hidden shadow-xl",children:i.photoURL?a.jsx("img",{src:i.photoURL,alt:"Profile",className:"h-full w-full object-cover"}):a.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400",children:a.jsx(Jr,{size:48})})})}),e&&!k&&a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx($R,{isFollowing:S(t),onToggle:()=>{var ue;return T(t,{displayName:`${i.firstName||""} ${i.lastName||""}`.trim(),photoURL:i.photoURL,role:((ue=i.accountTypes)==null?void 0:ue[0])||"User"})},size:"md"}),a.jsxs("button",{onClick:()=>s(t,`${i.firstName} ${i.lastName}`),className:"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 px-5 py-2.5 rounded-xl font-bold text-sm hover:bg-gray-200 dark:hover:bg-gray-700 transition flex items-center gap-2 border dark:border-gray-700",children:[a.jsx(Cd,{size:18})," Message"]})]}),k&&a.jsx("div",{className:"mb-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs font-bold rounded-lg border border-green-200 dark:border-green-800",children:"Public View Mode"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h1",{className:"text-3xl font-extrabold dark:text-white flex items-center gap-2 mb-2",children:[i.firstName||"User"," ",i.lastName||"",i.isVerified&&a.jsx(na,{size:22,className:"text-blue-500 fill-blue-500 text-white"})]}),a.jsx("div",{className:"flex flex-wrap gap-2 text-sm text-gray-500 dark:text-gray-400 font-medium mb-4",children:(i.accountTypes||["Creative"]).map((ue,ve)=>a.jsx("span",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full text-xs font-bold",children:ue},ve))}),a.jsx(VEe,{followersCount:P.followersCount||0,followingCount:P.followingCount||0,onFollowersClick:()=>j("followers"),onFollowingClick:()=>j("following"),size:"md"})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 py-6 border-y dark:border-gray-800 mb-8",children:[a.jsxs("div",{className:"text-center md:text-left",children:[a.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Rating"}),a.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-1",children:[a.jsx("span",{className:"text-xl font-bold dark:text-white",children:i.rating||"New"}),i.rating>0&&a.jsx(MEe,{rating:i.rating,size:14})]})]}),a.jsxs("div",{className:"text-center md:text-left",children:[a.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Experience"}),a.jsxs("div",{className:"text-xl font-bold dark:text-white",children:[i.yearsExp||"1+"," ",a.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Yrs"})]})]}),a.jsxs("div",{className:"text-center md:text-left",children:[a.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Response"}),a.jsxs("div",{className:"text-xl font-bold dark:text-white",children:["~1 ",a.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Hr"})]})]}),a.jsxs("div",{className:"text-center md:text-left",children:[a.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Bookings"}),a.jsx("div",{className:"text-xl font-bold dark:text-white",children:i.completedJobs||0})]})]}),a.jsxs("div",{className:"mb-8",children:[a.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[a.jsx(Jr,{size:14})," About"]}),a.jsx("div",{className:"bg-gray-50 dark:bg-[#252830] p-5 rounded-xl border dark:border-gray-800",children:a.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-sm whitespace-pre-line",children:i.bio||"No biography provided yet."})})]}),(((D=i.genres)==null?void 0:D.length)>0||((F=i.instruments)==null?void 0:F.length)>0)&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[a.jsx(ta,{size:14})," Sound Profile"]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[(V=i.genres)==null?void 0:V.map(ue=>a.jsx("span",{className:"px-3 py-1.5 bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300 rounded-lg text-xs font-bold border border-purple-100 dark:border-purple-800",children:ue},ue)),($=i.instruments)==null?void 0:$.map(ue=>a.jsx("span",{className:"px-3 py-1.5 bg-blue-50 dark:bg-blue-900/20 text-brand-blue dark:text-blue-300 rounded-lg text-xs font-bold border border-blue-100 dark:border-blue-800",children:ue},ue))]})]}),((J=i.equipmentList)==null?void 0:J.length)>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[a.jsx(Jo,{size:14})," Select Gear"]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-[#252830] rounded-xl p-4 border dark:border-gray-800",children:[a.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm text-gray-600 dark:text-gray-400",children:i.equipmentList.slice(0,10).map((ue,ve)=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx(es,{size:14,className:"text-brand-blue shrink-0 mt-0.5"}),a.jsx("span",{className:"truncate",children:ue})]},ve))}),i.equipmentList.length>10&&a.jsx("div",{className:"mt-3 pt-3 border-t dark:border-gray-700 text-center",children:a.jsxs("span",{className:"text-xs text-gray-400 font-medium italic",children:["+",i.equipmentList.length-10," more items available"]})})]})]})]})]})})]}),v&&a.jsx(OEe,{userId:t,userName:`${(i==null?void 0:i.firstName)||""} ${(i==null?void 0:i.lastName)||""}`.trim()||"User",initialTab:b,currentUser:e,currentUserData:n,isFollowing:S,toggleFollow:T,onClose:()=>x(!1),openPublicProfile:ue=>{x(!1)}})]})}function $Ee({user:t}){const[e,n]=N.useState([]),[r,s]=N.useState("All");return N.useEffect(()=>{const i=Et(Re(Z,`artifacts/${Ge}/public/data/service_requests`),Wn("timestamp","desc"),Qs(50)),o=pn(i,l=>n(l.docs.map(c=>({id:c.id,...c.data()}))));return()=>o()},[]),a.jsxs("div",{className:"animate-in fade-in",children:[a.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 scrollbar-hide mb-2",children:[a.jsx("button",{onClick:()=>s("All"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap border transition ${r==="All"?"bg-orange-500 text-white border-orange-600":"bg-white dark:bg-dark-card border-gray-200 dark:border-gray-700 dark:text-gray-300"}`,children:"All Jobs"}),ww.map(i=>a.jsx("button",{onClick:()=>s(i.label),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap border transition ${r===i.label?"bg-orange-500 text-white border-orange-600":"bg-white dark:bg-dark-card border-gray-200 dark:border-gray-700 dark:text-gray-300"}`,children:i.label},i.id))]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.filter(i=>r==="All"||i.category===r).map(i=>a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 hover:border-orange-400 transition shadow-sm group",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsx("span",{className:"text-[10px] font-bold uppercase text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/20 px-2 py-0.5 rounded",children:i.category}),i.budget&&a.jsxs("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:["$",i.budget]})]}),a.jsx("h3",{className:"font-bold text-lg dark:text-white mb-1",children:i.topic}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-2 mb-4",children:i.description}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 border-t dark:border-gray-700 pt-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jr,{size:12})," ",i.userName]}),i.userId!==t.uid&&a.jsxs("button",{className:"bg-gray-900 dark:bg-white dark:text-black text-white px-3 py-1.5 rounded font-bold hover:opacity-80 flex items-center gap-1",children:[a.jsx(Cd,{size:12})," Message"]})]})]},i.id)),e.length===0&&a.jsx("div",{className:"col-span-full text-center py-12 text-gray-400",children:"No active requests."})]})]})}function BEe({user:t,userData:e,target:n,onClose:r}){const[s,i]=N.useState(!1),[o,l]=N.useState({serviceCategory:"Repair",equipmentName:"",issueDescription:"",logistics:"Drop-off",preferredDate:"",budgetCap:""}),[c,d]=N.useState([]),{uploadMedia:h,uploading:m}=gl(),p=async x=>{const b=x.target.files[0];if(!b)return;const E=await h(b,`tech_requests/${t.uid}`);E&&d(k=>[...k,E])},v=async()=>{if(!o.equipmentName||!o.issueDescription)return alert("Please describe the equipment and the issue.");i(!0);try{await hn(Re(Z,`artifacts/${Ge}/public/data/bookings`),{senderId:t.uid,senderName:`${e.firstName} ${e.lastName}`,targetId:n.id,targetName:n.firstName?`${n.firstName} ${n.lastName}`:n.name,type:"TechRequest",serviceType:o.serviceCategory,equipment:o.equipmentName,description:o.issueDescription,logistics:o.logistics,budgetCap:o.budgetCap,status:"Pending",date:o.preferredDate||"Flexible",message:`[${o.serviceCategory}] ${o.equipmentName}: ${o.issueDescription}`,attachments:c,timestamp:zt()}),alert("Service request sent!"),r()}catch{alert("Failed to send.")}i(!1)};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4 animate-in fade-in zoom-in-95",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700 flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-5 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white flex items-center gap-2",children:[a.jsx(Km,{size:18,className:"text-orange-500"})," Service Request"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Hiring ",a.jsxs("span",{className:"font-bold text-orange-600 dark:text-orange-400",children:[n.firstName," ",n.lastName]})]})]}),a.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition",children:a.jsx(_t,{size:20})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Type"}),a.jsx("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:o.serviceCategory,onChange:x=>l({...o,serviceCategory:x.target.value}),children:ww.map(x=>a.jsx("option",{value:x.label,children:x.label},x.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Logistics"}),a.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:o.logistics,onChange:x=>l({...o,logistics:x.target.value}),children:[a.jsx("option",{value:"Drop-off",children:"I will drop it off"}),a.jsx("option",{value:"On-site",children:"Tech comes to me"}),a.jsx("option",{value:"Ship",children:"I will ship it"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Equipment"}),a.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"e.g. Fender Twin Reverb",value:o.equipmentName,onChange:x=>l({...o,equipmentName:x.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Issue Description"}),a.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px] text-sm",placeholder:"Describe symptoms...",value:o.issueDescription,onChange:x=>l({...o,issueDescription:x.target.value})})]}),a.jsxs("div",{className:"pt-4 border-t dark:border-gray-700",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-brand-blue hover:text-blue-600 font-bold mb-3",children:[a.jsx(Qd,{size:16})," Add Video/Photo ",a.jsx("input",{type:"file",className:"hidden",accept:"image/*,video/*",onChange:p,disabled:m})]}),a.jsx("div",{className:"flex gap-2 overflow-x-auto",children:c.map((x,b)=>a.jsx("div",{className:"h-12 w-12 bg-black rounded border dark:border-gray-600 overflow-hidden",children:a.jsx("img",{src:x.url,className:"h-full w-full object-cover"})},b))})]})]}),a.jsx("div",{className:"p-5 border-t dark:border-gray-700 bg-gray-50 dark:bg-[#23262f]",children:a.jsx("button",{onClick:v,disabled:s||m,className:"w-full bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition shadow-lg",children:s?a.jsx(rt,{className:"animate-spin mx-auto"}):"Submit Request"})})]})})}function zEe({user:t,userData:e,openPublicProfile:n}){const[r,s]=N.useState([]),[i,o]=N.useState(!1),[l,c]=N.useState(""),[d,h]=N.useState(""),[m,p]=N.useState(null),v=async()=>{o(!0);try{const x=[nn("accountTypes","array-contains","Technician"),Qs(20)];l&&x.push(nn("searchTerms","array-contains",l.toLowerCase()));const b=Et(gd(Z,"public_profile"),...x);let k=(await Kt(b)).docs.map(_=>({id:_.ref.parent.parent.id,..._.data()})).filter(_=>_.id!==t.uid);d&&(k=k.filter(_=>_.subRoles&&_.subRoles.includes(d))),s(k)}catch(x){console.error(x)}o(!1)};return N.useEffect(()=>{v()},[d]),a.jsxs("div",{className:"animate-in fade-in",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ur,{className:"absolute left-4 top-3.5 text-gray-400",size:18}),a.jsx("input",{className:"w-full pl-12 p-3 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-orange-500 dark:text-white",placeholder:"Search technicians...",value:l,onChange:x=>c(x.target.value),onKeyDown:x=>x.key==="Enter"&&v()})]}),a.jsx("div",{className:"md:w-1/3",children:a.jsxs("select",{className:"w-full p-3 bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm outline-none focus:ring-2 focus:ring-orange-500 dark:text-white cursor-pointer",value:d,onChange:x=>h(x.target.value),children:[a.jsx("option",{value:"",children:"All Specialties"}),vq.map(x=>a.jsx("option",{value:x,children:x},x))]})})]}),i?a.jsx("div",{className:"text-center py-12",children:a.jsx(rt,{className:"animate-spin mx-auto text-orange-500"})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(x=>{var b,E,k;return a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden shadow-sm hover:shadow-lg transition group",children:[a.jsx("div",{className:"h-24 bg-gradient-to-r from-slate-700 to-slate-600 relative",children:a.jsx("div",{className:"absolute -bottom-8 left-6",children:a.jsx("div",{className:"h-16 w-16 rounded-full border-4 border-white dark:border-[#2c2e36] bg-gray-200 overflow-hidden",children:x.photoURL?a.jsx("img",{src:x.photoURL,className:"h-full w-full object-cover"}):a.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:a.jsx(Jr,{})})})})}),a.jsxs("div",{className:"pt-10 px-6 pb-6",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-bold dark:text-white text-lg",children:[x.firstName," ",x.lastName]}),a.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400 font-bold mb-2 flex items-center gap-1",children:[a.jsx(Jo,{size:12})," ",((b=x.subRoles)==null?void 0:b[0])||"Technician"]})]}),x.rate>0&&a.jsxs("div",{className:"text-sm font-bold dark:text-gray-300 border border-gray-200 dark:border-gray-600 px-2 py-1 rounded-lg",children:["$",x.rate,"/hr"]})]}),a.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:(E=x.subRoles)==null?void 0:E.slice(0,3).map(_=>a.jsx("span",{className:"text-[10px] bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-200 px-2 py-0.5 rounded border border-orange-200 dark:border-orange-800",children:_},_))}),a.jsx("div",{className:"flex flex-wrap gap-1 mb-4 h-6 overflow-hidden",children:(((k=x.skills)==null?void 0:k.split(","))||[]).slice(0,3).map((_,S)=>a.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 pr-2 border-r border-gray-300 dark:border-gray-600 last:border-0",children:_.trim()},S))}),a.jsxs("div",{className:"flex gap-2 mt-auto",children:[a.jsx("button",{onClick:()=>n(x.id),className:"flex-1 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 py-2 rounded-lg text-xs font-bold transition",children:"Profile"}),a.jsxs("button",{onClick:()=>p(x),className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg text-xs font-bold transition shadow-sm flex items-center justify-center gap-1",children:[a.jsx(Km,{size:14})," Request"]})]})]})]},x.id)})}),m&&a.jsx(BEe,{user:t,userData:e,target:m,onClose:()=>p(null)})]})}function UEe({user:t,userData:e,onSuccess:n,onCancel:r}){const[s,i]=N.useState(ww[0].label),[o,l]=N.useState(""),[c,d]=N.useState("Normal"),[h,m]=N.useState(""),[p,v]=N.useState(""),[x,b]=N.useState(!1),[E,k]=N.useState(null),{uploadMedia:_,uploading:S}=gl(),T=async j=>{const R=j.target.files[0];if(!R)return;const I=await _(R,`service_requests/${t.uid}`);I&&k(I)},P=async()=>{if(!o||!p)return alert("Please complete the request.");b(!0);try{await hn(Re(Z,`artifacts/${Ge}/public/data/service_requests`),{topic:`${s} for ${o}`,category:s,equipment:o,urgency:c,budget:h?parseInt(h):null,description:p,userId:t.uid,userName:`${e.firstName} ${e.lastName}`,status:"Open",timestamp:zt(),attachment:E||null}),alert("Tech Request Broadcasted!"),n()}catch(j){console.error(j),alert("Failed.")}b(!1)};return a.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-8 rounded-2xl border border-orange-200 dark:border-gray-700 shadow-xl animate-in zoom-in-95",children:[a.jsxs("h2",{className:"text-2xl font-extrabold dark:text-white mb-6 flex items-center gap-2 text-orange-600",children:[a.jsx(Ys,{})," Broadcast Tech Need"]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"p-6 bg-orange-50 dark:bg-gray-800 rounded-xl border border-orange-100 dark:border-gray-700",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-lg font-medium text-gray-700 dark:text-gray-200",children:[a.jsx("span",{children:"I need"}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:s,onChange:j=>i(j.target.value),className:"appearance-none bg-white dark:bg-gray-700 border border-orange-300 dark:border-orange-700 rounded-lg py-1 pl-3 pr-8 font-bold text-orange-700 dark:text-white focus:outline-none",children:ww.map(j=>a.jsx("option",{value:j.label,children:j.label},j.id))}),a.jsx(of,{size:14,className:"absolute right-2 top-1/2 -translate-y-1/2 text-orange-500 dark:text-white pointer-events-none"})]}),a.jsx("span",{children:"for my"}),a.jsx("input",{className:"bg-transparent border-b-2 border-orange-300 dark:border-orange-700 text-center w-40 font-bold focus:outline-none focus:border-orange-500 dark:text-white",placeholder:"Equipment Name",value:o,onChange:j=>l(j.target.value)})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Urgency"}),a.jsxs("select",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:c,onChange:j=>d(j.target.value),children:[a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"High (Session Blocked)"}),a.jsx("option",{children:"Emergency (24h)"}),a.jsx("option",{children:"Flexible"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Est. Budget ($)"}),a.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Optional",value:h,onChange:j=>m(j.target.value)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Details"}),a.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Describe the issue, specific model, symptoms...",value:p,onChange:j=>v(j.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Visual Reference"}),!E&&!S&&a.jsxs("label",{className:"flex items-center justify-center gap-2 w-full p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition text-gray-500",children:[a.jsx(Qd,{size:20}),a.jsx("span",{className:"text-sm font-bold",children:"Upload Video or Image"}),a.jsx("input",{type:"file",className:"hidden",accept:"video/*,image/*",onChange:T})]}),E&&a.jsxs("div",{className:"relative w-full rounded-xl overflow-hidden border dark:border-gray-700 bg-black",children:[E.type==="video"?a.jsx("video",{src:E.url,controls:!0,className:"w-full h-48 object-contain"}):a.jsx("img",{src:E.url,className:"w-full h-48 object-contain"}),a.jsx("button",{onClick:()=>k(null),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsx(_t,{size:14})})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{onClick:r,className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition",children:"Cancel"}),a.jsx("button",{onClick:P,disabled:x||S,className:"flex-1 bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition flex items-center justify-center gap-2 disabled:opacity-50",children:x?a.jsx(rt,{className:"animate-spin"}):"Broadcast Now"})]})]})]})}function WEe({user:t,isTech:e}){const[n,r]=N.useState("feed"),[s,i]=N.useState([]),[o,l]=N.useState(!0);N.useEffect(()=>{const d=Et(Re(Z,Ve(t.uid).equipmentSubmissions),nn("status","==","pending"),Wn("timestamp","desc"),Qs(20)),h=pn(d,m=>{i(m.docs.map(p=>({id:p.id,...p.data()}))),l(!1)});return()=>h()},[t.uid]);const c=async(d,h,m)=>{var p,v,x,b,E,k;if(!e)return alert("Only verified Technicians can vote on gear accuracy.");try{const _=Se(Z,Ve(t.uid).equipmentSubmissions,d),S=`votes.${h}`;await Nt(_,{[S]:Ay(t.uid)});const T=3,P=3,j=(((v=(p=m.votes)==null?void 0:p.yes)==null?void 0:v.length)||0)+(h==="yes"?1:0),R=(((b=(x=m.votes)==null?void 0:x.fake)==null?void 0:b.length)||0)+(h==="fake"?1:0),I=(((k=(E=m.votes)==null?void 0:E.duplicate)==null?void 0:k.length)||0)+(h==="duplicate"?1:0);if(j>=T){const O=Se(Z,`artifacts/${Ge}/public/data/equipment_database/${m.category}/items`,m.model.replace(/\s+/g,"_"));await ec(O,{name:m.model,brand:m.brand,category:m.category,subCategory:m.subCategory,specs:m.specs,verifiedBy:Ay(t.uid),addedBy:m.submittedBy,addedAt:zt()}),await Nt(_,{status:"approved"}),await Nt(Se(Z,Ve(m.submittedBy).userWallet),{balance:ho(50)}),await Nt(Se(Z,Ve(t.uid).userWallet),{balance:ho(5)}),alert("Consensus reached! Item approved and rewards distributed.")}else(R>=P||I>=P)&&await Nt(_,{status:"rejected"})}catch(_){console.error("Voting failed:",_)}};return a.jsxs("div",{className:"animate-in fade-in",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Mye,{className:"text-orange-500"})," Gear Knowledge Base"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Crowdsourced equipment specs verified by pros."})]}),a.jsxs("div",{className:"flex gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[a.jsx("button",{onClick:()=>r("feed"),className:`px-4 py-2 rounded-md text-xs font-bold transition ${n==="feed"?"bg-white dark:bg-gray-600 shadow text-orange-600 dark:text-orange-400":"text-gray-500"}`,children:"The Bench (Queue)"}),a.jsx("button",{onClick:()=>r("submit"),className:`px-4 py-2 rounded-md text-xs font-bold transition ${n==="submit"?"bg-white dark:bg-gray-600 shadow text-orange-600 dark:text-orange-400":"text-gray-500"}`,children:"Submit New Gear"})]})]}),n==="feed"&&a.jsx("div",{className:"grid grid-cols-1 gap-4",children:o?a.jsx("div",{className:"p-10 text-center",children:a.jsx(rt,{className:"animate-spin mx-auto"})}):s.length===0?a.jsxs("div",{className:"text-center py-12 border-2 border-dashed dark:border-gray-700 rounded-xl",children:[a.jsx(es,{size:48,className:"mx-auto text-green-500 mb-2 opacity-50"}),a.jsx("p",{className:"text-gray-500",children:"The bench is clear. No pending submissions."})]}):s.map(d=>{var h,m,p,v,x,b,E,k,_,S,T,P,j;return a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row gap-6",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-[10px] font-bold uppercase bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-gray-500",children:d.brand}),a.jsx("span",{className:"text-[10px] font-bold uppercase bg-blue-50 dark:bg-blue-900/20 text-blue-600 px-2 py-0.5 rounded",children:(h=d.category)==null?void 0:h.replace(/_/g," ")})]}),a.jsx("h4",{className:"text-lg font-extrabold dark:text-white mb-2",children:d.model}),a.jsx("div",{className:"bg-gray-50 dark:bg-black/20 p-3 rounded-lg text-sm text-gray-600 dark:text-gray-300 mb-2 border dark:border-gray-700",children:d.specs}),a.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[a.jsx(Jr,{size:12})," Submitted by ",d.submitterName||"Unknown","  50 TK Reward Pending"]})]}),a.jsxs("div",{className:"w-full md:w-48 flex flex-col justify-center gap-2 border-l dark:border-gray-700 pl-0 md:pl-6",children:[a.jsxs("button",{onClick:()=>c(d.id,"yes",d),disabled:(p=(m=d.votes)==null?void 0:m.yes)==null?void 0:p.includes(t.uid),className:"w-full py-2 bg-green-100 dark:bg-green-900/20 hover:bg-green-200 text-green-700 dark:text-green-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[a.jsx(Xye,{size:14})," Yes (",((x=(v=d.votes)==null?void 0:v.yes)==null?void 0:x.length)||0,")"]}),a.jsxs("button",{onClick:()=>c(d.id,"fake",d),disabled:(E=(b=d.votes)==null?void 0:b.fake)==null?void 0:E.includes(t.uid),className:"w-full py-2 bg-red-100 dark:bg-red-900/20 hover:bg-red-200 text-red-700 dark:text-red-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[a.jsx(Yye,{size:14})," Fake (",((_=(k=d.votes)==null?void 0:k.fake)==null?void 0:_.length)||0,")"]}),a.jsxs("button",{onClick:()=>c(d.id,"duplicate",d),disabled:(T=(S=d.votes)==null?void 0:S.duplicate)==null?void 0:T.includes(t.uid),className:"w-full py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 text-gray-600 dark:text-gray-300 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition disabled:opacity-50",children:[a.jsx(uW,{size:14})," Dup (",((j=(P=d.votes)==null?void 0:P.duplicate)==null?void 0:j.length)||0,")"]})]})]},d.id)})}),n==="submit"&&a.jsx(HEe,{user:t,userData,onSuccess:()=>r("feed")})]})}function HEe({user:t,userData:e,onSuccess:n}){const[r,s]=N.useState({brand:"",model:"",category:d0[0].id,subCategory:"",specs:""}),[i,o]=N.useState(!1),l=async()=>{if(!r.brand||!r.model||!r.specs)return alert("All fields required.");o(!0);try{await hn(Re(Z,Ve(t.uid).equipmentSubmissions),{...r,submittedBy:t.uid,submitterName:`${e.firstName} ${e.lastName}`,status:"pending",timestamp:zt(),votes:{yes:[],fake:[],duplicate:[]}}),alert("Submission Received! You'll earn 50 TK once verified."),n()}catch(c){console.error(c),alert("Submission failed.")}o(!1)};return a.jsxs("div",{className:"max-w-xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border border-orange-200 dark:border-gray-700 shadow-lg",children:[a.jsx("h4",{className:"font-bold text-lg dark:text-white mb-4",children:"Submit New Equipment"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Category"}),a.jsx("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:r.category,onChange:c=>s({...r,category:c.target.value}),children:d0.map(c=>a.jsx("option",{value:c.id,children:c.label},c.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Sub-Category"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. Compressor",value:r.subCategory,onChange:c=>s({...r,subCategory:c.target.value})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Brand"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. Neve",value:r.brand,onChange:c=>s({...r,brand:c.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Model"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",placeholder:"e.g. 1073LB",value:r.model,onChange:c=>s({...r,model:c.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Specs / Description"}),a.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm h-24",placeholder:"Brief technical specs...",value:r.specs,onChange:c=>s({...r,specs:c.target.value})})]}),a.jsx("button",{onClick:l,disabled:i,className:"w-full bg-orange-600 text-white py-2.5 rounded-lg font-bold hover:bg-orange-700 flex items-center justify-center gap-2",children:i?a.jsx(rt,{className:"animate-spin"}):"Submit for Verification"})]})]})}function qEe({user:t}){const[e,n]=N.useState({skills:"",rate:"",serviceRadius:"",subRoles:[]}),[r,s]=N.useState(!0);N.useEffect(()=>{uo(Se(Z,Ve(t.uid).userSubProfile("Technician"))).then(o=>{o.exists()&&n(o.data()),s(!1)})},[t.uid]);const i=async()=>{try{await Nt(Se(Z,Ve(t.uid).userSubProfile("Technician")),e);const o=[...e.skills?e.skills.toLowerCase().split(",").map(l=>l.trim()):[],...e.subRoles?e.subRoles.map(l=>l.toLowerCase()):[]];await Nt(Se(Z,Ve(t.uid).userPublicProfile),{rate:parseInt(e.rate)||0,subRoles:e.subRoles||[],searchTerms:o}),alert("Tech Profile Updated Successfully")}catch{alert("Update failed")}};return r?a.jsx("div",{className:"p-10 text-center",children:a.jsx(rt,{className:"animate-spin mx-auto"})}):a.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm animate-in fade-in",children:[a.jsx("h3",{className:"font-bold text-lg dark:text-white mb-6 border-b dark:border-gray-700 pb-2",children:"Your Technician Settings"}),a.jsxs("div",{className:"space-y-5",children:[a.jsx(BR,{label:"Primary Specialties",fieldKey:"subRoles",options:vq,initialValues:e.subRoles,onChange:(o,l)=>n(c=>({...c,[o]:l}))}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Detailed Skills (Comma Separated)"}),a.jsx("input",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:e.skills||"",onChange:o=>n({...e,skills:o.target.value}),placeholder:"e.g. SSL 4000 Maintenance, Tube Bias..."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Hourly Rate ($)"}),a.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:e.rate||"",onChange:o=>n({...e,rate:o.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Service Radius (Miles)"}),a.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:e.serviceRadius||"",onChange:o=>n({...e,serviceRadius:o.target.value})})]})]}),a.jsx("div",{className:"pt-4",children:a.jsxs("button",{onClick:i,className:"w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 flex items-center justify-center gap-2",children:[a.jsx(Gd,{size:18})," Save Changes"]})})]})]})}function GEe({user:t,userData:e,openPublicProfile:n}){var o;const[r,s]=N.useState("board"),i=(o=e==null?void 0:e.accountTypes)==null?void 0:o.includes("Technician");return a.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 pb-20",children:[a.jsxs("div",{className:"bg-gradient-to-r from-orange-900 to-slate-900 p-8 rounded-2xl text-white shadow-xl relative overflow-hidden flex flex-col md:flex-row justify-between items-end",children:[a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex items-center gap-2 text-orange-400 font-bold uppercase tracking-widest text-xs mb-2",children:[a.jsx(Km,{size:14})," SeshNx Technical"]}),a.jsx("h1",{className:"text-3xl font-extrabold mb-2",children:"Studio Tech Services"}),a.jsx("p",{className:"text-slate-300 max-w-lg",children:"Hire professionals for equipment repair, studio wiring, and acoustic calibration."})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 relative z-10 mt-4 md:mt-0",children:[a.jsx("button",{onClick:()=>s("board"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="board"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Job Board"}),a.jsx("button",{onClick:()=>s("directory"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="directory"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Find a Tech"}),a.jsx("button",{onClick:()=>s("broadcast"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="broadcast"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Post Request"}),a.jsx("button",{onClick:()=>s("database"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="database"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Gear DB"}),i&&a.jsx("button",{onClick:()=>s("profile"),className:`px-4 py-2 rounded-lg font-bold text-sm transition ${r==="profile"?"bg-orange-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:"Tech Portal"})]}),a.jsx(Kd,{size:200,className:"absolute -right-10 -top-10 text-white opacity-5 rotate-12 pointer-events-none"})]}),a.jsxs("div",{className:"min-h-[400px]",children:[r==="board"&&a.jsx($Ee,{user:t}),r==="directory"&&a.jsx(zEe,{user:t,userData:e,openPublicProfile:n}),r==="broadcast"&&a.jsx(UEe,{user:t,userData:e,onSuccess:()=>s("board"),onCancel:()=>s("board")}),r==="database"&&a.jsx(WEe,{user:t,isTech:i}),r==="profile"&&i&&a.jsx(qEe,{user:t})]})]})}const KEe=()=>{const[t,e]=N.useState({tierData:null,tokenPackages:null}),[n,r]=N.useState(!0),{DEFAULT_TIER_DATA:s,FALLBACK_TOKEN_PACKAGES:i}=N.useMemo(()=>({DEFAULT_TIER_DATA:{FREE:{name:"Free",price:0,feeMultiplier:1.2,features:["1 Broadcast Request / month","Cannot list on SeshFx Market"],limits:{broadcastsPerMonth:1,sessionsPerWeek:2,canListMarket:!1,monthlyTokens:0}},BASIC:{name:"Basic",price:4.99,feeMultiplier:1.1,features:["3 Broadcast Requests / month","10 Booked Sessions / week","Can list on SeshFx Market (5 items)"],limits:{broadcastsPerMonth:3,sessionsPerWeek:10,canListMarket:!0,monthlyTokens:25}},PRO:{name:"Pro Creative",price:14.99,feeMultiplier:1.02,features:["15 Broadcast Requests / month","Unlimited Booked Sessions","Profile Search Boost"],limits:{broadcastsPerMonth:15,sessionsPerWeek:999,canListMarket:!0,monthlyTokens:100}},STUDIO:{name:"Studio Business",price:29.99,feeMultiplier:1,features:["Studio Manager Component Access","Unlimited Broadcast Requests","0% Session Fees"],limits:{broadcastsPerMonth:999,sessionsPerWeek:999,canListMarket:!0,monthlyTokens:100}}},FALLBACK_TOKEN_PACKAGES:[{id:"pack_small",tokens:100,price:4.99,label:"Starter Stash"},{id:"pack_medium",tokens:550,price:19.99,label:"Producer Pack",highlight:!0},{id:"pack_large",tokens:1200,price:39.99,label:"Studio Vault"}]}),[]);N.useEffect(()=>{const l=Se(Z,"artifacts",Ge,"public","config","subscriptions","tier_config"),c=pn(l,m=>{let p=m.exists()?m.data():{};const v=Object.keys(s).reduce((x,b)=>(x[b]={...s[b],...p[b]},x),{});e(x=>({...x,tierData:v}))}),d=Se(Z,"artifacts",Ge,"public","config","subscriptions","token_packages"),h=pn(d,m=>{let p=m.exists()?Object.values(m.data()):i;(!Array.isArray(p)||p.length===0)&&(p=i),e(v=>({...v,tokenPackages:p}))});return r(!1),()=>{c(),h()}},[s,i]);const o=l=>{var d,h;const c=((d=t.tierData)==null?void 0:d[l])||((h=t.tierData)==null?void 0:h.FREE);return c?c.feeMultiplier:s.FREE.feeMultiplier};return{tierData:t.tierData||s,tokenPackages:t.tokenPackages||i,loading:n,getFeeMultiplier:o}};var uG="https://js.stripe.com/v3",QEe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var ZEe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(uG,'"]')),n=0;n<e.length;n++){var r=e[n];if(QEe.test(r.src))return r}return null},zV=function(e){var n="",r=document.createElement("script");r.src="".concat(uG).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},Xp=null,Uv=null,Wv=null,YEe=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},XEe=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},JEe=function(e){return Xp!==null?Xp:(Xp=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var s=ZEe();if(!(s&&e)){if(!s)s=zV(e);else if(s&&Wv!==null&&Uv!==null){var i;s.removeEventListener("load",Wv),s.removeEventListener("error",Uv),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=zV(e)}}Wv=XEe(n,r),Uv=YEe(r),s.addEventListener("load",Wv),s.addEventListener("error",Uv)}catch(o){r(o);return}}),Xp.catch(function(n){return Xp=null,Promise.reject(n)}))},Jp,eSe=function(){return Jp||(Jp=JEe(null).catch(function(e){return Jp=null,Promise.reject(e)}),Jp)};Promise.resolve().then(function(){return eSe()}).catch(function(t){console.warn(t)});const tSe=D1(Fc),nSe=async t=>{if(t<=0)throw new Error("No funds available to cash out.");try{const e=V1(tSe,"initiatePayout"),{data:n}=await e({amount:t});return n}catch(e){throw console.error("Payout failed:",e),e.message.includes("not found")?new Error("Payout system is currently in maintenance mode. Please try again later."):e}};function rSe({user:t,userData:e}){var S;const[n,r]=N.useState("store"),[s,i]=N.useState({balance:0,escrowBalance:0,payoutBalance:0}),[o,l]=N.useState(!1),{tierData:c,tokenPackages:d,loading:h}=KEe(),m=(e==null?void 0:e.currentTier)||ske.FREE,p=(S=e==null?void 0:e.accountTypes)==null?void 0:S.some(T=>["Artist","Musician","Producer","Engineer","Studio","Composer","Technician","Label","Agent"].includes(T));N.useEffect(()=>{if(!(t!=null&&t.uid))return;const T=pn(Se(Z,Ve(t.uid).userWallet),P=>{if(P.exists()){const j=P.data();i({balance:j.balance||0,escrowBalance:j.escrowBalance||0,payoutBalance:j.payoutBalance||0})}});return()=>T()},[t.uid]);const v=async(T,P="payment")=>{l(!0);try{const j=await mye(Eye,{price:T,mode:P,success_url:window.location.href,cancel_url:window.location.href});window.location.assign(j.url)}catch(j){console.error("Checkout Error:",j),alert(`Checkout failed: ${j.message}`)}finally{l(!1)}},x=T=>{if(!T.stripePriceId)return alert("Configuration Error: This package is missing a Stripe Price ID.");v(T.stripePriceId,"payment")},b=T=>{if(!T.stripePriceId)return alert("Configuration Error: This plan is missing a Stripe Price ID.");v(T.stripePriceId,"subscription")},E=async()=>{if(p){if(s.payoutBalance<=0)return alert("No funds available for cash out.");if(window.confirm(`Cash out $${s.payoutBalance.toFixed(2)} to your connected account?`)){l(!0);try{await nSe(s.payoutBalance),alert("Cash out initiated! Funds should arrive in your bank account shortly.")}catch(T){alert(T.message)}finally{l(!1)}}}},k=Object.values(c).sort((T,P)=>T.id===m?-1:P.id===m?1:T.price-P.price),_=T=>{const P=(T-1)*100;return P>0?`+${P.toFixed(0)}% Service Fee`:P===0?"0% Service Fee":`-${Math.abs(P).toFixed(0)}% Fee (Discount)`};return a.jsxs("div",{className:"max-w-6xl mx-auto p-4 pb-24",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-3xl font-extrabold dark:text-white flex items-center gap-2",children:[a.jsx(ui,{size:32,className:"text-green-500"})," My Wallet"]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage tokens, subscriptions, and earnings."})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] px-5 py-3 rounded-2xl border dark:border-gray-700 shadow-sm flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-full",children:a.jsx(Ys,{fill:"currentColor",className:"text-yellow-500",size:20})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wide",children:"Spending Tokens"}),a.jsxs("div",{className:"font-mono font-extrabold text-xl dark:text-white leading-none",children:[s.balance.toLocaleString()," TK"]})]})]}),p&&a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] px-5 py-3 rounded-2xl border dark:border-gray-700 shadow-sm flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-500/10 rounded-full",children:a.jsx(ui,{className:"text-green-500",size:20})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wide",children:"Available USD"}),a.jsxs("div",{className:"font-mono font-extrabold text-xl dark:text-white leading-none",children:["$",s.payoutBalance.toFixed(2)]})]})]})]})]}),a.jsxs("div",{className:"flex gap-4 border-b dark:border-gray-700 mb-8 overflow-x-auto",children:[a.jsx("button",{onClick:()=>r("store"),className:`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${n==="store"?"border-brand-blue text-brand-blue":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Token Store"}),a.jsx("button",{onClick:()=>r("plans"),className:`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${n==="plans"?"border-brand-blue text-brand-blue":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Membership Plans"}),p&&a.jsx("button",{onClick:()=>r("earnings"),className:`pb-3 px-4 text-sm font-bold border-b-2 transition whitespace-nowrap ${n==="earnings"?"border-brand-blue text-brand-blue":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Earnings & Escrow"})]}),n==="store"&&a.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[a.jsxs("div",{className:"bg-gradient-to-r from-brand-blue to-purple-600 rounded-2xl p-8 text-white shadow-lg relative overflow-hidden",children:[a.jsxs("div",{className:"relative z-10 max-w-lg",children:[a.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Power Up Your Creativity"}),a.jsx("p",{className:"opacity-90 mb-6",children:"Use tokens to buy beats, presets, booking requests, and more on the SeshFx Marketplace."})]}),a.jsx(Ys,{size:200,className:"absolute -right-10 -bottom-20 text-white opacity-10 rotate-12 pointer-events-none"})]}),h?a.jsx("div",{className:"text-center py-20",children:a.jsx(rt,{className:"animate-spin text-brand-blue mx-auto",size:32})}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(T=>a.jsxs("div",{className:`relative bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border transition-all duration-200 hover:-translate-y-1 hover:shadow-xl ${T.highlight?"border-yellow-500 ring-2 ring-yellow-500/20":"dark:border-gray-700"}`,children:[T.highlight&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-yellow-500 text-black text-[10px] font-extrabold px-3 py-1 rounded-full tracking-wide shadow-sm",children:"BEST VALUE"}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs font-bold uppercase tracking-widest mb-2",children:T.label}),a.jsxs("div",{className:"text-5xl font-extrabold dark:text-white flex items-center justify-center gap-1",children:[T.tokens,a.jsx("span",{className:"text-lg font-medium text-gray-400",children:"TK"})]})]}),a.jsx("button",{onClick:()=>x(T),disabled:o,className:`w-full py-3 rounded-xl font-bold flex justify-center items-center gap-2 transition-all ${T.highlight?"bg-yellow-500 text-black hover:bg-yellow-400":"bg-gray-900 dark:bg-white text-white dark:text-black hover:opacity-90"}`,children:o?a.jsx(rt,{className:"animate-spin",size:18}):`Buy for $${T.price}`})]},T.id))})]}),n==="plans"&&a.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[a.jsxs("div",{className:"text-center max-w-2xl mx-auto mb-8",children:[a.jsx("h3",{className:"text-2xl font-bold dark:text-white mb-2",children:"Upgrade Your Workflow"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Unlock lower fees, unlimited bookings, and premium visibility."})]}),h?a.jsx("div",{className:"text-center py-10",children:a.jsx(rt,{className:"animate-spin text-brand-blue mx-auto",size:24})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:k.map(T=>{const P=T.id===m;return a.jsxs("div",{className:`bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border flex flex-col ${P?"border-brand-blue ring-1 ring-brand-blue":"dark:border-gray-700"} shadow-sm`,children:[P&&a.jsxs("div",{className:"text-xs font-bold text-brand-blue uppercase tracking-wide mb-2 flex items-center gap-1",children:[a.jsx(nR,{size:12,fill:"currentColor"})," Current Plan"]}),a.jsx("h3",{className:"text-xl font-bold dark:text-white mb-1",children:T.name}),a.jsxs("div",{className:"text-3xl font-extrabold mb-6 dark:text-white",children:["$",T.price,a.jsx("span",{className:"text-sm font-normal text-gray-500",children:"/mo"})]}),a.jsxs("div",{className:"space-y-3 mb-8 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-gray-700 dark:text-gray-200",children:[a.jsx(ui,{size:16,className:T.feeMultiplier<=1?"text-green-500":"text-gray-400"}),_(T.feeMultiplier)]}),T.features.map((j,R)=>a.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-600 dark:text-gray-400",children:[a.jsx(Bi,{size:14,className:"text-green-500 shrink-0 mt-0.5"}),a.jsx("span",{children:j})]},R))]}),a.jsx("button",{onClick:()=>b(T),className:`w-full py-2.5 rounded-lg font-bold text-sm transition-colors mt-auto ${P?"bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-default":"bg-brand-blue text-white hover:bg-blue-600 shadow-lg shadow-blue-500/20"}`,disabled:P||o,children:P?"Active":o?a.jsx(rt,{className:"animate-spin mx-auto"}):"Upgrade"})]},T.id)})})]}),n==="earnings"&&p&&a.jsx("div",{className:"space-y-6 animate-in fade-in duration-300",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm relative overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-lg",children:a.jsx(tu,{size:24})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold dark:text-white",children:"Escrow Balance"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Funds held for active sessions"})]})]}),a.jsxs("div",{className:"text-4xl font-extrabold dark:text-white mb-4",children:["$",s.escrowBalance.toLocaleString(void 0,{minimumFractionDigits:2})]}),a.jsxs("div",{className:"text-xs bg-orange-50 dark:bg-orange-900/10 text-orange-700 dark:text-orange-300 p-3 rounded-lg flex items-start gap-2",children:[a.jsx(pl,{size:14,className:"mt-0.5 shrink-0"}),' Funds are released to "Available" 24 hours after a session is successfully completed.']})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border border-green-500/30 shadow-lg relative overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-lg",children:a.jsx(ui,{size:24})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold dark:text-white",children:"Available for Payout"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Cleared funds ready to transfer"})]})]}),a.jsxs("div",{className:"text-4xl font-extrabold text-green-600 dark:text-green-400 mb-6",children:["$",s.payoutBalance.toLocaleString(void 0,{minimumFractionDigits:2})]}),a.jsx("button",{onClick:E,disabled:o||s.payoutBalance<=0,className:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold shadow-lg hover:shadow-green-500/30 transition-all flex justify-center items-center gap-2 disabled:opacity-50 disabled:shadow-none",children:o?a.jsx(rt,{className:"animate-spin",size:20}):a.jsxs(a.Fragment,{children:["Cash Out Now ",a.jsx(Sb,{size:20})]})}),a.jsx("div",{className:"text-[10px] text-center text-gray-400 mt-3",children:"Transfers handled securely via Stripe Connect."})]})]})})]})}function sSe({user:t}){const[e,n]=N.useState([]),[r,s]=N.useState(""),[i,o]=N.useState([]),[l,c]=N.useState(!1),[d,h]=N.useState("list");N.useEffect(()=>{if(!(t!=null&&t.uid))return;const x=Re(Z,Ve(t.uid).labelRoster(t.uid)),b=pn(x,E=>{n(E.docs.map(k=>({id:k.id,...k.data()})))});return()=>b()},[t==null?void 0:t.uid]);const m=async()=>{if(!(r.length<3)){c(!0);try{const x=Et(gd(Z,"public_profile"),nn("searchTerms","array-contains",r.toLowerCase())),E=(await Kt(x)).docs.map(k=>({id:k.ref.parent.parent.id,...k.data()})).filter(k=>k.id!==t.uid&&!e.some(_=>_.artistId===k.id));o(E)}catch(x){console.error("Search failed:",x)}c(!1)}},p=async x=>{try{await hn(Re(Z,Ve(t.uid).labelRoster(t.uid)),{artistId:x.id,name:`${x.firstName} ${x.lastName}`,email:x.email||"N/A",photoURL:x.photoURL||null,signedAt:zt(),status:"Active"}),alert(`Signed ${x.firstName} to roster!`),s(""),o([]),h("list")}catch(b){console.error("Signing failed:",b),alert("Failed to add artist.")}},v=async(x,b)=>{if(confirm(`Release ${b} from your roster?`))try{await _o(Se(Z,Ve(t.uid).labelRoster(t.uid),x))}catch(E){console.error(E)}};return a.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 animate-in fade-in pb-20",children:[a.jsxs("div",{className:"flex justify-between items-center bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(na,{className:"text-purple-600"})," Label Management"]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your artist roster and bookings."})]}),a.jsx("button",{onClick:()=>h(d==="list"?"search":"list"),className:"bg-purple-600 text-white px-5 py-2.5 rounded-xl font-bold hover:bg-purple-700 transition flex items-center gap-2",children:d==="list"?a.jsxs(a.Fragment,{children:[a.jsx(nu,{size:18})," Sign Artist"]}):"Back to Roster"})]}),d==="search"&&a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm animate-in slide-in-from-top-4",children:[a.jsx("h3",{className:"font-bold dark:text-white mb-4",children:"Find Talent"}),a.jsxs("div",{className:"flex gap-2 mb-6",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Ur,{className:"absolute left-3 top-3 text-gray-400",size:18}),a.jsx("input",{className:"w-full pl-10 p-3 border rounded-xl dark:bg-[#1f2128] dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"Search by name...",value:r,onChange:x=>s(x.target.value),onKeyDown:x=>x.key==="Enter"&&m()})]}),a.jsx("button",{onClick:m,disabled:l,className:"bg-gray-900 dark:bg-white dark:text-black text-white px-6 rounded-xl font-bold",children:l?"...":"Search"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.map(x=>{var b;return a.jsxs("div",{className:"p-4 border dark:border-gray-700 rounded-xl flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden",children:x.photoURL?a.jsx("img",{src:x.photoURL,className:"h-full w-full object-cover"}):a.jsx(Jr,{className:"m-2 text-gray-400"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-bold dark:text-white text-sm",children:[x.firstName," ",x.lastName]}),a.jsx("div",{className:"text-xs text-gray-500",children:((b=x.accountTypes)==null?void 0:b[0])||"User"})]})]}),a.jsx("button",{onClick:()=>p(x),className:"text-xs bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-3 py-1.5 rounded-lg font-bold hover:bg-purple-200",children:"Sign"})]},x.id)}),i.length===0&&r&&!l&&a.jsx("div",{className:"col-span-full text-center text-gray-500 text-sm",children:"No artists found."})]})]}),d==="list"&&a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-2xl border dark:border-gray-700 overflow-hidden",children:[a.jsx("div",{className:"p-4 bg-gray-50 dark:bg-[#23262f] border-b dark:border-gray-700 flex justify-between items-center",children:a.jsxs("span",{className:"font-bold text-sm text-gray-500 uppercase tracking-wide",children:["Current Roster (",e.length,")"]})}),e.length===0?a.jsxs("div",{className:"p-12 text-center text-gray-500",children:[a.jsx(Rs,{size:48,className:"mx-auto mb-3 opacity-20"}),a.jsx("p",{children:"No artists signed yet."})]}):a.jsx("div",{className:"divide-y dark:divide-gray-700",children:e.map(x=>{var b;return a.jsxs("div",{className:"p-5 hover:bg-gray-50 dark:hover:bg-white/5 transition flex items-center justify-between group",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center text-indigo-600 font-bold text-lg overflow-hidden",children:x.photoURL?a.jsx("img",{src:x.photoURL,className:"h-full w-full object-cover"}):x.name[0]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold dark:text-white text-lg",children:x.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Signed: ",(b=x.signedAt)!=null&&b.toDate?x.signedAt.toDate().toLocaleDateString():"Recent"]})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 px-2 py-1 rounded text-xs font-bold",children:x.status}),a.jsx("button",{onClick:()=>v(x.id,x.name),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",title:"Release Artist",children:a.jsx(bs,{size:18})})]})]},x.id)})})]})]})}function iSe({user:t,userData:e}){const{schoolData:n,studentProfile:r}=vx(),[s,i]=N.useState(""),[o,l]=N.useState([]),[c,d]=N.useState(!1),h=(e==null?void 0:e.internshipCities)||[],m=async()=>{const b=s.trim();if(b&&h.length<3)try{await Nt(Se(Z,"users",t.uid),{internshipCities:Ay(b)}),i("")}catch(E){console.error("Error adding interest:",E)}},p=async b=>{try{await Nt(Se(Z,"users",t.uid),{internshipCities:Dre(b)})}catch(E){console.error("Error removing interest:",E)}};N.useEffect(()=>{e!=null&&e.programComplete&&v()},[e==null?void 0:e.programComplete,h]);const v=async()=>{d(!0);try{const b=Et(Re(Z,"studios"),nn("allowInternship","==",!0));let k=(await Kt(b)).docs.map(_=>({id:_.id,..._.data()}));h.length>0&&(k=k.filter(_=>h.some(S=>{var T,P;return((T=_.city)==null?void 0:T.toLowerCase().includes(S.toLowerCase()))||((P=_.zipCode)==null?void 0:P.includes(S))}))),l(k)}catch(b){console.error("Error fetching studios:",b)}finally{d(!1)}},x=((r==null?void 0:r.hoursLogged)||0)/((n==null?void 0:n.requiredHours)||100);return a.jsxs("div",{className:"max-w-5xl mx-auto space-y-8 pb-20",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6",children:[a.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-2",children:n!=null&&n.logoURL?a.jsx("img",{src:n.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):a.jsx(Bc,{size:32,className:"text-gray-400"})}),a.jsxs("div",{className:"flex-1 text-center md:text-left",children:[a.jsx("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight mb-1",children:(n==null?void 0:n.name)||"Student Dashboard"}),a.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:[a.jsx("span",{className:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Student Portal"}),a.jsx("span",{children:""}),a.jsxs("span",{children:["ID: ",(e==null?void 0:e.studentId)||"N/A"]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Cohort: ",(r==null?void 0:r.cohort)||"General"]})]})]}),a.jsxs("div",{className:"w-full md:w-64 bg-gray-50 dark:bg-black/20 p-4 rounded-xl border dark:border-gray-700",children:[a.jsxs("div",{className:"flex justify-between text-sm font-bold mb-2",children:[a.jsx("span",{className:"dark:text-gray-300",children:"Progress"}),a.jsxs("span",{className:"text-indigo-600",children:[Math.round(x*100),"%"]})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-2",children:a.jsx("div",{className:"h-full bg-indigo-600",style:{width:`${Math.min(100,x*100)}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 text-right",children:[(r==null?void 0:r.hoursLogged)||0," / ",(n==null?void 0:n.requiredHours)||100," Hours"]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm space-y-6",children:[a.jsxs("h2",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Br,{size:20,className:"text-indigo-500"})," Internship Locations"]}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Add up to 3 target locations (City, Zip, or County) to find matched studios."}),a.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(b=>a.jsxs("span",{className:"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-800 dark:text-indigo-300 text-sm font-medium px-3 py-1 rounded-full flex items-center gap-1",children:[b,a.jsx("button",{onClick:()=>p(b),className:"ml-1 hover:text-indigo-800",children:""})]},b))}),h.length<3&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",placeholder:"Enter City or Zip Code",value:s,onChange:b=>i(b.target.value),onKeyDown:b=>b.key==="Enter"&&m(),className:"flex-1 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none"}),a.jsx("button",{onClick:m,disabled:!s.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg font-bold disabled:opacity-50",children:"Add"})]})]}),(e==null?void 0:e.programComplete)&&a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm space-y-4",children:[a.jsxs("h2",{className:"text-xl font-bold dark:text-white flex items-center gap-2",children:[a.jsx(Ur,{size:20,className:"text-indigo-500"})," Available Studios"]}),c?a.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[a.jsx(Ms,{className:"animate-spin",size:16})," Searching..."]}):o.length>0?a.jsx("div",{className:"space-y-3",children:o.map(b=>a.jsxs("div",{className:"p-4 border rounded-lg dark:border-gray-700 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold dark:text-white text-lg",children:b.name}),a.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[a.jsx(Br,{size:12})," ",b.city,", ",b.state]})]}),a.jsx("button",{className:"text-indigo-600 font-bold text-sm hover:underline",children:"View Details"})]},b.id))}):a.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[a.jsx(es,{size:16})," No studios found matching your criteria yet."]})]})]})}const XR=(t,e="export")=>{if(!t||!t.length){console.warn("No data to export.");return}const n=new Set;t.forEach(c=>Object.keys(c).forEach(d=>n.add(d)));const r=Array.from(n),s=[];s.push(r.join(",")),t.forEach(c=>{const d=r.map(h=>{const m=c[h];return m&&typeof m=="object"?m.toMillis?`"${new Date(m.toMillis()).toLocaleString()}"`:`"${JSON.stringify(m).replace(/"/g,'""')}"`:`"${(""+(m??"")).replace(/"/g,'""')}"`});s.push(d.join(","))});const i=new Blob([s.join(`
`)],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(i),l=document.createElement("a");l.href=o,l.setAttribute("download",`${e}_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)};function oSe({schoolId:t,schoolData:e}){const[n,r]=N.useState({students:0,interns:0,pending:0}),[s,i]=N.useState([]),[o,l]=N.useState(!0);return N.useEffect(()=>{t&&(async()=>{l(!0);try{const d=await sj(Re(Z,`schools/${t}/students`)),m=(await Kt(Re(Z,`schools/${t}/students`))).docs.filter(b=>b.data().internshipStudioId).length,v=(await Kt(Re(Z,`schools/${t}/internship_logs`))).docs.filter(b=>b.data().status==="pending_approval").length;r({students:d.data().count,interns:m,pending:v});const x=await Kt(Et(Re(Z,`schools/${t}/audit_logs`),Wn("timestamp","desc"),Qs(5)));i(x.docs.map(b=>({id:b.id,...b.data()})))}catch(d){console.error("Overview load failed:",d)}l(!1)})()},[t]),o?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Overview..."}):a.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-2",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(Wa,{title:"Total Students",value:n.students,icon:a.jsx(Rs,{className:"text-white"}),bg:"bg-gradient-to-br from-indigo-500 to-blue-600",text:"text-white"}),a.jsx(Wa,{title:"Active Internships",value:n.interns,icon:a.jsx(Jo,{className:"text-white"}),bg:"bg-gradient-to-br from-purple-500 to-pink-600",text:"text-white"}),a.jsx(Wa,{title:"Pending Approvals",value:n.pending,icon:a.jsx(Ms,{className:"text-white"}),bg:"bg-gradient-to-br from-yellow-500 to-orange-600",text:"text-white"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-4 bg-gray-50 dark:bg-gray-800/50",children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(KA,{size:18,className:"text-gray-400"})," Recent Activity"]}),a.jsx("div",{className:"space-y-3",children:s.length===0?a.jsx("p",{className:"text-sm text-gray-500 italic",children:"No recent activity recorded."}):s.map(c=>{var d;return a.jsxs("div",{className:"text-xs border-b dark:border-gray-700 pb-2 last:border-0",children:[a.jsxs("div",{className:"flex justify-between font-bold dark:text-gray-200",children:[a.jsx("span",{children:c.action}),a.jsx("span",{className:"text-gray-500 font-normal",children:(d=c.timestamp)!=null&&d.toDate?c.timestamp.toDate().toLocaleTimeString():""})]}),a.jsxs("div",{className:"text-gray-500 mt-0.5",children:[c.details," ",a.jsxs("span",{className:"opacity-70",children:[" ",c.adminName]})]})]},c.id)})})]}),a.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-6 flex flex-col items-center justify-center text-center bg-white dark:bg-black/20 shadow-sm",children:[a.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center shadow-lg mb-4 overflow-hidden border-4 border-white dark:border-gray-700",children:e!=null&&e.logoURL?a.jsx("img",{src:e.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):a.jsx(Bc,{size:40,className:"text-indigo-500"})}),a.jsx("h2",{className:"text-2xl font-extrabold dark:text-white mb-1",children:(e==null?void 0:e.name)||"School Name"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:(e==null?void 0:e.address)||"No Address Set"}),(e==null?void 0:e.website)&&a.jsxs("a",{href:e.website,target:"_blank",rel:"noreferrer",className:"text-xs font-bold text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1.5 rounded-full hover:bg-indigo-100 transition flex items-center gap-1",children:[a.jsx(dx,{size:12})," Visit Website"]})]})]})]})}function aSe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState([]),[o,l]=N.useState(!0),[c,d]=N.useState(""),[h,m]=N.useState(!1),[p,v]=N.useState(!1),[x,b]=N.useState(null),[E,k]=N.useState(!1),[_,S]=N.useState({firstName:"",lastName:"",email:"",studentId:"",cohort:"",status:"Enrolled"}),[T,P]=N.useState("");N.useEffect(()=>{(async()=>{l(!0);try{const $=await Kt(Re(Z,`schools/${t}/students`));r($.docs.map(ue=>({id:ue.id,...ue.data()})));const J=await Kt(Re(Z,`schools/${t}/partners`));i(J.docs.map(ue=>({id:ue.id,...ue.data()})))}catch($){console.error("Roster load failed:",$)}l(!1)})()},[t]);const j=()=>{S({firstName:"",lastName:"",email:"",studentId:"",cohort:"",status:"Enrolled"}),k(!1),b(null),m(!0)},R=V=>{var $,J;S({firstName:(($=V.displayName)==null?void 0:$.split(" ")[0])||"",lastName:((J=V.displayName)==null?void 0:J.split(" ").slice(1).join(" "))||"",email:V.email||"",studentId:V.studentId||"",cohort:V.cohort||"",status:V.status||"Enrolled"}),k(!0),b(V),m(!0)},I=async()=>{const V=`${_.firstName} ${_.lastName}`.trim();if(!V||!_.email)return alert("Name and Email required.");try{if(E&&x)await Nt(Se(Z,`schools/${t}/students/${x.id}`),{..._,displayName:V}),r($=>$.map(J=>J.id===x.id?{...J,..._,displayName:V}:J)),await e("Edit Student",`Updated ${V}`);else{const $=await hn(Re(Z,`schools/${t}/students`),{..._,displayName:V,hoursLogged:0,createdAt:zt()});r(J=>[...J,{id:$.id,..._,displayName:V,hoursLogged:0}]),await e("Add Student",`Added ${V}`)}m(!1)}catch($){console.error("Save student failed:",$),alert("Failed to save student.")}},O=async(V,$)=>{if(confirm(`Remove ${$} from the roster? This does not delete their user account.`))try{await _o(Se(Z,`schools/${t}/students/${V}`)),r(J=>J.filter(ue=>ue.id!==V)),await e("Remove Student",`Removed ${$}`)}catch(J){console.error("Delete failed:",J)}},D=async()=>{if(!(!x||!T))try{await Nt(Se(Z,`schools/${t}/students/${x.id}`),{internshipStudioId:T}),r(V=>V.map($=>$.id===x.id?{...$,internshipStudioId:T}:$)),v(!1),P(""),alert(`Assigned ${x.displayName} to studio.`),await e("Assign Internship",`Assigned ${x.displayName}`)}catch(V){console.error("Assignment failed:",V)}},F=n.filter(V=>{var $,J;return(($=V.displayName)==null?void 0:$.toLowerCase().includes(c.toLowerCase()))||((J=V.studentId)==null?void 0:J.includes(c))});return o?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roster..."}):a.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-between",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(Ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-9 p-2 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Search by Name or ID...",value:c,onChange:V=>d(V.target.value)})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>XR(n,"student_roster"),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-bold text-xs",children:"Export CSV"}),a.jsxs("button",{onClick:j,className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-indigo-700",children:[a.jsx(nu,{size:16})," Add Student"]})]})]}),a.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3",children:"Name"}),a.jsx("th",{className:"p-3",children:"ID"}),a.jsx("th",{className:"p-3",children:"Cohort"}),a.jsx("th",{className:"p-3",children:"Internship"}),a.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:F.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"5",className:"p-6 text-center text-gray-500",children:"No students found."})}):F.map(V=>a.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[a.jsx("td",{className:"p-3 font-bold dark:text-white",children:V.displayName}),a.jsx("td",{className:"p-3 text-gray-500",children:V.studentId||"--"}),a.jsx("td",{className:"p-3",children:V.cohort||"General"}),a.jsx("td",{className:"p-3 text-gray-500",children:V.internshipStudioId?a.jsxs("span",{className:"flex items-center gap-1 text-green-600 font-medium text-xs bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded w-fit",children:[a.jsx(Jo,{size:12})," Assigned"]}):a.jsx("span",{className:"text-gray-400 italic text-xs",children:"Pending"})}),a.jsx("td",{className:"p-3 text-right",children:a.jsxs("div",{className:"flex justify-end gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[a.jsx("button",{onClick:()=>{b(V),v(!0)},className:"p-1.5 bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-300 rounded hover:bg-indigo-100",title:"Assign Internship",children:a.jsx(YA,{size:14})}),a.jsx("button",{onClick:()=>R(V),className:"p-1.5 bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 rounded hover:bg-gray-200",title:"Edit Details",children:a.jsx(eR,{size:14})}),a.jsx("button",{onClick:()=>O(V.id,V.displayName),className:"p-1.5 bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400 rounded hover:bg-red-100",title:"Remove Student",children:a.jsx(bs,{size:14})})]})})]},V.id))})]})}),h&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 space-y-4 animate-in zoom-in-95 shadow-2xl",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"font-bold text-xl dark:text-white",children:E?"Edit Student":"Add New Student"}),a.jsx("button",{onClick:()=>m(!1),children:a.jsx(_t,{className:"text-gray-400 hover:text-red-500"})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"First Name"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:_.firstName,onChange:V=>S({..._,firstName:V.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Last Name"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:_.lastName,onChange:V=>S({..._,lastName:V.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Email Address"}),a.jsx("input",{type:"email",className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:_.email,onChange:V=>S({..._,email:V.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Student ID"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:_.studentId,onChange:V=>S({..._,studentId:V.target.value}),placeholder:"e.g. S123"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Cohort"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:_.cohort,onChange:V=>S({..._,cohort:V.target.value}),placeholder:"Fall 2024"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Enrollment Status"}),a.jsxs("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:_.status,onChange:V=>S({..._,status:V.target.value}),children:[a.jsx("option",{value:"Enrolled",children:"Enrolled"}),a.jsx("option",{value:"Graduated",children:"Graduated"}),a.jsx("option",{value:"Dropped",children:"Dropped"}),a.jsx("option",{value:"Leave",children:"On Leave"})]})]}),a.jsx("button",{onClick:I,className:"w-full bg-indigo-600 text-white py-2.5 rounded-lg font-bold hover:bg-indigo-700 mt-2",children:E?"Update Student":"Create Student Record"})]})}),p&&x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-sm rounded-xl p-6 space-y-4 animate-in zoom-in-95 shadow-2xl",children:[a.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Assign Internship"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Select a partner studio for ",a.jsx("strong",{children:x.displayName}),"."]}),a.jsxs("select",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",value:T,onChange:V=>P(V.target.value),children:[a.jsx("option",{value:"",children:"Select Studio..."}),s.map(V=>a.jsx("option",{value:V.id,children:V.name},V.id))]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>v(!1),className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-sm",children:"Cancel"}),a.jsx("button",{onClick:D,disabled:!T,className:"flex-1 bg-indigo-600 text-white py-2 rounded font-bold disabled:opacity-50",children:"Confirm"})]})]})})]})}const lSe=(t,e)=>{if(!t||!e)return 0;const n=t.toMillis?t.toMillis():new Date(t).getTime(),s=(e.toMillis?e.toMillis():new Date(e).getTime())-n;return Math.max(0,Math.floor(s/6e4))},cSe=t=>{const e=Math.floor(t/60),n=Math.floor(t%60);return`${e}h ${n>0?`${n}m`:""}`};function uSe({schoolId:t}){const[e,n]=N.useState([]),[r,s]=N.useState(!0),[i,o]=N.useState("all");N.useEffect(()=>{t&&(async()=>{s(!0);try{let h=Et(Re(Z,`schools/${t}/internship_logs`),Wn("checkIn","desc"),Qs(100));const p=(await Kt(h)).docs.map(v=>{const x=v.data(),b=lSe(x.checkIn,x.checkOut);return{id:v.id,...x,duration:b}});n(p)}catch(h){console.error("Error fetching logs:",h)}s(!1)})()},[t]);const l=async(d,h)=>{try{await Nt(Se(Z,`schools/${t}/internship_logs/${d}`),{status:h}),n(m=>m.map(p=>p.id===d?{...p,status:h}:p))}catch(m){console.error("Error updating log:",m),alert("Failed to update log status.")}},c=i==="all"?e:e.filter(d=>d.status===i);return r?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Internship Hours..."}):a.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ZA,{size:16,className:"text-gray-500"}),a.jsxs("select",{className:"bg-white dark:bg-[#1f2128] border dark:border-gray-600 text-sm rounded-md p-1.5 outline-none dark:text-white",value:i,onChange:d=>o(d.target.value),children:[a.jsx("option",{value:"all",children:"All Activity"}),a.jsx("option",{value:"pending_approval",children:"Pending Approval"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"rejected",children:"Rejected"}),a.jsx("option",{value:"active",children:"Active (Clocked In)"})]})]}),a.jsxs("button",{onClick:()=>XR(c,"internship_hours"),className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-[#1f2128] border dark:border-gray-600 rounded-md text-xs font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[a.jsx(Gm,{size:14})," Export CSV"]})]}),a.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 shadow-sm",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3",children:"Date"}),a.jsx("th",{className:"p-3",children:"Student"}),a.jsx("th",{className:"p-3",children:"Activity / Description"}),a.jsx("th",{className:"p-3",children:"Duration"}),a.jsx("th",{className:"p-3",children:"Status"}),a.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:c.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"6",className:"p-8 text-center text-gray-500",children:"No logs found matching criteria."})}):c.map(d=>{var h,m;return a.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[a.jsxs("td",{className:"p-3 text-gray-600 dark:text-gray-300 whitespace-nowrap",children:[a.jsx("div",{className:"font-medium",children:(h=d.checkIn)!=null&&h.toDate?d.checkIn.toDate().toLocaleDateString():"N/A"}),a.jsx("div",{className:"text-[10px] text-gray-400",children:(m=d.checkIn)!=null&&m.toDate?d.checkIn.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),a.jsx("td",{className:"p-3 font-bold dark:text-white",children:d.studentName}),a.jsxs("td",{className:"p-3 max-w-xs",children:[a.jsxs("span",{className:"block text-[10px] uppercase font-bold text-gray-400 mb-0.5",children:[d.type,"  ",d.location]}),a.jsx("span",{className:"text-gray-700 dark:text-gray-300 truncate block",title:d.description,children:d.description||a.jsx("span",{className:"italic opacity-50",children:"No description provided"})})]}),a.jsx("td",{className:"p-3 font-mono font-bold text-indigo-600 dark:text-indigo-400",children:d.checkOut?cSe(d.duration):a.jsx("span",{className:"animate-pulse text-green-500",children:"Active..."})}),a.jsx("td",{className:"p-3",children:a.jsx(dSe,{status:d.status})}),a.jsx("td",{className:"p-3 text-right",children:d.status==="pending_approval"&&a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx("button",{onClick:()=>l(d.id,"approved"),className:"p-1.5 bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded hover:bg-green-200 transition",title:"Approve",children:a.jsx(es,{size:16})}),a.jsx("button",{onClick:()=>l(d.id,"rejected"),className:"p-1.5 bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded hover:bg-red-200 transition",title:"Reject",children:a.jsx(t0e,{size:16})})]})})]},d.id)})})]})})]})}function dSe({status:t}){const e={approved:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",rejected:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",pending_approval:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",active:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 animate-pulse"},n={approved:"Approved",rejected:"Rejected",pending_approval:"Pending",active:"In Progress"};return a.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-[10px] uppercase font-bold tracking-wide ${e[t]||"bg-gray-100 text-gray-500"}`,children:n[t]||t})}function hSe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState([]),[o,l]=N.useState(!0),[c,d]=N.useState(""),[h,m]=N.useState("");N.useEffect(()=>{(async()=>{l(!0);try{const x=await Kt(Re(Z,`schools/${t}/staff`));r(x.docs.map(E=>({id:E.id,...E.data()})));const b=await Kt(Re(Z,`schools/${t}/roles`));i(b.docs.map(E=>({id:E.id,...E.data()})))}catch(x){console.error("Staff load failed:",x)}l(!1)})()},[t]);const p=async()=>{if(!c||!h)return alert("Email and Role are required.");try{const v=Et(gd(Z,"public_profile"),nn("email","==",c)),x=await Kt(v);if(x.empty)return alert("User not found. They must sign up for SeshNx first.");const b=x.docs[0],E=b.data(),k=b.ref.parent.parent.id,_=s.find(P=>P.id===h),S={uid:k,email:E.email,name:`${E.firstName} ${E.lastName}`,roleId:h,roleName:(_==null?void 0:_.name)||"Unknown",addedAt:zt()};await hn(Re(Z,`schools/${t}/staff`),S);const T=Ve(k).userProfile;await Nt(Se(Z,T),{schoolId:t,accountTypes:Ay("Instructor")}),r(P=>[...P,S]),d(""),alert(`${E.firstName} added as ${_==null?void 0:_.name}.`),await e("Add Staff",`Added ${E.email} as ${_==null?void 0:_.name}`)}catch(v){console.error("Add staff error:",v),alert("Failed to add staff member. Check console.")}};return o?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Staff..."}):a.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(nu,{size:18,className:"text-indigo-600"})," Add New Staff Member"]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(i0,{size:16,className:"absolute left-3 top-3 text-gray-400"}),a.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"User Email Address",value:c,onChange:v=>d(v.target.value)})]}),a.jsxs("div",{className:"relative min-w-[200px]",children:[a.jsx(na,{size:16,className:"absolute left-3 top-3 text-gray-400"}),a.jsxs("select",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white appearance-none",value:h,onChange:v=>m(v.target.value),children:[a.jsx("option",{value:"",children:"Select Role..."}),s.map(v=>a.jsx("option",{value:v.id,children:v.name},v.id))]})]}),a.jsx("button",{onClick:p,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 transition shadow-md",children:"Add Staff"})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["* The user must already have a SeshNx account. This will grant them ",a.jsx("strong",{children:"Instructor"})," access to this school."]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-[#23262f]",children:[a.jsx("span",{className:"font-bold text-sm dark:text-gray-200",children:"Authorized Personnel"}),a.jsxs("span",{className:"text-xs bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded-full font-bold",children:[n.length," Active"]})]}),a.jsx("div",{className:"divide-y dark:divide-gray-700",children:n.length===0?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"No staff members found."}):n.map(v=>a.jsxs("div",{className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold shadow-sm",children:v.name?v.name.charAt(0):"?"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold dark:text-white text-sm",children:v.name}),a.jsx("div",{className:"text-xs text-gray-500",children:v.email})]})]}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsx("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-bold border dark:border-gray-600",children:v.roleName})})]},v.id))})]})]})}function fSe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState(!0),[o,l]=N.useState(!1),[c,d]=N.useState({name:"",color:"#3b82f6",permissions:[]}),[h,m]=N.useState(!1);N.useEffect(()=>{t&&(async()=>{i(!0);try{const _=await Kt(Re(Z,`schools/${t}/roles`));r(_.docs.map(S=>({id:S.id,...S.data()})))}catch(_){console.error("Error loading roles:",_)}i(!1)})()},[t]);const p=async()=>{if(c.name){m(!0);try{const k=await hn(Re(Z,`schools/${t}/roles`),c);r(_=>[..._,{id:k.id,...c}]),await e("Create Role",`Created role: ${c.name}`),d({name:"",color:"#3b82f6",permissions:[]}),l(!1)}catch(k){console.error("Create role failed:",k),alert("Failed to create role.")}m(!1)}},v=async(k,_)=>{if(confirm(`Delete role "${_}"? Staff assigned to this role will lose their permissions.`))try{await _o(Se(Z,`schools/${t}/roles/${k}`)),r(S=>S.filter(T=>T.id!==k)),await e("Delete Role",`Deleted role: ${_}`)}catch(S){console.error("Delete role failed:",S)}},x=async(k,_)=>{r(S=>S.map(T=>T.id===k?{...T,permissions:_}:T));try{await Nt(Se(Z,`schools/${t}/roles/${k}`),{permissions:_})}catch(S){console.error("Update perms failed:",S)}},b=k=>{d(_=>({..._,permissions:_.permissions.includes(k)?_.permissions.filter(S=>S!==k):[..._.permissions,k]}))},E=(k,_)=>{const S=k.permissions||[],T=S.includes(_)?S.filter(P=>P!==_):[...S,_];x(k.id,T)};return s?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roles..."}):a.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[a.jsxs("button",{onClick:()=>l(!0),className:"w-full py-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-500 font-bold hover:bg-gray-50 dark:hover:bg-white/5 transition flex items-center justify-center gap-2",children:[a.jsx(Zs,{size:20})," Create New Role"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(k=>{var _;return a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] border dark:border-gray-700 rounded-xl shadow-sm flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-start bg-gray-50 dark:bg-gray-800/50",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold dark:text-white flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:k.color}}),k.name]}),a.jsxs("span",{className:"text-[10px] text-gray-400 uppercase tracking-wider font-bold",children:[((_=k.permissions)==null?void 0:_.length)||0," Permissions"]})]}),a.jsx("button",{onClick:()=>v(k.id,k.name),className:"text-gray-400 hover:text-red-500 transition p-1",title:"Delete Role",children:a.jsx(bs,{size:16})})]}),a.jsx("div",{className:"p-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar",children:a.jsx("div",{className:"space-y-0.5",children:PC.map(S=>{var P;const T=(P=k.permissions)==null?void 0:P.includes(S.id);return a.jsxs("label",{className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition ${T?"bg-indigo-50 dark:bg-indigo-900/20":"hover:bg-gray-50 dark:hover:bg-white/5"}`,children:[a.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${T?"bg-indigo-600 border-indigo-600":"border-gray-400"}`,children:T&&a.jsx(Bi,{size:10,className:"text-white",strokeWidth:4})}),a.jsx("input",{type:"checkbox",className:"hidden",checked:T,onChange:()=>E(k,S.id)}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:`text-xs font-bold ${T?"text-indigo-700 dark:text-indigo-300":"text-gray-600 dark:text-gray-400"}`,children:S.label}),a.jsx("div",{className:"text-[10px] text-gray-400 leading-tight",children:S.description})]})]},S.id)})})})]},k.id)})}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-lg rounded-xl p-6 space-y-4 max-h-[90vh] overflow-y-auto animate-in zoom-in-95 shadow-2xl",children:[a.jsxs("h3",{className:"font-bold text-xl dark:text-white flex items-center gap-2",children:[a.jsx(s0,{className:"text-indigo-600"})," Create New Role"]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{className:"col-span-3",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Role Name"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g. Academic Advisor",value:c.name,onChange:k=>d({...c,name:k.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Color"}),a.jsx("div",{className:"flex items-center border rounded dark:border-gray-600 p-1 dark:bg-black/20",children:a.jsx("input",{type:"color",className:"h-8 w-8 rounded cursor-pointer border-none bg-transparent",value:c.color,onChange:k=>d({...c,color:k.target.value})})})]})]}),a.jsxs("div",{className:"border-t dark:border-gray-700 pt-4",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-3 block",children:"Assign Initial Permissions"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:PC.map(k=>a.jsxs("label",{className:`flex items-start gap-2 p-2 border rounded cursor-pointer transition ${c.permissions.includes(k.id)?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-white/5"}`,children:[a.jsx("input",{type:"checkbox",className:"mt-1",checked:c.permissions.includes(k.id),onChange:()=>b(k.id)}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold dark:text-gray-200",children:k.label}),a.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:k.description})]})]},k.id))})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx("button",{onClick:()=>l(!1),className:"flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 rounded font-bold text-sm",children:"Cancel"}),a.jsx("button",{onClick:p,disabled:h,className:"flex-1 bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700 disabled:opacity-50",children:h?"Saving...":"Create Role"})]})]})})]})}function mSe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState(!0),[o,l]=N.useState({resource:"",limit:4,unit:"hours/week",role:"Student"});N.useEffect(()=>{t&&(async()=>{i(!0);try{const m=await Kt(Re(Z,`schools/${t}/rules`));r(m.docs.map(p=>({id:p.id,...p.data()})))}catch(m){console.error("Error loading rules:",m)}i(!1)})()},[t]);const c=async()=>{if(!o.resource)return alert("Resource name required.");try{const m={id:(await hn(Re(Z,`schools/${t}/rules`),o)).id,...o};r(p=>[...p,m]),await e("Add Resource Rule",`Set ${o.limit} ${o.unit} limit for ${o.resource}`),l({resource:"",limit:4,unit:"hours/week",role:"Student"})}catch(h){console.error("Add rule failed:",h)}},d=async(h,m)=>{if(confirm("Delete this rule?"))try{await _o(Se(Z,`schools/${t}/rules/${h}`)),r(p=>p.filter(v=>v.id!==h)),await e("Delete Rule",`Removed rule for ${m}`)}catch(p){console.error("Delete failed:",p)}};return s?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Rules..."}):a.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(tu,{size:18,className:"text-indigo-600"})," Add Restriction / Quota"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Resource Name"}),a.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g. Studio A, SSL Room",value:o.resource,onChange:h=>l({...o,resource:h.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Limit"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",className:"w-20 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:o.limit,onChange:h=>l({...o,limit:h.target.value})}),a.jsxs("select",{className:"flex-1 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white text-sm",value:o.unit,onChange:h=>l({...o,unit:h.target.value}),children:[a.jsx("option",{value:"hours/week",children:"Hrs/Wk"}),a.jsx("option",{value:"hours/term",children:"Hrs/Term"}),a.jsx("option",{value:"bookings/week",children:"Bookings/Wk"})]})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("button",{onClick:c,className:"w-full bg-indigo-600 text-white py-2.5 rounded-lg font-bold hover:bg-indigo-700 flex items-center justify-center gap-2",children:[a.jsx(Zs,{size:18})," Add Rule"]})})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Applies To Role"}),a.jsxs("select",{className:"w-full md:w-1/2 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:o.role,onChange:h=>l({...o,role:h.target.value}),children:[a.jsx("option",{value:"Student",children:"All Students"}),a.jsx("option",{value:"Senior",children:"Seniors Only"}),a.jsx("option",{value:"Junior",children:"Juniors Only"}),a.jsx("option",{value:"Probation",children:"Probationary"})]})]})]}),a.jsx("div",{className:"space-y-3",children:n.length===0?a.jsx("div",{className:"text-center text-gray-500 py-8 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No active restrictions. Students have default access."}):n.map(h=>a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 flex justify-between items-center shadow-sm hover:shadow-md transition",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold dark:text-white text-lg",children:h.resource}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300 mt-1",children:[a.jsxs("span",{className:"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300 px-2 py-0.5 rounded text-xs font-bold border border-indigo-100 dark:border-indigo-800",children:[h.limit," ",h.unit]}),a.jsx("span",{className:"text-gray-400",children:""}),a.jsxs("span",{children:["Applies to: ",a.jsx("strong",{children:h.role})]})]})]}),a.jsx("button",{onClick:()=>d(h.id,h.resource),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:a.jsx(bs,{size:18})})]},h.id))})]})}function pSe({schoolId:t,logAction:e,user:n,userData:r}){const[s,i]=N.useState([]),[o,l]=N.useState(!0),[c,d]=N.useState(!1),[h,m]=N.useState({title:"",message:"",target:"All"});N.useEffect(()=>{t&&(async()=>{l(!0);try{const b=Et(Re(Z,`schools/${t}/announcements`),Wn("createdAt","desc")),E=await Kt(b);i(E.docs.map(k=>({id:k.id,...k.data()})))}catch(b){console.error("Error loading announcements:",b)}l(!1)})()},[t]);const p=async()=>{if(!h.title.trim()||!h.message.trim())return alert("Title and Message required.");d(!0);try{const x={...h,schoolId:t,authorId:n.uid,authorName:r.displayName||"School Admin",authorRole:r.activeProfileRole||"Admin",createdAt:zt()},b=await hn(Re(Z,`schools/${t}/announcements`),x);i(E=>[{id:b.id,...x,createdAt:new Date},...E]),await e("Post Announcement",`Posted: ${h.title}`),m({title:"",message:"",target:"All"})}catch(x){console.error("Post failed:",x),alert("Failed to post announcement.")}d(!1)},v=async x=>{if(confirm("Delete this announcement?"))try{await _o(Se(Z,`schools/${t}/announcements/${x}`)),i(b=>b.filter(E=>E.id!==x)),await e("Delete Announcement","Removed a post")}catch(b){console.error("Delete failed:",b)}};return o?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading News..."}):a.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(gW,{size:18,className:"text-indigo-600"})," Post New Announcement"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"Headline / Title",value:h.title,onChange:x=>m({...h,title:x.target.value})})}),a.jsx("div",{className:"sm:w-1/4",children:a.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white cursor-pointer",value:h.target,onChange:x=>m({...h,target:x.target.value}),children:[a.jsx("option",{value:"All",children:"Everyone"}),a.jsx("option",{value:"Student",children:"Students Only"}),a.jsx("option",{value:"Instructor",children:"Staff Only"})]})})]}),a.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Write your message here...",value:h.message,onChange:x=>m({...h,message:x.target.value})}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:p,disabled:c||!h.title,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 transition",children:c?"Posting...":a.jsxs(a.Fragment,{children:[a.jsx(b1,{size:16})," Post Announcement"]})})})]})]}),a.jsx("div",{className:"space-y-4",children:s.length===0?a.jsx("div",{className:"text-center text-gray-500 py-10 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No announcements yet."}):s.map(x=>{var b;return a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-5 rounded-xl border dark:border-gray-700 shadow-sm relative group",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold dark:text-white",children:x.title}),a.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2 mt-1",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Jr,{size:12})," ",x.authorName]}),a.jsx("span",{children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[x.target==="All"?a.jsx(Rs,{size:12}):a.jsx(na,{size:12}),x.target]}),a.jsx("span",{children:""}),a.jsx("span",{children:(b=x.createdAt)!=null&&b.toDate?x.createdAt.toDate().toLocaleDateString():"Just now"})]})]}),a.jsx("button",{onClick:()=>v(x.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition opacity-0 group-hover:opacity-100",title:"Delete Post",children:a.jsx(bs,{size:16})})]}),a.jsx("div",{className:"text-gray-700 dark:text-gray-300 text-sm whitespace-pre-wrap leading-relaxed bg-gray-50 dark:bg-black/20 p-3 rounded-lg",children:x.message})]},x.id)})})]})}function gSe({schoolId:t,logAction:e}){const[n,r]=N.useState([]),[s,i]=N.useState(!0),[o,l]=N.useState({name:"",address:"",website:"",contactEmail:""});N.useEffect(()=>{t&&(async()=>{i(!0);try{const m=Et(Re(Z,`schools/${t}/partners`),Wn("name")),p=await Kt(m);r(p.docs.map(v=>({id:v.id,...v.data()})))}catch(m){console.error("Error loading partners:",m)}i(!1)})()},[t]);const c=async()=>{if(!o.name)return alert("Partner Name is required.");try{const h={...o,status:"Approved"},m=await hn(Re(Z,`schools/${t}/partners`),h);r(p=>[...p,{id:m.id,...h}]),await e("Add Partner",`Added studio: ${o.name}`),l({name:"",address:"",website:"",contactEmail:""})}catch(h){console.error("Add partner failed:",h),alert("Failed to add partner.")}},d=async(h,m)=>{if(confirm(`Remove ${m} from approved partners?`))try{await _o(Se(Z,`schools/${t}/partners/${h}`)),r(p=>p.filter(v=>v.id!==h)),await e("Remove Partner",`Removed: ${m}`)}catch(p){console.error("Delete failed:",p)}};return s?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Partners..."}):a.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-5 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(Jo,{size:18,className:"text-indigo-600"})," Add Approved Partner"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Studio / Company Name"}),a.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-bold",placeholder:"e.g. Sound City Studios",value:o.name,onChange:h=>l({...o,name:h.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(Br,{size:14,className:"absolute left-3 top-3 text-gray-400"}),a.jsx("input",{className:"w-full pl-9 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"123 Main St...",value:o.address,onChange:h=>l({...o,address:h.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-1 block",children:"Contact Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(R4,{size:14,className:"absolute left-3 top-3 text-gray-400"}),a.jsx("input",{className:"w-full pl-9 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"manager@studio.com",value:o.contactEmail,onChange:h=>l({...o,contactEmail:h.target.value})})]})]})]}),a.jsx("div",{className:"mt-3 flex justify-end",children:a.jsxs("button",{onClick:c,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 flex items-center gap-2 shadow-md transition",children:[a.jsx(Zs,{size:18})," Add Partner"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.length===0?a.jsx("div",{className:"col-span-full text-center py-10 text-gray-500 border-2 border-dashed dark:border-gray-700 rounded-xl",children:"No partners added yet."}):n.map(h=>a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-4 rounded-xl border dark:border-gray-700 shadow-sm hover:shadow-md transition group relative",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsx("h4",{className:"font-bold dark:text-white text-lg truncate pr-8",children:h.name}),a.jsx("button",{onClick:()=>d(h.id,h.name),className:"text-gray-400 hover:text-red-500 absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition",children:a.jsx(bs,{size:16})})]}),a.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[h.address&&a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Br,{size:14,className:"mt-0.5 text-indigo-500 shrink-0"}),a.jsx("span",{className:"truncate",children:h.address})]}),h.contactEmail&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(R4,{size:14,className:"text-green-500 shrink-0"}),a.jsx("a",{href:`mailto:${h.contactEmail}`,className:"hover:underline truncate",children:h.contactEmail})]})]}),a.jsxs("div",{className:"mt-4 pt-3 border-t dark:border-gray-700 flex justify-between items-center",children:[a.jsx("span",{className:"text-[10px] font-bold uppercase text-green-600 bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded border border-green-200 dark:border-green-800",children:"Approved"}),h.website&&a.jsx("a",{href:h.website,target:"_blank",rel:"noreferrer",className:"text-gray-400 hover:text-indigo-500",children:a.jsx(fW,{size:14})})]})]},h.id))})]})}function ySe({schoolId:t,logAction:e,graderName:n}){const[r,s]=N.useState([]),[i,o]=N.useState(!0),[l,c]=N.useState(""),[d,h]=N.useState(null),[m,p]=N.useState([]),[v,x]=N.useState(!1),[b,E]=N.useState(!1),[k,_]=N.useState({technical:5,softSkills:5,notes:""});N.useEffect(()=>{t&&(async()=>{o(!0);try{const R=Et(Re(Z,`schools/${t}/students`),Wn("displayName")),I=await Kt(R);s(I.docs.map(O=>({id:O.id,...O.data()})))}catch(R){console.error("Error loading students:",R)}o(!1)})()},[t]),N.useEffect(()=>{if(!d)return;(async()=>{x(!0);try{const R=Et(Re(Z,`schools/${t}/students/${d.id}/evaluations`),Wn("date","desc")),I=await Kt(R);p(I.docs.map(O=>({id:O.id,...O.data()})))}catch(R){console.error("Error loading history:",R)}x(!1)})(),E(!1),_({technical:5,softSkills:5,notes:""})},[d,t]);const S=async()=>{if(d)try{const j={...k,evaluator:n||"Instructor",date:zt()},R=await hn(Re(Z,`schools/${t}/students/${d.id}/evaluations`),j);p(I=>[{id:R.id,...j,date:new Date},...I]),await e("Grade Student",`Graded ${d.displayName}: Tech(${k.technical}) Soft(${k.softSkills})`),E(!1),alert("Evaluation submitted successfully.")}catch(j){console.error("Grading failed:",j),alert("Failed to save evaluation.")}},T=r.filter(j=>{var R,I;return((R=j.displayName)==null?void 0:R.toLowerCase().includes(l.toLowerCase()))||((I=j.studentId)==null?void 0:I.toLowerCase().includes(l.toLowerCase()))}),P=j=>j>=8?"text-green-500":j>=5?"text-yellow-500":"text-red-500";return i?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Roster..."}):a.jsxs("div",{className:"flex flex-col md:flex-row h-[600px] border dark:border-gray-700 rounded-xl overflow-hidden bg-white dark:bg-[#2c2e36] animate-in fade-in shadow-sm",children:[a.jsxs("div",{className:"w-full md:w-1/3 border-r dark:border-gray-700 flex flex-col bg-gray-50 dark:bg-[#23262f]",children:[a.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{className:"absolute left-3 top-2.5 text-gray-400",size:16}),a.jsx("input",{className:"w-full pl-9 p-2 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"Search Students...",value:l,onChange:j=>c(j.target.value)})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:T.map(j=>a.jsxs("div",{onClick:()=>h(j),className:`p-3 px-4 cursor-pointer flex justify-between items-center transition border-b dark:border-gray-700/50 last:border-0
                                ${(d==null?void 0:d.id)===j.id?"bg-white dark:bg-[#2c2e36] border-l-4 border-l-indigo-600 shadow-sm":"hover:bg-gray-100 dark:hover:bg-gray-700"}
                            `,children:[a.jsxs("div",{children:[a.jsx("div",{className:`font-bold text-sm ${(d==null?void 0:d.id)===j.id?"text-indigo-700 dark:text-white":"dark:text-gray-300"}`,children:j.displayName}),a.jsxs("div",{className:"text-xs text-gray-500",children:[j.cohort||"General","  ",j.hoursLogged||0," hrs"]})]}),(d==null?void 0:d.id)===j.id&&a.jsx(ea,{size:16,className:"text-indigo-500"})]},j.id))})]}),a.jsx("div",{className:"flex-1 flex flex-col relative",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 border-b dark:border-gray-700 flex justify-between items-center bg-white dark:bg-[#2c2e36]",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-700 dark:text-indigo-300 font-bold",children:d.displayName[0]}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold dark:text-white",children:d.displayName}),a.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",d.studentId||"N/A"]})]})]}),b?a.jsxs("button",{onClick:()=>E(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-white flex items-center gap-2 text-sm font-bold",children:[a.jsx(Fye,{size:16})," View History"]}):a.jsxs("button",{onClick:()=>E(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-indigo-700 flex items-center gap-2",children:[a.jsx(Zs,{size:16})," New Evaluation"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-white dark:bg-[#2c2e36]",children:[b&&a.jsxs("div",{className:"max-w-lg mx-auto space-y-6 animate-in slide-in-from-bottom-4",children:[a.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800/50 mb-6",children:[a.jsx("h4",{className:"font-bold text-indigo-800 dark:text-indigo-300 mb-1",children:"New Assessment"}),a.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:["Rating performance for ",new Date().toLocaleDateString(),"."]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("label",{className:"font-bold text-sm dark:text-gray-300",children:"Technical Proficiency"}),a.jsxs("span",{className:`font-bold ${P(k.technical)}`,children:[k.technical,"/10"]})]}),a.jsx("input",{type:"range",min:"1",max:"10",step:"1",className:"w-full accent-indigo-600 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:k.technical,onChange:j=>_({...k,technical:parseInt(j.target.value)})}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Knowledge of equipment, software, and signal flow."})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("label",{className:"font-bold text-sm dark:text-gray-300",children:"Soft Skills / Professionalism"}),a.jsxs("span",{className:`font-bold ${P(k.softSkills)}`,children:[k.softSkills,"/10"]})]}),a.jsx("input",{type:"range",min:"1",max:"10",step:"1",className:"w-full accent-indigo-600 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:k.softSkills,onChange:j=>_({...k,softSkills:parseInt(j.target.value)})}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Punctuality, attitude, communication, and client handling."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"font-bold text-sm dark:text-gray-300 block mb-2",children:"Instructor Notes"}),a.jsx("textarea",{className:"w-full p-3 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white min-h-[100px]",placeholder:"Detailed feedback...",value:k.notes,onChange:j=>_({...k,notes:j.target.value})})]}),a.jsxs("button",{onClick:S,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 transition flex items-center justify-center gap-2 shadow-lg",children:[a.jsx(Gd,{size:18})," Submit Evaluation"]})]})]}),!b&&a.jsx("div",{className:"space-y-4",children:v?a.jsx("p",{className:"text-center text-gray-500",children:"Loading history..."}):m.length===0?a.jsxs("div",{className:"text-center py-10 border-2 border-dashed dark:border-gray-700 rounded-xl",children:[a.jsx(gm,{size:32,className:"mx-auto text-gray-300 mb-2"}),a.jsx("p",{className:"text-gray-500",children:"No evaluations recorded yet."}),a.jsx("button",{onClick:()=>E(!0),className:"text-indigo-500 font-bold text-sm mt-2 hover:underline",children:"Start first evaluation"})]}):m.map(j=>{var R;return a.jsxs("div",{className:"border dark:border-gray-700 rounded-xl p-4 hover:shadow-md transition bg-gray-50 dark:bg-[#23262f]",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1",children:(R=j.date)!=null&&R.toDate?j.date.toDate().toLocaleDateString():"Unknown Date"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jr,{size:14,className:"text-gray-400"}),a.jsx("span",{className:"text-sm font-medium dark:text-gray-200",children:j.evaluator})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"text-center px-3 py-1 bg-white dark:bg-black/20 rounded border dark:border-gray-600",children:[a.jsx("div",{className:`font-bold ${P(j.technical)}`,children:j.technical}),a.jsx("div",{className:"text-[9px] text-gray-400 uppercase",children:"Tech"})]}),a.jsxs("div",{className:"text-center px-3 py-1 bg-white dark:bg-black/20 rounded border dark:border-gray-600",children:[a.jsx("div",{className:`font-bold ${P(j.softSkills)}`,children:j.softSkills}),a.jsx("div",{className:"text-[9px] text-gray-400 uppercase",children:"Soft"})]})]})]}),j.notes&&a.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 border-t dark:border-gray-700 pt-3 mt-2",children:['"',j.notes,'"']})]},j.id)})})]})]}):a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400",children:[a.jsx(gm,{size:48,className:"mb-4 opacity-20"}),a.jsx("p",{children:"Select a student to view history or submit grades."})]})})]})}function xSe({schoolId:t,logAction:e}){const[n,r]=N.useState(""),[s,i]=N.useState(!1),o=async()=>{var m;if(!n.trim())return alert("Please paste CSV data first.");i(!0);const c=n.trim().split(`
`);let d=0,h=0;try{for(let p of c){const v=p.split(",");if(v.length>=3){const x=v[0].trim(),b=v[1].trim(),E=v[2].trim(),k=((m=v[3])==null?void 0:m.trim())||"General",_=`${b} ${E}`;x&&b?(await hn(Re(Z,`schools/${t}/students`),{email:x,displayName:_,firstName:b,lastName:E,cohort:k,studentId:"",status:"Enrolled",hoursLogged:0,createdAt:zt()}),d++):h++}else h++}await e("Batch Import",`Imported ${d} students. (${h} skipped)`),alert(`Import complete! Added ${d} students.`),r("")}catch(p){console.error("Import failed:",p),alert("Batch import encountered an error.")}i(!1)},l=async()=>{prompt("Type 'ROLLOVER' to confirm. This will archive current internship logs for all students.")==="ROLLOVER"&&(alert("Rollover process initiated. (This is a placeholder for the Cloud Function trigger)."),await e("Term Rollover","Initiated term archival"))};return a.jsxs("div",{className:"space-y-6 animate-in fade-in",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(_1,{size:18,className:"text-indigo-600"})," Batch Import Students"]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg mb-4 border border-blue-100 dark:border-blue-800 text-xs text-blue-800 dark:text-blue-300",children:[a.jsx("strong",{children:"Format:"})," ",a.jsx("code",{children:"email, first_name, last_name, cohort"}),a.jsx("br",{}),"Example: ",a.jsx("code",{children:"student@test.edu, John, Doe, Fall 2024"})]}),a.jsx("textarea",{className:"w-full h-40 p-3 text-sm border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-mono resize-y focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Paste CSV data here...",value:n,onChange:c=>r(c.target.value),disabled:s}),a.jsx("div",{className:"mt-3 flex justify-end",children:a.jsx("button",{onClick:o,disabled:s||!n,className:"bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2 transition",children:s?"Processing...":a.jsxs(a.Fragment,{children:[a.jsx($c,{size:16})," Import Students"]})})})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(Cye,{size:18,className:"text-orange-500"})," Term Management"]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-bold text-sm dark:text-gray-200 mb-1",children:"End of Term Rollover"}),a.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"Use this tool at the end of a semester or cohort period. It will:"}),a.jsxs("ul",{className:"list-disc list-inside text-xs text-gray-500 mt-2 space-y-1 ml-1",children:[a.jsx("li",{children:"Archive all active internship logs."}),a.jsx("li",{children:'Reset "Current Hours" counters (preserving Total Lifetime Hours).'}),a.jsx("li",{children:'Mark graduating students as "Alumni" (optional).'})]})]}),a.jsx("div",{className:"w-full md:w-auto",children:a.jsxs("button",{onClick:l,className:"w-full md:w-auto bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/40 text-red-600 dark:text-red-400 px-4 py-3 rounded-lg font-bold text-xs flex items-center justify-center gap-2 border border-red-200 dark:border-red-800 transition",children:[a.jsx(Sd,{size:16})," Execute Rollover"]})})]})]})]})}function vSe({schoolId:t}){const[e,n]=N.useState([]),[r,s]=N.useState(!0),[i,o]=N.useState(50);N.useEffect(()=>{t&&(async()=>{s(!0);try{const d=Et(Re(Z,`schools/${t}/audit_logs`),Wn("timestamp","desc"),Qs(i)),h=await Kt(d);n(h.docs.map(m=>({id:m.id,...m.data()})))}catch(d){console.error("Error loading audit logs:",d)}s(!1)})()},[t,i]);const l=c=>c.includes("Delete")||c.includes("Remove")?"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400":c.includes("Create")||c.includes("Add")?"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-400":c.includes("Update")||c.includes("Edit")?"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 bg-gray-100 dark:bg-gray-700 dark:text-gray-300";return r&&e.length===0?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Audit Trail..."}):a.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[a.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[a.jsx(KA,{size:16}),a.jsxs("span",{children:["Showing last ",a.jsx("strong",{children:e.length})," actions"]})]}),a.jsxs("button",{onClick:()=>XR(e,"audit_logs"),className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-[#1f2128] border dark:border-gray-600 rounded-md text-xs font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[a.jsx($c,{size:14})," Export Log"]})]}),a.jsx("div",{className:"overflow-x-auto bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 shadow-sm",children:a.jsxs("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-500 font-bold uppercase text-xs",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3",children:"Timestamp"}),a.jsx("th",{className:"p-3",children:"Admin / Staff"}),a.jsx("th",{className:"p-3",children:"Action Type"}),a.jsx("th",{className:"p-3",children:"Details"})]})}),a.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"4",className:"p-8 text-center text-gray-500",children:"No audit history found."})}):e.map(c=>{var d;return a.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-white/5 transition",children:[a.jsxs("td",{className:"p-3 text-gray-500 whitespace-nowrap flex items-center gap-2",children:[a.jsx(Ms,{size:14,className:"opacity-50"}),(d=c.timestamp)!=null&&d.toDate?c.timestamp.toDate().toLocaleString():"N/A"]}),a.jsx("td",{className:"p-3 font-bold dark:text-white",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(na,{size:14,className:"text-indigo-500"}),c.adminName||"System"]})}),a.jsx("td",{className:"p-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider ${l(c.action)}`,children:c.action})}),a.jsx("td",{className:"p-3 text-gray-600 dark:text-gray-300 font-mono text-xs",children:c.details})]},c.id)})})]})}),e.length>=i&&a.jsx("div",{className:"text-center pt-2",children:a.jsx("button",{onClick:()=>o(c=>c+50),className:"text-xs font-bold text-indigo-600 hover:underline",children:"Load Older Logs"})})]})}function bSe({schoolId:t,initialData:e,logAction:n,refreshMeta:r}){const[s,i]=N.useState(e||{}),{uploadImage:o,uploading:l}=YR();N.useEffect(()=>{e&&i(e)},[e]);const c=async()=>{try{await Nt(Se(Z,"schools",t),s),alert("School settings updated successfully."),r&&r(s),await n("Update Settings","Updated school configuration")}catch(m){console.error("Update failed:",m),alert("Failed to update school settings.")}},d=async m=>{const p=m.target.files[0];if(!(!p||!t))try{const v=await o(p,`schools/${t}/images/logo`);v&&(await Nt(Se(Z,"schools",t),{logoURL:v}),i(x=>({...x,logoURL:v})),r&&r({...s,logoURL:v}),await n("Update Logo","Uploaded new school logo"))}catch(v){console.error("Logo upload failed",v),alert("Failed to upload logo.")}},h=m=>{i(p=>({...p,[m]:!p[m]}))};return!s.name&&!e?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading Settings..."}):a.jsxs("div",{className:"space-y-8 animate-in fade-in",children:[a.jsxs("section",{className:"flex flex-col md:flex-row gap-6 items-start",children:[a.jsxs("div",{className:"relative group",children:[a.jsxs("div",{className:"h-32 w-32 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300 dark:border-gray-600",children:[s.logoURL?a.jsx("img",{src:s.logoURL,className:"h-full w-full object-contain",alt:"Logo"}):a.jsx(Bc,{size:40,className:"text-gray-400"}),l&&a.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center text-white text-xs",children:"Uploading..."})]}),a.jsxs("label",{className:"absolute bottom-2 right-2 bg-indigo-600 p-2 rounded-full text-white cursor-pointer shadow-lg hover:bg-indigo-700 transition",children:[a.jsx(v1,{size:14}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:d,disabled:l})]})]}),a.jsxs("div",{className:"flex-1 w-full grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"School Name"}),a.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.name||"",onChange:m=>i({...s,name:m.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Primary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"color",className:"h-10 w-10 p-0 border-0 rounded cursor-pointer",value:s.primaryColor||"#4f46e5",onChange:m=>i({...s,primaryColor:m.target.value})}),a.jsx("input",{className:"flex-1 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white font-mono",value:s.primaryColor||"",onChange:m=>i({...s,primaryColor:m.target.value})})]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(Br,{size:16,className:"absolute left-3 top-3 text-gray-400"}),a.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.address||"",onChange:m=>i({...s,address:m.target.value})})]})]})]})]}),a.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t dark:border-gray-700",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Website"}),a.jsxs("div",{className:"relative",children:[a.jsx(dx,{size:16,className:"absolute left-3 top-3 text-gray-400"}),a.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.website||"",onChange:m=>i({...s,website:m.target.value}),placeholder:"https://"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Contact Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(i0,{size:16,className:"absolute left-3 top-3 text-gray-400"}),a.jsx("input",{className:"w-full pl-10 p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.contactEmail||"",onChange:m=>i({...s,contactEmail:m.target.value}),placeholder:"admin@school.edu"})]})]})]}),a.jsxs("section",{children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white border-b dark:border-gray-700 pb-2 mb-4 flex items-center gap-2",children:[a.jsx(gm,{size:18,className:"text-indigo-600"})," Academic Structure"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Cohort Mode"}),a.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.cohortMode||"Semester",onChange:m=>i({...s,cohortMode:m.target.value}),children:[a.jsx("option",{value:"Semester",children:"Semester Based"}),a.jsx("option",{value:"Trimester",children:"Trimester"}),a.jsx("option",{value:"Monthly",children:"Monthly"}),a.jsx("option",{value:"Rolling",children:"Rolling"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Grading Scale"}),a.jsxs("select",{className:"w-full p-2.5 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white",value:s.gradingScale||"1-10",onChange:m=>i({...s,gradingScale:m.target.value}),children:[a.jsx("option",{value:"1-10",children:"Numeric (1-10)"}),a.jsx("option",{value:"Pass/Fail",children:"Pass/Fail"}),a.jsx("option",{value:"Letter",children:"Letter Grades"})]})]})]})]}),a.jsxs("section",{children:[a.jsxs("h3",{className:"font-bold text-lg dark:text-white border-b dark:border-gray-700 pb-2 mb-4 flex items-center gap-2",children:[a.jsx(Kd,{size:18,className:"text-indigo-600"})," Operational Rules"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-sm dark:text-white",children:"Strict Geofencing"}),a.jsx("div",{className:"text-xs text-gray-500",children:"Require GPS location match for clock-in"})]}),a.jsx("button",{onClick:()=>h("geofencing"),children:s.geofencing?a.jsx(Xu,{size:24,className:"text-indigo-600"}):a.jsx(Yu,{size:24,className:"text-gray-400"})})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-sm dark:text-white",children:"Supervisor Approval"}),a.jsx("div",{className:"text-xs text-gray-500",children:"Require partner studio sign-off on hours"})]}),a.jsx("button",{onClick:()=>h("requireApproval"),children:s.requireApproval?a.jsx(Xu,{size:24,className:"text-indigo-600"}):a.jsx(Yu,{size:24,className:"text-gray-400"})})]})]})]}),a.jsx("div",{className:"pt-4 border-t dark:border-gray-700",children:a.jsxs("button",{onClick:c,className:"w-full sm:w-auto bg-indigo-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-indigo-700 flex items-center justify-center gap-2 shadow-lg",children:[a.jsx(Gd,{size:18})," Save Configuration"]})})]})}function dG({user:t,userData:e,allowedTabs:n,staffTitle:r,currentView:s}){var T;const{schoolId:i}=vx(),o=s?s.replace("edu-",""):n?n[0]:"overview",[l,c]=N.useState(i||null),[d,h]=N.useState(null),[m,p]=N.useState([]),[v,x]=N.useState(!1),[b,E]=N.useState({name:"",address:"",primaryColor:"#4f46e5"}),k=(T=e==null?void 0:e.accountTypes)==null?void 0:T.includes("Admin");N.useEffect(()=>{k&&(async()=>{try{const R=(await Kt(Re(Z,"schools"))).docs.map(I=>({id:I.id,...I.data()}));p(R),!l&&!i&&R.length>0&&c(R[0].id)}catch(j){console.error("Error fetching schools list:",j)}})()},[k,l]),N.useEffect(()=>{if(!l)return;(async()=>{try{const j=Et(Re(Z,"schools"),nn("__name__","==",l)),R=await Kt(j);R.empty||h(R.docs[0].data())}catch(j){console.error("Error loading school meta:",j)}})()},[l]);const _=async(P,j)=>{if(l)try{await hn(Re(Z,`schools/${l}/audit_logs`),{action:P,details:j,adminId:t.uid,adminName:`${e.firstName} ${e.lastName}`,timestamp:zt()})}catch(R){console.error("Failed to log action:",R)}},S=async()=>{if(b.name)try{const P=await hn(Re(Z,"schools"),{...b,createdAt:zt(),requiredHours:100});await hn(Re(Z,`schools/${P.id}/roles`),{name:"Admin",color:"#dc2626",permissions:PC.map(j=>j.id)}),p(j=>[...j,{id:P.id,...b}]),c(P.id),x(!1),E({name:"",address:"",primaryColor:"#4f46e5"})}catch(P){console.error("Error creating school:",P),alert("Failed to create school.")}};return a.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 pb-20",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6 relative overflow-hidden",children:[a.jsx("div",{className:"h-24 w-24 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-2 z-10",children:d!=null&&d.logoURL?a.jsx("img",{src:d.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):a.jsx(Bc,{size:40,className:"text-gray-400"})}),a.jsxs("div",{className:"flex-1 text-center md:text-left z-10",children:[a.jsxs("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight flex items-center justify-center md:justify-start gap-3",children:[(d==null?void 0:d.name)||"Select School",k&&!r&&a.jsxs("div",{className:"relative group",children:[a.jsx("select",{className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",value:l||"",onChange:P=>c(P.target.value),children:m.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))}),a.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 border-none rounded-lg text-sm font-bold p-1 px-2 flex items-center gap-1 pointer-events-none group-hover:bg-gray-200 dark:group-hover:bg-gray-600 transition",children:[a.jsx("span",{children:"Switch"})," ",a.jsx(na,{size:10})]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400 mt-1",children:[r?a.jsxs("span",{className:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:[r," Dashboard"]}):a.jsx("span",{className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Global Admin Mode"}),(d==null?void 0:d.address)&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Br,{size:12})," ",d.address]})]})]})]}),k&&a.jsx("div",{className:"z-10",children:a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-indigo-700 transition shadow-md",children:[a.jsx(Zs,{size:16})," New School"]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-600/5 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"})]}),a.jsx("div",{className:"bg-white dark:bg-[#2c2e36] rounded-xl border dark:border-gray-700 min-h-[400px] p-4",children:l?a.jsxs(a.Fragment,{children:[o==="overview"&&a.jsx(oSe,{schoolId:l,schoolData:d}),o==="roster"&&a.jsx(aSe,{schoolId:l,logAction:_}),o==="hours"&&a.jsx(uSe,{schoolId:l}),o==="instructors"&&a.jsx(hSe,{schoolId:l,logAction:_}),o==="roles"&&a.jsx(fSe,{schoolId:l,logAction:_}),o==="resources"&&a.jsx(mSe,{schoolId:l,logAction:_}),o==="news"&&a.jsx(pSe,{schoolId:l,logAction:_,user:t,userData:e}),o==="partners"&&a.jsx(gSe,{schoolId:l,logAction:_}),o==="evaluations"&&a.jsx(ySe,{schoolId:l,logAction:_,graderName:e.displayName}),o==="cohorts"&&a.jsx(xSe,{schoolId:l,logAction:_}),o==="audit"&&a.jsx(vSe,{schoolId:l}),o==="settings"&&a.jsx(bSe,{schoolId:l,initialData:d,logAction:_,refreshMeta:P=>h(j=>({...j,...P}))})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-gray-500",children:[a.jsx(Bc,{size:48,className:"mb-4 opacity-20"}),a.jsx("p",{children:"Please select or create a school to manage."})]})}),v&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] w-full max-w-md rounded-xl p-6 space-y-4 animate-in zoom-in-95",children:[a.jsx("h3",{className:"font-bold text-xl dark:text-white",children:"Create School"}),a.jsx("input",{className:"w-full p-2 border rounded dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"School Name",value:b.name,onChange:P=>E({...b,name:P.target.value})}),a.jsx("button",{onClick:S,className:"w-full bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700",children:"Create"}),a.jsx("button",{onClick:()=>x(!1),className:"w-full text-gray-500 text-sm hover:underline",children:"Cancel"})]})})]})}function _Se({user:t,userData:e,currentView:n}){const{myPermissions:r,staffProfile:s}=vx(),i={manage_roster:"roster",manage_enrollment:"cohorts",approve_hours:"hours",manage_partners:"partners",grade_students:"evaluations",post_announcements:"news",manage_resources:"resources",manage_staff:"instructors",view_audit:"audit",edit_settings:"settings"},o=r.includes("ALL")?Object.values(i):r.map(l=>i[l]).filter(Boolean);return o.length===0&&!r.includes("ALL")?a.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-gray-500",children:[a.jsx(tu,{size:48,className:"mb-4 text-gray-300"}),a.jsx("h3",{className:"text-lg font-bold",children:"Access Restricted"}),a.jsx("p",{children:"You are listed as staff but have no assigned permissions."})]}):a.jsx(dG,{user:t,userData:e,allowedTabs:o,staffTitle:s==null?void 0:s.roleName,currentView:n})}function wSe({user:t,userData:e}){const{schoolData:n,studentProfile:r,internshipStudio:s,checkIn:i,checkOut:o}=vx(),[l,c]=N.useState(""),[d,h]=N.useState(!1),m=async()=>{h(!0);try{r!=null&&r.isClockedIn?(await o(l),c("")):await i((s==null?void 0:s.name)||"Remote Internship","studio")}catch(v){console.error(v)}h(!1)};if(!r)return a.jsx("div",{className:"p-8 text-center",children:"Loading student profile..."});const p=Math.min(100,(r.hoursLogged||0)/((n==null?void 0:n.requiredHours)||100)*100);return a.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col md:flex-row items-center gap-6",children:[a.jsx("div",{className:"h-20 w-20 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center overflow-hidden border-2 border-gray-200 dark:border-gray-600 shrink-0 p-1",children:n!=null&&n.logoURL?a.jsx("img",{src:n.logoURL,className:"h-full w-full object-contain",alt:"School Logo"}):a.jsx(Bc,{size:32,className:"text-gray-400"})}),a.jsxs("div",{className:"flex-1 text-center md:text-left",children:[a.jsx("h1",{className:"text-3xl font-extrabold dark:text-white tracking-tight mb-1",children:(n==null?void 0:n.name)||"Internship Dashboard"}),a.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:[a.jsx("span",{className:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wide",children:"Active Intern"}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Cohort: ",r.cohort]})]})]}),a.jsxs("div",{className:"text-right hidden md:block",children:[a.jsx("div",{className:"text-3xl font-black dark:text-white text-indigo-600",children:r.hoursLogged||0}),a.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider",children:"Total Hours"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"md:col-span-2 bg-gradient-to-br from-indigo-900 to-slate-900 text-white p-8 rounded-2xl relative overflow-hidden shadow-lg border border-indigo-800/50",children:[a.jsxs("div",{className:"relative z-10",children:[a.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest opacity-60 mb-2",children:"Assigned Studio Location"}),a.jsx("h2",{className:"text-3xl font-extrabold mb-4 tracking-tight",children:(s==null?void 0:s.name)||"Pending Assignment"}),s?a.jsxs("div",{className:"space-y-3 text-sm opacity-90",children:[a.jsxs("p",{className:"flex items-center gap-2",children:[a.jsx(Br,{size:18,className:"text-indigo-400"})," ",s.address||"Address not listed"]}),a.jsxs("p",{className:"flex items-center gap-2",children:[a.jsx(es,{size:18,className:"text-green-400"})," Status: Active Placement"]})]}):a.jsxs("div",{className:"bg-white/10 p-4 rounded-xl flex items-start gap-3 border border-white/10",children:[a.jsx(pl,{className:"text-yellow-400 shrink-0 mt-0.5",size:20}),a.jsx("p",{className:"text-sm leading-relaxed",children:"You haven't been assigned an internship location yet. Please contact your school coordinator to get placed."})]})]}),a.jsx("div",{className:"absolute -right-12 -bottom-12 w-64 h-64 bg-indigo-600/20 rounded-full blur-3xl"})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-bold dark:text-white mb-4 flex items-center gap-2",children:[a.jsx(Ms,{className:r.isClockedIn?"text-green-500 animate-pulse":"text-gray-400"}),r.isClockedIn?"Currently Working":"Time Clock"]}),r.isClockedIn&&a.jsx("textarea",{className:"w-full p-3 text-sm border rounded-xl mb-4 dark:bg-black/20 dark:border-gray-600 dark:text-white resize-none focus:ring-2 focus:ring-indigo-500 outline-none",rows:"4",placeholder:"Describe your tasks for this session...",value:l,onChange:v=>c(v.target.value)})]}),a.jsx("button",{onClick:m,disabled:d||!s&&!r.isClockedIn,className:`w-full py-3.5 rounded-xl font-bold text-white transition shadow-lg transform active:scale-95 ${d?"bg-gray-400":r.isClockedIn?"bg-red-500 hover:bg-red-600 shadow-red-500/30":"bg-green-600 hover:bg-green-700 shadow-green-600/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none"}`,children:d?"Processing...":r.isClockedIn?"Clock Out":"Clock In"})]})]}),a.jsxs("div",{className:"bg-white dark:bg-[#2c2e36] p-6 rounded-2xl border dark:border-gray-700 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between text-sm font-bold mb-2",children:[a.jsx("span",{className:"dark:text-white",children:"Completion Progress"}),a.jsxs("span",{className:"text-indigo-600",children:[Math.round(p),"%"]})]}),a.jsx("div",{className:"w-full h-4 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-1000 ease-out",style:{width:`${p}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 mt-2 text-center",children:[r.hoursLogged," / ",(n==null?void 0:n.requiredHours)||100," Hours Required"]})]})]})}function kSe({user:t,onComplete:e,onSkip:n}){const[r,s]=N.useState(""),[i,o]=N.useState([]),[l,c]=N.useState(null),[d,h]=N.useState(""),[m,p]=N.useState(""),[v,x]=N.useState(!1),b=async k=>{if(k.length<3){o([]);return}const _=Et(Re(Z,"schools"),nn("name",">=",k),nn("name","<=",k+"")),S=await Kt(_);o(S.docs.map(T=>({id:T.id,...T.data()})))},E=async()=>{if(!l||!d){p("Please select a school and enter your ID.");return}p(""),x(!0);try{const k=D1(),_=V1(k,"enrollStudent");await Nt(Se(Z,"users",t.uid),{schoolId:l.id,studentId:d,accountTypes:["user","student"]}),e()}catch(k){console.error("Enrollment error:",k),p("Enrollment failed. Please try again.")}finally{x(!1)}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("h2",{className:"text-xl font-bold dark:text-white",children:"Student Enrollment"}),a.jsx("p",{className:"text-gray-500",children:"Search for your school and enter your student ID to link your account."}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search for your school...",value:r,onChange:k=>{s(k.target.value),b(k.target.value)},className:"w-full pl-10 p-2 border rounded-lg dark:bg-black/20 dark:border-gray-600 dark:text-white"}),a.jsx(Ur,{className:"absolute left-3 top-3 text-gray-400",size:16})]}),r.length>0&&i.length>0&&a.jsx("div",{className:"border rounded-lg max-h-40 overflow-y-auto dark:border-gray-700 bg-white dark:bg-gray-800",children:i.map(k=>a.jsxs("div",{className:`p-3 cursor-pointer hover:bg-indigo-50 dark:hover:bg-gray-700/50 ${(l==null?void 0:l.id)===k.id?"bg-indigo-100 dark:bg-indigo-900/50":""}`,onClick:()=>{c(k),s(k.name),o([])},children:[a.jsx("div",{className:"font-medium dark:text-white",children:k.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:[k.city,", ",k.state]})]},k.id))}),l&&a.jsxs("div",{className:"space-y-4 pt-4 animate-in fade-in slide-in-from-top-2",children:[a.jsxs("p",{className:"text-sm font-bold dark:text-white",children:["Selected: ",a.jsx("span",{className:"text-indigo-600",children:l.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Student ID Number"}),a.jsx("input",{type:"text",value:d,onChange:k=>h(k.target.value),className:"w-full p-2 border rounded-lg mt-1 dark:bg-black/20 dark:border-gray-600 dark:text-white",placeholder:"e.g., SESH00123"})]}),m&&a.jsx("p",{className:"text-red-500 text-sm",children:m}),a.jsx("button",{onClick:E,disabled:v||!d,className:"w-full bg-indigo-600 text-white p-2 rounded-lg font-bold hover:bg-indigo-700 transition disabled:opacity-50",children:v?"Verifying...":"Link Student Account"})]}),a.jsx("button",{onClick:n,className:"w-full text-sm text-gray-500 hover:text-indigo-600 mt-2",children:"Skip enrollment for now"})]})}const NSe={initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10}};function ESe({children:t,className:e=""}){return a.jsx(nt.div,{initial:"initial",animate:"animate",exit:"exit",variants:NSe,transition:{duration:.3,ease:"easeOut"},className:e,children:t})}function SSe(){var J,ue,ve,le;const[t,e]=N.useState(null),[n,r]=N.useState(null),[s,i]=N.useState({}),[o,l]=N.useState([]),[c,d]=N.useState(!0),[h,m]=N.useState(()=>typeof window<"u"&&new URLSearchParams(window.location.search).get("tab")||"dashboard"),p=q=>{if(m(q),new URLSearchParams(window.location.search).get("tab")!==q){const H=`${window.location.pathname}?tab=${q}`;window.history.pushState({tab:q},"",H)}};N.useEffect(()=>{const q=()=>{const H=new URLSearchParams(window.location.search).get("tab")||"dashboard";m(H)};return window.addEventListener("popstate",q),()=>window.removeEventListener("popstate",q)},[]);const[v,x]=N.useState(!1),[b,E]=N.useState(null),[k,_]=N.useState(0),[S,T]=N.useState(()=>typeof window<"u"?localStorage.getItem("theme")==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches:!1);N.useEffect(()=>{S?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[S]);const P=()=>T(!S),j=i$(Fc),R=pre(Fc);N.useEffect(()=>{const q=ZX(j,async Q=>{if(d(!0),Q){e(Q);const H=Se(R,`artifacts/${Ge}/users/${Q.uid}/profiles/main`),X=pn(H,te=>{te.exists()?r(te.data()):r(null)}),oe=Se(R,`artifacts/${Ge}/users/${Q.uid}/wallet/account`),ae=pn(oe,te=>{te.exists()&&_(te.data().balance||0)}),je=Re(R,`artifacts/${Ge}/users/${Q.uid}/profiles`),ge=pn(je,te=>{const be={};te.forEach(Fe=>{Fe.id!=="main"&&(be[Fe.id]=Fe.data())}),i(be)});return l([{id:1,text:"Welcome to SeshNx!",type:"system",timestamp:new Date}]),d(!1),()=>{X(),ae(),ge()}}else e(null),r(null),i({}),d(!1)});return()=>q()},[]);const I=()=>nI(j),O=(q,Q)=>E({uid:q,name:Q}),D=async q=>{if(t)try{const Q=Se(R,`artifacts/${Ge}/users/${t.uid}/profiles/main`);await Nt(Q,{activeProfileRole:q})}catch(Q){console.error("Role switch failed:",Q)}};if(c)return a.jsx("div",{className:"h-screen flex items-center justify-center bg-gray-50 dark:bg-[#1a1d21]",children:a.jsx(rt,{className:"animate-spin text-brand-blue",size:48})});if(!t)return a.jsx(J5,{darkMode:S,toggleTheme:P});if(t&&!n)return a.jsx(J5,{user:t,isNewUser:!0,darkMode:S,toggleTheme:P});const F=()=>{var q,Q,H;if(h.startsWith("edu-"))return h==="edu-enroll"?a.jsx(kSe,{user:t,userData:n}):(q=n==null?void 0:n.accountTypes)!=null&&q.includes("Admin")?a.jsx(dG,{user:t,userData:n,currentView:h}):(Q=n==null?void 0:n.accountTypes)!=null&&Q.includes("Instructor")?a.jsx(_Se,{user:t,userData:n,currentView:h}):(H=n==null?void 0:n.accountTypes)!=null&&H.includes("Intern")?a.jsx(wSe,{user:t,userData:n,currentView:h}):a.jsx(iSe,{user:t,userData:n});switch(h){case"dashboard":case"home":return a.jsx(X5,{user:t,userData:n,subProfiles:s,notifications:o,setActiveTab:p,tokenBalance:k});case"feed":case"social":return a.jsx(Yke,{user:t,userData:n,openPublicProfile:O});case"bookings":case"find-talent":return a.jsx($Ne,{user:t,userData:n,openPublicProfile:O});case"marketplace":return a.jsx(nEe,{user:t,userData:n,tokenBalance:k});case"messages":return a.jsx(SEe,{user:t,userData:n,openPublicProfile:O});case"tech":return a.jsx(GEe,{user:t,userData:n});case"studio-ops":case"studio-manager":return a.jsx(IEe,{user:t,userData:n});case"label-manager":return a.jsx(sSe,{user:t,userData:n});case"payments":return a.jsx(rSe,{user:t,userData:n});case"profile":return a.jsx(PEe,{user:t,userData:n,subProfiles:s,handleLogout:I});case"settings":return a.jsx(cG,{user:t,userData:n,handleLogout:I});case"legal":return a.jsx(Aq,{});default:return a.jsx(X5,{user:t,userData:n,setActiveTab:p,subProfiles:s,notifications:o})}},$=h.startsWith("edu-")&&(((J=n==null?void 0:n.accountTypes)==null?void 0:J.includes("Admin"))||((ue=n==null?void 0:n.accountTypes)==null?void 0:ue.includes("Instructor")));return a.jsx(tke,{user:t,userData:n,children:a.jsxs("div",{className:"flex h-screen flex-col bg-gray-50 dark:bg-[#1a1d21] overflow-hidden selection:bg-brand-blue selection:text-white",children:[a.jsx(pwe,{position:"bottom-right",toastOptions:{style:{background:"#333",color:"#fff"},success:{style:{background:"green"},iconTheme:{primary:"white",secondary:"green"}},error:{style:{background:"red"}}}}),a.jsx(eke,{user:t,userData:n,subProfiles:s,onMenuClick:()=>x(!v),setActiveTab:p,activeTab:h,tokenBalance:k,darkMode:S,toggleTheme:P,onRoleSwitch:D,openPublicProfile:O}),a.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[a.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 transform transition-transform duration-300 ease-in-out md:relative md:translate-x-0 ${v?"translate-x-0 shadow-2xl":"-translate-x-full"} bg-white dark:bg-[#23262f] border-r dark:border-gray-800`,children:$?a.jsx(rke,{activeTab:h,setActiveTab:p,sidebarOpen:v,setSidebarOpen:x,isStaff:(ve=n.accountTypes)==null?void 0:ve.includes("Instructor"),isAdmin:(le=n.accountTypes)==null?void 0:le.includes("Admin")}):a.jsx(nke,{activeTab:h,setActiveTab:p,sidebarOpen:v,setSidebarOpen:x,userData:n,handleLogout:I})}),a.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 scroll-smooth",id:"main-scroll",children:a.jsx(yr,{mode:"wait",children:a.jsx(ESe,{className:"max-w-7xl mx-auto",children:F()},h)})})]}),a.jsx(yr,{children:b&&a.jsx(FEe,{userId:b.uid,currentUser:t,currentUserData:n,onClose:()=>E(null),onMessage:(q,Q)=>{E(null),p("messages")}})})]})})}DE.createRoot(document.getElementById("root")).render(a.jsx(He.StrictMode,{children:a.jsx(SSe,{})}));const TSe=()=>{const t=document.getElementById("loading-fallback");t&&(t.classList.add("fade-out"),setTimeout(()=>{t&&t.parentNode&&t.parentNode.removeChild(t),document.body.style.overflow="auto"},500))};setTimeout(TSe,800);
