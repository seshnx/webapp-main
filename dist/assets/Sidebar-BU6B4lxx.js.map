{"version":3,"file":"Sidebar-BU6B4lxx.js","sources":["../../src/components/Sidebar.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { User, MessageSquare, Calendar, MessageCircle, Settings, Sliders, LogOut, ShoppingBag, CreditCard, X, ShieldCheck, Wrench, Briefcase, GraduationCap } from 'lucide-react';\r\nimport { supabase } from '../config/supabase';\r\nimport { useSchool } from '../contexts/SchoolContext';\r\n\r\nexport default function Sidebar({ userData, activeTab, setActiveTab, sidebarOpen, setSidebarOpen, handleLogout }) {\r\n  // Always call hook (React rules), but handle case where context might not be ready\r\n  const schoolContext = useSchool();\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  \r\n  // Safely extract values with fallbacks\r\n  const isStudent = schoolContext?.isStudent ?? (userData?.accountTypes?.includes('Student') || false);\r\n  const isStaff = schoolContext?.isStaff ?? (userData?.accountTypes?.includes('EDUStaff') || userData?.accountTypes?.includes('EDUAdmin') || false);\r\n\r\n  // Track mobile viewport\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      setIsMobile(window.innerWidth < 1024);\r\n    };\r\n    \r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    return () => window.removeEventListener('resize', checkMobile);\r\n  }, []);\r\n\r\n  const links = [\r\n    { id: 'dashboard', icon: <User size={18} />, label: 'Dashboard' },\r\n    { id: 'feed', icon: <MessageSquare size={18} />, label: 'SocialNx' },\r\n    { id: 'marketplace', icon: <ShoppingBag size={18} />, label: 'Marketplace' },\r\n    { id: 'tech', icon: <Wrench size={18} />, label: 'Tech Services' }, \r\n    { id: 'bookings', icon: <Calendar size={18} />, label: 'Bookings' },\r\n    { id: 'messages', icon: <MessageCircle size={18} />, label: 'Messages' },\r\n    { id: 'payments', icon: <CreditCard size={18} />, label: 'Billing' },\r\n    { id: 'profile', icon: <Settings size={18} />, label: 'Profile' },\r\n  ];\r\n\r\n  // --- EDU Panel Logic ---\r\n  // Now checks for Students OR Staff (EDUStaff/EDUAdmins)\r\n  const isIntern = userData?.accountTypes?.includes('Intern');\r\n  \r\n  if (isStudent || isIntern || isStaff || userData?.accountTypes?.includes('student')) {\r\n      const insertIdx = links.findIndex(l => l.id === 'payments');\r\n      \r\n      // Determine label based on role\r\n      let label = 'EDU Panel';\r\n      if (isIntern) label = 'Internship';\r\n      else if (isStaff) label = 'School Admin';\r\n\r\n      // Determine routing ID\r\n      let routeId = 'edu-overview'; // Default for staff/students\r\n      if (isIntern) routeId = 'edu-intern';\r\n      else if (isStudent) routeId = 'edu-student';\r\n\r\n      links.splice(insertIdx, 0, { \r\n          id: routeId,\r\n          icon: <GraduationCap size={18} />, \r\n          label: label, \r\n          highlight: true \r\n      });\r\n  }\r\n\r\n  // Check if user has business features (Studio, Label, Agent, Talent, Producer, etc.)\r\n  const hasBusinessFeatures = userData?.accountTypes?.some(t => \r\n    ['Studio', 'Label', 'Agent', 'Talent', 'Producer', 'Engineer'].includes(t)\r\n  );\r\n\r\n  const onLogout = handleLogout || (async () => {\r\n    try {\r\n      if (supabase) {\r\n        const { error } = await supabase.auth.signOut();\r\n        if (error) console.error(\"Logout error:\", error);\r\n      }\r\n      // Navigate to home after logout\r\n      window.location.href = '/';\r\n    } catch (err) {\r\n      console.error(\"Logout failed:\", err);\r\n      window.location.href = '/';\r\n    }\r\n  });\r\n\r\n  const handleNavigation = (id) => {\r\n    setActiveTab(id);\r\n    // Always close sidebar after navigation (especially on mobile)\r\n    // Check if we're on mobile screen size\r\n    const isMobile = window.innerWidth < 1024;\r\n    if (setSidebarOpen && (isMobile || sidebarOpen)) {\r\n      setSidebarOpen(false);\r\n    }\r\n  };\r\n\r\n  const SidebarContent = ({ isMobile }) => (\r\n    <>\r\n      <div className=\"flex-1 py-4 overflow-y-auto scrollbar-hide\">\r\n        {isMobile && (\r\n            <div className=\"px-4 mb-6 flex items-center justify-between\">\r\n                <div className=\"text-xs font-bold text-gray-400 uppercase\">Menu</div>\r\n                <button \r\n                    onClick={() => setSidebarOpen(false)} \r\n                    className=\"p-2 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors\"\r\n                    aria-label=\"Close menu\"\r\n                >\r\n                    <X size={20} aria-hidden=\"true\" />\r\n                </button>\r\n            </div>\r\n        )}\r\n        \r\n        <nav className=\"space-y-1 px-2\">\r\n            {links.map(link => (\r\n            <button\r\n                key={link.id}\r\n                onClick={() => handleNavigation(link.id)}\r\n                className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition\r\n                ${activeTab === link.id \r\n                    ? 'bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400' \r\n                    : 'text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800'}\r\n                ${link.highlight ? 'text-amber-600 dark:text-amber-500' : ''}\r\n                `}\r\n            >\r\n                {link.icon}\r\n                {link.label}\r\n            </button>\r\n            ))}\r\n        </nav>\r\n\r\n        <div className=\"mt-auto px-2 pt-4 space-y-1\">\r\n            <button onClick={() => handleNavigation('legal')} className={`flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium w-full transition ${activeTab === 'legal' ? 'bg-blue-50 text-brand-blue dark:bg-blue-900/20 dark:text-blue-400' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800'}`}>\r\n                <ShieldCheck size={18} />\r\n                Legal Center\r\n            </button>\r\n            \r\n            {/* Business Center - Show if user has business features */}\r\n            {hasBusinessFeatures && (\r\n                <button \r\n                    onClick={() => handleNavigation('business-center')} \r\n                    className={`flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium w-full transition ${\r\n                        activeTab === 'business-center' \r\n                            ? 'bg-indigo-50 text-indigo-600 dark:bg-indigo-900/20 dark:text-indigo-400' \r\n                            : 'text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/10'\r\n                    }`}\r\n                >\r\n                    <Briefcase size={18} />\r\n                    Business Center\r\n                </button>\r\n            )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"p-4 border-t border-gray-200 dark:border-gray-700 shrink-0 bg-white dark:bg-[#1f2128]\">\r\n        <button onClick={onLogout} className=\"flex items-center gap-2 text-red-500 text-sm font-medium hover:opacity-80 px-2 w-full py-2 rounded hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors\">\r\n          <LogOut size={16} /> Sign Out\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {/* Desktop Sidebar */}\r\n      <aside className=\"hidden lg:flex w-64 bg-white dark:bg-[#1f2128] border-r border-gray-200 dark:border-gray-700 flex-col h-full shrink-0 relative z-30\">\r\n         <SidebarContent isMobile={false} />\r\n      </aside>\r\n\r\n      {/* Mobile Backdrop */}\r\n      {sidebarOpen && isMobile && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] transition-all duration-300 ease-out opacity-100 pointer-events-auto\" \r\n          onClick={() => setSidebarOpen(false)}\r\n          aria-hidden=\"true\"\r\n        />\r\n      )}\r\n\r\n      {/* Mobile Sidebar */}\r\n      <aside \r\n        className={`fixed inset-y-0 left-0 z-[10000] w-72 bg-white dark:bg-[#1f2128] shadow-2xl transform transition-all duration-300 ease-out flex flex-col h-full lg:hidden ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'}`}\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        aria-label=\"Navigation menu\"\r\n      >\r\n         <SidebarContent isMobile={true} />\r\n      </aside>\r\n    </>\r\n  );\r\n}\r\n"],"names":["Sidebar","userData","activeTab","setActiveTab","sidebarOpen","setSidebarOpen","handleLogout","schoolContext","useSchool","isMobile","setIsMobile","useState","isStudent","_a","isStaff","_b","_c","useEffect","checkMobile","links","jsx","User","MessageSquare","ShoppingBag","Wrench","Calendar","MessageCircle","CreditCard","Settings","isIntern","_d","_e","insertIdx","l","label","routeId","GraduationCap","hasBusinessFeatures","_f","t","onLogout","err","handleNavigation","id","SidebarContent","jsxs","Fragment","X","link","ShieldCheck","Briefcase","LogOut"],"mappings":"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"}